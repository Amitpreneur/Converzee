{"ast":null,"code":"/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.10.2 (2021-11-17)\n */\n(function () {\n  'use strict';\n\n  var Cell = function (initial) {\n    var value = initial;\n\n    var get = function () {\n      return value;\n    };\n\n    var set = function (v) {\n      value = v;\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var global$3 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n  var __assign = function () {\n    __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n\n      return t;\n    };\n\n    return __assign.apply(this, arguments);\n  };\n\n  var typeOf = function (x) {\n    var t = typeof x;\n\n    if (x === null) {\n      return 'null';\n    } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    } else {\n      return t;\n    }\n  };\n\n  var isType$1 = function (type) {\n    return function (value) {\n      return typeOf(value) === type;\n    };\n  };\n\n  var isSimpleType = function (type) {\n    return function (value) {\n      return typeof value === type;\n    };\n  };\n\n  var isString = isType$1('string');\n  var isArray = isType$1('array');\n  var isBoolean = isSimpleType('boolean');\n  var isNumber = isSimpleType('number');\n\n  var noop = function () {};\n\n  var constant = function (value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var identity = function (x) {\n    return x;\n  };\n\n  var never = constant(false);\n  var always = constant(true);\n  var punctuationStr = '[!-#%-*,-\\\\/:;?@\\\\[-\\\\]_{}\\xA1\\xAB\\xB7\\xBB\\xBF;\\xB7\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1361-\\u1368\\u1400\\u166D\\u166E\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CD3\\u2010-\\u2027\\u2030-\\u2043\\u2045-\\u2051\\u2053-\\u205E\\u207D\\u207E\\u208D\\u208E\\u3008\\u3009\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30\\u2E31\\u3001-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uff3f\\uFF5B\\uFF5D\\uFF5F-\\uFF65]';\n  var punctuation$1 = constant(punctuationStr);\n\n  var none = function () {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var call = function (thunk) {\n      return thunk();\n    };\n\n    var id = identity;\n    var me = {\n      fold: function (n, _s) {\n        return n();\n      },\n      isSome: never,\n      isNone: always,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function (msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: constant(null),\n      getOrUndefined: constant(undefined),\n      or: id,\n      orThunk: call,\n      map: none,\n      each: noop,\n      bind: none,\n      exists: never,\n      forall: always,\n      filter: function () {\n        return none();\n      },\n      toArray: function () {\n        return [];\n      },\n      toString: constant('none()')\n    };\n    return me;\n  }();\n\n  var some = function (a) {\n    var constant_a = constant(a);\n\n    var self = function () {\n      return me;\n    };\n\n    var bind = function (f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function (n, s) {\n        return s(a);\n      },\n      isSome: always,\n      isNone: never,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: function (f) {\n        return some(f(a));\n      },\n      each: function (f) {\n        f(a);\n      },\n      bind: bind,\n      exists: bind,\n      forall: bind,\n      filter: function (f) {\n        return f(a) ? me : NONE;\n      },\n      toArray: function () {\n        return [a];\n      },\n      toString: function () {\n        return 'some(' + a + ')';\n      }\n    };\n    return me;\n  };\n\n  var from = function (value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Optional = {\n    some: some,\n    none: none,\n    from: from\n  };\n  var punctuation = punctuation$1;\n  var global$2 = tinymce.util.Tools.resolve('tinymce.Env');\n  var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n  var nativeSlice = Array.prototype.slice;\n  var nativePush = Array.prototype.push;\n\n  var map = function (xs, f) {\n    var len = xs.length;\n    var r = new Array(len);\n\n    for (var i = 0; i < len; i++) {\n      var x = xs[i];\n      r[i] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var each = function (xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var eachr = function (xs, f) {\n    for (var i = xs.length - 1; i >= 0; i--) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var groupBy = function (xs, f) {\n    if (xs.length === 0) {\n      return [];\n    } else {\n      var wasType = f(xs[0]);\n      var r = [];\n      var group = [];\n\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        var type = f(x);\n\n        if (type !== wasType) {\n          r.push(group);\n          group = [];\n        }\n\n        wasType = type;\n        group.push(x);\n      }\n\n      if (group.length !== 0) {\n        r.push(group);\n      }\n\n      return r;\n    }\n  };\n\n  var foldl = function (xs, f, acc) {\n    each(xs, function (x, i) {\n      acc = f(acc, x, i);\n    });\n    return acc;\n  };\n\n  var flatten = function (xs) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (!isArray(xs[i])) {\n        throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n      }\n\n      nativePush.apply(r, xs[i]);\n    }\n\n    return r;\n  };\n\n  var bind = function (xs, f) {\n    return flatten(map(xs, f));\n  };\n\n  var sort = function (xs, comparator) {\n    var copy = nativeSlice.call(xs, 0);\n    copy.sort(comparator);\n    return copy;\n  };\n\n  var hasOwnProperty = Object.hasOwnProperty;\n\n  var has = function (obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  typeof window !== 'undefined' ? window : Function('return this;')();\n  var DOCUMENT = 9;\n  var DOCUMENT_FRAGMENT = 11;\n  var ELEMENT = 1;\n  var TEXT = 3;\n\n  var type = function (element) {\n    return element.dom.nodeType;\n  };\n\n  var isType = function (t) {\n    return function (element) {\n      return type(element) === t;\n    };\n  };\n\n  var isText$1 = isType(TEXT);\n\n  var rawSet = function (dom, key, value) {\n    if (isString(value) || isBoolean(value) || isNumber(value)) {\n      dom.setAttribute(key, value + '');\n    } else {\n      console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n      throw new Error('Attribute value was not simple');\n    }\n  };\n\n  var set = function (element, key, value) {\n    rawSet(element.dom, key, value);\n  };\n\n  var compareDocumentPosition = function (a, b, match) {\n    return (a.compareDocumentPosition(b) & match) !== 0;\n  };\n\n  var documentPositionPreceding = function (a, b) {\n    return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_PRECEDING);\n  };\n\n  var fromHtml = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n\n    if (!div.hasChildNodes() || div.childNodes.length > 1) {\n      console.error('HTML does not have a single root node', html);\n      throw new Error('HTML must have a single root node');\n    }\n\n    return fromDom(div.childNodes[0]);\n  };\n\n  var fromTag = function (tag, scope) {\n    var doc = scope || document;\n    var node = doc.createElement(tag);\n    return fromDom(node);\n  };\n\n  var fromText = function (text, scope) {\n    var doc = scope || document;\n    var node = doc.createTextNode(text);\n    return fromDom(node);\n  };\n\n  var fromDom = function (node) {\n    if (node === null || node === undefined) {\n      throw new Error('Node cannot be null or undefined');\n    }\n\n    return {\n      dom: node\n    };\n  };\n\n  var fromPoint = function (docElm, x, y) {\n    return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n  };\n\n  var SugarElement = {\n    fromHtml: fromHtml,\n    fromTag: fromTag,\n    fromText: fromText,\n    fromDom: fromDom,\n    fromPoint: fromPoint\n  };\n\n  var bypassSelector = function (dom) {\n    return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n  };\n\n  var all = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), SugarElement.fromDom);\n  };\n\n  var parent = function (element) {\n    return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n  };\n\n  var children = function (element) {\n    return map(element.dom.childNodes, SugarElement.fromDom);\n  };\n\n  var spot = function (element, offset) {\n    return {\n      element: element,\n      offset: offset\n    };\n  };\n\n  var leaf = function (element, offset) {\n    var cs = children(element);\n    return cs.length > 0 && offset < cs.length ? spot(cs[offset], 0) : spot(element, offset);\n  };\n\n  var before = function (marker, element) {\n    var parent$1 = parent(marker);\n    parent$1.each(function (v) {\n      v.dom.insertBefore(element.dom, marker.dom);\n    });\n  };\n\n  var append = function (parent, element) {\n    parent.dom.appendChild(element.dom);\n  };\n\n  var wrap = function (element, wrapper) {\n    before(element, wrapper);\n    append(wrapper, element);\n  };\n\n  var NodeValue = function (is, name) {\n    var get = function (element) {\n      if (!is(element)) {\n        throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n      }\n\n      return getOption(element).getOr('');\n    };\n\n    var getOption = function (element) {\n      return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n    };\n\n    var set = function (element, value) {\n      if (!is(element)) {\n        throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n      }\n\n      element.dom.nodeValue = value;\n    };\n\n    return {\n      get: get,\n      getOption: getOption,\n      set: set\n    };\n  };\n\n  var api = NodeValue(isText$1, 'text');\n\n  var get$1 = function (element) {\n    return api.get(element);\n  };\n\n  var descendants = function (scope, selector) {\n    return all(selector, scope);\n  };\n\n  var global = tinymce.util.Tools.resolve('tinymce.dom.TreeWalker');\n\n  var isSimpleBoundary = function (dom, node) {\n    return dom.isBlock(node) || has(dom.schema.getShortEndedElements(), node.nodeName);\n  };\n\n  var isContentEditableFalse = function (dom, node) {\n    return dom.getContentEditable(node) === 'false';\n  };\n\n  var isContentEditableTrueInCef = function (dom, node) {\n    return dom.getContentEditable(node) === 'true' && dom.getContentEditableParent(node.parentNode) === 'false';\n  };\n\n  var isHidden = function (dom, node) {\n    return !dom.isBlock(node) && has(dom.schema.getWhiteSpaceElements(), node.nodeName);\n  };\n\n  var isBoundary = function (dom, node) {\n    return isSimpleBoundary(dom, node) || isContentEditableFalse(dom, node) || isHidden(dom, node) || isContentEditableTrueInCef(dom, node);\n  };\n\n  var isText = function (node) {\n    return node.nodeType === 3;\n  };\n\n  var nuSection = function () {\n    return {\n      sOffset: 0,\n      fOffset: 0,\n      elements: []\n    };\n  };\n\n  var toLeaf = function (node, offset) {\n    return leaf(SugarElement.fromDom(node), offset);\n  };\n\n  var walk = function (dom, walkerFn, startNode, callbacks, endNode, skipStart) {\n    if (skipStart === void 0) {\n      skipStart = true;\n    }\n\n    var next = skipStart ? walkerFn(false) : startNode;\n\n    while (next) {\n      var isCefNode = isContentEditableFalse(dom, next);\n\n      if (isCefNode || isHidden(dom, next)) {\n        var stopWalking = isCefNode ? callbacks.cef(next) : callbacks.boundary(next);\n\n        if (stopWalking) {\n          break;\n        } else {\n          next = walkerFn(true);\n          continue;\n        }\n      } else if (isSimpleBoundary(dom, next)) {\n        if (callbacks.boundary(next)) {\n          break;\n        }\n      } else if (isText(next)) {\n        callbacks.text(next);\n      }\n\n      if (next === endNode) {\n        break;\n      } else {\n        next = walkerFn(false);\n      }\n    }\n  };\n\n  var collectTextToBoundary = function (dom, section, node, rootNode, forwards) {\n    if (isBoundary(dom, node)) {\n      return;\n    }\n\n    var rootBlock = dom.getParent(rootNode, dom.isBlock);\n    var walker = new global(node, rootBlock);\n    var walkerFn = forwards ? walker.next.bind(walker) : walker.prev.bind(walker);\n    walk(dom, walkerFn, node, {\n      boundary: always,\n      cef: always,\n      text: function (next) {\n        if (forwards) {\n          section.fOffset += next.length;\n        } else {\n          section.sOffset += next.length;\n        }\n\n        section.elements.push(SugarElement.fromDom(next));\n      }\n    });\n  };\n\n  var collect = function (dom, rootNode, startNode, endNode, callbacks, skipStart) {\n    if (skipStart === void 0) {\n      skipStart = true;\n    }\n\n    var walker = new global(startNode, rootNode);\n    var sections = [];\n    var current = nuSection();\n    collectTextToBoundary(dom, current, startNode, rootNode, false);\n\n    var finishSection = function () {\n      if (current.elements.length > 0) {\n        sections.push(current);\n        current = nuSection();\n      }\n\n      return false;\n    };\n\n    walk(dom, walker.next.bind(walker), startNode, {\n      boundary: finishSection,\n      cef: function (node) {\n        finishSection();\n\n        if (callbacks) {\n          sections.push.apply(sections, callbacks.cef(node));\n        }\n\n        return false;\n      },\n      text: function (next) {\n        current.elements.push(SugarElement.fromDom(next));\n\n        if (callbacks) {\n          callbacks.text(next, current);\n        }\n      }\n    }, endNode, skipStart);\n\n    if (endNode) {\n      collectTextToBoundary(dom, current, endNode, rootNode, true);\n    }\n\n    finishSection();\n    return sections;\n  };\n\n  var collectRangeSections = function (dom, rng) {\n    var start = toLeaf(rng.startContainer, rng.startOffset);\n    var startNode = start.element.dom;\n    var end = toLeaf(rng.endContainer, rng.endOffset);\n    var endNode = end.element.dom;\n    return collect(dom, rng.commonAncestorContainer, startNode, endNode, {\n      text: function (node, section) {\n        if (node === endNode) {\n          section.fOffset += node.length - end.offset;\n        } else if (node === startNode) {\n          section.sOffset += start.offset;\n        }\n      },\n      cef: function (node) {\n        var sections = bind(descendants(SugarElement.fromDom(node), '*[contenteditable=true]'), function (e) {\n          var ceTrueNode = e.dom;\n          return collect(dom, ceTrueNode, ceTrueNode);\n        });\n        return sort(sections, function (a, b) {\n          return documentPositionPreceding(a.elements[0].dom, b.elements[0].dom) ? 1 : -1;\n        });\n      }\n    }, false);\n  };\n\n  var fromRng = function (dom, rng) {\n    return rng.collapsed ? [] : collectRangeSections(dom, rng);\n  };\n\n  var fromNode = function (dom, node) {\n    var rng = dom.createRng();\n    rng.selectNode(node);\n    return fromRng(dom, rng);\n  };\n\n  var fromNodes = function (dom, nodes) {\n    return bind(nodes, function (node) {\n      return fromNode(dom, node);\n    });\n  };\n\n  var find$2 = function (text, pattern, start, finish) {\n    if (start === void 0) {\n      start = 0;\n    }\n\n    if (finish === void 0) {\n      finish = text.length;\n    }\n\n    var regex = pattern.regex;\n    regex.lastIndex = start;\n    var results = [];\n    var match;\n\n    while (match = regex.exec(text)) {\n      var matchedText = match[pattern.matchIndex];\n      var matchStart = match.index + match[0].indexOf(matchedText);\n      var matchFinish = matchStart + matchedText.length;\n\n      if (matchFinish > finish) {\n        break;\n      }\n\n      results.push({\n        start: matchStart,\n        finish: matchFinish\n      });\n      regex.lastIndex = matchFinish;\n    }\n\n    return results;\n  };\n\n  var extract = function (elements, matches) {\n    var nodePositions = foldl(elements, function (acc, element) {\n      var content = get$1(element);\n      var start = acc.last;\n      var finish = start + content.length;\n      var positions = bind(matches, function (match, matchIdx) {\n        if (match.start < finish && match.finish > start) {\n          return [{\n            element: element,\n            start: Math.max(start, match.start) - start,\n            finish: Math.min(finish, match.finish) - start,\n            matchId: matchIdx\n          }];\n        } else {\n          return [];\n        }\n      });\n      return {\n        results: acc.results.concat(positions),\n        last: finish\n      };\n    }, {\n      results: [],\n      last: 0\n    }).results;\n    return groupBy(nodePositions, function (position) {\n      return position.matchId;\n    });\n  };\n\n  var find$1 = function (pattern, sections) {\n    return bind(sections, function (section) {\n      var elements = section.elements;\n      var content = map(elements, get$1).join('');\n      var positions = find$2(content, pattern, section.sOffset, content.length - section.fOffset);\n      return extract(elements, positions);\n    });\n  };\n\n  var mark = function (matches, replacementNode) {\n    eachr(matches, function (match, idx) {\n      eachr(match, function (pos) {\n        var wrapper = SugarElement.fromDom(replacementNode.cloneNode(false));\n        set(wrapper, 'data-mce-index', idx);\n        var textNode = pos.element.dom;\n\n        if (textNode.length === pos.finish && pos.start === 0) {\n          wrap(pos.element, wrapper);\n        } else {\n          if (textNode.length !== pos.finish) {\n            textNode.splitText(pos.finish);\n          }\n\n          var matchNode = textNode.splitText(pos.start);\n          wrap(SugarElement.fromDom(matchNode), wrapper);\n        }\n      });\n    });\n  };\n\n  var findAndMark = function (dom, pattern, node, replacementNode) {\n    var textSections = fromNode(dom, node);\n    var matches = find$1(pattern, textSections);\n    mark(matches, replacementNode);\n    return matches.length;\n  };\n\n  var findAndMarkInSelection = function (dom, pattern, selection, replacementNode) {\n    var bookmark = selection.getBookmark();\n    var nodes = dom.select('td[data-mce-selected],th[data-mce-selected]');\n    var textSections = nodes.length > 0 ? fromNodes(dom, nodes) : fromRng(dom, selection.getRng());\n    var matches = find$1(pattern, textSections);\n    mark(matches, replacementNode);\n    selection.moveToBookmark(bookmark);\n    return matches.length;\n  };\n\n  var getElmIndex = function (elm) {\n    var value = elm.getAttribute('data-mce-index');\n\n    if (typeof value === 'number') {\n      return '' + value;\n    }\n\n    return value;\n  };\n\n  var markAllMatches = function (editor, currentSearchState, pattern, inSelection) {\n    var marker = editor.dom.create('span', {\n      'data-mce-bogus': 1\n    });\n    marker.className = 'mce-match-marker';\n    var node = editor.getBody();\n    done(editor, currentSearchState, false);\n\n    if (inSelection) {\n      return findAndMarkInSelection(editor.dom, pattern, editor.selection, marker);\n    } else {\n      return findAndMark(editor.dom, pattern, node, marker);\n    }\n  };\n\n  var unwrap = function (node) {\n    var parentNode = node.parentNode;\n\n    if (node.firstChild) {\n      parentNode.insertBefore(node.firstChild, node);\n    }\n\n    node.parentNode.removeChild(node);\n  };\n\n  var findSpansByIndex = function (editor, index) {\n    var spans = [];\n    var nodes = global$1.toArray(editor.getBody().getElementsByTagName('span'));\n\n    if (nodes.length) {\n      for (var i = 0; i < nodes.length; i++) {\n        var nodeIndex = getElmIndex(nodes[i]);\n\n        if (nodeIndex === null || !nodeIndex.length) {\n          continue;\n        }\n\n        if (nodeIndex === index.toString()) {\n          spans.push(nodes[i]);\n        }\n      }\n    }\n\n    return spans;\n  };\n\n  var moveSelection = function (editor, currentSearchState, forward) {\n    var searchState = currentSearchState.get();\n    var testIndex = searchState.index;\n    var dom = editor.dom;\n    forward = forward !== false;\n\n    if (forward) {\n      if (testIndex + 1 === searchState.count) {\n        testIndex = 0;\n      } else {\n        testIndex++;\n      }\n    } else {\n      if (testIndex - 1 === -1) {\n        testIndex = searchState.count - 1;\n      } else {\n        testIndex--;\n      }\n    }\n\n    dom.removeClass(findSpansByIndex(editor, searchState.index), 'mce-match-marker-selected');\n    var spans = findSpansByIndex(editor, testIndex);\n\n    if (spans.length) {\n      dom.addClass(findSpansByIndex(editor, testIndex), 'mce-match-marker-selected');\n      editor.selection.scrollIntoView(spans[0]);\n      return testIndex;\n    }\n\n    return -1;\n  };\n\n  var removeNode = function (dom, node) {\n    var parent = node.parentNode;\n    dom.remove(node);\n\n    if (dom.isEmpty(parent)) {\n      dom.remove(parent);\n    }\n  };\n\n  var escapeSearchText = function (text, wholeWord) {\n    var escapedText = text.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&').replace(/\\s/g, '[^\\\\S\\\\r\\\\n\\\\uFEFF]');\n    var wordRegex = '(' + escapedText + ')';\n    return wholeWord ? '(?:^|\\\\s|' + punctuation() + ')' + wordRegex + ('(?=$|\\\\s|' + punctuation() + ')') : wordRegex;\n  };\n\n  var find = function (editor, currentSearchState, text, matchCase, wholeWord, inSelection) {\n    var selection = editor.selection;\n    var escapedText = escapeSearchText(text, wholeWord);\n    var isForwardSelection = selection.isForward();\n    var pattern = {\n      regex: new RegExp(escapedText, matchCase ? 'g' : 'gi'),\n      matchIndex: 1\n    };\n    var count = markAllMatches(editor, currentSearchState, pattern, inSelection);\n\n    if (global$2.browser.isSafari()) {\n      selection.setRng(selection.getRng(), isForwardSelection);\n    }\n\n    if (count) {\n      var newIndex = moveSelection(editor, currentSearchState, true);\n      currentSearchState.set({\n        index: newIndex,\n        count: count,\n        text: text,\n        matchCase: matchCase,\n        wholeWord: wholeWord,\n        inSelection: inSelection\n      });\n    }\n\n    return count;\n  };\n\n  var next = function (editor, currentSearchState) {\n    var index = moveSelection(editor, currentSearchState, true);\n    currentSearchState.set(__assign(__assign({}, currentSearchState.get()), {\n      index: index\n    }));\n  };\n\n  var prev = function (editor, currentSearchState) {\n    var index = moveSelection(editor, currentSearchState, false);\n    currentSearchState.set(__assign(__assign({}, currentSearchState.get()), {\n      index: index\n    }));\n  };\n\n  var isMatchSpan = function (node) {\n    var matchIndex = getElmIndex(node);\n    return matchIndex !== null && matchIndex.length > 0;\n  };\n\n  var replace = function (editor, currentSearchState, text, forward, all) {\n    var searchState = currentSearchState.get();\n    var currentIndex = searchState.index;\n    var currentMatchIndex,\n        nextIndex = currentIndex;\n    forward = forward !== false;\n    var node = editor.getBody();\n    var nodes = global$1.grep(global$1.toArray(node.getElementsByTagName('span')), isMatchSpan);\n\n    for (var i = 0; i < nodes.length; i++) {\n      var nodeIndex = getElmIndex(nodes[i]);\n      var matchIndex = currentMatchIndex = parseInt(nodeIndex, 10);\n\n      if (all || matchIndex === searchState.index) {\n        if (text.length) {\n          nodes[i].firstChild.nodeValue = text;\n          unwrap(nodes[i]);\n        } else {\n          removeNode(editor.dom, nodes[i]);\n        }\n\n        while (nodes[++i]) {\n          matchIndex = parseInt(getElmIndex(nodes[i]), 10);\n\n          if (matchIndex === currentMatchIndex) {\n            removeNode(editor.dom, nodes[i]);\n          } else {\n            i--;\n            break;\n          }\n        }\n\n        if (forward) {\n          nextIndex--;\n        }\n      } else if (currentMatchIndex > currentIndex) {\n        nodes[i].setAttribute('data-mce-index', String(currentMatchIndex - 1));\n      }\n    }\n\n    currentSearchState.set(__assign(__assign({}, searchState), {\n      count: all ? 0 : searchState.count - 1,\n      index: nextIndex\n    }));\n\n    if (forward) {\n      next(editor, currentSearchState);\n    } else {\n      prev(editor, currentSearchState);\n    }\n\n    return !all && currentSearchState.get().count > 0;\n  };\n\n  var done = function (editor, currentSearchState, keepEditorSelection) {\n    var startContainer, endContainer;\n    var searchState = currentSearchState.get();\n    var nodes = global$1.toArray(editor.getBody().getElementsByTagName('span'));\n\n    for (var i = 0; i < nodes.length; i++) {\n      var nodeIndex = getElmIndex(nodes[i]);\n\n      if (nodeIndex !== null && nodeIndex.length) {\n        if (nodeIndex === searchState.index.toString()) {\n          if (!startContainer) {\n            startContainer = nodes[i].firstChild;\n          }\n\n          endContainer = nodes[i].firstChild;\n        }\n\n        unwrap(nodes[i]);\n      }\n    }\n\n    currentSearchState.set(__assign(__assign({}, searchState), {\n      index: -1,\n      count: 0,\n      text: ''\n    }));\n\n    if (startContainer && endContainer) {\n      var rng = editor.dom.createRng();\n      rng.setStart(startContainer, 0);\n      rng.setEnd(endContainer, endContainer.data.length);\n\n      if (keepEditorSelection !== false) {\n        editor.selection.setRng(rng);\n      }\n\n      return rng;\n    }\n  };\n\n  var hasNext = function (editor, currentSearchState) {\n    return currentSearchState.get().count > 1;\n  };\n\n  var hasPrev = function (editor, currentSearchState) {\n    return currentSearchState.get().count > 1;\n  };\n\n  var get = function (editor, currentState) {\n    var done$1 = function (keepEditorSelection) {\n      return done(editor, currentState, keepEditorSelection);\n    };\n\n    var find$1 = function (text, matchCase, wholeWord, inSelection) {\n      if (inSelection === void 0) {\n        inSelection = false;\n      }\n\n      return find(editor, currentState, text, matchCase, wholeWord, inSelection);\n    };\n\n    var next$1 = function () {\n      return next(editor, currentState);\n    };\n\n    var prev$1 = function () {\n      return prev(editor, currentState);\n    };\n\n    var replace$1 = function (text, forward, all) {\n      return replace(editor, currentState, text, forward, all);\n    };\n\n    return {\n      done: done$1,\n      find: find$1,\n      next: next$1,\n      prev: prev$1,\n      replace: replace$1\n    };\n  };\n\n  var singleton = function (doRevoke) {\n    var subject = Cell(Optional.none());\n\n    var revoke = function () {\n      return subject.get().each(doRevoke);\n    };\n\n    var clear = function () {\n      revoke();\n      subject.set(Optional.none());\n    };\n\n    var isSet = function () {\n      return subject.get().isSome();\n    };\n\n    var get = function () {\n      return subject.get();\n    };\n\n    var set = function (s) {\n      revoke();\n      subject.set(Optional.some(s));\n    };\n\n    return {\n      clear: clear,\n      isSet: isSet,\n      get: get,\n      set: set\n    };\n  };\n\n  var value = function () {\n    var subject = singleton(noop);\n\n    var on = function (f) {\n      return subject.get().each(f);\n    };\n\n    return __assign(__assign({}, subject), {\n      on: on\n    });\n  };\n\n  var open = function (editor, currentSearchState) {\n    var dialogApi = value();\n    editor.undoManager.add();\n    var selectedText = global$1.trim(editor.selection.getContent({\n      format: 'text'\n    }));\n\n    var updateButtonStates = function (api) {\n      var updateNext = hasNext(editor, currentSearchState) ? api.enable : api.disable;\n      updateNext('next');\n      var updatePrev = hasPrev(editor, currentSearchState) ? api.enable : api.disable;\n      updatePrev('prev');\n    };\n\n    var updateSearchState = function (api) {\n      var data = api.getData();\n      var current = currentSearchState.get();\n      currentSearchState.set(__assign(__assign({}, current), {\n        matchCase: data.matchcase,\n        wholeWord: data.wholewords,\n        inSelection: data.inselection\n      }));\n    };\n\n    var disableAll = function (api, disable) {\n      var buttons = ['replace', 'replaceall', 'prev', 'next'];\n      var toggle = disable ? api.disable : api.enable;\n      each(buttons, toggle);\n    };\n\n    var notFoundAlert = function (api) {\n      editor.windowManager.alert('Could not find the specified string.', function () {\n        api.focus('findtext');\n      });\n    };\n\n    var focusButtonIfRequired = function (api, name) {\n      if (global$2.browser.isSafari() && global$2.deviceType.isTouch() && (name === 'find' || name === 'replace' || name === 'replaceall')) {\n        api.focus(name);\n      }\n    };\n\n    var reset = function (api) {\n      done(editor, currentSearchState, false);\n      disableAll(api, true);\n      updateButtonStates(api);\n    };\n\n    var doFind = function (api) {\n      var data = api.getData();\n      var last = currentSearchState.get();\n\n      if (!data.findtext.length) {\n        reset(api);\n        return;\n      }\n\n      if (last.text === data.findtext && last.matchCase === data.matchcase && last.wholeWord === data.wholewords) {\n        next(editor, currentSearchState);\n      } else {\n        var count = find(editor, currentSearchState, data.findtext, data.matchcase, data.wholewords, data.inselection);\n\n        if (count <= 0) {\n          notFoundAlert(api);\n        }\n\n        disableAll(api, count === 0);\n      }\n\n      updateButtonStates(api);\n    };\n\n    var initialState = currentSearchState.get();\n    var initialData = {\n      findtext: selectedText,\n      replacetext: '',\n      wholewords: initialState.wholeWord,\n      matchcase: initialState.matchCase,\n      inselection: initialState.inSelection\n    };\n    var spec = {\n      title: 'Find and Replace',\n      size: 'normal',\n      body: {\n        type: 'panel',\n        items: [{\n          type: 'bar',\n          items: [{\n            type: 'input',\n            name: 'findtext',\n            placeholder: 'Find',\n            maximized: true,\n            inputMode: 'search'\n          }, {\n            type: 'button',\n            name: 'prev',\n            text: 'Previous',\n            icon: 'action-prev',\n            disabled: true,\n            borderless: true\n          }, {\n            type: 'button',\n            name: 'next',\n            text: 'Next',\n            icon: 'action-next',\n            disabled: true,\n            borderless: true\n          }]\n        }, {\n          type: 'input',\n          name: 'replacetext',\n          placeholder: 'Replace with',\n          inputMode: 'search'\n        }]\n      },\n      buttons: [{\n        type: 'menu',\n        name: 'options',\n        icon: 'preferences',\n        tooltip: 'Preferences',\n        align: 'start',\n        items: [{\n          type: 'togglemenuitem',\n          name: 'matchcase',\n          text: 'Match case'\n        }, {\n          type: 'togglemenuitem',\n          name: 'wholewords',\n          text: 'Find whole words only'\n        }, {\n          type: 'togglemenuitem',\n          name: 'inselection',\n          text: 'Find in selection'\n        }]\n      }, {\n        type: 'custom',\n        name: 'find',\n        text: 'Find',\n        primary: true\n      }, {\n        type: 'custom',\n        name: 'replace',\n        text: 'Replace',\n        disabled: true\n      }, {\n        type: 'custom',\n        name: 'replaceall',\n        text: 'Replace all',\n        disabled: true\n      }],\n      initialData: initialData,\n      onChange: function (api, details) {\n        if (details.name === 'findtext' && currentSearchState.get().count > 0) {\n          reset(api);\n        }\n      },\n      onAction: function (api, details) {\n        var data = api.getData();\n\n        switch (details.name) {\n          case 'find':\n            doFind(api);\n            break;\n\n          case 'replace':\n            if (!replace(editor, currentSearchState, data.replacetext)) {\n              reset(api);\n            } else {\n              updateButtonStates(api);\n            }\n\n            break;\n\n          case 'replaceall':\n            replace(editor, currentSearchState, data.replacetext, true, true);\n            reset(api);\n            break;\n\n          case 'prev':\n            prev(editor, currentSearchState);\n            updateButtonStates(api);\n            break;\n\n          case 'next':\n            next(editor, currentSearchState);\n            updateButtonStates(api);\n            break;\n\n          case 'matchcase':\n          case 'wholewords':\n          case 'inselection':\n            updateSearchState(api);\n            reset(api);\n            break;\n        }\n\n        focusButtonIfRequired(api, details.name);\n      },\n      onSubmit: function (api) {\n        doFind(api);\n        focusButtonIfRequired(api, 'find');\n      },\n      onClose: function () {\n        editor.focus();\n        done(editor, currentSearchState);\n        editor.undoManager.add();\n      }\n    };\n    dialogApi.set(editor.windowManager.open(spec, {\n      inline: 'toolbar'\n    }));\n  };\n\n  var register$1 = function (editor, currentSearchState) {\n    editor.addCommand('SearchReplace', function () {\n      open(editor, currentSearchState);\n    });\n  };\n\n  var showDialog = function (editor, currentSearchState) {\n    return function () {\n      open(editor, currentSearchState);\n    };\n  };\n\n  var register = function (editor, currentSearchState) {\n    editor.ui.registry.addMenuItem('searchreplace', {\n      text: 'Find and replace...',\n      shortcut: 'Meta+F',\n      onAction: showDialog(editor, currentSearchState),\n      icon: 'search'\n    });\n    editor.ui.registry.addButton('searchreplace', {\n      tooltip: 'Find and replace',\n      onAction: showDialog(editor, currentSearchState),\n      icon: 'search'\n    });\n    editor.shortcuts.add('Meta+F', '', showDialog(editor, currentSearchState));\n  };\n\n  function Plugin() {\n    global$3.add('searchreplace', function (editor) {\n      var currentSearchState = Cell({\n        index: -1,\n        count: 0,\n        text: '',\n        matchCase: false,\n        wholeWord: false,\n        inSelection: false\n      });\n      register$1(editor, currentSearchState);\n      register(editor, currentSearchState);\n      return get(editor, currentSearchState);\n    });\n  }\n\n  Plugin();\n})();","map":{"version":3,"sources":["/opt/bitnami/apache/htdocs/converzee-frontend/node_modules/tinymce/plugins/searchreplace/plugin.js"],"names":["Cell","initial","value","get","set","v","global$3","tinymce","util","Tools","resolve","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","typeOf","x","Array","isPrototypeOf","constructor","name","String","isType$1","type","isSimpleType","isString","isArray","isBoolean","isNumber","noop","constant","identity","never","always","punctuationStr","punctuation$1","none","NONE","thunk","id","me","fold","_s","isSome","isNone","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","toArray","toString","some","a","constant_a","self","f","from","Optional","punctuation","global$2","global$1","nativeSlice","slice","nativePush","push","xs","len","r","eachr","groupBy","wasType","group","foldl","acc","flatten","sort","comparator","copy","has","obj","key","window","Function","DOCUMENT","DOCUMENT_FRAGMENT","ELEMENT","TEXT","element","dom","nodeType","isType","isText$1","rawSet","setAttribute","console","error","compareDocumentPosition","b","match","documentPositionPreceding","Node","DOCUMENT_POSITION_PRECEDING","fromHtml","html","scope","doc","document","div","createElement","innerHTML","hasChildNodes","childNodes","fromDom","fromTag","tag","node","fromText","text","createTextNode","fromPoint","docElm","y","elementFromPoint","SugarElement","bypassSelector","childElementCount","all","selector","base","querySelectorAll","parent","parentNode","children","spot","offset","leaf","cs","before","marker","parent$1","insertBefore","append","appendChild","wrap","wrapper","NodeValue","is","getOption","nodeValue","api","get$1","descendants","global","isSimpleBoundary","isBlock","schema","getShortEndedElements","nodeName","isContentEditableFalse","getContentEditable","isContentEditableTrueInCef","getContentEditableParent","isHidden","getWhiteSpaceElements","isBoundary","isText","nuSection","sOffset","fOffset","elements","toLeaf","walk","walkerFn","startNode","callbacks","endNode","skipStart","next","isCefNode","stopWalking","cef","boundary","collectTextToBoundary","section","rootNode","forwards","rootBlock","getParent","walker","prev","collect","sections","current","finishSection","collectRangeSections","rng","start","startContainer","startOffset","end","endContainer","endOffset","commonAncestorContainer","e","ceTrueNode","fromRng","collapsed","fromNode","createRng","selectNode","fromNodes","nodes","find$2","pattern","finish","regex","lastIndex","results","exec","matchedText","matchIndex","matchStart","index","indexOf","matchFinish","extract","matches","nodePositions","content","last","positions","matchIdx","Math","max","min","matchId","concat","position","find$1","join","mark","replacementNode","idx","pos","cloneNode","textNode","splitText","matchNode","findAndMark","textSections","findAndMarkInSelection","selection","bookmark","getBookmark","select","getRng","moveToBookmark","getElmIndex","elm","getAttribute","markAllMatches","editor","currentSearchState","inSelection","create","className","getBody","done","unwrap","firstChild","removeChild","findSpansByIndex","spans","getElementsByTagName","nodeIndex","moveSelection","forward","searchState","testIndex","count","removeClass","addClass","scrollIntoView","removeNode","remove","isEmpty","escapeSearchText","wholeWord","escapedText","replace","wordRegex","find","matchCase","isForwardSelection","isForward","RegExp","browser","isSafari","setRng","newIndex","isMatchSpan","currentIndex","currentMatchIndex","nextIndex","grep","parseInt","keepEditorSelection","setStart","setEnd","data","hasNext","hasPrev","currentState","done$1","next$1","prev$1","replace$1","singleton","doRevoke","subject","revoke","clear","isSet","on","open","dialogApi","undoManager","add","selectedText","trim","getContent","format","updateButtonStates","updateNext","enable","disable","updatePrev","updateSearchState","getData","matchcase","wholewords","inselection","disableAll","buttons","toggle","notFoundAlert","windowManager","alert","focus","focusButtonIfRequired","deviceType","isTouch","reset","doFind","findtext","initialState","initialData","replacetext","spec","title","size","body","items","placeholder","maximized","inputMode","icon","disabled","borderless","tooltip","align","primary","onChange","details","onAction","onSubmit","onClose","inline","register$1","addCommand","showDialog","register","ui","registry","addMenuItem","shortcut","addButton","shortcuts","Plugin"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.10.2 (2021-11-17)\n */\n(function () {\n    'use strict';\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n\n    var typeOf = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType$1 = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var isString = isType$1('string');\n    var isArray = isType$1('array');\n    var isBoolean = isSimpleType('boolean');\n    var isNumber = isSimpleType('number');\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var punctuationStr = '[!-#%-*,-\\\\/:;?@\\\\[-\\\\]_{}\\xA1\\xAB\\xB7\\xBB\\xBF;\\xB7\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1361-\\u1368\\u1400\\u166D\\u166E\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CD3\\u2010-\\u2027\\u2030-\\u2043\\u2045-\\u2051\\u2053-\\u205E\\u207D\\u207E\\u208D\\u208E\\u3008\\u3009\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30\\u2E31\\u3001-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uff3f\\uFF5B\\uFF5D\\uFF5F-\\uFF65]';\n\n    var punctuation$1 = constant(punctuationStr);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = identity;\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: function () {\n          return none();\n        },\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var punctuation = punctuation$1;\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var nativeSlice = Array.prototype.slice;\n    var nativePush = Array.prototype.push;\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var groupBy = function (xs, f) {\n      if (xs.length === 0) {\n        return [];\n      } else {\n        var wasType = f(xs[0]);\n        var r = [];\n        var group = [];\n        for (var i = 0, len = xs.length; i < len; i++) {\n          var x = xs[i];\n          var type = f(x);\n          if (type !== wasType) {\n            r.push(group);\n            group = [];\n          }\n          wasType = type;\n          group.push(x);\n        }\n        if (group.length !== 0) {\n          r.push(group);\n        }\n        return r;\n      }\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x, i) {\n        acc = f(acc, x, i);\n      });\n      return acc;\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      return flatten(map(xs, f));\n    };\n    var sort = function (xs, comparator) {\n      var copy = nativeSlice.call(xs, 0);\n      copy.sort(comparator);\n      return copy;\n    };\n\n    var hasOwnProperty = Object.hasOwnProperty;\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n\n    typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var DOCUMENT = 9;\n    var DOCUMENT_FRAGMENT = 11;\n    var ELEMENT = 1;\n    var TEXT = 3;\n\n    var type = function (element) {\n      return element.dom.nodeType;\n    };\n    var isType = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isText$1 = isType(TEXT);\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set = function (element, key, value) {\n      rawSet(element.dom, key, value);\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionPreceding = function (a, b) {\n      return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_PRECEDING);\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), SugarElement.fromDom);\n    };\n\n    var parent = function (element) {\n      return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n    };\n    var children = function (element) {\n      return map(element.dom.childNodes, SugarElement.fromDom);\n    };\n    var spot = function (element, offset) {\n      return {\n        element: element,\n        offset: offset\n      };\n    };\n    var leaf = function (element, offset) {\n      var cs = children(element);\n      return cs.length > 0 && offset < cs.length ? spot(cs[offset], 0) : spot(element, offset);\n    };\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom.insertBefore(element.dom, marker.dom);\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom.appendChild(element.dom);\n    };\n    var wrap = function (element, wrapper) {\n      before(element, wrapper);\n      append(wrapper, element);\n    };\n\n    var NodeValue = function (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom.nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    };\n\n    var api = NodeValue(isText$1, 'text');\n    var get$1 = function (element) {\n      return api.get(element);\n    };\n\n    var descendants = function (scope, selector) {\n      return all(selector, scope);\n    };\n\n    var global = tinymce.util.Tools.resolve('tinymce.dom.TreeWalker');\n\n    var isSimpleBoundary = function (dom, node) {\n      return dom.isBlock(node) || has(dom.schema.getShortEndedElements(), node.nodeName);\n    };\n    var isContentEditableFalse = function (dom, node) {\n      return dom.getContentEditable(node) === 'false';\n    };\n    var isContentEditableTrueInCef = function (dom, node) {\n      return dom.getContentEditable(node) === 'true' && dom.getContentEditableParent(node.parentNode) === 'false';\n    };\n    var isHidden = function (dom, node) {\n      return !dom.isBlock(node) && has(dom.schema.getWhiteSpaceElements(), node.nodeName);\n    };\n    var isBoundary = function (dom, node) {\n      return isSimpleBoundary(dom, node) || isContentEditableFalse(dom, node) || isHidden(dom, node) || isContentEditableTrueInCef(dom, node);\n    };\n    var isText = function (node) {\n      return node.nodeType === 3;\n    };\n    var nuSection = function () {\n      return {\n        sOffset: 0,\n        fOffset: 0,\n        elements: []\n      };\n    };\n    var toLeaf = function (node, offset) {\n      return leaf(SugarElement.fromDom(node), offset);\n    };\n    var walk = function (dom, walkerFn, startNode, callbacks, endNode, skipStart) {\n      if (skipStart === void 0) {\n        skipStart = true;\n      }\n      var next = skipStart ? walkerFn(false) : startNode;\n      while (next) {\n        var isCefNode = isContentEditableFalse(dom, next);\n        if (isCefNode || isHidden(dom, next)) {\n          var stopWalking = isCefNode ? callbacks.cef(next) : callbacks.boundary(next);\n          if (stopWalking) {\n            break;\n          } else {\n            next = walkerFn(true);\n            continue;\n          }\n        } else if (isSimpleBoundary(dom, next)) {\n          if (callbacks.boundary(next)) {\n            break;\n          }\n        } else if (isText(next)) {\n          callbacks.text(next);\n        }\n        if (next === endNode) {\n          break;\n        } else {\n          next = walkerFn(false);\n        }\n      }\n    };\n    var collectTextToBoundary = function (dom, section, node, rootNode, forwards) {\n      if (isBoundary(dom, node)) {\n        return;\n      }\n      var rootBlock = dom.getParent(rootNode, dom.isBlock);\n      var walker = new global(node, rootBlock);\n      var walkerFn = forwards ? walker.next.bind(walker) : walker.prev.bind(walker);\n      walk(dom, walkerFn, node, {\n        boundary: always,\n        cef: always,\n        text: function (next) {\n          if (forwards) {\n            section.fOffset += next.length;\n          } else {\n            section.sOffset += next.length;\n          }\n          section.elements.push(SugarElement.fromDom(next));\n        }\n      });\n    };\n    var collect = function (dom, rootNode, startNode, endNode, callbacks, skipStart) {\n      if (skipStart === void 0) {\n        skipStart = true;\n      }\n      var walker = new global(startNode, rootNode);\n      var sections = [];\n      var current = nuSection();\n      collectTextToBoundary(dom, current, startNode, rootNode, false);\n      var finishSection = function () {\n        if (current.elements.length > 0) {\n          sections.push(current);\n          current = nuSection();\n        }\n        return false;\n      };\n      walk(dom, walker.next.bind(walker), startNode, {\n        boundary: finishSection,\n        cef: function (node) {\n          finishSection();\n          if (callbacks) {\n            sections.push.apply(sections, callbacks.cef(node));\n          }\n          return false;\n        },\n        text: function (next) {\n          current.elements.push(SugarElement.fromDom(next));\n          if (callbacks) {\n            callbacks.text(next, current);\n          }\n        }\n      }, endNode, skipStart);\n      if (endNode) {\n        collectTextToBoundary(dom, current, endNode, rootNode, true);\n      }\n      finishSection();\n      return sections;\n    };\n    var collectRangeSections = function (dom, rng) {\n      var start = toLeaf(rng.startContainer, rng.startOffset);\n      var startNode = start.element.dom;\n      var end = toLeaf(rng.endContainer, rng.endOffset);\n      var endNode = end.element.dom;\n      return collect(dom, rng.commonAncestorContainer, startNode, endNode, {\n        text: function (node, section) {\n          if (node === endNode) {\n            section.fOffset += node.length - end.offset;\n          } else if (node === startNode) {\n            section.sOffset += start.offset;\n          }\n        },\n        cef: function (node) {\n          var sections = bind(descendants(SugarElement.fromDom(node), '*[contenteditable=true]'), function (e) {\n            var ceTrueNode = e.dom;\n            return collect(dom, ceTrueNode, ceTrueNode);\n          });\n          return sort(sections, function (a, b) {\n            return documentPositionPreceding(a.elements[0].dom, b.elements[0].dom) ? 1 : -1;\n          });\n        }\n      }, false);\n    };\n    var fromRng = function (dom, rng) {\n      return rng.collapsed ? [] : collectRangeSections(dom, rng);\n    };\n    var fromNode = function (dom, node) {\n      var rng = dom.createRng();\n      rng.selectNode(node);\n      return fromRng(dom, rng);\n    };\n    var fromNodes = function (dom, nodes) {\n      return bind(nodes, function (node) {\n        return fromNode(dom, node);\n      });\n    };\n\n    var find$2 = function (text, pattern, start, finish) {\n      if (start === void 0) {\n        start = 0;\n      }\n      if (finish === void 0) {\n        finish = text.length;\n      }\n      var regex = pattern.regex;\n      regex.lastIndex = start;\n      var results = [];\n      var match;\n      while (match = regex.exec(text)) {\n        var matchedText = match[pattern.matchIndex];\n        var matchStart = match.index + match[0].indexOf(matchedText);\n        var matchFinish = matchStart + matchedText.length;\n        if (matchFinish > finish) {\n          break;\n        }\n        results.push({\n          start: matchStart,\n          finish: matchFinish\n        });\n        regex.lastIndex = matchFinish;\n      }\n      return results;\n    };\n    var extract = function (elements, matches) {\n      var nodePositions = foldl(elements, function (acc, element) {\n        var content = get$1(element);\n        var start = acc.last;\n        var finish = start + content.length;\n        var positions = bind(matches, function (match, matchIdx) {\n          if (match.start < finish && match.finish > start) {\n            return [{\n                element: element,\n                start: Math.max(start, match.start) - start,\n                finish: Math.min(finish, match.finish) - start,\n                matchId: matchIdx\n              }];\n          } else {\n            return [];\n          }\n        });\n        return {\n          results: acc.results.concat(positions),\n          last: finish\n        };\n      }, {\n        results: [],\n        last: 0\n      }).results;\n      return groupBy(nodePositions, function (position) {\n        return position.matchId;\n      });\n    };\n\n    var find$1 = function (pattern, sections) {\n      return bind(sections, function (section) {\n        var elements = section.elements;\n        var content = map(elements, get$1).join('');\n        var positions = find$2(content, pattern, section.sOffset, content.length - section.fOffset);\n        return extract(elements, positions);\n      });\n    };\n    var mark = function (matches, replacementNode) {\n      eachr(matches, function (match, idx) {\n        eachr(match, function (pos) {\n          var wrapper = SugarElement.fromDom(replacementNode.cloneNode(false));\n          set(wrapper, 'data-mce-index', idx);\n          var textNode = pos.element.dom;\n          if (textNode.length === pos.finish && pos.start === 0) {\n            wrap(pos.element, wrapper);\n          } else {\n            if (textNode.length !== pos.finish) {\n              textNode.splitText(pos.finish);\n            }\n            var matchNode = textNode.splitText(pos.start);\n            wrap(SugarElement.fromDom(matchNode), wrapper);\n          }\n        });\n      });\n    };\n    var findAndMark = function (dom, pattern, node, replacementNode) {\n      var textSections = fromNode(dom, node);\n      var matches = find$1(pattern, textSections);\n      mark(matches, replacementNode);\n      return matches.length;\n    };\n    var findAndMarkInSelection = function (dom, pattern, selection, replacementNode) {\n      var bookmark = selection.getBookmark();\n      var nodes = dom.select('td[data-mce-selected],th[data-mce-selected]');\n      var textSections = nodes.length > 0 ? fromNodes(dom, nodes) : fromRng(dom, selection.getRng());\n      var matches = find$1(pattern, textSections);\n      mark(matches, replacementNode);\n      selection.moveToBookmark(bookmark);\n      return matches.length;\n    };\n\n    var getElmIndex = function (elm) {\n      var value = elm.getAttribute('data-mce-index');\n      if (typeof value === 'number') {\n        return '' + value;\n      }\n      return value;\n    };\n    var markAllMatches = function (editor, currentSearchState, pattern, inSelection) {\n      var marker = editor.dom.create('span', { 'data-mce-bogus': 1 });\n      marker.className = 'mce-match-marker';\n      var node = editor.getBody();\n      done(editor, currentSearchState, false);\n      if (inSelection) {\n        return findAndMarkInSelection(editor.dom, pattern, editor.selection, marker);\n      } else {\n        return findAndMark(editor.dom, pattern, node, marker);\n      }\n    };\n    var unwrap = function (node) {\n      var parentNode = node.parentNode;\n      if (node.firstChild) {\n        parentNode.insertBefore(node.firstChild, node);\n      }\n      node.parentNode.removeChild(node);\n    };\n    var findSpansByIndex = function (editor, index) {\n      var spans = [];\n      var nodes = global$1.toArray(editor.getBody().getElementsByTagName('span'));\n      if (nodes.length) {\n        for (var i = 0; i < nodes.length; i++) {\n          var nodeIndex = getElmIndex(nodes[i]);\n          if (nodeIndex === null || !nodeIndex.length) {\n            continue;\n          }\n          if (nodeIndex === index.toString()) {\n            spans.push(nodes[i]);\n          }\n        }\n      }\n      return spans;\n    };\n    var moveSelection = function (editor, currentSearchState, forward) {\n      var searchState = currentSearchState.get();\n      var testIndex = searchState.index;\n      var dom = editor.dom;\n      forward = forward !== false;\n      if (forward) {\n        if (testIndex + 1 === searchState.count) {\n          testIndex = 0;\n        } else {\n          testIndex++;\n        }\n      } else {\n        if (testIndex - 1 === -1) {\n          testIndex = searchState.count - 1;\n        } else {\n          testIndex--;\n        }\n      }\n      dom.removeClass(findSpansByIndex(editor, searchState.index), 'mce-match-marker-selected');\n      var spans = findSpansByIndex(editor, testIndex);\n      if (spans.length) {\n        dom.addClass(findSpansByIndex(editor, testIndex), 'mce-match-marker-selected');\n        editor.selection.scrollIntoView(spans[0]);\n        return testIndex;\n      }\n      return -1;\n    };\n    var removeNode = function (dom, node) {\n      var parent = node.parentNode;\n      dom.remove(node);\n      if (dom.isEmpty(parent)) {\n        dom.remove(parent);\n      }\n    };\n    var escapeSearchText = function (text, wholeWord) {\n      var escapedText = text.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&').replace(/\\s/g, '[^\\\\S\\\\r\\\\n\\\\uFEFF]');\n      var wordRegex = '(' + escapedText + ')';\n      return wholeWord ? '(?:^|\\\\s|' + punctuation() + ')' + wordRegex + ('(?=$|\\\\s|' + punctuation() + ')') : wordRegex;\n    };\n    var find = function (editor, currentSearchState, text, matchCase, wholeWord, inSelection) {\n      var selection = editor.selection;\n      var escapedText = escapeSearchText(text, wholeWord);\n      var isForwardSelection = selection.isForward();\n      var pattern = {\n        regex: new RegExp(escapedText, matchCase ? 'g' : 'gi'),\n        matchIndex: 1\n      };\n      var count = markAllMatches(editor, currentSearchState, pattern, inSelection);\n      if (global$2.browser.isSafari()) {\n        selection.setRng(selection.getRng(), isForwardSelection);\n      }\n      if (count) {\n        var newIndex = moveSelection(editor, currentSearchState, true);\n        currentSearchState.set({\n          index: newIndex,\n          count: count,\n          text: text,\n          matchCase: matchCase,\n          wholeWord: wholeWord,\n          inSelection: inSelection\n        });\n      }\n      return count;\n    };\n    var next = function (editor, currentSearchState) {\n      var index = moveSelection(editor, currentSearchState, true);\n      currentSearchState.set(__assign(__assign({}, currentSearchState.get()), { index: index }));\n    };\n    var prev = function (editor, currentSearchState) {\n      var index = moveSelection(editor, currentSearchState, false);\n      currentSearchState.set(__assign(__assign({}, currentSearchState.get()), { index: index }));\n    };\n    var isMatchSpan = function (node) {\n      var matchIndex = getElmIndex(node);\n      return matchIndex !== null && matchIndex.length > 0;\n    };\n    var replace = function (editor, currentSearchState, text, forward, all) {\n      var searchState = currentSearchState.get();\n      var currentIndex = searchState.index;\n      var currentMatchIndex, nextIndex = currentIndex;\n      forward = forward !== false;\n      var node = editor.getBody();\n      var nodes = global$1.grep(global$1.toArray(node.getElementsByTagName('span')), isMatchSpan);\n      for (var i = 0; i < nodes.length; i++) {\n        var nodeIndex = getElmIndex(nodes[i]);\n        var matchIndex = currentMatchIndex = parseInt(nodeIndex, 10);\n        if (all || matchIndex === searchState.index) {\n          if (text.length) {\n            nodes[i].firstChild.nodeValue = text;\n            unwrap(nodes[i]);\n          } else {\n            removeNode(editor.dom, nodes[i]);\n          }\n          while (nodes[++i]) {\n            matchIndex = parseInt(getElmIndex(nodes[i]), 10);\n            if (matchIndex === currentMatchIndex) {\n              removeNode(editor.dom, nodes[i]);\n            } else {\n              i--;\n              break;\n            }\n          }\n          if (forward) {\n            nextIndex--;\n          }\n        } else if (currentMatchIndex > currentIndex) {\n          nodes[i].setAttribute('data-mce-index', String(currentMatchIndex - 1));\n        }\n      }\n      currentSearchState.set(__assign(__assign({}, searchState), {\n        count: all ? 0 : searchState.count - 1,\n        index: nextIndex\n      }));\n      if (forward) {\n        next(editor, currentSearchState);\n      } else {\n        prev(editor, currentSearchState);\n      }\n      return !all && currentSearchState.get().count > 0;\n    };\n    var done = function (editor, currentSearchState, keepEditorSelection) {\n      var startContainer, endContainer;\n      var searchState = currentSearchState.get();\n      var nodes = global$1.toArray(editor.getBody().getElementsByTagName('span'));\n      for (var i = 0; i < nodes.length; i++) {\n        var nodeIndex = getElmIndex(nodes[i]);\n        if (nodeIndex !== null && nodeIndex.length) {\n          if (nodeIndex === searchState.index.toString()) {\n            if (!startContainer) {\n              startContainer = nodes[i].firstChild;\n            }\n            endContainer = nodes[i].firstChild;\n          }\n          unwrap(nodes[i]);\n        }\n      }\n      currentSearchState.set(__assign(__assign({}, searchState), {\n        index: -1,\n        count: 0,\n        text: ''\n      }));\n      if (startContainer && endContainer) {\n        var rng = editor.dom.createRng();\n        rng.setStart(startContainer, 0);\n        rng.setEnd(endContainer, endContainer.data.length);\n        if (keepEditorSelection !== false) {\n          editor.selection.setRng(rng);\n        }\n        return rng;\n      }\n    };\n    var hasNext = function (editor, currentSearchState) {\n      return currentSearchState.get().count > 1;\n    };\n    var hasPrev = function (editor, currentSearchState) {\n      return currentSearchState.get().count > 1;\n    };\n\n    var get = function (editor, currentState) {\n      var done$1 = function (keepEditorSelection) {\n        return done(editor, currentState, keepEditorSelection);\n      };\n      var find$1 = function (text, matchCase, wholeWord, inSelection) {\n        if (inSelection === void 0) {\n          inSelection = false;\n        }\n        return find(editor, currentState, text, matchCase, wholeWord, inSelection);\n      };\n      var next$1 = function () {\n        return next(editor, currentState);\n      };\n      var prev$1 = function () {\n        return prev(editor, currentState);\n      };\n      var replace$1 = function (text, forward, all) {\n        return replace(editor, currentState, text, forward, all);\n      };\n      return {\n        done: done$1,\n        find: find$1,\n        next: next$1,\n        prev: prev$1,\n        replace: replace$1\n      };\n    };\n\n    var singleton = function (doRevoke) {\n      var subject = Cell(Optional.none());\n      var revoke = function () {\n        return subject.get().each(doRevoke);\n      };\n      var clear = function () {\n        revoke();\n        subject.set(Optional.none());\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      var get = function () {\n        return subject.get();\n      };\n      var set = function (s) {\n        revoke();\n        subject.set(Optional.some(s));\n      };\n      return {\n        clear: clear,\n        isSet: isSet,\n        get: get,\n        set: set\n      };\n    };\n    var value = function () {\n      var subject = singleton(noop);\n      var on = function (f) {\n        return subject.get().each(f);\n      };\n      return __assign(__assign({}, subject), { on: on });\n    };\n\n    var open = function (editor, currentSearchState) {\n      var dialogApi = value();\n      editor.undoManager.add();\n      var selectedText = global$1.trim(editor.selection.getContent({ format: 'text' }));\n      var updateButtonStates = function (api) {\n        var updateNext = hasNext(editor, currentSearchState) ? api.enable : api.disable;\n        updateNext('next');\n        var updatePrev = hasPrev(editor, currentSearchState) ? api.enable : api.disable;\n        updatePrev('prev');\n      };\n      var updateSearchState = function (api) {\n        var data = api.getData();\n        var current = currentSearchState.get();\n        currentSearchState.set(__assign(__assign({}, current), {\n          matchCase: data.matchcase,\n          wholeWord: data.wholewords,\n          inSelection: data.inselection\n        }));\n      };\n      var disableAll = function (api, disable) {\n        var buttons = [\n          'replace',\n          'replaceall',\n          'prev',\n          'next'\n        ];\n        var toggle = disable ? api.disable : api.enable;\n        each(buttons, toggle);\n      };\n      var notFoundAlert = function (api) {\n        editor.windowManager.alert('Could not find the specified string.', function () {\n          api.focus('findtext');\n        });\n      };\n      var focusButtonIfRequired = function (api, name) {\n        if (global$2.browser.isSafari() && global$2.deviceType.isTouch() && (name === 'find' || name === 'replace' || name === 'replaceall')) {\n          api.focus(name);\n        }\n      };\n      var reset = function (api) {\n        done(editor, currentSearchState, false);\n        disableAll(api, true);\n        updateButtonStates(api);\n      };\n      var doFind = function (api) {\n        var data = api.getData();\n        var last = currentSearchState.get();\n        if (!data.findtext.length) {\n          reset(api);\n          return;\n        }\n        if (last.text === data.findtext && last.matchCase === data.matchcase && last.wholeWord === data.wholewords) {\n          next(editor, currentSearchState);\n        } else {\n          var count = find(editor, currentSearchState, data.findtext, data.matchcase, data.wholewords, data.inselection);\n          if (count <= 0) {\n            notFoundAlert(api);\n          }\n          disableAll(api, count === 0);\n        }\n        updateButtonStates(api);\n      };\n      var initialState = currentSearchState.get();\n      var initialData = {\n        findtext: selectedText,\n        replacetext: '',\n        wholewords: initialState.wholeWord,\n        matchcase: initialState.matchCase,\n        inselection: initialState.inSelection\n      };\n      var spec = {\n        title: 'Find and Replace',\n        size: 'normal',\n        body: {\n          type: 'panel',\n          items: [\n            {\n              type: 'bar',\n              items: [\n                {\n                  type: 'input',\n                  name: 'findtext',\n                  placeholder: 'Find',\n                  maximized: true,\n                  inputMode: 'search'\n                },\n                {\n                  type: 'button',\n                  name: 'prev',\n                  text: 'Previous',\n                  icon: 'action-prev',\n                  disabled: true,\n                  borderless: true\n                },\n                {\n                  type: 'button',\n                  name: 'next',\n                  text: 'Next',\n                  icon: 'action-next',\n                  disabled: true,\n                  borderless: true\n                }\n              ]\n            },\n            {\n              type: 'input',\n              name: 'replacetext',\n              placeholder: 'Replace with',\n              inputMode: 'search'\n            }\n          ]\n        },\n        buttons: [\n          {\n            type: 'menu',\n            name: 'options',\n            icon: 'preferences',\n            tooltip: 'Preferences',\n            align: 'start',\n            items: [\n              {\n                type: 'togglemenuitem',\n                name: 'matchcase',\n                text: 'Match case'\n              },\n              {\n                type: 'togglemenuitem',\n                name: 'wholewords',\n                text: 'Find whole words only'\n              },\n              {\n                type: 'togglemenuitem',\n                name: 'inselection',\n                text: 'Find in selection'\n              }\n            ]\n          },\n          {\n            type: 'custom',\n            name: 'find',\n            text: 'Find',\n            primary: true\n          },\n          {\n            type: 'custom',\n            name: 'replace',\n            text: 'Replace',\n            disabled: true\n          },\n          {\n            type: 'custom',\n            name: 'replaceall',\n            text: 'Replace all',\n            disabled: true\n          }\n        ],\n        initialData: initialData,\n        onChange: function (api, details) {\n          if (details.name === 'findtext' && currentSearchState.get().count > 0) {\n            reset(api);\n          }\n        },\n        onAction: function (api, details) {\n          var data = api.getData();\n          switch (details.name) {\n          case 'find':\n            doFind(api);\n            break;\n          case 'replace':\n            if (!replace(editor, currentSearchState, data.replacetext)) {\n              reset(api);\n            } else {\n              updateButtonStates(api);\n            }\n            break;\n          case 'replaceall':\n            replace(editor, currentSearchState, data.replacetext, true, true);\n            reset(api);\n            break;\n          case 'prev':\n            prev(editor, currentSearchState);\n            updateButtonStates(api);\n            break;\n          case 'next':\n            next(editor, currentSearchState);\n            updateButtonStates(api);\n            break;\n          case 'matchcase':\n          case 'wholewords':\n          case 'inselection':\n            updateSearchState(api);\n            reset(api);\n            break;\n          }\n          focusButtonIfRequired(api, details.name);\n        },\n        onSubmit: function (api) {\n          doFind(api);\n          focusButtonIfRequired(api, 'find');\n        },\n        onClose: function () {\n          editor.focus();\n          done(editor, currentSearchState);\n          editor.undoManager.add();\n        }\n      };\n      dialogApi.set(editor.windowManager.open(spec, { inline: 'toolbar' }));\n    };\n\n    var register$1 = function (editor, currentSearchState) {\n      editor.addCommand('SearchReplace', function () {\n        open(editor, currentSearchState);\n      });\n    };\n\n    var showDialog = function (editor, currentSearchState) {\n      return function () {\n        open(editor, currentSearchState);\n      };\n    };\n    var register = function (editor, currentSearchState) {\n      editor.ui.registry.addMenuItem('searchreplace', {\n        text: 'Find and replace...',\n        shortcut: 'Meta+F',\n        onAction: showDialog(editor, currentSearchState),\n        icon: 'search'\n      });\n      editor.ui.registry.addButton('searchreplace', {\n        tooltip: 'Find and replace',\n        onAction: showDialog(editor, currentSearchState),\n        icon: 'search'\n      });\n      editor.shortcuts.add('Meta+F', '', showDialog(editor, currentSearchState));\n    };\n\n    function Plugin () {\n      global$3.add('searchreplace', function (editor) {\n        var currentSearchState = Cell({\n          index: -1,\n          count: 0,\n          text: '',\n          matchCase: false,\n          wholeWord: false,\n          inSelection: false\n        });\n        register$1(editor, currentSearchState);\n        register(editor, currentSearchState);\n        return get(editor, currentSearchState);\n      });\n    }\n\n    Plugin();\n\n}());\n"]},"metadata":{},"sourceType":"script"}