{"ast":null,"code":"var _jsxFileName = \"/opt/bitnami/apache/htdocs/converzee-frontend/src/components/pages/tools/AutoplayVideo/index.js\";\nimport React, { Component } from \"react\";\nimport SideBar from \"./SideBar\";\nimport ToolUtil, { generateIframeContant, getDefaultItems } from \"../../../../utils/ToolUtil\";\nimport Util, { generateFile, parseImgUrl } from \"../../../Util\";\nimport Text from \"./Text\";\nimport Script from \"./Script\";\nimport { ToolLayout, ButtonsGroup } from \"../../../layout/ToolLayout\";\nimport { getPath, GET_PIXEL, SAVE_TOOL, GET_ONE_TOOL } from \"../../../../actions/URLs\";\nimport RequestHandler from \"../../../../actions/RequestHandler\";\nimport { Modal } from \"antd\";\nimport { LayoutSelector } from \"../../../layout/LayoutSelector\";\nimport Code from \"./Code\";\nimport { autoplayVideoModalResponse, autoplayVideoModal } from \"../../../utils/Modal\";\nimport Preview from \"./Preview\";\nimport { ReponsiveImage } from \"../../../comman/PreviewAble\";\nimport Video from \"./Video\";\nimport Image from \"../VideoPopup/Image\";\nimport Icons from \"./Icons\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class OptinForm extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      video: {\n        url: \"\",\n        videoType: \"youtube\"\n      },\n      toolName: \"\",\n      toolId: \"\",\n      preview: false,\n      _id: null,\n      activeTab: 1,\n      image: \"\",\n      toolData: {\n        text: 'Click for sound'\n      },\n      STYLE: {\n        elements: [{\n          name: \"background\",\n          text: \"Video Background\",\n          color: \"\"\n        }],\n        switchElement: false,\n        selected: 0\n      },\n      CODE: {\n        include: [{\n          type: \"contains\",\n          url: \"\"\n        }],\n        exclude: [{\n          type: \"contains\",\n          url: null\n        }]\n      },\n      icons: \"/asset/play_icon.gif\"\n    };\n    this.loaded = false;\n\n    this.onVideoChange = switchElement => {\n      this.setState({\n        STYLE: {\n          switchElement\n        }\n      });\n    };\n\n    this.onChangeActive = tabIndex => {\n      const {\n        activeTab\n      } = this.state;\n\n      if (activeTab !== tabIndex) {\n        this.setState({\n          activeTab: tabIndex\n        });\n      }\n    };\n\n    this.onUpdate = (index, data) => {\n      switch (index) {\n        case 1:\n          this.setState({\n            toolData: {\n              text: data\n            }\n          });\n          break;\n\n        case 2:\n          this.setState({\n            video: data\n          });\n          break;\n\n        case 3:\n          this.setState({\n            icons: data\n          });\n          break;\n\n        case 5:\n          this.setState({\n            image: data\n          });\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    this.codeUpdate = data => {\n      this.setState({\n        CODE: data\n      });\n    };\n\n    this.renderMain = () => {\n      const {\n        activeTab,\n        toolData,\n        CODE,\n        video,\n        STYLE,\n        image,\n        icons\n      } = this.state;\n      let component = null;\n      if (!this.loaded) return null;\n\n      switch (activeTab) {\n        case 1:\n          component = /*#__PURE__*/_jsxDEV(Video, { ...video,\n            onVideoChange: this.onVideoChange,\n            switchElement: STYLE.switchElement,\n            onChange: this.onUpdate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 25\n          }, this);\n          break;\n\n        case 2:\n          component = /*#__PURE__*/_jsxDEV(Image, {\n            image: image,\n            case: 5,\n            onChange: this.onUpdate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 25\n          }, this);\n          break;\n\n        case 3:\n          component = /*#__PURE__*/_jsxDEV(Icons, {\n            icons: icons,\n            case: 3,\n            onChange: this.onUpdate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 25\n          }, this);\n          break;\n\n        case 4:\n          component = /*#__PURE__*/_jsxDEV(Text, {\n            text: toolData.text,\n            case: 1,\n            onChange: this.onUpdate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 25\n          }, this);\n          break;\n\n        case 5:\n          component = /*#__PURE__*/_jsxDEV(Script, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 25\n          }, this);\n          break;\n\n        default:\n          component = /*#__PURE__*/_jsxDEV(Code, { ...CODE,\n            onChange: this.codeUpdate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 25\n          }, this);\n          break;\n      }\n\n      return component;\n    };\n\n    this.onClickSave = () => {\n      if (this.state.CODE.include[0].url !== \"\") {\n        if (this.state.video.url !== \"\") {\n          var pattern = new RegExp('^(https?:\\\\/\\\\/)?' + // protocol\n          '((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|' + // domain name\n          '((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))' + // OR ip (v4) address\n          '(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*' + // port and path\n          '(\\\\?[;&a-z\\\\d%_.~+=-]*)?' + // query string\n          '(\\\\#[-a-z\\\\d_]*)?$', 'i'); // fragment locator\n\n          if (pattern.test(this.state.video.url)) {\n            RequestHandler.PostRequest(SAVE_TOOL, {\n              toolData: autoplayVideoModal(this.state)\n            }, (res, err) => {\n              if (res) {\n                const data1 = res.data;\n\n                if (data1.success) {\n                  if (data1.script) {\n                    window.gs.setScript(data1.script);\n                  } else {\n                    Modal.success({\n                      content: data1.message\n                    });\n                  }\n\n                  setTimeout(() => {\n                    this.props.history.push(\"/Campaigns\");\n                  }, 1000);\n                }\n              }\n            });\n          } else {\n            Modal.warning({\n              content: \"Video URL should be url.\"\n            });\n          }\n        } else {\n          Modal.warning({\n            content: \"Please add video url.\"\n          });\n        }\n      } else {\n        Modal.warning({\n          content: \"Should Contain atleast one trigger point\"\n        });\n      }\n    };\n\n    this.back = () => {\n      this.props.history.push(\"/Create\");\n    };\n\n    this.togglePreview = () => {\n      const {\n        preview\n      } = this.state;\n      this.setState({\n        preview: !preview\n      });\n    };\n\n    this.renderRight = () => {\n      const {\n        activeTab,\n        image,\n        video\n      } = this.state;\n      if (activeTab === 1 && video.url) return /*#__PURE__*/_jsxDEV(ReponsiveImage, {\n        isVideo: true,\n        url: video.url\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 46\n      }, this);\n      if (activeTab === 2 && image) return /*#__PURE__*/_jsxDEV(ReponsiveImage, {\n        isImg: true,\n        url: \"https://d257yxqteot439.cloudfront.net/static/contains/\".concat(image)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 42\n      }, this);\n      return activeTab === 5 ? null : /*#__PURE__*/_jsxDEV(ReponsiveImage, {\n        isAs: true,\n        url: \"asset/video_pop_up.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 38\n      }, this);\n    };\n  }\n\n  componentWillMount() {\n    if (window.gs.ie) {\n      const ie = getDefaultItems(window.gs.ie);\n      let {\n        toolData\n      } = this.state;\n      this.state.toolData = { ...toolData,\n        ...ie\n      };\n      window.gs.ie = null;\n    }\n  }\n\n  componentDidMount() {\n    const id = this.props.match ? this.props.match.params ? this.props.match.params.id : null : null;\n\n    if (id) {\n      RequestHandler.PostRequest(GET_ONE_TOOL + id, {}, (res, err) => {\n        this.loaded = true;\n\n        if (res) {\n          Util.isRedirected = true;\n          const data = autoplayVideoModalResponse(res);\n\n          if (data) {\n            this.setState(data, () => {\n              window.gs.navTitle(ToolUtil.getTool(data.toolId) + \"  \" + \"(\" + data.name + \")\");\n            });\n          }\n        }\n      });\n    } else {\n      let toolId = 24;\n      this.loaded = true;\n      this.setState({\n        toolId: toolId,\n        toolName: ToolUtil.getTool(toolId),\n        name: Util.CAMPAIGNS_NAME\n      });\n      Util.RedirectWhenCampaignEmpty(this.props);\n      window.gs.navTitle(ToolUtil.getTool(toolId) + \"(\" + Util.CAMPAIGNS_NAME + \")\");\n    }\n  }\n\n  render() {\n    const {\n      preview,\n      video,\n      toolData,\n      activeTab\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(ToolLayout, {\n      children: [preview ? /*#__PURE__*/_jsxDEV(Preview, { ...this.state,\n        onClose: this.togglePreview\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 20\n      }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-10 toolItem\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: activeTab === 5 ? \"col-md-12\" : \"col-md-6\",\n              children: this.renderMain()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-md-6 mt-2\",\n              children: this.renderRight()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ButtonsGroup, {\n              preview: video.url != \"\" ? () => {\n                this.setState({\n                  preview: !preview\n                });\n              } : null,\n              backUrl: this.back,\n              save: this.onClickSave\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-1 sideBarButtomPanel\",\n          children: /*#__PURE__*/_jsxDEV(SideBar, {\n            layout: toolData.layout,\n            activeTab: activeTab,\n            onChangeActive: this.onChangeActive\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/opt/bitnami/apache/htdocs/converzee-frontend/src/components/pages/tools/AutoplayVideo/index.js"],"names":["React","Component","SideBar","ToolUtil","generateIframeContant","getDefaultItems","Util","generateFile","parseImgUrl","Text","Script","ToolLayout","ButtonsGroup","getPath","GET_PIXEL","SAVE_TOOL","GET_ONE_TOOL","RequestHandler","Modal","LayoutSelector","Code","autoplayVideoModalResponse","autoplayVideoModal","Preview","ReponsiveImage","Video","Image","Icons","OptinForm","state","video","url","videoType","toolName","toolId","preview","_id","activeTab","image","toolData","text","STYLE","elements","name","color","switchElement","selected","CODE","include","type","exclude","icons","loaded","onVideoChange","setState","onChangeActive","tabIndex","onUpdate","index","data","codeUpdate","renderMain","component","onClickSave","pattern","RegExp","test","PostRequest","res","err","data1","success","script","window","gs","setScript","content","message","setTimeout","props","history","push","warning","back","togglePreview","renderRight","componentWillMount","ie","componentDidMount","id","match","params","isRedirected","navTitle","getTool","CAMPAIGNS_NAME","RedirectWhenCampaignEmpty","render","layout"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport SideBar from \"./SideBar\";\r\nimport ToolUtil, { generateIframeContant, getDefaultItems } from \"../../../../utils/ToolUtil\";\r\nimport Util, { generateFile, parseImgUrl } from \"../../../Util\";\r\nimport Text from \"./Text\";\r\nimport Script from \"./Script\";\r\nimport { ToolLayout, ButtonsGroup } from \"../../../layout/ToolLayout\";\r\nimport { getPath, GET_PIXEL, SAVE_TOOL, GET_ONE_TOOL } from \"../../../../actions/URLs\";\r\nimport RequestHandler from \"../../../../actions/RequestHandler\";\r\nimport { Modal } from \"antd\";\r\nimport { LayoutSelector } from \"../../../layout/LayoutSelector\";\r\nimport Code from \"./Code\";\r\nimport { autoplayVideoModalResponse, autoplayVideoModal } from \"../../../utils/Modal\";\r\nimport Preview from \"./Preview\";\r\nimport { ReponsiveImage } from \"../../../comman/PreviewAble\";\r\nimport Video from \"./Video\";\r\nimport Image from \"../VideoPopup/Image\";\r\nimport Icons from \"./Icons\";\r\n\r\nexport default class OptinForm extends Component {\r\n  state = {\r\n    video: { url: \"\", videoType: \"youtube\" },\r\n    toolName: \"\",\r\n    toolId: \"\",\r\n    preview: false,\r\n    _id: null,\r\n    activeTab: 1,\r\n    image: \"\",\r\n    toolData: {\r\n      text: 'Click for sound',\r\n    },\r\n    STYLE: {\r\n        elements: [{ name: \"background\", text: \"Video Background\", color: \"\" }],\r\n        switchElement: false,\r\n        selected: 0,\r\n    },\r\n    CODE: { include: [{ type: \"contains\", url: \"\" }], exclude: [{ type: \"contains\", url: null }] },\r\n    icons: \"/asset/play_icon.gif\"\r\n  };\r\n  loaded = false;\r\n\r\n  componentWillMount() {\r\n    if (window.gs.ie) {\r\n      const ie = getDefaultItems(window.gs.ie);\r\n      let { toolData } = this.state;\r\n      this.state.toolData = { ...toolData, ...ie };\r\n      window.gs.ie = null;\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const id = this.props.match ? (this.props.match.params ? this.props.match.params.id : null) : null;\r\n    if (id) {\r\n      RequestHandler.PostRequest(GET_ONE_TOOL + id, {}, (res, err) => {\r\n        this.loaded = true;\r\n        if (res) {\r\n          Util.isRedirected = true;\r\n          const data = autoplayVideoModalResponse(res);\r\n          if (data) {\r\n            this.setState(data, () => {\r\n              window.gs.navTitle(ToolUtil.getTool(data.toolId) + \"  \" + \"(\" + data.name + \")\");\r\n            });\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      let toolId = 24; this.loaded = true;\r\n      this.setState({ toolId: toolId, toolName: ToolUtil.getTool(toolId), name: Util.CAMPAIGNS_NAME });\r\n      Util.RedirectWhenCampaignEmpty(this.props);\r\n      window.gs.navTitle(ToolUtil.getTool(toolId) + \"(\" + Util.CAMPAIGNS_NAME + \")\");\r\n    }\r\n\r\n  }\r\n\r\n  onVideoChange = (switchElement) => {\r\n    this.setState({ STYLE: { switchElement } });\r\n  };\r\n\r\n  onChangeActive = (tabIndex) => {\r\n    const { activeTab } = this.state;\r\n    if (activeTab !== tabIndex) {\r\n      this.setState({ activeTab: tabIndex });\r\n    }\r\n  };\r\n\r\n    onUpdate = (index, data) => {\r\n        switch (index) {\r\n        case 1:\r\n            this.setState({ toolData : { text: data} });\r\n            break;\r\n        case 2:\r\n            this.setState({ video: data });\r\n            break;\r\n        case 3:\r\n            this.setState({ icons: data });\r\n            break;\r\n        case 5:\r\n            this.setState({ image: data });\r\n            break;\r\n        default:\r\n            break;\r\n        }\r\n    };\r\n\r\n    codeUpdate = (data) => {\r\n      this.setState({ CODE: data });\r\n    }\r\n\r\n  renderMain = () => {\r\n    const { activeTab, toolData, CODE, video, STYLE, image, icons } = this.state;\r\n    let component = null;\r\n    if (!this.loaded) return null;\r\n    switch (activeTab) {\r\n        case 1:\r\n            component = <Video {...video} onVideoChange={this.onVideoChange} switchElement={STYLE.switchElement} onChange={this.onUpdate}/>;\r\n            break;\r\n        case 2:\r\n            component = <Image image={image} case={5} onChange={this.onUpdate} />;\r\n            break;\r\n        case 3:\r\n            component = <Icons icons={icons} case={3} onChange={this.onUpdate} />;\r\n            break;\r\n        case 4:\r\n            component = <Text text={toolData.text} case={1} onChange={this.onUpdate} />;\r\n            break;\r\n        case 5:\r\n            component = <Script />;\r\n            break;\r\n        default:\r\n            component = <Code {...CODE} onChange={this.codeUpdate} />\r\n            break;\r\n    }\r\n    return component;\r\n  };\r\n\r\n  onClickSave = () => {\r\n    if (this.state.CODE.include[0].url !== \"\") {\r\n      if(this.state.video.url !== \"\") {\r\n        var pattern = new RegExp('^(https?:\\\\/\\\\/)?'+ // protocol\r\n          '((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|'+ // domain name\r\n          '((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))'+ // OR ip (v4) address\r\n          '(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*'+ // port and path\r\n          '(\\\\?[;&a-z\\\\d%_.~+=-]*)?'+ // query string\r\n          '(\\\\#[-a-z\\\\d_]*)?$','i'); // fragment locator\r\n        if(pattern.test(this.state.video.url)) {\r\n          RequestHandler.PostRequest(SAVE_TOOL, { toolData: autoplayVideoModal(this.state) }, (res, err) => {\r\n            if (res) {\r\n              const data1 = res.data;\r\n              if (data1.success) {\r\n                if (data1.script) {\r\n                  window.gs.setScript(data1.script);\r\n                } else {\r\n                  Modal.success({\r\n                    content: data1.message,\r\n                  });\r\n                }\r\n                setTimeout(() => {\r\n                  this.props.history.push(\"/Campaigns\");\r\n                }, 1000);\r\n              }\r\n            }\r\n          });\r\n        } else {\r\n          Modal.warning({\r\n            content: \"Video URL should be url.\",\r\n          });\r\n        }\r\n      } else {\r\n        Modal.warning({\r\n          content: \"Please add video url.\",\r\n        });\r\n      }\r\n    } else {\r\n      Modal.warning({\r\n        content: \"Should Contain atleast one trigger point\",\r\n      });\r\n    }\r\n  };\r\n\r\n  back = () => {\r\n    this.props.history.push(\"/Create\");\r\n  };\r\n\r\n  togglePreview = () => {\r\n    const { preview } = this.state;\r\n    this.setState({ preview: !preview });\r\n  };\r\n\r\n  renderRight = () => {\r\n    const { activeTab, image, video } = this.state;\r\n    if (activeTab === 1 && video.url) return <ReponsiveImage isVideo={true} url={video.url} />;\r\n    if (activeTab === 2 && image) return <ReponsiveImage isImg={true} url={`https://d257yxqteot439.cloudfront.net/static/contains/${image}`} />;\r\n    return (activeTab === 5 ? null : <ReponsiveImage isAs={true} url={\"asset/video_pop_up.png\"} />);\r\n  };\r\n\r\n  render() {\r\n    const { preview, video, toolData, activeTab  } = this.state;\r\n    return (\r\n      <ToolLayout>\r\n        {preview ? <Preview {...this.state} onClose={this.togglePreview} /> : null}\r\n        <div className=\"row\">\r\n          <div className=\"col-10 toolItem\">\r\n            <div className=\"row\">\r\n              <div className={activeTab === 5 ? \"col-md-12\" : \"col-md-6\"}>{this.renderMain()}</div>\r\n              <div className=\"col-md-6 mt-2\">{this.renderRight()}</div>\r\n              <ButtonsGroup   \r\n               preview={ video.url!=\"\" ? () => {\r\n                this.setState({ preview: !preview });\r\n              } : null}\r\n              backUrl={this.back}\r\n              save={this.onClickSave} \r\n            />\r\n            </div>\r\n          </div>\r\n          <div className=\"col-1 sideBarButtomPanel\">\r\n            <SideBar layout={toolData.layout} activeTab={activeTab} onChangeActive={this.onChangeActive} />\r\n          </div>\r\n        </div>\r\n      </ToolLayout>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}