{"ast":null,"code":"/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.10.2 (2021-11-17)\n */\n(function () {\n  'use strict';\n\n  var global$7 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n  var global$6 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n  var typeOf = function (x) {\n    var t = typeof x;\n\n    if (x === null) {\n      return 'null';\n    } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    } else {\n      return t;\n    }\n  };\n\n  var isType = function (type) {\n    return function (value) {\n      return typeOf(value) === type;\n    };\n  };\n\n  var isSimpleType = function (type) {\n    return function (value) {\n      return typeof value === type;\n    };\n  };\n\n  var eq = function (t) {\n    return function (a) {\n      return t === a;\n    };\n  };\n\n  var isString = isType('string');\n  var isArray = isType('array');\n  var isNull = eq(null);\n  var isBoolean = isSimpleType('boolean');\n  var isFunction = isSimpleType('function');\n\n  var noop = function () {};\n\n  var constant = function (value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var identity = function (x) {\n    return x;\n  };\n\n  var tripleEquals = function (a, b) {\n    return a === b;\n  };\n\n  var never = constant(false);\n  var always = constant(true);\n\n  var none = function () {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var call = function (thunk) {\n      return thunk();\n    };\n\n    var id = identity;\n    var me = {\n      fold: function (n, _s) {\n        return n();\n      },\n      isSome: never,\n      isNone: always,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function (msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: constant(null),\n      getOrUndefined: constant(undefined),\n      or: id,\n      orThunk: call,\n      map: none,\n      each: noop,\n      bind: none,\n      exists: never,\n      forall: always,\n      filter: function () {\n        return none();\n      },\n      toArray: function () {\n        return [];\n      },\n      toString: constant('none()')\n    };\n    return me;\n  }();\n\n  var some = function (a) {\n    var constant_a = constant(a);\n\n    var self = function () {\n      return me;\n    };\n\n    var bind = function (f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function (n, s) {\n        return s(a);\n      },\n      isSome: always,\n      isNone: never,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: function (f) {\n        return some(f(a));\n      },\n      each: function (f) {\n        f(a);\n      },\n      bind: bind,\n      exists: bind,\n      forall: bind,\n      filter: function (f) {\n        return f(a) ? me : NONE;\n      },\n      toArray: function () {\n        return [a];\n      },\n      toString: function () {\n        return 'some(' + a + ')';\n      }\n    };\n    return me;\n  };\n\n  var from = function (value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Optional = {\n    some: some,\n    none: none,\n    from: from\n  };\n  var nativeIndexOf = Array.prototype.indexOf;\n  var nativePush = Array.prototype.push;\n\n  var rawIndexOf = function (ts, t) {\n    return nativeIndexOf.call(ts, t);\n  };\n\n  var contains = function (xs, x) {\n    return rawIndexOf(xs, x) > -1;\n  };\n\n  var map = function (xs, f) {\n    var len = xs.length;\n    var r = new Array(len);\n\n    for (var i = 0; i < len; i++) {\n      var x = xs[i];\n      r[i] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var each$1 = function (xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var foldl = function (xs, f, acc) {\n    each$1(xs, function (x, i) {\n      acc = f(acc, x, i);\n    });\n    return acc;\n  };\n\n  var flatten = function (xs) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (!isArray(xs[i])) {\n        throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n      }\n\n      nativePush.apply(r, xs[i]);\n    }\n\n    return r;\n  };\n\n  var bind = function (xs, f) {\n    return flatten(map(xs, f));\n  };\n\n  var findMap = function (arr, f) {\n    for (var i = 0; i < arr.length; i++) {\n      var r = f(arr[i], i);\n\n      if (r.isSome()) {\n        return r;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var is = function (lhs, rhs, comparator) {\n    if (comparator === void 0) {\n      comparator = tripleEquals;\n    }\n\n    return lhs.exists(function (left) {\n      return comparator(left, rhs);\n    });\n  };\n\n  var cat = function (arr) {\n    var r = [];\n\n    var push = function (x) {\n      r.push(x);\n    };\n\n    for (var i = 0; i < arr.length; i++) {\n      arr[i].each(push);\n    }\n\n    return r;\n  };\n\n  var someIf = function (b, a) {\n    return b ? Optional.some(a) : Optional.none();\n  };\n\n  var assumeExternalTargets = function (editor) {\n    var externalTargets = editor.getParam('link_assume_external_targets', false);\n\n    if (isBoolean(externalTargets) && externalTargets) {\n      return 1;\n    } else if (isString(externalTargets) && (externalTargets === 'http' || externalTargets === 'https')) {\n      return externalTargets;\n    }\n\n    return 0;\n  };\n\n  var hasContextToolbar = function (editor) {\n    return editor.getParam('link_context_toolbar', false, 'boolean');\n  };\n\n  var getLinkList = function (editor) {\n    return editor.getParam('link_list');\n  };\n\n  var getDefaultLinkTarget = function (editor) {\n    return editor.getParam('default_link_target');\n  };\n\n  var getTargetList = function (editor) {\n    return editor.getParam('target_list', true);\n  };\n\n  var getRelList = function (editor) {\n    return editor.getParam('rel_list', [], 'array');\n  };\n\n  var getLinkClassList = function (editor) {\n    return editor.getParam('link_class_list', [], 'array');\n  };\n\n  var shouldShowLinkTitle = function (editor) {\n    return editor.getParam('link_title', true, 'boolean');\n  };\n\n  var allowUnsafeLinkTarget = function (editor) {\n    return editor.getParam('allow_unsafe_link_target', false, 'boolean');\n  };\n\n  var useQuickLink = function (editor) {\n    return editor.getParam('link_quicklink', false, 'boolean');\n  };\n\n  var getDefaultLinkProtocol = function (editor) {\n    return editor.getParam('link_default_protocol', 'http', 'string');\n  };\n\n  var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n  var getValue = function (item) {\n    return isString(item.value) ? item.value : '';\n  };\n\n  var getText = function (item) {\n    if (isString(item.text)) {\n      return item.text;\n    } else if (isString(item.title)) {\n      return item.title;\n    } else {\n      return '';\n    }\n  };\n\n  var sanitizeList = function (list, extractValue) {\n    var out = [];\n    global$5.each(list, function (item) {\n      var text = getText(item);\n\n      if (item.menu !== undefined) {\n        var items = sanitizeList(item.menu, extractValue);\n        out.push({\n          text: text,\n          items: items\n        });\n      } else {\n        var value = extractValue(item);\n        out.push({\n          text: text,\n          value: value\n        });\n      }\n    });\n    return out;\n  };\n\n  var sanitizeWith = function (extracter) {\n    if (extracter === void 0) {\n      extracter = getValue;\n    }\n\n    return function (list) {\n      return Optional.from(list).map(function (list) {\n        return sanitizeList(list, extracter);\n      });\n    };\n  };\n\n  var sanitize = function (list) {\n    return sanitizeWith(getValue)(list);\n  };\n\n  var createUi = function (name, label) {\n    return function (items) {\n      return {\n        name: name,\n        type: 'listbox',\n        label: label,\n        items: items\n      };\n    };\n  };\n\n  var ListOptions = {\n    sanitize: sanitize,\n    sanitizeWith: sanitizeWith,\n    createUi: createUi,\n    getValue: getValue\n  };\n\n  var __assign = function () {\n    __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n\n      return t;\n    };\n\n    return __assign.apply(this, arguments);\n  };\n\n  var keys = Object.keys;\n  var hasOwnProperty = Object.hasOwnProperty;\n\n  var each = function (obj, f) {\n    var props = keys(obj);\n\n    for (var k = 0, len = props.length; k < len; k++) {\n      var i = props[k];\n      var x = obj[i];\n      f(x, i);\n    }\n  };\n\n  var objAcc = function (r) {\n    return function (x, i) {\n      r[i] = x;\n    };\n  };\n\n  var internalFilter = function (obj, pred, onTrue, onFalse) {\n    var r = {};\n    each(obj, function (x, i) {\n      (pred(x, i) ? onTrue : onFalse)(x, i);\n    });\n    return r;\n  };\n\n  var filter = function (obj, pred) {\n    var t = {};\n    internalFilter(obj, pred, objAcc(t), noop);\n    return t;\n  };\n\n  var has = function (obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  var hasNonNullableKey = function (obj, key) {\n    return has(obj, key) && obj[key] !== undefined && obj[key] !== null;\n  };\n\n  var global$4 = tinymce.util.Tools.resolve('tinymce.dom.TreeWalker');\n  var global$3 = tinymce.util.Tools.resolve('tinymce.util.URI');\n\n  var isAnchor = function (elm) {\n    return elm && elm.nodeName.toLowerCase() === 'a';\n  };\n\n  var isLink = function (elm) {\n    return isAnchor(elm) && !!getHref(elm);\n  };\n\n  var collectNodesInRange = function (rng, predicate) {\n    if (rng.collapsed) {\n      return [];\n    } else {\n      var contents = rng.cloneContents();\n      var walker = new global$4(contents.firstChild, contents);\n      var elements = [];\n      var current = contents.firstChild;\n\n      do {\n        if (predicate(current)) {\n          elements.push(current);\n        }\n      } while (current = walker.next());\n\n      return elements;\n    }\n  };\n\n  var hasProtocol = function (url) {\n    return /^\\w+:/i.test(url);\n  };\n\n  var getHref = function (elm) {\n    var href = elm.getAttribute('data-mce-href');\n    return href ? href : elm.getAttribute('href');\n  };\n\n  var applyRelTargetRules = function (rel, isUnsafe) {\n    var rules = ['noopener'];\n    var rels = rel ? rel.split(/\\s+/) : [];\n\n    var toString = function (rels) {\n      return global$5.trim(rels.sort().join(' '));\n    };\n\n    var addTargetRules = function (rels) {\n      rels = removeTargetRules(rels);\n      return rels.length > 0 ? rels.concat(rules) : rules;\n    };\n\n    var removeTargetRules = function (rels) {\n      return rels.filter(function (val) {\n        return global$5.inArray(rules, val) === -1;\n      });\n    };\n\n    var newRels = isUnsafe ? addTargetRules(rels) : removeTargetRules(rels);\n    return newRels.length > 0 ? toString(newRels) : '';\n  };\n\n  var trimCaretContainers = function (text) {\n    return text.replace(/\\uFEFF/g, '');\n  };\n\n  var getAnchorElement = function (editor, selectedElm) {\n    selectedElm = selectedElm || editor.selection.getNode();\n\n    if (isImageFigure(selectedElm)) {\n      return editor.dom.select('a[href]', selectedElm)[0];\n    } else {\n      return editor.dom.getParent(selectedElm, 'a[href]');\n    }\n  };\n\n  var getAnchorText = function (selection, anchorElm) {\n    var text = anchorElm ? anchorElm.innerText || anchorElm.textContent : selection.getContent({\n      format: 'text'\n    });\n    return trimCaretContainers(text);\n  };\n\n  var hasLinks = function (elements) {\n    return global$5.grep(elements, isLink).length > 0;\n  };\n\n  var hasLinksInSelection = function (rng) {\n    return collectNodesInRange(rng, isLink).length > 0;\n  };\n\n  var isOnlyTextSelected = function (editor) {\n    var inlineTextElements = editor.schema.getTextInlineElements();\n\n    var isElement = function (elm) {\n      return elm.nodeType === 1 && !isAnchor(elm) && !has(inlineTextElements, elm.nodeName.toLowerCase());\n    };\n\n    var elements = collectNodesInRange(editor.selection.getRng(), isElement);\n    return elements.length === 0;\n  };\n\n  var isImageFigure = function (elm) {\n    return elm && elm.nodeName === 'FIGURE' && /\\bimage\\b/i.test(elm.className);\n  };\n\n  var getLinkAttrs = function (data) {\n    var attrs = ['title', 'rel', 'class', 'target'];\n    return foldl(attrs, function (acc, key) {\n      data[key].each(function (value) {\n        acc[key] = value.length > 0 ? value : null;\n      });\n      return acc;\n    }, {\n      href: data.href\n    });\n  };\n\n  var handleExternalTargets = function (href, assumeExternalTargets) {\n    if ((assumeExternalTargets === 'http' || assumeExternalTargets === 'https') && !hasProtocol(href)) {\n      return assumeExternalTargets + '://' + href;\n    }\n\n    return href;\n  };\n\n  var applyLinkOverrides = function (editor, linkAttrs) {\n    var newLinkAttrs = __assign({}, linkAttrs);\n\n    if (!(getRelList(editor).length > 0) && allowUnsafeLinkTarget(editor) === false) {\n      var newRel = applyRelTargetRules(newLinkAttrs.rel, newLinkAttrs.target === '_blank');\n      newLinkAttrs.rel = newRel ? newRel : null;\n    }\n\n    if (Optional.from(newLinkAttrs.target).isNone() && getTargetList(editor) === false) {\n      newLinkAttrs.target = getDefaultLinkTarget(editor);\n    }\n\n    newLinkAttrs.href = handleExternalTargets(newLinkAttrs.href, assumeExternalTargets(editor));\n    return newLinkAttrs;\n  };\n\n  var updateLink = function (editor, anchorElm, text, linkAttrs) {\n    text.each(function (text) {\n      if (has(anchorElm, 'innerText')) {\n        anchorElm.innerText = text;\n      } else {\n        anchorElm.textContent = text;\n      }\n    });\n    editor.dom.setAttribs(anchorElm, linkAttrs);\n    editor.selection.select(anchorElm);\n  };\n\n  var createLink = function (editor, selectedElm, text, linkAttrs) {\n    if (isImageFigure(selectedElm)) {\n      linkImageFigure(editor, selectedElm, linkAttrs);\n    } else {\n      text.fold(function () {\n        editor.execCommand('mceInsertLink', false, linkAttrs);\n      }, function (text) {\n        editor.insertContent(editor.dom.createHTML('a', linkAttrs, editor.dom.encode(text)));\n      });\n    }\n  };\n\n  var linkDomMutation = function (editor, attachState, data) {\n    var selectedElm = editor.selection.getNode();\n    var anchorElm = getAnchorElement(editor, selectedElm);\n    var linkAttrs = applyLinkOverrides(editor, getLinkAttrs(data));\n    editor.undoManager.transact(function () {\n      if (data.href === attachState.href) {\n        attachState.attach();\n      }\n\n      if (anchorElm) {\n        editor.focus();\n        updateLink(editor, anchorElm, data.text, linkAttrs);\n      } else {\n        createLink(editor, selectedElm, data.text, linkAttrs);\n      }\n    });\n  };\n\n  var unlinkSelection = function (editor) {\n    var dom = editor.dom,\n        selection = editor.selection;\n    var bookmark = selection.getBookmark();\n    var rng = selection.getRng().cloneRange();\n    var startAnchorElm = dom.getParent(rng.startContainer, 'a[href]', editor.getBody());\n    var endAnchorElm = dom.getParent(rng.endContainer, 'a[href]', editor.getBody());\n\n    if (startAnchorElm) {\n      rng.setStartBefore(startAnchorElm);\n    }\n\n    if (endAnchorElm) {\n      rng.setEndAfter(endAnchorElm);\n    }\n\n    selection.setRng(rng);\n    editor.execCommand('unlink');\n    selection.moveToBookmark(bookmark);\n  };\n\n  var unlinkDomMutation = function (editor) {\n    editor.undoManager.transact(function () {\n      var node = editor.selection.getNode();\n\n      if (isImageFigure(node)) {\n        unlinkImageFigure(editor, node);\n      } else {\n        unlinkSelection(editor);\n      }\n\n      editor.focus();\n    });\n  };\n\n  var unwrapOptions = function (data) {\n    var cls = data.class,\n        href = data.href,\n        rel = data.rel,\n        target = data.target,\n        text = data.text,\n        title = data.title;\n    return filter({\n      class: cls.getOrNull(),\n      href: href,\n      rel: rel.getOrNull(),\n      target: target.getOrNull(),\n      text: text.getOrNull(),\n      title: title.getOrNull()\n    }, function (v, _k) {\n      return isNull(v) === false;\n    });\n  };\n\n  var sanitizeData = function (editor, data) {\n    var href = data.href;\n    return __assign(__assign({}, data), {\n      href: global$3.isDomSafe(href, 'a', editor.settings) ? href : ''\n    });\n  };\n\n  var link = function (editor, attachState, data) {\n    var sanitizedData = sanitizeData(editor, data);\n    editor.hasPlugin('rtc', true) ? editor.execCommand('createlink', false, unwrapOptions(sanitizedData)) : linkDomMutation(editor, attachState, sanitizedData);\n  };\n\n  var unlink = function (editor) {\n    editor.hasPlugin('rtc', true) ? editor.execCommand('unlink') : unlinkDomMutation(editor);\n  };\n\n  var unlinkImageFigure = function (editor, fig) {\n    var img = editor.dom.select('img', fig)[0];\n\n    if (img) {\n      var a = editor.dom.getParents(img, 'a[href]', fig)[0];\n\n      if (a) {\n        a.parentNode.insertBefore(img, a);\n        editor.dom.remove(a);\n      }\n    }\n  };\n\n  var linkImageFigure = function (editor, fig, attrs) {\n    var img = editor.dom.select('img', fig)[0];\n\n    if (img) {\n      var a = editor.dom.create('a', attrs);\n      img.parentNode.insertBefore(a, img);\n      a.appendChild(img);\n    }\n  };\n\n  var isListGroup = function (item) {\n    return hasNonNullableKey(item, 'items');\n  };\n\n  var findTextByValue = function (value, catalog) {\n    return findMap(catalog, function (item) {\n      if (isListGroup(item)) {\n        return findTextByValue(value, item.items);\n      } else {\n        return someIf(item.value === value, item);\n      }\n    });\n  };\n\n  var getDelta = function (persistentText, fieldName, catalog, data) {\n    var value = data[fieldName];\n    var hasPersistentText = persistentText.length > 0;\n    return value !== undefined ? findTextByValue(value, catalog).map(function (i) {\n      return {\n        url: {\n          value: i.value,\n          meta: {\n            text: hasPersistentText ? persistentText : i.text,\n            attach: noop\n          }\n        },\n        text: hasPersistentText ? persistentText : i.text\n      };\n    }) : Optional.none();\n  };\n\n  var findCatalog = function (catalogs, fieldName) {\n    if (fieldName === 'link') {\n      return catalogs.link;\n    } else if (fieldName === 'anchor') {\n      return catalogs.anchor;\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var init = function (initialData, linkCatalog) {\n    var persistentData = {\n      text: initialData.text,\n      title: initialData.title\n    };\n\n    var getTitleFromUrlChange = function (url) {\n      return someIf(persistentData.title.length <= 0, Optional.from(url.meta.title).getOr(''));\n    };\n\n    var getTextFromUrlChange = function (url) {\n      return someIf(persistentData.text.length <= 0, Optional.from(url.meta.text).getOr(url.value));\n    };\n\n    var onUrlChange = function (data) {\n      var text = getTextFromUrlChange(data.url);\n      var title = getTitleFromUrlChange(data.url);\n\n      if (text.isSome() || title.isSome()) {\n        return Optional.some(__assign(__assign({}, text.map(function (text) {\n          return {\n            text: text\n          };\n        }).getOr({})), title.map(function (title) {\n          return {\n            title: title\n          };\n        }).getOr({})));\n      } else {\n        return Optional.none();\n      }\n    };\n\n    var onCatalogChange = function (data, change) {\n      var catalog = findCatalog(linkCatalog, change.name).getOr([]);\n      return getDelta(persistentData.text, change.name, catalog, data);\n    };\n\n    var onChange = function (getData, change) {\n      var name = change.name;\n\n      if (name === 'url') {\n        return onUrlChange(getData());\n      } else if (contains(['anchor', 'link'], name)) {\n        return onCatalogChange(getData(), change);\n      } else if (name === 'text' || name === 'title') {\n        persistentData[name] = getData()[name];\n        return Optional.none();\n      } else {\n        return Optional.none();\n      }\n    };\n\n    return {\n      onChange: onChange\n    };\n  };\n\n  var DialogChanges = {\n    init: init,\n    getDelta: getDelta\n  };\n  var global$2 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n  var global$1 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n  var delayedConfirm = function (editor, message, callback) {\n    var rng = editor.selection.getRng();\n    global$2.setEditorTimeout(editor, function () {\n      editor.windowManager.confirm(message, function (state) {\n        editor.selection.setRng(rng);\n        callback(state);\n      });\n    });\n  };\n\n  var tryEmailTransform = function (data) {\n    var url = data.href;\n    var suggestMailTo = url.indexOf('@') > 0 && url.indexOf('/') === -1 && url.indexOf('mailto:') === -1;\n    return suggestMailTo ? Optional.some({\n      message: 'The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?',\n      preprocess: function (oldData) {\n        return __assign(__assign({}, oldData), {\n          href: 'mailto:' + url\n        });\n      }\n    }) : Optional.none();\n  };\n\n  var tryProtocolTransform = function (assumeExternalTargets, defaultLinkProtocol) {\n    return function (data) {\n      var url = data.href;\n      var suggestProtocol = assumeExternalTargets === 1 && !hasProtocol(url) || assumeExternalTargets === 0 && /^\\s*www(\\.|\\d\\.)/i.test(url);\n      return suggestProtocol ? Optional.some({\n        message: 'The URL you entered seems to be an external link. Do you want to add the required ' + defaultLinkProtocol + ':// prefix?',\n        preprocess: function (oldData) {\n          return __assign(__assign({}, oldData), {\n            href: defaultLinkProtocol + '://' + url\n          });\n        }\n      }) : Optional.none();\n    };\n  };\n\n  var preprocess = function (editor, data) {\n    return findMap([tryEmailTransform, tryProtocolTransform(assumeExternalTargets(editor), getDefaultLinkProtocol(editor))], function (f) {\n      return f(data);\n    }).fold(function () {\n      return global$1.resolve(data);\n    }, function (transform) {\n      return new global$1(function (callback) {\n        delayedConfirm(editor, transform.message, function (state) {\n          callback(state ? transform.preprocess(data) : data);\n        });\n      });\n    });\n  };\n\n  var DialogConfirms = {\n    preprocess: preprocess\n  };\n\n  var getAnchors = function (editor) {\n    var anchorNodes = editor.dom.select('a:not([href])');\n    var anchors = bind(anchorNodes, function (anchor) {\n      var id = anchor.name || anchor.id;\n      return id ? [{\n        text: id,\n        value: '#' + id\n      }] : [];\n    });\n    return anchors.length > 0 ? Optional.some([{\n      text: 'None',\n      value: ''\n    }].concat(anchors)) : Optional.none();\n  };\n\n  var AnchorListOptions = {\n    getAnchors: getAnchors\n  };\n\n  var getClasses = function (editor) {\n    var list = getLinkClassList(editor);\n\n    if (list.length > 0) {\n      return ListOptions.sanitize(list);\n    }\n\n    return Optional.none();\n  };\n\n  var ClassListOptions = {\n    getClasses: getClasses\n  };\n  var global = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n  var parseJson = function (text) {\n    try {\n      return Optional.some(JSON.parse(text));\n    } catch (err) {\n      return Optional.none();\n    }\n  };\n\n  var getLinks = function (editor) {\n    var extractor = function (item) {\n      return editor.convertURL(item.value || item.url, 'href');\n    };\n\n    var linkList = getLinkList(editor);\n    return new global$1(function (callback) {\n      if (isString(linkList)) {\n        global.send({\n          url: linkList,\n          success: function (text) {\n            return callback(parseJson(text));\n          },\n          error: function (_) {\n            return callback(Optional.none());\n          }\n        });\n      } else if (isFunction(linkList)) {\n        linkList(function (output) {\n          return callback(Optional.some(output));\n        });\n      } else {\n        callback(Optional.from(linkList));\n      }\n    }).then(function (optItems) {\n      return optItems.bind(ListOptions.sanitizeWith(extractor)).map(function (items) {\n        if (items.length > 0) {\n          var noneItem = [{\n            text: 'None',\n            value: ''\n          }];\n          return noneItem.concat(items);\n        } else {\n          return items;\n        }\n      });\n    });\n  };\n\n  var LinkListOptions = {\n    getLinks: getLinks\n  };\n\n  var getRels = function (editor, initialTarget) {\n    var list = getRelList(editor);\n\n    if (list.length > 0) {\n      var isTargetBlank_1 = is(initialTarget, '_blank');\n      var enforceSafe = allowUnsafeLinkTarget(editor) === false;\n\n      var safeRelExtractor = function (item) {\n        return applyRelTargetRules(ListOptions.getValue(item), isTargetBlank_1);\n      };\n\n      var sanitizer = enforceSafe ? ListOptions.sanitizeWith(safeRelExtractor) : ListOptions.sanitize;\n      return sanitizer(list);\n    }\n\n    return Optional.none();\n  };\n\n  var RelOptions = {\n    getRels: getRels\n  };\n  var fallbacks = [{\n    text: 'Current window',\n    value: ''\n  }, {\n    text: 'New window',\n    value: '_blank'\n  }];\n\n  var getTargets = function (editor) {\n    var list = getTargetList(editor);\n\n    if (isArray(list)) {\n      return ListOptions.sanitize(list).orThunk(function () {\n        return Optional.some(fallbacks);\n      });\n    } else if (list === false) {\n      return Optional.none();\n    }\n\n    return Optional.some(fallbacks);\n  };\n\n  var TargetOptions = {\n    getTargets: getTargets\n  };\n\n  var nonEmptyAttr = function (dom, elem, name) {\n    var val = dom.getAttrib(elem, name);\n    return val !== null && val.length > 0 ? Optional.some(val) : Optional.none();\n  };\n\n  var extractFromAnchor = function (editor, anchor) {\n    var dom = editor.dom;\n    var onlyText = isOnlyTextSelected(editor);\n    var text = onlyText ? Optional.some(getAnchorText(editor.selection, anchor)) : Optional.none();\n    var url = anchor ? Optional.some(dom.getAttrib(anchor, 'href')) : Optional.none();\n    var target = anchor ? Optional.from(dom.getAttrib(anchor, 'target')) : Optional.none();\n    var rel = nonEmptyAttr(dom, anchor, 'rel');\n    var linkClass = nonEmptyAttr(dom, anchor, 'class');\n    var title = nonEmptyAttr(dom, anchor, 'title');\n    return {\n      url: url,\n      text: text,\n      title: title,\n      target: target,\n      rel: rel,\n      linkClass: linkClass\n    };\n  };\n\n  var collect = function (editor, linkNode) {\n    return LinkListOptions.getLinks(editor).then(function (links) {\n      var anchor = extractFromAnchor(editor, linkNode);\n      return {\n        anchor: anchor,\n        catalogs: {\n          targets: TargetOptions.getTargets(editor),\n          rels: RelOptions.getRels(editor, anchor.target),\n          classes: ClassListOptions.getClasses(editor),\n          anchor: AnchorListOptions.getAnchors(editor),\n          link: links\n        },\n        optNode: Optional.from(linkNode),\n        flags: {\n          titleEnabled: shouldShowLinkTitle(editor)\n        }\n      };\n    });\n  };\n\n  var DialogInfo = {\n    collect: collect\n  };\n\n  var handleSubmit = function (editor, info) {\n    return function (api) {\n      var data = api.getData();\n\n      if (!data.url.value) {\n        unlink(editor);\n        api.close();\n        return;\n      }\n\n      var getChangedValue = function (key) {\n        return Optional.from(data[key]).filter(function (value) {\n          return !is(info.anchor[key], value);\n        });\n      };\n\n      var changedData = {\n        href: data.url.value,\n        text: getChangedValue('text'),\n        target: getChangedValue('target'),\n        rel: getChangedValue('rel'),\n        class: getChangedValue('linkClass'),\n        title: getChangedValue('title')\n      };\n      var attachState = {\n        href: data.url.value,\n        attach: data.url.meta !== undefined && data.url.meta.attach ? data.url.meta.attach : noop\n      };\n      DialogConfirms.preprocess(editor, changedData).then(function (pData) {\n        link(editor, attachState, pData);\n      });\n      api.close();\n    };\n  };\n\n  var collectData = function (editor) {\n    var anchorNode = getAnchorElement(editor);\n    return DialogInfo.collect(editor, anchorNode);\n  };\n\n  var getInitialData = function (info, defaultTarget) {\n    var anchor = info.anchor;\n    var url = anchor.url.getOr('');\n    return {\n      url: {\n        value: url,\n        meta: {\n          original: {\n            value: url\n          }\n        }\n      },\n      text: anchor.text.getOr(''),\n      title: anchor.title.getOr(''),\n      anchor: url,\n      link: url,\n      rel: anchor.rel.getOr(''),\n      target: anchor.target.or(defaultTarget).getOr(''),\n      linkClass: anchor.linkClass.getOr('')\n    };\n  };\n\n  var makeDialog = function (settings, onSubmit, editor) {\n    var urlInput = [{\n      name: 'url',\n      type: 'urlinput',\n      filetype: 'file',\n      label: 'URL'\n    }];\n    var displayText = settings.anchor.text.map(function () {\n      return {\n        name: 'text',\n        type: 'input',\n        label: 'Text to display'\n      };\n    }).toArray();\n    var titleText = settings.flags.titleEnabled ? [{\n      name: 'title',\n      type: 'input',\n      label: 'Title'\n    }] : [];\n    var defaultTarget = Optional.from(getDefaultLinkTarget(editor));\n    var initialData = getInitialData(settings, defaultTarget);\n    var catalogs = settings.catalogs;\n    var dialogDelta = DialogChanges.init(initialData, catalogs);\n    var body = {\n      type: 'panel',\n      items: flatten([urlInput, displayText, titleText, cat([catalogs.anchor.map(ListOptions.createUi('anchor', 'Anchors')), catalogs.rels.map(ListOptions.createUi('rel', 'Rel')), catalogs.targets.map(ListOptions.createUi('target', 'Open link in...')), catalogs.link.map(ListOptions.createUi('link', 'Link list')), catalogs.classes.map(ListOptions.createUi('linkClass', 'Class'))])])\n    };\n    return {\n      title: 'Insert/Edit Link',\n      size: 'normal',\n      body: body,\n      buttons: [{\n        type: 'cancel',\n        name: 'cancel',\n        text: 'Cancel'\n      }, {\n        type: 'submit',\n        name: 'save',\n        text: 'Save',\n        primary: true\n      }],\n      initialData: initialData,\n      onChange: function (api, _a) {\n        var name = _a.name;\n        dialogDelta.onChange(api.getData, {\n          name: name\n        }).each(function (newData) {\n          api.setData(newData);\n        });\n      },\n      onSubmit: onSubmit\n    };\n  };\n\n  var open$1 = function (editor) {\n    var data = collectData(editor);\n    data.then(function (info) {\n      var onSubmit = handleSubmit(editor, info);\n      return makeDialog(info, onSubmit, editor);\n    }).then(function (spec) {\n      editor.windowManager.open(spec);\n    });\n  };\n\n  var appendClickRemove = function (link, evt) {\n    document.body.appendChild(link);\n    link.dispatchEvent(evt);\n    document.body.removeChild(link);\n  };\n\n  var open = function (url) {\n    var link = document.createElement('a');\n    link.target = '_blank';\n    link.href = url;\n    link.rel = 'noreferrer noopener';\n    var evt = document.createEvent('MouseEvents');\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n    appendClickRemove(link, evt);\n  };\n\n  var getLink = function (editor, elm) {\n    return editor.dom.getParent(elm, 'a[href]');\n  };\n\n  var getSelectedLink = function (editor) {\n    return getLink(editor, editor.selection.getStart());\n  };\n\n  var hasOnlyAltModifier = function (e) {\n    return e.altKey === true && e.shiftKey === false && e.ctrlKey === false && e.metaKey === false;\n  };\n\n  var gotoLink = function (editor, a) {\n    if (a) {\n      var href = getHref(a);\n\n      if (/^#/.test(href)) {\n        var targetEl = editor.$(href);\n\n        if (targetEl.length) {\n          editor.selection.scrollIntoView(targetEl[0], true);\n        }\n      } else {\n        open(a.href);\n      }\n    }\n  };\n\n  var openDialog = function (editor) {\n    return function () {\n      open$1(editor);\n    };\n  };\n\n  var gotoSelectedLink = function (editor) {\n    return function () {\n      gotoLink(editor, getSelectedLink(editor));\n    };\n  };\n\n  var setupGotoLinks = function (editor) {\n    editor.on('click', function (e) {\n      var link = getLink(editor, e.target);\n\n      if (link && global$6.metaKeyPressed(e)) {\n        e.preventDefault();\n        gotoLink(editor, link);\n      }\n    });\n    editor.on('keydown', function (e) {\n      var link = getSelectedLink(editor);\n\n      if (link && e.keyCode === 13 && hasOnlyAltModifier(e)) {\n        e.preventDefault();\n        gotoLink(editor, link);\n      }\n    });\n  };\n\n  var toggleState = function (editor, toggler) {\n    editor.on('NodeChange', toggler);\n    return function () {\n      return editor.off('NodeChange', toggler);\n    };\n  };\n\n  var toggleActiveState = function (editor) {\n    return function (api) {\n      var updateState = function () {\n        return api.setActive(!editor.mode.isReadOnly() && getAnchorElement(editor, editor.selection.getNode()) !== null);\n      };\n\n      updateState();\n      return toggleState(editor, updateState);\n    };\n  };\n\n  var toggleEnabledState = function (editor) {\n    return function (api) {\n      var updateState = function () {\n        return api.setDisabled(getAnchorElement(editor, editor.selection.getNode()) === null);\n      };\n\n      updateState();\n      return toggleState(editor, updateState);\n    };\n  };\n\n  var toggleUnlinkState = function (editor) {\n    return function (api) {\n      var hasLinks$1 = function (parents) {\n        return hasLinks(parents) || hasLinksInSelection(editor.selection.getRng());\n      };\n\n      var parents = editor.dom.getParents(editor.selection.getStart());\n      api.setDisabled(!hasLinks$1(parents));\n      return toggleState(editor, function (e) {\n        return api.setDisabled(!hasLinks$1(e.parents));\n      });\n    };\n  };\n\n  var register = function (editor) {\n    editor.addCommand('mceLink', function () {\n      if (useQuickLink(editor)) {\n        editor.fire('contexttoolbar-show', {\n          toolbarKey: 'quicklink'\n        });\n      } else {\n        openDialog(editor)();\n      }\n    });\n  };\n\n  var setup = function (editor) {\n    editor.addShortcut('Meta+K', '', function () {\n      editor.execCommand('mceLink');\n    });\n  };\n\n  var setupButtons = function (editor) {\n    editor.ui.registry.addToggleButton('link', {\n      icon: 'link',\n      tooltip: 'Insert/edit link',\n      onAction: openDialog(editor),\n      onSetup: toggleActiveState(editor)\n    });\n    editor.ui.registry.addButton('openlink', {\n      icon: 'new-tab',\n      tooltip: 'Open link',\n      onAction: gotoSelectedLink(editor),\n      onSetup: toggleEnabledState(editor)\n    });\n    editor.ui.registry.addButton('unlink', {\n      icon: 'unlink',\n      tooltip: 'Remove link',\n      onAction: function () {\n        return unlink(editor);\n      },\n      onSetup: toggleUnlinkState(editor)\n    });\n  };\n\n  var setupMenuItems = function (editor) {\n    editor.ui.registry.addMenuItem('openlink', {\n      text: 'Open link',\n      icon: 'new-tab',\n      onAction: gotoSelectedLink(editor),\n      onSetup: toggleEnabledState(editor)\n    });\n    editor.ui.registry.addMenuItem('link', {\n      icon: 'link',\n      text: 'Link...',\n      shortcut: 'Meta+K',\n      onAction: openDialog(editor)\n    });\n    editor.ui.registry.addMenuItem('unlink', {\n      icon: 'unlink',\n      text: 'Remove link',\n      onAction: function () {\n        return unlink(editor);\n      },\n      onSetup: toggleUnlinkState(editor)\n    });\n  };\n\n  var setupContextMenu = function (editor) {\n    var inLink = 'link unlink openlink';\n    var noLink = 'link';\n    editor.ui.registry.addContextMenu('link', {\n      update: function (element) {\n        return hasLinks(editor.dom.getParents(element, 'a')) ? inLink : noLink;\n      }\n    });\n  };\n\n  var setupContextToolbars = function (editor) {\n    var collapseSelectionToEnd = function (editor) {\n      editor.selection.collapse(false);\n    };\n\n    var onSetupLink = function (buttonApi) {\n      var node = editor.selection.getNode();\n      buttonApi.setDisabled(!getAnchorElement(editor, node));\n      return noop;\n    };\n\n    var getLinkText = function (value) {\n      var anchor = getAnchorElement(editor);\n      var onlyText = isOnlyTextSelected(editor);\n\n      if (!anchor && onlyText) {\n        var text = getAnchorText(editor.selection, anchor);\n        return Optional.some(text.length > 0 ? text : value);\n      } else {\n        return Optional.none();\n      }\n    };\n\n    editor.ui.registry.addContextForm('quicklink', {\n      launch: {\n        type: 'contextformtogglebutton',\n        icon: 'link',\n        tooltip: 'Link',\n        onSetup: toggleActiveState(editor)\n      },\n      label: 'Link',\n      predicate: function (node) {\n        return !!getAnchorElement(editor, node) && hasContextToolbar(editor);\n      },\n      initValue: function () {\n        var elm = getAnchorElement(editor);\n        return !!elm ? getHref(elm) : '';\n      },\n      commands: [{\n        type: 'contextformtogglebutton',\n        icon: 'link',\n        tooltip: 'Link',\n        primary: true,\n        onSetup: function (buttonApi) {\n          var node = editor.selection.getNode();\n          buttonApi.setActive(!!getAnchorElement(editor, node));\n          return toggleActiveState(editor)(buttonApi);\n        },\n        onAction: function (formApi) {\n          var value = formApi.getValue();\n          var text = getLinkText(value);\n          var attachState = {\n            href: value,\n            attach: noop\n          };\n          link(editor, attachState, {\n            href: value,\n            text: text,\n            title: Optional.none(),\n            rel: Optional.none(),\n            target: Optional.none(),\n            class: Optional.none()\n          });\n          collapseSelectionToEnd(editor);\n          formApi.hide();\n        }\n      }, {\n        type: 'contextformbutton',\n        icon: 'unlink',\n        tooltip: 'Remove link',\n        onSetup: onSetupLink,\n        onAction: function (formApi) {\n          unlink(editor);\n          formApi.hide();\n        }\n      }, {\n        type: 'contextformbutton',\n        icon: 'new-tab',\n        tooltip: 'Open link',\n        onSetup: onSetupLink,\n        onAction: function (formApi) {\n          gotoSelectedLink(editor)();\n          formApi.hide();\n        }\n      }]\n    });\n  };\n\n  function Plugin() {\n    global$7.add('link', function (editor) {\n      setupButtons(editor);\n      setupMenuItems(editor);\n      setupContextMenu(editor);\n      setupContextToolbars(editor);\n      setupGotoLinks(editor);\n      register(editor);\n      setup(editor);\n    });\n  }\n\n  Plugin();\n})();","map":{"version":3,"sources":["/opt/bitnami/apache/htdocs/converzee-frontend/node_modules/tinymce/plugins/link/plugin.js"],"names":["global$7","tinymce","util","Tools","resolve","global$6","typeOf","x","t","Array","prototype","isPrototypeOf","constructor","name","String","isType","type","value","isSimpleType","eq","a","isString","isArray","isNull","isBoolean","isFunction","noop","constant","identity","tripleEquals","b","never","always","none","NONE","call","thunk","id","me","fold","n","_s","isSome","isNone","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","toArray","toString","some","constant_a","self","f","s","from","Optional","nativeIndexOf","indexOf","nativePush","push","rawIndexOf","ts","contains","xs","len","length","r","i","each$1","foldl","acc","flatten","apply","findMap","arr","is","lhs","rhs","comparator","left","cat","someIf","assumeExternalTargets","editor","externalTargets","getParam","hasContextToolbar","getLinkList","getDefaultLinkTarget","getTargetList","getRelList","getLinkClassList","shouldShowLinkTitle","allowUnsafeLinkTarget","useQuickLink","getDefaultLinkProtocol","global$5","getValue","item","getText","text","title","sanitizeList","list","extractValue","out","menu","items","sanitizeWith","extracter","sanitize","createUi","label","ListOptions","__assign","Object","assign","arguments","p","hasOwnProperty","keys","obj","props","k","objAcc","internalFilter","pred","onTrue","onFalse","has","key","hasNonNullableKey","global$4","global$3","isAnchor","elm","nodeName","toLowerCase","isLink","getHref","collectNodesInRange","rng","predicate","collapsed","contents","cloneContents","walker","firstChild","elements","current","next","hasProtocol","url","test","href","getAttribute","applyRelTargetRules","rel","isUnsafe","rules","rels","split","trim","sort","join","addTargetRules","removeTargetRules","concat","val","inArray","newRels","trimCaretContainers","replace","getAnchorElement","selectedElm","selection","getNode","isImageFigure","dom","select","getParent","getAnchorText","anchorElm","innerText","textContent","getContent","format","hasLinks","grep","hasLinksInSelection","isOnlyTextSelected","inlineTextElements","schema","getTextInlineElements","isElement","nodeType","getRng","className","getLinkAttrs","data","attrs","handleExternalTargets","applyLinkOverrides","linkAttrs","newLinkAttrs","newRel","target","updateLink","setAttribs","createLink","linkImageFigure","execCommand","insertContent","createHTML","encode","linkDomMutation","attachState","undoManager","transact","attach","focus","unlinkSelection","bookmark","getBookmark","cloneRange","startAnchorElm","startContainer","getBody","endAnchorElm","endContainer","setStartBefore","setEndAfter","setRng","moveToBookmark","unlinkDomMutation","node","unlinkImageFigure","unwrapOptions","cls","class","v","_k","sanitizeData","isDomSafe","settings","link","sanitizedData","hasPlugin","unlink","fig","img","getParents","parentNode","insertBefore","remove","create","appendChild","isListGroup","findTextByValue","catalog","getDelta","persistentText","fieldName","hasPersistentText","meta","findCatalog","catalogs","anchor","init","initialData","linkCatalog","persistentData","getTitleFromUrlChange","getTextFromUrlChange","onUrlChange","onCatalogChange","change","onChange","getData","DialogChanges","global$2","global$1","delayedConfirm","message","callback","setEditorTimeout","windowManager","confirm","state","tryEmailTransform","suggestMailTo","preprocess","oldData","tryProtocolTransform","defaultLinkProtocol","suggestProtocol","transform","DialogConfirms","getAnchors","anchorNodes","anchors","AnchorListOptions","getClasses","ClassListOptions","global","parseJson","JSON","parse","err","getLinks","extractor","convertURL","linkList","send","success","error","_","output","then","optItems","noneItem","LinkListOptions","getRels","initialTarget","isTargetBlank_1","enforceSafe","safeRelExtractor","sanitizer","RelOptions","fallbacks","getTargets","TargetOptions","nonEmptyAttr","elem","getAttrib","extractFromAnchor","onlyText","linkClass","collect","linkNode","links","targets","classes","optNode","flags","titleEnabled","DialogInfo","handleSubmit","info","api","close","getChangedValue","changedData","pData","collectData","anchorNode","getInitialData","defaultTarget","original","makeDialog","onSubmit","urlInput","filetype","displayText","titleText","dialogDelta","body","size","buttons","primary","_a","newData","setData","open$1","spec","open","appendClickRemove","evt","document","dispatchEvent","removeChild","createElement","createEvent","initMouseEvent","window","getLink","getSelectedLink","getStart","hasOnlyAltModifier","e","altKey","shiftKey","ctrlKey","metaKey","gotoLink","targetEl","$","scrollIntoView","openDialog","gotoSelectedLink","setupGotoLinks","on","metaKeyPressed","preventDefault","keyCode","toggleState","toggler","off","toggleActiveState","updateState","setActive","mode","isReadOnly","toggleEnabledState","setDisabled","toggleUnlinkState","hasLinks$1","parents","register","addCommand","fire","toolbarKey","setup","addShortcut","setupButtons","ui","registry","addToggleButton","icon","tooltip","onAction","onSetup","addButton","setupMenuItems","addMenuItem","shortcut","setupContextMenu","inLink","noLink","addContextMenu","update","element","setupContextToolbars","collapseSelectionToEnd","collapse","onSetupLink","buttonApi","getLinkText","addContextForm","launch","initValue","commands","formApi","hide","Plugin","add"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.10.2 (2021-11-17)\n */\n(function () {\n    'use strict';\n\n    var global$7 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var global$6 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var typeOf = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var eq = function (t) {\n      return function (a) {\n        return t === a;\n      };\n    };\n    var isString = isType('string');\n    var isArray = isType('array');\n    var isNull = eq(null);\n    var isBoolean = isSimpleType('boolean');\n    var isFunction = isSimpleType('function');\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    var tripleEquals = function (a, b) {\n      return a === b;\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = identity;\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: function () {\n          return none();\n        },\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each$1 = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var foldl = function (xs, f, acc) {\n      each$1(xs, function (x, i) {\n        acc = f(acc, x, i);\n      });\n      return acc;\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      return flatten(map(xs, f));\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Optional.none();\n    };\n\n    var is = function (lhs, rhs, comparator) {\n      if (comparator === void 0) {\n        comparator = tripleEquals;\n      }\n      return lhs.exists(function (left) {\n        return comparator(left, rhs);\n      });\n    };\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var someIf = function (b, a) {\n      return b ? Optional.some(a) : Optional.none();\n    };\n\n    var assumeExternalTargets = function (editor) {\n      var externalTargets = editor.getParam('link_assume_external_targets', false);\n      if (isBoolean(externalTargets) && externalTargets) {\n        return 1;\n      } else if (isString(externalTargets) && (externalTargets === 'http' || externalTargets === 'https')) {\n        return externalTargets;\n      }\n      return 0;\n    };\n    var hasContextToolbar = function (editor) {\n      return editor.getParam('link_context_toolbar', false, 'boolean');\n    };\n    var getLinkList = function (editor) {\n      return editor.getParam('link_list');\n    };\n    var getDefaultLinkTarget = function (editor) {\n      return editor.getParam('default_link_target');\n    };\n    var getTargetList = function (editor) {\n      return editor.getParam('target_list', true);\n    };\n    var getRelList = function (editor) {\n      return editor.getParam('rel_list', [], 'array');\n    };\n    var getLinkClassList = function (editor) {\n      return editor.getParam('link_class_list', [], 'array');\n    };\n    var shouldShowLinkTitle = function (editor) {\n      return editor.getParam('link_title', true, 'boolean');\n    };\n    var allowUnsafeLinkTarget = function (editor) {\n      return editor.getParam('allow_unsafe_link_target', false, 'boolean');\n    };\n    var useQuickLink = function (editor) {\n      return editor.getParam('link_quicklink', false, 'boolean');\n    };\n    var getDefaultLinkProtocol = function (editor) {\n      return editor.getParam('link_default_protocol', 'http', 'string');\n    };\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getValue = function (item) {\n      return isString(item.value) ? item.value : '';\n    };\n    var getText = function (item) {\n      if (isString(item.text)) {\n        return item.text;\n      } else if (isString(item.title)) {\n        return item.title;\n      } else {\n        return '';\n      }\n    };\n    var sanitizeList = function (list, extractValue) {\n      var out = [];\n      global$5.each(list, function (item) {\n        var text = getText(item);\n        if (item.menu !== undefined) {\n          var items = sanitizeList(item.menu, extractValue);\n          out.push({\n            text: text,\n            items: items\n          });\n        } else {\n          var value = extractValue(item);\n          out.push({\n            text: text,\n            value: value\n          });\n        }\n      });\n      return out;\n    };\n    var sanitizeWith = function (extracter) {\n      if (extracter === void 0) {\n        extracter = getValue;\n      }\n      return function (list) {\n        return Optional.from(list).map(function (list) {\n          return sanitizeList(list, extracter);\n        });\n      };\n    };\n    var sanitize = function (list) {\n      return sanitizeWith(getValue)(list);\n    };\n    var createUi = function (name, label) {\n      return function (items) {\n        return {\n          name: name,\n          type: 'listbox',\n          label: label,\n          items: items\n        };\n      };\n    };\n    var ListOptions = {\n      sanitize: sanitize,\n      sanitizeWith: sanitizeWith,\n      createUi: createUi,\n      getValue: getValue\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var objAcc = function (r) {\n      return function (x, i) {\n        r[i] = x;\n      };\n    };\n    var internalFilter = function (obj, pred, onTrue, onFalse) {\n      var r = {};\n      each(obj, function (x, i) {\n        (pred(x, i) ? onTrue : onFalse)(x, i);\n      });\n      return r;\n    };\n    var filter = function (obj, pred) {\n      var t = {};\n      internalFilter(obj, pred, objAcc(t), noop);\n      return t;\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n    var hasNonNullableKey = function (obj, key) {\n      return has(obj, key) && obj[key] !== undefined && obj[key] !== null;\n    };\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.dom.TreeWalker');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.URI');\n\n    var isAnchor = function (elm) {\n      return elm && elm.nodeName.toLowerCase() === 'a';\n    };\n    var isLink = function (elm) {\n      return isAnchor(elm) && !!getHref(elm);\n    };\n    var collectNodesInRange = function (rng, predicate) {\n      if (rng.collapsed) {\n        return [];\n      } else {\n        var contents = rng.cloneContents();\n        var walker = new global$4(contents.firstChild, contents);\n        var elements = [];\n        var current = contents.firstChild;\n        do {\n          if (predicate(current)) {\n            elements.push(current);\n          }\n        } while (current = walker.next());\n        return elements;\n      }\n    };\n    var hasProtocol = function (url) {\n      return /^\\w+:/i.test(url);\n    };\n    var getHref = function (elm) {\n      var href = elm.getAttribute('data-mce-href');\n      return href ? href : elm.getAttribute('href');\n    };\n    var applyRelTargetRules = function (rel, isUnsafe) {\n      var rules = ['noopener'];\n      var rels = rel ? rel.split(/\\s+/) : [];\n      var toString = function (rels) {\n        return global$5.trim(rels.sort().join(' '));\n      };\n      var addTargetRules = function (rels) {\n        rels = removeTargetRules(rels);\n        return rels.length > 0 ? rels.concat(rules) : rules;\n      };\n      var removeTargetRules = function (rels) {\n        return rels.filter(function (val) {\n          return global$5.inArray(rules, val) === -1;\n        });\n      };\n      var newRels = isUnsafe ? addTargetRules(rels) : removeTargetRules(rels);\n      return newRels.length > 0 ? toString(newRels) : '';\n    };\n    var trimCaretContainers = function (text) {\n      return text.replace(/\\uFEFF/g, '');\n    };\n    var getAnchorElement = function (editor, selectedElm) {\n      selectedElm = selectedElm || editor.selection.getNode();\n      if (isImageFigure(selectedElm)) {\n        return editor.dom.select('a[href]', selectedElm)[0];\n      } else {\n        return editor.dom.getParent(selectedElm, 'a[href]');\n      }\n    };\n    var getAnchorText = function (selection, anchorElm) {\n      var text = anchorElm ? anchorElm.innerText || anchorElm.textContent : selection.getContent({ format: 'text' });\n      return trimCaretContainers(text);\n    };\n    var hasLinks = function (elements) {\n      return global$5.grep(elements, isLink).length > 0;\n    };\n    var hasLinksInSelection = function (rng) {\n      return collectNodesInRange(rng, isLink).length > 0;\n    };\n    var isOnlyTextSelected = function (editor) {\n      var inlineTextElements = editor.schema.getTextInlineElements();\n      var isElement = function (elm) {\n        return elm.nodeType === 1 && !isAnchor(elm) && !has(inlineTextElements, elm.nodeName.toLowerCase());\n      };\n      var elements = collectNodesInRange(editor.selection.getRng(), isElement);\n      return elements.length === 0;\n    };\n    var isImageFigure = function (elm) {\n      return elm && elm.nodeName === 'FIGURE' && /\\bimage\\b/i.test(elm.className);\n    };\n    var getLinkAttrs = function (data) {\n      var attrs = [\n        'title',\n        'rel',\n        'class',\n        'target'\n      ];\n      return foldl(attrs, function (acc, key) {\n        data[key].each(function (value) {\n          acc[key] = value.length > 0 ? value : null;\n        });\n        return acc;\n      }, { href: data.href });\n    };\n    var handleExternalTargets = function (href, assumeExternalTargets) {\n      if ((assumeExternalTargets === 'http' || assumeExternalTargets === 'https') && !hasProtocol(href)) {\n        return assumeExternalTargets + '://' + href;\n      }\n      return href;\n    };\n    var applyLinkOverrides = function (editor, linkAttrs) {\n      var newLinkAttrs = __assign({}, linkAttrs);\n      if (!(getRelList(editor).length > 0) && allowUnsafeLinkTarget(editor) === false) {\n        var newRel = applyRelTargetRules(newLinkAttrs.rel, newLinkAttrs.target === '_blank');\n        newLinkAttrs.rel = newRel ? newRel : null;\n      }\n      if (Optional.from(newLinkAttrs.target).isNone() && getTargetList(editor) === false) {\n        newLinkAttrs.target = getDefaultLinkTarget(editor);\n      }\n      newLinkAttrs.href = handleExternalTargets(newLinkAttrs.href, assumeExternalTargets(editor));\n      return newLinkAttrs;\n    };\n    var updateLink = function (editor, anchorElm, text, linkAttrs) {\n      text.each(function (text) {\n        if (has(anchorElm, 'innerText')) {\n          anchorElm.innerText = text;\n        } else {\n          anchorElm.textContent = text;\n        }\n      });\n      editor.dom.setAttribs(anchorElm, linkAttrs);\n      editor.selection.select(anchorElm);\n    };\n    var createLink = function (editor, selectedElm, text, linkAttrs) {\n      if (isImageFigure(selectedElm)) {\n        linkImageFigure(editor, selectedElm, linkAttrs);\n      } else {\n        text.fold(function () {\n          editor.execCommand('mceInsertLink', false, linkAttrs);\n        }, function (text) {\n          editor.insertContent(editor.dom.createHTML('a', linkAttrs, editor.dom.encode(text)));\n        });\n      }\n    };\n    var linkDomMutation = function (editor, attachState, data) {\n      var selectedElm = editor.selection.getNode();\n      var anchorElm = getAnchorElement(editor, selectedElm);\n      var linkAttrs = applyLinkOverrides(editor, getLinkAttrs(data));\n      editor.undoManager.transact(function () {\n        if (data.href === attachState.href) {\n          attachState.attach();\n        }\n        if (anchorElm) {\n          editor.focus();\n          updateLink(editor, anchorElm, data.text, linkAttrs);\n        } else {\n          createLink(editor, selectedElm, data.text, linkAttrs);\n        }\n      });\n    };\n    var unlinkSelection = function (editor) {\n      var dom = editor.dom, selection = editor.selection;\n      var bookmark = selection.getBookmark();\n      var rng = selection.getRng().cloneRange();\n      var startAnchorElm = dom.getParent(rng.startContainer, 'a[href]', editor.getBody());\n      var endAnchorElm = dom.getParent(rng.endContainer, 'a[href]', editor.getBody());\n      if (startAnchorElm) {\n        rng.setStartBefore(startAnchorElm);\n      }\n      if (endAnchorElm) {\n        rng.setEndAfter(endAnchorElm);\n      }\n      selection.setRng(rng);\n      editor.execCommand('unlink');\n      selection.moveToBookmark(bookmark);\n    };\n    var unlinkDomMutation = function (editor) {\n      editor.undoManager.transact(function () {\n        var node = editor.selection.getNode();\n        if (isImageFigure(node)) {\n          unlinkImageFigure(editor, node);\n        } else {\n          unlinkSelection(editor);\n        }\n        editor.focus();\n      });\n    };\n    var unwrapOptions = function (data) {\n      var cls = data.class, href = data.href, rel = data.rel, target = data.target, text = data.text, title = data.title;\n      return filter({\n        class: cls.getOrNull(),\n        href: href,\n        rel: rel.getOrNull(),\n        target: target.getOrNull(),\n        text: text.getOrNull(),\n        title: title.getOrNull()\n      }, function (v, _k) {\n        return isNull(v) === false;\n      });\n    };\n    var sanitizeData = function (editor, data) {\n      var href = data.href;\n      return __assign(__assign({}, data), { href: global$3.isDomSafe(href, 'a', editor.settings) ? href : '' });\n    };\n    var link = function (editor, attachState, data) {\n      var sanitizedData = sanitizeData(editor, data);\n      editor.hasPlugin('rtc', true) ? editor.execCommand('createlink', false, unwrapOptions(sanitizedData)) : linkDomMutation(editor, attachState, sanitizedData);\n    };\n    var unlink = function (editor) {\n      editor.hasPlugin('rtc', true) ? editor.execCommand('unlink') : unlinkDomMutation(editor);\n    };\n    var unlinkImageFigure = function (editor, fig) {\n      var img = editor.dom.select('img', fig)[0];\n      if (img) {\n        var a = editor.dom.getParents(img, 'a[href]', fig)[0];\n        if (a) {\n          a.parentNode.insertBefore(img, a);\n          editor.dom.remove(a);\n        }\n      }\n    };\n    var linkImageFigure = function (editor, fig, attrs) {\n      var img = editor.dom.select('img', fig)[0];\n      if (img) {\n        var a = editor.dom.create('a', attrs);\n        img.parentNode.insertBefore(a, img);\n        a.appendChild(img);\n      }\n    };\n\n    var isListGroup = function (item) {\n      return hasNonNullableKey(item, 'items');\n    };\n    var findTextByValue = function (value, catalog) {\n      return findMap(catalog, function (item) {\n        if (isListGroup(item)) {\n          return findTextByValue(value, item.items);\n        } else {\n          return someIf(item.value === value, item);\n        }\n      });\n    };\n    var getDelta = function (persistentText, fieldName, catalog, data) {\n      var value = data[fieldName];\n      var hasPersistentText = persistentText.length > 0;\n      return value !== undefined ? findTextByValue(value, catalog).map(function (i) {\n        return {\n          url: {\n            value: i.value,\n            meta: {\n              text: hasPersistentText ? persistentText : i.text,\n              attach: noop\n            }\n          },\n          text: hasPersistentText ? persistentText : i.text\n        };\n      }) : Optional.none();\n    };\n    var findCatalog = function (catalogs, fieldName) {\n      if (fieldName === 'link') {\n        return catalogs.link;\n      } else if (fieldName === 'anchor') {\n        return catalogs.anchor;\n      } else {\n        return Optional.none();\n      }\n    };\n    var init = function (initialData, linkCatalog) {\n      var persistentData = {\n        text: initialData.text,\n        title: initialData.title\n      };\n      var getTitleFromUrlChange = function (url) {\n        return someIf(persistentData.title.length <= 0, Optional.from(url.meta.title).getOr(''));\n      };\n      var getTextFromUrlChange = function (url) {\n        return someIf(persistentData.text.length <= 0, Optional.from(url.meta.text).getOr(url.value));\n      };\n      var onUrlChange = function (data) {\n        var text = getTextFromUrlChange(data.url);\n        var title = getTitleFromUrlChange(data.url);\n        if (text.isSome() || title.isSome()) {\n          return Optional.some(__assign(__assign({}, text.map(function (text) {\n            return { text: text };\n          }).getOr({})), title.map(function (title) {\n            return { title: title };\n          }).getOr({})));\n        } else {\n          return Optional.none();\n        }\n      };\n      var onCatalogChange = function (data, change) {\n        var catalog = findCatalog(linkCatalog, change.name).getOr([]);\n        return getDelta(persistentData.text, change.name, catalog, data);\n      };\n      var onChange = function (getData, change) {\n        var name = change.name;\n        if (name === 'url') {\n          return onUrlChange(getData());\n        } else if (contains([\n            'anchor',\n            'link'\n          ], name)) {\n          return onCatalogChange(getData(), change);\n        } else if (name === 'text' || name === 'title') {\n          persistentData[name] = getData()[name];\n          return Optional.none();\n        } else {\n          return Optional.none();\n        }\n      };\n      return { onChange: onChange };\n    };\n    var DialogChanges = {\n      init: init,\n      getDelta: getDelta\n    };\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var delayedConfirm = function (editor, message, callback) {\n      var rng = editor.selection.getRng();\n      global$2.setEditorTimeout(editor, function () {\n        editor.windowManager.confirm(message, function (state) {\n          editor.selection.setRng(rng);\n          callback(state);\n        });\n      });\n    };\n    var tryEmailTransform = function (data) {\n      var url = data.href;\n      var suggestMailTo = url.indexOf('@') > 0 && url.indexOf('/') === -1 && url.indexOf('mailto:') === -1;\n      return suggestMailTo ? Optional.some({\n        message: 'The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?',\n        preprocess: function (oldData) {\n          return __assign(__assign({}, oldData), { href: 'mailto:' + url });\n        }\n      }) : Optional.none();\n    };\n    var tryProtocolTransform = function (assumeExternalTargets, defaultLinkProtocol) {\n      return function (data) {\n        var url = data.href;\n        var suggestProtocol = assumeExternalTargets === 1 && !hasProtocol(url) || assumeExternalTargets === 0 && /^\\s*www(\\.|\\d\\.)/i.test(url);\n        return suggestProtocol ? Optional.some({\n          message: 'The URL you entered seems to be an external link. Do you want to add the required ' + defaultLinkProtocol + ':// prefix?',\n          preprocess: function (oldData) {\n            return __assign(__assign({}, oldData), { href: defaultLinkProtocol + '://' + url });\n          }\n        }) : Optional.none();\n      };\n    };\n    var preprocess = function (editor, data) {\n      return findMap([\n        tryEmailTransform,\n        tryProtocolTransform(assumeExternalTargets(editor), getDefaultLinkProtocol(editor))\n      ], function (f) {\n        return f(data);\n      }).fold(function () {\n        return global$1.resolve(data);\n      }, function (transform) {\n        return new global$1(function (callback) {\n          delayedConfirm(editor, transform.message, function (state) {\n            callback(state ? transform.preprocess(data) : data);\n          });\n        });\n      });\n    };\n    var DialogConfirms = { preprocess: preprocess };\n\n    var getAnchors = function (editor) {\n      var anchorNodes = editor.dom.select('a:not([href])');\n      var anchors = bind(anchorNodes, function (anchor) {\n        var id = anchor.name || anchor.id;\n        return id ? [{\n            text: id,\n            value: '#' + id\n          }] : [];\n      });\n      return anchors.length > 0 ? Optional.some([{\n          text: 'None',\n          value: ''\n        }].concat(anchors)) : Optional.none();\n    };\n    var AnchorListOptions = { getAnchors: getAnchors };\n\n    var getClasses = function (editor) {\n      var list = getLinkClassList(editor);\n      if (list.length > 0) {\n        return ListOptions.sanitize(list);\n      }\n      return Optional.none();\n    };\n    var ClassListOptions = { getClasses: getClasses };\n\n    var global = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n    var parseJson = function (text) {\n      try {\n        return Optional.some(JSON.parse(text));\n      } catch (err) {\n        return Optional.none();\n      }\n    };\n    var getLinks = function (editor) {\n      var extractor = function (item) {\n        return editor.convertURL(item.value || item.url, 'href');\n      };\n      var linkList = getLinkList(editor);\n      return new global$1(function (callback) {\n        if (isString(linkList)) {\n          global.send({\n            url: linkList,\n            success: function (text) {\n              return callback(parseJson(text));\n            },\n            error: function (_) {\n              return callback(Optional.none());\n            }\n          });\n        } else if (isFunction(linkList)) {\n          linkList(function (output) {\n            return callback(Optional.some(output));\n          });\n        } else {\n          callback(Optional.from(linkList));\n        }\n      }).then(function (optItems) {\n        return optItems.bind(ListOptions.sanitizeWith(extractor)).map(function (items) {\n          if (items.length > 0) {\n            var noneItem = [{\n                text: 'None',\n                value: ''\n              }];\n            return noneItem.concat(items);\n          } else {\n            return items;\n          }\n        });\n      });\n    };\n    var LinkListOptions = { getLinks: getLinks };\n\n    var getRels = function (editor, initialTarget) {\n      var list = getRelList(editor);\n      if (list.length > 0) {\n        var isTargetBlank_1 = is(initialTarget, '_blank');\n        var enforceSafe = allowUnsafeLinkTarget(editor) === false;\n        var safeRelExtractor = function (item) {\n          return applyRelTargetRules(ListOptions.getValue(item), isTargetBlank_1);\n        };\n        var sanitizer = enforceSafe ? ListOptions.sanitizeWith(safeRelExtractor) : ListOptions.sanitize;\n        return sanitizer(list);\n      }\n      return Optional.none();\n    };\n    var RelOptions = { getRels: getRels };\n\n    var fallbacks = [\n      {\n        text: 'Current window',\n        value: ''\n      },\n      {\n        text: 'New window',\n        value: '_blank'\n      }\n    ];\n    var getTargets = function (editor) {\n      var list = getTargetList(editor);\n      if (isArray(list)) {\n        return ListOptions.sanitize(list).orThunk(function () {\n          return Optional.some(fallbacks);\n        });\n      } else if (list === false) {\n        return Optional.none();\n      }\n      return Optional.some(fallbacks);\n    };\n    var TargetOptions = { getTargets: getTargets };\n\n    var nonEmptyAttr = function (dom, elem, name) {\n      var val = dom.getAttrib(elem, name);\n      return val !== null && val.length > 0 ? Optional.some(val) : Optional.none();\n    };\n    var extractFromAnchor = function (editor, anchor) {\n      var dom = editor.dom;\n      var onlyText = isOnlyTextSelected(editor);\n      var text = onlyText ? Optional.some(getAnchorText(editor.selection, anchor)) : Optional.none();\n      var url = anchor ? Optional.some(dom.getAttrib(anchor, 'href')) : Optional.none();\n      var target = anchor ? Optional.from(dom.getAttrib(anchor, 'target')) : Optional.none();\n      var rel = nonEmptyAttr(dom, anchor, 'rel');\n      var linkClass = nonEmptyAttr(dom, anchor, 'class');\n      var title = nonEmptyAttr(dom, anchor, 'title');\n      return {\n        url: url,\n        text: text,\n        title: title,\n        target: target,\n        rel: rel,\n        linkClass: linkClass\n      };\n    };\n    var collect = function (editor, linkNode) {\n      return LinkListOptions.getLinks(editor).then(function (links) {\n        var anchor = extractFromAnchor(editor, linkNode);\n        return {\n          anchor: anchor,\n          catalogs: {\n            targets: TargetOptions.getTargets(editor),\n            rels: RelOptions.getRels(editor, anchor.target),\n            classes: ClassListOptions.getClasses(editor),\n            anchor: AnchorListOptions.getAnchors(editor),\n            link: links\n          },\n          optNode: Optional.from(linkNode),\n          flags: { titleEnabled: shouldShowLinkTitle(editor) }\n        };\n      });\n    };\n    var DialogInfo = { collect: collect };\n\n    var handleSubmit = function (editor, info) {\n      return function (api) {\n        var data = api.getData();\n        if (!data.url.value) {\n          unlink(editor);\n          api.close();\n          return;\n        }\n        var getChangedValue = function (key) {\n          return Optional.from(data[key]).filter(function (value) {\n            return !is(info.anchor[key], value);\n          });\n        };\n        var changedData = {\n          href: data.url.value,\n          text: getChangedValue('text'),\n          target: getChangedValue('target'),\n          rel: getChangedValue('rel'),\n          class: getChangedValue('linkClass'),\n          title: getChangedValue('title')\n        };\n        var attachState = {\n          href: data.url.value,\n          attach: data.url.meta !== undefined && data.url.meta.attach ? data.url.meta.attach : noop\n        };\n        DialogConfirms.preprocess(editor, changedData).then(function (pData) {\n          link(editor, attachState, pData);\n        });\n        api.close();\n      };\n    };\n    var collectData = function (editor) {\n      var anchorNode = getAnchorElement(editor);\n      return DialogInfo.collect(editor, anchorNode);\n    };\n    var getInitialData = function (info, defaultTarget) {\n      var anchor = info.anchor;\n      var url = anchor.url.getOr('');\n      return {\n        url: {\n          value: url,\n          meta: { original: { value: url } }\n        },\n        text: anchor.text.getOr(''),\n        title: anchor.title.getOr(''),\n        anchor: url,\n        link: url,\n        rel: anchor.rel.getOr(''),\n        target: anchor.target.or(defaultTarget).getOr(''),\n        linkClass: anchor.linkClass.getOr('')\n      };\n    };\n    var makeDialog = function (settings, onSubmit, editor) {\n      var urlInput = [{\n          name: 'url',\n          type: 'urlinput',\n          filetype: 'file',\n          label: 'URL'\n        }];\n      var displayText = settings.anchor.text.map(function () {\n        return {\n          name: 'text',\n          type: 'input',\n          label: 'Text to display'\n        };\n      }).toArray();\n      var titleText = settings.flags.titleEnabled ? [{\n          name: 'title',\n          type: 'input',\n          label: 'Title'\n        }] : [];\n      var defaultTarget = Optional.from(getDefaultLinkTarget(editor));\n      var initialData = getInitialData(settings, defaultTarget);\n      var catalogs = settings.catalogs;\n      var dialogDelta = DialogChanges.init(initialData, catalogs);\n      var body = {\n        type: 'panel',\n        items: flatten([\n          urlInput,\n          displayText,\n          titleText,\n          cat([\n            catalogs.anchor.map(ListOptions.createUi('anchor', 'Anchors')),\n            catalogs.rels.map(ListOptions.createUi('rel', 'Rel')),\n            catalogs.targets.map(ListOptions.createUi('target', 'Open link in...')),\n            catalogs.link.map(ListOptions.createUi('link', 'Link list')),\n            catalogs.classes.map(ListOptions.createUi('linkClass', 'Class'))\n          ])\n        ])\n      };\n      return {\n        title: 'Insert/Edit Link',\n        size: 'normal',\n        body: body,\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: initialData,\n        onChange: function (api, _a) {\n          var name = _a.name;\n          dialogDelta.onChange(api.getData, { name: name }).each(function (newData) {\n            api.setData(newData);\n          });\n        },\n        onSubmit: onSubmit\n      };\n    };\n    var open$1 = function (editor) {\n      var data = collectData(editor);\n      data.then(function (info) {\n        var onSubmit = handleSubmit(editor, info);\n        return makeDialog(info, onSubmit, editor);\n      }).then(function (spec) {\n        editor.windowManager.open(spec);\n      });\n    };\n\n    var appendClickRemove = function (link, evt) {\n      document.body.appendChild(link);\n      link.dispatchEvent(evt);\n      document.body.removeChild(link);\n    };\n    var open = function (url) {\n      var link = document.createElement('a');\n      link.target = '_blank';\n      link.href = url;\n      link.rel = 'noreferrer noopener';\n      var evt = document.createEvent('MouseEvents');\n      evt.initMouseEvent('click', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n      appendClickRemove(link, evt);\n    };\n\n    var getLink = function (editor, elm) {\n      return editor.dom.getParent(elm, 'a[href]');\n    };\n    var getSelectedLink = function (editor) {\n      return getLink(editor, editor.selection.getStart());\n    };\n    var hasOnlyAltModifier = function (e) {\n      return e.altKey === true && e.shiftKey === false && e.ctrlKey === false && e.metaKey === false;\n    };\n    var gotoLink = function (editor, a) {\n      if (a) {\n        var href = getHref(a);\n        if (/^#/.test(href)) {\n          var targetEl = editor.$(href);\n          if (targetEl.length) {\n            editor.selection.scrollIntoView(targetEl[0], true);\n          }\n        } else {\n          open(a.href);\n        }\n      }\n    };\n    var openDialog = function (editor) {\n      return function () {\n        open$1(editor);\n      };\n    };\n    var gotoSelectedLink = function (editor) {\n      return function () {\n        gotoLink(editor, getSelectedLink(editor));\n      };\n    };\n    var setupGotoLinks = function (editor) {\n      editor.on('click', function (e) {\n        var link = getLink(editor, e.target);\n        if (link && global$6.metaKeyPressed(e)) {\n          e.preventDefault();\n          gotoLink(editor, link);\n        }\n      });\n      editor.on('keydown', function (e) {\n        var link = getSelectedLink(editor);\n        if (link && e.keyCode === 13 && hasOnlyAltModifier(e)) {\n          e.preventDefault();\n          gotoLink(editor, link);\n        }\n      });\n    };\n    var toggleState = function (editor, toggler) {\n      editor.on('NodeChange', toggler);\n      return function () {\n        return editor.off('NodeChange', toggler);\n      };\n    };\n    var toggleActiveState = function (editor) {\n      return function (api) {\n        var updateState = function () {\n          return api.setActive(!editor.mode.isReadOnly() && getAnchorElement(editor, editor.selection.getNode()) !== null);\n        };\n        updateState();\n        return toggleState(editor, updateState);\n      };\n    };\n    var toggleEnabledState = function (editor) {\n      return function (api) {\n        var updateState = function () {\n          return api.setDisabled(getAnchorElement(editor, editor.selection.getNode()) === null);\n        };\n        updateState();\n        return toggleState(editor, updateState);\n      };\n    };\n    var toggleUnlinkState = function (editor) {\n      return function (api) {\n        var hasLinks$1 = function (parents) {\n          return hasLinks(parents) || hasLinksInSelection(editor.selection.getRng());\n        };\n        var parents = editor.dom.getParents(editor.selection.getStart());\n        api.setDisabled(!hasLinks$1(parents));\n        return toggleState(editor, function (e) {\n          return api.setDisabled(!hasLinks$1(e.parents));\n        });\n      };\n    };\n\n    var register = function (editor) {\n      editor.addCommand('mceLink', function () {\n        if (useQuickLink(editor)) {\n          editor.fire('contexttoolbar-show', { toolbarKey: 'quicklink' });\n        } else {\n          openDialog(editor)();\n        }\n      });\n    };\n\n    var setup = function (editor) {\n      editor.addShortcut('Meta+K', '', function () {\n        editor.execCommand('mceLink');\n      });\n    };\n\n    var setupButtons = function (editor) {\n      editor.ui.registry.addToggleButton('link', {\n        icon: 'link',\n        tooltip: 'Insert/edit link',\n        onAction: openDialog(editor),\n        onSetup: toggleActiveState(editor)\n      });\n      editor.ui.registry.addButton('openlink', {\n        icon: 'new-tab',\n        tooltip: 'Open link',\n        onAction: gotoSelectedLink(editor),\n        onSetup: toggleEnabledState(editor)\n      });\n      editor.ui.registry.addButton('unlink', {\n        icon: 'unlink',\n        tooltip: 'Remove link',\n        onAction: function () {\n          return unlink(editor);\n        },\n        onSetup: toggleUnlinkState(editor)\n      });\n    };\n    var setupMenuItems = function (editor) {\n      editor.ui.registry.addMenuItem('openlink', {\n        text: 'Open link',\n        icon: 'new-tab',\n        onAction: gotoSelectedLink(editor),\n        onSetup: toggleEnabledState(editor)\n      });\n      editor.ui.registry.addMenuItem('link', {\n        icon: 'link',\n        text: 'Link...',\n        shortcut: 'Meta+K',\n        onAction: openDialog(editor)\n      });\n      editor.ui.registry.addMenuItem('unlink', {\n        icon: 'unlink',\n        text: 'Remove link',\n        onAction: function () {\n          return unlink(editor);\n        },\n        onSetup: toggleUnlinkState(editor)\n      });\n    };\n    var setupContextMenu = function (editor) {\n      var inLink = 'link unlink openlink';\n      var noLink = 'link';\n      editor.ui.registry.addContextMenu('link', {\n        update: function (element) {\n          return hasLinks(editor.dom.getParents(element, 'a')) ? inLink : noLink;\n        }\n      });\n    };\n    var setupContextToolbars = function (editor) {\n      var collapseSelectionToEnd = function (editor) {\n        editor.selection.collapse(false);\n      };\n      var onSetupLink = function (buttonApi) {\n        var node = editor.selection.getNode();\n        buttonApi.setDisabled(!getAnchorElement(editor, node));\n        return noop;\n      };\n      var getLinkText = function (value) {\n        var anchor = getAnchorElement(editor);\n        var onlyText = isOnlyTextSelected(editor);\n        if (!anchor && onlyText) {\n          var text = getAnchorText(editor.selection, anchor);\n          return Optional.some(text.length > 0 ? text : value);\n        } else {\n          return Optional.none();\n        }\n      };\n      editor.ui.registry.addContextForm('quicklink', {\n        launch: {\n          type: 'contextformtogglebutton',\n          icon: 'link',\n          tooltip: 'Link',\n          onSetup: toggleActiveState(editor)\n        },\n        label: 'Link',\n        predicate: function (node) {\n          return !!getAnchorElement(editor, node) && hasContextToolbar(editor);\n        },\n        initValue: function () {\n          var elm = getAnchorElement(editor);\n          return !!elm ? getHref(elm) : '';\n        },\n        commands: [\n          {\n            type: 'contextformtogglebutton',\n            icon: 'link',\n            tooltip: 'Link',\n            primary: true,\n            onSetup: function (buttonApi) {\n              var node = editor.selection.getNode();\n              buttonApi.setActive(!!getAnchorElement(editor, node));\n              return toggleActiveState(editor)(buttonApi);\n            },\n            onAction: function (formApi) {\n              var value = formApi.getValue();\n              var text = getLinkText(value);\n              var attachState = {\n                href: value,\n                attach: noop\n              };\n              link(editor, attachState, {\n                href: value,\n                text: text,\n                title: Optional.none(),\n                rel: Optional.none(),\n                target: Optional.none(),\n                class: Optional.none()\n              });\n              collapseSelectionToEnd(editor);\n              formApi.hide();\n            }\n          },\n          {\n            type: 'contextformbutton',\n            icon: 'unlink',\n            tooltip: 'Remove link',\n            onSetup: onSetupLink,\n            onAction: function (formApi) {\n              unlink(editor);\n              formApi.hide();\n            }\n          },\n          {\n            type: 'contextformbutton',\n            icon: 'new-tab',\n            tooltip: 'Open link',\n            onSetup: onSetupLink,\n            onAction: function (formApi) {\n              gotoSelectedLink(editor)();\n              formApi.hide();\n            }\n          }\n        ]\n      });\n    };\n\n    function Plugin () {\n      global$7.add('link', function (editor) {\n        setupButtons(editor);\n        setupMenuItems(editor);\n        setupContextMenu(editor);\n        setupContextToolbars(editor);\n        setupGotoLinks(editor);\n        register(editor);\n        setup(editor);\n      });\n    }\n\n    Plugin();\n\n}());\n"]},"metadata":{},"sourceType":"script"}