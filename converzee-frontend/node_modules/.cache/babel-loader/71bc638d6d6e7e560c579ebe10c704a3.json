{"ast":null,"code":"/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.10.2 (2021-11-17)\n */\n(function () {\n  'use strict';\n\n  var typeOf = function (x) {\n    var t = typeof x;\n\n    if (x === null) {\n      return 'null';\n    } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    } else {\n      return t;\n    }\n  };\n\n  var isType$1 = function (type) {\n    return function (value) {\n      return typeOf(value) === type;\n    };\n  };\n\n  var isSimpleType = function (type) {\n    return function (value) {\n      return typeof value === type;\n    };\n  };\n\n  var eq$2 = function (t) {\n    return function (a) {\n      return t === a;\n    };\n  };\n\n  var isString = isType$1('string');\n  var isObject = isType$1('object');\n  var isArray = isType$1('array');\n  var isNull = eq$2(null);\n  var isBoolean = isSimpleType('boolean');\n  var isUndefined = eq$2(undefined);\n\n  var isNullable = function (a) {\n    return a === null || a === undefined;\n  };\n\n  var isNonNullable = function (a) {\n    return !isNullable(a);\n  };\n\n  var isFunction = isSimpleType('function');\n  var isNumber = isSimpleType('number');\n\n  var noop = function () {};\n\n  var compose = function (fa, fb) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return fa(fb.apply(null, args));\n    };\n  };\n\n  var compose1 = function (fbc, fab) {\n    return function (a) {\n      return fbc(fab(a));\n    };\n  };\n\n  var constant = function (value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var identity = function (x) {\n    return x;\n  };\n\n  var tripleEquals = function (a, b) {\n    return a === b;\n  };\n\n  function curry(fn) {\n    var initialArgs = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      initialArgs[_i - 1] = arguments[_i];\n    }\n\n    return function () {\n      var restArgs = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        restArgs[_i] = arguments[_i];\n      }\n\n      var all = initialArgs.concat(restArgs);\n      return fn.apply(null, all);\n    };\n  }\n\n  var not = function (f) {\n    return function (t) {\n      return !f(t);\n    };\n  };\n\n  var die = function (msg) {\n    return function () {\n      throw new Error(msg);\n    };\n  };\n\n  var never = constant(false);\n  var always = constant(true);\n\n  var none$2 = function () {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var call = function (thunk) {\n      return thunk();\n    };\n\n    var id = identity;\n    var me = {\n      fold: function (n, _s) {\n        return n();\n      },\n      isSome: never,\n      isNone: always,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function (msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: constant(null),\n      getOrUndefined: constant(undefined),\n      or: id,\n      orThunk: call,\n      map: none$2,\n      each: noop,\n      bind: none$2,\n      exists: never,\n      forall: always,\n      filter: function () {\n        return none$2();\n      },\n      toArray: function () {\n        return [];\n      },\n      toString: constant('none()')\n    };\n    return me;\n  }();\n\n  var some = function (a) {\n    var constant_a = constant(a);\n\n    var self = function () {\n      return me;\n    };\n\n    var bind = function (f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function (n, s) {\n        return s(a);\n      },\n      isSome: always,\n      isNone: never,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: function (f) {\n        return some(f(a));\n      },\n      each: function (f) {\n        f(a);\n      },\n      bind: bind,\n      exists: bind,\n      forall: bind,\n      filter: function (f) {\n        return f(a) ? me : NONE;\n      },\n      toArray: function () {\n        return [a];\n      },\n      toString: function () {\n        return 'some(' + a + ')';\n      }\n    };\n    return me;\n  };\n\n  var from$1 = function (value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Optional = {\n    some: some,\n    none: none$2,\n    from: from$1\n  };\n  var nativeSlice = Array.prototype.slice;\n  var nativeIndexOf = Array.prototype.indexOf;\n  var nativePush = Array.prototype.push;\n\n  var rawIndexOf = function (ts, t) {\n    return nativeIndexOf.call(ts, t);\n  };\n\n  var contains$2 = function (xs, x) {\n    return rawIndexOf(xs, x) > -1;\n  };\n\n  var exists = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var range$1 = function (num, f) {\n    var r = [];\n\n    for (var i = 0; i < num; i++) {\n      r.push(f(i));\n    }\n\n    return r;\n  };\n\n  var map$1 = function (xs, f) {\n    var len = xs.length;\n    var r = new Array(len);\n\n    for (var i = 0; i < len; i++) {\n      var x = xs[i];\n      r[i] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var each$2 = function (xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var eachr = function (xs, f) {\n    for (var i = xs.length - 1; i >= 0; i--) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var partition = function (xs, pred) {\n    var pass = [];\n    var fail = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      var arr = pred(x, i) ? pass : fail;\n      arr.push(x);\n    }\n\n    return {\n      pass: pass,\n      fail: fail\n    };\n  };\n\n  var filter$2 = function (xs, pred) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        r.push(x);\n      }\n    }\n\n    return r;\n  };\n\n  var foldr = function (xs, f, acc) {\n    eachr(xs, function (x, i) {\n      acc = f(acc, x, i);\n    });\n    return acc;\n  };\n\n  var foldl = function (xs, f, acc) {\n    each$2(xs, function (x, i) {\n      acc = f(acc, x, i);\n    });\n    return acc;\n  };\n\n  var findUntil = function (xs, pred, until) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(x);\n      } else if (until(x, i)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var find$1 = function (xs, pred) {\n    return findUntil(xs, pred, never);\n  };\n\n  var findIndex = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(i);\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var flatten$1 = function (xs) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (!isArray(xs[i])) {\n        throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n      }\n\n      nativePush.apply(r, xs[i]);\n    }\n\n    return r;\n  };\n\n  var bind$2 = function (xs, f) {\n    return flatten$1(map$1(xs, f));\n  };\n\n  var forall = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      var x = xs[i];\n\n      if (pred(x, i) !== true) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  var reverse = function (xs) {\n    var r = nativeSlice.call(xs, 0);\n    r.reverse();\n    return r;\n  };\n\n  var mapToObject = function (xs, f) {\n    var r = {};\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      r[String(x)] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var pure = function (x) {\n    return [x];\n  };\n\n  var sort$1 = function (xs, comparator) {\n    var copy = nativeSlice.call(xs, 0);\n    copy.sort(comparator);\n    return copy;\n  };\n\n  var get$d = function (xs, i) {\n    return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n  };\n\n  var head = function (xs) {\n    return get$d(xs, 0);\n  };\n\n  var last$2 = function (xs) {\n    return get$d(xs, xs.length - 1);\n  };\n\n  var findMap = function (arr, f) {\n    for (var i = 0; i < arr.length; i++) {\n      var r = f(arr[i], i);\n\n      if (r.isSome()) {\n        return r;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var __assign = function () {\n    __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n\n      return t;\n    };\n\n    return __assign.apply(this, arguments);\n  };\n\n  function __spreadArray(to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n        if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n        ar[i] = from[i];\n      }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n  }\n\n  var cached = function (f) {\n    var called = false;\n    var r;\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (!called) {\n        called = true;\n        r = f.apply(null, args);\n      }\n\n      return r;\n    };\n  };\n\n  var DeviceType = function (os, browser, userAgent, mediaMatch) {\n    var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n    var isiPhone = os.isiOS() && !isiPad;\n    var isMobile = os.isiOS() || os.isAndroid();\n    var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n    var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n    var isPhone = isiPhone || isMobile && !isTablet;\n    var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n    var isDesktop = !isPhone && !isTablet && !iOSwebview;\n    return {\n      isiPad: constant(isiPad),\n      isiPhone: constant(isiPhone),\n      isTablet: constant(isTablet),\n      isPhone: constant(isPhone),\n      isTouch: constant(isTouch),\n      isAndroid: os.isAndroid,\n      isiOS: os.isiOS,\n      isWebView: constant(iOSwebview),\n      isDesktop: constant(isDesktop)\n    };\n  };\n\n  var firstMatch = function (regexes, s) {\n    for (var i = 0; i < regexes.length; i++) {\n      var x = regexes[i];\n\n      if (x.test(s)) {\n        return x;\n      }\n    }\n\n    return undefined;\n  };\n\n  var find = function (regexes, agent) {\n    var r = firstMatch(regexes, agent);\n\n    if (!r) {\n      return {\n        major: 0,\n        minor: 0\n      };\n    }\n\n    var group = function (i) {\n      return Number(agent.replace(r, '$' + i));\n    };\n\n    return nu$2(group(1), group(2));\n  };\n\n  var detect$6 = function (versionRegexes, agent) {\n    var cleanedAgent = String(agent).toLowerCase();\n\n    if (versionRegexes.length === 0) {\n      return unknown$2();\n    }\n\n    return find(versionRegexes, cleanedAgent);\n  };\n\n  var unknown$2 = function () {\n    return nu$2(0, 0);\n  };\n\n  var nu$2 = function (major, minor) {\n    return {\n      major: major,\n      minor: minor\n    };\n  };\n\n  var Version = {\n    nu: nu$2,\n    detect: detect$6,\n    unknown: unknown$2\n  };\n\n  var detectBrowser$1 = function (browsers, userAgentData) {\n    return findMap(userAgentData.brands, function (uaBrand) {\n      var lcBrand = uaBrand.brand.toLowerCase();\n      return find$1(browsers, function (browser) {\n        var _a;\n\n        return lcBrand === ((_a = browser.brand) === null || _a === void 0 ? void 0 : _a.toLowerCase());\n      }).map(function (info) {\n        return {\n          current: info.name,\n          version: Version.nu(parseInt(uaBrand.version, 10), 0)\n        };\n      });\n    });\n  };\n\n  var detect$5 = function (candidates, userAgent) {\n    var agent = String(userAgent).toLowerCase();\n    return find$1(candidates, function (candidate) {\n      return candidate.search(agent);\n    });\n  };\n\n  var detectBrowser = function (browsers, userAgent) {\n    return detect$5(browsers, userAgent).map(function (browser) {\n      var version = Version.detect(browser.versionRegexes, userAgent);\n      return {\n        current: browser.name,\n        version: version\n      };\n    });\n  };\n\n  var detectOs = function (oses, userAgent) {\n    return detect$5(oses, userAgent).map(function (os) {\n      var version = Version.detect(os.versionRegexes, userAgent);\n      return {\n        current: os.name,\n        version: version\n      };\n    });\n  };\n\n  var removeFromStart = function (str, numChars) {\n    return str.substring(numChars);\n  };\n\n  var checkRange = function (str, substr, start) {\n    return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n  };\n\n  var removeLeading = function (str, prefix) {\n    return startsWith(str, prefix) ? removeFromStart(str, prefix.length) : str;\n  };\n\n  var contains$1 = function (str, substr) {\n    return str.indexOf(substr) !== -1;\n  };\n\n  var startsWith = function (str, prefix) {\n    return checkRange(str, prefix, 0);\n  };\n\n  var endsWith = function (str, suffix) {\n    return checkRange(str, suffix, str.length - suffix.length);\n  };\n\n  var blank = function (r) {\n    return function (s) {\n      return s.replace(r, '');\n    };\n  };\n\n  var trim = blank(/^\\s+|\\s+$/g);\n\n  var isNotEmpty = function (s) {\n    return s.length > 0;\n  };\n\n  var isEmpty$1 = function (s) {\n    return !isNotEmpty(s);\n  };\n\n  var toFloat = function (value) {\n    var num = parseFloat(value);\n    return isNaN(num) ? Optional.none() : Optional.some(num);\n  };\n\n  var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n\n  var checkContains = function (target) {\n    return function (uastring) {\n      return contains$1(uastring, target);\n    };\n  };\n\n  var browsers = [{\n    name: 'Edge',\n    versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n    search: function (uastring) {\n      return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n    }\n  }, {\n    name: 'Chrome',\n    brand: 'Chromium',\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/, normalVersionRegex],\n    search: function (uastring) {\n      return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n    }\n  }, {\n    name: 'IE',\n    versionRegexes: [/.*?msie\\ ?([0-9]+)\\.([0-9]+).*/, /.*?rv:([0-9]+)\\.([0-9]+).*/],\n    search: function (uastring) {\n      return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n    }\n  }, {\n    name: 'Opera',\n    versionRegexes: [normalVersionRegex, /.*?opera\\/([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('opera')\n  }, {\n    name: 'Firefox',\n    versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('firefox')\n  }, {\n    name: 'Safari',\n    versionRegexes: [normalVersionRegex, /.*?cpu os ([0-9]+)_([0-9]+).*/],\n    search: function (uastring) {\n      return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n    }\n  }];\n  var oses = [{\n    name: 'Windows',\n    search: checkContains('win'),\n    versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'iOS',\n    search: function (uastring) {\n      return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n    },\n    versionRegexes: [/.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Android',\n    search: checkContains('android'),\n    versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'OSX',\n    search: checkContains('mac os x'),\n    versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Linux',\n    search: checkContains('linux'),\n    versionRegexes: []\n  }, {\n    name: 'Solaris',\n    search: checkContains('sunos'),\n    versionRegexes: []\n  }, {\n    name: 'FreeBSD',\n    search: checkContains('freebsd'),\n    versionRegexes: []\n  }, {\n    name: 'ChromeOS',\n    search: checkContains('cros'),\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n  }];\n  var PlatformInfo = {\n    browsers: constant(browsers),\n    oses: constant(oses)\n  };\n  var edge = 'Edge';\n  var chrome = 'Chrome';\n  var ie = 'IE';\n  var opera = 'Opera';\n  var firefox = 'Firefox';\n  var safari = 'Safari';\n\n  var unknown$1 = function () {\n    return nu$1({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$1 = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isBrowser = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isEdge: isBrowser(edge),\n      isChrome: isBrowser(chrome),\n      isIE: isBrowser(ie),\n      isOpera: isBrowser(opera),\n      isFirefox: isBrowser(firefox),\n      isSafari: isBrowser(safari)\n    };\n  };\n\n  var Browser = {\n    unknown: unknown$1,\n    nu: nu$1,\n    edge: constant(edge),\n    chrome: constant(chrome),\n    ie: constant(ie),\n    opera: constant(opera),\n    firefox: constant(firefox),\n    safari: constant(safari)\n  };\n  var windows = 'Windows';\n  var ios = 'iOS';\n  var android = 'Android';\n  var linux = 'Linux';\n  var osx = 'OSX';\n  var solaris = 'Solaris';\n  var freebsd = 'FreeBSD';\n  var chromeos = 'ChromeOS';\n\n  var unknown = function () {\n    return nu({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isOS = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isWindows: isOS(windows),\n      isiOS: isOS(ios),\n      isAndroid: isOS(android),\n      isOSX: isOS(osx),\n      isLinux: isOS(linux),\n      isSolaris: isOS(solaris),\n      isFreeBSD: isOS(freebsd),\n      isChromeOS: isOS(chromeos)\n    };\n  };\n\n  var OperatingSystem = {\n    unknown: unknown,\n    nu: nu,\n    windows: constant(windows),\n    ios: constant(ios),\n    android: constant(android),\n    linux: constant(linux),\n    osx: constant(osx),\n    solaris: constant(solaris),\n    freebsd: constant(freebsd),\n    chromeos: constant(chromeos)\n  };\n\n  var detect$4 = function (userAgent, userAgentDataOpt, mediaMatch) {\n    var browsers = PlatformInfo.browsers();\n    var oses = PlatformInfo.oses();\n    var browser = userAgentDataOpt.bind(function (userAgentData) {\n      return detectBrowser$1(browsers, userAgentData);\n    }).orThunk(function () {\n      return detectBrowser(browsers, userAgent);\n    }).fold(Browser.unknown, Browser.nu);\n    var os = detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n    var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n    return {\n      browser: browser,\n      os: os,\n      deviceType: deviceType\n    };\n  };\n\n  var PlatformDetection = {\n    detect: detect$4\n  };\n\n  var mediaMatch = function (query) {\n    return window.matchMedia(query).matches;\n  };\n\n  var platform = cached(function () {\n    return PlatformDetection.detect(navigator.userAgent, Optional.from(navigator.userAgentData), mediaMatch);\n  });\n\n  var detect$3 = function () {\n    return platform();\n  };\n\n  var compareDocumentPosition = function (a, b, match) {\n    return (a.compareDocumentPosition(b) & match) !== 0;\n  };\n\n  var documentPositionContainedBy = function (a, b) {\n    return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n  };\n\n  var COMMENT = 8;\n  var DOCUMENT = 9;\n  var DOCUMENT_FRAGMENT = 11;\n  var ELEMENT = 1;\n  var TEXT = 3;\n\n  var fromHtml$1 = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n\n    if (!div.hasChildNodes() || div.childNodes.length > 1) {\n      console.error('HTML does not have a single root node', html);\n      throw new Error('HTML must have a single root node');\n    }\n\n    return fromDom$1(div.childNodes[0]);\n  };\n\n  var fromTag = function (tag, scope) {\n    var doc = scope || document;\n    var node = doc.createElement(tag);\n    return fromDom$1(node);\n  };\n\n  var fromText = function (text, scope) {\n    var doc = scope || document;\n    var node = doc.createTextNode(text);\n    return fromDom$1(node);\n  };\n\n  var fromDom$1 = function (node) {\n    if (node === null || node === undefined) {\n      throw new Error('Node cannot be null or undefined');\n    }\n\n    return {\n      dom: node\n    };\n  };\n\n  var fromPoint$1 = function (docElm, x, y) {\n    return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom$1);\n  };\n\n  var SugarElement = {\n    fromHtml: fromHtml$1,\n    fromTag: fromTag,\n    fromText: fromText,\n    fromDom: fromDom$1,\n    fromPoint: fromPoint$1\n  };\n\n  var is$2 = function (element, selector) {\n    var dom = element.dom;\n\n    if (dom.nodeType !== ELEMENT) {\n      return false;\n    } else {\n      var elem = dom;\n\n      if (elem.matches !== undefined) {\n        return elem.matches(selector);\n      } else if (elem.msMatchesSelector !== undefined) {\n        return elem.msMatchesSelector(selector);\n      } else if (elem.webkitMatchesSelector !== undefined) {\n        return elem.webkitMatchesSelector(selector);\n      } else if (elem.mozMatchesSelector !== undefined) {\n        return elem.mozMatchesSelector(selector);\n      } else {\n        throw new Error('Browser lacks native selectors');\n      }\n    }\n  };\n\n  var bypassSelector = function (dom) {\n    return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n  };\n\n  var all$1 = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? [] : map$1(base.querySelectorAll(selector), SugarElement.fromDom);\n  };\n\n  var one = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n  };\n\n  var eq$1 = function (e1, e2) {\n    return e1.dom === e2.dom;\n  };\n\n  var regularContains = function (e1, e2) {\n    var d1 = e1.dom;\n    var d2 = e2.dom;\n    return d1 === d2 ? false : d1.contains(d2);\n  };\n\n  var ieContains = function (e1, e2) {\n    return documentPositionContainedBy(e1.dom, e2.dom);\n  };\n\n  var contains = function (e1, e2) {\n    return detect$3().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n  };\n\n  var is$1 = is$2;\n  var keys = Object.keys;\n  var hasOwnProperty = Object.hasOwnProperty;\n\n  var each$1 = function (obj, f) {\n    var props = keys(obj);\n\n    for (var k = 0, len = props.length; k < len; k++) {\n      var i = props[k];\n      var x = obj[i];\n      f(x, i);\n    }\n  };\n\n  var map = function (obj, f) {\n    return tupleMap(obj, function (x, i) {\n      return {\n        k: i,\n        v: f(x, i)\n      };\n    });\n  };\n\n  var tupleMap = function (obj, f) {\n    var r = {};\n    each$1(obj, function (x, i) {\n      var tuple = f(x, i);\n      r[tuple.k] = tuple.v;\n    });\n    return r;\n  };\n\n  var objAcc = function (r) {\n    return function (x, i) {\n      r[i] = x;\n    };\n  };\n\n  var internalFilter = function (obj, pred, onTrue, onFalse) {\n    var r = {};\n    each$1(obj, function (x, i) {\n      (pred(x, i) ? onTrue : onFalse)(x, i);\n    });\n    return r;\n  };\n\n  var filter$1 = function (obj, pred) {\n    var t = {};\n    internalFilter(obj, pred, objAcc(t), noop);\n    return t;\n  };\n\n  var mapToArray = function (obj, f) {\n    var r = [];\n    each$1(obj, function (value, name) {\n      r.push(f(value, name));\n    });\n    return r;\n  };\n\n  var values = function (obj) {\n    return mapToArray(obj, identity);\n  };\n\n  var size = function (obj) {\n    return keys(obj).length;\n  };\n\n  var get$c = function (obj, key) {\n    return has$1(obj, key) ? Optional.from(obj[key]) : Optional.none();\n  };\n\n  var has$1 = function (obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  var hasNonNullableKey = function (obj, key) {\n    return has$1(obj, key) && obj[key] !== undefined && obj[key] !== null;\n  };\n\n  var isEmpty = function (r) {\n    for (var x in r) {\n      if (hasOwnProperty.call(r, x)) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  var validSectionList = ['tfoot', 'thead', 'tbody', 'colgroup'];\n\n  var isValidSection = function (parentName) {\n    return contains$2(validSectionList, parentName);\n  };\n\n  var grid = function (rows, columns) {\n    return {\n      rows: rows,\n      columns: columns\n    };\n  };\n\n  var address = function (row, column) {\n    return {\n      row: row,\n      column: column\n    };\n  };\n\n  var detail = function (element, rowspan, colspan) {\n    return {\n      element: element,\n      rowspan: rowspan,\n      colspan: colspan\n    };\n  };\n\n  var detailnew = function (element, rowspan, colspan, isNew) {\n    return {\n      element: element,\n      rowspan: rowspan,\n      colspan: colspan,\n      isNew: isNew\n    };\n  };\n\n  var extended = function (element, rowspan, colspan, row, column, isLocked) {\n    return {\n      element: element,\n      rowspan: rowspan,\n      colspan: colspan,\n      row: row,\n      column: column,\n      isLocked: isLocked\n    };\n  };\n\n  var rowdetail = function (element, cells, section) {\n    return {\n      element: element,\n      cells: cells,\n      section: section\n    };\n  };\n\n  var rowdetailnew = function (element, cells, section, isNew) {\n    return {\n      element: element,\n      cells: cells,\n      section: section,\n      isNew: isNew\n    };\n  };\n\n  var elementnew = function (element, isNew, isLocked) {\n    return {\n      element: element,\n      isNew: isNew,\n      isLocked: isLocked\n    };\n  };\n\n  var rowcells = function (element, cells, section, isNew) {\n    return {\n      element: element,\n      cells: cells,\n      section: section,\n      isNew: isNew\n    };\n  };\n\n  var bounds = function (startRow, startCol, finishRow, finishCol) {\n    return {\n      startRow: startRow,\n      startCol: startCol,\n      finishRow: finishRow,\n      finishCol: finishCol\n    };\n  };\n\n  var columnext = function (element, colspan, column) {\n    return {\n      element: element,\n      colspan: colspan,\n      column: column\n    };\n  };\n\n  var colgroup = function (element, columns) {\n    return {\n      element: element,\n      columns: columns\n    };\n  };\n\n  typeof window !== 'undefined' ? window : Function('return this;')();\n\n  var name = function (element) {\n    var r = element.dom.nodeName;\n    return r.toLowerCase();\n  };\n\n  var type$1 = function (element) {\n    return element.dom.nodeType;\n  };\n\n  var isType = function (t) {\n    return function (element) {\n      return type$1(element) === t;\n    };\n  };\n\n  var isComment = function (element) {\n    return type$1(element) === COMMENT || name(element) === '#comment';\n  };\n\n  var isElement = isType(ELEMENT);\n  var isText = isType(TEXT);\n  var isDocument = isType(DOCUMENT);\n  var isDocumentFragment = isType(DOCUMENT_FRAGMENT);\n\n  var isTag = function (tag) {\n    return function (e) {\n      return isElement(e) && name(e) === tag;\n    };\n  };\n\n  var owner = function (element) {\n    return SugarElement.fromDom(element.dom.ownerDocument);\n  };\n\n  var documentOrOwner = function (dos) {\n    return isDocument(dos) ? dos : owner(dos);\n  };\n\n  var defaultView = function (element) {\n    return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n  };\n\n  var parent = function (element) {\n    return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n  };\n\n  var parentElement = function (element) {\n    return Optional.from(element.dom.parentElement).map(SugarElement.fromDom);\n  };\n\n  var parents = function (element, isRoot) {\n    var stop = isFunction(isRoot) ? isRoot : never;\n    var dom = element.dom;\n    var ret = [];\n\n    while (dom.parentNode !== null && dom.parentNode !== undefined) {\n      var rawParent = dom.parentNode;\n      var p = SugarElement.fromDom(rawParent);\n      ret.push(p);\n\n      if (stop(p) === true) {\n        break;\n      } else {\n        dom = rawParent;\n      }\n    }\n\n    return ret;\n  };\n\n  var prevSibling = function (element) {\n    return Optional.from(element.dom.previousSibling).map(SugarElement.fromDom);\n  };\n\n  var nextSibling = function (element) {\n    return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n  };\n\n  var children$3 = function (element) {\n    return map$1(element.dom.childNodes, SugarElement.fromDom);\n  };\n\n  var child$3 = function (element, index) {\n    var cs = element.dom.childNodes;\n    return Optional.from(cs[index]).map(SugarElement.fromDom);\n  };\n\n  var firstChild = function (element) {\n    return child$3(element, 0);\n  };\n\n  var isShadowRoot = function (dos) {\n    return isDocumentFragment(dos) && isNonNullable(dos.dom.host);\n  };\n\n  var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n  var isSupported$1 = constant(supported);\n  var getRootNode = supported ? function (e) {\n    return SugarElement.fromDom(e.dom.getRootNode());\n  } : documentOrOwner;\n\n  var getShadowRoot = function (e) {\n    var r = getRootNode(e);\n    return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n  };\n\n  var getShadowHost = function (e) {\n    return SugarElement.fromDom(e.dom.host);\n  };\n\n  var getOriginalEventTarget = function (event) {\n    if (isSupported$1() && isNonNullable(event.target)) {\n      var el = SugarElement.fromDom(event.target);\n\n      if (isElement(el) && isOpenShadowHost(el)) {\n        if (event.composed && event.composedPath) {\n          var composedPath = event.composedPath();\n\n          if (composedPath) {\n            return head(composedPath);\n          }\n        }\n      }\n    }\n\n    return Optional.from(event.target);\n  };\n\n  var isOpenShadowHost = function (element) {\n    return isNonNullable(element.dom.shadowRoot);\n  };\n\n  var inBody = function (element) {\n    var dom = isText(element) ? element.dom.parentNode : element.dom;\n\n    if (dom === undefined || dom === null || dom.ownerDocument === null) {\n      return false;\n    }\n\n    var doc = dom.ownerDocument;\n    return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n      return doc.body.contains(dom);\n    }, compose1(inBody, getShadowHost));\n  };\n\n  var body$1 = function () {\n    return getBody$1(SugarElement.fromDom(document));\n  };\n\n  var getBody$1 = function (doc) {\n    var b = doc.dom.body;\n\n    if (b === null || b === undefined) {\n      throw new Error('Body is not available yet');\n    }\n\n    return SugarElement.fromDom(b);\n  };\n\n  var ancestors$4 = function (scope, predicate, isRoot) {\n    return filter$2(parents(scope, isRoot), predicate);\n  };\n\n  var children$2 = function (scope, predicate) {\n    return filter$2(children$3(scope), predicate);\n  };\n\n  var descendants$1 = function (scope, predicate) {\n    var result = [];\n    each$2(children$3(scope), function (x) {\n      if (predicate(x)) {\n        result = result.concat([x]);\n      }\n\n      result = result.concat(descendants$1(x, predicate));\n    });\n    return result;\n  };\n\n  var ancestors$3 = function (scope, selector, isRoot) {\n    return ancestors$4(scope, function (e) {\n      return is$2(e, selector);\n    }, isRoot);\n  };\n\n  var children$1 = function (scope, selector) {\n    return children$2(scope, function (e) {\n      return is$2(e, selector);\n    });\n  };\n\n  var descendants = function (scope, selector) {\n    return all$1(selector, scope);\n  };\n\n  function ClosestOrAncestor(is, ancestor, scope, a, isRoot) {\n    if (is(scope, a)) {\n      return Optional.some(scope);\n    } else if (isFunction(isRoot) && isRoot(scope)) {\n      return Optional.none();\n    } else {\n      return ancestor(scope, a, isRoot);\n    }\n  }\n\n  var ancestor$2 = function (scope, predicate, isRoot) {\n    var element = scope.dom;\n    var stop = isFunction(isRoot) ? isRoot : never;\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = SugarElement.fromDom(element);\n\n      if (predicate(el)) {\n        return Optional.some(el);\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var closest$2 = function (scope, predicate, isRoot) {\n    var is = function (s, test) {\n      return test(s);\n    };\n\n    return ClosestOrAncestor(is, ancestor$2, scope, predicate, isRoot);\n  };\n\n  var child$2 = function (scope, predicate) {\n    var pred = function (node) {\n      return predicate(SugarElement.fromDom(node));\n    };\n\n    var result = find$1(scope.dom.childNodes, pred);\n    return result.map(SugarElement.fromDom);\n  };\n\n  var descendant$1 = function (scope, predicate) {\n    var descend = function (node) {\n      for (var i = 0; i < node.childNodes.length; i++) {\n        var child_1 = SugarElement.fromDom(node.childNodes[i]);\n\n        if (predicate(child_1)) {\n          return Optional.some(child_1);\n        }\n\n        var res = descend(node.childNodes[i]);\n\n        if (res.isSome()) {\n          return res;\n        }\n      }\n\n      return Optional.none();\n    };\n\n    return descend(scope.dom);\n  };\n\n  var ancestor$1 = function (scope, selector, isRoot) {\n    return ancestor$2(scope, function (e) {\n      return is$2(e, selector);\n    }, isRoot);\n  };\n\n  var child$1 = function (scope, selector) {\n    return child$2(scope, function (e) {\n      return is$2(e, selector);\n    });\n  };\n\n  var descendant = function (scope, selector) {\n    return one(selector, scope);\n  };\n\n  var closest$1 = function (scope, selector, isRoot) {\n    var is = function (element, selector) {\n      return is$2(element, selector);\n    };\n\n    return ClosestOrAncestor(is, ancestor$1, scope, selector, isRoot);\n  };\n\n  var rawSet = function (dom, key, value) {\n    if (isString(value) || isBoolean(value) || isNumber(value)) {\n      dom.setAttribute(key, value + '');\n    } else {\n      console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n      throw new Error('Attribute value was not simple');\n    }\n  };\n\n  var set$2 = function (element, key, value) {\n    rawSet(element.dom, key, value);\n  };\n\n  var setAll$1 = function (element, attrs) {\n    var dom = element.dom;\n    each$1(attrs, function (v, k) {\n      rawSet(dom, k, v);\n    });\n  };\n\n  var setOptions = function (element, attrs) {\n    each$1(attrs, function (v, k) {\n      v.fold(function () {\n        remove$7(element, k);\n      }, function (value) {\n        rawSet(element.dom, k, value);\n      });\n    });\n  };\n\n  var get$b = function (element, key) {\n    var v = element.dom.getAttribute(key);\n    return v === null ? undefined : v;\n  };\n\n  var getOpt = function (element, key) {\n    return Optional.from(get$b(element, key));\n  };\n\n  var remove$7 = function (element, key) {\n    element.dom.removeAttribute(key);\n  };\n\n  var clone$2 = function (element) {\n    return foldl(element.dom.attributes, function (acc, attr) {\n      acc[attr.name] = attr.value;\n      return acc;\n    }, {});\n  };\n\n  var is = function (lhs, rhs, comparator) {\n    if (comparator === void 0) {\n      comparator = tripleEquals;\n    }\n\n    return lhs.exists(function (left) {\n      return comparator(left, rhs);\n    });\n  };\n\n  var cat = function (arr) {\n    var r = [];\n\n    var push = function (x) {\n      r.push(x);\n    };\n\n    for (var i = 0; i < arr.length; i++) {\n      arr[i].each(push);\n    }\n\n    return r;\n  };\n\n  var lift2 = function (oa, ob, f) {\n    return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n  };\n\n  var bindFrom = function (a, f) {\n    return a !== undefined && a !== null ? f(a) : Optional.none();\n  };\n\n  var flatten = function (oot) {\n    return oot.bind(identity);\n  };\n\n  var someIf = function (b, a) {\n    return b ? Optional.some(a) : Optional.none();\n  };\n\n  var isSupported = function (dom) {\n    return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n  };\n\n  var internalSet = function (dom, property, value) {\n    if (!isString(value)) {\n      console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n      throw new Error('CSS value must be a string: ' + value);\n    }\n\n    if (isSupported(dom)) {\n      dom.style.setProperty(property, value);\n    }\n  };\n\n  var internalRemove = function (dom, property) {\n    if (isSupported(dom)) {\n      dom.style.removeProperty(property);\n    }\n  };\n\n  var set$1 = function (element, property, value) {\n    var dom = element.dom;\n    internalSet(dom, property, value);\n  };\n\n  var setAll = function (element, css) {\n    var dom = element.dom;\n    each$1(css, function (v, k) {\n      internalSet(dom, k, v);\n    });\n  };\n\n  var get$a = function (element, property) {\n    var dom = element.dom;\n    var styles = window.getComputedStyle(dom);\n    var r = styles.getPropertyValue(property);\n    return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n  };\n\n  var getUnsafeProperty = function (dom, property) {\n    return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n  };\n\n  var getRaw$2 = function (element, property) {\n    var dom = element.dom;\n    var raw = getUnsafeProperty(dom, property);\n    return Optional.from(raw).filter(function (r) {\n      return r.length > 0;\n    });\n  };\n\n  var remove$6 = function (element, property) {\n    var dom = element.dom;\n    internalRemove(dom, property);\n\n    if (is(getOpt(element, 'style').map(trim), '')) {\n      remove$7(element, 'style');\n    }\n  };\n\n  var copy$2 = function (source, target) {\n    var sourceDom = source.dom;\n    var targetDom = target.dom;\n\n    if (isSupported(sourceDom) && isSupported(targetDom)) {\n      targetDom.style.cssText = sourceDom.style.cssText;\n    }\n  };\n\n  var getAttrValue = function (cell, name, fallback) {\n    if (fallback === void 0) {\n      fallback = 0;\n    }\n\n    return getOpt(cell, name).map(function (value) {\n      return parseInt(value, 10);\n    }).getOr(fallback);\n  };\n\n  var getSpan = function (cell, type) {\n    return getAttrValue(cell, type, 1);\n  };\n\n  var hasColspan = function (cellOrCol) {\n    if (isTag('col')(cellOrCol)) {\n      return getAttrValue(cellOrCol, 'span', 1) > 1;\n    } else {\n      return getSpan(cellOrCol, 'colspan') > 1;\n    }\n  };\n\n  var hasRowspan = function (cell) {\n    return getSpan(cell, 'rowspan') > 1;\n  };\n\n  var getCssValue = function (element, property) {\n    return parseInt(get$a(element, property), 10);\n  };\n\n  var minWidth = constant(10);\n  var minHeight = constant(10);\n\n  var firstLayer = function (scope, selector) {\n    return filterFirstLayer(scope, selector, always);\n  };\n\n  var filterFirstLayer = function (scope, selector, predicate) {\n    return bind$2(children$3(scope), function (x) {\n      if (is$2(x, selector)) {\n        return predicate(x) ? [x] : [];\n      } else {\n        return filterFirstLayer(x, selector, predicate);\n      }\n    });\n  };\n\n  var lookup = function (tags, element, isRoot) {\n    if (isRoot === void 0) {\n      isRoot = never;\n    }\n\n    if (isRoot(element)) {\n      return Optional.none();\n    }\n\n    if (contains$2(tags, name(element))) {\n      return Optional.some(element);\n    }\n\n    var isRootOrUpperTable = function (elm) {\n      return is$2(elm, 'table') || isRoot(elm);\n    };\n\n    return ancestor$1(element, tags.join(','), isRootOrUpperTable);\n  };\n\n  var cell = function (element, isRoot) {\n    return lookup(['td', 'th'], element, isRoot);\n  };\n\n  var cells$1 = function (ancestor) {\n    return firstLayer(ancestor, 'th,td');\n  };\n\n  var columns$1 = function (ancestor) {\n    if (is$2(ancestor, 'colgroup')) {\n      return children$1(ancestor, 'col');\n    } else {\n      return bind$2(columnGroups(ancestor), function (columnGroup) {\n        return children$1(columnGroup, 'col');\n      });\n    }\n  };\n\n  var table = function (element, isRoot) {\n    return closest$1(element, 'table', isRoot);\n  };\n\n  var rows$1 = function (ancestor) {\n    return firstLayer(ancestor, 'tr');\n  };\n\n  var columnGroups = function (ancestor) {\n    return table(ancestor).fold(constant([]), function (table) {\n      return children$1(table, 'colgroup');\n    });\n  };\n\n  var fromRowsOrColGroups = function (elems, getSection) {\n    return map$1(elems, function (row) {\n      if (name(row) === 'colgroup') {\n        var cells = map$1(columns$1(row), function (column) {\n          var colspan = getAttrValue(column, 'span', 1);\n          return detail(column, 1, colspan);\n        });\n        return rowdetail(row, cells, 'colgroup');\n      } else {\n        var cells = map$1(cells$1(row), function (cell) {\n          var rowspan = getAttrValue(cell, 'rowspan', 1);\n          var colspan = getAttrValue(cell, 'colspan', 1);\n          return detail(cell, rowspan, colspan);\n        });\n        return rowdetail(row, cells, getSection(row));\n      }\n    });\n  };\n\n  var getParentSection = function (group) {\n    return parent(group).map(function (parent) {\n      var parentName = name(parent);\n      return isValidSection(parentName) ? parentName : 'tbody';\n    }).getOr('tbody');\n  };\n\n  var fromTable$1 = function (table) {\n    var rows = rows$1(table);\n    var columnGroups$1 = columnGroups(table);\n\n    var elems = __spreadArray(__spreadArray([], columnGroups$1, true), rows, true);\n\n    return fromRowsOrColGroups(elems, getParentSection);\n  };\n\n  var fromPastedRows = function (elems, section) {\n    return fromRowsOrColGroups(elems, function () {\n      return section;\n    });\n  };\n\n  var addCells = function (gridRow, index, cells) {\n    var existingCells = gridRow.cells;\n    var before = existingCells.slice(0, index);\n    var after = existingCells.slice(index);\n    var newCells = before.concat(cells).concat(after);\n    return setCells(gridRow, newCells);\n  };\n\n  var addCell = function (gridRow, index, cell) {\n    return addCells(gridRow, index, [cell]);\n  };\n\n  var mutateCell = function (gridRow, index, cell) {\n    var cells = gridRow.cells;\n    cells[index] = cell;\n  };\n\n  var setCells = function (gridRow, cells) {\n    return rowcells(gridRow.element, cells, gridRow.section, gridRow.isNew);\n  };\n\n  var mapCells = function (gridRow, f) {\n    var cells = gridRow.cells;\n    var r = map$1(cells, f);\n    return rowcells(gridRow.element, r, gridRow.section, gridRow.isNew);\n  };\n\n  var getCell = function (gridRow, index) {\n    return gridRow.cells[index];\n  };\n\n  var getCellElement = function (gridRow, index) {\n    return getCell(gridRow, index).element;\n  };\n\n  var cellLength = function (gridRow) {\n    return gridRow.cells.length;\n  };\n\n  var extractGridDetails = function (grid) {\n    var result = partition(grid, function (row) {\n      return row.section === 'colgroup';\n    });\n    return {\n      rows: result.fail,\n      cols: result.pass\n    };\n  };\n\n  var clone$1 = function (gridRow, cloneRow, cloneCell) {\n    var newCells = map$1(gridRow.cells, cloneCell);\n    return rowcells(cloneRow(gridRow.element), newCells, gridRow.section, true);\n  };\n\n  var LOCKED_COL_ATTR = 'data-snooker-locked-cols';\n\n  var getLockedColumnsFromTable = function (table) {\n    return getOpt(table, LOCKED_COL_ATTR).bind(function (lockedColStr) {\n      return Optional.from(lockedColStr.match(/\\d+/g));\n    }).map(function (lockedCols) {\n      return mapToObject(lockedCols, always);\n    });\n  };\n\n  var getLockedColumnsFromGrid = function (grid) {\n    var locked = foldl(extractGridDetails(grid).rows, function (acc, row) {\n      each$2(row.cells, function (cell, idx) {\n        if (cell.isLocked) {\n          acc[idx] = true;\n        }\n      });\n      return acc;\n    }, {});\n    var lockedArr = mapToArray(locked, function (_val, key) {\n      return parseInt(key, 10);\n    });\n    return sort$1(lockedArr);\n  };\n\n  var key = function (row, column) {\n    return row + ',' + column;\n  };\n\n  var getAt = function (warehouse, row, column) {\n    return Optional.from(warehouse.access[key(row, column)]);\n  };\n\n  var findItem = function (warehouse, item, comparator) {\n    var filtered = filterItems(warehouse, function (detail) {\n      return comparator(item, detail.element);\n    });\n    return filtered.length > 0 ? Optional.some(filtered[0]) : Optional.none();\n  };\n\n  var filterItems = function (warehouse, predicate) {\n    var all = bind$2(warehouse.all, function (r) {\n      return r.cells;\n    });\n    return filter$2(all, predicate);\n  };\n\n  var generateColumns = function (rowData) {\n    var columnsGroup = {};\n    var index = 0;\n    each$2(rowData.cells, function (column) {\n      var colspan = column.colspan;\n      range$1(colspan, function (columnIndex) {\n        var colIndex = index + columnIndex;\n        columnsGroup[colIndex] = columnext(column.element, colspan, colIndex);\n      });\n      index += colspan;\n    });\n    return columnsGroup;\n  };\n\n  var generate$1 = function (list) {\n    var access = {};\n    var cells = [];\n    var tableOpt = head(list).map(function (rowData) {\n      return rowData.element;\n    }).bind(table);\n    var lockedColumns = tableOpt.bind(getLockedColumnsFromTable).getOr({});\n    var maxRows = 0;\n    var maxColumns = 0;\n    var rowCount = 0;\n\n    var _a = partition(list, function (rowData) {\n      return rowData.section === 'colgroup';\n    }),\n        colgroupRows = _a.pass,\n        rows = _a.fail;\n\n    each$2(rows, function (rowData) {\n      var currentRow = [];\n      each$2(rowData.cells, function (rowCell) {\n        var start = 0;\n\n        while (access[key(rowCount, start)] !== undefined) {\n          start++;\n        }\n\n        var isLocked = hasNonNullableKey(lockedColumns, start.toString());\n        var current = extended(rowCell.element, rowCell.rowspan, rowCell.colspan, rowCount, start, isLocked);\n\n        for (var occupiedColumnPosition = 0; occupiedColumnPosition < rowCell.colspan; occupiedColumnPosition++) {\n          for (var occupiedRowPosition = 0; occupiedRowPosition < rowCell.rowspan; occupiedRowPosition++) {\n            var rowPosition = rowCount + occupiedRowPosition;\n            var columnPosition = start + occupiedColumnPosition;\n            var newpos = key(rowPosition, columnPosition);\n            access[newpos] = current;\n            maxColumns = Math.max(maxColumns, columnPosition + 1);\n          }\n        }\n\n        currentRow.push(current);\n      });\n      maxRows++;\n      cells.push(rowdetail(rowData.element, currentRow, rowData.section));\n      rowCount++;\n    });\n\n    var _b = last$2(colgroupRows).map(function (rowData) {\n      var columns = generateColumns(rowData);\n      var colgroup$1 = colgroup(rowData.element, values(columns));\n      return {\n        colgroups: [colgroup$1],\n        columns: columns\n      };\n    }).getOrThunk(function () {\n      return {\n        colgroups: [],\n        columns: {}\n      };\n    }),\n        columns = _b.columns,\n        colgroups = _b.colgroups;\n\n    var grid$1 = grid(maxRows, maxColumns);\n    return {\n      grid: grid$1,\n      access: access,\n      all: cells,\n      columns: columns,\n      colgroups: colgroups\n    };\n  };\n\n  var fromTable = function (table) {\n    var list = fromTable$1(table);\n    return generate$1(list);\n  };\n\n  var justCells = function (warehouse) {\n    return bind$2(warehouse.all, function (w) {\n      return w.cells;\n    });\n  };\n\n  var justColumns = function (warehouse) {\n    return values(warehouse.columns);\n  };\n\n  var hasColumns = function (warehouse) {\n    return keys(warehouse.columns).length > 0;\n  };\n\n  var getColumnAt = function (warehouse, columnIndex) {\n    return Optional.from(warehouse.columns[columnIndex]);\n  };\n\n  var Warehouse = {\n    fromTable: fromTable,\n    generate: generate$1,\n    getAt: getAt,\n    findItem: findItem,\n    filterItems: filterItems,\n    justCells: justCells,\n    justColumns: justColumns,\n    hasColumns: hasColumns,\n    getColumnAt: getColumnAt\n  };\n\n  var inSelection = function (bounds, detail) {\n    var leftEdge = detail.column;\n    var rightEdge = detail.column + detail.colspan - 1;\n    var topEdge = detail.row;\n    var bottomEdge = detail.row + detail.rowspan - 1;\n    return leftEdge <= bounds.finishCol && rightEdge >= bounds.startCol && topEdge <= bounds.finishRow && bottomEdge >= bounds.startRow;\n  };\n\n  var isWithin = function (bounds, detail) {\n    return detail.column >= bounds.startCol && detail.column + detail.colspan - 1 <= bounds.finishCol && detail.row >= bounds.startRow && detail.row + detail.rowspan - 1 <= bounds.finishRow;\n  };\n\n  var isRectangular = function (warehouse, bounds) {\n    var isRect = true;\n    var detailIsWithin = curry(isWithin, bounds);\n\n    for (var i = bounds.startRow; i <= bounds.finishRow; i++) {\n      for (var j = bounds.startCol; j <= bounds.finishCol; j++) {\n        isRect = isRect && Warehouse.getAt(warehouse, i, j).exists(detailIsWithin);\n      }\n    }\n\n    return isRect ? Optional.some(bounds) : Optional.none();\n  };\n\n  var getBounds = function (detailA, detailB) {\n    return bounds(Math.min(detailA.row, detailB.row), Math.min(detailA.column, detailB.column), Math.max(detailA.row + detailA.rowspan - 1, detailB.row + detailB.rowspan - 1), Math.max(detailA.column + detailA.colspan - 1, detailB.column + detailB.colspan - 1));\n  };\n\n  var getAnyBox = function (warehouse, startCell, finishCell) {\n    var startCoords = Warehouse.findItem(warehouse, startCell, eq$1);\n    var finishCoords = Warehouse.findItem(warehouse, finishCell, eq$1);\n    return startCoords.bind(function (sc) {\n      return finishCoords.map(function (fc) {\n        return getBounds(sc, fc);\n      });\n    });\n  };\n\n  var getBox$1 = function (warehouse, startCell, finishCell) {\n    return getAnyBox(warehouse, startCell, finishCell).bind(function (bounds) {\n      return isRectangular(warehouse, bounds);\n    });\n  };\n\n  var moveBy$1 = function (warehouse, cell, row, column) {\n    return Warehouse.findItem(warehouse, cell, eq$1).bind(function (detail) {\n      var startRow = row > 0 ? detail.row + detail.rowspan - 1 : detail.row;\n      var startCol = column > 0 ? detail.column + detail.colspan - 1 : detail.column;\n      var dest = Warehouse.getAt(warehouse, startRow + row, startCol + column);\n      return dest.map(function (d) {\n        return d.element;\n      });\n    });\n  };\n\n  var intercepts$1 = function (warehouse, start, finish) {\n    return getAnyBox(warehouse, start, finish).map(function (bounds) {\n      var inside = Warehouse.filterItems(warehouse, curry(inSelection, bounds));\n      return map$1(inside, function (detail) {\n        return detail.element;\n      });\n    });\n  };\n\n  var parentCell = function (warehouse, innerCell) {\n    var isContainedBy = function (c1, c2) {\n      return contains(c2, c1);\n    };\n\n    return Warehouse.findItem(warehouse, innerCell, isContainedBy).map(function (detail) {\n      return detail.element;\n    });\n  };\n\n  var moveBy = function (cell, deltaRow, deltaColumn) {\n    return table(cell).bind(function (table) {\n      var warehouse = getWarehouse(table);\n      return moveBy$1(warehouse, cell, deltaRow, deltaColumn);\n    });\n  };\n\n  var intercepts = function (table, first, last) {\n    var warehouse = getWarehouse(table);\n    return intercepts$1(warehouse, first, last);\n  };\n\n  var nestedIntercepts = function (table, first, firstTable, last, lastTable) {\n    var warehouse = getWarehouse(table);\n    var optStartCell = eq$1(table, firstTable) ? Optional.some(first) : parentCell(warehouse, first);\n    var optLastCell = eq$1(table, lastTable) ? Optional.some(last) : parentCell(warehouse, last);\n    return optStartCell.bind(function (startCell) {\n      return optLastCell.bind(function (lastCell) {\n        return intercepts$1(warehouse, startCell, lastCell);\n      });\n    });\n  };\n\n  var getBox = function (table, first, last) {\n    var warehouse = getWarehouse(table);\n    return getBox$1(warehouse, first, last);\n  };\n\n  var getWarehouse = Warehouse.fromTable;\n\n  var before$4 = function (marker, element) {\n    var parent$1 = parent(marker);\n    parent$1.each(function (v) {\n      v.dom.insertBefore(element.dom, marker.dom);\n    });\n  };\n\n  var after$5 = function (marker, element) {\n    var sibling = nextSibling(marker);\n    sibling.fold(function () {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        append$1(v, element);\n      });\n    }, function (v) {\n      before$4(v, element);\n    });\n  };\n\n  var prepend = function (parent, element) {\n    var firstChild$1 = firstChild(parent);\n    firstChild$1.fold(function () {\n      append$1(parent, element);\n    }, function (v) {\n      parent.dom.insertBefore(element.dom, v.dom);\n    });\n  };\n\n  var append$1 = function (parent, element) {\n    parent.dom.appendChild(element.dom);\n  };\n\n  var appendAt = function (parent, element, index) {\n    child$3(parent, index).fold(function () {\n      append$1(parent, element);\n    }, function (v) {\n      before$4(v, element);\n    });\n  };\n\n  var wrap = function (element, wrapper) {\n    before$4(element, wrapper);\n    append$1(wrapper, element);\n  };\n\n  var before$3 = function (marker, elements) {\n    each$2(elements, function (x) {\n      before$4(marker, x);\n    });\n  };\n\n  var after$4 = function (marker, elements) {\n    each$2(elements, function (x, i) {\n      var e = i === 0 ? marker : elements[i - 1];\n      after$5(e, x);\n    });\n  };\n\n  var append = function (parent, elements) {\n    each$2(elements, function (x) {\n      append$1(parent, x);\n    });\n  };\n\n  var empty = function (element) {\n    element.dom.textContent = '';\n    each$2(children$3(element), function (rogue) {\n      remove$5(rogue);\n    });\n  };\n\n  var remove$5 = function (element) {\n    var dom = element.dom;\n\n    if (dom.parentNode !== null) {\n      dom.parentNode.removeChild(dom);\n    }\n  };\n\n  var unwrap = function (wrapper) {\n    var children = children$3(wrapper);\n\n    if (children.length > 0) {\n      before$3(wrapper, children);\n    }\n\n    remove$5(wrapper);\n  };\n\n  var NodeValue = function (is, name) {\n    var get = function (element) {\n      if (!is(element)) {\n        throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n      }\n\n      return getOption(element).getOr('');\n    };\n\n    var getOption = function (element) {\n      return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n    };\n\n    var set = function (element, value) {\n      if (!is(element)) {\n        throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n      }\n\n      element.dom.nodeValue = value;\n    };\n\n    return {\n      get: get,\n      getOption: getOption,\n      set: set\n    };\n  };\n\n  var api$2 = NodeValue(isText, 'text');\n\n  var get$9 = function (element) {\n    return api$2.get(element);\n  };\n\n  var getOption = function (element) {\n    return api$2.getOption(element);\n  };\n\n  var set = function (element, value) {\n    return api$2.set(element, value);\n  };\n\n  var TagBoundaries = ['body', 'p', 'div', 'article', 'aside', 'figcaption', 'figure', 'footer', 'header', 'nav', 'section', 'ol', 'ul', 'li', 'table', 'thead', 'tbody', 'tfoot', 'caption', 'tr', 'td', 'th', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'pre', 'address'];\n\n  function DomUniverse() {\n    var clone = function (element) {\n      return SugarElement.fromDom(element.dom.cloneNode(false));\n    };\n\n    var document = function (element) {\n      return documentOrOwner(element).dom;\n    };\n\n    var isBoundary = function (element) {\n      if (!isElement(element)) {\n        return false;\n      }\n\n      if (name(element) === 'body') {\n        return true;\n      }\n\n      return contains$2(TagBoundaries, name(element));\n    };\n\n    var isEmptyTag = function (element) {\n      if (!isElement(element)) {\n        return false;\n      }\n\n      return contains$2(['br', 'img', 'hr', 'input'], name(element));\n    };\n\n    var isNonEditable = function (element) {\n      return isElement(element) && get$b(element, 'contenteditable') === 'false';\n    };\n\n    var comparePosition = function (element, other) {\n      return element.dom.compareDocumentPosition(other.dom);\n    };\n\n    var copyAttributesTo = function (source, destination) {\n      var as = clone$2(source);\n      setAll$1(destination, as);\n    };\n\n    var isSpecial = function (element) {\n      var tag = name(element);\n      return contains$2(['script', 'noscript', 'iframe', 'noframes', 'noembed', 'title', 'style', 'textarea', 'xmp'], tag);\n    };\n\n    var getLanguage = function (element) {\n      return isElement(element) ? getOpt(element, 'lang') : Optional.none();\n    };\n\n    return {\n      up: constant({\n        selector: ancestor$1,\n        closest: closest$1,\n        predicate: ancestor$2,\n        all: parents\n      }),\n      down: constant({\n        selector: descendants,\n        predicate: descendants$1\n      }),\n      styles: constant({\n        get: get$a,\n        getRaw: getRaw$2,\n        set: set$1,\n        remove: remove$6\n      }),\n      attrs: constant({\n        get: get$b,\n        set: set$2,\n        remove: remove$7,\n        copyTo: copyAttributesTo\n      }),\n      insert: constant({\n        before: before$4,\n        after: after$5,\n        afterAll: after$4,\n        append: append$1,\n        appendAll: append,\n        prepend: prepend,\n        wrap: wrap\n      }),\n      remove: constant({\n        unwrap: unwrap,\n        remove: remove$5\n      }),\n      create: constant({\n        nu: SugarElement.fromTag,\n        clone: clone,\n        text: SugarElement.fromText\n      }),\n      query: constant({\n        comparePosition: comparePosition,\n        prevSibling: prevSibling,\n        nextSibling: nextSibling\n      }),\n      property: constant({\n        children: children$3,\n        name: name,\n        parent: parent,\n        document: document,\n        isText: isText,\n        isComment: isComment,\n        isElement: isElement,\n        isSpecial: isSpecial,\n        getLanguage: getLanguage,\n        getText: get$9,\n        setText: set,\n        isBoundary: isBoundary,\n        isEmptyTag: isEmptyTag,\n        isNonEditable: isNonEditable\n      }),\n      eq: eq$1,\n      is: is$1\n    };\n  }\n\n  var all = function (universe, look, elements, f) {\n    var head = elements[0];\n    var tail = elements.slice(1);\n    return f(universe, look, head, tail);\n  };\n\n  var oneAll = function (universe, look, elements) {\n    return elements.length > 0 ? all(universe, look, elements, unsafeOne) : Optional.none();\n  };\n\n  var unsafeOne = function (universe, look, head, tail) {\n    var start = look(universe, head);\n    return foldr(tail, function (b, a) {\n      var current = look(universe, a);\n      return commonElement(universe, b, current);\n    }, start);\n  };\n\n  var commonElement = function (universe, start, end) {\n    return start.bind(function (s) {\n      return end.filter(curry(universe.eq, s));\n    });\n  };\n\n  var eq = function (universe, item) {\n    return curry(universe.eq, item);\n  };\n\n  var ancestors$2 = function (universe, start, end, isRoot) {\n    if (isRoot === void 0) {\n      isRoot = never;\n    }\n\n    var ps1 = [start].concat(universe.up().all(start));\n    var ps2 = [end].concat(universe.up().all(end));\n\n    var prune = function (path) {\n      var index = findIndex(path, isRoot);\n      return index.fold(function () {\n        return path;\n      }, function (ind) {\n        return path.slice(0, ind + 1);\n      });\n    };\n\n    var pruned1 = prune(ps1);\n    var pruned2 = prune(ps2);\n    var shared = find$1(pruned1, function (x) {\n      return exists(pruned2, eq(universe, x));\n    });\n    return {\n      firstpath: pruned1,\n      secondpath: pruned2,\n      shared: shared\n    };\n  };\n\n  var sharedOne$1 = oneAll;\n  var ancestors$1 = ancestors$2;\n  var universe$3 = DomUniverse();\n\n  var sharedOne = function (look, elements) {\n    return sharedOne$1(universe$3, function (_universe, element) {\n      return look(element);\n    }, elements);\n  };\n\n  var ancestors = function (start, finish, isRoot) {\n    return ancestors$1(universe$3, start, finish, isRoot);\n  };\n\n  var lookupTable = function (container) {\n    return ancestor$1(container, 'table');\n  };\n\n  var identify = function (start, finish, isRoot) {\n    var getIsRoot = function (rootTable) {\n      return function (element) {\n        return isRoot !== undefined && isRoot(element) || eq$1(element, rootTable);\n      };\n    };\n\n    if (eq$1(start, finish)) {\n      return Optional.some({\n        boxes: Optional.some([start]),\n        start: start,\n        finish: finish\n      });\n    } else {\n      return lookupTable(start).bind(function (startTable) {\n        return lookupTable(finish).bind(function (finishTable) {\n          if (eq$1(startTable, finishTable)) {\n            return Optional.some({\n              boxes: intercepts(startTable, start, finish),\n              start: start,\n              finish: finish\n            });\n          } else if (contains(startTable, finishTable)) {\n            var ancestorCells = ancestors$3(finish, 'td,th', getIsRoot(startTable));\n            var finishCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : finish;\n            return Optional.some({\n              boxes: nestedIntercepts(startTable, start, startTable, finish, finishTable),\n              start: start,\n              finish: finishCell\n            });\n          } else if (contains(finishTable, startTable)) {\n            var ancestorCells = ancestors$3(start, 'td,th', getIsRoot(finishTable));\n            var startCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : start;\n            return Optional.some({\n              boxes: nestedIntercepts(finishTable, start, startTable, finish, finishTable),\n              start: start,\n              finish: startCell\n            });\n          } else {\n            return ancestors(start, finish).shared.bind(function (lca) {\n              return closest$1(lca, 'table', isRoot).bind(function (lcaTable) {\n                var finishAncestorCells = ancestors$3(finish, 'td,th', getIsRoot(lcaTable));\n                var finishCell = finishAncestorCells.length > 0 ? finishAncestorCells[finishAncestorCells.length - 1] : finish;\n                var startAncestorCells = ancestors$3(start, 'td,th', getIsRoot(lcaTable));\n                var startCell = startAncestorCells.length > 0 ? startAncestorCells[startAncestorCells.length - 1] : start;\n                return Optional.some({\n                  boxes: nestedIntercepts(lcaTable, start, startTable, finish, finishTable),\n                  start: startCell,\n                  finish: finishCell\n                });\n              });\n            });\n          }\n        });\n      });\n    }\n  };\n\n  var retrieve$1 = function (container, selector) {\n    var sels = descendants(container, selector);\n    return sels.length > 0 ? Optional.some(sels) : Optional.none();\n  };\n\n  var getLast = function (boxes, lastSelectedSelector) {\n    return find$1(boxes, function (box) {\n      return is$2(box, lastSelectedSelector);\n    });\n  };\n\n  var getEdges = function (container, firstSelectedSelector, lastSelectedSelector) {\n    return descendant(container, firstSelectedSelector).bind(function (first) {\n      return descendant(container, lastSelectedSelector).bind(function (last) {\n        return sharedOne(lookupTable, [first, last]).map(function (table) {\n          return {\n            first: first,\n            last: last,\n            table: table\n          };\n        });\n      });\n    });\n  };\n\n  var expandTo = function (finish, firstSelectedSelector) {\n    return ancestor$1(finish, 'table').bind(function (table) {\n      return descendant(table, firstSelectedSelector).bind(function (start) {\n        return identify(start, finish).bind(function (identified) {\n          return identified.boxes.map(function (boxes) {\n            return {\n              boxes: boxes,\n              start: identified.start,\n              finish: identified.finish\n            };\n          });\n        });\n      });\n    });\n  };\n\n  var shiftSelection = function (boxes, deltaRow, deltaColumn, firstSelectedSelector, lastSelectedSelector) {\n    return getLast(boxes, lastSelectedSelector).bind(function (last) {\n      return moveBy(last, deltaRow, deltaColumn).bind(function (finish) {\n        return expandTo(finish, firstSelectedSelector);\n      });\n    });\n  };\n\n  var retrieve = function (container, selector) {\n    return retrieve$1(container, selector);\n  };\n\n  var retrieveBox = function (container, firstSelectedSelector, lastSelectedSelector) {\n    return getEdges(container, firstSelectedSelector, lastSelectedSelector).bind(function (edges) {\n      var isRoot = function (ancestor) {\n        return eq$1(container, ancestor);\n      };\n\n      var sectionSelector = 'thead,tfoot,tbody,table';\n      var firstAncestor = ancestor$1(edges.first, sectionSelector, isRoot);\n      var lastAncestor = ancestor$1(edges.last, sectionSelector, isRoot);\n      return firstAncestor.bind(function (fA) {\n        return lastAncestor.bind(function (lA) {\n          return eq$1(fA, lA) ? getBox(edges.table, edges.first, edges.last) : Optional.none();\n        });\n      });\n    });\n  };\n\n  var generate = function (cases) {\n    if (!isArray(cases)) {\n      throw new Error('cases must be an array');\n    }\n\n    if (cases.length === 0) {\n      throw new Error('there must be at least one case');\n    }\n\n    var constructors = [];\n    var adt = {};\n    each$2(cases, function (acase, count) {\n      var keys$1 = keys(acase);\n\n      if (keys$1.length !== 1) {\n        throw new Error('one and only one name per case');\n      }\n\n      var key = keys$1[0];\n      var value = acase[key];\n\n      if (adt[key] !== undefined) {\n        throw new Error('duplicate key detected:' + key);\n      } else if (key === 'cata') {\n        throw new Error('cannot have a case named cata (sorry)');\n      } else if (!isArray(value)) {\n        throw new Error('case arguments must be an array');\n      }\n\n      constructors.push(key);\n\n      adt[key] = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        var argLength = args.length;\n\n        if (argLength !== value.length) {\n          throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n        }\n\n        var match = function (branches) {\n          var branchKeys = keys(branches);\n\n          if (constructors.length !== branchKeys.length) {\n            throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n          }\n\n          var allReqd = forall(constructors, function (reqKey) {\n            return contains$2(branchKeys, reqKey);\n          });\n\n          if (!allReqd) {\n            throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n          }\n\n          return branches[key].apply(null, args);\n        };\n\n        return {\n          fold: function () {\n            var foldArgs = [];\n\n            for (var _i = 0; _i < arguments.length; _i++) {\n              foldArgs[_i] = arguments[_i];\n            }\n\n            if (foldArgs.length !== cases.length) {\n              throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n            }\n\n            var target = foldArgs[count];\n            return target.apply(null, args);\n          },\n          match: match,\n          log: function (label) {\n            console.log(label, {\n              constructors: constructors,\n              constructor: key,\n              params: args\n            });\n          }\n        };\n      };\n    });\n    return adt;\n  };\n\n  var Adt = {\n    generate: generate\n  };\n  var type = Adt.generate([{\n    none: []\n  }, {\n    multiple: ['elements']\n  }, {\n    single: ['element']\n  }]);\n\n  var cata$2 = function (subject, onNone, onMultiple, onSingle) {\n    return subject.fold(onNone, onMultiple, onSingle);\n  };\n\n  var none$1 = type.none;\n  var multiple = type.multiple;\n  var single = type.single;\n\n  var Selections = function (lazyRoot, getStart, selectedSelector) {\n    var get = function () {\n      return retrieve(lazyRoot(), selectedSelector).fold(function () {\n        return getStart().fold(none$1, single);\n      }, function (cells) {\n        return multiple(cells);\n      });\n    };\n\n    return {\n      get: get\n    };\n  };\n\n  var global$3 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n  var clone = function (original, isDeep) {\n    return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n  };\n\n  var shallow = function (original) {\n    return clone(original, false);\n  };\n\n  var deep = function (original) {\n    return clone(original, true);\n  };\n\n  var shallowAs = function (original, tag) {\n    var nu = SugarElement.fromTag(tag);\n    var attributes = clone$2(original);\n    setAll$1(nu, attributes);\n    return nu;\n  };\n\n  var copy$1 = function (original, tag) {\n    var nu = shallowAs(original, tag);\n    var cloneChildren = children$3(deep(original));\n    append(nu, cloneChildren);\n    return nu;\n  };\n\n  var mutate$1 = function (original, tag) {\n    var nu = shallowAs(original, tag);\n    before$4(original, nu);\n    var children = children$3(original);\n    append(nu, children);\n    remove$5(original);\n    return nu;\n  };\n\n  var Dimension = function (name, getOffset) {\n    var set = function (element, h) {\n      if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n        throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n      }\n\n      var dom = element.dom;\n\n      if (isSupported(dom)) {\n        dom.style[name] = h + 'px';\n      }\n    };\n\n    var get = function (element) {\n      var r = getOffset(element);\n\n      if (r <= 0 || r === null) {\n        var css = get$a(element, name);\n        return parseFloat(css) || 0;\n      }\n\n      return r;\n    };\n\n    var getOuter = get;\n\n    var aggregate = function (element, properties) {\n      return foldl(properties, function (acc, property) {\n        var val = get$a(element, property);\n        var value = val === undefined ? 0 : parseInt(val, 10);\n        return isNaN(value) ? acc : acc + value;\n      }, 0);\n    };\n\n    var max = function (element, value, properties) {\n      var cumulativeInclusions = aggregate(element, properties);\n      var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n      return absoluteMax;\n    };\n\n    return {\n      set: set,\n      get: get,\n      getOuter: getOuter,\n      aggregate: aggregate,\n      max: max\n    };\n  };\n\n  var needManualCalc = function () {\n    var browser = detect$3().browser;\n    return browser.isIE() || browser.isEdge();\n  };\n\n  var toNumber = function (px, fallback) {\n    return toFloat(px).getOr(fallback);\n  };\n\n  var getProp = function (element, name, fallback) {\n    return toNumber(get$a(element, name), fallback);\n  };\n\n  var getBoxSizing = function (element) {\n    return get$a(element, 'box-sizing');\n  };\n\n  var calcContentBoxSize = function (element, size, upper, lower) {\n    var paddingUpper = getProp(element, 'padding-' + upper, 0);\n    var paddingLower = getProp(element, 'padding-' + lower, 0);\n    var borderUpper = getProp(element, 'border-' + upper + '-width', 0);\n    var borderLower = getProp(element, 'border-' + lower + '-width', 0);\n    return size - paddingUpper - paddingLower - borderUpper - borderLower;\n  };\n\n  var getCalculatedHeight = function (element, boxSizing) {\n    var dom = element.dom;\n    var height = dom.getBoundingClientRect().height || dom.offsetHeight;\n    return boxSizing === 'border-box' ? height : calcContentBoxSize(element, height, 'top', 'bottom');\n  };\n\n  var getCalculatedWidth = function (element, boxSizing) {\n    var dom = element.dom;\n    var width = dom.getBoundingClientRect().width || dom.offsetWidth;\n    return boxSizing === 'border-box' ? width : calcContentBoxSize(element, width, 'left', 'right');\n  };\n\n  var getHeight$1 = function (element) {\n    return needManualCalc() ? getCalculatedHeight(element, getBoxSizing(element)) : getProp(element, 'height', element.dom.offsetHeight);\n  };\n\n  var getWidth = function (element) {\n    return needManualCalc() ? getCalculatedWidth(element, getBoxSizing(element)) : getProp(element, 'width', element.dom.offsetWidth);\n  };\n\n  var getInnerWidth = function (element) {\n    return getCalculatedWidth(element, 'content-box');\n  };\n\n  var api$1 = Dimension('width', function (element) {\n    return element.dom.offsetWidth;\n  });\n\n  var get$8 = function (element) {\n    return api$1.get(element);\n  };\n\n  var getOuter$2 = function (element) {\n    return api$1.getOuter(element);\n  };\n\n  var getInner = getInnerWidth;\n  var getRuntime$1 = getWidth;\n\n  var columns = function (warehouse, isValidCell) {\n    if (isValidCell === void 0) {\n      isValidCell = always;\n    }\n\n    var grid = warehouse.grid;\n    var cols = range$1(grid.columns, identity);\n    var rowsArr = range$1(grid.rows, identity);\n    return map$1(cols, function (col) {\n      var getBlock = function () {\n        return bind$2(rowsArr, function (r) {\n          return Warehouse.getAt(warehouse, r, col).filter(function (detail) {\n            return detail.column === col;\n          }).toArray();\n        });\n      };\n\n      var isValid = function (detail) {\n        return detail.colspan === 1 && isValidCell(detail.element);\n      };\n\n      var getFallback = function () {\n        return Warehouse.getAt(warehouse, 0, col);\n      };\n\n      return decide(getBlock, isValid, getFallback);\n    });\n  };\n\n  var decide = function (getBlock, isValid, getFallback) {\n    var inBlock = getBlock();\n    var validInBlock = find$1(inBlock, isValid);\n    var detailOption = validInBlock.orThunk(function () {\n      return Optional.from(inBlock[0]).orThunk(getFallback);\n    });\n    return detailOption.map(function (detail) {\n      return detail.element;\n    });\n  };\n\n  var rows = function (warehouse) {\n    var grid = warehouse.grid;\n    var rowsArr = range$1(grid.rows, identity);\n    var cols = range$1(grid.columns, identity);\n    return map$1(rowsArr, function (row) {\n      var getBlock = function () {\n        return bind$2(cols, function (c) {\n          return Warehouse.getAt(warehouse, row, c).filter(function (detail) {\n            return detail.row === row;\n          }).fold(constant([]), function (detail) {\n            return [detail];\n          });\n        });\n      };\n\n      var isSingle = function (detail) {\n        return detail.rowspan === 1;\n      };\n\n      var getFallback = function () {\n        return Warehouse.getAt(warehouse, row, 0);\n      };\n\n      return decide(getBlock, isSingle, getFallback);\n    });\n  };\n\n  var deduce = function (xs, index) {\n    if (index < 0 || index >= xs.length - 1) {\n      return Optional.none();\n    }\n\n    var current = xs[index].fold(function () {\n      var rest = reverse(xs.slice(0, index));\n      return findMap(rest, function (a, i) {\n        return a.map(function (aa) {\n          return {\n            value: aa,\n            delta: i + 1\n          };\n        });\n      });\n    }, function (c) {\n      return Optional.some({\n        value: c,\n        delta: 0\n      });\n    });\n    var next = xs[index + 1].fold(function () {\n      var rest = xs.slice(index + 1);\n      return findMap(rest, function (a, i) {\n        return a.map(function (aa) {\n          return {\n            value: aa,\n            delta: i + 1\n          };\n        });\n      });\n    }, function (n) {\n      return Optional.some({\n        value: n,\n        delta: 1\n      });\n    });\n    return current.bind(function (c) {\n      return next.map(function (n) {\n        var extras = n.delta + c.delta;\n        return Math.abs(n.value - c.value) / extras;\n      });\n    });\n  };\n\n  var onDirection = function (isLtr, isRtl) {\n    return function (element) {\n      return getDirection(element) === 'rtl' ? isRtl : isLtr;\n    };\n  };\n\n  var getDirection = function (element) {\n    return get$a(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n  };\n\n  var api = Dimension('height', function (element) {\n    var dom = element.dom;\n    return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n  });\n\n  var get$7 = function (element) {\n    return api.get(element);\n  };\n\n  var getOuter$1 = function (element) {\n    return api.getOuter(element);\n  };\n\n  var getRuntime = getHeight$1;\n\n  var r = function (left, top) {\n    var translate = function (x, y) {\n      return r(left + x, top + y);\n    };\n\n    return {\n      left: left,\n      top: top,\n      translate: translate\n    };\n  };\n\n  var SugarPosition = r;\n\n  var boxPosition = function (dom) {\n    var box = dom.getBoundingClientRect();\n    return SugarPosition(box.left, box.top);\n  };\n\n  var firstDefinedOrZero = function (a, b) {\n    if (a !== undefined) {\n      return a;\n    } else {\n      return b !== undefined ? b : 0;\n    }\n  };\n\n  var absolute = function (element) {\n    var doc = element.dom.ownerDocument;\n    var body = doc.body;\n    var win = doc.defaultView;\n    var html = doc.documentElement;\n\n    if (body === element.dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n    var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n    var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n    var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n    return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n  };\n\n  var viewport = function (element) {\n    var dom = element.dom;\n    var doc = dom.ownerDocument;\n    var body = doc.body;\n\n    if (body === dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    if (!inBody(element)) {\n      return SugarPosition(0, 0);\n    }\n\n    return boxPosition(dom);\n  };\n\n  var rowInfo = function (row, y) {\n    return {\n      row: row,\n      y: y\n    };\n  };\n\n  var colInfo = function (col, x) {\n    return {\n      col: col,\n      x: x\n    };\n  };\n\n  var rtlEdge = function (cell) {\n    var pos = absolute(cell);\n    return pos.left + getOuter$2(cell);\n  };\n\n  var ltrEdge = function (cell) {\n    return absolute(cell).left;\n  };\n\n  var getLeftEdge = function (index, cell) {\n    return colInfo(index, ltrEdge(cell));\n  };\n\n  var getRightEdge = function (index, cell) {\n    return colInfo(index, rtlEdge(cell));\n  };\n\n  var getTop$1 = function (cell) {\n    return absolute(cell).top;\n  };\n\n  var getTopEdge = function (index, cell) {\n    return rowInfo(index, getTop$1(cell));\n  };\n\n  var getBottomEdge = function (index, cell) {\n    return rowInfo(index, getTop$1(cell) + getOuter$1(cell));\n  };\n\n  var findPositions = function (getInnerEdge, getOuterEdge, array) {\n    if (array.length === 0) {\n      return [];\n    }\n\n    var lines = map$1(array.slice(1), function (cellOption, index) {\n      return cellOption.map(function (cell) {\n        return getInnerEdge(index, cell);\n      });\n    });\n    var lastLine = array[array.length - 1].map(function (cell) {\n      return getOuterEdge(array.length - 1, cell);\n    });\n    return lines.concat([lastLine]);\n  };\n\n  var negate = function (step) {\n    return -step;\n  };\n\n  var height = {\n    delta: identity,\n    positions: function (optElements) {\n      return findPositions(getTopEdge, getBottomEdge, optElements);\n    },\n    edge: getTop$1\n  };\n  var ltr$1 = {\n    delta: identity,\n    edge: ltrEdge,\n    positions: function (optElements) {\n      return findPositions(getLeftEdge, getRightEdge, optElements);\n    }\n  };\n  var rtl$1 = {\n    delta: negate,\n    edge: rtlEdge,\n    positions: function (optElements) {\n      return findPositions(getRightEdge, getLeftEdge, optElements);\n    }\n  };\n  var detect$2 = onDirection(ltr$1, rtl$1);\n  var width = {\n    delta: function (amount, table) {\n      return detect$2(table).delta(amount, table);\n    },\n    positions: function (cols, table) {\n      return detect$2(table).positions(cols, table);\n    },\n    edge: function (cell) {\n      return detect$2(cell).edge(cell);\n    }\n  };\n  var units = {\n    unsupportedLength: ['em', 'ex', 'cap', 'ch', 'ic', 'rem', 'lh', 'rlh', 'vw', 'vh', 'vi', 'vb', 'vmin', 'vmax', 'cm', 'mm', 'Q', 'in', 'pc', 'pt', 'px'],\n    fixed: ['px', 'pt'],\n    relative: ['%'],\n    empty: ['']\n  };\n\n  var pattern = function () {\n    var decimalDigits = '[0-9]+';\n    var signedInteger = '[+-]?' + decimalDigits;\n    var exponentPart = '[eE]' + signedInteger;\n    var dot = '\\\\.';\n\n    var opt = function (input) {\n      return '(?:' + input + ')?';\n    };\n\n    var unsignedDecimalLiteral = ['Infinity', decimalDigits + dot + opt(decimalDigits) + opt(exponentPart), dot + decimalDigits + opt(exponentPart), decimalDigits + opt(exponentPart)].join('|');\n    var float = '[+-]?(?:' + unsignedDecimalLiteral + ')';\n    return new RegExp('^(' + float + ')(.*)$');\n  }();\n\n  var isUnit = function (unit, accepted) {\n    return exists(accepted, function (acc) {\n      return exists(units[acc], function (check) {\n        return unit === check;\n      });\n    });\n  };\n\n  var parse = function (input, accepted) {\n    var match = Optional.from(pattern.exec(input));\n    return match.bind(function (array) {\n      var value = Number(array[1]);\n      var unitRaw = array[2];\n\n      if (isUnit(unitRaw, accepted)) {\n        return Optional.some({\n          value: value,\n          unit: unitRaw\n        });\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var rPercentageBasedSizeRegex = /(\\d+(\\.\\d+)?)%/;\n  var rPixelBasedSizeRegex = /(\\d+(\\.\\d+)?)px|em/;\n  var isCol$2 = isTag('col');\n\n  var getPercentSize = function (elm, outerGetter, innerGetter) {\n    var relativeParent = parentElement(elm).getOrThunk(function () {\n      return getBody$1(owner(elm));\n    });\n    return outerGetter(elm) / innerGetter(relativeParent) * 100;\n  };\n\n  var setPixelWidth = function (cell, amount) {\n    set$1(cell, 'width', amount + 'px');\n  };\n\n  var setPercentageWidth = function (cell, amount) {\n    set$1(cell, 'width', amount + '%');\n  };\n\n  var setHeight = function (cell, amount) {\n    set$1(cell, 'height', amount + 'px');\n  };\n\n  var getHeightValue = function (cell) {\n    return getRuntime(cell) + 'px';\n  };\n\n  var convert = function (cell, number, getter, setter) {\n    var newSize = table(cell).map(function (table) {\n      var total = getter(table);\n      return Math.floor(number / 100 * total);\n    }).getOr(number);\n    setter(cell, newSize);\n    return newSize;\n  };\n\n  var normalizePixelSize = function (value, cell, getter, setter) {\n    var number = parseFloat(value);\n    return endsWith(value, '%') && name(cell) !== 'table' ? convert(cell, number, getter, setter) : number;\n  };\n\n  var getTotalHeight = function (cell) {\n    var value = getHeightValue(cell);\n\n    if (!value) {\n      return get$7(cell);\n    }\n\n    return normalizePixelSize(value, cell, get$7, setHeight);\n  };\n\n  var get$6 = function (cell, type, f) {\n    var v = f(cell);\n    var span = getSpan(cell, type);\n    return v / span;\n  };\n\n  var getRaw$1 = function (element, prop) {\n    return getRaw$2(element, prop).orThunk(function () {\n      return getOpt(element, prop).map(function (val) {\n        return val + 'px';\n      });\n    });\n  };\n\n  var getRawWidth$1 = function (element) {\n    return getRaw$1(element, 'width');\n  };\n\n  var getRawHeight = function (element) {\n    return getRaw$1(element, 'height');\n  };\n\n  var getPercentageWidth = function (cell) {\n    return getPercentSize(cell, get$8, getInner);\n  };\n\n  var getPixelWidth$1 = function (cell) {\n    return isCol$2(cell) ? get$8(cell) : getRuntime$1(cell);\n  };\n\n  var getHeight = function (cell) {\n    return get$6(cell, 'rowspan', getTotalHeight);\n  };\n\n  var getGenericWidth = function (cell) {\n    var width = getRawWidth$1(cell);\n    return width.bind(function (w) {\n      return parse(w, ['fixed', 'relative', 'empty']);\n    });\n  };\n\n  var setGenericWidth = function (cell, amount, unit) {\n    set$1(cell, 'width', amount + unit);\n  };\n\n  var getPixelTableWidth = function (table) {\n    return get$8(table) + 'px';\n  };\n\n  var getPercentTableWidth = function (table) {\n    return getPercentSize(table, get$8, getInner) + '%';\n  };\n\n  var isPercentSizing$1 = function (table) {\n    return getRawWidth$1(table).exists(function (size) {\n      return rPercentageBasedSizeRegex.test(size);\n    });\n  };\n\n  var isPixelSizing$1 = function (table) {\n    return getRawWidth$1(table).exists(function (size) {\n      return rPixelBasedSizeRegex.test(size);\n    });\n  };\n\n  var isNoneSizing$1 = function (table) {\n    return getRawWidth$1(table).isNone();\n  };\n\n  var percentageBasedSizeRegex = constant(rPercentageBasedSizeRegex);\n  var isCol$1 = isTag('col');\n\n  var getRawW = function (cell) {\n    return getRawWidth$1(cell).getOrThunk(function () {\n      return getPixelWidth$1(cell) + 'px';\n    });\n  };\n\n  var getRawH = function (cell) {\n    return getRawHeight(cell).getOrThunk(function () {\n      return getHeight(cell) + 'px';\n    });\n  };\n\n  var justCols = function (warehouse) {\n    return map$1(Warehouse.justColumns(warehouse), function (column) {\n      return Optional.from(column.element);\n    });\n  };\n\n  var isValidColumn = function (cell) {\n    var browser = detect$3().browser;\n    var supportsColWidths = browser.isChrome() || browser.isFirefox();\n    return isCol$1(cell) ? supportsColWidths : true;\n  };\n\n  var getDimension = function (cellOpt, index, backups, filter, getter, fallback) {\n    return cellOpt.filter(filter).fold(function () {\n      return fallback(deduce(backups, index));\n    }, function (cell) {\n      return getter(cell);\n    });\n  };\n\n  var getWidthFrom = function (warehouse, table, getWidth, fallback) {\n    var columnCells = columns(warehouse);\n    var columns$1 = Warehouse.hasColumns(warehouse) ? justCols(warehouse) : columnCells;\n    var backups = [Optional.some(width.edge(table))].concat(map$1(width.positions(columnCells, table), function (pos) {\n      return pos.map(function (p) {\n        return p.x;\n      });\n    }));\n    var colFilter = not(hasColspan);\n    return map$1(columns$1, function (cellOption, c) {\n      return getDimension(cellOption, c, backups, colFilter, function (column) {\n        if (isValidColumn(column)) {\n          return getWidth(column);\n        } else {\n          var cell = bindFrom(columnCells[c], identity);\n          return getDimension(cell, c, backups, colFilter, function (cell) {\n            return fallback(Optional.some(get$8(cell)));\n          }, fallback);\n        }\n      }, fallback);\n    });\n  };\n\n  var getDeduced = function (deduced) {\n    return deduced.map(function (d) {\n      return d + 'px';\n    }).getOr('');\n  };\n\n  var getRawWidths = function (warehouse, table) {\n    return getWidthFrom(warehouse, table, getRawW, getDeduced);\n  };\n\n  var getPercentageWidths = function (warehouse, table, tableSize) {\n    return getWidthFrom(warehouse, table, getPercentageWidth, function (deduced) {\n      return deduced.fold(function () {\n        return tableSize.minCellWidth();\n      }, function (cellWidth) {\n        return cellWidth / tableSize.pixelWidth() * 100;\n      });\n    });\n  };\n\n  var getPixelWidths = function (warehouse, table, tableSize) {\n    return getWidthFrom(warehouse, table, getPixelWidth$1, function (deduced) {\n      return deduced.getOrThunk(tableSize.minCellWidth);\n    });\n  };\n\n  var getHeightFrom = function (warehouse, table, direction, getHeight, fallback) {\n    var rows$1 = rows(warehouse);\n    var backups = [Optional.some(direction.edge(table))].concat(map$1(direction.positions(rows$1, table), function (pos) {\n      return pos.map(function (p) {\n        return p.y;\n      });\n    }));\n    return map$1(rows$1, function (cellOption, c) {\n      return getDimension(cellOption, c, backups, not(hasRowspan), getHeight, fallback);\n    });\n  };\n\n  var getPixelHeights = function (warehouse, table, direction) {\n    return getHeightFrom(warehouse, table, direction, getHeight, function (deduced) {\n      return deduced.getOrThunk(minHeight);\n    });\n  };\n\n  var getRawHeights = function (warehouse, table, direction) {\n    return getHeightFrom(warehouse, table, direction, getRawH, getDeduced);\n  };\n\n  var widthLookup = function (table, getter) {\n    return function () {\n      if (inBody(table)) {\n        return getter(table);\n      } else {\n        return parseFloat(getRaw$2(table, 'width').getOr('0'));\n      }\n    };\n  };\n\n  var noneSize = function (table) {\n    var getWidth = widthLookup(table, get$8);\n    var zero = constant(0);\n\n    var getWidths = function (warehouse, tableSize) {\n      return getPixelWidths(warehouse, table, tableSize);\n    };\n\n    return {\n      width: getWidth,\n      pixelWidth: getWidth,\n      getWidths: getWidths,\n      getCellDelta: zero,\n      singleColumnWidth: constant([0]),\n      minCellWidth: zero,\n      setElementWidth: noop,\n      adjustTableWidth: noop,\n      isRelative: true,\n      label: 'none'\n    };\n  };\n\n  var percentageSize = function (table) {\n    var getFloatWidth = widthLookup(table, function (elem) {\n      return parseFloat(getPercentTableWidth(elem));\n    });\n    var getWidth = widthLookup(table, get$8);\n\n    var getCellDelta = function (delta) {\n      return delta / getWidth() * 100;\n    };\n\n    var singleColumnWidth = function (w, _delta) {\n      return [100 - w];\n    };\n\n    var minCellWidth = function () {\n      return minWidth() / getWidth() * 100;\n    };\n\n    var adjustTableWidth = function (delta) {\n      var currentWidth = getFloatWidth();\n      var change = delta / 100 * currentWidth;\n      var newWidth = currentWidth + change;\n      setPercentageWidth(table, newWidth);\n    };\n\n    var getWidths = function (warehouse, tableSize) {\n      return getPercentageWidths(warehouse, table, tableSize);\n    };\n\n    return {\n      width: getFloatWidth,\n      pixelWidth: getWidth,\n      getWidths: getWidths,\n      getCellDelta: getCellDelta,\n      singleColumnWidth: singleColumnWidth,\n      minCellWidth: minCellWidth,\n      setElementWidth: setPercentageWidth,\n      adjustTableWidth: adjustTableWidth,\n      isRelative: true,\n      label: 'percent'\n    };\n  };\n\n  var pixelSize = function (table) {\n    var getWidth = widthLookup(table, get$8);\n    var getCellDelta = identity;\n\n    var singleColumnWidth = function (w, delta) {\n      var newNext = Math.max(minWidth(), w + delta);\n      return [newNext - w];\n    };\n\n    var adjustTableWidth = function (delta) {\n      var newWidth = getWidth() + delta;\n      setPixelWidth(table, newWidth);\n    };\n\n    var getWidths = function (warehouse, tableSize) {\n      return getPixelWidths(warehouse, table, tableSize);\n    };\n\n    return {\n      width: getWidth,\n      pixelWidth: getWidth,\n      getWidths: getWidths,\n      getCellDelta: getCellDelta,\n      singleColumnWidth: singleColumnWidth,\n      minCellWidth: minWidth,\n      setElementWidth: setPixelWidth,\n      adjustTableWidth: adjustTableWidth,\n      isRelative: false,\n      label: 'pixel'\n    };\n  };\n\n  var chooseSize = function (element, width) {\n    var percentMatch = percentageBasedSizeRegex().exec(width);\n\n    if (percentMatch !== null) {\n      return percentageSize(element);\n    } else {\n      return pixelSize(element);\n    }\n  };\n\n  var getTableSize = function (table) {\n    var width = getRawWidth$1(table);\n    return width.fold(function () {\n      return noneSize(table);\n    }, function (w) {\n      return chooseSize(table, w);\n    });\n  };\n\n  var TableSize = {\n    getTableSize: getTableSize,\n    pixelSize: pixelSize,\n    percentageSize: percentageSize,\n    noneSize: noneSize\n  };\n\n  var statsStruct = function (minRow, minCol, maxRow, maxCol, allCells, selectedCells) {\n    return {\n      minRow: minRow,\n      minCol: minCol,\n      maxRow: maxRow,\n      maxCol: maxCol,\n      allCells: allCells,\n      selectedCells: selectedCells\n    };\n  };\n\n  var findSelectedStats = function (house, isSelected) {\n    var totalColumns = house.grid.columns;\n    var totalRows = house.grid.rows;\n    var minRow = totalRows;\n    var minCol = totalColumns;\n    var maxRow = 0;\n    var maxCol = 0;\n    var allCells = [];\n    var selectedCells = [];\n    each$1(house.access, function (detail) {\n      allCells.push(detail);\n\n      if (isSelected(detail)) {\n        selectedCells.push(detail);\n        var startRow = detail.row;\n        var endRow = startRow + detail.rowspan - 1;\n        var startCol = detail.column;\n        var endCol = startCol + detail.colspan - 1;\n\n        if (startRow < minRow) {\n          minRow = startRow;\n        } else if (endRow > maxRow) {\n          maxRow = endRow;\n        }\n\n        if (startCol < minCol) {\n          minCol = startCol;\n        } else if (endCol > maxCol) {\n          maxCol = endCol;\n        }\n      }\n    });\n    return statsStruct(minRow, minCol, maxRow, maxCol, allCells, selectedCells);\n  };\n\n  var makeCell = function (list, seenSelected, rowIndex) {\n    var row = list[rowIndex].element;\n    var td = SugarElement.fromTag('td');\n    append$1(td, SugarElement.fromTag('br'));\n    var f = seenSelected ? append$1 : prepend;\n    f(row, td);\n  };\n\n  var fillInGaps = function (list, house, stats, isSelected) {\n    var totalColumns = house.grid.columns;\n    var totalRows = house.grid.rows;\n\n    for (var i = 0; i < totalRows; i++) {\n      var seenSelected = false;\n\n      for (var j = 0; j < totalColumns; j++) {\n        if (!(i < stats.minRow || i > stats.maxRow || j < stats.minCol || j > stats.maxCol)) {\n          var needCell = Warehouse.getAt(house, i, j).filter(isSelected).isNone();\n\n          if (needCell) {\n            makeCell(list, seenSelected, i);\n          } else {\n            seenSelected = true;\n          }\n        }\n      }\n    }\n  };\n\n  var clean = function (replica, stats, house, widthDelta) {\n    each$1(house.columns, function (col) {\n      if (col.column < stats.minCol || col.column > stats.maxCol) {\n        remove$5(col.element);\n      }\n    });\n    var emptyRows = filter$2(firstLayer(replica, 'tr'), function (row) {\n      return row.dom.childElementCount === 0;\n    });\n    each$2(emptyRows, remove$5);\n\n    if (stats.minCol === stats.maxCol || stats.minRow === stats.maxRow) {\n      each$2(firstLayer(replica, 'th,td'), function (cell) {\n        remove$7(cell, 'rowspan');\n        remove$7(cell, 'colspan');\n      });\n    }\n\n    remove$7(replica, LOCKED_COL_ATTR);\n    remove$7(replica, 'data-snooker-col-series');\n    var tableSize = TableSize.getTableSize(replica);\n    tableSize.adjustTableWidth(widthDelta);\n  };\n\n  var getTableWidthDelta = function (table, warehouse, tableSize, stats) {\n    if (stats.minCol === 0 && warehouse.grid.columns === stats.maxCol + 1) {\n      return 0;\n    }\n\n    var colWidths = getPixelWidths(warehouse, table, tableSize);\n    var allColsWidth = foldl(colWidths, function (acc, width) {\n      return acc + width;\n    }, 0);\n    var selectedColsWidth = foldl(colWidths.slice(stats.minCol, stats.maxCol + 1), function (acc, width) {\n      return acc + width;\n    }, 0);\n    var newWidth = selectedColsWidth / allColsWidth * tableSize.pixelWidth();\n    var delta = newWidth - tableSize.pixelWidth();\n    return tableSize.getCellDelta(delta);\n  };\n\n  var extract$1 = function (table, selectedSelector) {\n    var isSelected = function (detail) {\n      return is$2(detail.element, selectedSelector);\n    };\n\n    var replica = deep(table);\n    var list = fromTable$1(replica);\n    var tableSize = TableSize.getTableSize(table);\n    var replicaHouse = Warehouse.generate(list);\n    var replicaStats = findSelectedStats(replicaHouse, isSelected);\n    var selector = 'th:not(' + selectedSelector + ')' + ',td:not(' + selectedSelector + ')';\n    var unselectedCells = filterFirstLayer(replica, 'th,td', function (cell) {\n      return is$2(cell, selector);\n    });\n    each$2(unselectedCells, remove$5);\n    fillInGaps(list, replicaHouse, replicaStats, isSelected);\n    var house = Warehouse.fromTable(table);\n    var widthDelta = getTableWidthDelta(table, house, tableSize, replicaStats);\n    clean(replica, replicaStats, replicaHouse, widthDelta);\n    return replica;\n  };\n\n  var nbsp = '\\xA0';\n\n  var getEnd = function (element) {\n    return name(element) === 'img' ? 1 : getOption(element).fold(function () {\n      return children$3(element).length;\n    }, function (v) {\n      return v.length;\n    });\n  };\n\n  var isTextNodeWithCursorPosition = function (el) {\n    return getOption(el).filter(function (text) {\n      return text.trim().length !== 0 || text.indexOf(nbsp) > -1;\n    }).isSome();\n  };\n\n  var elementsWithCursorPosition = ['img', 'br'];\n\n  var isCursorPosition = function (elem) {\n    var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n    return hasCursorPosition || contains$2(elementsWithCursorPosition, name(elem));\n  };\n\n  var first = function (element) {\n    return descendant$1(element, isCursorPosition);\n  };\n\n  var last$1 = function (element) {\n    return descendantRtl(element, isCursorPosition);\n  };\n\n  var descendantRtl = function (scope, predicate) {\n    var descend = function (element) {\n      var children = children$3(element);\n\n      for (var i = children.length - 1; i >= 0; i--) {\n        var child = children[i];\n\n        if (predicate(child)) {\n          return Optional.some(child);\n        }\n\n        var res = descend(child);\n\n        if (res.isSome()) {\n          return res;\n        }\n      }\n\n      return Optional.none();\n    };\n\n    return descend(scope);\n  };\n\n  var transferableAttributes = {\n    scope: ['row', 'col']\n  };\n\n  var createCell = function (doc) {\n    return function () {\n      var td = SugarElement.fromTag('td', doc.dom);\n      append$1(td, SugarElement.fromTag('br', doc.dom));\n      return td;\n    };\n  };\n\n  var createCol = function (doc) {\n    return function () {\n      return SugarElement.fromTag('col', doc.dom);\n    };\n  };\n\n  var createColgroup = function (doc) {\n    return function () {\n      return SugarElement.fromTag('colgroup', doc.dom);\n    };\n  };\n\n  var createRow$1 = function (doc) {\n    return function () {\n      return SugarElement.fromTag('tr', doc.dom);\n    };\n  };\n\n  var replace$1 = function (cell, tag, attrs) {\n    var replica = copy$1(cell, tag);\n    each$1(attrs, function (v, k) {\n      if (v === null) {\n        remove$7(replica, k);\n      } else {\n        set$2(replica, k, v);\n      }\n    });\n    return replica;\n  };\n\n  var pasteReplace = function (cell) {\n    return cell;\n  };\n\n  var cloneFormats = function (oldCell, newCell, formats) {\n    var first$1 = first(oldCell);\n    return first$1.map(function (firstText) {\n      var formatSelector = formats.join(',');\n      var parents = ancestors$3(firstText, formatSelector, function (element) {\n        return eq$1(element, oldCell);\n      });\n      return foldr(parents, function (last, parent) {\n        var clonedFormat = shallow(parent);\n        remove$7(clonedFormat, 'contenteditable');\n        append$1(last, clonedFormat);\n        return clonedFormat;\n      }, newCell);\n    }).getOr(newCell);\n  };\n\n  var cloneAppropriateAttributes = function (original, clone) {\n    each$1(transferableAttributes, function (validAttributes, attributeName) {\n      return getOpt(original, attributeName).filter(function (attribute) {\n        return contains$2(validAttributes, attribute);\n      }).each(function (attribute) {\n        return set$2(clone, attributeName, attribute);\n      });\n    });\n  };\n\n  var cellOperations = function (mutate, doc, formatsToClone) {\n    var cloneCss = function (prev, clone) {\n      copy$2(prev.element, clone);\n      remove$6(clone, 'height');\n\n      if (prev.colspan !== 1) {\n        remove$6(clone, 'width');\n      }\n    };\n\n    var newCell = function (prev) {\n      var td = SugarElement.fromTag(name(prev.element), doc.dom);\n      var formats = formatsToClone.getOr(['strong', 'em', 'b', 'i', 'span', 'font', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'div']);\n      var lastNode = formats.length > 0 ? cloneFormats(prev.element, td, formats) : td;\n      append$1(lastNode, SugarElement.fromTag('br'));\n      cloneCss(prev, td);\n      cloneAppropriateAttributes(prev.element, td);\n      mutate(prev.element, td);\n      return td;\n    };\n\n    var newCol = function (prev) {\n      var col = SugarElement.fromTag(name(prev.element), doc.dom);\n      cloneCss(prev, col);\n      mutate(prev.element, col);\n      return col;\n    };\n\n    return {\n      col: newCol,\n      colgroup: createColgroup(doc),\n      row: createRow$1(doc),\n      cell: newCell,\n      replace: replace$1,\n      colGap: createCol(doc),\n      gap: createCell(doc)\n    };\n  };\n\n  var paste$1 = function (doc) {\n    return {\n      col: createCol(doc),\n      colgroup: createColgroup(doc),\n      row: createRow$1(doc),\n      cell: createCell(doc),\n      replace: pasteReplace,\n      colGap: createCol(doc),\n      gap: createCell(doc)\n    };\n  };\n\n  var fromHtml = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n    return children$3(SugarElement.fromDom(div));\n  };\n\n  var fromDom = function (nodes) {\n    return map$1(nodes, SugarElement.fromDom);\n  };\n\n  var getNodeName = function (elm) {\n    return elm.nodeName.toLowerCase();\n  };\n\n  var getBody = function (editor) {\n    return SugarElement.fromDom(editor.getBody());\n  };\n\n  var getPixelWidth = function (elm) {\n    return elm.getBoundingClientRect().width;\n  };\n\n  var getPixelHeight = function (elm) {\n    return elm.getBoundingClientRect().height;\n  };\n\n  var getIsRoot = function (editor) {\n    return function (element) {\n      return eq$1(element, getBody(editor));\n    };\n  };\n\n  var removePxSuffix = function (size) {\n    return size ? size.replace(/px$/, '') : '';\n  };\n\n  var addPxSuffix = function (size) {\n    return /^\\d+(\\.\\d+)?$/.test(size) ? size + 'px' : size;\n  };\n\n  var removeDataStyle = function (table) {\n    remove$7(table, 'data-mce-style');\n\n    var removeStyleAttribute = function (element) {\n      return remove$7(element, 'data-mce-style');\n    };\n\n    each$2(cells$1(table), removeStyleAttribute);\n    each$2(columns$1(table), removeStyleAttribute);\n    each$2(rows$1(table), removeStyleAttribute);\n  };\n\n  var getRawWidth = function (editor, elm) {\n    var raw = editor.dom.getStyle(elm, 'width') || editor.dom.getAttrib(elm, 'width');\n    return Optional.from(raw).filter(isNotEmpty);\n  };\n\n  var isPercentage$1 = function (value) {\n    return /^(\\d+(\\.\\d+)?)%$/.test(value);\n  };\n\n  var isPixel = function (value) {\n    return /^(\\d+(\\.\\d+)?)px$/.test(value);\n  };\n\n  var getSelectionStart = function (editor) {\n    return SugarElement.fromDom(editor.selection.getStart());\n  };\n\n  var getSelectionEnd = function (editor) {\n    return SugarElement.fromDom(editor.selection.getEnd());\n  };\n\n  var selection = function (selections) {\n    return cata$2(selections.get(), constant([]), identity, pure);\n  };\n\n  var unmergable = function (selections) {\n    var hasSpan = function (elem, type) {\n      return getOpt(elem, type).exists(function (span) {\n        return parseInt(span, 10) > 1;\n      });\n    };\n\n    var hasRowOrColSpan = function (elem) {\n      return hasSpan(elem, 'rowspan') || hasSpan(elem, 'colspan');\n    };\n\n    var candidates = selection(selections);\n    return candidates.length > 0 && forall(candidates, hasRowOrColSpan) ? Optional.some(candidates) : Optional.none();\n  };\n\n  var mergable = function (table, selections, ephemera) {\n    return cata$2(selections.get(), Optional.none, function (cells) {\n      if (cells.length <= 1) {\n        return Optional.none();\n      } else {\n        return retrieveBox(table, ephemera.firstSelectedSelector, ephemera.lastSelectedSelector).map(function (bounds) {\n          return {\n            bounds: bounds,\n            cells: cells\n          };\n        });\n      }\n    }, Optional.none);\n  };\n\n  var strSelected = 'data-mce-selected';\n  var strSelectedSelector = 'td[' + strSelected + '],th[' + strSelected + ']';\n  var strAttributeSelector = '[' + strSelected + ']';\n  var strFirstSelected = 'data-mce-first-selected';\n  var strFirstSelectedSelector = 'td[' + strFirstSelected + '],th[' + strFirstSelected + ']';\n  var strLastSelected = 'data-mce-last-selected';\n  var strLastSelectedSelector = 'td[' + strLastSelected + '],th[' + strLastSelected + ']';\n  var attributeSelector = strAttributeSelector;\n  var ephemera = {\n    selected: strSelected,\n    selectedSelector: strSelectedSelector,\n    firstSelected: strFirstSelected,\n    firstSelectedSelector: strFirstSelectedSelector,\n    lastSelected: strLastSelected,\n    lastSelectedSelector: strLastSelectedSelector\n  };\n\n  var noMenu = function (cell) {\n    return {\n      element: cell,\n      mergable: Optional.none(),\n      unmergable: Optional.none(),\n      selection: [cell]\n    };\n  };\n\n  var forMenu = function (selections, table, cell) {\n    return {\n      element: cell,\n      mergable: mergable(table, selections, ephemera),\n      unmergable: unmergable(selections),\n      selection: selection(selections)\n    };\n  };\n\n  var paste = function (element, clipboard, generators) {\n    return {\n      element: element,\n      clipboard: clipboard,\n      generators: generators\n    };\n  };\n\n  var pasteRows = function (selections, cell, clipboard, generators) {\n    return {\n      selection: selection(selections),\n      clipboard: clipboard,\n      generators: generators\n    };\n  };\n\n  var getSelectionCellFallback = function (element) {\n    return table(element).bind(function (table) {\n      return retrieve(table, ephemera.firstSelectedSelector);\n    }).fold(constant(element), function (cells) {\n      return cells[0];\n    });\n  };\n\n  var getSelectionFromSelector = function (selector) {\n    return function (initCell, isRoot) {\n      var cellName = name(initCell);\n      var cell = cellName === 'col' || cellName === 'colgroup' ? getSelectionCellFallback(initCell) : initCell;\n      return closest$1(cell, selector, isRoot);\n    };\n  };\n\n  var getSelectionCellOrCaption = getSelectionFromSelector('th,td,caption');\n  var getSelectionCell = getSelectionFromSelector('th,td');\n\n  var getCellsFromSelection = function (selections) {\n    return selection(selections);\n  };\n\n  var getRowsFromSelection = function (selected, selector) {\n    var cellOpt = getSelectionCell(selected);\n    var rowsOpt = cellOpt.bind(function (cell) {\n      return table(cell);\n    }).map(function (table) {\n      return rows$1(table);\n    });\n    return lift2(cellOpt, rowsOpt, function (cell, rows) {\n      return filter$2(rows, function (row) {\n        return exists(fromDom(row.dom.cells), function (rowCell) {\n          return get$b(rowCell, selector) === '1' || eq$1(rowCell, cell);\n        });\n      });\n    }).getOr([]);\n  };\n\n  var extractSelected = function (cells) {\n    return table(cells[0]).map(function (table) {\n      var replica = extract$1(table, attributeSelector);\n      removeDataStyle(replica);\n      return [replica];\n    });\n  };\n\n  var serializeElements = function (editor, elements) {\n    return map$1(elements, function (elm) {\n      return editor.selection.serializer.serialize(elm.dom, {});\n    }).join('');\n  };\n\n  var getTextContent = function (elements) {\n    return map$1(elements, function (element) {\n      return element.dom.innerText;\n    }).join('');\n  };\n\n  var registerEvents = function (editor, selections, actions) {\n    editor.on('BeforeGetContent', function (e) {\n      var multiCellContext = function (cells) {\n        e.preventDefault();\n        extractSelected(cells).each(function (elements) {\n          e.content = e.format === 'text' ? getTextContent(elements) : serializeElements(editor, elements);\n        });\n      };\n\n      if (e.selection === true) {\n        cata$2(selections.get(), noop, multiCellContext, noop);\n      }\n    });\n    editor.on('BeforeSetContent', function (e) {\n      if (e.selection === true && e.paste === true) {\n        var selectedCells = getCellsFromSelection(selections);\n        head(selectedCells).each(function (cell) {\n          table(cell).each(function (table) {\n            var elements = filter$2(fromHtml(e.content), function (content) {\n              return name(content) !== 'meta';\n            });\n            var isTable = isTag('table');\n\n            if (elements.length === 1 && isTable(elements[0])) {\n              e.preventDefault();\n              var doc = SugarElement.fromDom(editor.getDoc());\n              var generators = paste$1(doc);\n              var targets = paste(cell, elements[0], generators);\n              actions.pasteCells(table, targets).each(function () {\n                editor.focus();\n              });\n            }\n          });\n        });\n      }\n    });\n  };\n\n  var adt$7 = Adt.generate([{\n    none: []\n  }, {\n    only: ['index']\n  }, {\n    left: ['index', 'next']\n  }, {\n    middle: ['prev', 'index', 'next']\n  }, {\n    right: ['prev', 'index']\n  }]);\n\n  var ColumnContext = __assign({}, adt$7);\n\n  var neighbours = function (input, index) {\n    if (input.length === 0) {\n      return ColumnContext.none();\n    }\n\n    if (input.length === 1) {\n      return ColumnContext.only(0);\n    }\n\n    if (index === 0) {\n      return ColumnContext.left(0, 1);\n    }\n\n    if (index === input.length - 1) {\n      return ColumnContext.right(index - 1, index);\n    }\n\n    if (index > 0 && index < input.length - 1) {\n      return ColumnContext.middle(index - 1, index, index + 1);\n    }\n\n    return ColumnContext.none();\n  };\n\n  var determine = function (input, column, step, tableSize, resize) {\n    var result = input.slice(0);\n    var context = neighbours(input, column);\n    var onNone = constant(map$1(result, constant(0)));\n\n    var onOnly = function (index) {\n      return tableSize.singleColumnWidth(result[index], step);\n    };\n\n    var onLeft = function (index, next) {\n      return resize.calcLeftEdgeDeltas(result, index, next, step, tableSize.minCellWidth(), tableSize.isRelative);\n    };\n\n    var onMiddle = function (prev, index, next) {\n      return resize.calcMiddleDeltas(result, prev, index, next, step, tableSize.minCellWidth(), tableSize.isRelative);\n    };\n\n    var onRight = function (prev, index) {\n      return resize.calcRightEdgeDeltas(result, prev, index, step, tableSize.minCellWidth(), tableSize.isRelative);\n    };\n\n    return context.fold(onNone, onOnly, onLeft, onMiddle, onRight);\n  };\n\n  var total = function (start, end, measures) {\n    var r = 0;\n\n    for (var i = start; i < end; i++) {\n      r += measures[i] !== undefined ? measures[i] : 0;\n    }\n\n    return r;\n  };\n\n  var recalculateWidthForCells = function (warehouse, widths) {\n    var all = Warehouse.justCells(warehouse);\n    return map$1(all, function (cell) {\n      var width = total(cell.column, cell.column + cell.colspan, widths);\n      return {\n        element: cell.element,\n        width: width,\n        colspan: cell.colspan\n      };\n    });\n  };\n\n  var recalculateWidthForColumns = function (warehouse, widths) {\n    var groups = Warehouse.justColumns(warehouse);\n    return map$1(groups, function (column, index) {\n      return {\n        element: column.element,\n        width: widths[index],\n        colspan: column.colspan\n      };\n    });\n  };\n\n  var recalculateHeightForCells = function (warehouse, heights) {\n    var all = Warehouse.justCells(warehouse);\n    return map$1(all, function (cell) {\n      var height = total(cell.row, cell.row + cell.rowspan, heights);\n      return {\n        element: cell.element,\n        height: height,\n        rowspan: cell.rowspan\n      };\n    });\n  };\n\n  var matchRowHeight = function (warehouse, heights) {\n    return map$1(warehouse.all, function (row, i) {\n      return {\n        element: row.element,\n        height: heights[i]\n      };\n    });\n  };\n\n  var sumUp = function (newSize) {\n    return foldr(newSize, function (b, a) {\n      return b + a;\n    }, 0);\n  };\n\n  var recalculate = function (warehouse, widths) {\n    if (Warehouse.hasColumns(warehouse)) {\n      return recalculateWidthForColumns(warehouse, widths);\n    } else {\n      return recalculateWidthForCells(warehouse, widths);\n    }\n  };\n\n  var recalculateAndApply = function (warehouse, widths, tableSize) {\n    var newSizes = recalculate(warehouse, widths);\n    each$2(newSizes, function (cell) {\n      tableSize.setElementWidth(cell.element, cell.width);\n    });\n  };\n\n  var adjustWidth = function (table, delta, index, resizing, tableSize) {\n    var warehouse = Warehouse.fromTable(table);\n    var step = tableSize.getCellDelta(delta);\n    var widths = tableSize.getWidths(warehouse, tableSize);\n    var isLastColumn = index === warehouse.grid.columns - 1;\n    var clampedStep = resizing.clampTableDelta(widths, index, step, tableSize.minCellWidth(), isLastColumn);\n    var deltas = determine(widths, index, clampedStep, tableSize, resizing);\n    var newWidths = map$1(deltas, function (dx, i) {\n      return dx + widths[i];\n    });\n    recalculateAndApply(warehouse, newWidths, tableSize);\n    resizing.resizeTable(tableSize.adjustTableWidth, clampedStep, isLastColumn);\n  };\n\n  var adjustHeight = function (table, delta, index, direction) {\n    var warehouse = Warehouse.fromTable(table);\n    var heights = getPixelHeights(warehouse, table, direction);\n    var newHeights = map$1(heights, function (dy, i) {\n      return index === i ? Math.max(delta + dy, minHeight()) : dy;\n    });\n    var newCellSizes = recalculateHeightForCells(warehouse, newHeights);\n    var newRowSizes = matchRowHeight(warehouse, newHeights);\n    each$2(newRowSizes, function (row) {\n      setHeight(row.element, row.height);\n    });\n    each$2(newCellSizes, function (cell) {\n      setHeight(cell.element, cell.height);\n    });\n    var total = sumUp(newHeights);\n    setHeight(table, total);\n  };\n\n  var adjustAndRedistributeWidths$1 = function (_table, list, details, tableSize, resizeBehaviour) {\n    var warehouse = Warehouse.generate(list);\n    var sizes = tableSize.getWidths(warehouse, tableSize);\n    var tablePixelWidth = tableSize.pixelWidth();\n\n    var _a = resizeBehaviour.calcRedestributedWidths(sizes, tablePixelWidth, details.pixelDelta, tableSize.isRelative),\n        newSizes = _a.newSizes,\n        delta = _a.delta;\n\n    recalculateAndApply(warehouse, newSizes, tableSize);\n    tableSize.adjustTableWidth(delta);\n  };\n\n  var adjustWidthTo = function (_table, list, _info, tableSize) {\n    var warehouse = Warehouse.generate(list);\n    var widths = tableSize.getWidths(warehouse, tableSize);\n    recalculateAndApply(warehouse, widths, tableSize);\n  };\n\n  var zero = function (array) {\n    return map$1(array, constant(0));\n  };\n\n  var surround = function (sizes, startIndex, endIndex, results, f) {\n    return f(sizes.slice(0, startIndex)).concat(results).concat(f(sizes.slice(endIndex)));\n  };\n\n  var clampDeltaHelper = function (predicate) {\n    return function (sizes, index, delta, minCellSize) {\n      if (!predicate(delta)) {\n        return delta;\n      } else {\n        var newSize = Math.max(minCellSize, sizes[index] - Math.abs(delta));\n        var diff = Math.abs(newSize - sizes[index]);\n        return delta >= 0 ? diff : -diff;\n      }\n    };\n  };\n\n  var clampNegativeDelta = clampDeltaHelper(function (delta) {\n    return delta < 0;\n  });\n  var clampDelta = clampDeltaHelper(always);\n\n  var resizeTable = function () {\n    var calcFixedDeltas = function (sizes, index, next, delta, minCellSize) {\n      var clampedDelta = clampNegativeDelta(sizes, index, delta, minCellSize);\n      return surround(sizes, index, next + 1, [clampedDelta, 0], zero);\n    };\n\n    var calcRelativeDeltas = function (sizes, index, delta, minCellSize) {\n      var ratio = (100 + delta) / 100;\n      var newThis = Math.max(minCellSize, (sizes[index] + delta) / ratio);\n      return map$1(sizes, function (size, idx) {\n        var newSize = idx === index ? newThis : size / ratio;\n        return newSize - size;\n      });\n    };\n\n    var calcLeftEdgeDeltas = function (sizes, index, next, delta, minCellSize, isRelative) {\n      if (isRelative) {\n        return calcRelativeDeltas(sizes, index, delta, minCellSize);\n      } else {\n        return calcFixedDeltas(sizes, index, next, delta, minCellSize);\n      }\n    };\n\n    var calcMiddleDeltas = function (sizes, _prev, index, next, delta, minCellSize, isRelative) {\n      return calcLeftEdgeDeltas(sizes, index, next, delta, minCellSize, isRelative);\n    };\n\n    var resizeTable = function (resizer, delta) {\n      return resizer(delta);\n    };\n\n    var calcRightEdgeDeltas = function (sizes, _prev, index, delta, minCellSize, isRelative) {\n      if (isRelative) {\n        return calcRelativeDeltas(sizes, index, delta, minCellSize);\n      } else {\n        var clampedDelta = clampNegativeDelta(sizes, index, delta, minCellSize);\n        return zero(sizes.slice(0, index)).concat([clampedDelta]);\n      }\n    };\n\n    var calcRedestributedWidths = function (sizes, totalWidth, pixelDelta, isRelative) {\n      if (isRelative) {\n        var tableWidth = totalWidth + pixelDelta;\n        var ratio_1 = tableWidth / totalWidth;\n        var newSizes = map$1(sizes, function (size) {\n          return size / ratio_1;\n        });\n        return {\n          delta: ratio_1 * 100 - 100,\n          newSizes: newSizes\n        };\n      } else {\n        return {\n          delta: pixelDelta,\n          newSizes: sizes\n        };\n      }\n    };\n\n    return {\n      resizeTable: resizeTable,\n      clampTableDelta: clampNegativeDelta,\n      calcLeftEdgeDeltas: calcLeftEdgeDeltas,\n      calcMiddleDeltas: calcMiddleDeltas,\n      calcRightEdgeDeltas: calcRightEdgeDeltas,\n      calcRedestributedWidths: calcRedestributedWidths\n    };\n  };\n\n  var preserveTable = function () {\n    var calcLeftEdgeDeltas = function (sizes, index, next, delta, minCellSize) {\n      var idx = delta >= 0 ? next : index;\n      var clampedDelta = clampDelta(sizes, idx, delta, minCellSize);\n      return surround(sizes, index, next + 1, [clampedDelta, -clampedDelta], zero);\n    };\n\n    var calcMiddleDeltas = function (sizes, _prev, index, next, delta, minCellSize) {\n      return calcLeftEdgeDeltas(sizes, index, next, delta, minCellSize);\n    };\n\n    var resizeTable = function (resizer, delta, isLastColumn) {\n      if (isLastColumn) {\n        resizer(delta);\n      }\n    };\n\n    var calcRightEdgeDeltas = function (sizes, _prev, _index, delta, _minCellSize, isRelative) {\n      if (isRelative) {\n        return zero(sizes);\n      } else {\n        var diff = delta / sizes.length;\n        return map$1(sizes, constant(diff));\n      }\n    };\n\n    var clampTableDelta = function (sizes, index, delta, minCellSize, isLastColumn) {\n      if (isLastColumn) {\n        if (delta >= 0) {\n          return delta;\n        } else {\n          var maxDelta = foldl(sizes, function (a, b) {\n            return a + b - minCellSize;\n          }, 0);\n          return Math.max(-maxDelta, delta);\n        }\n      } else {\n        return clampNegativeDelta(sizes, index, delta, minCellSize);\n      }\n    };\n\n    var calcRedestributedWidths = function (sizes, _totalWidth, _pixelDelta, _isRelative) {\n      return {\n        delta: 0,\n        newSizes: sizes\n      };\n    };\n\n    return {\n      resizeTable: resizeTable,\n      clampTableDelta: clampTableDelta,\n      calcLeftEdgeDeltas: calcLeftEdgeDeltas,\n      calcMiddleDeltas: calcMiddleDeltas,\n      calcRightEdgeDeltas: calcRightEdgeDeltas,\n      calcRedestributedWidths: calcRedestributedWidths\n    };\n  };\n\n  var only = function (element, isResizable) {\n    var parent = Optional.from(element.dom.documentElement).map(SugarElement.fromDom).getOr(element);\n    return {\n      parent: constant(parent),\n      view: constant(element),\n      origin: constant(SugarPosition(0, 0)),\n      isResizable: isResizable\n    };\n  };\n\n  var detached = function (editable, chrome, isResizable) {\n    var origin = function () {\n      return absolute(chrome);\n    };\n\n    return {\n      parent: constant(chrome),\n      view: constant(editable),\n      origin: origin,\n      isResizable: isResizable\n    };\n  };\n\n  var body = function (editable, chrome, isResizable) {\n    return {\n      parent: constant(chrome),\n      view: constant(editable),\n      origin: constant(SugarPosition(0, 0)),\n      isResizable: isResizable\n    };\n  };\n\n  var ResizeWire = {\n    only: only,\n    detached: detached,\n    body: body\n  };\n  var adt$6 = Adt.generate([{\n    invalid: ['raw']\n  }, {\n    pixels: ['value']\n  }, {\n    percent: ['value']\n  }]);\n\n  var validateFor = function (suffix, type, value) {\n    var rawAmount = value.substring(0, value.length - suffix.length);\n    var amount = parseFloat(rawAmount);\n    return rawAmount === amount.toString() ? type(amount) : adt$6.invalid(value);\n  };\n\n  var from = function (value) {\n    if (endsWith(value, '%')) {\n      return validateFor('%', adt$6.percent, value);\n    }\n\n    if (endsWith(value, 'px')) {\n      return validateFor('px', adt$6.pixels, value);\n    }\n\n    return adt$6.invalid(value);\n  };\n\n  var Size = __assign(__assign({}, adt$6), {\n    from: from\n  });\n\n  var redistributeToPercent = function (widths, totalWidth) {\n    return map$1(widths, function (w) {\n      var colType = Size.from(w);\n      return colType.fold(function () {\n        return w;\n      }, function (px) {\n        var ratio = px / totalWidth * 100;\n        return ratio + '%';\n      }, function (pc) {\n        return pc + '%';\n      });\n    });\n  };\n\n  var redistributeToPx = function (widths, totalWidth, newTotalWidth) {\n    var scale = newTotalWidth / totalWidth;\n    return map$1(widths, function (w) {\n      var colType = Size.from(w);\n      return colType.fold(function () {\n        return w;\n      }, function (px) {\n        return px * scale + 'px';\n      }, function (pc) {\n        return pc / 100 * newTotalWidth + 'px';\n      });\n    });\n  };\n\n  var redistributeEmpty = function (newWidthType, columns) {\n    var f = newWidthType.fold(function () {\n      return constant('');\n    }, function (pixels) {\n      var num = pixels / columns;\n      return constant(num + 'px');\n    }, function () {\n      var num = 100 / columns;\n      return constant(num + '%');\n    });\n    return range$1(columns, f);\n  };\n\n  var redistributeValues = function (newWidthType, widths, totalWidth) {\n    return newWidthType.fold(function () {\n      return widths;\n    }, function (px) {\n      return redistributeToPx(widths, totalWidth, px);\n    }, function (_pc) {\n      return redistributeToPercent(widths, totalWidth);\n    });\n  };\n\n  var redistribute$1 = function (widths, totalWidth, newWidth) {\n    var newType = Size.from(newWidth);\n    var floats = forall(widths, function (s) {\n      return s === '0px';\n    }) ? redistributeEmpty(newType, widths.length) : redistributeValues(newType, widths, totalWidth);\n    return normalize(floats);\n  };\n\n  var sum = function (values, fallback) {\n    if (values.length === 0) {\n      return fallback;\n    }\n\n    return foldr(values, function (rest, v) {\n      return Size.from(v).fold(constant(0), identity, identity) + rest;\n    }, 0);\n  };\n\n  var roundDown = function (num, unit) {\n    var floored = Math.floor(num);\n    return {\n      value: floored + unit,\n      remainder: num - floored\n    };\n  };\n\n  var add$3 = function (value, amount) {\n    return Size.from(value).fold(constant(value), function (px) {\n      return px + amount + 'px';\n    }, function (pc) {\n      return pc + amount + '%';\n    });\n  };\n\n  var normalize = function (values) {\n    if (values.length === 0) {\n      return values;\n    }\n\n    var scan = foldr(values, function (rest, value) {\n      var info = Size.from(value).fold(function () {\n        return {\n          value: value,\n          remainder: 0\n        };\n      }, function (num) {\n        return roundDown(num, 'px');\n      }, function (num) {\n        return {\n          value: num + '%',\n          remainder: 0\n        };\n      });\n      return {\n        output: [info.value].concat(rest.output),\n        remainder: rest.remainder + info.remainder\n      };\n    }, {\n      output: [],\n      remainder: 0\n    });\n    var r = scan.output;\n    return r.slice(0, r.length - 1).concat([add$3(r[r.length - 1], Math.round(scan.remainder))]);\n  };\n\n  var validate = Size.from;\n\n  var redistributeToW = function (newWidths, cells, unit) {\n    each$2(cells, function (cell) {\n      var widths = newWidths.slice(cell.column, cell.colspan + cell.column);\n      var w = sum(widths, minWidth());\n      set$1(cell.element, 'width', w + unit);\n    });\n  };\n\n  var redistributeToColumns = function (newWidths, columns, unit) {\n    each$2(columns, function (column, index) {\n      var width = sum([newWidths[index]], minWidth());\n      set$1(column.element, 'width', width + unit);\n    });\n  };\n\n  var redistributeToH = function (newHeights, rows, cells, unit) {\n    each$2(cells, function (cell) {\n      var heights = newHeights.slice(cell.row, cell.rowspan + cell.row);\n      var h = sum(heights, minHeight());\n      set$1(cell.element, 'height', h + unit);\n    });\n    each$2(rows, function (row, i) {\n      set$1(row.element, 'height', newHeights[i]);\n    });\n  };\n\n  var getUnit = function (newSize) {\n    return validate(newSize).fold(constant('px'), constant('px'), constant('%'));\n  };\n\n  var redistribute = function (table, optWidth, optHeight) {\n    var warehouse = Warehouse.fromTable(table);\n    var rows = warehouse.all;\n    var cells = Warehouse.justCells(warehouse);\n    var columns = Warehouse.justColumns(warehouse);\n    optWidth.each(function (newWidth) {\n      var widthUnit = getUnit(newWidth);\n      var totalWidth = get$8(table);\n      var oldWidths = getRawWidths(warehouse, table);\n      var nuWidths = redistribute$1(oldWidths, totalWidth, newWidth);\n\n      if (Warehouse.hasColumns(warehouse)) {\n        redistributeToColumns(nuWidths, columns, widthUnit);\n      } else {\n        redistributeToW(nuWidths, cells, widthUnit);\n      }\n\n      set$1(table, 'width', newWidth);\n    });\n    optHeight.each(function (newHeight) {\n      var hUnit = getUnit(newHeight);\n      var totalHeight = get$7(table);\n      var oldHeights = getRawHeights(warehouse, table, height);\n      var nuHeights = redistribute$1(oldHeights, totalHeight, newHeight);\n      redistributeToH(nuHeights, rows, cells, hUnit);\n      set$1(table, 'height', newHeight);\n    });\n  };\n\n  var isPercentSizing = isPercentSizing$1;\n  var isPixelSizing = isPixelSizing$1;\n  var isNoneSizing = isNoneSizing$1;\n\n  var getGridSize = function (table) {\n    var warehouse = Warehouse.fromTable(table);\n    return warehouse.grid;\n  };\n\n  var Event = function (fields) {\n    var handlers = [];\n\n    var bind = function (handler) {\n      if (handler === undefined) {\n        throw new Error('Event bind error: undefined handler');\n      }\n\n      handlers.push(handler);\n    };\n\n    var unbind = function (handler) {\n      handlers = filter$2(handlers, function (h) {\n        return h !== handler;\n      });\n    };\n\n    var trigger = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      var event = {};\n      each$2(fields, function (name, i) {\n        event[name] = args[i];\n      });\n      each$2(handlers, function (handler) {\n        handler(event);\n      });\n    };\n\n    return {\n      bind: bind,\n      unbind: unbind,\n      trigger: trigger\n    };\n  };\n\n  var create$4 = function (typeDefs) {\n    var registry = map(typeDefs, function (event) {\n      return {\n        bind: event.bind,\n        unbind: event.unbind\n      };\n    });\n    var trigger = map(typeDefs, function (event) {\n      return event.trigger;\n    });\n    return {\n      registry: registry,\n      trigger: trigger\n    };\n  };\n\n  var last = function (fn, rate) {\n    var timer = null;\n\n    var cancel = function () {\n      if (!isNull(timer)) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      cancel();\n      timer = setTimeout(function () {\n        timer = null;\n        fn.apply(null, args);\n      }, rate);\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  var sort = function (arr) {\n    return arr.slice(0).sort();\n  };\n\n  var reqMessage = function (required, keys) {\n    throw new Error('All required keys (' + sort(required).join(', ') + ') were not specified. Specified keys were: ' + sort(keys).join(', ') + '.');\n  };\n\n  var unsuppMessage = function (unsupported) {\n    throw new Error('Unsupported keys for object: ' + sort(unsupported).join(', '));\n  };\n\n  var validateStrArr = function (label, array) {\n    if (!isArray(array)) {\n      throw new Error('The ' + label + ' fields must be an array. Was: ' + array + '.');\n    }\n\n    each$2(array, function (a) {\n      if (!isString(a)) {\n        throw new Error('The value ' + a + ' in the ' + label + ' fields was not a string.');\n      }\n    });\n  };\n\n  var invalidTypeMessage = function (incorrect, type) {\n    throw new Error('All values need to be of type: ' + type + '. Keys (' + sort(incorrect).join(', ') + ') were not.');\n  };\n\n  var checkDupes = function (everything) {\n    var sorted = sort(everything);\n    var dupe = find$1(sorted, function (s, i) {\n      return i < sorted.length - 1 && s === sorted[i + 1];\n    });\n    dupe.each(function (d) {\n      throw new Error('The field: ' + d + ' occurs more than once in the combined fields: [' + sorted.join(', ') + '].');\n    });\n  };\n\n  var base = function (handleUnsupported, required) {\n    return baseWith(handleUnsupported, required, {\n      validate: isFunction,\n      label: 'function'\n    });\n  };\n\n  var baseWith = function (handleUnsupported, required, pred) {\n    if (required.length === 0) {\n      throw new Error('You must specify at least one required field.');\n    }\n\n    validateStrArr('required', required);\n    checkDupes(required);\n    return function (obj) {\n      var keys$1 = keys(obj);\n      var allReqd = forall(required, function (req) {\n        return contains$2(keys$1, req);\n      });\n\n      if (!allReqd) {\n        reqMessage(required, keys$1);\n      }\n\n      handleUnsupported(required, keys$1);\n      var invalidKeys = filter$2(required, function (key) {\n        return !pred.validate(obj[key], key);\n      });\n\n      if (invalidKeys.length > 0) {\n        invalidTypeMessage(invalidKeys, pred.label);\n      }\n\n      return obj;\n    };\n  };\n\n  var handleExact = function (required, keys) {\n    var unsupported = filter$2(keys, function (key) {\n      return !contains$2(required, key);\n    });\n\n    if (unsupported.length > 0) {\n      unsuppMessage(unsupported);\n    }\n  };\n\n  var exactly = function (required) {\n    return base(handleExact, required);\n  };\n\n  var DragMode = exactly(['compare', 'extract', 'mutate', 'sink']);\n  var DragSink = exactly(['element', 'start', 'stop', 'destroy']);\n  var DragApi = exactly(['forceDrop', 'drop', 'move', 'delayDrop']);\n\n  var InDrag = function () {\n    var previous = Optional.none();\n\n    var reset = function () {\n      previous = Optional.none();\n    };\n\n    var update = function (mode, nu) {\n      var result = previous.map(function (old) {\n        return mode.compare(old, nu);\n      });\n      previous = Optional.some(nu);\n      return result;\n    };\n\n    var onEvent = function (event, mode) {\n      var dataOption = mode.extract(event);\n      dataOption.each(function (data) {\n        var offset = update(mode, data);\n        offset.each(function (d) {\n          events.trigger.move(d);\n        });\n      });\n    };\n\n    var events = create$4({\n      move: Event(['info'])\n    });\n    return {\n      onEvent: onEvent,\n      reset: reset,\n      events: events.registry\n    };\n  };\n\n  var NoDrag = function () {\n    var events = create$4({\n      move: Event(['info'])\n    });\n    return {\n      onEvent: noop,\n      reset: noop,\n      events: events.registry\n    };\n  };\n\n  var Movement = function () {\n    var noDragState = NoDrag();\n    var inDragState = InDrag();\n    var dragState = noDragState;\n\n    var on = function () {\n      dragState.reset();\n      dragState = inDragState;\n    };\n\n    var off = function () {\n      dragState.reset();\n      dragState = noDragState;\n    };\n\n    var onEvent = function (event, mode) {\n      dragState.onEvent(event, mode);\n    };\n\n    var isOn = function () {\n      return dragState === inDragState;\n    };\n\n    return {\n      on: on,\n      off: off,\n      isOn: isOn,\n      onEvent: onEvent,\n      events: inDragState.events\n    };\n  };\n\n  var setup = function (mutation, mode, settings) {\n    var active = false;\n    var events = create$4({\n      start: Event([]),\n      stop: Event([])\n    });\n    var movement = Movement();\n\n    var drop = function () {\n      sink.stop();\n\n      if (movement.isOn()) {\n        movement.off();\n        events.trigger.stop();\n      }\n    };\n\n    var throttledDrop = last(drop, 200);\n\n    var go = function (parent) {\n      sink.start(parent);\n      movement.on();\n      events.trigger.start();\n    };\n\n    var mousemove = function (event) {\n      throttledDrop.cancel();\n      movement.onEvent(event, mode);\n    };\n\n    movement.events.move.bind(function (event) {\n      mode.mutate(mutation, event.info);\n    });\n\n    var on = function () {\n      active = true;\n    };\n\n    var off = function () {\n      active = false;\n    };\n\n    var runIfActive = function (f) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        if (active) {\n          f.apply(null, args);\n        }\n      };\n    };\n\n    var sink = mode.sink(DragApi({\n      forceDrop: drop,\n      drop: runIfActive(drop),\n      move: runIfActive(mousemove),\n      delayDrop: runIfActive(throttledDrop.throttle)\n    }), settings);\n\n    var destroy = function () {\n      sink.destroy();\n    };\n\n    return {\n      element: sink.element,\n      go: go,\n      on: on,\n      off: off,\n      destroy: destroy,\n      events: events.registry\n    };\n  };\n\n  var mkEvent = function (target, x, y, stop, prevent, kill, raw) {\n    return {\n      target: target,\n      x: x,\n      y: y,\n      stop: stop,\n      prevent: prevent,\n      kill: kill,\n      raw: raw\n    };\n  };\n\n  var fromRawEvent$1 = function (rawEvent) {\n    var target = SugarElement.fromDom(getOriginalEventTarget(rawEvent).getOr(rawEvent.target));\n\n    var stop = function () {\n      return rawEvent.stopPropagation();\n    };\n\n    var prevent = function () {\n      return rawEvent.preventDefault();\n    };\n\n    var kill = compose(prevent, stop);\n    return mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n  };\n\n  var handle$2 = function (filter, handler) {\n    return function (rawEvent) {\n      if (filter(rawEvent)) {\n        handler(fromRawEvent$1(rawEvent));\n      }\n    };\n  };\n\n  var binder = function (element, event, filter, handler, useCapture) {\n    var wrapped = handle$2(filter, handler);\n    element.dom.addEventListener(event, wrapped, useCapture);\n    return {\n      unbind: curry(unbind, element, event, wrapped, useCapture)\n    };\n  };\n\n  var bind$1 = function (element, event, filter, handler) {\n    return binder(element, event, filter, handler, false);\n  };\n\n  var unbind = function (element, event, handler, useCapture) {\n    element.dom.removeEventListener(event, handler, useCapture);\n  };\n\n  var filter = always;\n\n  var bind = function (element, event, handler) {\n    return bind$1(element, event, filter, handler);\n  };\n\n  var fromRawEvent = fromRawEvent$1;\n\n  var read = function (element, attr) {\n    var value = get$b(element, attr);\n    return value === undefined || value === '' ? [] : value.split(' ');\n  };\n\n  var add$2 = function (element, attr, id) {\n    var old = read(element, attr);\n    var nu = old.concat([id]);\n    set$2(element, attr, nu.join(' '));\n    return true;\n  };\n\n  var remove$4 = function (element, attr, id) {\n    var nu = filter$2(read(element, attr), function (v) {\n      return v !== id;\n    });\n\n    if (nu.length > 0) {\n      set$2(element, attr, nu.join(' '));\n    } else {\n      remove$7(element, attr);\n    }\n\n    return false;\n  };\n\n  var supports = function (element) {\n    return element.dom.classList !== undefined;\n  };\n\n  var get$5 = function (element) {\n    return read(element, 'class');\n  };\n\n  var add$1 = function (element, clazz) {\n    return add$2(element, 'class', clazz);\n  };\n\n  var remove$3 = function (element, clazz) {\n    return remove$4(element, 'class', clazz);\n  };\n\n  var add = function (element, clazz) {\n    if (supports(element)) {\n      element.dom.classList.add(clazz);\n    } else {\n      add$1(element, clazz);\n    }\n  };\n\n  var cleanClass = function (element) {\n    var classList = supports(element) ? element.dom.classList : get$5(element);\n\n    if (classList.length === 0) {\n      remove$7(element, 'class');\n    }\n  };\n\n  var remove$2 = function (element, clazz) {\n    if (supports(element)) {\n      var classList = element.dom.classList;\n      classList.remove(clazz);\n    } else {\n      remove$3(element, clazz);\n    }\n\n    cleanClass(element);\n  };\n\n  var has = function (element, clazz) {\n    return supports(element) && element.dom.classList.contains(clazz);\n  };\n\n  var css = function (namespace) {\n    var dashNamespace = namespace.replace(/\\./g, '-');\n\n    var resolve = function (str) {\n      return dashNamespace + '-' + str;\n    };\n\n    return {\n      resolve: resolve\n    };\n  };\n\n  var styles$1 = css('ephox-dragster');\n  var resolve$1 = styles$1.resolve;\n\n  var Blocker = function (options) {\n    var settings = __assign({\n      layerClass: resolve$1('blocker')\n    }, options);\n\n    var div = SugarElement.fromTag('div');\n    set$2(div, 'role', 'presentation');\n    setAll(div, {\n      position: 'fixed',\n      left: '0px',\n      top: '0px',\n      width: '100%',\n      height: '100%'\n    });\n    add(div, resolve$1('blocker'));\n    add(div, settings.layerClass);\n    var element = constant(div);\n\n    var destroy = function () {\n      remove$5(div);\n    };\n\n    return {\n      element: element,\n      destroy: destroy\n    };\n  };\n\n  var compare = function (old, nu) {\n    return SugarPosition(nu.left - old.left, nu.top - old.top);\n  };\n\n  var extract = function (event) {\n    return Optional.some(SugarPosition(event.x, event.y));\n  };\n\n  var mutate = function (mutation, info) {\n    mutation.mutate(info.left, info.top);\n  };\n\n  var sink = function (dragApi, settings) {\n    var blocker = Blocker(settings);\n    var mdown = bind(blocker.element(), 'mousedown', dragApi.forceDrop);\n    var mup = bind(blocker.element(), 'mouseup', dragApi.drop);\n    var mmove = bind(blocker.element(), 'mousemove', dragApi.move);\n    var mout = bind(blocker.element(), 'mouseout', dragApi.delayDrop);\n\n    var destroy = function () {\n      blocker.destroy();\n      mup.unbind();\n      mmove.unbind();\n      mout.unbind();\n      mdown.unbind();\n    };\n\n    var start = function (parent) {\n      append$1(parent, blocker.element());\n    };\n\n    var stop = function () {\n      remove$5(blocker.element());\n    };\n\n    return DragSink({\n      element: blocker.element,\n      start: start,\n      stop: stop,\n      destroy: destroy\n    });\n  };\n\n  var MouseDrag = DragMode({\n    compare: compare,\n    extract: extract,\n    sink: sink,\n    mutate: mutate\n  });\n\n  var transform$1 = function (mutation, settings) {\n    if (settings === void 0) {\n      settings = {};\n    }\n\n    var mode = settings.mode !== undefined ? settings.mode : MouseDrag;\n    return setup(mutation, mode, settings);\n  };\n\n  var closest = function (target) {\n    return closest$1(target, '[contenteditable]');\n  };\n\n  var isEditable$1 = function (element, assumeEditable) {\n    if (assumeEditable === void 0) {\n      assumeEditable = false;\n    }\n\n    if (!detect$3().browser.isIE() && inBody(element)) {\n      return element.dom.isContentEditable;\n    } else {\n      return closest(element).fold(constant(assumeEditable), function (editable) {\n        return getRaw(editable) === 'true';\n      });\n    }\n  };\n\n  var getRaw = function (element) {\n    return element.dom.contentEditable;\n  };\n\n  var styles = css('ephox-snooker');\n  var resolve = styles.resolve;\n\n  var Mutation = function () {\n    var events = create$4({\n      drag: Event(['xDelta', 'yDelta'])\n    });\n\n    var mutate = function (x, y) {\n      events.trigger.drag(x, y);\n    };\n\n    return {\n      mutate: mutate,\n      events: events.registry\n    };\n  };\n\n  var BarMutation = function () {\n    var events = create$4({\n      drag: Event(['xDelta', 'yDelta', 'target'])\n    });\n    var target = Optional.none();\n    var delegate = Mutation();\n    delegate.events.drag.bind(function (event) {\n      target.each(function (t) {\n        events.trigger.drag(event.xDelta, event.yDelta, t);\n      });\n    });\n\n    var assign = function (t) {\n      target = Optional.some(t);\n    };\n\n    var get = function () {\n      return target;\n    };\n\n    return {\n      assign: assign,\n      get: get,\n      mutate: delegate.mutate,\n      events: events.registry\n    };\n  };\n\n  var col = function (column, x, y, w, h) {\n    var bar = SugarElement.fromTag('div');\n    setAll(bar, {\n      position: 'absolute',\n      left: x - w / 2 + 'px',\n      top: y + 'px',\n      height: h + 'px',\n      width: w + 'px'\n    });\n    setAll$1(bar, {\n      'data-column': column,\n      'role': 'presentation'\n    });\n    return bar;\n  };\n\n  var row = function (r, x, y, w, h) {\n    var bar = SugarElement.fromTag('div');\n    setAll(bar, {\n      position: 'absolute',\n      left: x + 'px',\n      top: y - h / 2 + 'px',\n      height: h + 'px',\n      width: w + 'px'\n    });\n    setAll$1(bar, {\n      'data-row': r,\n      'role': 'presentation'\n    });\n    return bar;\n  };\n\n  var resizeBar = resolve('resizer-bar');\n  var resizeRowBar = resolve('resizer-rows');\n  var resizeColBar = resolve('resizer-cols');\n  var BAR_THICKNESS = 7;\n\n  var resizableRows = function (warehouse, isResizable) {\n    return bind$2(warehouse.all, function (row, i) {\n      return isResizable(row.element) ? [i] : [];\n    });\n  };\n\n  var resizableColumns = function (warehouse, isResizable) {\n    var resizableCols = [];\n    range$1(warehouse.grid.columns, function (index) {\n      var colElmOpt = Warehouse.getColumnAt(warehouse, index).map(function (col) {\n        return col.element;\n      });\n\n      if (colElmOpt.forall(isResizable)) {\n        resizableCols.push(index);\n      }\n    });\n    return filter$2(resizableCols, function (colIndex) {\n      var columnCells = Warehouse.filterItems(warehouse, function (cell) {\n        return cell.column === colIndex;\n      });\n      return forall(columnCells, function (cell) {\n        return isResizable(cell.element);\n      });\n    });\n  };\n\n  var destroy = function (wire) {\n    var previous = descendants(wire.parent(), '.' + resizeBar);\n    each$2(previous, remove$5);\n  };\n\n  var drawBar = function (wire, positions, create) {\n    var origin = wire.origin();\n    each$2(positions, function (cpOption) {\n      cpOption.each(function (cp) {\n        var bar = create(origin, cp);\n        add(bar, resizeBar);\n        append$1(wire.parent(), bar);\n      });\n    });\n  };\n\n  var refreshCol = function (wire, colPositions, position, tableHeight) {\n    drawBar(wire, colPositions, function (origin, cp) {\n      var colBar = col(cp.col, cp.x - origin.left, position.top - origin.top, BAR_THICKNESS, tableHeight);\n      add(colBar, resizeColBar);\n      return colBar;\n    });\n  };\n\n  var refreshRow = function (wire, rowPositions, position, tableWidth) {\n    drawBar(wire, rowPositions, function (origin, cp) {\n      var rowBar = row(cp.row, position.left - origin.left, cp.y - origin.top, tableWidth, BAR_THICKNESS);\n      add(rowBar, resizeRowBar);\n      return rowBar;\n    });\n  };\n\n  var refreshGrid = function (warhouse, wire, table, rows, cols) {\n    var position = absolute(table);\n    var isResizable = wire.isResizable;\n    var rowPositions = rows.length > 0 ? height.positions(rows, table) : [];\n    var resizableRowBars = rowPositions.length > 0 ? resizableRows(warhouse, isResizable) : [];\n    var resizableRowPositions = filter$2(rowPositions, function (_pos, i) {\n      return exists(resizableRowBars, function (barIndex) {\n        return i === barIndex;\n      });\n    });\n    refreshRow(wire, resizableRowPositions, position, getOuter$2(table));\n    var colPositions = cols.length > 0 ? width.positions(cols, table) : [];\n    var resizableColBars = colPositions.length > 0 ? resizableColumns(warhouse, isResizable) : [];\n    var resizableColPositions = filter$2(colPositions, function (_pos, i) {\n      return exists(resizableColBars, function (barIndex) {\n        return i === barIndex;\n      });\n    });\n    refreshCol(wire, resizableColPositions, position, getOuter$1(table));\n  };\n\n  var refresh = function (wire, table) {\n    destroy(wire);\n\n    if (wire.isResizable(table)) {\n      var warehouse = Warehouse.fromTable(table);\n      var rows$1 = rows(warehouse);\n      var cols = columns(warehouse);\n      refreshGrid(warehouse, wire, table, rows$1, cols);\n    }\n  };\n\n  var each = function (wire, f) {\n    var bars = descendants(wire.parent(), '.' + resizeBar);\n    each$2(bars, f);\n  };\n\n  var hide = function (wire) {\n    each(wire, function (bar) {\n      set$1(bar, 'display', 'none');\n    });\n  };\n\n  var show = function (wire) {\n    each(wire, function (bar) {\n      set$1(bar, 'display', 'block');\n    });\n  };\n\n  var isRowBar = function (element) {\n    return has(element, resizeRowBar);\n  };\n\n  var isColBar = function (element) {\n    return has(element, resizeColBar);\n  };\n\n  var resizeBarDragging = resolve('resizer-bar-dragging');\n\n  var BarManager = function (wire) {\n    var mutation = BarMutation();\n    var resizing = transform$1(mutation, {});\n    var hoverTable = Optional.none();\n\n    var getResizer = function (element, type) {\n      return Optional.from(get$b(element, type));\n    };\n\n    mutation.events.drag.bind(function (event) {\n      getResizer(event.target, 'data-row').each(function (_dataRow) {\n        var currentRow = getCssValue(event.target, 'top');\n        set$1(event.target, 'top', currentRow + event.yDelta + 'px');\n      });\n      getResizer(event.target, 'data-column').each(function (_dataCol) {\n        var currentCol = getCssValue(event.target, 'left');\n        set$1(event.target, 'left', currentCol + event.xDelta + 'px');\n      });\n    });\n\n    var getDelta = function (target, dir) {\n      var newX = getCssValue(target, dir);\n      var oldX = getAttrValue(target, 'data-initial-' + dir, 0);\n      return newX - oldX;\n    };\n\n    resizing.events.stop.bind(function () {\n      mutation.get().each(function (target) {\n        hoverTable.each(function (table) {\n          getResizer(target, 'data-row').each(function (row) {\n            var delta = getDelta(target, 'top');\n            remove$7(target, 'data-initial-top');\n            events.trigger.adjustHeight(table, delta, parseInt(row, 10));\n          });\n          getResizer(target, 'data-column').each(function (column) {\n            var delta = getDelta(target, 'left');\n            remove$7(target, 'data-initial-left');\n            events.trigger.adjustWidth(table, delta, parseInt(column, 10));\n          });\n          refresh(wire, table);\n        });\n      });\n    });\n\n    var handler = function (target, dir) {\n      events.trigger.startAdjust();\n      mutation.assign(target);\n      set$2(target, 'data-initial-' + dir, getCssValue(target, dir));\n      add(target, resizeBarDragging);\n      set$1(target, 'opacity', '0.2');\n      resizing.go(wire.parent());\n    };\n\n    var mousedown = bind(wire.parent(), 'mousedown', function (event) {\n      if (isRowBar(event.target)) {\n        handler(event.target, 'top');\n      }\n\n      if (isColBar(event.target)) {\n        handler(event.target, 'left');\n      }\n    });\n\n    var isRoot = function (e) {\n      return eq$1(e, wire.view());\n    };\n\n    var findClosestEditableTable = function (target) {\n      return closest$1(target, 'table', isRoot).filter(isEditable$1);\n    };\n\n    var mouseover = bind(wire.view(), 'mouseover', function (event) {\n      findClosestEditableTable(event.target).fold(function () {\n        if (inBody(event.target)) {\n          destroy(wire);\n        }\n      }, function (table) {\n        hoverTable = Optional.some(table);\n        refresh(wire, table);\n      });\n    });\n\n    var destroy$1 = function () {\n      mousedown.unbind();\n      mouseover.unbind();\n      resizing.destroy();\n      destroy(wire);\n    };\n\n    var refresh$1 = function (tbl) {\n      refresh(wire, tbl);\n    };\n\n    var events = create$4({\n      adjustHeight: Event(['table', 'delta', 'row']),\n      adjustWidth: Event(['table', 'delta', 'column']),\n      startAdjust: Event([])\n    });\n    return {\n      destroy: destroy$1,\n      refresh: refresh$1,\n      on: resizing.on,\n      off: resizing.off,\n      hideBars: curry(hide, wire),\n      showBars: curry(show, wire),\n      events: events.registry\n    };\n  };\n\n  var create$3 = function (wire, resizing, lazySizing) {\n    var hdirection = height;\n    var vdirection = width;\n    var manager = BarManager(wire);\n    var events = create$4({\n      beforeResize: Event(['table', 'type']),\n      afterResize: Event(['table', 'type']),\n      startDrag: Event([])\n    });\n    manager.events.adjustHeight.bind(function (event) {\n      var table = event.table;\n      events.trigger.beforeResize(table, 'row');\n      var delta = hdirection.delta(event.delta, table);\n      adjustHeight(table, delta, event.row, hdirection);\n      events.trigger.afterResize(table, 'row');\n    });\n    manager.events.startAdjust.bind(function (_event) {\n      events.trigger.startDrag();\n    });\n    manager.events.adjustWidth.bind(function (event) {\n      var table = event.table;\n      events.trigger.beforeResize(table, 'col');\n      var delta = vdirection.delta(event.delta, table);\n      var tableSize = lazySizing(table);\n      adjustWidth(table, delta, event.column, resizing, tableSize);\n      events.trigger.afterResize(table, 'col');\n    });\n    return {\n      on: manager.on,\n      off: manager.off,\n      hideBars: manager.hideBars,\n      showBars: manager.showBars,\n      destroy: manager.destroy,\n      events: events.registry\n    };\n  };\n\n  var TableResize = {\n    create: create$3\n  };\n\n  var fireNewRow = function (editor, row) {\n    return editor.fire('newrow', {\n      node: row\n    });\n  };\n\n  var fireNewCell = function (editor, cell) {\n    return editor.fire('newcell', {\n      node: cell\n    });\n  };\n\n  var fireObjectResizeStart = function (editor, target, width, height, origin) {\n    editor.fire('ObjectResizeStart', {\n      target: target,\n      width: width,\n      height: height,\n      origin: origin\n    });\n  };\n\n  var fireObjectResized = function (editor, target, width, height, origin) {\n    editor.fire('ObjectResized', {\n      target: target,\n      width: width,\n      height: height,\n      origin: origin\n    });\n  };\n\n  var fireTableSelectionChange = function (editor, cells, start, finish, otherCells) {\n    editor.fire('TableSelectionChange', {\n      cells: cells,\n      start: start,\n      finish: finish,\n      otherCells: otherCells\n    });\n  };\n\n  var fireTableSelectionClear = function (editor) {\n    editor.fire('TableSelectionClear');\n  };\n\n  var fireTableModified = function (editor, table, data) {\n    editor.fire('TableModified', __assign(__assign({}, data), {\n      table: table\n    }));\n  };\n\n  var styleModified = {\n    structure: false,\n    style: true\n  };\n  var structureModified = {\n    structure: true,\n    style: false\n  };\n  var styleAndStructureModified = {\n    structure: true,\n    style: true\n  };\n  var defaultTableToolbar = 'tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol';\n  var defaultStyles = {\n    'border-collapse': 'collapse',\n    'width': '100%'\n  };\n  var defaultCellBorderWidths = range$1(5, function (i) {\n    var size = i + 1 + 'px';\n    return {\n      title: size,\n      value: size\n    };\n  });\n  var defaultCellBorderStyles = map$1(['Solid', 'Dotted', 'Dashed', 'Double', 'Groove', 'Ridge', 'Inset', 'Outset', 'None', 'Hidden'], function (type) {\n    return {\n      title: type,\n      value: type.toLowerCase()\n    };\n  });\n\n  var determineDefaultStyles = function (editor) {\n    var _a;\n\n    if (isPixelsForced(editor)) {\n      var dom = editor.dom;\n      var parentBlock = (_a = dom.getParent(editor.selection.getStart(), dom.isBlock)) !== null && _a !== void 0 ? _a : editor.getBody();\n      var contentWidth = getInner(SugarElement.fromDom(parentBlock));\n      return __assign(__assign({}, defaultStyles), {\n        width: contentWidth + 'px'\n      });\n    } else if (isResponsiveForced(editor)) {\n      return filter$1(defaultStyles, function (_value, key) {\n        return key !== 'width';\n      });\n    } else {\n      return defaultStyles;\n    }\n  };\n\n  var defaultAttributes = {\n    border: '1'\n  };\n  var defaultColumnResizingBehaviour = 'preservetable';\n\n  var getTableSizingMode = function (editor) {\n    return editor.getParam('table_sizing_mode', 'auto');\n  };\n\n  var getTableResponseWidth = function (editor) {\n    return editor.getParam('table_responsive_width');\n  };\n\n  var getTableBorderWidths = function (editor) {\n    return editor.getParam('table_border_widths', defaultCellBorderWidths, 'array');\n  };\n\n  var getTableBorderStyles = function (editor) {\n    return editor.getParam('table_border_styles', defaultCellBorderStyles, 'array');\n  };\n\n  var getDefaultAttributes = function (editor) {\n    return editor.getParam('table_default_attributes', defaultAttributes, 'object');\n  };\n\n  var getDefaultStyles = function (editor) {\n    return editor.getParam('table_default_styles', determineDefaultStyles(editor), 'object');\n  };\n\n  var hasTableResizeBars = function (editor) {\n    return editor.getParam('table_resize_bars', true, 'boolean');\n  };\n\n  var hasTabNavigation = function (editor) {\n    return editor.getParam('table_tab_navigation', true, 'boolean');\n  };\n\n  var hasAdvancedCellTab = function (editor) {\n    return editor.getParam('table_cell_advtab', true, 'boolean');\n  };\n\n  var hasAdvancedRowTab = function (editor) {\n    return editor.getParam('table_row_advtab', true, 'boolean');\n  };\n\n  var hasAdvancedTableTab = function (editor) {\n    return editor.getParam('table_advtab', true, 'boolean');\n  };\n\n  var hasAppearanceOptions = function (editor) {\n    return editor.getParam('table_appearance_options', true, 'boolean');\n  };\n\n  var hasTableGrid = function (editor) {\n    return editor.getParam('table_grid', true, 'boolean');\n  };\n\n  var shouldStyleWithCss = function (editor) {\n    return editor.getParam('table_style_by_css', false, 'boolean');\n  };\n\n  var getCellClassList = function (editor) {\n    return editor.getParam('table_cell_class_list', [], 'array');\n  };\n\n  var getRowClassList = function (editor) {\n    return editor.getParam('table_row_class_list', [], 'array');\n  };\n\n  var getTableClassList = function (editor) {\n    return editor.getParam('table_class_list', [], 'array');\n  };\n\n  var isPercentagesForced = function (editor) {\n    return getTableSizingMode(editor) === 'relative' || getTableResponseWidth(editor) === true;\n  };\n\n  var isPixelsForced = function (editor) {\n    return getTableSizingMode(editor) === 'fixed' || getTableResponseWidth(editor) === false;\n  };\n\n  var isResponsiveForced = function (editor) {\n    return getTableSizingMode(editor) === 'responsive';\n  };\n\n  var getToolbar = function (editor) {\n    return editor.getParam('table_toolbar', defaultTableToolbar);\n  };\n\n  var useColumnGroup = function (editor) {\n    return editor.getParam('table_use_colgroups', false, 'boolean');\n  };\n\n  var getTableHeaderType = function (editor) {\n    var defaultValue = 'section';\n    var value = editor.getParam('table_header_type', defaultValue, 'string');\n    var validValues = ['section', 'cells', 'sectionCells', 'auto'];\n\n    if (!contains$2(validValues, value)) {\n      return defaultValue;\n    } else {\n      return value;\n    }\n  };\n\n  var getColumnResizingBehaviour = function (editor) {\n    var validModes = ['preservetable', 'resizetable'];\n    var givenMode = editor.getParam('table_column_resizing', defaultColumnResizingBehaviour, 'string');\n    return find$1(validModes, function (mode) {\n      return mode === givenMode;\n    }).getOr(defaultColumnResizingBehaviour);\n  };\n\n  var isPreserveTableColumnResizing = function (editor) {\n    return getColumnResizingBehaviour(editor) === 'preservetable';\n  };\n\n  var isResizeTableColumnResizing = function (editor) {\n    return getColumnResizingBehaviour(editor) === 'resizetable';\n  };\n\n  var getCloneElements = function (editor) {\n    var cloneElements = editor.getParam('table_clone_elements');\n\n    if (isString(cloneElements)) {\n      return Optional.some(cloneElements.split(/[ ,]/));\n    } else if (Array.isArray(cloneElements)) {\n      return Optional.some(cloneElements);\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var hasObjectResizing = function (editor) {\n    var objectResizing = editor.getParam('object_resizing', true);\n    return isString(objectResizing) ? objectResizing === 'table' : objectResizing;\n  };\n\n  var getTableBackgroundColorMap = function (editor) {\n    return editor.getParam('table_background_color_map', [], 'array');\n  };\n\n  var getTableBorderColorMap = function (editor) {\n    return editor.getParam('table_border_color_map', [], 'array');\n  };\n\n  var get$4 = function (editor, table) {\n    if (isPercentagesForced(editor)) {\n      return TableSize.percentageSize(table);\n    } else if (isPixelsForced(editor)) {\n      return TableSize.pixelSize(table);\n    } else {\n      return TableSize.getTableSize(table);\n    }\n  };\n\n  var cleanupLegacyAttributes = function (element) {\n    remove$7(element, 'width');\n  };\n\n  var convertToPercentSize = function (table) {\n    var newWidth = getPercentTableWidth(table);\n    redistribute(table, Optional.some(newWidth), Optional.none());\n    cleanupLegacyAttributes(table);\n  };\n\n  var convertToPixelSize = function (table) {\n    var newWidth = getPixelTableWidth(table);\n    redistribute(table, Optional.some(newWidth), Optional.none());\n    cleanupLegacyAttributes(table);\n  };\n\n  var convertToNoneSize = function (table) {\n    remove$6(table, 'width');\n    var columns = columns$1(table);\n    var rowElements = columns.length > 0 ? columns : cells$1(table);\n    each$2(rowElements, function (cell) {\n      remove$6(cell, 'width');\n      cleanupLegacyAttributes(cell);\n    });\n    cleanupLegacyAttributes(table);\n  };\n\n  var enforcePercentage = convertToPercentSize;\n  var enforcePixels = convertToPixelSize;\n  var enforceNone = convertToNoneSize;\n\n  var syncPixels = function (table) {\n    var warehouse = Warehouse.fromTable(table);\n\n    if (!Warehouse.hasColumns(warehouse)) {\n      each$2(cells$1(table), function (cell) {\n        var computedWidth = get$a(cell, 'width');\n        set$1(cell, 'width', computedWidth);\n        remove$7(cell, 'width');\n      });\n    }\n  };\n\n  var createContainer = function () {\n    var container = SugarElement.fromTag('div');\n    setAll(container, {\n      position: 'static',\n      height: '0',\n      width: '0',\n      padding: '0',\n      margin: '0',\n      border: '0'\n    });\n    append$1(body$1(), container);\n    return container;\n  };\n\n  var get$3 = function (editor, isResizable) {\n    return editor.inline ? ResizeWire.body(getBody(editor), createContainer(), isResizable) : ResizeWire.only(SugarElement.fromDom(editor.getDoc()), isResizable);\n  };\n\n  var remove$1 = function (editor, wire) {\n    if (editor.inline) {\n      remove$5(wire.parent());\n    }\n  };\n\n  var barResizerPrefix = 'bar-';\n\n  var isResizable = function (elm) {\n    return get$b(elm, 'data-mce-resize') !== 'false';\n  };\n\n  var getResizeHandler = function (editor) {\n    var selectionRng = Optional.none();\n    var resize = Optional.none();\n    var wire = Optional.none();\n    var startW;\n    var startRawW;\n\n    var isTable = function (elm) {\n      return elm.nodeName === 'TABLE';\n    };\n\n    var lazyResize = function () {\n      return resize;\n    };\n\n    var lazyWire = function () {\n      return wire.getOr(ResizeWire.only(SugarElement.fromDom(editor.getBody()), isResizable));\n    };\n\n    var lazySizing = function (table) {\n      return get$4(editor, table);\n    };\n\n    var lazyResizingBehaviour = function () {\n      return isPreserveTableColumnResizing(editor) ? preserveTable() : resizeTable();\n    };\n\n    var getNumColumns = function (table) {\n      return getGridSize(table).columns;\n    };\n\n    var afterCornerResize = function (table, origin, width) {\n      var isRightEdgeResize = endsWith(origin, 'e');\n\n      if (startRawW === '') {\n        enforcePercentage(table);\n      }\n\n      if (width !== startW && startRawW !== '') {\n        set$1(table, 'width', startRawW);\n        var resizing = lazyResizingBehaviour();\n        var tableSize = lazySizing(table);\n        var col = isPreserveTableColumnResizing(editor) || isRightEdgeResize ? getNumColumns(table) - 1 : 0;\n        adjustWidth(table, width - startW, col, resizing, tableSize);\n      } else if (isPercentage$1(startRawW)) {\n        var percentW = parseFloat(startRawW.replace('%', ''));\n        var targetPercentW = width * percentW / startW;\n        set$1(table, 'width', targetPercentW + '%');\n      }\n\n      if (isPixel(startRawW)) {\n        syncPixels(table);\n      }\n    };\n\n    var destroy = function () {\n      resize.each(function (sz) {\n        sz.destroy();\n      });\n      wire.each(function (w) {\n        remove$1(editor, w);\n      });\n    };\n\n    editor.on('init', function () {\n      var rawWire = get$3(editor, isResizable);\n      wire = Optional.some(rawWire);\n\n      if (hasObjectResizing(editor) && hasTableResizeBars(editor)) {\n        var resizing = lazyResizingBehaviour();\n        var sz = TableResize.create(rawWire, resizing, lazySizing);\n        sz.on();\n        sz.events.startDrag.bind(function (_event) {\n          selectionRng = Optional.some(editor.selection.getRng());\n        });\n        sz.events.beforeResize.bind(function (event) {\n          var rawTable = event.table.dom;\n          fireObjectResizeStart(editor, rawTable, getPixelWidth(rawTable), getPixelHeight(rawTable), barResizerPrefix + event.type);\n        });\n        sz.events.afterResize.bind(function (event) {\n          var table = event.table;\n          var rawTable = table.dom;\n          removeDataStyle(table);\n          selectionRng.each(function (rng) {\n            editor.selection.setRng(rng);\n            editor.focus();\n          });\n          fireObjectResized(editor, rawTable, getPixelWidth(rawTable), getPixelHeight(rawTable), barResizerPrefix + event.type);\n          editor.undoManager.add();\n        });\n        resize = Optional.some(sz);\n      }\n    });\n    editor.on('ObjectResizeStart', function (e) {\n      var targetElm = e.target;\n\n      if (isTable(targetElm)) {\n        var table = SugarElement.fromDom(targetElm);\n        each$2(editor.dom.select('.mce-clonedresizable'), function (clone) {\n          editor.dom.addClass(clone, 'mce-' + getColumnResizingBehaviour(editor) + '-columns');\n        });\n\n        if (!isPixelSizing(table) && isPixelsForced(editor)) {\n          enforcePixels(table);\n        } else if (!isPercentSizing(table) && isPercentagesForced(editor)) {\n          enforcePercentage(table);\n        }\n\n        if (isNoneSizing(table) && startsWith(e.origin, barResizerPrefix)) {\n          enforcePercentage(table);\n        }\n\n        startW = e.width;\n        startRawW = isResponsiveForced(editor) ? '' : getRawWidth(editor, targetElm).getOr('');\n      }\n    });\n    editor.on('ObjectResized', function (e) {\n      var targetElm = e.target;\n\n      if (isTable(targetElm)) {\n        var table = SugarElement.fromDom(targetElm);\n        var origin_1 = e.origin;\n\n        if (startsWith(origin_1, 'corner-')) {\n          afterCornerResize(table, origin_1, e.width);\n        }\n\n        removeDataStyle(table);\n        fireTableModified(editor, table.dom, styleModified);\n      }\n    });\n    editor.on('SwitchMode', function () {\n      lazyResize().each(function (resize) {\n        if (editor.mode.isReadOnly()) {\n          resize.hideBars();\n        } else {\n          resize.showBars();\n        }\n      });\n    });\n    return {\n      lazyResize: lazyResize,\n      lazyWire: lazyWire,\n      destroy: destroy\n    };\n  };\n\n  var point = function (element, offset) {\n    return {\n      element: element,\n      offset: offset\n    };\n  };\n\n  var scan$1 = function (universe, element, direction) {\n    if (universe.property().isText(element) && universe.property().getText(element).trim().length === 0 || universe.property().isComment(element)) {\n      return direction(element).bind(function (elem) {\n        return scan$1(universe, elem, direction).orThunk(function () {\n          return Optional.some(elem);\n        });\n      });\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var toEnd = function (universe, element) {\n    if (universe.property().isText(element)) {\n      return universe.property().getText(element).length;\n    }\n\n    var children = universe.property().children(element);\n    return children.length;\n  };\n\n  var freefallRtl$2 = function (universe, element) {\n    var candidate = scan$1(universe, element, universe.query().prevSibling).getOr(element);\n\n    if (universe.property().isText(candidate)) {\n      return point(candidate, toEnd(universe, candidate));\n    }\n\n    var children = universe.property().children(candidate);\n    return children.length > 0 ? freefallRtl$2(universe, children[children.length - 1]) : point(candidate, toEnd(universe, candidate));\n  };\n\n  var freefallRtl$1 = freefallRtl$2;\n  var universe$2 = DomUniverse();\n\n  var freefallRtl = function (element) {\n    return freefallRtl$1(universe$2, element);\n  };\n\n  var halve = function (main, other) {\n    var colspan = getSpan(main, 'colspan');\n\n    if (colspan === 1) {\n      var width = getGenericWidth(main);\n      width.each(function (w) {\n        var newWidth = w.value / 2;\n        setGenericWidth(main, newWidth, w.unit);\n        setGenericWidth(other, newWidth, w.unit);\n      });\n    }\n  };\n\n  var isHeaderCell = isTag('th');\n\n  var isHeaderCells = function (cells) {\n    return forall(cells, function (cell) {\n      return isHeaderCell(cell.element);\n    });\n  };\n\n  var getRowHeaderType = function (isHeaderRow, isHeaderCells) {\n    if (isHeaderRow && isHeaderCells) {\n      return 'sectionCells';\n    } else if (isHeaderRow) {\n      return 'section';\n    } else {\n      return 'cells';\n    }\n  };\n\n  var getRowType$1 = function (row) {\n    var isHeaderRow = row.section === 'thead';\n    var isHeaderCells = is(findCommonCellType(row.cells), 'th');\n\n    if (isHeaderRow || isHeaderCells) {\n      return {\n        type: 'header',\n        subType: getRowHeaderType(isHeaderRow, isHeaderCells)\n      };\n    } else if (row.section === 'tfoot') {\n      return {\n        type: 'footer'\n      };\n    } else {\n      return {\n        type: 'body'\n      };\n    }\n  };\n\n  var findCommonCellType = function (cells) {\n    var headerCells = filter$2(cells, function (cell) {\n      return isHeaderCell(cell.element);\n    });\n\n    if (headerCells.length === 0) {\n      return Optional.some('td');\n    } else if (headerCells.length === cells.length) {\n      return Optional.some('th');\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var findCommonRowType = function (rows) {\n    var rowTypes = map$1(rows, function (row) {\n      return getRowType$1(row).type;\n    });\n    var hasHeader = contains$2(rowTypes, 'header');\n    var hasFooter = contains$2(rowTypes, 'footer');\n\n    if (!hasHeader && !hasFooter) {\n      return Optional.some('body');\n    } else {\n      var hasBody = contains$2(rowTypes, 'body');\n\n      if (hasHeader && !hasBody && !hasFooter) {\n        return Optional.some('header');\n      } else if (!hasHeader && !hasBody && hasFooter) {\n        return Optional.some('footer');\n      } else {\n        return Optional.none();\n      }\n    }\n  };\n\n  var findTableRowHeaderType = function (warehouse) {\n    return findMap(warehouse.all, function (row) {\n      var rowType = getRowType$1(row);\n      return rowType.type === 'header' ? Optional.from(rowType.subType) : Optional.none();\n    });\n  };\n\n  var transformCell = function (cell, comparator, substitution) {\n    return elementnew(substitution(cell.element, comparator), true, cell.isLocked);\n  };\n\n  var transformRow = function (row, section) {\n    return row.section !== section ? rowcells(row.element, row.cells, section, row.isNew) : row;\n  };\n\n  var section = function () {\n    return {\n      transformRow: transformRow,\n      transformCell: function (cell, comparator, substitution) {\n        var newCell = substitution(cell.element, comparator);\n        var fixedCell = name(newCell) !== 'td' ? mutate$1(newCell, 'td') : newCell;\n        return elementnew(fixedCell, cell.isNew, cell.isLocked);\n      }\n    };\n  };\n\n  var sectionCells = function () {\n    return {\n      transformRow: transformRow,\n      transformCell: transformCell\n    };\n  };\n\n  var cells = function () {\n    return {\n      transformRow: function (row, section) {\n        var newSection = section === 'thead' ? 'tbody' : section;\n        return transformRow(row, newSection);\n      },\n      transformCell: transformCell\n    };\n  };\n\n  var fallback = function () {\n    return {\n      transformRow: identity,\n      transformCell: transformCell\n    };\n  };\n\n  var getTableSectionType = function (table, fallback) {\n    var warehouse = Warehouse.fromTable(table);\n    var type = findTableRowHeaderType(warehouse).getOr(fallback);\n\n    switch (type) {\n      case 'section':\n        return section();\n\n      case 'sectionCells':\n        return sectionCells();\n\n      case 'cells':\n        return cells();\n    }\n  };\n\n  var TableSection = {\n    getTableSectionType: getTableSectionType,\n    section: section,\n    sectionCells: sectionCells,\n    cells: cells,\n    fallback: fallback\n  };\n\n  var setIfNot = function (element, property, value, ignore) {\n    if (value === ignore) {\n      remove$7(element, property);\n    } else {\n      set$2(element, property, value);\n    }\n  };\n\n  var insert$1 = function (table, selector, element) {\n    last$2(children$1(table, selector)).fold(function () {\n      return prepend(table, element);\n    }, function (child) {\n      return after$5(child, element);\n    });\n  };\n\n  var generateSection = function (table, sectionName) {\n    var section = child$1(table, sectionName).getOrThunk(function () {\n      var newSection = SugarElement.fromTag(sectionName, owner(table).dom);\n\n      if (sectionName === 'thead') {\n        insert$1(table, 'caption,colgroup', newSection);\n      } else if (sectionName === 'colgroup') {\n        insert$1(table, 'caption', newSection);\n      } else {\n        append$1(table, newSection);\n      }\n\n      return newSection;\n    });\n    empty(section);\n    return section;\n  };\n\n  var render$1 = function (table, grid) {\n    var newRows = [];\n    var newCells = [];\n\n    var syncRows = function (gridSection) {\n      return map$1(gridSection, function (row) {\n        if (row.isNew) {\n          newRows.push(row.element);\n        }\n\n        var tr = row.element;\n        empty(tr);\n        each$2(row.cells, function (cell) {\n          if (cell.isNew) {\n            newCells.push(cell.element);\n          }\n\n          setIfNot(cell.element, 'colspan', cell.colspan, 1);\n          setIfNot(cell.element, 'rowspan', cell.rowspan, 1);\n          append$1(tr, cell.element);\n        });\n        return tr;\n      });\n    };\n\n    var syncColGroup = function (gridSection) {\n      return bind$2(gridSection, function (colGroup) {\n        return map$1(colGroup.cells, function (col) {\n          setIfNot(col.element, 'span', col.colspan, 1);\n          return col.element;\n        });\n      });\n    };\n\n    var renderSection = function (gridSection, sectionName) {\n      var section = generateSection(table, sectionName);\n      var sync = sectionName === 'colgroup' ? syncColGroup : syncRows;\n      var sectionElems = sync(gridSection);\n      append(section, sectionElems);\n    };\n\n    var removeSection = function (sectionName) {\n      child$1(table, sectionName).each(remove$5);\n    };\n\n    var renderOrRemoveSection = function (gridSection, sectionName) {\n      if (gridSection.length > 0) {\n        renderSection(gridSection, sectionName);\n      } else {\n        removeSection(sectionName);\n      }\n    };\n\n    var headSection = [];\n    var bodySection = [];\n    var footSection = [];\n    var columnGroupsSection = [];\n    each$2(grid, function (row) {\n      switch (row.section) {\n        case 'thead':\n          headSection.push(row);\n          break;\n\n        case 'tbody':\n          bodySection.push(row);\n          break;\n\n        case 'tfoot':\n          footSection.push(row);\n          break;\n\n        case 'colgroup':\n          columnGroupsSection.push(row);\n          break;\n      }\n    });\n    renderOrRemoveSection(columnGroupsSection, 'colgroup');\n    renderOrRemoveSection(headSection, 'thead');\n    renderOrRemoveSection(bodySection, 'tbody');\n    renderOrRemoveSection(footSection, 'tfoot');\n    return {\n      newRows: newRows,\n      newCells: newCells\n    };\n  };\n\n  var copy = function (grid) {\n    return map$1(grid, function (row) {\n      var tr = shallow(row.element);\n      each$2(row.cells, function (cell) {\n        var clonedCell = deep(cell.element);\n        setIfNot(clonedCell, 'colspan', cell.colspan, 1);\n        setIfNot(clonedCell, 'rowspan', cell.rowspan, 1);\n        append$1(tr, clonedCell);\n      });\n      return tr;\n    });\n  };\n\n  var getColumn = function (grid, index) {\n    return map$1(grid, function (row) {\n      return getCell(row, index);\n    });\n  };\n\n  var getRow = function (grid, index) {\n    return grid[index];\n  };\n\n  var findDiff = function (xs, comp) {\n    if (xs.length === 0) {\n      return 0;\n    }\n\n    var first = xs[0];\n    var index = findIndex(xs, function (x) {\n      return !comp(first.element, x.element);\n    });\n    return index.getOr(xs.length);\n  };\n\n  var subgrid = function (grid, row, column, comparator) {\n    var gridRow = getRow(grid, row);\n    var isColRow = gridRow.section === 'colgroup';\n    var colspan = findDiff(gridRow.cells.slice(column), comparator);\n    var rowspan = isColRow ? 1 : findDiff(getColumn(grid.slice(row), column), comparator);\n    return {\n      colspan: colspan,\n      rowspan: rowspan\n    };\n  };\n\n  var toDetails = function (grid, comparator) {\n    var seen = map$1(grid, function (row) {\n      return map$1(row.cells, never);\n    });\n\n    var updateSeen = function (rowIndex, columnIndex, rowspan, colspan) {\n      for (var row = rowIndex; row < rowIndex + rowspan; row++) {\n        for (var column = columnIndex; column < columnIndex + colspan; column++) {\n          seen[row][column] = true;\n        }\n      }\n    };\n\n    return map$1(grid, function (row, rowIndex) {\n      var details = bind$2(row.cells, function (cell, columnIndex) {\n        if (seen[rowIndex][columnIndex] === false) {\n          var result = subgrid(grid, rowIndex, columnIndex, comparator);\n          updateSeen(rowIndex, columnIndex, result.rowspan, result.colspan);\n          return [detailnew(cell.element, result.rowspan, result.colspan, cell.isNew)];\n        } else {\n          return [];\n        }\n      });\n      return rowdetailnew(row.element, details, row.section, row.isNew);\n    });\n  };\n\n  var toGrid = function (warehouse, generators, isNew) {\n    var grid = [];\n    each$2(warehouse.colgroups, function (colgroup) {\n      var colgroupCols = [];\n\n      for (var columnIndex = 0; columnIndex < warehouse.grid.columns; columnIndex++) {\n        var element = Warehouse.getColumnAt(warehouse, columnIndex).map(function (column) {\n          return elementnew(column.element, isNew, false);\n        }).getOrThunk(function () {\n          return elementnew(generators.colGap(), true, false);\n        });\n        colgroupCols.push(element);\n      }\n\n      grid.push(rowcells(colgroup.element, colgroupCols, 'colgroup', isNew));\n    });\n\n    for (var rowIndex = 0; rowIndex < warehouse.grid.rows; rowIndex++) {\n      var rowCells = [];\n\n      for (var columnIndex = 0; columnIndex < warehouse.grid.columns; columnIndex++) {\n        var element = Warehouse.getAt(warehouse, rowIndex, columnIndex).map(function (item) {\n          return elementnew(item.element, isNew, item.isLocked);\n        }).getOrThunk(function () {\n          return elementnew(generators.gap(), true, false);\n        });\n        rowCells.push(element);\n      }\n\n      var rowDetail = warehouse.all[rowIndex];\n      var row = rowcells(rowDetail.element, rowCells, rowDetail.section, isNew);\n      grid.push(row);\n    }\n\n    return grid;\n  };\n\n  var fromWarehouse = function (warehouse, generators) {\n    return toGrid(warehouse, generators, false);\n  };\n\n  var toDetailList = function (grid) {\n    return toDetails(grid, eq$1);\n  };\n\n  var findInWarehouse = function (warehouse, element) {\n    return findMap(warehouse.all, function (r) {\n      return find$1(r.cells, function (e) {\n        return eq$1(element, e.element);\n      });\n    });\n  };\n\n  var extractCells = function (warehouse, target, predicate) {\n    var details = map$1(target.selection, function (cell$1) {\n      return cell(cell$1).bind(function (lc) {\n        return findInWarehouse(warehouse, lc);\n      }).filter(predicate);\n    });\n    var cells = cat(details);\n    return someIf(cells.length > 0, cells);\n  };\n\n  var run = function (operation, extract, adjustment, postAction, genWrappers) {\n    return function (wire, table, target, generators, behaviours) {\n      var warehouse = Warehouse.fromTable(table);\n      var tableSection = Optional.from(behaviours === null || behaviours === void 0 ? void 0 : behaviours.section).getOrThunk(TableSection.fallback);\n      var output = extract(warehouse, target).map(function (info) {\n        var model = fromWarehouse(warehouse, generators);\n        var result = operation(model, info, eq$1, genWrappers(generators), tableSection);\n        var lockedColumns = getLockedColumnsFromGrid(result.grid);\n        var grid = toDetailList(result.grid);\n        return {\n          info: info,\n          grid: grid,\n          cursor: result.cursor,\n          lockedColumns: lockedColumns\n        };\n      });\n      return output.bind(function (out) {\n        var newElements = render$1(table, out.grid);\n        var tableSizing = Optional.from(behaviours === null || behaviours === void 0 ? void 0 : behaviours.sizing).getOrThunk(function () {\n          return TableSize.getTableSize(table);\n        });\n        var resizing = Optional.from(behaviours === null || behaviours === void 0 ? void 0 : behaviours.resize).getOrThunk(preserveTable);\n        adjustment(table, out.grid, out.info, {\n          sizing: tableSizing,\n          resize: resizing,\n          section: tableSection\n        });\n        postAction(table);\n        refresh(wire, table);\n        remove$7(table, LOCKED_COL_ATTR);\n\n        if (out.lockedColumns.length > 0) {\n          set$2(table, LOCKED_COL_ATTR, out.lockedColumns.join(','));\n        }\n\n        return Optional.some({\n          cursor: out.cursor,\n          newRows: newElements.newRows,\n          newCells: newElements.newCells\n        });\n      });\n    };\n  };\n\n  var onPaste = function (warehouse, target) {\n    return cell(target.element).bind(function (cell) {\n      return findInWarehouse(warehouse, cell).map(function (details) {\n        var value = __assign(__assign({}, details), {\n          generators: target.generators,\n          clipboard: target.clipboard\n        });\n\n        return value;\n      });\n    });\n  };\n\n  var onPasteByEditor = function (warehouse, target) {\n    return extractCells(warehouse, target, always).map(function (cells) {\n      return {\n        cells: cells,\n        generators: target.generators,\n        clipboard: target.clipboard\n      };\n    });\n  };\n\n  var onMergable = function (_warehouse, target) {\n    return target.mergable;\n  };\n\n  var onUnmergable = function (_warehouse, target) {\n    return target.unmergable;\n  };\n\n  var onCells = function (warehouse, target) {\n    return extractCells(warehouse, target, always);\n  };\n\n  var onUnlockedCells = function (warehouse, target) {\n    return extractCells(warehouse, target, function (detail) {\n      return !detail.isLocked;\n    });\n  };\n\n  var isUnlockedTableCell = function (warehouse, cell) {\n    return findInWarehouse(warehouse, cell).exists(function (detail) {\n      return !detail.isLocked;\n    });\n  };\n\n  var allUnlocked = function (warehouse, cells) {\n    return forall(cells, function (cell) {\n      return isUnlockedTableCell(warehouse, cell);\n    });\n  };\n\n  var onUnlockedMergable = function (warehouse, target) {\n    return onMergable(warehouse, target).filter(function (mergeable) {\n      return allUnlocked(warehouse, mergeable.cells);\n    });\n  };\n\n  var onUnlockedUnmergable = function (warehouse, target) {\n    return onUnmergable(warehouse, target).filter(function (cells) {\n      return allUnlocked(warehouse, cells);\n    });\n  };\n\n  var merge$2 = function (grid, bounds, comparator, substitution) {\n    var rows = extractGridDetails(grid).rows;\n\n    if (rows.length === 0) {\n      return grid;\n    }\n\n    for (var i = bounds.startRow; i <= bounds.finishRow; i++) {\n      for (var j = bounds.startCol; j <= bounds.finishCol; j++) {\n        var row = rows[i];\n        var isLocked = getCell(row, j).isLocked;\n        mutateCell(row, j, elementnew(substitution(), false, isLocked));\n      }\n    }\n\n    return grid;\n  };\n\n  var unmerge = function (grid, target, comparator, substitution) {\n    var rows = extractGridDetails(grid).rows;\n    var first = true;\n\n    for (var i = 0; i < rows.length; i++) {\n      for (var j = 0; j < cellLength(rows[0]); j++) {\n        var row = rows[i];\n        var currentCell = getCell(row, j);\n        var currentCellElm = currentCell.element;\n        var isToReplace = comparator(currentCellElm, target);\n\n        if (isToReplace === true && first === false) {\n          mutateCell(row, j, elementnew(substitution(), true, currentCell.isLocked));\n        } else if (isToReplace === true) {\n          first = false;\n        }\n      }\n    }\n\n    return grid;\n  };\n\n  var uniqueCells = function (row, comparator) {\n    return foldl(row, function (rest, cell) {\n      return exists(rest, function (currentCell) {\n        return comparator(currentCell.element, cell.element);\n      }) ? rest : rest.concat([cell]);\n    }, []);\n  };\n\n  var splitCols = function (grid, index, comparator, substitution) {\n    if (index > 0 && index < grid[0].cells.length) {\n      each$2(grid, function (row) {\n        var prevCell = row.cells[index - 1];\n        var current = row.cells[index];\n        var isToReplace = comparator(current.element, prevCell.element);\n\n        if (isToReplace) {\n          mutateCell(row, index, elementnew(substitution(), true, current.isLocked));\n        }\n      });\n    }\n\n    return grid;\n  };\n\n  var splitRows = function (grid, index, comparator, substitution) {\n    var rows = extractGridDetails(grid).rows;\n\n    if (index > 0 && index < rows.length) {\n      var rowPrevCells = rows[index - 1].cells;\n      var cells = uniqueCells(rowPrevCells, comparator);\n      each$2(cells, function (cell) {\n        var replacement = Optional.none();\n\n        for (var i = index; i < rows.length; i++) {\n          var _loop_1 = function (j) {\n            var row = rows[i];\n            var current = getCell(row, j);\n            var isToReplace = comparator(current.element, cell.element);\n\n            if (isToReplace) {\n              if (replacement.isNone()) {\n                replacement = Optional.some(substitution());\n              }\n\n              replacement.each(function (sub) {\n                mutateCell(row, j, elementnew(sub, true, current.isLocked));\n              });\n            }\n          };\n\n          for (var j = 0; j < cellLength(rows[0]); j++) {\n            _loop_1(j);\n          }\n        }\n      });\n    }\n\n    return grid;\n  };\n\n  var value$1 = function (o) {\n    var or = function (_opt) {\n      return value$1(o);\n    };\n\n    var orThunk = function (_f) {\n      return value$1(o);\n    };\n\n    var map = function (f) {\n      return value$1(f(o));\n    };\n\n    var mapError = function (_f) {\n      return value$1(o);\n    };\n\n    var each = function (f) {\n      f(o);\n    };\n\n    var bind = function (f) {\n      return f(o);\n    };\n\n    var fold = function (_, onValue) {\n      return onValue(o);\n    };\n\n    var exists = function (f) {\n      return f(o);\n    };\n\n    var forall = function (f) {\n      return f(o);\n    };\n\n    var toOptional = function () {\n      return Optional.some(o);\n    };\n\n    return {\n      isValue: always,\n      isError: never,\n      getOr: constant(o),\n      getOrThunk: constant(o),\n      getOrDie: constant(o),\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: each,\n      bind: bind,\n      exists: exists,\n      forall: forall,\n      toOptional: toOptional\n    };\n  };\n\n  var error = function (message) {\n    var getOrThunk = function (f) {\n      return f();\n    };\n\n    var getOrDie = function () {\n      return die(String(message))();\n    };\n\n    var or = identity;\n\n    var orThunk = function (f) {\n      return f();\n    };\n\n    var map = function (_f) {\n      return error(message);\n    };\n\n    var mapError = function (f) {\n      return error(f(message));\n    };\n\n    var bind = function (_f) {\n      return error(message);\n    };\n\n    var fold = function (onError, _) {\n      return onError(message);\n    };\n\n    return {\n      isValue: never,\n      isError: always,\n      getOr: identity,\n      getOrThunk: getOrThunk,\n      getOrDie: getOrDie,\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: noop,\n      bind: bind,\n      exists: never,\n      forall: always,\n      toOptional: Optional.none\n    };\n  };\n\n  var fromOption = function (opt, err) {\n    return opt.fold(function () {\n      return error(err);\n    }, value$1);\n  };\n\n  var Result = {\n    value: value$1,\n    error: error,\n    fromOption: fromOption\n  };\n\n  var measure = function (startAddress, gridA, gridB) {\n    if (startAddress.row >= gridA.length || startAddress.column > cellLength(gridA[0])) {\n      return Result.error('invalid start address out of table bounds, row: ' + startAddress.row + ', column: ' + startAddress.column);\n    }\n\n    var rowRemainder = gridA.slice(startAddress.row);\n    var colRemainder = rowRemainder[0].cells.slice(startAddress.column);\n    var colRequired = cellLength(gridB[0]);\n    var rowRequired = gridB.length;\n    return Result.value({\n      rowDelta: rowRemainder.length - rowRequired,\n      colDelta: colRemainder.length - colRequired\n    });\n  };\n\n  var measureWidth = function (gridA, gridB) {\n    var colLengthA = cellLength(gridA[0]);\n    var colLengthB = cellLength(gridB[0]);\n    return {\n      rowDelta: 0,\n      colDelta: colLengthA - colLengthB\n    };\n  };\n\n  var measureHeight = function (gridA, gridB) {\n    var rowLengthA = gridA.length;\n    var rowLengthB = gridB.length;\n    return {\n      rowDelta: rowLengthA - rowLengthB,\n      colDelta: 0\n    };\n  };\n\n  var generateElements = function (amount, row, generators, isLocked) {\n    var generator = row.section === 'colgroup' ? generators.col : generators.cell;\n    return range$1(amount, function (idx) {\n      return elementnew(generator(), true, isLocked(idx));\n    });\n  };\n\n  var rowFill = function (grid, amount, generators, lockedColumns) {\n    var exampleRow = grid[grid.length - 1];\n    return grid.concat(range$1(amount, function () {\n      var generator = exampleRow.section === 'colgroup' ? generators.colgroup : generators.row;\n      var row = clone$1(exampleRow, generator, identity);\n      var elements = generateElements(row.cells.length, row, generators, function (idx) {\n        return has$1(lockedColumns, idx.toString());\n      });\n      return setCells(row, elements);\n    }));\n  };\n\n  var colFill = function (grid, amount, generators, startIndex) {\n    return map$1(grid, function (row) {\n      var newChildren = generateElements(amount, row, generators, never);\n      return addCells(row, startIndex, newChildren);\n    });\n  };\n\n  var lockedColFill = function (grid, generators, lockedColumns) {\n    return map$1(grid, function (row) {\n      return foldl(lockedColumns, function (acc, colNum) {\n        var newChild = generateElements(1, row, generators, always)[0];\n        return addCell(acc, colNum, newChild);\n      }, row);\n    });\n  };\n\n  var tailor = function (gridA, delta, generators) {\n    var fillCols = delta.colDelta < 0 ? colFill : identity;\n    var fillRows = delta.rowDelta < 0 ? rowFill : identity;\n    var lockedColumns = getLockedColumnsFromGrid(gridA);\n    var gridWidth = cellLength(gridA[0]);\n    var isLastColLocked = exists(lockedColumns, function (locked) {\n      return locked === gridWidth - 1;\n    });\n    var modifiedCols = fillCols(gridA, Math.abs(delta.colDelta), generators, isLastColLocked ? gridWidth - 1 : gridWidth);\n    var newLockedColumns = getLockedColumnsFromGrid(modifiedCols);\n    return fillRows(modifiedCols, Math.abs(delta.rowDelta), generators, mapToObject(newLockedColumns, always));\n  };\n\n  var isSpanning = function (grid, row, col, comparator) {\n    var candidate = getCell(grid[row], col);\n    var matching = curry(comparator, candidate.element);\n    var currentRow = grid[row];\n    return grid.length > 1 && cellLength(currentRow) > 1 && (col > 0 && matching(getCellElement(currentRow, col - 1)) || col < currentRow.cells.length - 1 && matching(getCellElement(currentRow, col + 1)) || row > 0 && matching(getCellElement(grid[row - 1], col)) || row < grid.length - 1 && matching(getCellElement(grid[row + 1], col)));\n  };\n\n  var mergeTables = function (startAddress, gridA, gridB, generator, comparator, lockedColumns) {\n    var startRow = startAddress.row;\n    var startCol = startAddress.column;\n    var mergeHeight = gridB.length;\n    var mergeWidth = cellLength(gridB[0]);\n    var endRow = startRow + mergeHeight;\n    var endCol = startCol + mergeWidth + lockedColumns.length;\n    var lockedColumnObj = mapToObject(lockedColumns, always);\n\n    for (var r = startRow; r < endRow; r++) {\n      var skippedCol = 0;\n\n      for (var c = startCol; c < endCol; c++) {\n        if (lockedColumnObj[c]) {\n          skippedCol++;\n          continue;\n        }\n\n        if (isSpanning(gridA, r, c, comparator)) {\n          unmerge(gridA, getCellElement(gridA[r], c), comparator, generator.cell);\n        }\n\n        var gridBColIndex = c - startCol - skippedCol;\n        var newCell = getCell(gridB[r - startRow], gridBColIndex);\n        var newCellElm = newCell.element;\n        var replacement = generator.replace(newCellElm);\n        mutateCell(gridA[r], c, elementnew(replacement, true, newCell.isLocked));\n      }\n    }\n\n    return gridA;\n  };\n\n  var getValidStartAddress = function (currentStartAddress, grid, lockedColumns) {\n    var gridColLength = cellLength(grid[0]);\n    var adjustedRowAddress = extractGridDetails(grid).cols.length + currentStartAddress.row;\n    var possibleColAddresses = range$1(gridColLength - currentStartAddress.column, function (num) {\n      return num + currentStartAddress.column;\n    });\n    var validColAddress = find$1(possibleColAddresses, function (num) {\n      return forall(lockedColumns, function (col) {\n        return col !== num;\n      });\n    }).getOr(gridColLength - 1);\n    return {\n      row: adjustedRowAddress,\n      column: validColAddress\n    };\n  };\n\n  var getLockedColumnsWithinBounds = function (startAddress, grid, lockedColumns) {\n    return filter$2(lockedColumns, function (colNum) {\n      return colNum >= startAddress.column && colNum <= cellLength(grid[0]) + startAddress.column;\n    });\n  };\n\n  var merge$1 = function (startAddress, gridA, gridB, generator, comparator) {\n    var lockedColumns = getLockedColumnsFromGrid(gridA);\n    var validStartAddress = getValidStartAddress(startAddress, gridA, lockedColumns);\n    var gridBRows = extractGridDetails(gridB).rows;\n    var lockedColumnsWithinBounds = getLockedColumnsWithinBounds(validStartAddress, gridBRows, lockedColumns);\n    var result = measure(validStartAddress, gridA, gridBRows);\n    return result.map(function (diff) {\n      var delta = __assign(__assign({}, diff), {\n        colDelta: diff.colDelta - lockedColumnsWithinBounds.length\n      });\n\n      var fittedGrid = tailor(gridA, delta, generator);\n      var newLockedColumns = getLockedColumnsFromGrid(fittedGrid);\n      var newLockedColumnsWithinBounds = getLockedColumnsWithinBounds(validStartAddress, gridBRows, newLockedColumns);\n      return mergeTables(validStartAddress, fittedGrid, gridBRows, generator, comparator, newLockedColumnsWithinBounds);\n    });\n  };\n\n  var insertCols = function (index, gridA, gridB, generator, comparator) {\n    splitCols(gridA, index, comparator, generator.cell);\n    var delta = measureHeight(gridB, gridA);\n    var fittedNewGrid = tailor(gridB, delta, generator);\n    var secondDelta = measureHeight(gridA, fittedNewGrid);\n    var fittedOldGrid = tailor(gridA, secondDelta, generator);\n    return map$1(fittedOldGrid, function (gridRow, i) {\n      return addCells(gridRow, index, fittedNewGrid[i].cells);\n    });\n  };\n\n  var insertRows = function (index, gridA, gridB, generator, comparator) {\n    splitRows(gridA, index, comparator, generator.cell);\n    var locked = getLockedColumnsFromGrid(gridA);\n    var diff = measureWidth(gridA, gridB);\n\n    var delta = __assign(__assign({}, diff), {\n      colDelta: diff.colDelta - locked.length\n    });\n\n    var fittedOldGrid = tailor(gridA, delta, generator);\n\n    var _a = extractGridDetails(fittedOldGrid),\n        oldCols = _a.cols,\n        oldRows = _a.rows;\n\n    var newLocked = getLockedColumnsFromGrid(fittedOldGrid);\n    var secondDiff = measureWidth(gridB, gridA);\n\n    var secondDelta = __assign(__assign({}, secondDiff), {\n      colDelta: secondDiff.colDelta + newLocked.length\n    });\n\n    var fittedGridB = lockedColFill(gridB, generator, newLocked);\n    var fittedNewGrid = tailor(fittedGridB, secondDelta, generator);\n    return oldCols.concat(oldRows.slice(0, index)).concat(fittedNewGrid).concat(oldRows.slice(index, oldRows.length));\n  };\n\n  var cloneRow = function (row, cloneCell, comparator, substitution) {\n    return clone$1(row, function (elem) {\n      return substitution(elem, comparator);\n    }, cloneCell);\n  };\n\n  var insertRowAt = function (grid, index, example, comparator, substitution) {\n    var _a = extractGridDetails(grid),\n        rows = _a.rows,\n        cols = _a.cols;\n\n    var before = rows.slice(0, index);\n    var after = rows.slice(index);\n    var newRow = cloneRow(rows[example], function (ex, c) {\n      var withinSpan = index > 0 && index < rows.length && comparator(getCellElement(rows[index - 1], c), getCellElement(rows[index], c));\n      var ret = withinSpan ? getCell(rows[index], c) : elementnew(substitution(ex.element, comparator), true, ex.isLocked);\n      return ret;\n    }, comparator, substitution);\n    return cols.concat(before).concat([newRow]).concat(after);\n  };\n\n  var getElementFor = function (row, column, section, withinSpan, example, comparator, substitution) {\n    if (section === 'colgroup' || !withinSpan) {\n      var cell = getCell(row, example);\n      return elementnew(substitution(cell.element, comparator), true, false);\n    } else {\n      return getCell(row, column);\n    }\n  };\n\n  var insertColumnAt = function (grid, index, example, comparator, substitution) {\n    return map$1(grid, function (row) {\n      var withinSpan = index > 0 && index < cellLength(row) && comparator(getCellElement(row, index - 1), getCellElement(row, index));\n      var sub = getElementFor(row, index, row.section, withinSpan, example, comparator, substitution);\n      return addCell(row, index, sub);\n    });\n  };\n\n  var deleteColumnsAt = function (grid, columns) {\n    return bind$2(grid, function (row) {\n      var existingCells = row.cells;\n      var cells = foldr(columns, function (acc, column) {\n        return column >= 0 && column < acc.length ? acc.slice(0, column).concat(acc.slice(column + 1)) : acc;\n      }, existingCells);\n      return cells.length > 0 ? [rowcells(row.element, cells, row.section, row.isNew)] : [];\n    });\n  };\n\n  var deleteRowsAt = function (grid, start, finish) {\n    var _a = extractGridDetails(grid),\n        rows = _a.rows,\n        cols = _a.cols;\n\n    return cols.concat(rows.slice(0, start)).concat(rows.slice(finish + 1));\n  };\n\n  var notInStartRow = function (grid, rowIndex, colIndex, comparator) {\n    return getCellElement(grid[rowIndex], colIndex) !== undefined && rowIndex > 0 && comparator(getCellElement(grid[rowIndex - 1], colIndex), getCellElement(grid[rowIndex], colIndex));\n  };\n\n  var notInStartColumn = function (row, index, comparator) {\n    return index > 0 && comparator(getCellElement(row, index - 1), getCellElement(row, index));\n  };\n\n  var isDuplicatedCell = function (grid, rowIndex, colIndex, comparator) {\n    return notInStartRow(grid, rowIndex, colIndex, comparator) || notInStartColumn(grid[rowIndex], colIndex, comparator);\n  };\n\n  var rowReplacerPredicate = function (targetRow, columnHeaders) {\n    var entireTableIsHeader = forall(columnHeaders, identity) && isHeaderCells(targetRow.cells);\n    return entireTableIsHeader ? always : function (cell, _rowIndex, colIndex) {\n      var type = name(cell.element);\n      return !(type === 'th' && columnHeaders[colIndex]);\n    };\n  };\n\n  var columnReplacePredicate = function (targetColumn, rowHeaders) {\n    var entireTableIsHeader = forall(rowHeaders, identity) && isHeaderCells(targetColumn);\n    return entireTableIsHeader ? always : function (cell, rowIndex, _colIndex) {\n      var type = name(cell.element);\n      return !(type === 'th' && rowHeaders[rowIndex]);\n    };\n  };\n\n  var determineScope = function (applyScope, element, newScope, isInHeader) {\n    var hasSpan = function (scope) {\n      return scope === 'row' ? hasRowspan(element) : hasColspan(element);\n    };\n\n    var getScope = function (scope) {\n      return hasSpan(scope) ? scope + 'group' : scope;\n    };\n\n    if (applyScope) {\n      return isHeaderCell(element) ? getScope(newScope) : null;\n    } else if (isInHeader && isHeaderCell(element)) {\n      var oppositeScope = newScope === 'row' ? 'col' : 'row';\n      return getScope(oppositeScope);\n    } else {\n      return null;\n    }\n  };\n\n  var rowScopeGenerator = function (applyScope, columnHeaders) {\n    return function (cell, rowIndex, columnIndex) {\n      return Optional.some(determineScope(applyScope, cell.element, 'col', columnHeaders[columnIndex]));\n    };\n  };\n\n  var columnScopeGenerator = function (applyScope, rowHeaders) {\n    return function (cell, rowIndex) {\n      return Optional.some(determineScope(applyScope, cell.element, 'row', rowHeaders[rowIndex]));\n    };\n  };\n\n  var replace = function (cell, comparator, substitute) {\n    return elementnew(substitute(cell.element, comparator), true, cell.isLocked);\n  };\n\n  var replaceIn = function (grid, targets, comparator, substitute, replacer, genScope, shouldReplace) {\n    var isTarget = function (cell) {\n      return exists(targets, function (target) {\n        return comparator(cell.element, target.element);\n      });\n    };\n\n    return map$1(grid, function (row, rowIndex) {\n      return mapCells(row, function (cell, colIndex) {\n        if (isTarget(cell)) {\n          var newCell_1 = shouldReplace(cell, rowIndex, colIndex) ? replacer(cell, comparator, substitute) : cell;\n          genScope(newCell_1, rowIndex, colIndex).each(function (scope) {\n            setOptions(newCell_1.element, {\n              scope: Optional.from(scope)\n            });\n          });\n          return newCell_1;\n        } else {\n          return cell;\n        }\n      });\n    });\n  };\n\n  var getColumnCells = function (rows, columnIndex, comparator) {\n    return bind$2(rows, function (row, i) {\n      return isDuplicatedCell(rows, i, columnIndex, comparator) ? [] : [getCell(row, columnIndex)];\n    });\n  };\n\n  var getRowCells = function (rows, rowIndex, comparator) {\n    var targetRow = rows[rowIndex];\n    return bind$2(targetRow.cells, function (item, i) {\n      return isDuplicatedCell(rows, rowIndex, i, comparator) ? [] : [item];\n    });\n  };\n\n  var replaceColumns = function (grid, indexes, applyScope, comparator, substitution) {\n    var rows = extractGridDetails(grid).rows;\n    var targets = bind$2(indexes, function (index) {\n      return getColumnCells(rows, index, comparator);\n    });\n    var rowHeaders = map$1(grid, function (row) {\n      return isHeaderCells(row.cells);\n    });\n    var shouldReplaceCell = columnReplacePredicate(targets, rowHeaders);\n    var scopeGenerator = columnScopeGenerator(applyScope, rowHeaders);\n    return replaceIn(grid, targets, comparator, substitution, replace, scopeGenerator, shouldReplaceCell);\n  };\n\n  var replaceRows = function (grid, indexes, section, applyScope, comparator, substitution, tableSection) {\n    var _a = extractGridDetails(grid),\n        cols = _a.cols,\n        rows = _a.rows;\n\n    var targetRow = rows[indexes[0]];\n    var targets = bind$2(indexes, function (index) {\n      return getRowCells(rows, index, comparator);\n    });\n    var columnHeaders = map$1(targetRow.cells, function (_cell, index) {\n      return isHeaderCells(getColumnCells(rows, index, comparator));\n    });\n\n    var newRows = __spreadArray([], rows, true);\n\n    each$2(indexes, function (index) {\n      newRows[index] = tableSection.transformRow(rows[index], section);\n    });\n    var newGrid = cols.concat(newRows);\n    var shouldReplaceCell = rowReplacerPredicate(targetRow, columnHeaders);\n    var scopeGenerator = rowScopeGenerator(applyScope, columnHeaders);\n    return replaceIn(newGrid, targets, comparator, substitution, tableSection.transformCell, scopeGenerator, shouldReplaceCell);\n  };\n\n  var replaceCells = function (grid, details, comparator, substitution) {\n    var rows = extractGridDetails(grid).rows;\n    var targetCells = map$1(details, function (detail) {\n      return getCell(rows[detail.row], detail.column);\n    });\n    return replaceIn(grid, targetCells, comparator, substitution, replace, Optional.none, always);\n  };\n\n  var uniqueColumns = function (details) {\n    var uniqueCheck = function (rest, detail) {\n      var columnExists = exists(rest, function (currentDetail) {\n        return currentDetail.column === detail.column;\n      });\n      return columnExists ? rest : rest.concat([detail]);\n    };\n\n    return foldl(details, uniqueCheck, []).sort(function (detailA, detailB) {\n      return detailA.column - detailB.column;\n    });\n  };\n\n  var isCol = isTag('col');\n  var isColgroup = isTag('colgroup');\n\n  var isRow$1 = function (element) {\n    return name(element) === 'tr' || isColgroup(element);\n  };\n\n  var elementToData = function (element) {\n    var colspan = getAttrValue(element, 'colspan', 1);\n    var rowspan = getAttrValue(element, 'rowspan', 1);\n    return {\n      element: element,\n      colspan: colspan,\n      rowspan: rowspan\n    };\n  };\n\n  var modification = function (generators, toData) {\n    if (toData === void 0) {\n      toData = elementToData;\n    }\n\n    var nuCell = function (data) {\n      return isCol(data.element) ? generators.col(data) : generators.cell(data);\n    };\n\n    var nuRow = function (data) {\n      return isColgroup(data.element) ? generators.colgroup(data) : generators.row(data);\n    };\n\n    var add = function (element) {\n      if (isRow$1(element)) {\n        return nuRow({\n          element: element\n        });\n      } else {\n        var replacement = nuCell(toData(element));\n        recent = Optional.some({\n          item: element,\n          replacement: replacement\n        });\n        return replacement;\n      }\n    };\n\n    var recent = Optional.none();\n\n    var getOrInit = function (element, comparator) {\n      return recent.fold(function () {\n        return add(element);\n      }, function (p) {\n        return comparator(element, p.item) ? p.replacement : add(element);\n      });\n    };\n\n    return {\n      getOrInit: getOrInit\n    };\n  };\n\n  var transform = function (tag) {\n    return function (generators) {\n      var list = [];\n\n      var find = function (element, comparator) {\n        return find$1(list, function (x) {\n          return comparator(x.item, element);\n        });\n      };\n\n      var makeNew = function (element) {\n        var attrs = tag === 'td' ? {\n          scope: null\n        } : {};\n        var cell = generators.replace(element, tag, attrs);\n        list.push({\n          item: element,\n          sub: cell\n        });\n        return cell;\n      };\n\n      var replaceOrInit = function (element, comparator) {\n        if (isRow$1(element) || isCol(element)) {\n          return element;\n        } else {\n          return find(element, comparator).fold(function () {\n            return makeNew(element);\n          }, function (p) {\n            return comparator(element, p.item) ? p.sub : makeNew(element);\n          });\n        }\n      };\n\n      return {\n        replaceOrInit: replaceOrInit\n      };\n    };\n  };\n\n  var getScopeAttribute = function (cell) {\n    return getOpt(cell, 'scope').map(function (attribute) {\n      return attribute.substr(0, 3);\n    });\n  };\n\n  var merging = function (generators) {\n    var unmerge = function (cell) {\n      var scope = getScopeAttribute(cell);\n      scope.each(function (attribute) {\n        return set$2(cell, 'scope', attribute);\n      });\n      return function () {\n        var raw = generators.cell({\n          element: cell,\n          colspan: 1,\n          rowspan: 1\n        });\n        remove$6(raw, 'width');\n        remove$6(cell, 'width');\n        scope.each(function (attribute) {\n          return set$2(raw, 'scope', attribute);\n        });\n        return raw;\n      };\n    };\n\n    var merge = function (cells) {\n      var getScopeProperty = function () {\n        var stringAttributes = cat(map$1(cells, getScopeAttribute));\n\n        if (stringAttributes.length === 0) {\n          return Optional.none();\n        } else {\n          var baseScope_1 = stringAttributes[0];\n          var scopes_1 = ['row', 'col'];\n          var isMixed = exists(stringAttributes, function (attribute) {\n            return attribute !== baseScope_1 && contains$2(scopes_1, attribute);\n          });\n          return isMixed ? Optional.none() : Optional.from(baseScope_1);\n        }\n      };\n\n      remove$6(cells[0], 'width');\n      getScopeProperty().fold(function () {\n        return remove$7(cells[0], 'scope');\n      }, function (attribute) {\n        return set$2(cells[0], 'scope', attribute + 'group');\n      });\n      return constant(cells[0]);\n    };\n\n    return {\n      unmerge: unmerge,\n      merge: merge\n    };\n  };\n\n  var Generators = {\n    modification: modification,\n    transform: transform,\n    merging: merging\n  };\n  var blockList = ['body', 'p', 'div', 'article', 'aside', 'figcaption', 'figure', 'footer', 'header', 'nav', 'section', 'ol', 'ul', 'table', 'thead', 'tfoot', 'tbody', 'caption', 'tr', 'td', 'th', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'pre', 'address'];\n\n  var isList$1 = function (universe, item) {\n    var tagName = universe.property().name(item);\n    return contains$2(['ol', 'ul'], tagName);\n  };\n\n  var isBlock$1 = function (universe, item) {\n    var tagName = universe.property().name(item);\n    return contains$2(blockList, tagName);\n  };\n\n  var isEmptyTag$1 = function (universe, item) {\n    return contains$2(['br', 'img', 'hr', 'input'], universe.property().name(item));\n  };\n\n  var universe$1 = DomUniverse();\n\n  var isBlock = function (element) {\n    return isBlock$1(universe$1, element);\n  };\n\n  var isList = function (element) {\n    return isList$1(universe$1, element);\n  };\n\n  var isEmptyTag = function (element) {\n    return isEmptyTag$1(universe$1, element);\n  };\n\n  var merge = function (cells) {\n    var isBr = function (el) {\n      return name(el) === 'br';\n    };\n\n    var advancedBr = function (children) {\n      return forall(children, function (c) {\n        return isBr(c) || isText(c) && get$9(c).trim().length === 0;\n      });\n    };\n\n    var isListItem = function (el) {\n      return name(el) === 'li' || ancestor$2(el, isList).isSome();\n    };\n\n    var siblingIsBlock = function (el) {\n      return nextSibling(el).map(function (rightSibling) {\n        if (isBlock(rightSibling)) {\n          return true;\n        }\n\n        if (isEmptyTag(rightSibling)) {\n          return name(rightSibling) === 'img' ? false : true;\n        }\n\n        return false;\n      }).getOr(false);\n    };\n\n    var markCell = function (cell) {\n      return last$1(cell).bind(function (rightEdge) {\n        var rightSiblingIsBlock = siblingIsBlock(rightEdge);\n        return parent(rightEdge).map(function (parent) {\n          return rightSiblingIsBlock === true || isListItem(parent) || isBr(rightEdge) || isBlock(parent) && !eq$1(cell, parent) ? [] : [SugarElement.fromTag('br')];\n        });\n      }).getOr([]);\n    };\n\n    var markContent = function () {\n      var content = bind$2(cells, function (cell) {\n        var children = children$3(cell);\n        return advancedBr(children) ? [] : children.concat(markCell(cell));\n      });\n      return content.length === 0 ? [SugarElement.fromTag('br')] : content;\n    };\n\n    var contents = markContent();\n    empty(cells[0]);\n    append(cells[0], contents);\n  };\n\n  var isEditable = function (elem) {\n    return isEditable$1(elem, true);\n  };\n\n  var prune = function (table) {\n    var cells = cells$1(table);\n\n    if (cells.length === 0) {\n      remove$5(table);\n    }\n  };\n\n  var outcome = function (grid, cursor) {\n    return {\n      grid: grid,\n      cursor: cursor\n    };\n  };\n\n  var findEditableCursorPosition = function (rows) {\n    return findMap(rows, function (row) {\n      return findMap(row.cells, function (cell) {\n        var elem = cell.element;\n        return someIf(isEditable(elem), elem);\n      });\n    });\n  };\n\n  var elementFromGrid = function (grid, row, column) {\n    var _a, _b;\n\n    var rows = extractGridDetails(grid).rows;\n    return Optional.from((_b = (_a = rows[row]) === null || _a === void 0 ? void 0 : _a.cells[column]) === null || _b === void 0 ? void 0 : _b.element).filter(isEditable).orThunk(function () {\n      return findEditableCursorPosition(rows);\n    });\n  };\n\n  var bundle = function (grid, row, column) {\n    var cursorElement = elementFromGrid(grid, row, column);\n    return outcome(grid, cursorElement);\n  };\n\n  var uniqueRows = function (details) {\n    var rowCompilation = function (rest, detail) {\n      var rowExists = exists(rest, function (currentDetail) {\n        return currentDetail.row === detail.row;\n      });\n      return rowExists ? rest : rest.concat([detail]);\n    };\n\n    return foldl(details, rowCompilation, []).sort(function (detailA, detailB) {\n      return detailA.row - detailB.row;\n    });\n  };\n\n  var opInsertRowsBefore = function (grid, details, comparator, genWrappers) {\n    var targetIndex = details[0].row;\n    var rows = uniqueRows(details);\n    var newGrid = foldr(rows, function (acc, row) {\n      var newG = insertRowAt(acc.grid, targetIndex, row.row + acc.delta, comparator, genWrappers.getOrInit);\n      return {\n        grid: newG,\n        delta: acc.delta + 1\n      };\n    }, {\n      grid: grid,\n      delta: 0\n    }).grid;\n    return bundle(newGrid, targetIndex, details[0].column);\n  };\n\n  var opInsertRowsAfter = function (grid, details, comparator, genWrappers) {\n    var rows = uniqueRows(details);\n    var target = rows[rows.length - 1];\n    var targetIndex = target.row + target.rowspan;\n    var newGrid = foldr(rows, function (newG, row) {\n      return insertRowAt(newG, targetIndex, row.row, comparator, genWrappers.getOrInit);\n    }, grid);\n    return bundle(newGrid, targetIndex, details[0].column);\n  };\n\n  var opInsertColumnsBefore = function (grid, extractDetail, comparator, genWrappers) {\n    var details = extractDetail.details;\n    var columns = uniqueColumns(details);\n    var targetIndex = columns[0].column;\n    var newGrid = foldr(columns, function (acc, col) {\n      var newG = insertColumnAt(acc.grid, targetIndex, col.column + acc.delta, comparator, genWrappers.getOrInit);\n      return {\n        grid: newG,\n        delta: acc.delta + 1\n      };\n    }, {\n      grid: grid,\n      delta: 0\n    }).grid;\n    return bundle(newGrid, details[0].row, targetIndex);\n  };\n\n  var opInsertColumnsAfter = function (grid, extractDetail, comparator, genWrappers) {\n    var details = extractDetail.details;\n    var target = details[details.length - 1];\n    var targetIndex = target.column + target.colspan;\n    var columns = uniqueColumns(details);\n    var newGrid = foldr(columns, function (newG, col) {\n      return insertColumnAt(newG, targetIndex, col.column, comparator, genWrappers.getOrInit);\n    }, grid);\n    return bundle(newGrid, details[0].row, targetIndex);\n  };\n\n  var opMakeColumnsHeader = function (initialGrid, details, comparator, genWrappers) {\n    var columns = uniqueColumns(details);\n    var columnIndexes = map$1(columns, function (detail) {\n      return detail.column;\n    });\n    var newGrid = replaceColumns(initialGrid, columnIndexes, true, comparator, genWrappers.replaceOrInit);\n    return bundle(newGrid, details[0].row, details[0].column);\n  };\n\n  var opMakeCellsHeader = function (initialGrid, details, comparator, genWrappers) {\n    var newGrid = replaceCells(initialGrid, details, comparator, genWrappers.replaceOrInit);\n    return bundle(newGrid, details[0].row, details[0].column);\n  };\n\n  var opUnmakeColumnsHeader = function (initialGrid, details, comparator, genWrappers) {\n    var columns = uniqueColumns(details);\n    var columnIndexes = map$1(columns, function (detail) {\n      return detail.column;\n    });\n    var newGrid = replaceColumns(initialGrid, columnIndexes, false, comparator, genWrappers.replaceOrInit);\n    return bundle(newGrid, details[0].row, details[0].column);\n  };\n\n  var opUnmakeCellsHeader = function (initialGrid, details, comparator, genWrappers) {\n    var newGrid = replaceCells(initialGrid, details, comparator, genWrappers.replaceOrInit);\n    return bundle(newGrid, details[0].row, details[0].column);\n  };\n\n  var makeRowsSection = function (section, applyScope) {\n    return function (initialGrid, details, comparator, genWrappers, tableSection) {\n      var rows = uniqueRows(details);\n      var rowIndexes = map$1(rows, function (detail) {\n        return detail.row;\n      });\n      var newGrid = replaceRows(initialGrid, rowIndexes, section, applyScope, comparator, genWrappers.replaceOrInit, tableSection);\n      return bundle(newGrid, details[0].row, details[0].column);\n    };\n  };\n\n  var opMakeRowsHeader = makeRowsSection('thead', true);\n  var opMakeRowsBody = makeRowsSection('tbody', false);\n  var opMakeRowsFooter = makeRowsSection('tfoot', false);\n\n  var opEraseColumns = function (grid, extractDetail, _comparator, _genWrappers) {\n    var columns = uniqueColumns(extractDetail.details);\n    var newGrid = deleteColumnsAt(grid, map$1(columns, function (column) {\n      return column.column;\n    }));\n    var maxColIndex = newGrid.length > 0 ? newGrid[0].cells.length - 1 : 0;\n    return bundle(newGrid, columns[0].row, Math.min(columns[0].column, maxColIndex));\n  };\n\n  var opEraseRows = function (grid, details, _comparator, _genWrappers) {\n    var rows = uniqueRows(details);\n    var newGrid = deleteRowsAt(grid, rows[0].row, rows[rows.length - 1].row);\n    var maxRowIndex = newGrid.length > 0 ? newGrid.length - 1 : 0;\n    return bundle(newGrid, Math.min(details[0].row, maxRowIndex), details[0].column);\n  };\n\n  var opMergeCells = function (grid, mergable, comparator, genWrappers) {\n    var cells = mergable.cells;\n    merge(cells);\n    var newGrid = merge$2(grid, mergable.bounds, comparator, genWrappers.merge(cells));\n    return outcome(newGrid, Optional.from(cells[0]));\n  };\n\n  var opUnmergeCells = function (grid, unmergable, comparator, genWrappers) {\n    var unmerge$1 = function (b, cell) {\n      return unmerge(b, cell, comparator, genWrappers.unmerge(cell));\n    };\n\n    var newGrid = foldr(unmergable, unmerge$1, grid);\n    return outcome(newGrid, Optional.from(unmergable[0]));\n  };\n\n  var opPasteCells = function (grid, pasteDetails, comparator, _genWrappers) {\n    var gridify = function (table, generators) {\n      var wh = Warehouse.fromTable(table);\n      return toGrid(wh, generators, true);\n    };\n\n    var gridB = gridify(pasteDetails.clipboard, pasteDetails.generators);\n    var startAddress = address(pasteDetails.row, pasteDetails.column);\n    var mergedGrid = merge$1(startAddress, grid, gridB, pasteDetails.generators, comparator);\n    return mergedGrid.fold(function () {\n      return outcome(grid, Optional.some(pasteDetails.element));\n    }, function (newGrid) {\n      return bundle(newGrid, pasteDetails.row, pasteDetails.column);\n    });\n  };\n\n  var gridifyRows = function (rows, generators, context) {\n    var pasteDetails = fromPastedRows(rows, context.section);\n    var wh = Warehouse.generate(pasteDetails);\n    return toGrid(wh, generators, true);\n  };\n\n  var opPasteColsBefore = function (grid, pasteDetails, comparator, _genWrappers) {\n    var rows = extractGridDetails(grid).rows;\n    var index = pasteDetails.cells[0].column;\n    var context = rows[pasteDetails.cells[0].row];\n    var gridB = gridifyRows(pasteDetails.clipboard, pasteDetails.generators, context);\n    var mergedGrid = insertCols(index, grid, gridB, pasteDetails.generators, comparator);\n    return bundle(mergedGrid, pasteDetails.cells[0].row, pasteDetails.cells[0].column);\n  };\n\n  var opPasteColsAfter = function (grid, pasteDetails, comparator, _genWrappers) {\n    var rows = extractGridDetails(grid).rows;\n    var index = pasteDetails.cells[pasteDetails.cells.length - 1].column + pasteDetails.cells[pasteDetails.cells.length - 1].colspan;\n    var context = rows[pasteDetails.cells[0].row];\n    var gridB = gridifyRows(pasteDetails.clipboard, pasteDetails.generators, context);\n    var mergedGrid = insertCols(index, grid, gridB, pasteDetails.generators, comparator);\n    return bundle(mergedGrid, pasteDetails.cells[0].row, pasteDetails.cells[0].column);\n  };\n\n  var opPasteRowsBefore = function (grid, pasteDetails, comparator, _genWrappers) {\n    var rows = extractGridDetails(grid).rows;\n    var index = pasteDetails.cells[0].row;\n    var context = rows[index];\n    var gridB = gridifyRows(pasteDetails.clipboard, pasteDetails.generators, context);\n    var mergedGrid = insertRows(index, grid, gridB, pasteDetails.generators, comparator);\n    return bundle(mergedGrid, pasteDetails.cells[0].row, pasteDetails.cells[0].column);\n  };\n\n  var opPasteRowsAfter = function (grid, pasteDetails, comparator, _genWrappers) {\n    var rows = extractGridDetails(grid).rows;\n    var index = pasteDetails.cells[pasteDetails.cells.length - 1].row + pasteDetails.cells[pasteDetails.cells.length - 1].rowspan;\n    var context = rows[pasteDetails.cells[0].row];\n    var gridB = gridifyRows(pasteDetails.clipboard, pasteDetails.generators, context);\n    var mergedGrid = insertRows(index, grid, gridB, pasteDetails.generators, comparator);\n    return bundle(mergedGrid, pasteDetails.cells[0].row, pasteDetails.cells[0].column);\n  };\n\n  var opGetColumnsType = function (table, target) {\n    var house = Warehouse.fromTable(table);\n    var details = onCells(house, target);\n    return details.bind(function (selectedCells) {\n      var lastSelectedCell = selectedCells[selectedCells.length - 1];\n      var minColRange = selectedCells[0].column;\n      var maxColRange = lastSelectedCell.column + lastSelectedCell.colspan;\n      var selectedColumnCells = flatten$1(map$1(house.all, function (row) {\n        return filter$2(row.cells, function (cell) {\n          return cell.column >= minColRange && cell.column < maxColRange;\n        });\n      }));\n      return findCommonCellType(selectedColumnCells);\n    }).getOr('');\n  };\n\n  var opGetCellsType = function (table, target) {\n    var house = Warehouse.fromTable(table);\n    var details = onCells(house, target);\n    return details.bind(findCommonCellType).getOr('');\n  };\n\n  var opGetRowsType = function (table, target) {\n    var house = Warehouse.fromTable(table);\n    var details = onCells(house, target);\n    return details.bind(function (selectedCells) {\n      var lastSelectedCell = selectedCells[selectedCells.length - 1];\n      var minRowRange = selectedCells[0].row;\n      var maxRowRange = lastSelectedCell.row + lastSelectedCell.rowspan;\n      var selectedRows = house.all.slice(minRowRange, maxRowRange);\n      return findCommonRowType(selectedRows);\n    }).getOr('');\n  };\n\n  var resize = function (table, list, details, behaviours) {\n    return adjustWidthTo(table, list, details, behaviours.sizing);\n  };\n\n  var adjustAndRedistributeWidths = function (table, list, details, behaviours) {\n    return adjustAndRedistributeWidths$1(table, list, details, behaviours.sizing, behaviours.resize);\n  };\n\n  var firstColumnIsLocked = function (_warehouse, details) {\n    return exists(details, function (detail) {\n      return detail.column === 0 && detail.isLocked;\n    });\n  };\n\n  var lastColumnIsLocked = function (warehouse, details) {\n    return exists(details, function (detail) {\n      return detail.column + detail.colspan >= warehouse.grid.columns && detail.isLocked;\n    });\n  };\n\n  var getColumnsWidth = function (warehouse, details) {\n    var columns$1 = columns(warehouse);\n    var uniqueCols = uniqueColumns(details);\n    return foldl(uniqueCols, function (acc, detail) {\n      var column = columns$1[detail.column];\n      var colWidth = column.map(getOuter$2).getOr(0);\n      return acc + colWidth;\n    }, 0);\n  };\n\n  var insertColumnsExtractor = function (before) {\n    return function (warehouse, target) {\n      return onCells(warehouse, target).filter(function (details) {\n        var checkLocked = before ? firstColumnIsLocked : lastColumnIsLocked;\n        return !checkLocked(warehouse, details);\n      }).map(function (details) {\n        return {\n          details: details,\n          pixelDelta: getColumnsWidth(warehouse, details)\n        };\n      });\n    };\n  };\n\n  var eraseColumnsExtractor = function (warehouse, target) {\n    return onUnlockedCells(warehouse, target).map(function (details) {\n      return {\n        details: details,\n        pixelDelta: -getColumnsWidth(warehouse, details)\n      };\n    });\n  };\n\n  var pasteColumnsExtractor = function (before) {\n    return function (warehouse, target) {\n      return onPasteByEditor(warehouse, target).filter(function (details) {\n        var checkLocked = before ? firstColumnIsLocked : lastColumnIsLocked;\n        return !checkLocked(warehouse, details.cells);\n      });\n    };\n  };\n\n  var headerCellGenerator = Generators.transform('th');\n  var bodyCellGenerator = Generators.transform('td');\n  var insertRowsBefore = run(opInsertRowsBefore, onCells, noop, noop, Generators.modification);\n  var insertRowsAfter = run(opInsertRowsAfter, onCells, noop, noop, Generators.modification);\n  var insertColumnsBefore = run(opInsertColumnsBefore, insertColumnsExtractor(true), adjustAndRedistributeWidths, noop, Generators.modification);\n  var insertColumnsAfter = run(opInsertColumnsAfter, insertColumnsExtractor(false), adjustAndRedistributeWidths, noop, Generators.modification);\n  var eraseColumns = run(opEraseColumns, eraseColumnsExtractor, adjustAndRedistributeWidths, prune, Generators.modification);\n  var eraseRows = run(opEraseRows, onCells, noop, prune, Generators.modification);\n  var makeColumnsHeader = run(opMakeColumnsHeader, onUnlockedCells, noop, noop, headerCellGenerator);\n  var unmakeColumnsHeader = run(opUnmakeColumnsHeader, onUnlockedCells, noop, noop, bodyCellGenerator);\n  var makeRowsHeader = run(opMakeRowsHeader, onUnlockedCells, noop, noop, headerCellGenerator);\n  var makeRowsBody = run(opMakeRowsBody, onUnlockedCells, noop, noop, bodyCellGenerator);\n  var makeRowsFooter = run(opMakeRowsFooter, onUnlockedCells, noop, noop, bodyCellGenerator);\n  var makeCellsHeader = run(opMakeCellsHeader, onUnlockedCells, noop, noop, headerCellGenerator);\n  var unmakeCellsHeader = run(opUnmakeCellsHeader, onUnlockedCells, noop, noop, bodyCellGenerator);\n  var mergeCells = run(opMergeCells, onUnlockedMergable, resize, noop, Generators.merging);\n  var unmergeCells = run(opUnmergeCells, onUnlockedUnmergable, resize, noop, Generators.merging);\n  var pasteCells = run(opPasteCells, onPaste, resize, noop, Generators.modification);\n  var pasteColsBefore = run(opPasteColsBefore, pasteColumnsExtractor(true), noop, noop, Generators.modification);\n  var pasteColsAfter = run(opPasteColsAfter, pasteColumnsExtractor(false), noop, noop, Generators.modification);\n  var pasteRowsBefore = run(opPasteRowsBefore, onPasteByEditor, noop, noop, Generators.modification);\n  var pasteRowsAfter = run(opPasteRowsAfter, onPasteByEditor, noop, noop, Generators.modification);\n  var getColumnsType = opGetColumnsType;\n  var getCellsType = opGetCellsType;\n  var getRowsType = opGetRowsType;\n\n  var TableActions = function (editor, cellSelection, lazyWire) {\n    var isTableBody = function (editor) {\n      return name(getBody(editor)) === 'table';\n    };\n\n    var lastRowGuard = function (table) {\n      return isTableBody(editor) === false || getGridSize(table).rows > 1;\n    };\n\n    var lastColumnGuard = function (table) {\n      return isTableBody(editor) === false || getGridSize(table).columns > 1;\n    };\n\n    var cloneFormats = getCloneElements(editor);\n    var colMutationOp = isResizeTableColumnResizing(editor) ? noop : halve;\n\n    var getTableSectionType = function (table) {\n      switch (getTableHeaderType(editor)) {\n        case 'section':\n          return TableSection.section();\n\n        case 'sectionCells':\n          return TableSection.sectionCells();\n\n        case 'cells':\n          return TableSection.cells();\n\n        default:\n          return TableSection.getTableSectionType(table, 'section');\n      }\n    };\n\n    var setSelectionFromAction = function (table, result) {\n      return result.cursor.fold(function () {\n        var cells = cells$1(table);\n        return head(cells).filter(inBody).map(function (firstCell) {\n          cellSelection.clear(table);\n          var rng = editor.dom.createRng();\n          rng.selectNode(firstCell.dom);\n          editor.selection.setRng(rng);\n          set$2(firstCell, 'data-mce-selected', '1');\n          return rng;\n        });\n      }, function (cell) {\n        var des = freefallRtl(cell);\n        var rng = editor.dom.createRng();\n        rng.setStart(des.element.dom, des.offset);\n        rng.setEnd(des.element.dom, des.offset);\n        editor.selection.setRng(rng);\n        cellSelection.clear(table);\n        return Optional.some(rng);\n      });\n    };\n\n    var execute = function (operation, guard, mutate, lazyWire, effect) {\n      return function (table, target, noEvents) {\n        if (noEvents === void 0) {\n          noEvents = false;\n        }\n\n        removeDataStyle(table);\n        var wire = lazyWire();\n        var doc = SugarElement.fromDom(editor.getDoc());\n        var generators = cellOperations(mutate, doc, cloneFormats);\n        var behaviours = {\n          sizing: get$4(editor, table),\n          resize: isResizeTableColumnResizing(editor) ? resizeTable() : preserveTable(),\n          section: getTableSectionType(table)\n        };\n        return guard(table) ? operation(wire, table, target, generators, behaviours).bind(function (result) {\n          each$2(result.newRows, function (row) {\n            fireNewRow(editor, row.dom);\n          });\n          each$2(result.newCells, function (cell) {\n            fireNewCell(editor, cell.dom);\n          });\n          var range = setSelectionFromAction(table, result);\n\n          if (inBody(table)) {\n            removeDataStyle(table);\n\n            if (!noEvents) {\n              fireTableModified(editor, table.dom, effect);\n            }\n          }\n\n          return range.map(function (rng) {\n            return {\n              rng: rng,\n              effect: effect\n            };\n          });\n        }) : Optional.none();\n      };\n    };\n\n    var deleteRow = execute(eraseRows, lastRowGuard, noop, lazyWire, structureModified);\n    var deleteColumn = execute(eraseColumns, lastColumnGuard, noop, lazyWire, structureModified);\n    var insertRowsBefore$1 = execute(insertRowsBefore, always, noop, lazyWire, structureModified);\n    var insertRowsAfter$1 = execute(insertRowsAfter, always, noop, lazyWire, structureModified);\n    var insertColumnsBefore$1 = execute(insertColumnsBefore, always, colMutationOp, lazyWire, structureModified);\n    var insertColumnsAfter$1 = execute(insertColumnsAfter, always, colMutationOp, lazyWire, structureModified);\n    var mergeCells$1 = execute(mergeCells, always, noop, lazyWire, structureModified);\n    var unmergeCells$1 = execute(unmergeCells, always, noop, lazyWire, structureModified);\n    var pasteColsBefore$1 = execute(pasteColsBefore, always, noop, lazyWire, structureModified);\n    var pasteColsAfter$1 = execute(pasteColsAfter, always, noop, lazyWire, structureModified);\n    var pasteRowsBefore$1 = execute(pasteRowsBefore, always, noop, lazyWire, structureModified);\n    var pasteRowsAfter$1 = execute(pasteRowsAfter, always, noop, lazyWire, structureModified);\n    var pasteCells$1 = execute(pasteCells, always, noop, lazyWire, styleAndStructureModified);\n    var makeCellsHeader$1 = execute(makeCellsHeader, always, noop, lazyWire, structureModified);\n    var unmakeCellsHeader$1 = execute(unmakeCellsHeader, always, noop, lazyWire, structureModified);\n    var makeColumnsHeader$1 = execute(makeColumnsHeader, always, noop, lazyWire, structureModified);\n    var unmakeColumnsHeader$1 = execute(unmakeColumnsHeader, always, noop, lazyWire, structureModified);\n    var makeRowsHeader$1 = execute(makeRowsHeader, always, noop, lazyWire, structureModified);\n    var makeRowsBody$1 = execute(makeRowsBody, always, noop, lazyWire, structureModified);\n    var makeRowsFooter$1 = execute(makeRowsFooter, always, noop, lazyWire, structureModified);\n    var getTableCellType = getCellsType;\n    var getTableColType = getColumnsType;\n    var getTableRowType = getRowsType;\n    return {\n      deleteRow: deleteRow,\n      deleteColumn: deleteColumn,\n      insertRowsBefore: insertRowsBefore$1,\n      insertRowsAfter: insertRowsAfter$1,\n      insertColumnsBefore: insertColumnsBefore$1,\n      insertColumnsAfter: insertColumnsAfter$1,\n      mergeCells: mergeCells$1,\n      unmergeCells: unmergeCells$1,\n      pasteColsBefore: pasteColsBefore$1,\n      pasteColsAfter: pasteColsAfter$1,\n      pasteRowsBefore: pasteRowsBefore$1,\n      pasteRowsAfter: pasteRowsAfter$1,\n      pasteCells: pasteCells$1,\n      makeCellsHeader: makeCellsHeader$1,\n      unmakeCellsHeader: unmakeCellsHeader$1,\n      makeColumnsHeader: makeColumnsHeader$1,\n      unmakeColumnsHeader: unmakeColumnsHeader$1,\n      makeRowsHeader: makeRowsHeader$1,\n      makeRowsBody: makeRowsBody$1,\n      makeRowsFooter: makeRowsFooter$1,\n      getTableRowType: getTableRowType,\n      getTableCellType: getTableCellType,\n      getTableColType: getTableColType\n    };\n  };\n\n  var DefaultRenderOptions = {\n    styles: {\n      'border-collapse': 'collapse',\n      'width': '100%'\n    },\n    attributes: {\n      border: '1'\n    },\n    colGroups: false\n  };\n\n  var tableHeaderCell = function () {\n    return SugarElement.fromTag('th');\n  };\n\n  var tableCell = function () {\n    return SugarElement.fromTag('td');\n  };\n\n  var tableColumn = function () {\n    return SugarElement.fromTag('col');\n  };\n\n  var createRow = function (columns, rowHeaders, columnHeaders, rowIndex) {\n    var tr = SugarElement.fromTag('tr');\n\n    for (var j = 0; j < columns; j++) {\n      var td = rowIndex < rowHeaders || j < columnHeaders ? tableHeaderCell() : tableCell();\n\n      if (j < columnHeaders) {\n        set$2(td, 'scope', 'row');\n      }\n\n      if (rowIndex < rowHeaders) {\n        set$2(td, 'scope', 'col');\n      }\n\n      append$1(td, SugarElement.fromTag('br'));\n      append$1(tr, td);\n    }\n\n    return tr;\n  };\n\n  var createGroupRow = function (columns) {\n    var columnGroup = SugarElement.fromTag('colgroup');\n    range$1(columns, function () {\n      return append$1(columnGroup, tableColumn());\n    });\n    return columnGroup;\n  };\n\n  var createRows = function (rows, columns, rowHeaders, columnHeaders) {\n    return range$1(rows, function (r) {\n      return createRow(columns, rowHeaders, columnHeaders, r);\n    });\n  };\n\n  var render = function (rows, columns, rowHeaders, columnHeaders, headerType, renderOpts) {\n    if (renderOpts === void 0) {\n      renderOpts = DefaultRenderOptions;\n    }\n\n    var table = SugarElement.fromTag('table');\n    var rowHeadersGoInThead = headerType !== 'cells';\n    setAll(table, renderOpts.styles);\n    setAll$1(table, renderOpts.attributes);\n\n    if (renderOpts.colGroups) {\n      append$1(table, createGroupRow(columns));\n    }\n\n    var actualRowHeaders = Math.min(rows, rowHeaders);\n\n    if (rowHeadersGoInThead && rowHeaders > 0) {\n      var thead = SugarElement.fromTag('thead');\n      append$1(table, thead);\n      var theadRowHeaders = headerType === 'sectionCells' ? actualRowHeaders : 0;\n      var theadRows = createRows(rowHeaders, columns, theadRowHeaders, columnHeaders);\n      append(thead, theadRows);\n    }\n\n    var tbody = SugarElement.fromTag('tbody');\n    append$1(table, tbody);\n    var numRows = rowHeadersGoInThead ? rows - actualRowHeaders : rows;\n    var numRowHeaders = rowHeadersGoInThead ? 0 : rowHeaders;\n    var tbodyRows = createRows(numRows, columns, numRowHeaders, columnHeaders);\n    append(tbody, tbodyRows);\n    return table;\n  };\n\n  var get$2 = function (element) {\n    return element.dom.innerHTML;\n  };\n\n  var getOuter = function (element) {\n    var container = SugarElement.fromTag('div');\n    var clone = SugarElement.fromDom(element.dom.cloneNode(true));\n    append$1(container, clone);\n    return get$2(container);\n  };\n\n  var placeCaretInCell = function (editor, cell) {\n    editor.selection.select(cell.dom, true);\n    editor.selection.collapse(true);\n  };\n\n  var selectFirstCellInTable = function (editor, tableElm) {\n    descendant(tableElm, 'td,th').each(curry(placeCaretInCell, editor));\n  };\n\n  var fireEvents = function (editor, table) {\n    each$2(descendants(table, 'tr'), function (row) {\n      fireNewRow(editor, row.dom);\n      each$2(descendants(row, 'th,td'), function (cell) {\n        fireNewCell(editor, cell.dom);\n      });\n    });\n  };\n\n  var isPercentage = function (width) {\n    return isString(width) && width.indexOf('%') !== -1;\n  };\n\n  var insert = function (editor, columns, rows, colHeaders, rowHeaders) {\n    var defaultStyles = getDefaultStyles(editor);\n    var options = {\n      styles: defaultStyles,\n      attributes: getDefaultAttributes(editor),\n      colGroups: useColumnGroup(editor)\n    };\n    editor.undoManager.ignore(function () {\n      var table = render(rows, columns, rowHeaders, colHeaders, getTableHeaderType(editor), options);\n      set$2(table, 'data-mce-id', '__mce');\n      var html = getOuter(table);\n      editor.insertContent(html);\n      editor.addVisual();\n    });\n    return descendant(getBody(editor), 'table[data-mce-id=\"__mce\"]').map(function (table) {\n      if (isPixelsForced(editor)) {\n        enforcePixels(table);\n      } else if (isResponsiveForced(editor)) {\n        enforceNone(table);\n      } else if (isPercentagesForced(editor) || isPercentage(defaultStyles.width)) {\n        enforcePercentage(table);\n      }\n\n      removeDataStyle(table);\n      remove$7(table, 'data-mce-id');\n      fireEvents(editor, table);\n      selectFirstCellInTable(editor, table);\n      return table.dom;\n    }).getOr(null);\n  };\n\n  var insertTableWithDataValidation = function (editor, rows, columns, options, errorMsg) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var checkInput = function (val) {\n      return isNumber(val) && val > 0;\n    };\n\n    if (checkInput(rows) && checkInput(columns)) {\n      var headerRows = options.headerRows || 0;\n      var headerColumns = options.headerColumns || 0;\n      return insert(editor, columns, rows, headerColumns, headerRows);\n    } else {\n      console.error(errorMsg);\n      return null;\n    }\n  };\n\n  var getClipboardElements = function (getClipboard) {\n    return function () {\n      return getClipboard().fold(function () {\n        return [];\n      }, function (elems) {\n        return map$1(elems, function (e) {\n          return e.dom;\n        });\n      });\n    };\n  };\n\n  var setClipboardElements = function (setClipboard) {\n    return function (elems) {\n      var elmsOpt = elems.length > 0 ? Optional.some(fromDom(elems)) : Optional.none();\n      setClipboard(elmsOpt);\n    };\n  };\n\n  var insertTable = function (editor) {\n    return function (columns, rows, options) {\n      if (options === void 0) {\n        options = {};\n      }\n\n      var table = insertTableWithDataValidation(editor, rows, columns, options, 'Invalid values for insertTable - rows and columns values are required to insert a table.');\n      editor.undoManager.add();\n      return table;\n    };\n  };\n\n  var getApi = function (editor, clipboard, resizeHandler, selectionTargets) {\n    return {\n      insertTable: insertTable(editor),\n      setClipboardRows: setClipboardElements(clipboard.setRows),\n      getClipboardRows: getClipboardElements(clipboard.getRows),\n      setClipboardCols: setClipboardElements(clipboard.setColumns),\n      getClipboardCols: getClipboardElements(clipboard.getColumns),\n      resizeHandler: resizeHandler,\n      selectionTargets: selectionTargets\n    };\n  };\n\n  var constrainSpan = function (element, property, value) {\n    var currentColspan = getAttrValue(element, property, 1);\n\n    if (value === 1 || currentColspan <= 1) {\n      remove$7(element, property);\n    } else {\n      set$2(element, property, Math.min(value, currentColspan));\n    }\n  };\n\n  var generateColGroup = function (house, minColRange, maxColRange) {\n    if (Warehouse.hasColumns(house)) {\n      var colsToCopy = filter$2(Warehouse.justColumns(house), function (col) {\n        return col.column >= minColRange && col.column < maxColRange;\n      });\n      var copiedCols = map$1(colsToCopy, function (c) {\n        var clonedCol = deep(c.element);\n        constrainSpan(clonedCol, 'span', maxColRange - minColRange);\n        return clonedCol;\n      });\n      var fakeColgroup = SugarElement.fromTag('colgroup');\n      append(fakeColgroup, copiedCols);\n      return [fakeColgroup];\n    } else {\n      return [];\n    }\n  };\n\n  var generateRows = function (house, minColRange, maxColRange) {\n    return map$1(house.all, function (row) {\n      var cellsToCopy = filter$2(row.cells, function (cell) {\n        return cell.column >= minColRange && cell.column < maxColRange;\n      });\n      var copiedCells = map$1(cellsToCopy, function (cell) {\n        var clonedCell = deep(cell.element);\n        constrainSpan(clonedCell, 'colspan', maxColRange - minColRange);\n        return clonedCell;\n      });\n      var fakeTR = SugarElement.fromTag('tr');\n      append(fakeTR, copiedCells);\n      return fakeTR;\n    });\n  };\n\n  var copyCols = function (table, target) {\n    var house = Warehouse.fromTable(table);\n    var details = onUnlockedCells(house, target);\n    return details.map(function (selectedCells) {\n      var lastSelectedCell = selectedCells[selectedCells.length - 1];\n      var minColRange = selectedCells[0].column;\n      var maxColRange = lastSelectedCell.column + lastSelectedCell.colspan;\n      var fakeColGroups = generateColGroup(house, minColRange, maxColRange);\n      var fakeRows = generateRows(house, minColRange, maxColRange);\n      return __spreadArray(__spreadArray([], fakeColGroups, true), fakeRows, true);\n    });\n  };\n\n  var copyRows = function (table, target, generators) {\n    var warehouse = Warehouse.fromTable(table);\n    var details = onCells(warehouse, target);\n    return details.bind(function (selectedCells) {\n      var grid = toGrid(warehouse, generators, false);\n      var rows = extractGridDetails(grid).rows;\n      var slicedGrid = rows.slice(selectedCells[0].row, selectedCells[selectedCells.length - 1].row + selectedCells[selectedCells.length - 1].rowspan);\n      var filteredGrid = bind$2(slicedGrid, function (row) {\n        var newCells = filter$2(row.cells, function (cell) {\n          return !cell.isLocked;\n        });\n        return newCells.length > 0 ? [__assign(__assign({}, row), {\n          cells: newCells\n        })] : [];\n      });\n      var slicedDetails = toDetailList(filteredGrid);\n      return someIf(slicedDetails.length > 0, slicedDetails);\n    }).map(function (slicedDetails) {\n      return copy(slicedDetails);\n    });\n  };\n\n  var global$2 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n  var getTDTHOverallStyle = function (dom, elm, name) {\n    var cells = dom.select('td,th', elm);\n    var firstChildStyle;\n\n    var checkChildren = function (firstChildStyle, elms) {\n      for (var i = 0; i < elms.length; i++) {\n        var currentStyle = dom.getStyle(elms[i], name);\n\n        if (typeof firstChildStyle === 'undefined') {\n          firstChildStyle = currentStyle;\n        }\n\n        if (firstChildStyle !== currentStyle) {\n          return '';\n        }\n      }\n\n      return firstChildStyle;\n    };\n\n    return checkChildren(firstChildStyle, cells);\n  };\n\n  var applyAlign = function (editor, elm, name) {\n    if (name) {\n      editor.formatter.apply('align' + name, {}, elm);\n    }\n  };\n\n  var applyVAlign = function (editor, elm, name) {\n    if (name) {\n      editor.formatter.apply('valign' + name, {}, elm);\n    }\n  };\n\n  var unApplyAlign = function (editor, elm) {\n    global$2.each('left center right'.split(' '), function (name) {\n      editor.formatter.remove('align' + name, {}, elm);\n    });\n  };\n\n  var unApplyVAlign = function (editor, elm) {\n    global$2.each('top middle bottom'.split(' '), function (name) {\n      editor.formatter.remove('valign' + name, {}, elm);\n    });\n  };\n\n  var verticalAlignValues = [{\n    text: 'None',\n    value: ''\n  }, {\n    text: 'Top',\n    value: 'top'\n  }, {\n    text: 'Middle',\n    value: 'middle'\n  }, {\n    text: 'Bottom',\n    value: 'bottom'\n  }];\n\n  var hexColour = function (value) {\n    return {\n      value: value\n    };\n  };\n\n  var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n  var longformRegex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\n\n  var isHexString = function (hex) {\n    return shorthandRegex.test(hex) || longformRegex.test(hex);\n  };\n\n  var normalizeHex = function (hex) {\n    return removeLeading(hex, '#').toUpperCase();\n  };\n\n  var fromString$1 = function (hex) {\n    return isHexString(hex) ? Optional.some({\n      value: normalizeHex(hex)\n    }) : Optional.none();\n  };\n\n  var toHex = function (component) {\n    var hex = component.toString(16);\n    return (hex.length === 1 ? '0' + hex : hex).toUpperCase();\n  };\n\n  var fromRgba = function (rgbaColour) {\n    var value = toHex(rgbaColour.red) + toHex(rgbaColour.green) + toHex(rgbaColour.blue);\n    return hexColour(value);\n  };\n\n  var rgbRegex = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/;\n  var rgbaRegex = /^rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*(\\d?(?:\\.\\d+)?)\\)/;\n\n  var rgbaColour = function (red, green, blue, alpha) {\n    return {\n      red: red,\n      green: green,\n      blue: blue,\n      alpha: alpha\n    };\n  };\n\n  var fromStringValues = function (red, green, blue, alpha) {\n    var r = parseInt(red, 10);\n    var g = parseInt(green, 10);\n    var b = parseInt(blue, 10);\n    var a = parseFloat(alpha);\n    return rgbaColour(r, g, b, a);\n  };\n\n  var fromString = function (rgbaString) {\n    if (rgbaString === 'transparent') {\n      return Optional.some(rgbaColour(0, 0, 0, 0));\n    }\n\n    var rgbMatch = rgbRegex.exec(rgbaString);\n\n    if (rgbMatch !== null) {\n      return Optional.some(fromStringValues(rgbMatch[1], rgbMatch[2], rgbMatch[3], '1'));\n    }\n\n    var rgbaMatch = rgbaRegex.exec(rgbaString);\n\n    if (rgbaMatch !== null) {\n      return Optional.some(fromStringValues(rgbaMatch[1], rgbaMatch[2], rgbaMatch[3], rgbaMatch[4]));\n    }\n\n    return Optional.none();\n  };\n\n  var anyToHex = function (color) {\n    return fromString$1(color).orThunk(function () {\n      return fromString(color).map(fromRgba);\n    }).getOrThunk(function () {\n      var canvas = document.createElement('canvas');\n      canvas.height = 1;\n      canvas.width = 1;\n      var canvasContext = canvas.getContext('2d');\n      canvasContext.clearRect(0, 0, canvas.width, canvas.height);\n      canvasContext.fillStyle = '#FFFFFF';\n      canvasContext.fillStyle = color;\n      canvasContext.fillRect(0, 0, 1, 1);\n      var rgba = canvasContext.getImageData(0, 0, 1, 1).data;\n      var r = rgba[0];\n      var g = rgba[1];\n      var b = rgba[2];\n      var a = rgba[3];\n      return fromRgba(rgbaColour(r, g, b, a));\n    });\n  };\n\n  var Cell = function (initial) {\n    var value = initial;\n\n    var get = function () {\n      return value;\n    };\n\n    var set = function (v) {\n      value = v;\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var singleton = function (doRevoke) {\n    var subject = Cell(Optional.none());\n\n    var revoke = function () {\n      return subject.get().each(doRevoke);\n    };\n\n    var clear = function () {\n      revoke();\n      subject.set(Optional.none());\n    };\n\n    var isSet = function () {\n      return subject.get().isSome();\n    };\n\n    var get = function () {\n      return subject.get();\n    };\n\n    var set = function (s) {\n      revoke();\n      subject.set(Optional.some(s));\n    };\n\n    return {\n      clear: clear,\n      isSet: isSet,\n      get: get,\n      set: set\n    };\n  };\n\n  var unbindable = function () {\n    return singleton(function (s) {\n      return s.unbind();\n    });\n  };\n\n  var value = function () {\n    var subject = singleton(noop);\n\n    var on = function (f) {\n      return subject.get().each(f);\n    };\n\n    return __assign(__assign({}, subject), {\n      on: on\n    });\n  };\n\n  var onSetupToggle = function (editor, selections, formatName, formatValue) {\n    return function (api) {\n      var boundCallback = unbindable();\n      var isNone = isEmpty$1(formatValue);\n\n      var init = function () {\n        var selectedCells = getCellsFromSelection(selections);\n\n        var checkNode = function (cell) {\n          return editor.formatter.match(formatName, {\n            value: formatValue\n          }, cell.dom, isNone);\n        };\n\n        if (isNone) {\n          api.setActive(!exists(selectedCells, checkNode));\n          boundCallback.set(editor.formatter.formatChanged(formatName, function (match) {\n            return api.setActive(!match);\n          }, true));\n        } else {\n          api.setActive(forall(selectedCells, checkNode));\n          boundCallback.set(editor.formatter.formatChanged(formatName, api.setActive, false, {\n            value: formatValue\n          }));\n        }\n      };\n\n      editor.initialized ? init() : editor.on('init', init);\n      return boundCallback.clear;\n    };\n  };\n\n  var isListGroup = function (item) {\n    return hasNonNullableKey(item, 'menu');\n  };\n\n  var buildListItems = function (items) {\n    return map$1(items, function (item) {\n      var text = item.text || item.title;\n\n      if (isListGroup(item)) {\n        return {\n          text: text,\n          items: buildListItems(item.menu)\n        };\n      } else {\n        return {\n          text: text,\n          value: item.value\n        };\n      }\n    });\n  };\n\n  var buildMenuItems = function (editor, selections, items, format, onAction) {\n    return map$1(items, function (item) {\n      var text = item.text || item.title;\n\n      if (isListGroup(item)) {\n        return {\n          type: 'nestedmenuitem',\n          text: text,\n          getSubmenuItems: function () {\n            return buildMenuItems(editor, selections, item.menu, format, onAction);\n          }\n        };\n      } else {\n        return {\n          text: text,\n          type: 'togglemenuitem',\n          onAction: function () {\n            return onAction(item.value);\n          },\n          onSetup: onSetupToggle(editor, selections, format, item.value)\n        };\n      }\n    });\n  };\n\n  var applyTableCellStyle = function (editor, style) {\n    return function (value) {\n      var _a;\n\n      editor.execCommand('mceTableApplyCellStyle', false, (_a = {}, _a[style] = value, _a));\n    };\n  };\n\n  var filterNoneItem = function (list) {\n    return bind$2(list, function (item) {\n      if (isListGroup(item)) {\n        return [__assign(__assign({}, item), {\n          menu: filterNoneItem(item.menu)\n        })];\n      } else {\n        return isNotEmpty(item.value) ? [item] : [];\n      }\n    });\n  };\n\n  var generateMenuItemsCallback = function (editor, selections, items, format, onAction) {\n    return function (callback) {\n      return callback(buildMenuItems(editor, selections, items, format, onAction));\n    };\n  };\n\n  var buildColorMenu = function (editor, colorList, style) {\n    var colorMap = map$1(colorList, function (entry) {\n      return {\n        text: entry.title,\n        value: '#' + anyToHex(entry.value).value,\n        type: 'choiceitem'\n      };\n    });\n    return [{\n      type: 'fancymenuitem',\n      fancytype: 'colorswatch',\n      initData: {\n        colors: colorMap.length > 0 ? colorMap : undefined,\n        allowCustomColors: false\n      },\n      onAction: function (data) {\n        var _a;\n\n        var value = data.value === 'remove' ? '' : data.value;\n        editor.execCommand('mceTableApplyCellStyle', false, (_a = {}, _a[style] = value, _a));\n      }\n    }];\n  };\n\n  var changeRowHeader = function (editor) {\n    return function () {\n      var currentType = editor.queryCommandValue('mceTableRowType');\n      var newType = currentType === 'header' ? 'body' : 'header';\n      editor.execCommand('mceTableRowType', false, {\n        type: newType\n      });\n    };\n  };\n\n  var changeColumnHeader = function (editor) {\n    return function () {\n      var currentType = editor.queryCommandValue('mceTableColType');\n      var newType = currentType === 'th' ? 'td' : 'th';\n      editor.execCommand('mceTableColType', false, {\n        type: newType\n      });\n    };\n  };\n\n  var getClassList$1 = function (editor) {\n    var classes = buildListItems(getCellClassList(editor));\n\n    if (classes.length > 0) {\n      return Optional.some({\n        name: 'class',\n        type: 'listbox',\n        label: 'Class',\n        items: classes\n      });\n    }\n\n    return Optional.none();\n  };\n\n  var children = [{\n    name: 'width',\n    type: 'input',\n    label: 'Width'\n  }, {\n    name: 'height',\n    type: 'input',\n    label: 'Height'\n  }, {\n    name: 'celltype',\n    type: 'listbox',\n    label: 'Cell type',\n    items: [{\n      text: 'Cell',\n      value: 'td'\n    }, {\n      text: 'Header cell',\n      value: 'th'\n    }]\n  }, {\n    name: 'scope',\n    type: 'listbox',\n    label: 'Scope',\n    items: [{\n      text: 'None',\n      value: ''\n    }, {\n      text: 'Row',\n      value: 'row'\n    }, {\n      text: 'Column',\n      value: 'col'\n    }, {\n      text: 'Row group',\n      value: 'rowgroup'\n    }, {\n      text: 'Column group',\n      value: 'colgroup'\n    }]\n  }, {\n    name: 'halign',\n    type: 'listbox',\n    label: 'Horizontal align',\n    items: [{\n      text: 'None',\n      value: ''\n    }, {\n      text: 'Left',\n      value: 'left'\n    }, {\n      text: 'Center',\n      value: 'center'\n    }, {\n      text: 'Right',\n      value: 'right'\n    }]\n  }, {\n    name: 'valign',\n    type: 'listbox',\n    label: 'Vertical align',\n    items: verticalAlignValues\n  }];\n\n  var getItems$2 = function (editor) {\n    return children.concat(getClassList$1(editor).toArray());\n  };\n\n  var getAdvancedTab = function (editor, dialogName) {\n    var emptyBorderStyle = [{\n      text: 'Select...',\n      value: ''\n    }];\n    var advTabItems = [{\n      name: 'borderstyle',\n      type: 'listbox',\n      label: 'Border style',\n      items: emptyBorderStyle.concat(buildListItems(getTableBorderStyles(editor)))\n    }, {\n      name: 'bordercolor',\n      type: 'colorinput',\n      label: 'Border color'\n    }, {\n      name: 'backgroundcolor',\n      type: 'colorinput',\n      label: 'Background color'\n    }];\n    var borderWidth = {\n      name: 'borderwidth',\n      type: 'input',\n      label: 'Border width'\n    };\n    var items = dialogName === 'cell' ? [borderWidth].concat(advTabItems) : advTabItems;\n    return {\n      title: 'Advanced',\n      name: 'advanced',\n      items: items\n    };\n  };\n\n  var modifiers = function (testTruthy) {\n    return function (editor, node) {\n      var dom = editor.dom;\n\n      var setAttrib = function (attr, value) {\n        if (!testTruthy || value) {\n          dom.setAttrib(node, attr, value);\n        }\n      };\n\n      var setStyle = function (prop, value) {\n        if (!testTruthy || value) {\n          dom.setStyle(node, prop, value);\n        }\n      };\n\n      var setFormat = function (formatName, value) {\n        if (!testTruthy || value) {\n          if (value === '') {\n            editor.formatter.remove(formatName, {\n              value: null\n            }, node, true);\n          } else {\n            editor.formatter.apply(formatName, {\n              value: value\n            }, node);\n          }\n        }\n      };\n\n      return {\n        setAttrib: setAttrib,\n        setStyle: setStyle,\n        setFormat: setFormat\n      };\n    };\n  };\n\n  var DomModifier = {\n    normal: modifiers(false),\n    ifTruthy: modifiers(true)\n  };\n\n  var rgbToHex = function (dom) {\n    return function (value) {\n      return startsWith(value, 'rgb') ? dom.toHex(value) : value;\n    };\n  };\n\n  var extractAdvancedStyles = function (dom, elm) {\n    var element = SugarElement.fromDom(elm);\n    return {\n      borderwidth: getRaw$2(element, 'border-width').getOr(''),\n      borderstyle: getRaw$2(element, 'border-style').getOr(''),\n      bordercolor: getRaw$2(element, 'border-color').map(rgbToHex(dom)).getOr(''),\n      backgroundcolor: getRaw$2(element, 'background-color').map(rgbToHex(dom)).getOr('')\n    };\n  };\n\n  var getSharedValues = function (data) {\n    var baseData = data[0];\n    var comparisonData = data.slice(1);\n    each$2(comparisonData, function (items) {\n      each$2(keys(baseData), function (key) {\n        each$1(items, function (itemValue, itemKey) {\n          var comparisonValue = baseData[key];\n\n          if (comparisonValue !== '' && key === itemKey) {\n            if (comparisonValue !== itemValue) {\n              baseData[key] = '';\n            }\n          }\n        });\n      });\n    });\n    return baseData;\n  };\n\n  var getAlignment = function (formats, formatName, editor, elm) {\n    return find$1(formats, function (name) {\n      return !isUndefined(editor.formatter.matchNode(elm, formatName + name));\n    }).getOr('');\n  };\n\n  var getHAlignment = curry(getAlignment, ['left', 'center', 'right'], 'align');\n  var getVAlignment = curry(getAlignment, ['top', 'middle', 'bottom'], 'valign');\n\n  var extractDataFromSettings = function (editor, hasAdvTableTab) {\n    var style = getDefaultStyles(editor);\n    var attrs = getDefaultAttributes(editor);\n\n    var extractAdvancedStyleData = function (dom) {\n      return {\n        borderstyle: get$c(style, 'border-style').getOr(''),\n        bordercolor: rgbToHex(dom)(get$c(style, 'border-color').getOr('')),\n        backgroundcolor: rgbToHex(dom)(get$c(style, 'background-color').getOr(''))\n      };\n    };\n\n    var defaultData = {\n      height: '',\n      width: '100%',\n      cellspacing: '',\n      cellpadding: '',\n      caption: false,\n      class: '',\n      align: '',\n      border: ''\n    };\n\n    var getBorder = function () {\n      var borderWidth = style['border-width'];\n\n      if (shouldStyleWithCss(editor) && borderWidth) {\n        return {\n          border: borderWidth\n        };\n      }\n\n      return get$c(attrs, 'border').fold(function () {\n        return {};\n      }, function (border) {\n        return {\n          border: border\n        };\n      });\n    };\n\n    var advStyle = hasAdvTableTab ? extractAdvancedStyleData(editor.dom) : {};\n\n    var getCellPaddingCellSpacing = function () {\n      var spacing = get$c(style, 'border-spacing').or(get$c(attrs, 'cellspacing')).fold(function () {\n        return {};\n      }, function (cellspacing) {\n        return {\n          cellspacing: cellspacing\n        };\n      });\n      var padding = get$c(style, 'border-padding').or(get$c(attrs, 'cellpadding')).fold(function () {\n        return {};\n      }, function (cellpadding) {\n        return {\n          cellpadding: cellpadding\n        };\n      });\n      return __assign(__assign({}, spacing), padding);\n    };\n\n    var data = __assign(__assign(__assign(__assign(__assign(__assign({}, defaultData), style), attrs), advStyle), getBorder()), getCellPaddingCellSpacing());\n\n    return data;\n  };\n\n  var getRowType = function (elm) {\n    return table(SugarElement.fromDom(elm)).map(function (table) {\n      var target = {\n        selection: fromDom(elm.cells)\n      };\n      return getRowsType(table, target);\n    }).getOr('');\n  };\n\n  var extractDataFromTableElement = function (editor, elm, hasAdvTableTab) {\n    var getBorder = function (dom, elm) {\n      var optBorderWidth = getRaw$2(SugarElement.fromDom(elm), 'border-width');\n\n      if (shouldStyleWithCss(editor) && optBorderWidth.isSome()) {\n        return optBorderWidth.getOr('');\n      }\n\n      return dom.getAttrib(elm, 'border') || getTDTHOverallStyle(editor.dom, elm, 'border-width') || getTDTHOverallStyle(editor.dom, elm, 'border');\n    };\n\n    var dom = editor.dom;\n    var cellspacing = shouldStyleWithCss(editor) ? dom.getStyle(elm, 'border-spacing') || dom.getAttrib(elm, 'cellspacing') : dom.getAttrib(elm, 'cellspacing') || dom.getStyle(elm, 'border-spacing');\n    var cellpadding = shouldStyleWithCss(editor) ? getTDTHOverallStyle(dom, elm, 'padding') || dom.getAttrib(elm, 'cellpadding') : dom.getAttrib(elm, 'cellpadding') || getTDTHOverallStyle(dom, elm, 'padding');\n    return __assign({\n      width: dom.getStyle(elm, 'width') || dom.getAttrib(elm, 'width'),\n      height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n      cellspacing: cellspacing,\n      cellpadding: cellpadding,\n      border: getBorder(dom, elm),\n      caption: !!dom.select('caption', elm)[0],\n      class: dom.getAttrib(elm, 'class', ''),\n      align: getHAlignment(editor, elm)\n    }, hasAdvTableTab ? extractAdvancedStyles(dom, elm) : {});\n  };\n\n  var extractDataFromRowElement = function (editor, elm, hasAdvancedRowTab) {\n    var dom = editor.dom;\n    return __assign({\n      height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n      class: dom.getAttrib(elm, 'class', ''),\n      type: getRowType(elm),\n      align: getHAlignment(editor, elm)\n    }, hasAdvancedRowTab ? extractAdvancedStyles(dom, elm) : {});\n  };\n\n  var extractDataFromCellElement = function (editor, cell, hasAdvancedCellTab, column) {\n    var dom = editor.dom;\n    var colElm = column.getOr(cell);\n\n    var getStyle = function (element, style) {\n      return dom.getStyle(element, style) || dom.getAttrib(element, style);\n    };\n\n    return __assign({\n      width: getStyle(colElm, 'width'),\n      height: getStyle(cell, 'height'),\n      scope: dom.getAttrib(cell, 'scope'),\n      celltype: getNodeName(cell),\n      class: dom.getAttrib(cell, 'class', ''),\n      halign: getHAlignment(editor, cell),\n      valign: getVAlignment(editor, cell)\n    }, hasAdvancedCellTab ? extractAdvancedStyles(dom, cell) : {});\n  };\n\n  var getSelectedCells = function (table, cells) {\n    var warehouse = Warehouse.fromTable(table);\n    var allCells = Warehouse.justCells(warehouse);\n    var filtered = filter$2(allCells, function (cellA) {\n      return exists(cells, function (cellB) {\n        return eq$1(cellA.element, cellB);\n      });\n    });\n    return map$1(filtered, function (cell) {\n      return {\n        element: cell.element.dom,\n        column: Warehouse.getColumnAt(warehouse, cell.column).map(function (col) {\n          return col.element.dom;\n        })\n      };\n    });\n  };\n\n  var updateSimpleProps$1 = function (modifier, colModifier, data) {\n    modifier.setAttrib('scope', data.scope);\n    modifier.setAttrib('class', data.class);\n    modifier.setStyle('height', addPxSuffix(data.height));\n    colModifier.setStyle('width', addPxSuffix(data.width));\n  };\n\n  var updateAdvancedProps$1 = function (modifier, data) {\n    modifier.setFormat('tablecellbackgroundcolor', data.backgroundcolor);\n    modifier.setFormat('tablecellbordercolor', data.bordercolor);\n    modifier.setFormat('tablecellborderstyle', data.borderstyle);\n    modifier.setFormat('tablecellborderwidth', addPxSuffix(data.borderwidth));\n  };\n\n  var applyStyleData$1 = function (editor, cells, data) {\n    var isSingleCell = cells.length === 1;\n    each$2(cells, function (item) {\n      var cellElm = item.element;\n      var modifier = isSingleCell ? DomModifier.normal(editor, cellElm) : DomModifier.ifTruthy(editor, cellElm);\n      var colModifier = item.column.map(function (col) {\n        return isSingleCell ? DomModifier.normal(editor, col) : DomModifier.ifTruthy(editor, col);\n      }).getOr(modifier);\n      updateSimpleProps$1(modifier, colModifier, data);\n\n      if (hasAdvancedCellTab(editor)) {\n        updateAdvancedProps$1(modifier, data);\n      }\n\n      if (isSingleCell) {\n        unApplyAlign(editor, cellElm);\n        unApplyVAlign(editor, cellElm);\n      }\n\n      if (data.halign) {\n        applyAlign(editor, cellElm, data.halign);\n      }\n\n      if (data.valign) {\n        applyVAlign(editor, cellElm, data.valign);\n      }\n    });\n  };\n\n  var applyStructureData$1 = function (editor, data) {\n    editor.execCommand('mceTableCellType', false, {\n      type: data.celltype,\n      no_events: true\n    });\n  };\n\n  var applyCellData = function (editor, cells, oldData, data) {\n    var modifiedData = filter$1(data, function (value, key) {\n      return oldData[key] !== value;\n    });\n\n    if (size(modifiedData) > 0 && cells.length >= 1) {\n      table(cells[0]).each(function (table) {\n        var selectedCells = getSelectedCells(table, cells);\n        var styleModified = size(filter$1(modifiedData, function (_value, key) {\n          return key !== 'scope' && key !== 'celltype';\n        })) > 0;\n        var structureModified = has$1(modifiedData, 'celltype');\n\n        if (styleModified || has$1(modifiedData, 'scope')) {\n          applyStyleData$1(editor, selectedCells, data);\n        }\n\n        if (structureModified) {\n          applyStructureData$1(editor, data);\n        }\n\n        fireTableModified(editor, table.dom, {\n          structure: structureModified,\n          style: styleModified\n        });\n      });\n    }\n  };\n\n  var onSubmitCellForm = function (editor, cells, oldData, api) {\n    var data = api.getData();\n    api.close();\n    editor.undoManager.transact(function () {\n      applyCellData(editor, cells, oldData, data);\n      editor.focus();\n    });\n  };\n\n  var getData = function (editor, cells) {\n    var cellsData = table(cells[0]).map(function (table) {\n      return map$1(getSelectedCells(table, cells), function (item) {\n        return extractDataFromCellElement(editor, item.element, hasAdvancedCellTab(editor), item.column);\n      });\n    });\n    return getSharedValues(cellsData.getOrDie());\n  };\n\n  var open$2 = function (editor, selections) {\n    var cells = getCellsFromSelection(selections);\n\n    if (cells.length === 0) {\n      return;\n    }\n\n    var data = getData(editor, cells);\n    var dialogTabPanel = {\n      type: 'tabpanel',\n      tabs: [{\n        title: 'General',\n        name: 'general',\n        items: getItems$2(editor)\n      }, getAdvancedTab(editor, 'cell')]\n    };\n    var dialogPanel = {\n      type: 'panel',\n      items: [{\n        type: 'grid',\n        columns: 2,\n        items: getItems$2(editor)\n      }]\n    };\n    editor.windowManager.open({\n      title: 'Cell Properties',\n      size: 'normal',\n      body: hasAdvancedCellTab(editor) ? dialogTabPanel : dialogPanel,\n      buttons: [{\n        type: 'cancel',\n        name: 'cancel',\n        text: 'Cancel'\n      }, {\n        type: 'submit',\n        name: 'save',\n        text: 'Save',\n        primary: true\n      }],\n      initialData: data,\n      onSubmit: curry(onSubmitCellForm, editor, cells, data)\n    });\n  };\n\n  var getClassList = function (editor) {\n    var classes = buildListItems(getRowClassList(editor));\n\n    if (classes.length > 0) {\n      return Optional.some({\n        name: 'class',\n        type: 'listbox',\n        label: 'Class',\n        items: classes\n      });\n    }\n\n    return Optional.none();\n  };\n\n  var formChildren = [{\n    type: 'listbox',\n    name: 'type',\n    label: 'Row type',\n    items: [{\n      text: 'Header',\n      value: 'header'\n    }, {\n      text: 'Body',\n      value: 'body'\n    }, {\n      text: 'Footer',\n      value: 'footer'\n    }]\n  }, {\n    type: 'listbox',\n    name: 'align',\n    label: 'Alignment',\n    items: [{\n      text: 'None',\n      value: ''\n    }, {\n      text: 'Left',\n      value: 'left'\n    }, {\n      text: 'Center',\n      value: 'center'\n    }, {\n      text: 'Right',\n      value: 'right'\n    }]\n  }, {\n    label: 'Height',\n    name: 'height',\n    type: 'input'\n  }];\n\n  var getItems$1 = function (editor) {\n    return formChildren.concat(getClassList(editor).toArray());\n  };\n\n  var updateSimpleProps = function (modifier, data) {\n    modifier.setAttrib('class', data.class);\n    modifier.setStyle('height', addPxSuffix(data.height));\n  };\n\n  var updateAdvancedProps = function (modifier, data) {\n    modifier.setStyle('background-color', data.backgroundcolor);\n    modifier.setStyle('border-color', data.bordercolor);\n    modifier.setStyle('border-style', data.borderstyle);\n  };\n\n  var applyStyleData = function (editor, rows, data, oldData) {\n    var isSingleRow = rows.length === 1;\n    each$2(rows, function (rowElm) {\n      var modifier = isSingleRow ? DomModifier.normal(editor, rowElm) : DomModifier.ifTruthy(editor, rowElm);\n      updateSimpleProps(modifier, data);\n\n      if (hasAdvancedRowTab(editor)) {\n        updateAdvancedProps(modifier, data);\n      }\n\n      if (data.align !== oldData.align) {\n        unApplyAlign(editor, rowElm);\n        applyAlign(editor, rowElm, data.align);\n      }\n    });\n  };\n\n  var applyStructureData = function (editor, data) {\n    editor.execCommand('mceTableRowType', false, {\n      type: data.type,\n      no_events: true\n    });\n  };\n\n  var applyRowData = function (editor, rows, oldData, data) {\n    var modifiedData = filter$1(data, function (value, key) {\n      return oldData[key] !== value;\n    });\n\n    if (size(modifiedData) > 0) {\n      var typeModified_1 = has$1(modifiedData, 'type');\n      var styleModified_1 = typeModified_1 ? size(modifiedData) > 1 : true;\n\n      if (styleModified_1) {\n        applyStyleData(editor, rows, data, oldData);\n      }\n\n      if (typeModified_1) {\n        applyStructureData(editor, data);\n      }\n\n      table(SugarElement.fromDom(rows[0])).each(function (table) {\n        return fireTableModified(editor, table.dom, {\n          structure: typeModified_1,\n          style: styleModified_1\n        });\n      });\n    }\n  };\n\n  var onSubmitRowForm = function (editor, rows, oldData, api) {\n    var data = api.getData();\n    api.close();\n    editor.undoManager.transact(function () {\n      applyRowData(editor, rows, oldData, data);\n      editor.focus();\n    });\n  };\n\n  var open$1 = function (editor) {\n    var rows = getRowsFromSelection(getSelectionStart(editor), ephemera.selected);\n\n    if (rows.length === 0) {\n      return;\n    }\n\n    var rowsData = map$1(rows, function (rowElm) {\n      return extractDataFromRowElement(editor, rowElm.dom, hasAdvancedRowTab(editor));\n    });\n    var data = getSharedValues(rowsData);\n    var dialogTabPanel = {\n      type: 'tabpanel',\n      tabs: [{\n        title: 'General',\n        name: 'general',\n        items: getItems$1(editor)\n      }, getAdvancedTab(editor, 'row')]\n    };\n    var dialogPanel = {\n      type: 'panel',\n      items: [{\n        type: 'grid',\n        columns: 2,\n        items: getItems$1(editor)\n      }]\n    };\n    editor.windowManager.open({\n      title: 'Row Properties',\n      size: 'normal',\n      body: hasAdvancedRowTab(editor) ? dialogTabPanel : dialogPanel,\n      buttons: [{\n        type: 'cancel',\n        name: 'cancel',\n        text: 'Cancel'\n      }, {\n        type: 'submit',\n        name: 'save',\n        text: 'Save',\n        primary: true\n      }],\n      initialData: data,\n      onSubmit: curry(onSubmitRowForm, editor, map$1(rows, function (r) {\n        return r.dom;\n      }), data)\n    });\n  };\n\n  var getItems = function (editor, classes, insertNewTable) {\n    var rowColCountItems = !insertNewTable ? [] : [{\n      type: 'input',\n      name: 'cols',\n      label: 'Cols',\n      inputMode: 'numeric'\n    }, {\n      type: 'input',\n      name: 'rows',\n      label: 'Rows',\n      inputMode: 'numeric'\n    }];\n    var alwaysItems = [{\n      type: 'input',\n      name: 'width',\n      label: 'Width'\n    }, {\n      type: 'input',\n      name: 'height',\n      label: 'Height'\n    }];\n    var appearanceItems = hasAppearanceOptions(editor) ? [{\n      type: 'input',\n      name: 'cellspacing',\n      label: 'Cell spacing',\n      inputMode: 'numeric'\n    }, {\n      type: 'input',\n      name: 'cellpadding',\n      label: 'Cell padding',\n      inputMode: 'numeric'\n    }, {\n      type: 'input',\n      name: 'border',\n      label: 'Border width'\n    }, {\n      type: 'label',\n      label: 'Caption',\n      items: [{\n        type: 'checkbox',\n        name: 'caption',\n        label: 'Show caption'\n      }]\n    }] : [];\n    var alignmentItem = [{\n      type: 'listbox',\n      name: 'align',\n      label: 'Alignment',\n      items: [{\n        text: 'None',\n        value: ''\n      }, {\n        text: 'Left',\n        value: 'left'\n      }, {\n        text: 'Center',\n        value: 'center'\n      }, {\n        text: 'Right',\n        value: 'right'\n      }]\n    }];\n    var classListItem = classes.length > 0 ? [{\n      type: 'listbox',\n      name: 'class',\n      label: 'Class',\n      items: classes\n    }] : [];\n    return rowColCountItems.concat(alwaysItems).concat(appearanceItems).concat(alignmentItem).concat(classListItem);\n  };\n\n  var styleTDTH = function (dom, elm, name, value) {\n    if (elm.tagName === 'TD' || elm.tagName === 'TH') {\n      if (isString(name)) {\n        dom.setStyle(elm, name, value);\n      } else {\n        dom.setStyle(elm, name);\n      }\n    } else {\n      if (elm.children) {\n        for (var i = 0; i < elm.children.length; i++) {\n          styleTDTH(dom, elm.children[i], name, value);\n        }\n      }\n    }\n  };\n\n  var applyDataToElement = function (editor, tableElm, data) {\n    var dom = editor.dom;\n    var attrs = {};\n    var styles = {};\n    attrs.class = data.class;\n    styles.height = addPxSuffix(data.height);\n\n    if (dom.getAttrib(tableElm, 'width') && !shouldStyleWithCss(editor)) {\n      attrs.width = removePxSuffix(data.width);\n    } else {\n      styles.width = addPxSuffix(data.width);\n    }\n\n    if (shouldStyleWithCss(editor)) {\n      styles['border-width'] = addPxSuffix(data.border);\n      styles['border-spacing'] = addPxSuffix(data.cellspacing);\n    } else {\n      attrs.border = data.border;\n      attrs.cellpadding = data.cellpadding;\n      attrs.cellspacing = data.cellspacing;\n    }\n\n    if (shouldStyleWithCss(editor) && tableElm.children) {\n      for (var i = 0; i < tableElm.children.length; i++) {\n        styleTDTH(dom, tableElm.children[i], {\n          'border-width': addPxSuffix(data.border),\n          'padding': addPxSuffix(data.cellpadding)\n        });\n\n        if (hasAdvancedTableTab(editor)) {\n          styleTDTH(dom, tableElm.children[i], {\n            'border-color': data.bordercolor\n          });\n        }\n      }\n    }\n\n    if (hasAdvancedTableTab(editor)) {\n      styles['background-color'] = data.backgroundcolor;\n      styles['border-color'] = data.bordercolor;\n      styles['border-style'] = data.borderstyle;\n    }\n\n    attrs.style = dom.serializeStyle(__assign(__assign({}, getDefaultStyles(editor)), styles));\n    dom.setAttribs(tableElm, __assign(__assign({}, getDefaultAttributes(editor)), attrs));\n  };\n\n  var onSubmitTableForm = function (editor, tableElm, oldData, api) {\n    var dom = editor.dom;\n    var data = api.getData();\n    var modifiedData = filter$1(data, function (value, key) {\n      return oldData[key] !== value;\n    });\n    api.close();\n\n    if (data.class === '') {\n      delete data.class;\n    }\n\n    editor.undoManager.transact(function () {\n      if (!tableElm) {\n        var cols = parseInt(data.cols, 10) || 1;\n        var rows = parseInt(data.rows, 10) || 1;\n        tableElm = insert(editor, cols, rows, 0, 0);\n      }\n\n      if (size(modifiedData) > 0) {\n        applyDataToElement(editor, tableElm, data);\n        var captionElm = dom.select('caption', tableElm)[0];\n\n        if (captionElm && !data.caption || !captionElm && data.caption) {\n          editor.execCommand('mceTableToggleCaption');\n        }\n\n        if (data.align === '') {\n          unApplyAlign(editor, tableElm);\n        } else {\n          applyAlign(editor, tableElm, data.align);\n        }\n      }\n\n      editor.focus();\n      editor.addVisual();\n\n      if (size(modifiedData) > 0) {\n        var captionModified = has$1(modifiedData, 'caption');\n        var styleModified = captionModified ? size(modifiedData) > 1 : true;\n        fireTableModified(editor, tableElm, {\n          structure: captionModified,\n          style: styleModified\n        });\n      }\n    });\n  };\n\n  var open = function (editor, insertNewTable) {\n    var dom = editor.dom;\n    var tableElm;\n    var data = extractDataFromSettings(editor, hasAdvancedTableTab(editor));\n\n    if (insertNewTable === false) {\n      tableElm = dom.getParent(editor.selection.getStart(), 'table', editor.getBody());\n\n      if (tableElm) {\n        data = extractDataFromTableElement(editor, tableElm, hasAdvancedTableTab(editor));\n      } else {\n        if (hasAdvancedTableTab(editor)) {\n          data.borderstyle = '';\n          data.bordercolor = '';\n          data.backgroundcolor = '';\n        }\n      }\n    } else {\n      data.cols = '1';\n      data.rows = '1';\n\n      if (hasAdvancedTableTab(editor)) {\n        data.borderstyle = '';\n        data.bordercolor = '';\n        data.backgroundcolor = '';\n      }\n    }\n\n    var classes = buildListItems(getTableClassList(editor));\n\n    if (classes.length > 0) {\n      if (data.class) {\n        data.class = data.class.replace(/\\s*mce\\-item\\-table\\s*/g, '');\n      }\n    }\n\n    var generalPanel = {\n      type: 'grid',\n      columns: 2,\n      items: getItems(editor, classes, insertNewTable)\n    };\n\n    var nonAdvancedForm = function () {\n      return {\n        type: 'panel',\n        items: [generalPanel]\n      };\n    };\n\n    var advancedForm = function () {\n      return {\n        type: 'tabpanel',\n        tabs: [{\n          title: 'General',\n          name: 'general',\n          items: [generalPanel]\n        }, getAdvancedTab(editor, 'table')]\n      };\n    };\n\n    var dialogBody = hasAdvancedTableTab(editor) ? advancedForm() : nonAdvancedForm();\n    editor.windowManager.open({\n      title: 'Table Properties',\n      size: 'normal',\n      body: dialogBody,\n      onSubmit: curry(onSubmitTableForm, editor, tableElm, data),\n      buttons: [{\n        type: 'cancel',\n        name: 'cancel',\n        text: 'Cancel'\n      }, {\n        type: 'submit',\n        name: 'save',\n        text: 'Save',\n        primary: true\n      }],\n      initialData: data\n    });\n  };\n\n  var getSelectionStartCellOrCaption = function (editor) {\n    return getSelectionCellOrCaption(getSelectionStart(editor), getIsRoot(editor));\n  };\n\n  var getSelectionStartCell = function (editor) {\n    return getSelectionCell(getSelectionStart(editor), getIsRoot(editor));\n  };\n\n  var registerCommands = function (editor, actions, cellSelection, selections, clipboard) {\n    var isRoot = getIsRoot(editor);\n\n    var eraseTable = function () {\n      return getSelectionStartCellOrCaption(editor).each(function (cellOrCaption) {\n        table(cellOrCaption, isRoot).filter(not(isRoot)).each(function (table) {\n          var cursor = SugarElement.fromText('');\n          after$5(table, cursor);\n          remove$5(table);\n\n          if (editor.dom.isEmpty(editor.getBody())) {\n            editor.setContent('');\n            editor.selection.setCursorLocation();\n          } else {\n            var rng = editor.dom.createRng();\n            rng.setStart(cursor.dom, 0);\n            rng.setEnd(cursor.dom, 0);\n            editor.selection.setRng(rng);\n            editor.nodeChanged();\n          }\n        });\n      });\n    };\n\n    var setSizingMode = function (sizing) {\n      return getSelectionStartCellOrCaption(editor).each(function (cellOrCaption) {\n        var isForcedSizing = isResponsiveForced(editor) || isPixelsForced(editor) || isPercentagesForced(editor);\n\n        if (!isForcedSizing) {\n          table(cellOrCaption, isRoot).each(function (table) {\n            if (sizing === 'relative' && !isPercentSizing(table)) {\n              enforcePercentage(table);\n            } else if (sizing === 'fixed' && !isPixelSizing(table)) {\n              enforcePixels(table);\n            } else if (sizing === 'responsive' && !isNoneSizing(table)) {\n              enforceNone(table);\n            }\n\n            removeDataStyle(table);\n            fireTableModified(editor, table.dom, structureModified);\n          });\n        }\n      });\n    };\n\n    var getTableFromCell = function (cell) {\n      return table(cell, isRoot);\n    };\n\n    var performActionOnSelection = function (action) {\n      return getSelectionStartCell(editor).bind(function (cell) {\n        return getTableFromCell(cell).map(function (table) {\n          return action(table, cell);\n        });\n      });\n    };\n\n    var toggleTableClass = function (_ui, clazz) {\n      performActionOnSelection(function (table) {\n        editor.formatter.toggle('tableclass', {\n          value: clazz\n        }, table.dom);\n        fireTableModified(editor, table.dom, styleModified);\n      });\n    };\n\n    var toggleTableCellClass = function (_ui, clazz) {\n      performActionOnSelection(function (table) {\n        var selectedCells = getCellsFromSelection(selections);\n        var allHaveClass = forall(selectedCells, function (cell) {\n          return editor.formatter.match('tablecellclass', {\n            value: clazz\n          }, cell.dom);\n        });\n        var formatterAction = allHaveClass ? editor.formatter.remove : editor.formatter.apply;\n        each$2(selectedCells, function (cell) {\n          return formatterAction('tablecellclass', {\n            value: clazz\n          }, cell.dom);\n        });\n        fireTableModified(editor, table.dom, styleModified);\n      });\n    };\n\n    var toggleCaption = function () {\n      getSelectionStartCellOrCaption(editor).each(function (cellOrCaption) {\n        table(cellOrCaption, isRoot).each(function (table) {\n          child$1(table, 'caption').fold(function () {\n            var caption = SugarElement.fromTag('caption');\n            append$1(caption, SugarElement.fromText('Caption'));\n            appendAt(table, caption, 0);\n            editor.selection.setCursorLocation(caption.dom, 0);\n          }, function (caption) {\n            if (isTag('caption')(cellOrCaption)) {\n              one('td', table).each(function (td) {\n                return editor.selection.setCursorLocation(td.dom, 0);\n              });\n            }\n\n            remove$5(caption);\n          });\n          fireTableModified(editor, table.dom, structureModified);\n        });\n      });\n    };\n\n    var postExecute = function (_data) {\n      editor.focus();\n    };\n\n    var actOnSelection = function (execute, noEvents) {\n      if (noEvents === void 0) {\n        noEvents = false;\n      }\n\n      return performActionOnSelection(function (table, startCell) {\n        var targets = forMenu(selections, table, startCell);\n        execute(table, targets, noEvents).each(postExecute);\n      });\n    };\n\n    var copyRowSelection = function () {\n      return performActionOnSelection(function (table, startCell) {\n        var targets = forMenu(selections, table, startCell);\n        var generators = cellOperations(noop, SugarElement.fromDom(editor.getDoc()), Optional.none());\n        return copyRows(table, targets, generators);\n      });\n    };\n\n    var copyColSelection = function () {\n      return performActionOnSelection(function (table, startCell) {\n        var targets = forMenu(selections, table, startCell);\n        return copyCols(table, targets);\n      });\n    };\n\n    var pasteOnSelection = function (execute, getRows) {\n      return getRows().each(function (rows) {\n        var clonedRows = map$1(rows, function (row) {\n          return deep(row);\n        });\n        performActionOnSelection(function (table, startCell) {\n          var generators = paste$1(SugarElement.fromDom(editor.getDoc()));\n          var targets = pasteRows(selections, startCell, clonedRows, generators);\n          execute(table, targets).each(postExecute);\n        });\n      });\n    };\n\n    var actOnType = function (getAction) {\n      return function (_ui, args) {\n        return get$c(args, 'type').each(function (type) {\n          actOnSelection(getAction(type), args.no_events);\n        });\n      };\n    };\n\n    each$1({\n      mceTableSplitCells: function () {\n        return actOnSelection(actions.unmergeCells);\n      },\n      mceTableMergeCells: function () {\n        return actOnSelection(actions.mergeCells);\n      },\n      mceTableInsertRowBefore: function () {\n        return actOnSelection(actions.insertRowsBefore);\n      },\n      mceTableInsertRowAfter: function () {\n        return actOnSelection(actions.insertRowsAfter);\n      },\n      mceTableInsertColBefore: function () {\n        return actOnSelection(actions.insertColumnsBefore);\n      },\n      mceTableInsertColAfter: function () {\n        return actOnSelection(actions.insertColumnsAfter);\n      },\n      mceTableDeleteCol: function () {\n        return actOnSelection(actions.deleteColumn);\n      },\n      mceTableDeleteRow: function () {\n        return actOnSelection(actions.deleteRow);\n      },\n      mceTableCutCol: function () {\n        return copyColSelection().each(function (selection) {\n          clipboard.setColumns(selection);\n          actOnSelection(actions.deleteColumn);\n        });\n      },\n      mceTableCutRow: function () {\n        return copyRowSelection().each(function (selection) {\n          clipboard.setRows(selection);\n          actOnSelection(actions.deleteRow);\n        });\n      },\n      mceTableCopyCol: function () {\n        return copyColSelection().each(function (selection) {\n          return clipboard.setColumns(selection);\n        });\n      },\n      mceTableCopyRow: function () {\n        return copyRowSelection().each(function (selection) {\n          return clipboard.setRows(selection);\n        });\n      },\n      mceTablePasteColBefore: function () {\n        return pasteOnSelection(actions.pasteColsBefore, clipboard.getColumns);\n      },\n      mceTablePasteColAfter: function () {\n        return pasteOnSelection(actions.pasteColsAfter, clipboard.getColumns);\n      },\n      mceTablePasteRowBefore: function () {\n        return pasteOnSelection(actions.pasteRowsBefore, clipboard.getRows);\n      },\n      mceTablePasteRowAfter: function () {\n        return pasteOnSelection(actions.pasteRowsAfter, clipboard.getRows);\n      },\n      mceTableDelete: eraseTable,\n      mceTableCellToggleClass: toggleTableCellClass,\n      mceTableToggleClass: toggleTableClass,\n      mceTableToggleCaption: toggleCaption,\n      mceTableSizingMode: function (_ui, sizing) {\n        return setSizingMode(sizing);\n      },\n      mceTableCellType: actOnType(function (type) {\n        return type === 'th' ? actions.makeCellsHeader : actions.unmakeCellsHeader;\n      }),\n      mceTableColType: actOnType(function (type) {\n        return type === 'th' ? actions.makeColumnsHeader : actions.unmakeColumnsHeader;\n      }),\n      mceTableRowType: actOnType(function (type) {\n        switch (type) {\n          case 'header':\n            return actions.makeRowsHeader;\n\n          case 'footer':\n            return actions.makeRowsFooter;\n\n          default:\n            return actions.makeRowsBody;\n        }\n      })\n    }, function (func, name) {\n      return editor.addCommand(name, func);\n    });\n    each$1({\n      mceTableProps: curry(open, editor, false),\n      mceTableRowProps: curry(open$1, editor),\n      mceTableCellProps: curry(open$2, editor, selections)\n    }, function (func, name) {\n      return editor.addCommand(name, function () {\n        return func();\n      });\n    });\n    editor.addCommand('mceInsertTable', function (_ui, args) {\n      if (isObject(args) && keys(args).length > 0) {\n        insertTableWithDataValidation(editor, args.rows, args.columns, args.options, 'Invalid values for mceInsertTable - rows and columns values are required to insert a table.');\n      } else {\n        open(editor, true);\n      }\n    });\n    editor.addCommand('mceTableApplyCellStyle', function (_ui, args) {\n      var getFormatName = function (style) {\n        return 'tablecell' + style.toLowerCase().replace('-', '');\n      };\n\n      if (!isObject(args)) {\n        return;\n      }\n\n      var cells = getCellsFromSelection(selections);\n\n      if (cells.length === 0) {\n        return;\n      }\n\n      var validArgs = filter$1(args, function (value, style) {\n        return editor.formatter.has(getFormatName(style)) && isString(value);\n      });\n\n      if (isEmpty(validArgs)) {\n        return;\n      }\n\n      each$1(validArgs, function (value, style) {\n        each$2(cells, function (cell) {\n          DomModifier.normal(editor, cell.dom).setFormat(getFormatName(style), value);\n        });\n      });\n      getTableFromCell(cells[0]).each(function (table) {\n        return fireTableModified(editor, table.dom, styleModified);\n      });\n    });\n  };\n\n  var registerQueryCommands = function (editor, actions, selections) {\n    var isRoot = getIsRoot(editor);\n\n    var lookupOnSelection = function (action) {\n      return getSelectionCell(getSelectionStart(editor)).bind(function (cell) {\n        return table(cell, isRoot).map(function (table) {\n          var targets = forMenu(selections, table, cell);\n          return action(table, targets);\n        });\n      }).getOr('');\n    };\n\n    each$1({\n      mceTableRowType: function () {\n        return lookupOnSelection(actions.getTableRowType);\n      },\n      mceTableCellType: function () {\n        return lookupOnSelection(actions.getTableCellType);\n      },\n      mceTableColType: function () {\n        return lookupOnSelection(actions.getTableColType);\n      }\n    }, function (func, name) {\n      return editor.addQueryValueHandler(name, func);\n    });\n  };\n\n  var Clipboard = function () {\n    var rows = value();\n    var cols = value();\n    return {\n      getRows: rows.get,\n      setRows: function (r) {\n        r.fold(rows.clear, rows.set);\n        cols.clear();\n      },\n      clearRows: rows.clear,\n      getColumns: cols.get,\n      setColumns: function (c) {\n        c.fold(cols.clear, cols.set);\n        rows.clear();\n      },\n      clearColumns: cols.clear\n    };\n  };\n\n  var genericBase = {\n    remove_similar: true,\n    inherit: false\n  };\n\n  var cellBase = __assign({\n    selector: 'td,th'\n  }, genericBase);\n\n  var cellFormats = {\n    tablecellbackgroundcolor: __assign({\n      styles: {\n        backgroundColor: '%value'\n      }\n    }, cellBase),\n    tablecellverticalalign: __assign({\n      styles: {\n        'vertical-align': '%value'\n      }\n    }, cellBase),\n    tablecellbordercolor: __assign({\n      styles: {\n        borderColor: '%value'\n      }\n    }, cellBase),\n    tablecellclass: __assign({\n      classes: ['%value']\n    }, cellBase),\n    tableclass: __assign({\n      selector: 'table',\n      classes: ['%value']\n    }, genericBase),\n    tablecellborderstyle: __assign({\n      styles: {\n        borderStyle: '%value'\n      }\n    }, cellBase),\n    tablecellborderwidth: __assign({\n      styles: {\n        borderWidth: '%value'\n      }\n    }, cellBase)\n  };\n\n  var registerFormats = function (editor) {\n    editor.formatter.register(cellFormats);\n  };\n\n  var adt$5 = Adt.generate([{\n    none: ['current']\n  }, {\n    first: ['current']\n  }, {\n    middle: ['current', 'target']\n  }, {\n    last: ['current']\n  }]);\n\n  var none = function (current) {\n    if (current === void 0) {\n      current = undefined;\n    }\n\n    return adt$5.none(current);\n  };\n\n  var CellLocation = __assign(__assign({}, adt$5), {\n    none: none\n  });\n\n  var walk = function (all, current, index, direction, isEligible) {\n    if (isEligible === void 0) {\n      isEligible = always;\n    }\n\n    var forwards = direction === 1;\n\n    if (!forwards && index <= 0) {\n      return CellLocation.first(all[0]);\n    } else if (forwards && index >= all.length - 1) {\n      return CellLocation.last(all[all.length - 1]);\n    } else {\n      var newIndex = index + direction;\n      var elem = all[newIndex];\n      return isEligible(elem) ? CellLocation.middle(current, elem) : walk(all, current, newIndex, direction, isEligible);\n    }\n  };\n\n  var detect$1 = function (current, isRoot) {\n    return table(current, isRoot).bind(function (table) {\n      var all = cells$1(table);\n      var index = findIndex(all, function (x) {\n        return eq$1(current, x);\n      });\n      return index.map(function (index) {\n        return {\n          index: index,\n          all: all\n        };\n      });\n    });\n  };\n\n  var next = function (current, isEligible, isRoot) {\n    var detection = detect$1(current, isRoot);\n    return detection.fold(function () {\n      return CellLocation.none(current);\n    }, function (info) {\n      return walk(info.all, current, info.index, 1, isEligible);\n    });\n  };\n\n  var prev = function (current, isEligible, isRoot) {\n    var detection = detect$1(current, isRoot);\n    return detection.fold(function () {\n      return CellLocation.none();\n    }, function (info) {\n      return walk(info.all, current, info.index, -1, isEligible);\n    });\n  };\n\n  var create$2 = function (start, soffset, finish, foffset) {\n    return {\n      start: start,\n      soffset: soffset,\n      finish: finish,\n      foffset: foffset\n    };\n  };\n\n  var SimRange = {\n    create: create$2\n  };\n  var adt$4 = Adt.generate([{\n    before: ['element']\n  }, {\n    on: ['element', 'offset']\n  }, {\n    after: ['element']\n  }]);\n\n  var cata$1 = function (subject, onBefore, onOn, onAfter) {\n    return subject.fold(onBefore, onOn, onAfter);\n  };\n\n  var getStart$1 = function (situ) {\n    return situ.fold(identity, identity, identity);\n  };\n\n  var before$2 = adt$4.before;\n  var on = adt$4.on;\n  var after$3 = adt$4.after;\n  var Situ = {\n    before: before$2,\n    on: on,\n    after: after$3,\n    cata: cata$1,\n    getStart: getStart$1\n  };\n  var adt$3 = Adt.generate([{\n    domRange: ['rng']\n  }, {\n    relative: ['startSitu', 'finishSitu']\n  }, {\n    exact: ['start', 'soffset', 'finish', 'foffset']\n  }]);\n\n  var exactFromRange = function (simRange) {\n    return adt$3.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n  };\n\n  var getStart = function (selection) {\n    return selection.match({\n      domRange: function (rng) {\n        return SugarElement.fromDom(rng.startContainer);\n      },\n      relative: function (startSitu, _finishSitu) {\n        return Situ.getStart(startSitu);\n      },\n      exact: function (start, _soffset, _finish, _foffset) {\n        return start;\n      }\n    });\n  };\n\n  var domRange = adt$3.domRange;\n  var relative = adt$3.relative;\n  var exact = adt$3.exact;\n\n  var getWin = function (selection) {\n    var start = getStart(selection);\n    return defaultView(start);\n  };\n\n  var range = SimRange.create;\n  var SimSelection = {\n    domRange: domRange,\n    relative: relative,\n    exact: exact,\n    exactFromRange: exactFromRange,\n    getWin: getWin,\n    range: range\n  };\n\n  var selectNode = function (win, element) {\n    var rng = win.document.createRange();\n    rng.selectNode(element.dom);\n    return rng;\n  };\n\n  var selectNodeContents = function (win, element) {\n    var rng = win.document.createRange();\n    selectNodeContentsUsing(rng, element);\n    return rng;\n  };\n\n  var selectNodeContentsUsing = function (rng, element) {\n    return rng.selectNodeContents(element.dom);\n  };\n\n  var setStart = function (rng, situ) {\n    situ.fold(function (e) {\n      rng.setStartBefore(e.dom);\n    }, function (e, o) {\n      rng.setStart(e.dom, o);\n    }, function (e) {\n      rng.setStartAfter(e.dom);\n    });\n  };\n\n  var setFinish = function (rng, situ) {\n    situ.fold(function (e) {\n      rng.setEndBefore(e.dom);\n    }, function (e, o) {\n      rng.setEnd(e.dom, o);\n    }, function (e) {\n      rng.setEndAfter(e.dom);\n    });\n  };\n\n  var relativeToNative = function (win, startSitu, finishSitu) {\n    var range = win.document.createRange();\n    setStart(range, startSitu);\n    setFinish(range, finishSitu);\n    return range;\n  };\n\n  var exactToNative = function (win, start, soffset, finish, foffset) {\n    var rng = win.document.createRange();\n    rng.setStart(start.dom, soffset);\n    rng.setEnd(finish.dom, foffset);\n    return rng;\n  };\n\n  var toRect = function (rect) {\n    return {\n      left: rect.left,\n      top: rect.top,\n      right: rect.right,\n      bottom: rect.bottom,\n      width: rect.width,\n      height: rect.height\n    };\n  };\n\n  var getFirstRect$1 = function (rng) {\n    var rects = rng.getClientRects();\n    var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n    return rect.width > 0 || rect.height > 0 ? Optional.some(rect).map(toRect) : Optional.none();\n  };\n\n  var adt$2 = Adt.generate([{\n    ltr: ['start', 'soffset', 'finish', 'foffset']\n  }, {\n    rtl: ['start', 'soffset', 'finish', 'foffset']\n  }]);\n\n  var fromRange = function (win, type, range) {\n    return type(SugarElement.fromDom(range.startContainer), range.startOffset, SugarElement.fromDom(range.endContainer), range.endOffset);\n  };\n\n  var getRanges = function (win, selection) {\n    return selection.match({\n      domRange: function (rng) {\n        return {\n          ltr: constant(rng),\n          rtl: Optional.none\n        };\n      },\n      relative: function (startSitu, finishSitu) {\n        return {\n          ltr: cached(function () {\n            return relativeToNative(win, startSitu, finishSitu);\n          }),\n          rtl: cached(function () {\n            return Optional.some(relativeToNative(win, finishSitu, startSitu));\n          })\n        };\n      },\n      exact: function (start, soffset, finish, foffset) {\n        return {\n          ltr: cached(function () {\n            return exactToNative(win, start, soffset, finish, foffset);\n          }),\n          rtl: cached(function () {\n            return Optional.some(exactToNative(win, finish, foffset, start, soffset));\n          })\n        };\n      }\n    });\n  };\n\n  var doDiagnose = function (win, ranges) {\n    var rng = ranges.ltr();\n\n    if (rng.collapsed) {\n      var reversed = ranges.rtl().filter(function (rev) {\n        return rev.collapsed === false;\n      });\n      return reversed.map(function (rev) {\n        return adt$2.rtl(SugarElement.fromDom(rev.endContainer), rev.endOffset, SugarElement.fromDom(rev.startContainer), rev.startOffset);\n      }).getOrThunk(function () {\n        return fromRange(win, adt$2.ltr, rng);\n      });\n    } else {\n      return fromRange(win, adt$2.ltr, rng);\n    }\n  };\n\n  var diagnose = function (win, selection) {\n    var ranges = getRanges(win, selection);\n    return doDiagnose(win, ranges);\n  };\n\n  var asLtrRange = function (win, selection) {\n    var diagnosis = diagnose(win, selection);\n    return diagnosis.match({\n      ltr: function (start, soffset, finish, foffset) {\n        var rng = win.document.createRange();\n        rng.setStart(start.dom, soffset);\n        rng.setEnd(finish.dom, foffset);\n        return rng;\n      },\n      rtl: function (start, soffset, finish, foffset) {\n        var rng = win.document.createRange();\n        rng.setStart(finish.dom, foffset);\n        rng.setEnd(start.dom, soffset);\n        return rng;\n      }\n    });\n  };\n\n  adt$2.ltr;\n  adt$2.rtl;\n\n  var searchForPoint = function (rectForOffset, x, y, maxX, length) {\n    if (length === 0) {\n      return 0;\n    } else if (x === maxX) {\n      return length - 1;\n    }\n\n    var xDelta = maxX;\n\n    for (var i = 1; i < length; i++) {\n      var rect = rectForOffset(i);\n      var curDeltaX = Math.abs(x - rect.left);\n\n      if (y <= rect.bottom) {\n        if (y < rect.top || curDeltaX > xDelta) {\n          return i - 1;\n        } else {\n          xDelta = curDeltaX;\n        }\n      }\n    }\n\n    return 0;\n  };\n\n  var inRect = function (rect, x, y) {\n    return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;\n  };\n\n  var locateOffset = function (doc, textnode, x, y, rect) {\n    var rangeForOffset = function (o) {\n      var r = doc.dom.createRange();\n      r.setStart(textnode.dom, o);\n      r.collapse(true);\n      return r;\n    };\n\n    var rectForOffset = function (o) {\n      var r = rangeForOffset(o);\n      return r.getBoundingClientRect();\n    };\n\n    var length = get$9(textnode).length;\n    var offset = searchForPoint(rectForOffset, x, y, rect.right, length);\n    return rangeForOffset(offset);\n  };\n\n  var locate$1 = function (doc, node, x, y) {\n    var r = doc.dom.createRange();\n    r.selectNode(node.dom);\n    var rects = r.getClientRects();\n    var foundRect = findMap(rects, function (rect) {\n      return inRect(rect, x, y) ? Optional.some(rect) : Optional.none();\n    });\n    return foundRect.map(function (rect) {\n      return locateOffset(doc, node, x, y, rect);\n    });\n  };\n\n  var searchInChildren = function (doc, node, x, y) {\n    var r = doc.dom.createRange();\n    var nodes = children$3(node);\n    return findMap(nodes, function (n) {\n      r.selectNode(n.dom);\n      return inRect(r.getBoundingClientRect(), x, y) ? locateNode(doc, n, x, y) : Optional.none();\n    });\n  };\n\n  var locateNode = function (doc, node, x, y) {\n    return isText(node) ? locate$1(doc, node, x, y) : searchInChildren(doc, node, x, y);\n  };\n\n  var locate = function (doc, node, x, y) {\n    var r = doc.dom.createRange();\n    r.selectNode(node.dom);\n    var rect = r.getBoundingClientRect();\n    var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n    var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n    return locateNode(doc, node, boundedX, boundedY);\n  };\n\n  var COLLAPSE_TO_LEFT = true;\n  var COLLAPSE_TO_RIGHT = false;\n\n  var getCollapseDirection = function (rect, x) {\n    return x - rect.left < rect.right - x ? COLLAPSE_TO_LEFT : COLLAPSE_TO_RIGHT;\n  };\n\n  var createCollapsedNode = function (doc, target, collapseDirection) {\n    var r = doc.dom.createRange();\n    r.selectNode(target.dom);\n    r.collapse(collapseDirection);\n    return r;\n  };\n\n  var locateInElement = function (doc, node, x) {\n    var cursorRange = doc.dom.createRange();\n    cursorRange.selectNode(node.dom);\n    var rect = cursorRange.getBoundingClientRect();\n    var collapseDirection = getCollapseDirection(rect, x);\n    var f = collapseDirection === COLLAPSE_TO_LEFT ? first : last$1;\n    return f(node).map(function (target) {\n      return createCollapsedNode(doc, target, collapseDirection);\n    });\n  };\n\n  var locateInEmpty = function (doc, node, x) {\n    var rect = node.dom.getBoundingClientRect();\n    var collapseDirection = getCollapseDirection(rect, x);\n    return Optional.some(createCollapsedNode(doc, node, collapseDirection));\n  };\n\n  var search = function (doc, node, x) {\n    var f = children$3(node).length === 0 ? locateInEmpty : locateInElement;\n    return f(doc, node, x);\n  };\n\n  var caretPositionFromPoint = function (doc, x, y) {\n    var _a, _b;\n\n    return Optional.from((_b = (_a = doc.dom).caretPositionFromPoint) === null || _b === void 0 ? void 0 : _b.call(_a, x, y)).bind(function (pos) {\n      if (pos.offsetNode === null) {\n        return Optional.none();\n      }\n\n      var r = doc.dom.createRange();\n      r.setStart(pos.offsetNode, pos.offset);\n      r.collapse();\n      return Optional.some(r);\n    });\n  };\n\n  var caretRangeFromPoint = function (doc, x, y) {\n    var _a, _b;\n\n    return Optional.from((_b = (_a = doc.dom).caretRangeFromPoint) === null || _b === void 0 ? void 0 : _b.call(_a, x, y));\n  };\n\n  var searchTextNodes = function (doc, node, x, y) {\n    var r = doc.dom.createRange();\n    r.selectNode(node.dom);\n    var rect = r.getBoundingClientRect();\n    var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n    var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n    return locate(doc, node, boundedX, boundedY);\n  };\n\n  var searchFromPoint = function (doc, x, y) {\n    return SugarElement.fromPoint(doc, x, y).bind(function (elem) {\n      var fallback = function () {\n        return search(doc, elem, x);\n      };\n\n      return children$3(elem).length === 0 ? fallback() : searchTextNodes(doc, elem, x, y).orThunk(fallback);\n    });\n  };\n\n  var availableSearch = function () {\n    if (document.caretPositionFromPoint) {\n      return caretPositionFromPoint;\n    } else if (document.caretRangeFromPoint) {\n      return caretRangeFromPoint;\n    } else {\n      return searchFromPoint;\n    }\n  }();\n\n  var fromPoint = function (win, x, y) {\n    var doc = SugarElement.fromDom(win.document);\n    return availableSearch(doc, x, y).map(function (rng) {\n      return SimRange.create(SugarElement.fromDom(rng.startContainer), rng.startOffset, SugarElement.fromDom(rng.endContainer), rng.endOffset);\n    });\n  };\n\n  var beforeSpecial = function (element, offset) {\n    var name$1 = name(element);\n\n    if ('input' === name$1) {\n      return Situ.after(element);\n    } else if (!contains$2(['br', 'img'], name$1)) {\n      return Situ.on(element, offset);\n    } else {\n      return offset === 0 ? Situ.before(element) : Situ.after(element);\n    }\n  };\n\n  var preprocessRelative = function (startSitu, finishSitu) {\n    var start = startSitu.fold(Situ.before, beforeSpecial, Situ.after);\n    var finish = finishSitu.fold(Situ.before, beforeSpecial, Situ.after);\n    return SimSelection.relative(start, finish);\n  };\n\n  var preprocessExact = function (start, soffset, finish, foffset) {\n    var startSitu = beforeSpecial(start, soffset);\n    var finishSitu = beforeSpecial(finish, foffset);\n    return SimSelection.relative(startSitu, finishSitu);\n  };\n\n  var preprocess = function (selection) {\n    return selection.match({\n      domRange: function (rng) {\n        var start = SugarElement.fromDom(rng.startContainer);\n        var finish = SugarElement.fromDom(rng.endContainer);\n        return preprocessExact(start, rng.startOffset, finish, rng.endOffset);\n      },\n      relative: preprocessRelative,\n      exact: preprocessExact\n    });\n  };\n\n  var makeRange = function (start, soffset, finish, foffset) {\n    var doc = owner(start);\n    var rng = doc.dom.createRange();\n    rng.setStart(start.dom, soffset);\n    rng.setEnd(finish.dom, foffset);\n    return rng;\n  };\n\n  var after$2 = function (start, soffset, finish, foffset) {\n    var r = makeRange(start, soffset, finish, foffset);\n    var same = eq$1(start, finish) && soffset === foffset;\n    return r.collapsed && !same;\n  };\n\n  var getNativeSelection = function (win) {\n    return Optional.from(win.getSelection());\n  };\n\n  var doSetNativeRange = function (win, rng) {\n    getNativeSelection(win).each(function (selection) {\n      selection.removeAllRanges();\n      selection.addRange(rng);\n    });\n  };\n\n  var doSetRange = function (win, start, soffset, finish, foffset) {\n    var rng = exactToNative(win, start, soffset, finish, foffset);\n    doSetNativeRange(win, rng);\n  };\n\n  var setLegacyRtlRange = function (win, selection, start, soffset, finish, foffset) {\n    selection.collapse(start.dom, soffset);\n    selection.extend(finish.dom, foffset);\n  };\n\n  var setRangeFromRelative = function (win, relative) {\n    return diagnose(win, relative).match({\n      ltr: function (start, soffset, finish, foffset) {\n        doSetRange(win, start, soffset, finish, foffset);\n      },\n      rtl: function (start, soffset, finish, foffset) {\n        getNativeSelection(win).each(function (selection) {\n          if (selection.setBaseAndExtent) {\n            selection.setBaseAndExtent(start.dom, soffset, finish.dom, foffset);\n          } else if (selection.extend) {\n            try {\n              setLegacyRtlRange(win, selection, start, soffset, finish, foffset);\n            } catch (e) {\n              doSetRange(win, finish, foffset, start, soffset);\n            }\n          } else {\n            doSetRange(win, finish, foffset, start, soffset);\n          }\n        });\n      }\n    });\n  };\n\n  var setExact = function (win, start, soffset, finish, foffset) {\n    var relative = preprocessExact(start, soffset, finish, foffset);\n    setRangeFromRelative(win, relative);\n  };\n\n  var setRelative = function (win, startSitu, finishSitu) {\n    var relative = preprocessRelative(startSitu, finishSitu);\n    setRangeFromRelative(win, relative);\n  };\n\n  var toNative = function (selection) {\n    var win = SimSelection.getWin(selection).dom;\n\n    var getDomRange = function (start, soffset, finish, foffset) {\n      return exactToNative(win, start, soffset, finish, foffset);\n    };\n\n    var filtered = preprocess(selection);\n    return diagnose(win, filtered).match({\n      ltr: getDomRange,\n      rtl: getDomRange\n    });\n  };\n\n  var readRange = function (selection) {\n    if (selection.rangeCount > 0) {\n      var firstRng = selection.getRangeAt(0);\n      var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n      return Optional.some(SimRange.create(SugarElement.fromDom(firstRng.startContainer), firstRng.startOffset, SugarElement.fromDom(lastRng.endContainer), lastRng.endOffset));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var doGetExact = function (selection) {\n    if (selection.anchorNode === null || selection.focusNode === null) {\n      return readRange(selection);\n    } else {\n      var anchor = SugarElement.fromDom(selection.anchorNode);\n      var focus_1 = SugarElement.fromDom(selection.focusNode);\n      return after$2(anchor, selection.anchorOffset, focus_1, selection.focusOffset) ? Optional.some(SimRange.create(anchor, selection.anchorOffset, focus_1, selection.focusOffset)) : readRange(selection);\n    }\n  };\n\n  var setToElement = function (win, element, selectNodeContents$1) {\n    if (selectNodeContents$1 === void 0) {\n      selectNodeContents$1 = true;\n    }\n\n    var rngGetter = selectNodeContents$1 ? selectNodeContents : selectNode;\n    var rng = rngGetter(win, element);\n    doSetNativeRange(win, rng);\n  };\n\n  var getExact = function (win) {\n    return getNativeSelection(win).filter(function (sel) {\n      return sel.rangeCount > 0;\n    }).bind(doGetExact);\n  };\n\n  var get$1 = function (win) {\n    return getExact(win).map(function (range) {\n      return SimSelection.exact(range.start, range.soffset, range.finish, range.foffset);\n    });\n  };\n\n  var getFirstRect = function (win, selection) {\n    var rng = asLtrRange(win, selection);\n    return getFirstRect$1(rng);\n  };\n\n  var getAtPoint = function (win, x, y) {\n    return fromPoint(win, x, y);\n  };\n\n  var clear = function (win) {\n    getNativeSelection(win).each(function (selection) {\n      return selection.removeAllRanges();\n    });\n  };\n\n  var global$1 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n  var forward = function (editor, isRoot, cell) {\n    return go$1(editor, isRoot, next(cell, isEditable$1));\n  };\n\n  var backward = function (editor, isRoot, cell) {\n    return go$1(editor, isRoot, prev(cell, isEditable$1));\n  };\n\n  var getCellFirstCursorPosition = function (editor, cell) {\n    var selection = SimSelection.exact(cell, 0, cell, 0);\n    return toNative(selection);\n  };\n\n  var go$1 = function (editor, isRoot, cell) {\n    return cell.fold(Optional.none, Optional.none, function (current, next) {\n      return first(next).map(function (cell) {\n        return getCellFirstCursorPosition(editor, cell);\n      });\n    }, function (current) {\n      editor.execCommand('mceTableInsertRowAfter');\n      return forward(editor, isRoot, current);\n    });\n  };\n\n  var rootElements = ['table', 'li', 'dl'];\n\n  var handle$1 = function (event, editor, cellSelection) {\n    if (event.keyCode === global$1.TAB) {\n      var body_1 = getBody(editor);\n\n      var isRoot_1 = function (element) {\n        var name$1 = name(element);\n        return eq$1(element, body_1) || contains$2(rootElements, name$1);\n      };\n\n      var rng = editor.selection.getRng();\n      var container = SugarElement.fromDom(event.shiftKey ? rng.startContainer : rng.endContainer);\n      cell(container, isRoot_1).each(function (cell) {\n        event.preventDefault();\n        table(cell, isRoot_1).each(cellSelection.clear);\n        editor.selection.collapse(event.shiftKey);\n        var navigation = event.shiftKey ? backward : forward;\n        var rng = navigation(editor, isRoot_1, cell);\n        rng.each(function (range) {\n          editor.selection.setRng(range);\n        });\n      });\n    }\n  };\n\n  var create$1 = function (selection, kill) {\n    return {\n      selection: selection,\n      kill: kill\n    };\n  };\n\n  var Response = {\n    create: create$1\n  };\n\n  var create = function (start, soffset, finish, foffset) {\n    return {\n      start: Situ.on(start, soffset),\n      finish: Situ.on(finish, foffset)\n    };\n  };\n\n  var Situs = {\n    create: create\n  };\n\n  var convertToRange = function (win, selection) {\n    var rng = asLtrRange(win, selection);\n    return SimRange.create(SugarElement.fromDom(rng.startContainer), rng.startOffset, SugarElement.fromDom(rng.endContainer), rng.endOffset);\n  };\n\n  var makeSitus = Situs.create;\n\n  var sync = function (container, isRoot, start, soffset, finish, foffset, selectRange) {\n    if (!(eq$1(start, finish) && soffset === foffset)) {\n      return closest$1(start, 'td,th', isRoot).bind(function (s) {\n        return closest$1(finish, 'td,th', isRoot).bind(function (f) {\n          return detect(container, isRoot, s, f, selectRange);\n        });\n      });\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var detect = function (container, isRoot, start, finish, selectRange) {\n    if (!eq$1(start, finish)) {\n      return identify(start, finish, isRoot).bind(function (cellSel) {\n        var boxes = cellSel.boxes.getOr([]);\n\n        if (boxes.length > 1) {\n          selectRange(container, boxes, cellSel.start, cellSel.finish);\n          return Optional.some(Response.create(Optional.some(makeSitus(start, 0, start, getEnd(start))), true));\n        } else {\n          return Optional.none();\n        }\n      });\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var update = function (rows, columns, container, selected, annotations) {\n    var updateSelection = function (newSels) {\n      annotations.clearBeforeUpdate(container);\n      annotations.selectRange(container, newSels.boxes, newSels.start, newSels.finish);\n      return newSels.boxes;\n    };\n\n    return shiftSelection(selected, rows, columns, annotations.firstSelectedSelector, annotations.lastSelectedSelector).map(updateSelection);\n  };\n\n  var traverse = function (item, mode) {\n    return {\n      item: item,\n      mode: mode\n    };\n  };\n\n  var backtrack = function (universe, item, _direction, transition) {\n    if (transition === void 0) {\n      transition = sidestep;\n    }\n\n    return universe.property().parent(item).map(function (p) {\n      return traverse(p, transition);\n    });\n  };\n\n  var sidestep = function (universe, item, direction, transition) {\n    if (transition === void 0) {\n      transition = advance;\n    }\n\n    return direction.sibling(universe, item).map(function (p) {\n      return traverse(p, transition);\n    });\n  };\n\n  var advance = function (universe, item, direction, transition) {\n    if (transition === void 0) {\n      transition = advance;\n    }\n\n    var children = universe.property().children(item);\n    var result = direction.first(children);\n    return result.map(function (r) {\n      return traverse(r, transition);\n    });\n  };\n\n  var successors = [{\n    current: backtrack,\n    next: sidestep,\n    fallback: Optional.none()\n  }, {\n    current: sidestep,\n    next: advance,\n    fallback: Optional.some(backtrack)\n  }, {\n    current: advance,\n    next: advance,\n    fallback: Optional.some(sidestep)\n  }];\n\n  var go = function (universe, item, mode, direction, rules) {\n    if (rules === void 0) {\n      rules = successors;\n    }\n\n    var ruleOpt = find$1(rules, function (succ) {\n      return succ.current === mode;\n    });\n    return ruleOpt.bind(function (rule) {\n      return rule.current(universe, item, direction, rule.next).orThunk(function () {\n        return rule.fallback.bind(function (fb) {\n          return go(universe, item, fb, direction);\n        });\n      });\n    });\n  };\n\n  var left$1 = function () {\n    var sibling = function (universe, item) {\n      return universe.query().prevSibling(item);\n    };\n\n    var first = function (children) {\n      return children.length > 0 ? Optional.some(children[children.length - 1]) : Optional.none();\n    };\n\n    return {\n      sibling: sibling,\n      first: first\n    };\n  };\n\n  var right$1 = function () {\n    var sibling = function (universe, item) {\n      return universe.query().nextSibling(item);\n    };\n\n    var first = function (children) {\n      return children.length > 0 ? Optional.some(children[0]) : Optional.none();\n    };\n\n    return {\n      sibling: sibling,\n      first: first\n    };\n  };\n\n  var Walkers = {\n    left: left$1,\n    right: right$1\n  };\n\n  var hone = function (universe, item, predicate, mode, direction, isRoot) {\n    var next = go(universe, item, mode, direction);\n    return next.bind(function (n) {\n      if (isRoot(n.item)) {\n        return Optional.none();\n      } else {\n        return predicate(n.item) ? Optional.some(n.item) : hone(universe, n.item, predicate, n.mode, direction, isRoot);\n      }\n    });\n  };\n\n  var left = function (universe, item, predicate, isRoot) {\n    return hone(universe, item, predicate, sidestep, Walkers.left(), isRoot);\n  };\n\n  var right = function (universe, item, predicate, isRoot) {\n    return hone(universe, item, predicate, sidestep, Walkers.right(), isRoot);\n  };\n\n  var isLeaf = function (universe) {\n    return function (element) {\n      return universe.property().children(element).length === 0;\n    };\n  };\n\n  var before$1 = function (universe, item, isRoot) {\n    return seekLeft$1(universe, item, isLeaf(universe), isRoot);\n  };\n\n  var after$1 = function (universe, item, isRoot) {\n    return seekRight$1(universe, item, isLeaf(universe), isRoot);\n  };\n\n  var seekLeft$1 = left;\n  var seekRight$1 = right;\n  var universe = DomUniverse();\n\n  var before = function (element, isRoot) {\n    return before$1(universe, element, isRoot);\n  };\n\n  var after = function (element, isRoot) {\n    return after$1(universe, element, isRoot);\n  };\n\n  var seekLeft = function (element, predicate, isRoot) {\n    return seekLeft$1(universe, element, predicate, isRoot);\n  };\n\n  var seekRight = function (element, predicate, isRoot) {\n    return seekRight$1(universe, element, predicate, isRoot);\n  };\n\n  var ancestor = function (scope, predicate, isRoot) {\n    return ancestor$2(scope, predicate, isRoot).isSome();\n  };\n\n  var adt$1 = Adt.generate([{\n    none: ['message']\n  }, {\n    success: []\n  }, {\n    failedUp: ['cell']\n  }, {\n    failedDown: ['cell']\n  }]);\n\n  var isOverlapping = function (bridge, before, after) {\n    var beforeBounds = bridge.getRect(before);\n    var afterBounds = bridge.getRect(after);\n    return afterBounds.right > beforeBounds.left && afterBounds.left < beforeBounds.right;\n  };\n\n  var isRow = function (elem) {\n    return closest$1(elem, 'tr');\n  };\n\n  var verify = function (bridge, before, beforeOffset, after, afterOffset, failure, isRoot) {\n    return closest$1(after, 'td,th', isRoot).bind(function (afterCell) {\n      return closest$1(before, 'td,th', isRoot).map(function (beforeCell) {\n        if (!eq$1(afterCell, beforeCell)) {\n          return sharedOne(isRow, [afterCell, beforeCell]).fold(function () {\n            return isOverlapping(bridge, beforeCell, afterCell) ? adt$1.success() : failure(beforeCell);\n          }, function (_sharedRow) {\n            return failure(beforeCell);\n          });\n        } else {\n          return eq$1(after, afterCell) && getEnd(afterCell) === afterOffset ? failure(beforeCell) : adt$1.none('in same cell');\n        }\n      });\n    }).getOr(adt$1.none('default'));\n  };\n\n  var cata = function (subject, onNone, onSuccess, onFailedUp, onFailedDown) {\n    return subject.fold(onNone, onSuccess, onFailedUp, onFailedDown);\n  };\n\n  var BeforeAfter = __assign(__assign({}, adt$1), {\n    verify: verify,\n    cata: cata\n  });\n\n  var inParent = function (parent, children, element, index) {\n    return {\n      parent: parent,\n      children: children,\n      element: element,\n      index: index\n    };\n  };\n\n  var indexInParent = function (element) {\n    return parent(element).bind(function (parent) {\n      var children = children$3(parent);\n      return indexOf(children, element).map(function (index) {\n        return inParent(parent, children, element, index);\n      });\n    });\n  };\n\n  var indexOf = function (elements, element) {\n    return findIndex(elements, curry(eq$1, element));\n  };\n\n  var isBr = function (elem) {\n    return name(elem) === 'br';\n  };\n\n  var gatherer = function (cand, gather, isRoot) {\n    return gather(cand, isRoot).bind(function (target) {\n      return isText(target) && get$9(target).trim().length === 0 ? gatherer(target, gather, isRoot) : Optional.some(target);\n    });\n  };\n\n  var handleBr = function (isRoot, element, direction) {\n    return direction.traverse(element).orThunk(function () {\n      return gatherer(element, direction.gather, isRoot);\n    }).map(direction.relative);\n  };\n\n  var findBr = function (element, offset) {\n    return child$3(element, offset).filter(isBr).orThunk(function () {\n      return child$3(element, offset - 1).filter(isBr);\n    });\n  };\n\n  var handleParent = function (isRoot, element, offset, direction) {\n    return findBr(element, offset).bind(function (br) {\n      return direction.traverse(br).fold(function () {\n        return gatherer(br, direction.gather, isRoot).map(direction.relative);\n      }, function (adjacent) {\n        return indexInParent(adjacent).map(function (info) {\n          return Situ.on(info.parent, info.index);\n        });\n      });\n    });\n  };\n\n  var tryBr = function (isRoot, element, offset, direction) {\n    var target = isBr(element) ? handleBr(isRoot, element, direction) : handleParent(isRoot, element, offset, direction);\n    return target.map(function (tgt) {\n      return {\n        start: tgt,\n        finish: tgt\n      };\n    });\n  };\n\n  var process = function (analysis) {\n    return BeforeAfter.cata(analysis, function (_message) {\n      return Optional.none();\n    }, function () {\n      return Optional.none();\n    }, function (cell) {\n      return Optional.some(point(cell, 0));\n    }, function (cell) {\n      return Optional.some(point(cell, getEnd(cell)));\n    });\n  };\n\n  var moveDown = function (caret, amount) {\n    return {\n      left: caret.left,\n      top: caret.top + amount,\n      right: caret.right,\n      bottom: caret.bottom + amount\n    };\n  };\n\n  var moveUp = function (caret, amount) {\n    return {\n      left: caret.left,\n      top: caret.top - amount,\n      right: caret.right,\n      bottom: caret.bottom - amount\n    };\n  };\n\n  var translate = function (caret, xDelta, yDelta) {\n    return {\n      left: caret.left + xDelta,\n      top: caret.top + yDelta,\n      right: caret.right + xDelta,\n      bottom: caret.bottom + yDelta\n    };\n  };\n\n  var getTop = function (caret) {\n    return caret.top;\n  };\n\n  var getBottom = function (caret) {\n    return caret.bottom;\n  };\n\n  var getPartialBox = function (bridge, element, offset) {\n    if (offset >= 0 && offset < getEnd(element)) {\n      return bridge.getRangedRect(element, offset, element, offset + 1);\n    } else if (offset > 0) {\n      return bridge.getRangedRect(element, offset - 1, element, offset);\n    }\n\n    return Optional.none();\n  };\n\n  var toCaret = function (rect) {\n    return {\n      left: rect.left,\n      top: rect.top,\n      right: rect.right,\n      bottom: rect.bottom\n    };\n  };\n\n  var getElemBox = function (bridge, element) {\n    return Optional.some(bridge.getRect(element));\n  };\n\n  var getBoxAt = function (bridge, element, offset) {\n    if (isElement(element)) {\n      return getElemBox(bridge, element).map(toCaret);\n    } else if (isText(element)) {\n      return getPartialBox(bridge, element, offset).map(toCaret);\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var getEntireBox = function (bridge, element) {\n    if (isElement(element)) {\n      return getElemBox(bridge, element).map(toCaret);\n    } else if (isText(element)) {\n      return bridge.getRangedRect(element, 0, element, getEnd(element)).map(toCaret);\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var JUMP_SIZE = 5;\n  var NUM_RETRIES = 100;\n  var adt = Adt.generate([{\n    none: []\n  }, {\n    retry: ['caret']\n  }]);\n\n  var isOutside = function (caret, box) {\n    return caret.left < box.left || Math.abs(box.right - caret.left) < 1 || caret.left > box.right;\n  };\n\n  var inOutsideBlock = function (bridge, element, caret) {\n    return closest$2(element, isBlock).fold(never, function (cell) {\n      return getEntireBox(bridge, cell).exists(function (box) {\n        return isOutside(caret, box);\n      });\n    });\n  };\n\n  var adjustDown = function (bridge, element, guessBox, original, caret) {\n    var lowerCaret = moveDown(caret, JUMP_SIZE);\n\n    if (Math.abs(guessBox.bottom - original.bottom) < 1) {\n      return adt.retry(lowerCaret);\n    } else if (guessBox.top > caret.bottom) {\n      return adt.retry(lowerCaret);\n    } else if (guessBox.top === caret.bottom) {\n      return adt.retry(moveDown(caret, 1));\n    } else {\n      return inOutsideBlock(bridge, element, caret) ? adt.retry(translate(lowerCaret, JUMP_SIZE, 0)) : adt.none();\n    }\n  };\n\n  var adjustUp = function (bridge, element, guessBox, original, caret) {\n    var higherCaret = moveUp(caret, JUMP_SIZE);\n\n    if (Math.abs(guessBox.top - original.top) < 1) {\n      return adt.retry(higherCaret);\n    } else if (guessBox.bottom < caret.top) {\n      return adt.retry(higherCaret);\n    } else if (guessBox.bottom === caret.top) {\n      return adt.retry(moveUp(caret, 1));\n    } else {\n      return inOutsideBlock(bridge, element, caret) ? adt.retry(translate(higherCaret, JUMP_SIZE, 0)) : adt.none();\n    }\n  };\n\n  var upMovement = {\n    point: getTop,\n    adjuster: adjustUp,\n    move: moveUp,\n    gather: before\n  };\n  var downMovement = {\n    point: getBottom,\n    adjuster: adjustDown,\n    move: moveDown,\n    gather: after\n  };\n\n  var isAtTable = function (bridge, x, y) {\n    return bridge.elementFromPoint(x, y).filter(function (elm) {\n      return name(elm) === 'table';\n    }).isSome();\n  };\n\n  var adjustForTable = function (bridge, movement, original, caret, numRetries) {\n    return adjustTil(bridge, movement, original, movement.move(caret, JUMP_SIZE), numRetries);\n  };\n\n  var adjustTil = function (bridge, movement, original, caret, numRetries) {\n    if (numRetries === 0) {\n      return Optional.some(caret);\n    }\n\n    if (isAtTable(bridge, caret.left, movement.point(caret))) {\n      return adjustForTable(bridge, movement, original, caret, numRetries - 1);\n    }\n\n    return bridge.situsFromPoint(caret.left, movement.point(caret)).bind(function (guess) {\n      return guess.start.fold(Optional.none, function (element) {\n        return getEntireBox(bridge, element).bind(function (guessBox) {\n          return movement.adjuster(bridge, element, guessBox, original, caret).fold(Optional.none, function (newCaret) {\n            return adjustTil(bridge, movement, original, newCaret, numRetries - 1);\n          });\n        }).orThunk(function () {\n          return Optional.some(caret);\n        });\n      }, Optional.none);\n    });\n  };\n\n  var ieTryDown = function (bridge, caret) {\n    return bridge.situsFromPoint(caret.left, caret.bottom + JUMP_SIZE);\n  };\n\n  var ieTryUp = function (bridge, caret) {\n    return bridge.situsFromPoint(caret.left, caret.top - JUMP_SIZE);\n  };\n\n  var checkScroll = function (movement, adjusted, bridge) {\n    if (movement.point(adjusted) > bridge.getInnerHeight()) {\n      return Optional.some(movement.point(adjusted) - bridge.getInnerHeight());\n    } else if (movement.point(adjusted) < 0) {\n      return Optional.some(-movement.point(adjusted));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var retry = function (movement, bridge, caret) {\n    var moved = movement.move(caret, JUMP_SIZE);\n    var adjusted = adjustTil(bridge, movement, caret, moved, NUM_RETRIES).getOr(moved);\n    return checkScroll(movement, adjusted, bridge).fold(function () {\n      return bridge.situsFromPoint(adjusted.left, movement.point(adjusted));\n    }, function (delta) {\n      bridge.scrollBy(0, delta);\n      return bridge.situsFromPoint(adjusted.left, movement.point(adjusted) - delta);\n    });\n  };\n\n  var Retries = {\n    tryUp: curry(retry, upMovement),\n    tryDown: curry(retry, downMovement),\n    ieTryUp: ieTryUp,\n    ieTryDown: ieTryDown,\n    getJumpSize: constant(JUMP_SIZE)\n  };\n  var MAX_RETRIES = 20;\n\n  var findSpot = function (bridge, isRoot, direction) {\n    return bridge.getSelection().bind(function (sel) {\n      return tryBr(isRoot, sel.finish, sel.foffset, direction).fold(function () {\n        return Optional.some(point(sel.finish, sel.foffset));\n      }, function (brNeighbour) {\n        var range = bridge.fromSitus(brNeighbour);\n        var analysis = BeforeAfter.verify(bridge, sel.finish, sel.foffset, range.finish, range.foffset, direction.failure, isRoot);\n        return process(analysis);\n      });\n    });\n  };\n\n  var scan = function (bridge, isRoot, element, offset, direction, numRetries) {\n    if (numRetries === 0) {\n      return Optional.none();\n    }\n\n    return tryCursor(bridge, isRoot, element, offset, direction).bind(function (situs) {\n      var range = bridge.fromSitus(situs);\n      var analysis = BeforeAfter.verify(bridge, element, offset, range.finish, range.foffset, direction.failure, isRoot);\n      return BeforeAfter.cata(analysis, function () {\n        return Optional.none();\n      }, function () {\n        return Optional.some(situs);\n      }, function (cell) {\n        if (eq$1(element, cell) && offset === 0) {\n          return tryAgain(bridge, element, offset, moveUp, direction);\n        } else {\n          return scan(bridge, isRoot, cell, 0, direction, numRetries - 1);\n        }\n      }, function (cell) {\n        if (eq$1(element, cell) && offset === getEnd(cell)) {\n          return tryAgain(bridge, element, offset, moveDown, direction);\n        } else {\n          return scan(bridge, isRoot, cell, getEnd(cell), direction, numRetries - 1);\n        }\n      });\n    });\n  };\n\n  var tryAgain = function (bridge, element, offset, move, direction) {\n    return getBoxAt(bridge, element, offset).bind(function (box) {\n      return tryAt(bridge, direction, move(box, Retries.getJumpSize()));\n    });\n  };\n\n  var tryAt = function (bridge, direction, box) {\n    var browser = detect$3().browser;\n\n    if (browser.isChrome() || browser.isSafari() || browser.isFirefox() || browser.isEdge()) {\n      return direction.otherRetry(bridge, box);\n    } else if (browser.isIE()) {\n      return direction.ieRetry(bridge, box);\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var tryCursor = function (bridge, isRoot, element, offset, direction) {\n    return getBoxAt(bridge, element, offset).bind(function (box) {\n      return tryAt(bridge, direction, box);\n    });\n  };\n\n  var handle = function (bridge, isRoot, direction) {\n    return findSpot(bridge, isRoot, direction).bind(function (spot) {\n      return scan(bridge, isRoot, spot.element, spot.offset, direction, MAX_RETRIES).map(bridge.fromSitus);\n    });\n  };\n\n  var inSameTable = function (elem, table) {\n    return ancestor(elem, function (e) {\n      return parent(e).exists(function (p) {\n        return eq$1(p, table);\n      });\n    });\n  };\n\n  var simulate = function (bridge, isRoot, direction, initial, anchor) {\n    return closest$1(initial, 'td,th', isRoot).bind(function (start) {\n      return closest$1(start, 'table', isRoot).bind(function (table) {\n        if (!inSameTable(anchor, table)) {\n          return Optional.none();\n        }\n\n        return handle(bridge, isRoot, direction).bind(function (range) {\n          return closest$1(range.finish, 'td,th', isRoot).map(function (finish) {\n            return {\n              start: start,\n              finish: finish,\n              range: range\n            };\n          });\n        });\n      });\n    });\n  };\n\n  var navigate = function (bridge, isRoot, direction, initial, anchor, precheck) {\n    if (detect$3().browser.isIE()) {\n      return Optional.none();\n    } else {\n      return precheck(initial, isRoot).orThunk(function () {\n        return simulate(bridge, isRoot, direction, initial, anchor).map(function (info) {\n          var range = info.range;\n          return Response.create(Optional.some(makeSitus(range.start, range.soffset, range.finish, range.foffset)), true);\n        });\n      });\n    }\n  };\n\n  var firstUpCheck = function (initial, isRoot) {\n    return closest$1(initial, 'tr', isRoot).bind(function (startRow) {\n      return closest$1(startRow, 'table', isRoot).bind(function (table) {\n        var rows = descendants(table, 'tr');\n\n        if (eq$1(startRow, rows[0])) {\n          return seekLeft(table, function (element) {\n            return last$1(element).isSome();\n          }, isRoot).map(function (last) {\n            var lastOffset = getEnd(last);\n            return Response.create(Optional.some(makeSitus(last, lastOffset, last, lastOffset)), true);\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n    });\n  };\n\n  var lastDownCheck = function (initial, isRoot) {\n    return closest$1(initial, 'tr', isRoot).bind(function (startRow) {\n      return closest$1(startRow, 'table', isRoot).bind(function (table) {\n        var rows = descendants(table, 'tr');\n\n        if (eq$1(startRow, rows[rows.length - 1])) {\n          return seekRight(table, function (element) {\n            return first(element).isSome();\n          }, isRoot).map(function (first) {\n            return Response.create(Optional.some(makeSitus(first, 0, first, 0)), true);\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n    });\n  };\n\n  var select = function (bridge, container, isRoot, direction, initial, anchor, selectRange) {\n    return simulate(bridge, isRoot, direction, initial, anchor).bind(function (info) {\n      return detect(container, isRoot, info.start, info.finish, selectRange);\n    });\n  };\n\n  var findCell = function (target, isRoot) {\n    return closest$1(target, 'td,th', isRoot);\n  };\n\n  var MouseSelection = function (bridge, container, isRoot, annotations) {\n    var cursor = value();\n    var clearstate = cursor.clear;\n\n    var applySelection = function (event) {\n      cursor.on(function (start) {\n        annotations.clearBeforeUpdate(container);\n        findCell(event.target, isRoot).each(function (finish) {\n          identify(start, finish, isRoot).each(function (cellSel) {\n            var boxes = cellSel.boxes.getOr([]);\n\n            if (boxes.length === 1) {\n              var singleCell = boxes[0];\n              var isNonEditableCell = getRaw(singleCell) === 'false';\n              var isCellClosestContentEditable = is(closest(event.target), singleCell, eq$1);\n\n              if (isNonEditableCell && isCellClosestContentEditable) {\n                annotations.selectRange(container, boxes, singleCell, singleCell);\n                bridge.selectContents(singleCell);\n              }\n            } else if (boxes.length > 1) {\n              annotations.selectRange(container, boxes, cellSel.start, cellSel.finish);\n              bridge.selectContents(finish);\n            }\n          });\n        });\n      });\n    };\n\n    var mousedown = function (event) {\n      annotations.clear(container);\n      findCell(event.target, isRoot).each(cursor.set);\n    };\n\n    var mouseover = function (event) {\n      applySelection(event);\n    };\n\n    var mouseup = function (event) {\n      applySelection(event);\n      clearstate();\n    };\n\n    return {\n      clearstate: clearstate,\n      mousedown: mousedown,\n      mouseover: mouseover,\n      mouseup: mouseup\n    };\n  };\n\n  var down = {\n    traverse: nextSibling,\n    gather: after,\n    relative: Situ.before,\n    otherRetry: Retries.tryDown,\n    ieRetry: Retries.ieTryDown,\n    failure: BeforeAfter.failedDown\n  };\n  var up = {\n    traverse: prevSibling,\n    gather: before,\n    relative: Situ.before,\n    otherRetry: Retries.tryUp,\n    ieRetry: Retries.ieTryUp,\n    failure: BeforeAfter.failedUp\n  };\n\n  var isKey = function (key) {\n    return function (keycode) {\n      return keycode === key;\n    };\n  };\n\n  var isUp = isKey(38);\n  var isDown = isKey(40);\n\n  var isNavigation = function (keycode) {\n    return keycode >= 37 && keycode <= 40;\n  };\n\n  var ltr = {\n    isBackward: isKey(37),\n    isForward: isKey(39)\n  };\n  var rtl = {\n    isBackward: isKey(39),\n    isForward: isKey(37)\n  };\n\n  var get = function (_DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n    var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n    return SugarPosition(x, y);\n  };\n\n  var by = function (x, y, _DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var win = doc.defaultView;\n\n    if (win) {\n      win.scrollBy(x, y);\n    }\n  };\n\n  var WindowBridge = function (win) {\n    var elementFromPoint = function (x, y) {\n      return SugarElement.fromPoint(SugarElement.fromDom(win.document), x, y);\n    };\n\n    var getRect = function (element) {\n      return element.dom.getBoundingClientRect();\n    };\n\n    var getRangedRect = function (start, soffset, finish, foffset) {\n      var sel = SimSelection.exact(start, soffset, finish, foffset);\n      return getFirstRect(win, sel);\n    };\n\n    var getSelection = function () {\n      return get$1(win).map(function (exactAdt) {\n        return convertToRange(win, exactAdt);\n      });\n    };\n\n    var fromSitus = function (situs) {\n      var relative = SimSelection.relative(situs.start, situs.finish);\n      return convertToRange(win, relative);\n    };\n\n    var situsFromPoint = function (x, y) {\n      return getAtPoint(win, x, y).map(function (exact) {\n        return Situs.create(exact.start, exact.soffset, exact.finish, exact.foffset);\n      });\n    };\n\n    var clearSelection = function () {\n      clear(win);\n    };\n\n    var collapseSelection = function (toStart) {\n      if (toStart === void 0) {\n        toStart = false;\n      }\n\n      get$1(win).each(function (sel) {\n        return sel.fold(function (rng) {\n          return rng.collapse(toStart);\n        }, function (startSitu, finishSitu) {\n          var situ = toStart ? startSitu : finishSitu;\n          setRelative(win, situ, situ);\n        }, function (start, soffset, finish, foffset) {\n          var node = toStart ? start : finish;\n          var offset = toStart ? soffset : foffset;\n          setExact(win, node, offset, node, offset);\n        });\n      });\n    };\n\n    var selectNode = function (element) {\n      setToElement(win, element, false);\n    };\n\n    var selectContents = function (element) {\n      setToElement(win, element);\n    };\n\n    var setSelection = function (sel) {\n      setExact(win, sel.start, sel.soffset, sel.finish, sel.foffset);\n    };\n\n    var setRelativeSelection = function (start, finish) {\n      setRelative(win, start, finish);\n    };\n\n    var getInnerHeight = function () {\n      return win.innerHeight;\n    };\n\n    var getScrollY = function () {\n      var pos = get(SugarElement.fromDom(win.document));\n      return pos.top;\n    };\n\n    var scrollBy = function (x, y) {\n      by(x, y, SugarElement.fromDom(win.document));\n    };\n\n    return {\n      elementFromPoint: elementFromPoint,\n      getRect: getRect,\n      getRangedRect: getRangedRect,\n      getSelection: getSelection,\n      fromSitus: fromSitus,\n      situsFromPoint: situsFromPoint,\n      clearSelection: clearSelection,\n      collapseSelection: collapseSelection,\n      setSelection: setSelection,\n      setRelativeSelection: setRelativeSelection,\n      selectNode: selectNode,\n      selectContents: selectContents,\n      getInnerHeight: getInnerHeight,\n      getScrollY: getScrollY,\n      scrollBy: scrollBy\n    };\n  };\n\n  var rc = function (rows, cols) {\n    return {\n      rows: rows,\n      cols: cols\n    };\n  };\n\n  var mouse = function (win, container, isRoot, annotations) {\n    var bridge = WindowBridge(win);\n    var handlers = MouseSelection(bridge, container, isRoot, annotations);\n    return {\n      clearstate: handlers.clearstate,\n      mousedown: handlers.mousedown,\n      mouseover: handlers.mouseover,\n      mouseup: handlers.mouseup\n    };\n  };\n\n  var keyboard = function (win, container, isRoot, annotations) {\n    var bridge = WindowBridge(win);\n\n    var clearToNavigate = function () {\n      annotations.clear(container);\n      return Optional.none();\n    };\n\n    var keydown = function (event, start, soffset, finish, foffset, direction) {\n      var realEvent = event.raw;\n      var keycode = realEvent.which;\n      var shiftKey = realEvent.shiftKey === true;\n      var handler = retrieve$1(container, annotations.selectedSelector).fold(function () {\n        if (isNavigation(keycode) && !shiftKey) {\n          annotations.clearBeforeUpdate(container);\n        }\n\n        if (isDown(keycode) && shiftKey) {\n          return curry(select, bridge, container, isRoot, down, finish, start, annotations.selectRange);\n        } else if (isUp(keycode) && shiftKey) {\n          return curry(select, bridge, container, isRoot, up, finish, start, annotations.selectRange);\n        } else if (isDown(keycode)) {\n          return curry(navigate, bridge, isRoot, down, finish, start, lastDownCheck);\n        } else if (isUp(keycode)) {\n          return curry(navigate, bridge, isRoot, up, finish, start, firstUpCheck);\n        } else {\n          return Optional.none;\n        }\n      }, function (selected) {\n        var update$1 = function (attempts) {\n          return function () {\n            var navigation = findMap(attempts, function (delta) {\n              return update(delta.rows, delta.cols, container, selected, annotations);\n            });\n            return navigation.fold(function () {\n              return getEdges(container, annotations.firstSelectedSelector, annotations.lastSelectedSelector).map(function (edges) {\n                var relative = isDown(keycode) || direction.isForward(keycode) ? Situ.after : Situ.before;\n                bridge.setRelativeSelection(Situ.on(edges.first, 0), relative(edges.table));\n                annotations.clear(container);\n                return Response.create(Optional.none(), true);\n              });\n            }, function (_) {\n              return Optional.some(Response.create(Optional.none(), true));\n            });\n          };\n        };\n\n        if (isDown(keycode) && shiftKey) {\n          return update$1([rc(+1, 0)]);\n        } else if (isUp(keycode) && shiftKey) {\n          return update$1([rc(-1, 0)]);\n        } else if (direction.isBackward(keycode) && shiftKey) {\n          return update$1([rc(0, -1), rc(-1, 0)]);\n        } else if (direction.isForward(keycode) && shiftKey) {\n          return update$1([rc(0, +1), rc(+1, 0)]);\n        } else if (isNavigation(keycode) && !shiftKey) {\n          return clearToNavigate;\n        } else {\n          return Optional.none;\n        }\n      });\n      return handler();\n    };\n\n    var keyup = function (event, start, soffset, finish, foffset) {\n      return retrieve$1(container, annotations.selectedSelector).fold(function () {\n        var realEvent = event.raw;\n        var keycode = realEvent.which;\n        var shiftKey = realEvent.shiftKey === true;\n\n        if (!shiftKey) {\n          return Optional.none();\n        }\n\n        if (isNavigation(keycode)) {\n          return sync(container, isRoot, start, soffset, finish, foffset, annotations.selectRange);\n        } else {\n          return Optional.none();\n        }\n      }, Optional.none);\n    };\n\n    return {\n      keydown: keydown,\n      keyup: keyup\n    };\n  };\n\n  var external = function (win, container, isRoot, annotations) {\n    var bridge = WindowBridge(win);\n    return function (start, finish) {\n      annotations.clearBeforeUpdate(container);\n      identify(start, finish, isRoot).each(function (cellSel) {\n        var boxes = cellSel.boxes.getOr([]);\n        annotations.selectRange(container, boxes, cellSel.start, cellSel.finish);\n        bridge.selectContents(finish);\n        bridge.collapseSelection();\n      });\n    };\n  };\n\n  var remove = function (element, classes) {\n    each$2(classes, function (x) {\n      remove$2(element, x);\n    });\n  };\n\n  var addClass = function (clazz) {\n    return function (element) {\n      add(element, clazz);\n    };\n  };\n\n  var removeClasses = function (classes) {\n    return function (element) {\n      remove(element, classes);\n    };\n  };\n\n  var byClass = function (ephemera) {\n    var addSelectionClass = addClass(ephemera.selected);\n    var removeSelectionClasses = removeClasses([ephemera.selected, ephemera.lastSelected, ephemera.firstSelected]);\n\n    var clear = function (container) {\n      var sels = descendants(container, ephemera.selectedSelector);\n      each$2(sels, removeSelectionClasses);\n    };\n\n    var selectRange = function (container, cells, start, finish) {\n      clear(container);\n      each$2(cells, addSelectionClass);\n      add(start, ephemera.firstSelected);\n      add(finish, ephemera.lastSelected);\n    };\n\n    return {\n      clearBeforeUpdate: clear,\n      clear: clear,\n      selectRange: selectRange,\n      selectedSelector: ephemera.selectedSelector,\n      firstSelectedSelector: ephemera.firstSelectedSelector,\n      lastSelectedSelector: ephemera.lastSelectedSelector\n    };\n  };\n\n  var byAttr = function (ephemera, onSelection, onClear) {\n    var removeSelectionAttributes = function (element) {\n      remove$7(element, ephemera.selected);\n      remove$7(element, ephemera.firstSelected);\n      remove$7(element, ephemera.lastSelected);\n    };\n\n    var addSelectionAttribute = function (element) {\n      set$2(element, ephemera.selected, '1');\n    };\n\n    var clear = function (container) {\n      clearBeforeUpdate(container);\n      onClear();\n    };\n\n    var clearBeforeUpdate = function (container) {\n      var sels = descendants(container, ephemera.selectedSelector + ',' + ephemera.firstSelectedSelector + ',' + ephemera.lastSelectedSelector);\n      each$2(sels, removeSelectionAttributes);\n    };\n\n    var selectRange = function (container, cells, start, finish) {\n      clear(container);\n      each$2(cells, addSelectionAttribute);\n      set$2(start, ephemera.firstSelected, '1');\n      set$2(finish, ephemera.lastSelected, '1');\n      onSelection(cells, start, finish);\n    };\n\n    return {\n      clearBeforeUpdate: clearBeforeUpdate,\n      clear: clear,\n      selectRange: selectRange,\n      selectedSelector: ephemera.selectedSelector,\n      firstSelectedSelector: ephemera.firstSelectedSelector,\n      lastSelectedSelector: ephemera.lastSelectedSelector\n    };\n  };\n\n  var SelectionAnnotation = {\n    byClass: byClass,\n    byAttr: byAttr\n  };\n\n  var getUpOrLeftCells = function (grid, selectedCells) {\n    var upGrid = grid.slice(0, selectedCells[selectedCells.length - 1].row + 1);\n    var upDetails = toDetailList(upGrid);\n    return bind$2(upDetails, function (detail) {\n      var slicedCells = detail.cells.slice(0, selectedCells[selectedCells.length - 1].column + 1);\n      return map$1(slicedCells, function (cell) {\n        return cell.element;\n      });\n    });\n  };\n\n  var getDownOrRightCells = function (grid, selectedCells) {\n    var downGrid = grid.slice(selectedCells[0].row + selectedCells[0].rowspan - 1, grid.length);\n    var downDetails = toDetailList(downGrid);\n    return bind$2(downDetails, function (detail) {\n      var slicedCells = detail.cells.slice(selectedCells[0].column + selectedCells[0].colspan - 1, detail.cells.length);\n      return map$1(slicedCells, function (cell) {\n        return cell.element;\n      });\n    });\n  };\n\n  var getOtherCells = function (table, target, generators) {\n    var warehouse = Warehouse.fromTable(table);\n    var details = onCells(warehouse, target);\n    return details.map(function (selectedCells) {\n      var grid = toGrid(warehouse, generators, false);\n      var upOrLeftCells = getUpOrLeftCells(grid, selectedCells);\n      var downOrRightCells = getDownOrRightCells(grid, selectedCells);\n      return {\n        upOrLeftCells: upOrLeftCells,\n        downOrRightCells: downOrRightCells\n      };\n    });\n  };\n\n  var global = tinymce.util.Tools.resolve('tinymce.Env');\n\n  var hasInternalTarget = function (e) {\n    return has(SugarElement.fromDom(e.target), 'ephox-snooker-resizer-bar') === false;\n  };\n\n  function CellSelection(editor, lazyResize, selectionTargets) {\n    var onSelection = function (cells, start, finish) {\n      selectionTargets.targets().each(function (targets) {\n        var tableOpt = table(start);\n        tableOpt.each(function (table) {\n          var cloneFormats = getCloneElements(editor);\n          var generators = cellOperations(noop, SugarElement.fromDom(editor.getDoc()), cloneFormats);\n          var otherCells = getOtherCells(table, targets, generators);\n          fireTableSelectionChange(editor, cells, start, finish, otherCells);\n        });\n      });\n    };\n\n    var onClear = function () {\n      return fireTableSelectionClear(editor);\n    };\n\n    var annotations = SelectionAnnotation.byAttr(ephemera, onSelection, onClear);\n    editor.on('init', function (_e) {\n      var win = editor.getWin();\n      var body = getBody(editor);\n      var isRoot = getIsRoot(editor);\n\n      var syncSelection = function () {\n        var sel = editor.selection;\n        var start = SugarElement.fromDom(sel.getStart());\n        var end = SugarElement.fromDom(sel.getEnd());\n        var shared = sharedOne(table, [start, end]);\n        shared.fold(function () {\n          return annotations.clear(body);\n        }, noop);\n      };\n\n      var mouseHandlers = mouse(win, body, isRoot, annotations);\n      var keyHandlers = keyboard(win, body, isRoot, annotations);\n      var external$1 = external(win, body, isRoot, annotations);\n\n      var hasShiftKey = function (event) {\n        return event.raw.shiftKey === true;\n      };\n\n      editor.on('TableSelectorChange', function (e) {\n        return external$1(e.start, e.finish);\n      });\n\n      var handleResponse = function (event, response) {\n        if (!hasShiftKey(event)) {\n          return;\n        }\n\n        if (response.kill) {\n          event.kill();\n        }\n\n        response.selection.each(function (ns) {\n          var relative = SimSelection.relative(ns.start, ns.finish);\n          var rng = asLtrRange(win, relative);\n          editor.selection.setRng(rng);\n        });\n      };\n\n      var keyup = function (event) {\n        var wrappedEvent = fromRawEvent(event);\n\n        if (wrappedEvent.raw.shiftKey && isNavigation(wrappedEvent.raw.which)) {\n          var rng = editor.selection.getRng();\n          var start = SugarElement.fromDom(rng.startContainer);\n          var end = SugarElement.fromDom(rng.endContainer);\n          keyHandlers.keyup(wrappedEvent, start, rng.startOffset, end, rng.endOffset).each(function (response) {\n            handleResponse(wrappedEvent, response);\n          });\n        }\n      };\n\n      var keydown = function (event) {\n        var wrappedEvent = fromRawEvent(event);\n        lazyResize().each(function (resize) {\n          return resize.hideBars();\n        });\n        var rng = editor.selection.getRng();\n        var start = SugarElement.fromDom(rng.startContainer);\n        var end = SugarElement.fromDom(rng.endContainer);\n        var direction = onDirection(ltr, rtl)(SugarElement.fromDom(editor.selection.getStart()));\n        keyHandlers.keydown(wrappedEvent, start, rng.startOffset, end, rng.endOffset, direction).each(function (response) {\n          handleResponse(wrappedEvent, response);\n        });\n        lazyResize().each(function (resize) {\n          return resize.showBars();\n        });\n      };\n\n      var isLeftMouse = function (raw) {\n        return raw.button === 0;\n      };\n\n      var isLeftButtonPressed = function (raw) {\n        if (raw.buttons === undefined) {\n          return true;\n        }\n\n        if (global.browser.isEdge() && raw.buttons === 0) {\n          return true;\n        }\n\n        return (raw.buttons & 1) !== 0;\n      };\n\n      var dragStart = function (_e) {\n        mouseHandlers.clearstate();\n      };\n\n      var mouseDown = function (e) {\n        if (isLeftMouse(e) && hasInternalTarget(e)) {\n          mouseHandlers.mousedown(fromRawEvent(e));\n        }\n      };\n\n      var mouseOver = function (e) {\n        if (isLeftButtonPressed(e) && hasInternalTarget(e)) {\n          mouseHandlers.mouseover(fromRawEvent(e));\n        }\n      };\n\n      var mouseUp = function (e) {\n        if (isLeftMouse(e) && hasInternalTarget(e)) {\n          mouseHandlers.mouseup(fromRawEvent(e));\n        }\n      };\n\n      var getDoubleTap = function () {\n        var lastTarget = Cell(SugarElement.fromDom(body));\n        var lastTimeStamp = Cell(0);\n\n        var touchEnd = function (t) {\n          var target = SugarElement.fromDom(t.target);\n\n          if (name(target) === 'td' || name(target) === 'th') {\n            var lT = lastTarget.get();\n            var lTS = lastTimeStamp.get();\n\n            if (eq$1(lT, target) && t.timeStamp - lTS < 300) {\n              t.preventDefault();\n              external$1(target, target);\n            }\n          }\n\n          lastTarget.set(target);\n          lastTimeStamp.set(t.timeStamp);\n        };\n\n        return {\n          touchEnd: touchEnd\n        };\n      };\n\n      var doubleTap = getDoubleTap();\n      editor.on('dragstart', dragStart);\n      editor.on('mousedown', mouseDown);\n      editor.on('mouseover', mouseOver);\n      editor.on('mouseup', mouseUp);\n      editor.on('touchend', doubleTap.touchEnd);\n      editor.on('keyup', keyup);\n      editor.on('keydown', keydown);\n      editor.on('NodeChange', syncSelection);\n    });\n    return {\n      clear: annotations.clear\n    };\n  }\n\n  var child = function (scope, selector) {\n    return child$1(scope, selector).isSome();\n  };\n\n  var getSelectionTargets = function (editor, selections) {\n    var targets = Cell(Optional.none());\n    var changeHandlers = Cell([]);\n    var selectionDetails = Optional.none();\n    var isCaption = isTag('caption');\n\n    var isDisabledForSelection = function (key) {\n      return selectionDetails.forall(function (details) {\n        return !details[key];\n      });\n    };\n\n    var getStart = function () {\n      return getSelectionCellOrCaption(getSelectionStart(editor), getIsRoot(editor));\n    };\n\n    var getEnd = function () {\n      return getSelectionCellOrCaption(getSelectionEnd(editor), getIsRoot(editor));\n    };\n\n    var findTargets = function () {\n      return getStart().bind(function (startCellOrCaption) {\n        return flatten(lift2(table(startCellOrCaption), getEnd().bind(table), function (startTable, endTable) {\n          if (eq$1(startTable, endTable)) {\n            if (isCaption(startCellOrCaption)) {\n              return Optional.some(noMenu(startCellOrCaption));\n            } else {\n              return Optional.some(forMenu(selections, startTable, startCellOrCaption));\n            }\n          }\n\n          return Optional.none();\n        }));\n      });\n    };\n\n    var getExtractedDetails = function (targets) {\n      var tableOpt = table(targets.element);\n      return tableOpt.map(function (table) {\n        var warehouse = Warehouse.fromTable(table);\n        var selectedCells = onCells(warehouse, targets).getOr([]);\n        var locked = foldl(selectedCells, function (acc, cell) {\n          if (cell.isLocked) {\n            acc.onAny = true;\n\n            if (cell.column === 0) {\n              acc.onFirst = true;\n            } else if (cell.column + cell.colspan >= warehouse.grid.columns) {\n              acc.onLast = true;\n            }\n          }\n\n          return acc;\n        }, {\n          onAny: false,\n          onFirst: false,\n          onLast: false\n        });\n        return {\n          mergeable: onUnlockedMergable(warehouse, targets).isSome(),\n          unmergeable: onUnlockedUnmergable(warehouse, targets).isSome(),\n          locked: locked\n        };\n      });\n    };\n\n    var resetTargets = function () {\n      targets.set(cached(findTargets)());\n      selectionDetails = targets.get().bind(getExtractedDetails);\n      each$2(changeHandlers.get(), function (handler) {\n        return handler();\n      });\n    };\n\n    var setupHandler = function (handler) {\n      handler();\n      changeHandlers.set(changeHandlers.get().concat([handler]));\n      return function () {\n        changeHandlers.set(filter$2(changeHandlers.get(), function (h) {\n          return h !== handler;\n        }));\n      };\n    };\n\n    var onSetup = function (api, isDisabled) {\n      return setupHandler(function () {\n        return targets.get().fold(function () {\n          api.setDisabled(true);\n        }, function (targets) {\n          api.setDisabled(isDisabled(targets));\n        });\n      });\n    };\n\n    var onSetupWithToggle = function (api, isDisabled, isActive) {\n      return setupHandler(function () {\n        return targets.get().fold(function () {\n          api.setDisabled(true);\n          api.setActive(false);\n        }, function (targets) {\n          api.setDisabled(isDisabled(targets));\n          api.setActive(isActive(targets));\n        });\n      });\n    };\n\n    var isDisabledFromLocked = function (lockedDisable) {\n      return selectionDetails.exists(function (details) {\n        return details.locked[lockedDisable];\n      });\n    };\n\n    var onSetupTable = function (api) {\n      return onSetup(api, function (_) {\n        return false;\n      });\n    };\n\n    var onSetupCellOrRow = function (api) {\n      return onSetup(api, function (targets) {\n        return isCaption(targets.element);\n      });\n    };\n\n    var onSetupColumn = function (lockedDisable) {\n      return function (api) {\n        return onSetup(api, function (targets) {\n          return isCaption(targets.element) || isDisabledFromLocked(lockedDisable);\n        });\n      };\n    };\n\n    var onSetupPasteable = function (getClipboardData) {\n      return function (api) {\n        return onSetup(api, function (targets) {\n          return isCaption(targets.element) || getClipboardData().isNone();\n        });\n      };\n    };\n\n    var onSetupPasteableColumn = function (getClipboardData, lockedDisable) {\n      return function (api) {\n        return onSetup(api, function (targets) {\n          return isCaption(targets.element) || getClipboardData().isNone() || isDisabledFromLocked(lockedDisable);\n        });\n      };\n    };\n\n    var onSetupMergeable = function (api) {\n      return onSetup(api, function (_targets) {\n        return isDisabledForSelection('mergeable');\n      });\n    };\n\n    var onSetupUnmergeable = function (api) {\n      return onSetup(api, function (_targets) {\n        return isDisabledForSelection('unmergeable');\n      });\n    };\n\n    var onSetupTableWithCaption = function (api) {\n      return onSetupWithToggle(api, never, function (targets) {\n        var tableOpt = table(targets.element, getIsRoot(editor));\n        return tableOpt.exists(function (table) {\n          return child(table, 'caption');\n        });\n      });\n    };\n\n    var onSetupTableHeaders = function (command, headerType) {\n      return function (api) {\n        return onSetupWithToggle(api, function (targets) {\n          return isCaption(targets.element);\n        }, function () {\n          return editor.queryCommandValue(command) === headerType;\n        });\n      };\n    };\n\n    var onSetupTableRowHeaders = onSetupTableHeaders('mceTableRowType', 'header');\n    var onSetupTableColumnHeaders = onSetupTableHeaders('mceTableColType', 'th');\n    editor.on('NodeChange ExecCommand TableSelectorChange', resetTargets);\n    return {\n      onSetupTable: onSetupTable,\n      onSetupCellOrRow: onSetupCellOrRow,\n      onSetupColumn: onSetupColumn,\n      onSetupPasteable: onSetupPasteable,\n      onSetupPasteableColumn: onSetupPasteableColumn,\n      onSetupMergeable: onSetupMergeable,\n      onSetupUnmergeable: onSetupUnmergeable,\n      resetTargets: resetTargets,\n      onSetupTableWithCaption: onSetupTableWithCaption,\n      onSetupTableRowHeaders: onSetupTableRowHeaders,\n      onSetupTableColumnHeaders: onSetupTableColumnHeaders,\n      targets: targets.get\n    };\n  };\n\n  var addButtons = function (editor, selections, selectionTargets, clipboard) {\n    editor.ui.registry.addMenuButton('table', {\n      tooltip: 'Table',\n      icon: 'table',\n      fetch: function (callback) {\n        return callback('inserttable | cell row column | advtablesort | tableprops deletetable');\n      }\n    });\n\n    var cmd = function (command) {\n      return function () {\n        return editor.execCommand(command);\n      };\n    };\n\n    editor.ui.registry.addButton('tableprops', {\n      tooltip: 'Table properties',\n      onAction: cmd('mceTableProps'),\n      icon: 'table',\n      onSetup: selectionTargets.onSetupTable\n    });\n    editor.ui.registry.addButton('tabledelete', {\n      tooltip: 'Delete table',\n      onAction: cmd('mceTableDelete'),\n      icon: 'table-delete-table',\n      onSetup: selectionTargets.onSetupTable\n    });\n    editor.ui.registry.addButton('tablecellprops', {\n      tooltip: 'Cell properties',\n      onAction: cmd('mceTableCellProps'),\n      icon: 'table-cell-properties',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tablemergecells', {\n      tooltip: 'Merge cells',\n      onAction: cmd('mceTableMergeCells'),\n      icon: 'table-merge-cells',\n      onSetup: selectionTargets.onSetupMergeable\n    });\n    editor.ui.registry.addButton('tablesplitcells', {\n      tooltip: 'Split cell',\n      onAction: cmd('mceTableSplitCells'),\n      icon: 'table-split-cells',\n      onSetup: selectionTargets.onSetupUnmergeable\n    });\n    editor.ui.registry.addButton('tableinsertrowbefore', {\n      tooltip: 'Insert row before',\n      onAction: cmd('mceTableInsertRowBefore'),\n      icon: 'table-insert-row-above',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tableinsertrowafter', {\n      tooltip: 'Insert row after',\n      onAction: cmd('mceTableInsertRowAfter'),\n      icon: 'table-insert-row-after',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tabledeleterow', {\n      tooltip: 'Delete row',\n      onAction: cmd('mceTableDeleteRow'),\n      icon: 'table-delete-row',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tablerowprops', {\n      tooltip: 'Row properties',\n      onAction: cmd('mceTableRowProps'),\n      icon: 'table-row-properties',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tableinsertcolbefore', {\n      tooltip: 'Insert column before',\n      onAction: cmd('mceTableInsertColBefore'),\n      icon: 'table-insert-column-before',\n      onSetup: selectionTargets.onSetupColumn('onFirst')\n    });\n    editor.ui.registry.addButton('tableinsertcolafter', {\n      tooltip: 'Insert column after',\n      onAction: cmd('mceTableInsertColAfter'),\n      icon: 'table-insert-column-after',\n      onSetup: selectionTargets.onSetupColumn('onLast')\n    });\n    editor.ui.registry.addButton('tabledeletecol', {\n      tooltip: 'Delete column',\n      onAction: cmd('mceTableDeleteCol'),\n      icon: 'table-delete-column',\n      onSetup: selectionTargets.onSetupColumn('onAny')\n    });\n    editor.ui.registry.addButton('tablecutrow', {\n      tooltip: 'Cut row',\n      icon: 'cut-row',\n      onAction: cmd('mceTableCutRow'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tablecopyrow', {\n      tooltip: 'Copy row',\n      icon: 'duplicate-row',\n      onAction: cmd('mceTableCopyRow'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tablepasterowbefore', {\n      tooltip: 'Paste row before',\n      icon: 'paste-row-before',\n      onAction: cmd('mceTablePasteRowBefore'),\n      onSetup: selectionTargets.onSetupPasteable(clipboard.getRows)\n    });\n    editor.ui.registry.addButton('tablepasterowafter', {\n      tooltip: 'Paste row after',\n      icon: 'paste-row-after',\n      onAction: cmd('mceTablePasteRowAfter'),\n      onSetup: selectionTargets.onSetupPasteable(clipboard.getRows)\n    });\n    editor.ui.registry.addButton('tablecutcol', {\n      tooltip: 'Cut column',\n      icon: 'cut-column',\n      onAction: cmd('mceTableCutCol'),\n      onSetup: selectionTargets.onSetupColumn('onAny')\n    });\n    editor.ui.registry.addButton('tablecopycol', {\n      tooltip: 'Copy column',\n      icon: 'duplicate-column',\n      onAction: cmd('mceTableCopyCol'),\n      onSetup: selectionTargets.onSetupColumn('onAny')\n    });\n    editor.ui.registry.addButton('tablepastecolbefore', {\n      tooltip: 'Paste column before',\n      icon: 'paste-column-before',\n      onAction: cmd('mceTablePasteColBefore'),\n      onSetup: selectionTargets.onSetupPasteableColumn(clipboard.getColumns, 'onFirst')\n    });\n    editor.ui.registry.addButton('tablepastecolafter', {\n      tooltip: 'Paste column after',\n      icon: 'paste-column-after',\n      onAction: cmd('mceTablePasteColAfter'),\n      onSetup: selectionTargets.onSetupPasteableColumn(clipboard.getColumns, 'onLast')\n    });\n    editor.ui.registry.addButton('tableinsertdialog', {\n      tooltip: 'Insert table',\n      onAction: cmd('mceInsertTable'),\n      icon: 'table'\n    });\n    var tableClassList = filterNoneItem(getTableClassList(editor));\n\n    if (tableClassList.length !== 0) {\n      editor.ui.registry.addMenuButton('tableclass', {\n        icon: 'table-classes',\n        tooltip: 'Table styles',\n        fetch: generateMenuItemsCallback(editor, selections, tableClassList, 'tableclass', function (value) {\n          return editor.execCommand('mceTableToggleClass', false, value);\n        }),\n        onSetup: selectionTargets.onSetupTable\n      });\n    }\n\n    var tableCellClassList = filterNoneItem(getCellClassList(editor));\n\n    if (tableCellClassList.length !== 0) {\n      editor.ui.registry.addMenuButton('tablecellclass', {\n        icon: 'table-cell-classes',\n        tooltip: 'Cell styles',\n        fetch: generateMenuItemsCallback(editor, selections, tableCellClassList, 'tablecellclass', function (value) {\n          return editor.execCommand('mceTableCellToggleClass', false, value);\n        }),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n    }\n\n    editor.ui.registry.addMenuButton('tablecellvalign', {\n      icon: 'vertical-align',\n      tooltip: 'Vertical align',\n      fetch: generateMenuItemsCallback(editor, selections, verticalAlignValues, 'tablecellverticalalign', applyTableCellStyle(editor, 'vertical-align')),\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addMenuButton('tablecellborderwidth', {\n      icon: 'border-width',\n      tooltip: 'Border width',\n      fetch: generateMenuItemsCallback(editor, selections, getTableBorderWidths(editor), 'tablecellborderwidth', applyTableCellStyle(editor, 'border-width')),\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addMenuButton('tablecellborderstyle', {\n      icon: 'border-style',\n      tooltip: 'Border style',\n      fetch: generateMenuItemsCallback(editor, selections, getTableBorderStyles(editor), 'tablecellborderstyle', applyTableCellStyle(editor, 'border-style')),\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addToggleButton('tablecaption', {\n      tooltip: 'Table caption',\n      onAction: cmd('mceTableToggleCaption'),\n      icon: 'table-caption',\n      onSetup: selectionTargets.onSetupTableWithCaption\n    });\n    editor.ui.registry.addMenuButton('tablecellbackgroundcolor', {\n      icon: 'cell-background-color',\n      tooltip: 'Background color',\n      fetch: function (callback) {\n        return callback(buildColorMenu(editor, getTableBackgroundColorMap(editor), 'background-color'));\n      },\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addMenuButton('tablecellbordercolor', {\n      icon: 'cell-border-color',\n      tooltip: 'Border color',\n      fetch: function (callback) {\n        return callback(buildColorMenu(editor, getTableBorderColorMap(editor), 'border-color'));\n      },\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addToggleButton('tablerowheader', {\n      tooltip: 'Row header',\n      icon: 'table-top-header',\n      onAction: changeRowHeader(editor),\n      onSetup: selectionTargets.onSetupTableRowHeaders\n    });\n    editor.ui.registry.addToggleButton('tablecolheader', {\n      tooltip: 'Column header',\n      icon: 'table-left-header',\n      onAction: changeColumnHeader(editor),\n      onSetup: selectionTargets.onSetupTableColumnHeaders\n    });\n  };\n\n  var addToolbars = function (editor) {\n    var isTable = function (table) {\n      return editor.dom.is(table, 'table') && editor.getBody().contains(table);\n    };\n\n    var toolbar = getToolbar(editor);\n\n    if (toolbar.length > 0) {\n      editor.ui.registry.addContextToolbar('table', {\n        predicate: isTable,\n        items: toolbar,\n        scope: 'node',\n        position: 'node'\n      });\n    }\n  };\n\n  var addMenuItems = function (editor, selections, selectionTargets, clipboard) {\n    var cmd = function (command) {\n      return function () {\n        return editor.execCommand(command);\n      };\n    };\n\n    var insertTableAction = function (data) {\n      editor.execCommand('mceInsertTable', false, {\n        rows: data.numRows,\n        columns: data.numColumns\n      });\n    };\n\n    var tableProperties = {\n      text: 'Table properties',\n      onSetup: selectionTargets.onSetupTable,\n      onAction: cmd('mceTableProps')\n    };\n    var deleteTable = {\n      text: 'Delete table',\n      icon: 'table-delete-table',\n      onSetup: selectionTargets.onSetupTable,\n      onAction: cmd('mceTableDelete')\n    };\n    editor.ui.registry.addMenuItem('tableinsertrowbefore', {\n      text: 'Insert row before',\n      icon: 'table-insert-row-above',\n      onAction: cmd('mceTableInsertRowBefore'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addMenuItem('tableinsertrowafter', {\n      text: 'Insert row after',\n      icon: 'table-insert-row-after',\n      onAction: cmd('mceTableInsertRowAfter'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addMenuItem('tabledeleterow', {\n      text: 'Delete row',\n      icon: 'table-delete-row',\n      onAction: cmd('mceTableDeleteRow'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addMenuItem('tablerowprops', {\n      text: 'Row properties',\n      icon: 'table-row-properties',\n      onAction: cmd('mceTableRowProps'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addMenuItem('tablecutrow', {\n      text: 'Cut row',\n      icon: 'cut-row',\n      onAction: cmd('mceTableCutRow'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addMenuItem('tablecopyrow', {\n      text: 'Copy row',\n      icon: 'duplicate-row',\n      onAction: cmd('mceTableCopyRow'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addMenuItem('tablepasterowbefore', {\n      text: 'Paste row before',\n      icon: 'paste-row-before',\n      onAction: cmd('mceTablePasteRowBefore'),\n      onSetup: selectionTargets.onSetupPasteable(clipboard.getRows)\n    });\n    editor.ui.registry.addMenuItem('tablepasterowafter', {\n      text: 'Paste row after',\n      icon: 'paste-row-after',\n      onAction: cmd('mceTablePasteRowAfter'),\n      onSetup: selectionTargets.onSetupPasteable(clipboard.getRows)\n    });\n    var row = {\n      type: 'nestedmenuitem',\n      text: 'Row',\n      getSubmenuItems: constant('tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter')\n    };\n    editor.ui.registry.addMenuItem('tableinsertcolumnbefore', {\n      text: 'Insert column before',\n      icon: 'table-insert-column-before',\n      onAction: cmd('mceTableInsertColBefore'),\n      onSetup: selectionTargets.onSetupColumn('onFirst')\n    });\n    editor.ui.registry.addMenuItem('tableinsertcolumnafter', {\n      text: 'Insert column after',\n      icon: 'table-insert-column-after',\n      onAction: cmd('mceTableInsertColAfter'),\n      onSetup: selectionTargets.onSetupColumn('onLast')\n    });\n    editor.ui.registry.addMenuItem('tabledeletecolumn', {\n      text: 'Delete column',\n      icon: 'table-delete-column',\n      onAction: cmd('mceTableDeleteCol'),\n      onSetup: selectionTargets.onSetupColumn('onAny')\n    });\n    editor.ui.registry.addMenuItem('tablecutcolumn', {\n      text: 'Cut column',\n      icon: 'cut-column',\n      onAction: cmd('mceTableCutCol'),\n      onSetup: selectionTargets.onSetupColumn('onAny')\n    });\n    editor.ui.registry.addMenuItem('tablecopycolumn', {\n      text: 'Copy column',\n      icon: 'duplicate-column',\n      onAction: cmd('mceTableCopyCol'),\n      onSetup: selectionTargets.onSetupColumn('onAny')\n    });\n    editor.ui.registry.addMenuItem('tablepastecolumnbefore', {\n      text: 'Paste column before',\n      icon: 'paste-column-before',\n      onAction: cmd('mceTablePasteColBefore'),\n      onSetup: selectionTargets.onSetupPasteableColumn(clipboard.getColumns, 'onFirst')\n    });\n    editor.ui.registry.addMenuItem('tablepastecolumnafter', {\n      text: 'Paste column after',\n      icon: 'paste-column-after',\n      onAction: cmd('mceTablePasteColAfter'),\n      onSetup: selectionTargets.onSetupPasteableColumn(clipboard.getColumns, 'onLast')\n    });\n    var column = {\n      type: 'nestedmenuitem',\n      text: 'Column',\n      getSubmenuItems: constant('tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter')\n    };\n    editor.ui.registry.addMenuItem('tablecellprops', {\n      text: 'Cell properties',\n      icon: 'table-cell-properties',\n      onAction: cmd('mceTableCellProps'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addMenuItem('tablemergecells', {\n      text: 'Merge cells',\n      icon: 'table-merge-cells',\n      onAction: cmd('mceTableMergeCells'),\n      onSetup: selectionTargets.onSetupMergeable\n    });\n    editor.ui.registry.addMenuItem('tablesplitcells', {\n      text: 'Split cell',\n      icon: 'table-split-cells',\n      onAction: cmd('mceTableSplitCells'),\n      onSetup: selectionTargets.onSetupUnmergeable\n    });\n    var cell = {\n      type: 'nestedmenuitem',\n      text: 'Cell',\n      getSubmenuItems: constant('tablecellprops tablemergecells tablesplitcells')\n    };\n\n    if (hasTableGrid(editor) === false) {\n      editor.ui.registry.addMenuItem('inserttable', {\n        text: 'Table',\n        icon: 'table',\n        onAction: cmd('mceInsertTable')\n      });\n    } else {\n      editor.ui.registry.addNestedMenuItem('inserttable', {\n        text: 'Table',\n        icon: 'table',\n        getSubmenuItems: function () {\n          return [{\n            type: 'fancymenuitem',\n            fancytype: 'inserttable',\n            onAction: insertTableAction\n          }];\n        }\n      });\n    }\n\n    editor.ui.registry.addMenuItem('inserttabledialog', {\n      text: 'Insert table',\n      icon: 'table',\n      onAction: cmd('mceInsertTable')\n    });\n    editor.ui.registry.addMenuItem('tableprops', tableProperties);\n    editor.ui.registry.addMenuItem('deletetable', deleteTable);\n    editor.ui.registry.addNestedMenuItem('row', row);\n    editor.ui.registry.addNestedMenuItem('column', column);\n    editor.ui.registry.addNestedMenuItem('cell', cell);\n    editor.ui.registry.addContextMenu('table', {\n      update: function () {\n        selectionTargets.resetTargets();\n        return selectionTargets.targets().fold(constant(''), function (targets) {\n          if (name(targets.element) === 'caption') {\n            return 'tableprops deletetable';\n          } else {\n            return 'cell row column | advtablesort | tableprops deletetable';\n          }\n        });\n      }\n    });\n    var tableClassList = filterNoneItem(getTableClassList(editor));\n\n    if (tableClassList.length !== 0) {\n      editor.ui.registry.addNestedMenuItem('tableclass', {\n        icon: 'table-classes',\n        text: 'Table styles',\n        getSubmenuItems: function () {\n          return buildMenuItems(editor, selections, tableClassList, 'tableclass', function (value) {\n            return editor.execCommand('mceTableToggleClass', false, value);\n          });\n        },\n        onSetup: selectionTargets.onSetupTable\n      });\n    }\n\n    var tableCellClassList = filterNoneItem(getCellClassList(editor));\n\n    if (tableCellClassList.length !== 0) {\n      editor.ui.registry.addNestedMenuItem('tablecellclass', {\n        icon: 'table-cell-classes',\n        text: 'Cell styles',\n        getSubmenuItems: function () {\n          return buildMenuItems(editor, selections, tableCellClassList, 'tablecellclass', function (value) {\n            return editor.execCommand('mceTableCellToggleClass', false, value);\n          });\n        },\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n    }\n\n    editor.ui.registry.addNestedMenuItem('tablecellvalign', {\n      icon: 'vertical-align',\n      text: 'Vertical align',\n      getSubmenuItems: function () {\n        return buildMenuItems(editor, selections, verticalAlignValues, 'tablecellverticalalign', applyTableCellStyle(editor, 'vertical-align'));\n      },\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addNestedMenuItem('tablecellborderwidth', {\n      icon: 'border-width',\n      text: 'Border width',\n      getSubmenuItems: function () {\n        return buildMenuItems(editor, selections, getTableBorderWidths(editor), 'tablecellborderwidth', applyTableCellStyle(editor, 'border-width'));\n      },\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addNestedMenuItem('tablecellborderstyle', {\n      icon: 'border-style',\n      text: 'Border style',\n      getSubmenuItems: function () {\n        return buildMenuItems(editor, selections, getTableBorderStyles(editor), 'tablecellborderstyle', applyTableCellStyle(editor, 'border-style'));\n      },\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addToggleMenuItem('tablecaption', {\n      icon: 'table-caption',\n      text: 'Table caption',\n      onAction: cmd('mceTableToggleCaption'),\n      onSetup: selectionTargets.onSetupTableWithCaption\n    });\n    editor.ui.registry.addNestedMenuItem('tablecellbackgroundcolor', {\n      icon: 'cell-background-color',\n      text: 'Background color',\n      getSubmenuItems: function () {\n        return buildColorMenu(editor, getTableBackgroundColorMap(editor), 'background-color');\n      },\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addNestedMenuItem('tablecellbordercolor', {\n      icon: 'cell-border-color',\n      text: 'Border color',\n      getSubmenuItems: function () {\n        return buildColorMenu(editor, getTableBorderColorMap(editor), 'border-color');\n      },\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addToggleMenuItem('tablerowheader', {\n      text: 'Row header',\n      icon: 'table-top-header',\n      onAction: changeRowHeader(editor),\n      onSetup: selectionTargets.onSetupTableRowHeaders\n    });\n    editor.ui.registry.addToggleMenuItem('tablecolheader', {\n      text: 'Column header',\n      icon: 'table-left-header',\n      onAction: changeColumnHeader(editor),\n      onSetup: selectionTargets.onSetupTableColumnHeaders\n    });\n  };\n\n  var Plugin = function (editor) {\n    var selections = Selections(function () {\n      return getBody(editor);\n    }, function () {\n      return getSelectionCell(getSelectionStart(editor), getIsRoot(editor));\n    }, ephemera.selectedSelector);\n    var selectionTargets = getSelectionTargets(editor, selections);\n    var resizeHandler = getResizeHandler(editor);\n    var cellSelection = CellSelection(editor, resizeHandler.lazyResize, selectionTargets);\n    var actions = TableActions(editor, cellSelection, resizeHandler.lazyWire);\n    var clipboard = Clipboard();\n    registerCommands(editor, actions, cellSelection, selections, clipboard);\n    registerQueryCommands(editor, actions, selections);\n    registerEvents(editor, selections, actions);\n    addMenuItems(editor, selections, selectionTargets, clipboard);\n    addButtons(editor, selections, selectionTargets, clipboard);\n    addToolbars(editor);\n    editor.on('PreInit', function () {\n      editor.serializer.addTempAttr(ephemera.firstSelected);\n      editor.serializer.addTempAttr(ephemera.lastSelected);\n      registerFormats(editor);\n    });\n\n    if (hasTabNavigation(editor)) {\n      editor.on('keydown', function (e) {\n        handle$1(e, editor, cellSelection);\n      });\n    }\n\n    editor.on('remove', function () {\n      resizeHandler.destroy();\n    });\n    return getApi(editor, clipboard, resizeHandler, selectionTargets);\n  };\n\n  function Plugin$1() {\n    global$3.add('table', Plugin);\n  }\n\n  Plugin$1();\n})();","map":{"version":3,"sources":["/opt/bitnami/apache/htdocs/converzee-frontend/node_modules/tinymce/plugins/table/plugin.js"],"names":["typeOf","x","t","Array","prototype","isPrototypeOf","constructor","name","String","isType$1","type","value","isSimpleType","eq$2","a","isString","isObject","isArray","isNull","isBoolean","isUndefined","undefined","isNullable","isNonNullable","isFunction","isNumber","noop","compose","fa","fb","args","_i","arguments","length","apply","compose1","fbc","fab","constant","identity","tripleEquals","b","curry","fn","initialArgs","restArgs","all","concat","not","f","die","msg","Error","never","always","none$2","NONE","call","thunk","id","me","fold","n","_s","isSome","isNone","getOr","getOrThunk","getOrDie","getOrNull","getOrUndefined","or","orThunk","map","each","bind","exists","forall","filter","toArray","toString","some","constant_a","self","s","from$1","Optional","none","from","nativeSlice","slice","nativeIndexOf","indexOf","nativePush","push","rawIndexOf","ts","contains$2","xs","pred","i","len","range$1","num","r","map$1","each$2","eachr","partition","pass","fail","arr","filter$2","foldr","acc","foldl","findUntil","until","find$1","findIndex","flatten$1","bind$2","reverse","mapToObject","pure","sort$1","comparator","copy","sort","get$d","head","last$2","findMap","__assign","Object","assign","p","hasOwnProperty","__spreadArray","to","pack","l","ar","cached","called","DeviceType","os","browser","userAgent","mediaMatch","isiPad","isiOS","test","isiPhone","isMobile","isAndroid","isTouch","isTablet","isPhone","iOSwebview","isSafari","isDesktop","isWebView","firstMatch","regexes","find","agent","major","minor","group","Number","replace","nu$2","detect$6","versionRegexes","cleanedAgent","toLowerCase","unknown$2","Version","nu","detect","unknown","detectBrowser$1","browsers","userAgentData","brands","uaBrand","lcBrand","brand","_a","info","current","version","parseInt","detect$5","candidates","candidate","search","detectBrowser","detectOs","oses","removeFromStart","str","numChars","substring","checkRange","substr","start","removeLeading","prefix","startsWith","contains$1","endsWith","suffix","blank","trim","isNotEmpty","isEmpty$1","toFloat","parseFloat","isNaN","normalVersionRegex","checkContains","target","uastring","PlatformInfo","edge","chrome","ie","opera","firefox","safari","unknown$1","nu$1","isBrowser","isEdge","isChrome","isIE","isOpera","isFirefox","Browser","windows","ios","android","linux","osx","solaris","freebsd","chromeos","isOS","isWindows","isOSX","isLinux","isSolaris","isFreeBSD","isChromeOS","OperatingSystem","detect$4","userAgentDataOpt","deviceType","PlatformDetection","query","window","matchMedia","matches","platform","navigator","detect$3","compareDocumentPosition","match","documentPositionContainedBy","Node","DOCUMENT_POSITION_CONTAINED_BY","COMMENT","DOCUMENT","DOCUMENT_FRAGMENT","ELEMENT","TEXT","fromHtml$1","html","scope","doc","document","div","createElement","innerHTML","hasChildNodes","childNodes","console","error","fromDom$1","fromTag","tag","node","fromText","text","createTextNode","dom","fromPoint$1","docElm","y","elementFromPoint","SugarElement","fromHtml","fromDom","fromPoint","is$2","element","selector","nodeType","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","all$1","base","querySelectorAll","one","querySelector","eq$1","e1","e2","regularContains","d1","d2","contains","ieContains","is$1","keys","each$1","obj","props","k","tupleMap","v","tuple","objAcc","internalFilter","onTrue","onFalse","filter$1","mapToArray","values","size","get$c","key","has$1","hasNonNullableKey","isEmpty","validSectionList","isValidSection","parentName","grid","rows","columns","address","row","column","detail","rowspan","colspan","detailnew","isNew","extended","isLocked","rowdetail","cells","section","rowdetailnew","elementnew","rowcells","bounds","startRow","startCol","finishRow","finishCol","columnext","colgroup","Function","nodeName","type$1","isType","isComment","isElement","isText","isDocument","isDocumentFragment","isTag","e","owner","ownerDocument","documentOrOwner","dos","defaultView","parent","parentNode","parentElement","parents","isRoot","stop","ret","rawParent","prevSibling","previousSibling","nextSibling","children$3","child$3","index","cs","firstChild","isShadowRoot","host","supported","Element","attachShadow","getRootNode","isSupported$1","getShadowRoot","getShadowHost","getOriginalEventTarget","event","el","isOpenShadowHost","composed","composedPath","shadowRoot","inBody","body","body$1","getBody$1","ancestors$4","predicate","children$2","descendants$1","result","ancestors$3","children$1","descendants","ClosestOrAncestor","is","ancestor","ancestor$2","closest$2","child$2","descendant$1","descend","child_1","res","ancestor$1","child$1","descendant","closest$1","rawSet","setAttribute","set$2","setAll$1","attrs","setOptions","remove$7","get$b","getAttribute","getOpt","removeAttribute","clone$2","attributes","attr","lhs","rhs","left","cat","lift2","oa","ob","bindFrom","flatten","oot","someIf","isSupported","style","getPropertyValue","internalSet","property","setProperty","internalRemove","removeProperty","set$1","setAll","css","get$a","styles","getComputedStyle","getUnsafeProperty","getRaw$2","raw","remove$6","copy$2","source","sourceDom","targetDom","cssText","getAttrValue","cell","fallback","getSpan","hasColspan","cellOrCol","hasRowspan","getCssValue","minWidth","minHeight","firstLayer","filterFirstLayer","lookup","tags","isRootOrUpperTable","elm","join","cells$1","columns$1","columnGroups","columnGroup","table","rows$1","fromRowsOrColGroups","elems","getSection","getParentSection","fromTable$1","columnGroups$1","fromPastedRows","addCells","gridRow","existingCells","before","after","newCells","setCells","addCell","mutateCell","mapCells","getCell","getCellElement","cellLength","extractGridDetails","cols","clone$1","cloneRow","cloneCell","LOCKED_COL_ATTR","getLockedColumnsFromTable","lockedColStr","lockedCols","getLockedColumnsFromGrid","locked","idx","lockedArr","_val","getAt","warehouse","access","findItem","item","filtered","filterItems","generateColumns","rowData","columnsGroup","columnIndex","colIndex","generate$1","list","tableOpt","lockedColumns","maxRows","maxColumns","rowCount","colgroupRows","currentRow","rowCell","occupiedColumnPosition","occupiedRowPosition","rowPosition","columnPosition","newpos","Math","max","_b","colgroup$1","colgroups","grid$1","fromTable","justCells","w","justColumns","hasColumns","getColumnAt","Warehouse","generate","inSelection","leftEdge","rightEdge","topEdge","bottomEdge","isWithin","isRectangular","isRect","detailIsWithin","j","getBounds","detailA","detailB","min","getAnyBox","startCell","finishCell","startCoords","finishCoords","sc","fc","getBox$1","moveBy$1","dest","d","intercepts$1","finish","inside","parentCell","innerCell","isContainedBy","c1","c2","moveBy","deltaRow","deltaColumn","getWarehouse","intercepts","first","last","nestedIntercepts","firstTable","lastTable","optStartCell","optLastCell","lastCell","getBox","before$4","marker","parent$1","insertBefore","after$5","sibling","append$1","prepend","firstChild$1","appendChild","appendAt","wrap","wrapper","before$3","elements","after$4","append","empty","textContent","rogue","remove$5","removeChild","unwrap","children","NodeValue","get","getOption","nodeValue","set","api$2","get$9","TagBoundaries","DomUniverse","clone","cloneNode","isBoundary","isEmptyTag","isNonEditable","comparePosition","other","copyAttributesTo","destination","as","isSpecial","getLanguage","up","closest","down","getRaw","remove","copyTo","insert","afterAll","appendAll","create","getText","setText","eq","universe","look","tail","oneAll","unsafeOne","commonElement","end","ancestors$2","ps1","ps2","prune","path","ind","pruned1","pruned2","shared","firstpath","secondpath","sharedOne$1","ancestors$1","universe$3","sharedOne","_universe","ancestors","lookupTable","container","identify","getIsRoot","rootTable","boxes","startTable","finishTable","ancestorCells","lca","lcaTable","finishAncestorCells","startAncestorCells","retrieve$1","sels","getLast","lastSelectedSelector","box","getEdges","firstSelectedSelector","expandTo","identified","shiftSelection","retrieve","retrieveBox","edges","sectionSelector","firstAncestor","lastAncestor","fA","lA","cases","constructors","adt","acase","count","keys$1","argLength","branches","branchKeys","allReqd","reqKey","foldArgs","log","label","params","Adt","multiple","single","cata$2","subject","onNone","onMultiple","onSingle","none$1","Selections","lazyRoot","getStart","selectedSelector","global$3","tinymce","util","Tools","resolve","original","isDeep","shallow","deep","shallowAs","copy$1","cloneChildren","mutate$1","Dimension","getOffset","h","getOuter","aggregate","properties","val","cumulativeInclusions","absoluteMax","needManualCalc","toNumber","px","getProp","getBoxSizing","calcContentBoxSize","upper","lower","paddingUpper","paddingLower","borderUpper","borderLower","getCalculatedHeight","boxSizing","height","getBoundingClientRect","offsetHeight","getCalculatedWidth","width","offsetWidth","getHeight$1","getWidth","getInnerWidth","api$1","get$8","getOuter$2","getInner","getRuntime$1","isValidCell","rowsArr","col","getBlock","isValid","getFallback","decide","inBlock","validInBlock","detailOption","c","isSingle","deduce","rest","aa","delta","next","extras","abs","onDirection","isLtr","isRtl","getDirection","api","get$7","getOuter$1","getRuntime","top","translate","SugarPosition","boxPosition","firstDefinedOrZero","absolute","win","documentElement","offsetLeft","offsetTop","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","viewport","rowInfo","colInfo","rtlEdge","pos","ltrEdge","getLeftEdge","getRightEdge","getTop$1","getTopEdge","getBottomEdge","findPositions","getInnerEdge","getOuterEdge","array","lines","cellOption","lastLine","negate","step","positions","optElements","ltr$1","rtl$1","detect$2","amount","units","unsupportedLength","fixed","relative","pattern","decimalDigits","signedInteger","exponentPart","dot","opt","input","unsignedDecimalLiteral","float","RegExp","isUnit","unit","accepted","check","parse","exec","unitRaw","rPercentageBasedSizeRegex","rPixelBasedSizeRegex","isCol$2","getPercentSize","outerGetter","innerGetter","relativeParent","setPixelWidth","setPercentageWidth","setHeight","getHeightValue","convert","number","getter","setter","newSize","total","floor","normalizePixelSize","getTotalHeight","get$6","span","getRaw$1","prop","getRawWidth$1","getRawHeight","getPercentageWidth","getPixelWidth$1","getHeight","getGenericWidth","setGenericWidth","getPixelTableWidth","getPercentTableWidth","isPercentSizing$1","isPixelSizing$1","isNoneSizing$1","percentageBasedSizeRegex","isCol$1","getRawW","getRawH","justCols","isValidColumn","supportsColWidths","getDimension","cellOpt","backups","getWidthFrom","columnCells","colFilter","getDeduced","deduced","getRawWidths","getPercentageWidths","tableSize","minCellWidth","cellWidth","pixelWidth","getPixelWidths","getHeightFrom","direction","getPixelHeights","getRawHeights","widthLookup","noneSize","zero","getWidths","getCellDelta","singleColumnWidth","setElementWidth","adjustTableWidth","isRelative","percentageSize","getFloatWidth","_delta","currentWidth","change","newWidth","pixelSize","newNext","chooseSize","percentMatch","getTableSize","TableSize","statsStruct","minRow","minCol","maxRow","maxCol","allCells","selectedCells","findSelectedStats","house","isSelected","totalColumns","totalRows","endRow","endCol","makeCell","seenSelected","rowIndex","td","fillInGaps","stats","needCell","clean","replica","widthDelta","emptyRows","getTableWidthDelta","colWidths","allColsWidth","selectedColsWidth","extract$1","replicaHouse","replicaStats","unselectedCells","nbsp","getEnd","isTextNodeWithCursorPosition","elementsWithCursorPosition","isCursorPosition","hasCursorPosition","last$1","descendantRtl","child","transferableAttributes","createCell","createCol","createColgroup","createRow$1","replace$1","pasteReplace","cloneFormats","oldCell","newCell","formats","first$1","firstText","formatSelector","clonedFormat","cloneAppropriateAttributes","validAttributes","attributeName","attribute","cellOperations","mutate","formatsToClone","cloneCss","prev","lastNode","newCol","colGap","gap","paste$1","nodes","getNodeName","getBody","editor","getPixelWidth","getPixelHeight","removePxSuffix","addPxSuffix","removeDataStyle","removeStyleAttribute","getRawWidth","getStyle","getAttrib","isPercentage$1","isPixel","getSelectionStart","selection","getSelectionEnd","selections","unmergable","hasSpan","hasRowOrColSpan","mergable","ephemera","strSelected","strSelectedSelector","strAttributeSelector","strFirstSelected","strFirstSelectedSelector","strLastSelected","strLastSelectedSelector","attributeSelector","selected","firstSelected","lastSelected","noMenu","forMenu","paste","clipboard","generators","pasteRows","getSelectionCellFallback","getSelectionFromSelector","initCell","cellName","getSelectionCellOrCaption","getSelectionCell","getCellsFromSelection","getRowsFromSelection","rowsOpt","extractSelected","serializeElements","serializer","serialize","getTextContent","innerText","registerEvents","actions","on","multiCellContext","preventDefault","content","format","isTable","getDoc","targets","pasteCells","focus","adt$7","only","middle","right","ColumnContext","neighbours","determine","resize","context","onOnly","onLeft","calcLeftEdgeDeltas","onMiddle","calcMiddleDeltas","onRight","calcRightEdgeDeltas","measures","recalculateWidthForCells","widths","recalculateWidthForColumns","groups","recalculateHeightForCells","heights","matchRowHeight","sumUp","recalculate","recalculateAndApply","newSizes","adjustWidth","resizing","isLastColumn","clampedStep","clampTableDelta","deltas","newWidths","dx","resizeTable","adjustHeight","newHeights","dy","newCellSizes","newRowSizes","adjustAndRedistributeWidths$1","_table","details","resizeBehaviour","sizes","tablePixelWidth","calcRedestributedWidths","pixelDelta","adjustWidthTo","_info","surround","startIndex","endIndex","results","clampDeltaHelper","minCellSize","diff","clampNegativeDelta","clampDelta","calcFixedDeltas","clampedDelta","calcRelativeDeltas","ratio","newThis","_prev","resizer","totalWidth","tableWidth","ratio_1","preserveTable","_index","_minCellSize","maxDelta","_totalWidth","_pixelDelta","_isRelative","isResizable","view","origin","detached","editable","ResizeWire","adt$6","invalid","pixels","percent","validateFor","rawAmount","Size","redistributeToPercent","colType","pc","redistributeToPx","newTotalWidth","scale","redistributeEmpty","newWidthType","redistributeValues","_pc","redistribute$1","newType","floats","normalize","sum","roundDown","floored","remainder","add$3","scan","output","round","validate","redistributeToW","redistributeToColumns","redistributeToH","getUnit","redistribute","optWidth","optHeight","widthUnit","oldWidths","nuWidths","newHeight","hUnit","totalHeight","oldHeights","nuHeights","isPercentSizing","isPixelSizing","isNoneSizing","getGridSize","Event","fields","handlers","handler","unbind","trigger","create$4","typeDefs","registry","rate","timer","cancel","clearTimeout","throttle","setTimeout","reqMessage","required","unsuppMessage","unsupported","validateStrArr","invalidTypeMessage","incorrect","checkDupes","everything","sorted","dupe","handleUnsupported","baseWith","req","invalidKeys","handleExact","exactly","DragMode","DragSink","DragApi","InDrag","previous","reset","update","mode","old","compare","onEvent","dataOption","extract","data","offset","events","move","NoDrag","Movement","noDragState","inDragState","dragState","off","isOn","setup","mutation","settings","active","movement","drop","sink","throttledDrop","go","mousemove","runIfActive","forceDrop","delayDrop","destroy","mkEvent","prevent","kill","fromRawEvent$1","rawEvent","stopPropagation","clientX","clientY","handle$2","binder","useCapture","wrapped","addEventListener","bind$1","removeEventListener","fromRawEvent","read","split","add$2","remove$4","supports","classList","get$5","add$1","clazz","remove$3","add","cleanClass","remove$2","has","namespace","dashNamespace","styles$1","resolve$1","Blocker","options","layerClass","position","dragApi","blocker","mdown","mup","mmove","mout","MouseDrag","transform$1","isEditable$1","assumeEditable","isContentEditable","contentEditable","Mutation","drag","BarMutation","delegate","xDelta","yDelta","bar","resizeBar","resizeRowBar","resizeColBar","BAR_THICKNESS","resizableRows","resizableColumns","resizableCols","colElmOpt","wire","drawBar","cpOption","cp","refreshCol","colPositions","tableHeight","colBar","refreshRow","rowPositions","rowBar","refreshGrid","warhouse","resizableRowBars","resizableRowPositions","_pos","barIndex","resizableColBars","resizableColPositions","refresh","bars","hide","show","isRowBar","isColBar","resizeBarDragging","BarManager","hoverTable","getResizer","_dataRow","_dataCol","currentCol","getDelta","dir","newX","oldX","startAdjust","mousedown","findClosestEditableTable","mouseover","destroy$1","refresh$1","tbl","hideBars","showBars","create$3","lazySizing","hdirection","vdirection","manager","beforeResize","afterResize","startDrag","_event","TableResize","fireNewRow","fire","fireNewCell","fireObjectResizeStart","fireObjectResized","fireTableSelectionChange","otherCells","fireTableSelectionClear","fireTableModified","styleModified","structure","structureModified","styleAndStructureModified","defaultTableToolbar","defaultStyles","defaultCellBorderWidths","title","defaultCellBorderStyles","determineDefaultStyles","isPixelsForced","parentBlock","getParent","isBlock","contentWidth","isResponsiveForced","_value","defaultAttributes","border","defaultColumnResizingBehaviour","getTableSizingMode","getParam","getTableResponseWidth","getTableBorderWidths","getTableBorderStyles","getDefaultAttributes","getDefaultStyles","hasTableResizeBars","hasTabNavigation","hasAdvancedCellTab","hasAdvancedRowTab","hasAdvancedTableTab","hasAppearanceOptions","hasTableGrid","shouldStyleWithCss","getCellClassList","getRowClassList","getTableClassList","isPercentagesForced","getToolbar","useColumnGroup","getTableHeaderType","defaultValue","validValues","getColumnResizingBehaviour","validModes","givenMode","isPreserveTableColumnResizing","isResizeTableColumnResizing","getCloneElements","cloneElements","hasObjectResizing","objectResizing","getTableBackgroundColorMap","getTableBorderColorMap","get$4","cleanupLegacyAttributes","convertToPercentSize","convertToPixelSize","convertToNoneSize","rowElements","enforcePercentage","enforcePixels","enforceNone","syncPixels","computedWidth","createContainer","padding","margin","get$3","inline","remove$1","barResizerPrefix","getResizeHandler","selectionRng","startW","startRawW","lazyResize","lazyWire","lazyResizingBehaviour","getNumColumns","afterCornerResize","isRightEdgeResize","percentW","targetPercentW","sz","rawWire","getRng","rawTable","rng","setRng","undoManager","targetElm","select","addClass","origin_1","isReadOnly","point","scan$1","toEnd","freefallRtl$2","freefallRtl$1","universe$2","freefallRtl","halve","main","isHeaderCell","isHeaderCells","getRowHeaderType","isHeaderRow","getRowType$1","findCommonCellType","subType","headerCells","findCommonRowType","rowTypes","hasHeader","hasFooter","hasBody","findTableRowHeaderType","rowType","transformCell","substitution","transformRow","fixedCell","sectionCells","newSection","getTableSectionType","TableSection","setIfNot","ignore","insert$1","generateSection","sectionName","render$1","newRows","syncRows","gridSection","tr","syncColGroup","colGroup","renderSection","sync","sectionElems","removeSection","renderOrRemoveSection","headSection","bodySection","footSection","columnGroupsSection","clonedCell","getColumn","getRow","findDiff","comp","subgrid","isColRow","toDetails","seen","updateSeen","toGrid","colgroupCols","rowCells","rowDetail","fromWarehouse","toDetailList","findInWarehouse","extractCells","cell$1","lc","run","operation","adjustment","postAction","genWrappers","behaviours","tableSection","model","cursor","out","newElements","tableSizing","sizing","onPaste","onPasteByEditor","onMergable","_warehouse","onUnmergable","onCells","onUnlockedCells","isUnlockedTableCell","allUnlocked","onUnlockedMergable","mergeable","onUnlockedUnmergable","merge$2","unmerge","currentCell","currentCellElm","isToReplace","uniqueCells","splitCols","prevCell","splitRows","rowPrevCells","replacement","_loop_1","sub","value$1","o","_opt","_f","mapError","_","onValue","toOptional","isValue","isError","message","onError","fromOption","err","Result","measure","startAddress","gridA","gridB","rowRemainder","colRemainder","colRequired","rowRequired","rowDelta","colDelta","measureWidth","colLengthA","colLengthB","measureHeight","rowLengthA","rowLengthB","generateElements","generator","rowFill","exampleRow","colFill","newChildren","lockedColFill","colNum","newChild","tailor","fillCols","fillRows","gridWidth","isLastColLocked","modifiedCols","newLockedColumns","isSpanning","matching","mergeTables","mergeHeight","mergeWidth","lockedColumnObj","skippedCol","gridBColIndex","newCellElm","getValidStartAddress","currentStartAddress","gridColLength","adjustedRowAddress","possibleColAddresses","validColAddress","getLockedColumnsWithinBounds","merge$1","validStartAddress","gridBRows","lockedColumnsWithinBounds","fittedGrid","newLockedColumnsWithinBounds","insertCols","fittedNewGrid","secondDelta","fittedOldGrid","insertRows","oldCols","oldRows","newLocked","secondDiff","fittedGridB","insertRowAt","example","newRow","ex","withinSpan","getElementFor","insertColumnAt","deleteColumnsAt","deleteRowsAt","notInStartRow","notInStartColumn","isDuplicatedCell","rowReplacerPredicate","targetRow","columnHeaders","entireTableIsHeader","_rowIndex","columnReplacePredicate","targetColumn","rowHeaders","_colIndex","determineScope","applyScope","newScope","isInHeader","getScope","oppositeScope","rowScopeGenerator","columnScopeGenerator","substitute","replaceIn","replacer","genScope","shouldReplace","isTarget","newCell_1","getColumnCells","getRowCells","replaceColumns","indexes","shouldReplaceCell","scopeGenerator","replaceRows","_cell","newGrid","replaceCells","targetCells","uniqueColumns","uniqueCheck","columnExists","currentDetail","isCol","isColgroup","isRow$1","elementToData","modification","toData","nuCell","nuRow","recent","getOrInit","transform","makeNew","replaceOrInit","getScopeAttribute","merging","merge","getScopeProperty","stringAttributes","baseScope_1","scopes_1","isMixed","Generators","blockList","isList$1","tagName","isBlock$1","isEmptyTag$1","universe$1","isList","isBr","advancedBr","isListItem","siblingIsBlock","rightSibling","markCell","rightSiblingIsBlock","markContent","contents","isEditable","outcome","findEditableCursorPosition","elementFromGrid","bundle","cursorElement","uniqueRows","rowCompilation","rowExists","opInsertRowsBefore","targetIndex","newG","opInsertRowsAfter","opInsertColumnsBefore","extractDetail","opInsertColumnsAfter","opMakeColumnsHeader","initialGrid","columnIndexes","opMakeCellsHeader","opUnmakeColumnsHeader","opUnmakeCellsHeader","makeRowsSection","rowIndexes","opMakeRowsHeader","opMakeRowsBody","opMakeRowsFooter","opEraseColumns","_comparator","_genWrappers","maxColIndex","opEraseRows","maxRowIndex","opMergeCells","opUnmergeCells","unmerge$1","opPasteCells","pasteDetails","gridify","wh","mergedGrid","gridifyRows","opPasteColsBefore","opPasteColsAfter","opPasteRowsBefore","opPasteRowsAfter","opGetColumnsType","lastSelectedCell","minColRange","maxColRange","selectedColumnCells","opGetCellsType","opGetRowsType","minRowRange","maxRowRange","selectedRows","adjustAndRedistributeWidths","firstColumnIsLocked","lastColumnIsLocked","getColumnsWidth","uniqueCols","colWidth","insertColumnsExtractor","checkLocked","eraseColumnsExtractor","pasteColumnsExtractor","headerCellGenerator","bodyCellGenerator","insertRowsBefore","insertRowsAfter","insertColumnsBefore","insertColumnsAfter","eraseColumns","eraseRows","makeColumnsHeader","unmakeColumnsHeader","makeRowsHeader","makeRowsBody","makeRowsFooter","makeCellsHeader","unmakeCellsHeader","mergeCells","unmergeCells","pasteColsBefore","pasteColsAfter","pasteRowsBefore","pasteRowsAfter","getColumnsType","getCellsType","getRowsType","TableActions","cellSelection","isTableBody","lastRowGuard","lastColumnGuard","colMutationOp","setSelectionFromAction","firstCell","clear","createRng","selectNode","des","setStart","setEnd","execute","guard","effect","noEvents","range","deleteRow","deleteColumn","insertRowsBefore$1","insertRowsAfter$1","insertColumnsBefore$1","insertColumnsAfter$1","mergeCells$1","unmergeCells$1","pasteColsBefore$1","pasteColsAfter$1","pasteRowsBefore$1","pasteRowsAfter$1","pasteCells$1","makeCellsHeader$1","unmakeCellsHeader$1","makeColumnsHeader$1","unmakeColumnsHeader$1","makeRowsHeader$1","makeRowsBody$1","makeRowsFooter$1","getTableCellType","getTableColType","getTableRowType","DefaultRenderOptions","colGroups","tableHeaderCell","tableCell","tableColumn","createRow","createGroupRow","createRows","render","headerType","renderOpts","rowHeadersGoInThead","actualRowHeaders","thead","theadRowHeaders","theadRows","tbody","numRows","numRowHeaders","tbodyRows","get$2","placeCaretInCell","collapse","selectFirstCellInTable","tableElm","fireEvents","isPercentage","colHeaders","insertContent","addVisual","insertTableWithDataValidation","errorMsg","checkInput","headerRows","headerColumns","getClipboardElements","getClipboard","setClipboardElements","setClipboard","elmsOpt","insertTable","getApi","resizeHandler","selectionTargets","setClipboardRows","setRows","getClipboardRows","getRows","setClipboardCols","setColumns","getClipboardCols","getColumns","constrainSpan","currentColspan","generateColGroup","colsToCopy","copiedCols","clonedCol","fakeColgroup","generateRows","cellsToCopy","copiedCells","fakeTR","copyCols","fakeColGroups","fakeRows","copyRows","slicedGrid","filteredGrid","slicedDetails","global$2","getTDTHOverallStyle","firstChildStyle","checkChildren","elms","currentStyle","applyAlign","formatter","applyVAlign","unApplyAlign","unApplyVAlign","verticalAlignValues","hexColour","shorthandRegex","longformRegex","isHexString","hex","normalizeHex","toUpperCase","fromString$1","toHex","component","fromRgba","rgbaColour","red","green","blue","rgbRegex","rgbaRegex","alpha","fromStringValues","g","fromString","rgbaString","rgbMatch","rgbaMatch","anyToHex","color","canvas","canvasContext","getContext","clearRect","fillStyle","fillRect","rgba","getImageData","Cell","initial","singleton","doRevoke","revoke","isSet","unbindable","onSetupToggle","formatName","formatValue","boundCallback","init","checkNode","setActive","formatChanged","initialized","isListGroup","buildListItems","items","menu","buildMenuItems","onAction","getSubmenuItems","onSetup","applyTableCellStyle","execCommand","filterNoneItem","generateMenuItemsCallback","callback","buildColorMenu","colorList","colorMap","entry","fancytype","initData","colors","allowCustomColors","changeRowHeader","currentType","queryCommandValue","changeColumnHeader","getClassList$1","classes","getItems$2","getAdvancedTab","dialogName","emptyBorderStyle","advTabItems","borderWidth","modifiers","testTruthy","setAttrib","setStyle","setFormat","DomModifier","normal","ifTruthy","rgbToHex","extractAdvancedStyles","borderwidth","borderstyle","bordercolor","backgroundcolor","getSharedValues","baseData","comparisonData","itemValue","itemKey","comparisonValue","getAlignment","matchNode","getHAlignment","getVAlignment","extractDataFromSettings","hasAdvTableTab","extractAdvancedStyleData","defaultData","cellspacing","cellpadding","caption","class","align","getBorder","advStyle","getCellPaddingCellSpacing","spacing","getRowType","extractDataFromTableElement","optBorderWidth","extractDataFromRowElement","extractDataFromCellElement","colElm","celltype","halign","valign","getSelectedCells","cellA","cellB","updateSimpleProps$1","modifier","colModifier","updateAdvancedProps$1","applyStyleData$1","isSingleCell","cellElm","applyStructureData$1","no_events","applyCellData","oldData","modifiedData","onSubmitCellForm","getData","close","transact","cellsData","open$2","dialogTabPanel","tabs","dialogPanel","windowManager","open","buttons","primary","initialData","onSubmit","getClassList","formChildren","getItems$1","updateSimpleProps","updateAdvancedProps","applyStyleData","isSingleRow","rowElm","applyStructureData","applyRowData","typeModified_1","styleModified_1","onSubmitRowForm","open$1","rowsData","getItems","insertNewTable","rowColCountItems","inputMode","alwaysItems","appearanceItems","alignmentItem","classListItem","styleTDTH","applyDataToElement","serializeStyle","setAttribs","onSubmitTableForm","captionElm","captionModified","generalPanel","nonAdvancedForm","advancedForm","dialogBody","getSelectionStartCellOrCaption","getSelectionStartCell","registerCommands","eraseTable","cellOrCaption","setContent","setCursorLocation","nodeChanged","setSizingMode","isForcedSizing","getTableFromCell","performActionOnSelection","action","toggleTableClass","_ui","toggle","toggleTableCellClass","allHaveClass","formatterAction","toggleCaption","postExecute","_data","actOnSelection","copyRowSelection","copyColSelection","pasteOnSelection","clonedRows","actOnType","getAction","mceTableSplitCells","mceTableMergeCells","mceTableInsertRowBefore","mceTableInsertRowAfter","mceTableInsertColBefore","mceTableInsertColAfter","mceTableDeleteCol","mceTableDeleteRow","mceTableCutCol","mceTableCutRow","mceTableCopyCol","mceTableCopyRow","mceTablePasteColBefore","mceTablePasteColAfter","mceTablePasteRowBefore","mceTablePasteRowAfter","mceTableDelete","mceTableCellToggleClass","mceTableToggleClass","mceTableToggleCaption","mceTableSizingMode","mceTableCellType","mceTableColType","mceTableRowType","func","addCommand","mceTableProps","mceTableRowProps","mceTableCellProps","getFormatName","validArgs","registerQueryCommands","lookupOnSelection","addQueryValueHandler","Clipboard","clearRows","clearColumns","genericBase","remove_similar","inherit","cellBase","cellFormats","tablecellbackgroundcolor","backgroundColor","tablecellverticalalign","tablecellbordercolor","borderColor","tablecellclass","tableclass","tablecellborderstyle","borderStyle","tablecellborderwidth","registerFormats","register","adt$5","CellLocation","walk","isEligible","forwards","newIndex","detect$1","detection","create$2","soffset","foffset","SimRange","adt$4","cata$1","onBefore","onOn","onAfter","getStart$1","situ","before$2","after$3","Situ","cata","adt$3","domRange","exact","exactFromRange","simRange","startContainer","startSitu","_finishSitu","_soffset","_finish","_foffset","getWin","SimSelection","createRange","selectNodeContents","selectNodeContentsUsing","setStartBefore","setStartAfter","setFinish","setEndBefore","setEndAfter","relativeToNative","finishSitu","exactToNative","toRect","rect","bottom","getFirstRect$1","rects","getClientRects","adt$2","ltr","rtl","fromRange","startOffset","endContainer","endOffset","getRanges","doDiagnose","ranges","collapsed","reversed","rev","diagnose","asLtrRange","diagnosis","searchForPoint","rectForOffset","maxX","curDeltaX","inRect","locateOffset","textnode","rangeForOffset","locate$1","foundRect","searchInChildren","locateNode","locate","boundedX","boundedY","COLLAPSE_TO_LEFT","COLLAPSE_TO_RIGHT","getCollapseDirection","createCollapsedNode","collapseDirection","locateInElement","cursorRange","locateInEmpty","caretPositionFromPoint","offsetNode","caretRangeFromPoint","searchTextNodes","searchFromPoint","availableSearch","beforeSpecial","name$1","preprocessRelative","preprocessExact","preprocess","makeRange","after$2","same","getNativeSelection","getSelection","doSetNativeRange","removeAllRanges","addRange","doSetRange","setLegacyRtlRange","extend","setRangeFromRelative","setBaseAndExtent","setExact","setRelative","toNative","getDomRange","readRange","rangeCount","firstRng","getRangeAt","lastRng","doGetExact","anchorNode","focusNode","anchor","focus_1","anchorOffset","focusOffset","setToElement","selectNodeContents$1","rngGetter","getExact","sel","get$1","getFirstRect","getAtPoint","global$1","forward","go$1","backward","getCellFirstCursorPosition","rootElements","handle$1","keyCode","TAB","body_1","isRoot_1","shiftKey","navigation","create$1","Response","Situs","convertToRange","makeSitus","selectRange","cellSel","annotations","updateSelection","newSels","clearBeforeUpdate","traverse","backtrack","_direction","transition","sidestep","advance","successors","rules","ruleOpt","succ","rule","left$1","right$1","Walkers","hone","isLeaf","before$1","seekLeft$1","after$1","seekRight$1","seekLeft","seekRight","adt$1","success","failedUp","failedDown","isOverlapping","bridge","beforeBounds","getRect","afterBounds","isRow","verify","beforeOffset","afterOffset","failure","afterCell","beforeCell","_sharedRow","onSuccess","onFailedUp","onFailedDown","BeforeAfter","inParent","indexInParent","gatherer","cand","gather","handleBr","findBr","handleParent","br","adjacent","tryBr","tgt","process","analysis","_message","moveDown","caret","moveUp","getTop","getBottom","getPartialBox","getRangedRect","toCaret","getElemBox","getBoxAt","getEntireBox","JUMP_SIZE","NUM_RETRIES","retry","isOutside","inOutsideBlock","adjustDown","guessBox","lowerCaret","adjustUp","higherCaret","upMovement","adjuster","downMovement","isAtTable","adjustForTable","numRetries","adjustTil","situsFromPoint","guess","newCaret","ieTryDown","ieTryUp","checkScroll","adjusted","getInnerHeight","moved","scrollBy","Retries","tryUp","tryDown","getJumpSize","MAX_RETRIES","findSpot","brNeighbour","fromSitus","tryCursor","situs","tryAgain","tryAt","otherRetry","ieRetry","handle","spot","inSameTable","simulate","navigate","precheck","firstUpCheck","lastOffset","lastDownCheck","findCell","MouseSelection","clearstate","applySelection","singleCell","isNonEditableCell","isCellClosestContentEditable","selectContents","mouseup","isKey","keycode","isUp","isDown","isNavigation","isBackward","isForward","_DOC","by","WindowBridge","exactAdt","clearSelection","collapseSelection","toStart","setSelection","setRelativeSelection","innerHeight","getScrollY","rc","mouse","keyboard","clearToNavigate","keydown","realEvent","which","update$1","attempts","keyup","external","removeClasses","byClass","addSelectionClass","removeSelectionClasses","byAttr","onSelection","onClear","removeSelectionAttributes","addSelectionAttribute","SelectionAnnotation","getUpOrLeftCells","upGrid","upDetails","slicedCells","getDownOrRightCells","downGrid","downDetails","getOtherCells","upOrLeftCells","downOrRightCells","global","hasInternalTarget","CellSelection","_e","syncSelection","mouseHandlers","keyHandlers","external$1","hasShiftKey","handleResponse","response","ns","wrappedEvent","isLeftMouse","button","isLeftButtonPressed","dragStart","mouseDown","mouseOver","mouseUp","getDoubleTap","lastTarget","lastTimeStamp","touchEnd","lT","lTS","timeStamp","doubleTap","getSelectionTargets","changeHandlers","selectionDetails","isCaption","isDisabledForSelection","findTargets","startCellOrCaption","endTable","getExtractedDetails","onAny","onFirst","onLast","unmergeable","resetTargets","setupHandler","isDisabled","setDisabled","onSetupWithToggle","isActive","isDisabledFromLocked","lockedDisable","onSetupTable","onSetupCellOrRow","onSetupColumn","onSetupPasteable","getClipboardData","onSetupPasteableColumn","onSetupMergeable","_targets","onSetupUnmergeable","onSetupTableWithCaption","onSetupTableHeaders","command","onSetupTableRowHeaders","onSetupTableColumnHeaders","addButtons","ui","addMenuButton","tooltip","icon","fetch","cmd","addButton","tableClassList","tableCellClassList","addToggleButton","addToolbars","toolbar","addContextToolbar","addMenuItems","insertTableAction","numColumns","tableProperties","deleteTable","addMenuItem","addNestedMenuItem","addContextMenu","addToggleMenuItem","Plugin","addTempAttr","Plugin$1"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.10.2 (2021-11-17)\n */\n(function () {\n    'use strict';\n\n    var typeOf = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType$1 = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var eq$2 = function (t) {\n      return function (a) {\n        return t === a;\n      };\n    };\n    var isString = isType$1('string');\n    var isObject = isType$1('object');\n    var isArray = isType$1('array');\n    var isNull = eq$2(null);\n    var isBoolean = isSimpleType('boolean');\n    var isUndefined = eq$2(undefined);\n    var isNullable = function (a) {\n      return a === null || a === undefined;\n    };\n    var isNonNullable = function (a) {\n      return !isNullable(a);\n    };\n    var isFunction = isSimpleType('function');\n    var isNumber = isSimpleType('number');\n\n    var noop = function () {\n    };\n    var compose = function (fa, fb) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return fa(fb.apply(null, args));\n      };\n    };\n    var compose1 = function (fbc, fab) {\n      return function (a) {\n        return fbc(fab(a));\n      };\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    var tripleEquals = function (a, b) {\n      return a === b;\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var not = function (f) {\n      return function (t) {\n        return !f(t);\n      };\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none$2 = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = identity;\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none$2,\n        each: noop,\n        bind: none$2,\n        exists: never,\n        forall: always,\n        filter: function () {\n          return none$2();\n        },\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        }\n      };\n      return me;\n    };\n    var from$1 = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none$2,\n      from: from$1\n    };\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var contains$2 = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var range$1 = function (num, f) {\n      var r = [];\n      for (var i = 0; i < num; i++) {\n        r.push(f(i));\n      }\n      return r;\n    };\n    var map$1 = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each$2 = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var partition = function (xs, pred) {\n      var pass = [];\n      var fail = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        var arr = pred(x, i) ? pass : fail;\n        arr.push(x);\n      }\n      return {\n        pass: pass,\n        fail: fail\n      };\n    };\n    var filter$2 = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x, i) {\n        acc = f(acc, x, i);\n      });\n      return acc;\n    };\n    var foldl = function (xs, f, acc) {\n      each$2(xs, function (x, i) {\n        acc = f(acc, x, i);\n      });\n      return acc;\n    };\n    var findUntil = function (xs, pred, until) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(x);\n        } else if (until(x, i)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var find$1 = function (xs, pred) {\n      return findUntil(xs, pred, never);\n    };\n    var findIndex = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(i);\n        }\n      }\n      return Optional.none();\n    };\n    var flatten$1 = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind$2 = function (xs, f) {\n      return flatten$1(map$1(xs, f));\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var mapToObject = function (xs, f) {\n      var r = {};\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        r[String(x)] = f(x, i);\n      }\n      return r;\n    };\n    var pure = function (x) {\n      return [x];\n    };\n    var sort$1 = function (xs, comparator) {\n      var copy = nativeSlice.call(xs, 0);\n      copy.sort(comparator);\n      return copy;\n    };\n    var get$d = function (xs, i) {\n      return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n    };\n    var head = function (xs) {\n      return get$d(xs, 0);\n    };\n    var last$2 = function (xs) {\n      return get$d(xs, xs.length - 1);\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Optional.none();\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n    function __spreadArray(to, from, pack) {\n      if (pack || arguments.length === 2)\n        for (var i = 0, l = from.length, ar; i < l; i++) {\n          if (ar || !(i in from)) {\n            if (!ar)\n              ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n          }\n        }\n      return to.concat(ar || Array.prototype.slice.call(from));\n    }\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n        return r;\n      };\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu$2(group(1), group(2));\n    };\n    var detect$6 = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown$2();\n      }\n      return find(versionRegexes, cleanedAgent);\n    };\n    var unknown$2 = function () {\n      return nu$2(0, 0);\n    };\n    var nu$2 = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu$2,\n      detect: detect$6,\n      unknown: unknown$2\n    };\n\n    var detectBrowser$1 = function (browsers, userAgentData) {\n      return findMap(userAgentData.brands, function (uaBrand) {\n        var lcBrand = uaBrand.brand.toLowerCase();\n        return find$1(browsers, function (browser) {\n          var _a;\n          return lcBrand === ((_a = browser.brand) === null || _a === void 0 ? void 0 : _a.toLowerCase());\n        }).map(function (info) {\n          return {\n            current: info.name,\n            version: Version.nu(parseInt(uaBrand.version, 10), 0)\n          };\n        });\n      });\n    };\n\n    var detect$5 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find$1(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$5(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$5(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n\n    var removeFromStart = function (str, numChars) {\n      return str.substring(numChars);\n    };\n\n    var checkRange = function (str, substr, start) {\n      return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n    };\n    var removeLeading = function (str, prefix) {\n      return startsWith(str, prefix) ? removeFromStart(str, prefix.length) : str;\n    };\n    var contains$1 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var startsWith = function (str, prefix) {\n      return checkRange(str, prefix, 0);\n    };\n    var endsWith = function (str, suffix) {\n      return checkRange(str, suffix, str.length - suffix.length);\n    };\n    var blank = function (r) {\n      return function (s) {\n        return s.replace(r, '');\n      };\n    };\n    var trim = blank(/^\\s+|\\s+$/g);\n    var isNotEmpty = function (s) {\n      return s.length > 0;\n    };\n    var isEmpty$1 = function (s) {\n      return !isNotEmpty(s);\n    };\n    var toFloat = function (value) {\n      var num = parseFloat(value);\n      return isNaN(num) ? Optional.none() : Optional.some(num);\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains$1(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        brand: 'Chromium',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('mac os x'),\n        versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      },\n      {\n        name: 'ChromeOS',\n        search: checkContains('cros'),\n        versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isBrowser = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge),\n        isChrome: isBrowser(chrome),\n        isIE: isBrowser(ie),\n        isOpera: isBrowser(opera),\n        isFirefox: isBrowser(firefox),\n        isSafari: isBrowser(safari)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var chromeos = 'ChromeOS';\n    var unknown = function () {\n      return nu({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isOS = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows),\n        isiOS: isOS(ios),\n        isAndroid: isOS(android),\n        isOSX: isOS(osx),\n        isLinux: isOS(linux),\n        isSolaris: isOS(solaris),\n        isFreeBSD: isOS(freebsd),\n        isChromeOS: isOS(chromeos)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown,\n      nu: nu,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd),\n      chromeos: constant(chromeos)\n    };\n\n    var detect$4 = function (userAgent, userAgentDataOpt, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = userAgentDataOpt.bind(function (userAgentData) {\n        return detectBrowser$1(browsers, userAgentData);\n      }).orThunk(function () {\n        return detectBrowser(browsers, userAgent);\n      }).fold(Browser.unknown, Browser.nu);\n      var os = detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$4 };\n\n    var mediaMatch = function (query) {\n      return window.matchMedia(query).matches;\n    };\n    var platform = cached(function () {\n      return PlatformDetection.detect(navigator.userAgent, Optional.from(navigator.userAgentData), mediaMatch);\n    });\n    var detect$3 = function () {\n      return platform();\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n\n    var COMMENT = 8;\n    var DOCUMENT = 9;\n    var DOCUMENT_FRAGMENT = 11;\n    var ELEMENT = 1;\n    var TEXT = 3;\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom$1(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom$1(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom$1(node);\n    };\n    var fromDom$1 = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint$1 = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom$1);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml$1,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom$1,\n      fromPoint: fromPoint$1\n    };\n\n    var is$2 = function (element, selector) {\n      var dom = element.dom;\n      if (dom.nodeType !== ELEMENT) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n    };\n    var all$1 = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? [] : map$1(base.querySelectorAll(selector), SugarElement.fromDom);\n    };\n    var one = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n    };\n\n    var eq$1 = function (e1, e2) {\n      return e1.dom === e2.dom;\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom;\n      var d2 = e2.dom;\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return documentPositionContainedBy(e1.dom, e2.dom);\n    };\n    var contains = function (e1, e2) {\n      return detect$3().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n    };\n    var is$1 = is$2;\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var objAcc = function (r) {\n      return function (x, i) {\n        r[i] = x;\n      };\n    };\n    var internalFilter = function (obj, pred, onTrue, onFalse) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        (pred(x, i) ? onTrue : onFalse)(x, i);\n      });\n      return r;\n    };\n    var filter$1 = function (obj, pred) {\n      var t = {};\n      internalFilter(obj, pred, objAcc(t), noop);\n      return t;\n    };\n    var mapToArray = function (obj, f) {\n      var r = [];\n      each$1(obj, function (value, name) {\n        r.push(f(value, name));\n      });\n      return r;\n    };\n    var values = function (obj) {\n      return mapToArray(obj, identity);\n    };\n    var size = function (obj) {\n      return keys(obj).length;\n    };\n    var get$c = function (obj, key) {\n      return has$1(obj, key) ? Optional.from(obj[key]) : Optional.none();\n    };\n    var has$1 = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n    var hasNonNullableKey = function (obj, key) {\n      return has$1(obj, key) && obj[key] !== undefined && obj[key] !== null;\n    };\n    var isEmpty = function (r) {\n      for (var x in r) {\n        if (hasOwnProperty.call(r, x)) {\n          return false;\n        }\n      }\n      return true;\n    };\n\n    var validSectionList = [\n      'tfoot',\n      'thead',\n      'tbody',\n      'colgroup'\n    ];\n    var isValidSection = function (parentName) {\n      return contains$2(validSectionList, parentName);\n    };\n    var grid = function (rows, columns) {\n      return {\n        rows: rows,\n        columns: columns\n      };\n    };\n    var address = function (row, column) {\n      return {\n        row: row,\n        column: column\n      };\n    };\n    var detail = function (element, rowspan, colspan) {\n      return {\n        element: element,\n        rowspan: rowspan,\n        colspan: colspan\n      };\n    };\n    var detailnew = function (element, rowspan, colspan, isNew) {\n      return {\n        element: element,\n        rowspan: rowspan,\n        colspan: colspan,\n        isNew: isNew\n      };\n    };\n    var extended = function (element, rowspan, colspan, row, column, isLocked) {\n      return {\n        element: element,\n        rowspan: rowspan,\n        colspan: colspan,\n        row: row,\n        column: column,\n        isLocked: isLocked\n      };\n    };\n    var rowdetail = function (element, cells, section) {\n      return {\n        element: element,\n        cells: cells,\n        section: section\n      };\n    };\n    var rowdetailnew = function (element, cells, section, isNew) {\n      return {\n        element: element,\n        cells: cells,\n        section: section,\n        isNew: isNew\n      };\n    };\n    var elementnew = function (element, isNew, isLocked) {\n      return {\n        element: element,\n        isNew: isNew,\n        isLocked: isLocked\n      };\n    };\n    var rowcells = function (element, cells, section, isNew) {\n      return {\n        element: element,\n        cells: cells,\n        section: section,\n        isNew: isNew\n      };\n    };\n    var bounds = function (startRow, startCol, finishRow, finishCol) {\n      return {\n        startRow: startRow,\n        startCol: startCol,\n        finishRow: finishRow,\n        finishCol: finishCol\n      };\n    };\n    var columnext = function (element, colspan, column) {\n      return {\n        element: element,\n        colspan: colspan,\n        column: column\n      };\n    };\n    var colgroup = function (element, columns) {\n      return {\n        element: element,\n        columns: columns\n      };\n    };\n\n    typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom.nodeName;\n      return r.toLowerCase();\n    };\n    var type$1 = function (element) {\n      return element.dom.nodeType;\n    };\n    var isType = function (t) {\n      return function (element) {\n        return type$1(element) === t;\n      };\n    };\n    var isComment = function (element) {\n      return type$1(element) === COMMENT || name(element) === '#comment';\n    };\n    var isElement = isType(ELEMENT);\n    var isText = isType(TEXT);\n    var isDocument = isType(DOCUMENT);\n    var isDocumentFragment = isType(DOCUMENT_FRAGMENT);\n    var isTag = function (tag) {\n      return function (e) {\n        return isElement(e) && name(e) === tag;\n      };\n    };\n\n    var owner = function (element) {\n      return SugarElement.fromDom(element.dom.ownerDocument);\n    };\n    var documentOrOwner = function (dos) {\n      return isDocument(dos) ? dos : owner(dos);\n    };\n    var defaultView = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n    };\n    var parent = function (element) {\n      return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n    };\n    var parentElement = function (element) {\n      return Optional.from(element.dom.parentElement).map(SugarElement.fromDom);\n    };\n    var parents = function (element, isRoot) {\n      var stop = isFunction(isRoot) ? isRoot : never;\n      var dom = element.dom;\n      var ret = [];\n      while (dom.parentNode !== null && dom.parentNode !== undefined) {\n        var rawParent = dom.parentNode;\n        var p = SugarElement.fromDom(rawParent);\n        ret.push(p);\n        if (stop(p) === true) {\n          break;\n        } else {\n          dom = rawParent;\n        }\n      }\n      return ret;\n    };\n    var prevSibling = function (element) {\n      return Optional.from(element.dom.previousSibling).map(SugarElement.fromDom);\n    };\n    var nextSibling = function (element) {\n      return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n    };\n    var children$3 = function (element) {\n      return map$1(element.dom.childNodes, SugarElement.fromDom);\n    };\n    var child$3 = function (element, index) {\n      var cs = element.dom.childNodes;\n      return Optional.from(cs[index]).map(SugarElement.fromDom);\n    };\n    var firstChild = function (element) {\n      return child$3(element, 0);\n    };\n\n    var isShadowRoot = function (dos) {\n      return isDocumentFragment(dos) && isNonNullable(dos.dom.host);\n    };\n    var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n    var isSupported$1 = constant(supported);\n    var getRootNode = supported ? function (e) {\n      return SugarElement.fromDom(e.dom.getRootNode());\n    } : documentOrOwner;\n    var getShadowRoot = function (e) {\n      var r = getRootNode(e);\n      return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n    };\n    var getShadowHost = function (e) {\n      return SugarElement.fromDom(e.dom.host);\n    };\n    var getOriginalEventTarget = function (event) {\n      if (isSupported$1() && isNonNullable(event.target)) {\n        var el = SugarElement.fromDom(event.target);\n        if (isElement(el) && isOpenShadowHost(el)) {\n          if (event.composed && event.composedPath) {\n            var composedPath = event.composedPath();\n            if (composedPath) {\n              return head(composedPath);\n            }\n          }\n        }\n      }\n      return Optional.from(event.target);\n    };\n    var isOpenShadowHost = function (element) {\n      return isNonNullable(element.dom.shadowRoot);\n    };\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom.parentNode : element.dom;\n      if (dom === undefined || dom === null || dom.ownerDocument === null) {\n        return false;\n      }\n      var doc = dom.ownerDocument;\n      return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n        return doc.body.contains(dom);\n      }, compose1(inBody, getShadowHost));\n    };\n    var body$1 = function () {\n      return getBody$1(SugarElement.fromDom(document));\n    };\n    var getBody$1 = function (doc) {\n      var b = doc.dom.body;\n      if (b === null || b === undefined) {\n        throw new Error('Body is not available yet');\n      }\n      return SugarElement.fromDom(b);\n    };\n\n    var ancestors$4 = function (scope, predicate, isRoot) {\n      return filter$2(parents(scope, isRoot), predicate);\n    };\n    var children$2 = function (scope, predicate) {\n      return filter$2(children$3(scope), predicate);\n    };\n    var descendants$1 = function (scope, predicate) {\n      var result = [];\n      each$2(children$3(scope), function (x) {\n        if (predicate(x)) {\n          result = result.concat([x]);\n        }\n        result = result.concat(descendants$1(x, predicate));\n      });\n      return result;\n    };\n\n    var ancestors$3 = function (scope, selector, isRoot) {\n      return ancestors$4(scope, function (e) {\n        return is$2(e, selector);\n      }, isRoot);\n    };\n    var children$1 = function (scope, selector) {\n      return children$2(scope, function (e) {\n        return is$2(e, selector);\n      });\n    };\n    var descendants = function (scope, selector) {\n      return all$1(selector, scope);\n    };\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      if (is(scope, a)) {\n        return Optional.some(scope);\n      } else if (isFunction(isRoot) && isRoot(scope)) {\n        return Optional.none();\n      } else {\n        return ancestor(scope, a, isRoot);\n      }\n    }\n\n    var ancestor$2 = function (scope, predicate, isRoot) {\n      var element = scope.dom;\n      var stop = isFunction(isRoot) ? isRoot : never;\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        if (predicate(el)) {\n          return Optional.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest$2 = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor$2, scope, predicate, isRoot);\n    };\n    var child$2 = function (scope, predicate) {\n      var pred = function (node) {\n        return predicate(SugarElement.fromDom(node));\n      };\n      var result = find$1(scope.dom.childNodes, pred);\n      return result.map(SugarElement.fromDom);\n    };\n    var descendant$1 = function (scope, predicate) {\n      var descend = function (node) {\n        for (var i = 0; i < node.childNodes.length; i++) {\n          var child_1 = SugarElement.fromDom(node.childNodes[i]);\n          if (predicate(child_1)) {\n            return Optional.some(child_1);\n          }\n          var res = descend(node.childNodes[i]);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Optional.none();\n      };\n      return descend(scope.dom);\n    };\n\n    var ancestor$1 = function (scope, selector, isRoot) {\n      return ancestor$2(scope, function (e) {\n        return is$2(e, selector);\n      }, isRoot);\n    };\n    var child$1 = function (scope, selector) {\n      return child$2(scope, function (e) {\n        return is$2(e, selector);\n      });\n    };\n    var descendant = function (scope, selector) {\n      return one(selector, scope);\n    };\n    var closest$1 = function (scope, selector, isRoot) {\n      var is = function (element, selector) {\n        return is$2(element, selector);\n      };\n      return ClosestOrAncestor(is, ancestor$1, scope, selector, isRoot);\n    };\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set$2 = function (element, key, value) {\n      rawSet(element.dom, key, value);\n    };\n    var setAll$1 = function (element, attrs) {\n      var dom = element.dom;\n      each$1(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var setOptions = function (element, attrs) {\n      each$1(attrs, function (v, k) {\n        v.fold(function () {\n          remove$7(element, k);\n        }, function (value) {\n          rawSet(element.dom, k, value);\n        });\n      });\n    };\n    var get$b = function (element, key) {\n      var v = element.dom.getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var getOpt = function (element, key) {\n      return Optional.from(get$b(element, key));\n    };\n    var remove$7 = function (element, key) {\n      element.dom.removeAttribute(key);\n    };\n    var clone$2 = function (element) {\n      return foldl(element.dom.attributes, function (acc, attr) {\n        acc[attr.name] = attr.value;\n        return acc;\n      }, {});\n    };\n\n    var is = function (lhs, rhs, comparator) {\n      if (comparator === void 0) {\n        comparator = tripleEquals;\n      }\n      return lhs.exists(function (left) {\n        return comparator(left, rhs);\n      });\n    };\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var lift2 = function (oa, ob, f) {\n      return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n    };\n    var bindFrom = function (a, f) {\n      return a !== undefined && a !== null ? f(a) : Optional.none();\n    };\n    var flatten = function (oot) {\n      return oot.bind(identity);\n    };\n    var someIf = function (b, a) {\n      return b ? Optional.some(a) : Optional.none();\n    };\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var internalRemove = function (dom, property) {\n      if (isSupported(dom)) {\n        dom.style.removeProperty(property);\n      }\n    };\n    var set$1 = function (element, property, value) {\n      var dom = element.dom;\n      internalSet(dom, property, value);\n    };\n    var setAll = function (element, css) {\n      var dom = element.dom;\n      each$1(css, function (v, k) {\n        internalSet(dom, k, v);\n      });\n    };\n    var get$a = function (element, property) {\n      var dom = element.dom;\n      var styles = window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n    var getRaw$2 = function (element, property) {\n      var dom = element.dom;\n      var raw = getUnsafeProperty(dom, property);\n      return Optional.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n    var remove$6 = function (element, property) {\n      var dom = element.dom;\n      internalRemove(dom, property);\n      if (is(getOpt(element, 'style').map(trim), '')) {\n        remove$7(element, 'style');\n      }\n    };\n    var copy$2 = function (source, target) {\n      var sourceDom = source.dom;\n      var targetDom = target.dom;\n      if (isSupported(sourceDom) && isSupported(targetDom)) {\n        targetDom.style.cssText = sourceDom.style.cssText;\n      }\n    };\n\n    var getAttrValue = function (cell, name, fallback) {\n      if (fallback === void 0) {\n        fallback = 0;\n      }\n      return getOpt(cell, name).map(function (value) {\n        return parseInt(value, 10);\n      }).getOr(fallback);\n    };\n    var getSpan = function (cell, type) {\n      return getAttrValue(cell, type, 1);\n    };\n    var hasColspan = function (cellOrCol) {\n      if (isTag('col')(cellOrCol)) {\n        return getAttrValue(cellOrCol, 'span', 1) > 1;\n      } else {\n        return getSpan(cellOrCol, 'colspan') > 1;\n      }\n    };\n    var hasRowspan = function (cell) {\n      return getSpan(cell, 'rowspan') > 1;\n    };\n    var getCssValue = function (element, property) {\n      return parseInt(get$a(element, property), 10);\n    };\n    var minWidth = constant(10);\n    var minHeight = constant(10);\n\n    var firstLayer = function (scope, selector) {\n      return filterFirstLayer(scope, selector, always);\n    };\n    var filterFirstLayer = function (scope, selector, predicate) {\n      return bind$2(children$3(scope), function (x) {\n        if (is$2(x, selector)) {\n          return predicate(x) ? [x] : [];\n        } else {\n          return filterFirstLayer(x, selector, predicate);\n        }\n      });\n    };\n\n    var lookup = function (tags, element, isRoot) {\n      if (isRoot === void 0) {\n        isRoot = never;\n      }\n      if (isRoot(element)) {\n        return Optional.none();\n      }\n      if (contains$2(tags, name(element))) {\n        return Optional.some(element);\n      }\n      var isRootOrUpperTable = function (elm) {\n        return is$2(elm, 'table') || isRoot(elm);\n      };\n      return ancestor$1(element, tags.join(','), isRootOrUpperTable);\n    };\n    var cell = function (element, isRoot) {\n      return lookup([\n        'td',\n        'th'\n      ], element, isRoot);\n    };\n    var cells$1 = function (ancestor) {\n      return firstLayer(ancestor, 'th,td');\n    };\n    var columns$1 = function (ancestor) {\n      if (is$2(ancestor, 'colgroup')) {\n        return children$1(ancestor, 'col');\n      } else {\n        return bind$2(columnGroups(ancestor), function (columnGroup) {\n          return children$1(columnGroup, 'col');\n        });\n      }\n    };\n    var table = function (element, isRoot) {\n      return closest$1(element, 'table', isRoot);\n    };\n    var rows$1 = function (ancestor) {\n      return firstLayer(ancestor, 'tr');\n    };\n    var columnGroups = function (ancestor) {\n      return table(ancestor).fold(constant([]), function (table) {\n        return children$1(table, 'colgroup');\n      });\n    };\n\n    var fromRowsOrColGroups = function (elems, getSection) {\n      return map$1(elems, function (row) {\n        if (name(row) === 'colgroup') {\n          var cells = map$1(columns$1(row), function (column) {\n            var colspan = getAttrValue(column, 'span', 1);\n            return detail(column, 1, colspan);\n          });\n          return rowdetail(row, cells, 'colgroup');\n        } else {\n          var cells = map$1(cells$1(row), function (cell) {\n            var rowspan = getAttrValue(cell, 'rowspan', 1);\n            var colspan = getAttrValue(cell, 'colspan', 1);\n            return detail(cell, rowspan, colspan);\n          });\n          return rowdetail(row, cells, getSection(row));\n        }\n      });\n    };\n    var getParentSection = function (group) {\n      return parent(group).map(function (parent) {\n        var parentName = name(parent);\n        return isValidSection(parentName) ? parentName : 'tbody';\n      }).getOr('tbody');\n    };\n    var fromTable$1 = function (table) {\n      var rows = rows$1(table);\n      var columnGroups$1 = columnGroups(table);\n      var elems = __spreadArray(__spreadArray([], columnGroups$1, true), rows, true);\n      return fromRowsOrColGroups(elems, getParentSection);\n    };\n    var fromPastedRows = function (elems, section) {\n      return fromRowsOrColGroups(elems, function () {\n        return section;\n      });\n    };\n\n    var addCells = function (gridRow, index, cells) {\n      var existingCells = gridRow.cells;\n      var before = existingCells.slice(0, index);\n      var after = existingCells.slice(index);\n      var newCells = before.concat(cells).concat(after);\n      return setCells(gridRow, newCells);\n    };\n    var addCell = function (gridRow, index, cell) {\n      return addCells(gridRow, index, [cell]);\n    };\n    var mutateCell = function (gridRow, index, cell) {\n      var cells = gridRow.cells;\n      cells[index] = cell;\n    };\n    var setCells = function (gridRow, cells) {\n      return rowcells(gridRow.element, cells, gridRow.section, gridRow.isNew);\n    };\n    var mapCells = function (gridRow, f) {\n      var cells = gridRow.cells;\n      var r = map$1(cells, f);\n      return rowcells(gridRow.element, r, gridRow.section, gridRow.isNew);\n    };\n    var getCell = function (gridRow, index) {\n      return gridRow.cells[index];\n    };\n    var getCellElement = function (gridRow, index) {\n      return getCell(gridRow, index).element;\n    };\n    var cellLength = function (gridRow) {\n      return gridRow.cells.length;\n    };\n    var extractGridDetails = function (grid) {\n      var result = partition(grid, function (row) {\n        return row.section === 'colgroup';\n      });\n      return {\n        rows: result.fail,\n        cols: result.pass\n      };\n    };\n    var clone$1 = function (gridRow, cloneRow, cloneCell) {\n      var newCells = map$1(gridRow.cells, cloneCell);\n      return rowcells(cloneRow(gridRow.element), newCells, gridRow.section, true);\n    };\n\n    var LOCKED_COL_ATTR = 'data-snooker-locked-cols';\n    var getLockedColumnsFromTable = function (table) {\n      return getOpt(table, LOCKED_COL_ATTR).bind(function (lockedColStr) {\n        return Optional.from(lockedColStr.match(/\\d+/g));\n      }).map(function (lockedCols) {\n        return mapToObject(lockedCols, always);\n      });\n    };\n    var getLockedColumnsFromGrid = function (grid) {\n      var locked = foldl(extractGridDetails(grid).rows, function (acc, row) {\n        each$2(row.cells, function (cell, idx) {\n          if (cell.isLocked) {\n            acc[idx] = true;\n          }\n        });\n        return acc;\n      }, {});\n      var lockedArr = mapToArray(locked, function (_val, key) {\n        return parseInt(key, 10);\n      });\n      return sort$1(lockedArr);\n    };\n\n    var key = function (row, column) {\n      return row + ',' + column;\n    };\n    var getAt = function (warehouse, row, column) {\n      return Optional.from(warehouse.access[key(row, column)]);\n    };\n    var findItem = function (warehouse, item, comparator) {\n      var filtered = filterItems(warehouse, function (detail) {\n        return comparator(item, detail.element);\n      });\n      return filtered.length > 0 ? Optional.some(filtered[0]) : Optional.none();\n    };\n    var filterItems = function (warehouse, predicate) {\n      var all = bind$2(warehouse.all, function (r) {\n        return r.cells;\n      });\n      return filter$2(all, predicate);\n    };\n    var generateColumns = function (rowData) {\n      var columnsGroup = {};\n      var index = 0;\n      each$2(rowData.cells, function (column) {\n        var colspan = column.colspan;\n        range$1(colspan, function (columnIndex) {\n          var colIndex = index + columnIndex;\n          columnsGroup[colIndex] = columnext(column.element, colspan, colIndex);\n        });\n        index += colspan;\n      });\n      return columnsGroup;\n    };\n    var generate$1 = function (list) {\n      var access = {};\n      var cells = [];\n      var tableOpt = head(list).map(function (rowData) {\n        return rowData.element;\n      }).bind(table);\n      var lockedColumns = tableOpt.bind(getLockedColumnsFromTable).getOr({});\n      var maxRows = 0;\n      var maxColumns = 0;\n      var rowCount = 0;\n      var _a = partition(list, function (rowData) {\n          return rowData.section === 'colgroup';\n        }), colgroupRows = _a.pass, rows = _a.fail;\n      each$2(rows, function (rowData) {\n        var currentRow = [];\n        each$2(rowData.cells, function (rowCell) {\n          var start = 0;\n          while (access[key(rowCount, start)] !== undefined) {\n            start++;\n          }\n          var isLocked = hasNonNullableKey(lockedColumns, start.toString());\n          var current = extended(rowCell.element, rowCell.rowspan, rowCell.colspan, rowCount, start, isLocked);\n          for (var occupiedColumnPosition = 0; occupiedColumnPosition < rowCell.colspan; occupiedColumnPosition++) {\n            for (var occupiedRowPosition = 0; occupiedRowPosition < rowCell.rowspan; occupiedRowPosition++) {\n              var rowPosition = rowCount + occupiedRowPosition;\n              var columnPosition = start + occupiedColumnPosition;\n              var newpos = key(rowPosition, columnPosition);\n              access[newpos] = current;\n              maxColumns = Math.max(maxColumns, columnPosition + 1);\n            }\n          }\n          currentRow.push(current);\n        });\n        maxRows++;\n        cells.push(rowdetail(rowData.element, currentRow, rowData.section));\n        rowCount++;\n      });\n      var _b = last$2(colgroupRows).map(function (rowData) {\n          var columns = generateColumns(rowData);\n          var colgroup$1 = colgroup(rowData.element, values(columns));\n          return {\n            colgroups: [colgroup$1],\n            columns: columns\n          };\n        }).getOrThunk(function () {\n          return {\n            colgroups: [],\n            columns: {}\n          };\n        }), columns = _b.columns, colgroups = _b.colgroups;\n      var grid$1 = grid(maxRows, maxColumns);\n      return {\n        grid: grid$1,\n        access: access,\n        all: cells,\n        columns: columns,\n        colgroups: colgroups\n      };\n    };\n    var fromTable = function (table) {\n      var list = fromTable$1(table);\n      return generate$1(list);\n    };\n    var justCells = function (warehouse) {\n      return bind$2(warehouse.all, function (w) {\n        return w.cells;\n      });\n    };\n    var justColumns = function (warehouse) {\n      return values(warehouse.columns);\n    };\n    var hasColumns = function (warehouse) {\n      return keys(warehouse.columns).length > 0;\n    };\n    var getColumnAt = function (warehouse, columnIndex) {\n      return Optional.from(warehouse.columns[columnIndex]);\n    };\n    var Warehouse = {\n      fromTable: fromTable,\n      generate: generate$1,\n      getAt: getAt,\n      findItem: findItem,\n      filterItems: filterItems,\n      justCells: justCells,\n      justColumns: justColumns,\n      hasColumns: hasColumns,\n      getColumnAt: getColumnAt\n    };\n\n    var inSelection = function (bounds, detail) {\n      var leftEdge = detail.column;\n      var rightEdge = detail.column + detail.colspan - 1;\n      var topEdge = detail.row;\n      var bottomEdge = detail.row + detail.rowspan - 1;\n      return leftEdge <= bounds.finishCol && rightEdge >= bounds.startCol && (topEdge <= bounds.finishRow && bottomEdge >= bounds.startRow);\n    };\n    var isWithin = function (bounds, detail) {\n      return detail.column >= bounds.startCol && detail.column + detail.colspan - 1 <= bounds.finishCol && detail.row >= bounds.startRow && detail.row + detail.rowspan - 1 <= bounds.finishRow;\n    };\n    var isRectangular = function (warehouse, bounds) {\n      var isRect = true;\n      var detailIsWithin = curry(isWithin, bounds);\n      for (var i = bounds.startRow; i <= bounds.finishRow; i++) {\n        for (var j = bounds.startCol; j <= bounds.finishCol; j++) {\n          isRect = isRect && Warehouse.getAt(warehouse, i, j).exists(detailIsWithin);\n        }\n      }\n      return isRect ? Optional.some(bounds) : Optional.none();\n    };\n\n    var getBounds = function (detailA, detailB) {\n      return bounds(Math.min(detailA.row, detailB.row), Math.min(detailA.column, detailB.column), Math.max(detailA.row + detailA.rowspan - 1, detailB.row + detailB.rowspan - 1), Math.max(detailA.column + detailA.colspan - 1, detailB.column + detailB.colspan - 1));\n    };\n    var getAnyBox = function (warehouse, startCell, finishCell) {\n      var startCoords = Warehouse.findItem(warehouse, startCell, eq$1);\n      var finishCoords = Warehouse.findItem(warehouse, finishCell, eq$1);\n      return startCoords.bind(function (sc) {\n        return finishCoords.map(function (fc) {\n          return getBounds(sc, fc);\n        });\n      });\n    };\n    var getBox$1 = function (warehouse, startCell, finishCell) {\n      return getAnyBox(warehouse, startCell, finishCell).bind(function (bounds) {\n        return isRectangular(warehouse, bounds);\n      });\n    };\n\n    var moveBy$1 = function (warehouse, cell, row, column) {\n      return Warehouse.findItem(warehouse, cell, eq$1).bind(function (detail) {\n        var startRow = row > 0 ? detail.row + detail.rowspan - 1 : detail.row;\n        var startCol = column > 0 ? detail.column + detail.colspan - 1 : detail.column;\n        var dest = Warehouse.getAt(warehouse, startRow + row, startCol + column);\n        return dest.map(function (d) {\n          return d.element;\n        });\n      });\n    };\n    var intercepts$1 = function (warehouse, start, finish) {\n      return getAnyBox(warehouse, start, finish).map(function (bounds) {\n        var inside = Warehouse.filterItems(warehouse, curry(inSelection, bounds));\n        return map$1(inside, function (detail) {\n          return detail.element;\n        });\n      });\n    };\n    var parentCell = function (warehouse, innerCell) {\n      var isContainedBy = function (c1, c2) {\n        return contains(c2, c1);\n      };\n      return Warehouse.findItem(warehouse, innerCell, isContainedBy).map(function (detail) {\n        return detail.element;\n      });\n    };\n\n    var moveBy = function (cell, deltaRow, deltaColumn) {\n      return table(cell).bind(function (table) {\n        var warehouse = getWarehouse(table);\n        return moveBy$1(warehouse, cell, deltaRow, deltaColumn);\n      });\n    };\n    var intercepts = function (table, first, last) {\n      var warehouse = getWarehouse(table);\n      return intercepts$1(warehouse, first, last);\n    };\n    var nestedIntercepts = function (table, first, firstTable, last, lastTable) {\n      var warehouse = getWarehouse(table);\n      var optStartCell = eq$1(table, firstTable) ? Optional.some(first) : parentCell(warehouse, first);\n      var optLastCell = eq$1(table, lastTable) ? Optional.some(last) : parentCell(warehouse, last);\n      return optStartCell.bind(function (startCell) {\n        return optLastCell.bind(function (lastCell) {\n          return intercepts$1(warehouse, startCell, lastCell);\n        });\n      });\n    };\n    var getBox = function (table, first, last) {\n      var warehouse = getWarehouse(table);\n      return getBox$1(warehouse, first, last);\n    };\n    var getWarehouse = Warehouse.fromTable;\n\n    var before$4 = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom.insertBefore(element.dom, marker.dom);\n      });\n    };\n    var after$5 = function (marker, element) {\n      var sibling = nextSibling(marker);\n      sibling.fold(function () {\n        var parent$1 = parent(marker);\n        parent$1.each(function (v) {\n          append$1(v, element);\n        });\n      }, function (v) {\n        before$4(v, element);\n      });\n    };\n    var prepend = function (parent, element) {\n      var firstChild$1 = firstChild(parent);\n      firstChild$1.fold(function () {\n        append$1(parent, element);\n      }, function (v) {\n        parent.dom.insertBefore(element.dom, v.dom);\n      });\n    };\n    var append$1 = function (parent, element) {\n      parent.dom.appendChild(element.dom);\n    };\n    var appendAt = function (parent, element, index) {\n      child$3(parent, index).fold(function () {\n        append$1(parent, element);\n      }, function (v) {\n        before$4(v, element);\n      });\n    };\n    var wrap = function (element, wrapper) {\n      before$4(element, wrapper);\n      append$1(wrapper, element);\n    };\n\n    var before$3 = function (marker, elements) {\n      each$2(elements, function (x) {\n        before$4(marker, x);\n      });\n    };\n    var after$4 = function (marker, elements) {\n      each$2(elements, function (x, i) {\n        var e = i === 0 ? marker : elements[i - 1];\n        after$5(e, x);\n      });\n    };\n    var append = function (parent, elements) {\n      each$2(elements, function (x) {\n        append$1(parent, x);\n      });\n    };\n\n    var empty = function (element) {\n      element.dom.textContent = '';\n      each$2(children$3(element), function (rogue) {\n        remove$5(rogue);\n      });\n    };\n    var remove$5 = function (element) {\n      var dom = element.dom;\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n    var unwrap = function (wrapper) {\n      var children = children$3(wrapper);\n      if (children.length > 0) {\n        before$3(wrapper, children);\n      }\n      remove$5(wrapper);\n    };\n\n    var NodeValue = function (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom.nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    };\n\n    var api$2 = NodeValue(isText, 'text');\n    var get$9 = function (element) {\n      return api$2.get(element);\n    };\n    var getOption = function (element) {\n      return api$2.getOption(element);\n    };\n    var set = function (element, value) {\n      return api$2.set(element, value);\n    };\n\n    var TagBoundaries = [\n      'body',\n      'p',\n      'div',\n      'article',\n      'aside',\n      'figcaption',\n      'figure',\n      'footer',\n      'header',\n      'nav',\n      'section',\n      'ol',\n      'ul',\n      'li',\n      'table',\n      'thead',\n      'tbody',\n      'tfoot',\n      'caption',\n      'tr',\n      'td',\n      'th',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'blockquote',\n      'pre',\n      'address'\n    ];\n\n    function DomUniverse () {\n      var clone = function (element) {\n        return SugarElement.fromDom(element.dom.cloneNode(false));\n      };\n      var document = function (element) {\n        return documentOrOwner(element).dom;\n      };\n      var isBoundary = function (element) {\n        if (!isElement(element)) {\n          return false;\n        }\n        if (name(element) === 'body') {\n          return true;\n        }\n        return contains$2(TagBoundaries, name(element));\n      };\n      var isEmptyTag = function (element) {\n        if (!isElement(element)) {\n          return false;\n        }\n        return contains$2([\n          'br',\n          'img',\n          'hr',\n          'input'\n        ], name(element));\n      };\n      var isNonEditable = function (element) {\n        return isElement(element) && get$b(element, 'contenteditable') === 'false';\n      };\n      var comparePosition = function (element, other) {\n        return element.dom.compareDocumentPosition(other.dom);\n      };\n      var copyAttributesTo = function (source, destination) {\n        var as = clone$2(source);\n        setAll$1(destination, as);\n      };\n      var isSpecial = function (element) {\n        var tag = name(element);\n        return contains$2([\n          'script',\n          'noscript',\n          'iframe',\n          'noframes',\n          'noembed',\n          'title',\n          'style',\n          'textarea',\n          'xmp'\n        ], tag);\n      };\n      var getLanguage = function (element) {\n        return isElement(element) ? getOpt(element, 'lang') : Optional.none();\n      };\n      return {\n        up: constant({\n          selector: ancestor$1,\n          closest: closest$1,\n          predicate: ancestor$2,\n          all: parents\n        }),\n        down: constant({\n          selector: descendants,\n          predicate: descendants$1\n        }),\n        styles: constant({\n          get: get$a,\n          getRaw: getRaw$2,\n          set: set$1,\n          remove: remove$6\n        }),\n        attrs: constant({\n          get: get$b,\n          set: set$2,\n          remove: remove$7,\n          copyTo: copyAttributesTo\n        }),\n        insert: constant({\n          before: before$4,\n          after: after$5,\n          afterAll: after$4,\n          append: append$1,\n          appendAll: append,\n          prepend: prepend,\n          wrap: wrap\n        }),\n        remove: constant({\n          unwrap: unwrap,\n          remove: remove$5\n        }),\n        create: constant({\n          nu: SugarElement.fromTag,\n          clone: clone,\n          text: SugarElement.fromText\n        }),\n        query: constant({\n          comparePosition: comparePosition,\n          prevSibling: prevSibling,\n          nextSibling: nextSibling\n        }),\n        property: constant({\n          children: children$3,\n          name: name,\n          parent: parent,\n          document: document,\n          isText: isText,\n          isComment: isComment,\n          isElement: isElement,\n          isSpecial: isSpecial,\n          getLanguage: getLanguage,\n          getText: get$9,\n          setText: set,\n          isBoundary: isBoundary,\n          isEmptyTag: isEmptyTag,\n          isNonEditable: isNonEditable\n        }),\n        eq: eq$1,\n        is: is$1\n      };\n    }\n\n    var all = function (universe, look, elements, f) {\n      var head = elements[0];\n      var tail = elements.slice(1);\n      return f(universe, look, head, tail);\n    };\n    var oneAll = function (universe, look, elements) {\n      return elements.length > 0 ? all(universe, look, elements, unsafeOne) : Optional.none();\n    };\n    var unsafeOne = function (universe, look, head, tail) {\n      var start = look(universe, head);\n      return foldr(tail, function (b, a) {\n        var current = look(universe, a);\n        return commonElement(universe, b, current);\n      }, start);\n    };\n    var commonElement = function (universe, start, end) {\n      return start.bind(function (s) {\n        return end.filter(curry(universe.eq, s));\n      });\n    };\n\n    var eq = function (universe, item) {\n      return curry(universe.eq, item);\n    };\n    var ancestors$2 = function (universe, start, end, isRoot) {\n      if (isRoot === void 0) {\n        isRoot = never;\n      }\n      var ps1 = [start].concat(universe.up().all(start));\n      var ps2 = [end].concat(universe.up().all(end));\n      var prune = function (path) {\n        var index = findIndex(path, isRoot);\n        return index.fold(function () {\n          return path;\n        }, function (ind) {\n          return path.slice(0, ind + 1);\n        });\n      };\n      var pruned1 = prune(ps1);\n      var pruned2 = prune(ps2);\n      var shared = find$1(pruned1, function (x) {\n        return exists(pruned2, eq(universe, x));\n      });\n      return {\n        firstpath: pruned1,\n        secondpath: pruned2,\n        shared: shared\n      };\n    };\n\n    var sharedOne$1 = oneAll;\n    var ancestors$1 = ancestors$2;\n\n    var universe$3 = DomUniverse();\n    var sharedOne = function (look, elements) {\n      return sharedOne$1(universe$3, function (_universe, element) {\n        return look(element);\n      }, elements);\n    };\n    var ancestors = function (start, finish, isRoot) {\n      return ancestors$1(universe$3, start, finish, isRoot);\n    };\n\n    var lookupTable = function (container) {\n      return ancestor$1(container, 'table');\n    };\n    var identify = function (start, finish, isRoot) {\n      var getIsRoot = function (rootTable) {\n        return function (element) {\n          return isRoot !== undefined && isRoot(element) || eq$1(element, rootTable);\n        };\n      };\n      if (eq$1(start, finish)) {\n        return Optional.some({\n          boxes: Optional.some([start]),\n          start: start,\n          finish: finish\n        });\n      } else {\n        return lookupTable(start).bind(function (startTable) {\n          return lookupTable(finish).bind(function (finishTable) {\n            if (eq$1(startTable, finishTable)) {\n              return Optional.some({\n                boxes: intercepts(startTable, start, finish),\n                start: start,\n                finish: finish\n              });\n            } else if (contains(startTable, finishTable)) {\n              var ancestorCells = ancestors$3(finish, 'td,th', getIsRoot(startTable));\n              var finishCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : finish;\n              return Optional.some({\n                boxes: nestedIntercepts(startTable, start, startTable, finish, finishTable),\n                start: start,\n                finish: finishCell\n              });\n            } else if (contains(finishTable, startTable)) {\n              var ancestorCells = ancestors$3(start, 'td,th', getIsRoot(finishTable));\n              var startCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : start;\n              return Optional.some({\n                boxes: nestedIntercepts(finishTable, start, startTable, finish, finishTable),\n                start: start,\n                finish: startCell\n              });\n            } else {\n              return ancestors(start, finish).shared.bind(function (lca) {\n                return closest$1(lca, 'table', isRoot).bind(function (lcaTable) {\n                  var finishAncestorCells = ancestors$3(finish, 'td,th', getIsRoot(lcaTable));\n                  var finishCell = finishAncestorCells.length > 0 ? finishAncestorCells[finishAncestorCells.length - 1] : finish;\n                  var startAncestorCells = ancestors$3(start, 'td,th', getIsRoot(lcaTable));\n                  var startCell = startAncestorCells.length > 0 ? startAncestorCells[startAncestorCells.length - 1] : start;\n                  return Optional.some({\n                    boxes: nestedIntercepts(lcaTable, start, startTable, finish, finishTable),\n                    start: startCell,\n                    finish: finishCell\n                  });\n                });\n              });\n            }\n          });\n        });\n      }\n    };\n    var retrieve$1 = function (container, selector) {\n      var sels = descendants(container, selector);\n      return sels.length > 0 ? Optional.some(sels) : Optional.none();\n    };\n    var getLast = function (boxes, lastSelectedSelector) {\n      return find$1(boxes, function (box) {\n        return is$2(box, lastSelectedSelector);\n      });\n    };\n    var getEdges = function (container, firstSelectedSelector, lastSelectedSelector) {\n      return descendant(container, firstSelectedSelector).bind(function (first) {\n        return descendant(container, lastSelectedSelector).bind(function (last) {\n          return sharedOne(lookupTable, [\n            first,\n            last\n          ]).map(function (table) {\n            return {\n              first: first,\n              last: last,\n              table: table\n            };\n          });\n        });\n      });\n    };\n    var expandTo = function (finish, firstSelectedSelector) {\n      return ancestor$1(finish, 'table').bind(function (table) {\n        return descendant(table, firstSelectedSelector).bind(function (start) {\n          return identify(start, finish).bind(function (identified) {\n            return identified.boxes.map(function (boxes) {\n              return {\n                boxes: boxes,\n                start: identified.start,\n                finish: identified.finish\n              };\n            });\n          });\n        });\n      });\n    };\n    var shiftSelection = function (boxes, deltaRow, deltaColumn, firstSelectedSelector, lastSelectedSelector) {\n      return getLast(boxes, lastSelectedSelector).bind(function (last) {\n        return moveBy(last, deltaRow, deltaColumn).bind(function (finish) {\n          return expandTo(finish, firstSelectedSelector);\n        });\n      });\n    };\n\n    var retrieve = function (container, selector) {\n      return retrieve$1(container, selector);\n    };\n    var retrieveBox = function (container, firstSelectedSelector, lastSelectedSelector) {\n      return getEdges(container, firstSelectedSelector, lastSelectedSelector).bind(function (edges) {\n        var isRoot = function (ancestor) {\n          return eq$1(container, ancestor);\n        };\n        var sectionSelector = 'thead,tfoot,tbody,table';\n        var firstAncestor = ancestor$1(edges.first, sectionSelector, isRoot);\n        var lastAncestor = ancestor$1(edges.last, sectionSelector, isRoot);\n        return firstAncestor.bind(function (fA) {\n          return lastAncestor.bind(function (lA) {\n            return eq$1(fA, lA) ? getBox(edges.table, edges.first, edges.last) : Optional.none();\n          });\n        });\n      });\n    };\n\n    var generate = function (cases) {\n      if (!isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each$2(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          var argLength = args.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains$2(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              var foldArgs = [];\n              for (var _i = 0; _i < arguments.length; _i++) {\n                foldArgs[_i] = arguments[_i];\n              }\n              if (foldArgs.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n              }\n              var target = foldArgs[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate };\n\n    var type = Adt.generate([\n      { none: [] },\n      { multiple: ['elements'] },\n      { single: ['element'] }\n    ]);\n    var cata$2 = function (subject, onNone, onMultiple, onSingle) {\n      return subject.fold(onNone, onMultiple, onSingle);\n    };\n    var none$1 = type.none;\n    var multiple = type.multiple;\n    var single = type.single;\n\n    var Selections = function (lazyRoot, getStart, selectedSelector) {\n      var get = function () {\n        return retrieve(lazyRoot(), selectedSelector).fold(function () {\n          return getStart().fold(none$1, single);\n        }, function (cells) {\n          return multiple(cells);\n        });\n      };\n      return { get: get };\n    };\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var clone = function (original, isDeep) {\n      return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n    };\n    var shallow = function (original) {\n      return clone(original, false);\n    };\n    var deep = function (original) {\n      return clone(original, true);\n    };\n    var shallowAs = function (original, tag) {\n      var nu = SugarElement.fromTag(tag);\n      var attributes = clone$2(original);\n      setAll$1(nu, attributes);\n      return nu;\n    };\n    var copy$1 = function (original, tag) {\n      var nu = shallowAs(original, tag);\n      var cloneChildren = children$3(deep(original));\n      append(nu, cloneChildren);\n      return nu;\n    };\n    var mutate$1 = function (original, tag) {\n      var nu = shallowAs(original, tag);\n      before$4(original, nu);\n      var children = children$3(original);\n      append(nu, children);\n      remove$5(original);\n      return nu;\n    };\n\n    var Dimension = function (name, getOffset) {\n      var set = function (element, h) {\n        if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n          throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n        }\n        var dom = element.dom;\n        if (isSupported(dom)) {\n          dom.style[name] = h + 'px';\n        }\n      };\n      var get = function (element) {\n        var r = getOffset(element);\n        if (r <= 0 || r === null) {\n          var css = get$a(element, name);\n          return parseFloat(css) || 0;\n        }\n        return r;\n      };\n      var getOuter = get;\n      var aggregate = function (element, properties) {\n        return foldl(properties, function (acc, property) {\n          var val = get$a(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    };\n\n    var needManualCalc = function () {\n      var browser = detect$3().browser;\n      return browser.isIE() || browser.isEdge();\n    };\n    var toNumber = function (px, fallback) {\n      return toFloat(px).getOr(fallback);\n    };\n    var getProp = function (element, name, fallback) {\n      return toNumber(get$a(element, name), fallback);\n    };\n    var getBoxSizing = function (element) {\n      return get$a(element, 'box-sizing');\n    };\n    var calcContentBoxSize = function (element, size, upper, lower) {\n      var paddingUpper = getProp(element, 'padding-' + upper, 0);\n      var paddingLower = getProp(element, 'padding-' + lower, 0);\n      var borderUpper = getProp(element, 'border-' + upper + '-width', 0);\n      var borderLower = getProp(element, 'border-' + lower + '-width', 0);\n      return size - paddingUpper - paddingLower - borderUpper - borderLower;\n    };\n    var getCalculatedHeight = function (element, boxSizing) {\n      var dom = element.dom;\n      var height = dom.getBoundingClientRect().height || dom.offsetHeight;\n      return boxSizing === 'border-box' ? height : calcContentBoxSize(element, height, 'top', 'bottom');\n    };\n    var getCalculatedWidth = function (element, boxSizing) {\n      var dom = element.dom;\n      var width = dom.getBoundingClientRect().width || dom.offsetWidth;\n      return boxSizing === 'border-box' ? width : calcContentBoxSize(element, width, 'left', 'right');\n    };\n    var getHeight$1 = function (element) {\n      return needManualCalc() ? getCalculatedHeight(element, getBoxSizing(element)) : getProp(element, 'height', element.dom.offsetHeight);\n    };\n    var getWidth = function (element) {\n      return needManualCalc() ? getCalculatedWidth(element, getBoxSizing(element)) : getProp(element, 'width', element.dom.offsetWidth);\n    };\n    var getInnerWidth = function (element) {\n      return getCalculatedWidth(element, 'content-box');\n    };\n\n    var api$1 = Dimension('width', function (element) {\n      return element.dom.offsetWidth;\n    });\n    var get$8 = function (element) {\n      return api$1.get(element);\n    };\n    var getOuter$2 = function (element) {\n      return api$1.getOuter(element);\n    };\n    var getInner = getInnerWidth;\n    var getRuntime$1 = getWidth;\n\n    var columns = function (warehouse, isValidCell) {\n      if (isValidCell === void 0) {\n        isValidCell = always;\n      }\n      var grid = warehouse.grid;\n      var cols = range$1(grid.columns, identity);\n      var rowsArr = range$1(grid.rows, identity);\n      return map$1(cols, function (col) {\n        var getBlock = function () {\n          return bind$2(rowsArr, function (r) {\n            return Warehouse.getAt(warehouse, r, col).filter(function (detail) {\n              return detail.column === col;\n            }).toArray();\n          });\n        };\n        var isValid = function (detail) {\n          return detail.colspan === 1 && isValidCell(detail.element);\n        };\n        var getFallback = function () {\n          return Warehouse.getAt(warehouse, 0, col);\n        };\n        return decide(getBlock, isValid, getFallback);\n      });\n    };\n    var decide = function (getBlock, isValid, getFallback) {\n      var inBlock = getBlock();\n      var validInBlock = find$1(inBlock, isValid);\n      var detailOption = validInBlock.orThunk(function () {\n        return Optional.from(inBlock[0]).orThunk(getFallback);\n      });\n      return detailOption.map(function (detail) {\n        return detail.element;\n      });\n    };\n    var rows = function (warehouse) {\n      var grid = warehouse.grid;\n      var rowsArr = range$1(grid.rows, identity);\n      var cols = range$1(grid.columns, identity);\n      return map$1(rowsArr, function (row) {\n        var getBlock = function () {\n          return bind$2(cols, function (c) {\n            return Warehouse.getAt(warehouse, row, c).filter(function (detail) {\n              return detail.row === row;\n            }).fold(constant([]), function (detail) {\n              return [detail];\n            });\n          });\n        };\n        var isSingle = function (detail) {\n          return detail.rowspan === 1;\n        };\n        var getFallback = function () {\n          return Warehouse.getAt(warehouse, row, 0);\n        };\n        return decide(getBlock, isSingle, getFallback);\n      });\n    };\n\n    var deduce = function (xs, index) {\n      if (index < 0 || index >= xs.length - 1) {\n        return Optional.none();\n      }\n      var current = xs[index].fold(function () {\n        var rest = reverse(xs.slice(0, index));\n        return findMap(rest, function (a, i) {\n          return a.map(function (aa) {\n            return {\n              value: aa,\n              delta: i + 1\n            };\n          });\n        });\n      }, function (c) {\n        return Optional.some({\n          value: c,\n          delta: 0\n        });\n      });\n      var next = xs[index + 1].fold(function () {\n        var rest = xs.slice(index + 1);\n        return findMap(rest, function (a, i) {\n          return a.map(function (aa) {\n            return {\n              value: aa,\n              delta: i + 1\n            };\n          });\n        });\n      }, function (n) {\n        return Optional.some({\n          value: n,\n          delta: 1\n        });\n      });\n      return current.bind(function (c) {\n        return next.map(function (n) {\n          var extras = n.delta + c.delta;\n          return Math.abs(n.value - c.value) / extras;\n        });\n      });\n    };\n\n    var onDirection = function (isLtr, isRtl) {\n      return function (element) {\n        return getDirection(element) === 'rtl' ? isRtl : isLtr;\n      };\n    };\n    var getDirection = function (element) {\n      return get$a(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n    };\n\n    var api = Dimension('height', function (element) {\n      var dom = element.dom;\n      return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n    });\n    var get$7 = function (element) {\n      return api.get(element);\n    };\n    var getOuter$1 = function (element) {\n      return api.getOuter(element);\n    };\n    var getRuntime = getHeight$1;\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n      return {\n        left: left,\n        top: top,\n        translate: translate\n      };\n    };\n    var SugarPosition = r;\n\n    var boxPosition = function (dom) {\n      var box = dom.getBoundingClientRect();\n      return SugarPosition(box.left, box.top);\n    };\n    var firstDefinedOrZero = function (a, b) {\n      if (a !== undefined) {\n        return a;\n      } else {\n        return b !== undefined ? b : 0;\n      }\n    };\n    var absolute = function (element) {\n      var doc = element.dom.ownerDocument;\n      var body = doc.body;\n      var win = doc.defaultView;\n      var html = doc.documentElement;\n      if (body === element.dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n      var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n      var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n      var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n      return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n    };\n    var viewport = function (element) {\n      var dom = element.dom;\n      var doc = dom.ownerDocument;\n      var body = doc.body;\n      if (body === dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      if (!inBody(element)) {\n        return SugarPosition(0, 0);\n      }\n      return boxPosition(dom);\n    };\n\n    var rowInfo = function (row, y) {\n      return {\n        row: row,\n        y: y\n      };\n    };\n    var colInfo = function (col, x) {\n      return {\n        col: col,\n        x: x\n      };\n    };\n    var rtlEdge = function (cell) {\n      var pos = absolute(cell);\n      return pos.left + getOuter$2(cell);\n    };\n    var ltrEdge = function (cell) {\n      return absolute(cell).left;\n    };\n    var getLeftEdge = function (index, cell) {\n      return colInfo(index, ltrEdge(cell));\n    };\n    var getRightEdge = function (index, cell) {\n      return colInfo(index, rtlEdge(cell));\n    };\n    var getTop$1 = function (cell) {\n      return absolute(cell).top;\n    };\n    var getTopEdge = function (index, cell) {\n      return rowInfo(index, getTop$1(cell));\n    };\n    var getBottomEdge = function (index, cell) {\n      return rowInfo(index, getTop$1(cell) + getOuter$1(cell));\n    };\n    var findPositions = function (getInnerEdge, getOuterEdge, array) {\n      if (array.length === 0) {\n        return [];\n      }\n      var lines = map$1(array.slice(1), function (cellOption, index) {\n        return cellOption.map(function (cell) {\n          return getInnerEdge(index, cell);\n        });\n      });\n      var lastLine = array[array.length - 1].map(function (cell) {\n        return getOuterEdge(array.length - 1, cell);\n      });\n      return lines.concat([lastLine]);\n    };\n    var negate = function (step) {\n      return -step;\n    };\n    var height = {\n      delta: identity,\n      positions: function (optElements) {\n        return findPositions(getTopEdge, getBottomEdge, optElements);\n      },\n      edge: getTop$1\n    };\n    var ltr$1 = {\n      delta: identity,\n      edge: ltrEdge,\n      positions: function (optElements) {\n        return findPositions(getLeftEdge, getRightEdge, optElements);\n      }\n    };\n    var rtl$1 = {\n      delta: negate,\n      edge: rtlEdge,\n      positions: function (optElements) {\n        return findPositions(getRightEdge, getLeftEdge, optElements);\n      }\n    };\n    var detect$2 = onDirection(ltr$1, rtl$1);\n    var width = {\n      delta: function (amount, table) {\n        return detect$2(table).delta(amount, table);\n      },\n      positions: function (cols, table) {\n        return detect$2(table).positions(cols, table);\n      },\n      edge: function (cell) {\n        return detect$2(cell).edge(cell);\n      }\n    };\n\n    var units = {\n      unsupportedLength: [\n        'em',\n        'ex',\n        'cap',\n        'ch',\n        'ic',\n        'rem',\n        'lh',\n        'rlh',\n        'vw',\n        'vh',\n        'vi',\n        'vb',\n        'vmin',\n        'vmax',\n        'cm',\n        'mm',\n        'Q',\n        'in',\n        'pc',\n        'pt',\n        'px'\n      ],\n      fixed: [\n        'px',\n        'pt'\n      ],\n      relative: ['%'],\n      empty: ['']\n    };\n    var pattern = function () {\n      var decimalDigits = '[0-9]+';\n      var signedInteger = '[+-]?' + decimalDigits;\n      var exponentPart = '[eE]' + signedInteger;\n      var dot = '\\\\.';\n      var opt = function (input) {\n        return '(?:' + input + ')?';\n      };\n      var unsignedDecimalLiteral = [\n        'Infinity',\n        decimalDigits + dot + opt(decimalDigits) + opt(exponentPart),\n        dot + decimalDigits + opt(exponentPart),\n        decimalDigits + opt(exponentPart)\n      ].join('|');\n      var float = '[+-]?(?:' + unsignedDecimalLiteral + ')';\n      return new RegExp('^(' + float + ')(.*)$');\n    }();\n    var isUnit = function (unit, accepted) {\n      return exists(accepted, function (acc) {\n        return exists(units[acc], function (check) {\n          return unit === check;\n        });\n      });\n    };\n    var parse = function (input, accepted) {\n      var match = Optional.from(pattern.exec(input));\n      return match.bind(function (array) {\n        var value = Number(array[1]);\n        var unitRaw = array[2];\n        if (isUnit(unitRaw, accepted)) {\n          return Optional.some({\n            value: value,\n            unit: unitRaw\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n\n    var rPercentageBasedSizeRegex = /(\\d+(\\.\\d+)?)%/;\n    var rPixelBasedSizeRegex = /(\\d+(\\.\\d+)?)px|em/;\n    var isCol$2 = isTag('col');\n    var getPercentSize = function (elm, outerGetter, innerGetter) {\n      var relativeParent = parentElement(elm).getOrThunk(function () {\n        return getBody$1(owner(elm));\n      });\n      return outerGetter(elm) / innerGetter(relativeParent) * 100;\n    };\n    var setPixelWidth = function (cell, amount) {\n      set$1(cell, 'width', amount + 'px');\n    };\n    var setPercentageWidth = function (cell, amount) {\n      set$1(cell, 'width', amount + '%');\n    };\n    var setHeight = function (cell, amount) {\n      set$1(cell, 'height', amount + 'px');\n    };\n    var getHeightValue = function (cell) {\n      return getRuntime(cell) + 'px';\n    };\n    var convert = function (cell, number, getter, setter) {\n      var newSize = table(cell).map(function (table) {\n        var total = getter(table);\n        return Math.floor(number / 100 * total);\n      }).getOr(number);\n      setter(cell, newSize);\n      return newSize;\n    };\n    var normalizePixelSize = function (value, cell, getter, setter) {\n      var number = parseFloat(value);\n      return endsWith(value, '%') && name(cell) !== 'table' ? convert(cell, number, getter, setter) : number;\n    };\n    var getTotalHeight = function (cell) {\n      var value = getHeightValue(cell);\n      if (!value) {\n        return get$7(cell);\n      }\n      return normalizePixelSize(value, cell, get$7, setHeight);\n    };\n    var get$6 = function (cell, type, f) {\n      var v = f(cell);\n      var span = getSpan(cell, type);\n      return v / span;\n    };\n    var getRaw$1 = function (element, prop) {\n      return getRaw$2(element, prop).orThunk(function () {\n        return getOpt(element, prop).map(function (val) {\n          return val + 'px';\n        });\n      });\n    };\n    var getRawWidth$1 = function (element) {\n      return getRaw$1(element, 'width');\n    };\n    var getRawHeight = function (element) {\n      return getRaw$1(element, 'height');\n    };\n    var getPercentageWidth = function (cell) {\n      return getPercentSize(cell, get$8, getInner);\n    };\n    var getPixelWidth$1 = function (cell) {\n      return isCol$2(cell) ? get$8(cell) : getRuntime$1(cell);\n    };\n    var getHeight = function (cell) {\n      return get$6(cell, 'rowspan', getTotalHeight);\n    };\n    var getGenericWidth = function (cell) {\n      var width = getRawWidth$1(cell);\n      return width.bind(function (w) {\n        return parse(w, [\n          'fixed',\n          'relative',\n          'empty'\n        ]);\n      });\n    };\n    var setGenericWidth = function (cell, amount, unit) {\n      set$1(cell, 'width', amount + unit);\n    };\n    var getPixelTableWidth = function (table) {\n      return get$8(table) + 'px';\n    };\n    var getPercentTableWidth = function (table) {\n      return getPercentSize(table, get$8, getInner) + '%';\n    };\n    var isPercentSizing$1 = function (table) {\n      return getRawWidth$1(table).exists(function (size) {\n        return rPercentageBasedSizeRegex.test(size);\n      });\n    };\n    var isPixelSizing$1 = function (table) {\n      return getRawWidth$1(table).exists(function (size) {\n        return rPixelBasedSizeRegex.test(size);\n      });\n    };\n    var isNoneSizing$1 = function (table) {\n      return getRawWidth$1(table).isNone();\n    };\n    var percentageBasedSizeRegex = constant(rPercentageBasedSizeRegex);\n\n    var isCol$1 = isTag('col');\n    var getRawW = function (cell) {\n      return getRawWidth$1(cell).getOrThunk(function () {\n        return getPixelWidth$1(cell) + 'px';\n      });\n    };\n    var getRawH = function (cell) {\n      return getRawHeight(cell).getOrThunk(function () {\n        return getHeight(cell) + 'px';\n      });\n    };\n    var justCols = function (warehouse) {\n      return map$1(Warehouse.justColumns(warehouse), function (column) {\n        return Optional.from(column.element);\n      });\n    };\n    var isValidColumn = function (cell) {\n      var browser = detect$3().browser;\n      var supportsColWidths = browser.isChrome() || browser.isFirefox();\n      return isCol$1(cell) ? supportsColWidths : true;\n    };\n    var getDimension = function (cellOpt, index, backups, filter, getter, fallback) {\n      return cellOpt.filter(filter).fold(function () {\n        return fallback(deduce(backups, index));\n      }, function (cell) {\n        return getter(cell);\n      });\n    };\n    var getWidthFrom = function (warehouse, table, getWidth, fallback) {\n      var columnCells = columns(warehouse);\n      var columns$1 = Warehouse.hasColumns(warehouse) ? justCols(warehouse) : columnCells;\n      var backups = [Optional.some(width.edge(table))].concat(map$1(width.positions(columnCells, table), function (pos) {\n        return pos.map(function (p) {\n          return p.x;\n        });\n      }));\n      var colFilter = not(hasColspan);\n      return map$1(columns$1, function (cellOption, c) {\n        return getDimension(cellOption, c, backups, colFilter, function (column) {\n          if (isValidColumn(column)) {\n            return getWidth(column);\n          } else {\n            var cell = bindFrom(columnCells[c], identity);\n            return getDimension(cell, c, backups, colFilter, function (cell) {\n              return fallback(Optional.some(get$8(cell)));\n            }, fallback);\n          }\n        }, fallback);\n      });\n    };\n    var getDeduced = function (deduced) {\n      return deduced.map(function (d) {\n        return d + 'px';\n      }).getOr('');\n    };\n    var getRawWidths = function (warehouse, table) {\n      return getWidthFrom(warehouse, table, getRawW, getDeduced);\n    };\n    var getPercentageWidths = function (warehouse, table, tableSize) {\n      return getWidthFrom(warehouse, table, getPercentageWidth, function (deduced) {\n        return deduced.fold(function () {\n          return tableSize.minCellWidth();\n        }, function (cellWidth) {\n          return cellWidth / tableSize.pixelWidth() * 100;\n        });\n      });\n    };\n    var getPixelWidths = function (warehouse, table, tableSize) {\n      return getWidthFrom(warehouse, table, getPixelWidth$1, function (deduced) {\n        return deduced.getOrThunk(tableSize.minCellWidth);\n      });\n    };\n    var getHeightFrom = function (warehouse, table, direction, getHeight, fallback) {\n      var rows$1 = rows(warehouse);\n      var backups = [Optional.some(direction.edge(table))].concat(map$1(direction.positions(rows$1, table), function (pos) {\n        return pos.map(function (p) {\n          return p.y;\n        });\n      }));\n      return map$1(rows$1, function (cellOption, c) {\n        return getDimension(cellOption, c, backups, not(hasRowspan), getHeight, fallback);\n      });\n    };\n    var getPixelHeights = function (warehouse, table, direction) {\n      return getHeightFrom(warehouse, table, direction, getHeight, function (deduced) {\n        return deduced.getOrThunk(minHeight);\n      });\n    };\n    var getRawHeights = function (warehouse, table, direction) {\n      return getHeightFrom(warehouse, table, direction, getRawH, getDeduced);\n    };\n\n    var widthLookup = function (table, getter) {\n      return function () {\n        if (inBody(table)) {\n          return getter(table);\n        } else {\n          return parseFloat(getRaw$2(table, 'width').getOr('0'));\n        }\n      };\n    };\n    var noneSize = function (table) {\n      var getWidth = widthLookup(table, get$8);\n      var zero = constant(0);\n      var getWidths = function (warehouse, tableSize) {\n        return getPixelWidths(warehouse, table, tableSize);\n      };\n      return {\n        width: getWidth,\n        pixelWidth: getWidth,\n        getWidths: getWidths,\n        getCellDelta: zero,\n        singleColumnWidth: constant([0]),\n        minCellWidth: zero,\n        setElementWidth: noop,\n        adjustTableWidth: noop,\n        isRelative: true,\n        label: 'none'\n      };\n    };\n    var percentageSize = function (table) {\n      var getFloatWidth = widthLookup(table, function (elem) {\n        return parseFloat(getPercentTableWidth(elem));\n      });\n      var getWidth = widthLookup(table, get$8);\n      var getCellDelta = function (delta) {\n        return delta / getWidth() * 100;\n      };\n      var singleColumnWidth = function (w, _delta) {\n        return [100 - w];\n      };\n      var minCellWidth = function () {\n        return minWidth() / getWidth() * 100;\n      };\n      var adjustTableWidth = function (delta) {\n        var currentWidth = getFloatWidth();\n        var change = delta / 100 * currentWidth;\n        var newWidth = currentWidth + change;\n        setPercentageWidth(table, newWidth);\n      };\n      var getWidths = function (warehouse, tableSize) {\n        return getPercentageWidths(warehouse, table, tableSize);\n      };\n      return {\n        width: getFloatWidth,\n        pixelWidth: getWidth,\n        getWidths: getWidths,\n        getCellDelta: getCellDelta,\n        singleColumnWidth: singleColumnWidth,\n        minCellWidth: minCellWidth,\n        setElementWidth: setPercentageWidth,\n        adjustTableWidth: adjustTableWidth,\n        isRelative: true,\n        label: 'percent'\n      };\n    };\n    var pixelSize = function (table) {\n      var getWidth = widthLookup(table, get$8);\n      var getCellDelta = identity;\n      var singleColumnWidth = function (w, delta) {\n        var newNext = Math.max(minWidth(), w + delta);\n        return [newNext - w];\n      };\n      var adjustTableWidth = function (delta) {\n        var newWidth = getWidth() + delta;\n        setPixelWidth(table, newWidth);\n      };\n      var getWidths = function (warehouse, tableSize) {\n        return getPixelWidths(warehouse, table, tableSize);\n      };\n      return {\n        width: getWidth,\n        pixelWidth: getWidth,\n        getWidths: getWidths,\n        getCellDelta: getCellDelta,\n        singleColumnWidth: singleColumnWidth,\n        minCellWidth: minWidth,\n        setElementWidth: setPixelWidth,\n        adjustTableWidth: adjustTableWidth,\n        isRelative: false,\n        label: 'pixel'\n      };\n    };\n    var chooseSize = function (element, width) {\n      var percentMatch = percentageBasedSizeRegex().exec(width);\n      if (percentMatch !== null) {\n        return percentageSize(element);\n      } else {\n        return pixelSize(element);\n      }\n    };\n    var getTableSize = function (table) {\n      var width = getRawWidth$1(table);\n      return width.fold(function () {\n        return noneSize(table);\n      }, function (w) {\n        return chooseSize(table, w);\n      });\n    };\n    var TableSize = {\n      getTableSize: getTableSize,\n      pixelSize: pixelSize,\n      percentageSize: percentageSize,\n      noneSize: noneSize\n    };\n\n    var statsStruct = function (minRow, minCol, maxRow, maxCol, allCells, selectedCells) {\n      return {\n        minRow: minRow,\n        minCol: minCol,\n        maxRow: maxRow,\n        maxCol: maxCol,\n        allCells: allCells,\n        selectedCells: selectedCells\n      };\n    };\n    var findSelectedStats = function (house, isSelected) {\n      var totalColumns = house.grid.columns;\n      var totalRows = house.grid.rows;\n      var minRow = totalRows;\n      var minCol = totalColumns;\n      var maxRow = 0;\n      var maxCol = 0;\n      var allCells = [];\n      var selectedCells = [];\n      each$1(house.access, function (detail) {\n        allCells.push(detail);\n        if (isSelected(detail)) {\n          selectedCells.push(detail);\n          var startRow = detail.row;\n          var endRow = startRow + detail.rowspan - 1;\n          var startCol = detail.column;\n          var endCol = startCol + detail.colspan - 1;\n          if (startRow < minRow) {\n            minRow = startRow;\n          } else if (endRow > maxRow) {\n            maxRow = endRow;\n          }\n          if (startCol < minCol) {\n            minCol = startCol;\n          } else if (endCol > maxCol) {\n            maxCol = endCol;\n          }\n        }\n      });\n      return statsStruct(minRow, minCol, maxRow, maxCol, allCells, selectedCells);\n    };\n    var makeCell = function (list, seenSelected, rowIndex) {\n      var row = list[rowIndex].element;\n      var td = SugarElement.fromTag('td');\n      append$1(td, SugarElement.fromTag('br'));\n      var f = seenSelected ? append$1 : prepend;\n      f(row, td);\n    };\n    var fillInGaps = function (list, house, stats, isSelected) {\n      var totalColumns = house.grid.columns;\n      var totalRows = house.grid.rows;\n      for (var i = 0; i < totalRows; i++) {\n        var seenSelected = false;\n        for (var j = 0; j < totalColumns; j++) {\n          if (!(i < stats.minRow || i > stats.maxRow || j < stats.minCol || j > stats.maxCol)) {\n            var needCell = Warehouse.getAt(house, i, j).filter(isSelected).isNone();\n            if (needCell) {\n              makeCell(list, seenSelected, i);\n            } else {\n              seenSelected = true;\n            }\n          }\n        }\n      }\n    };\n    var clean = function (replica, stats, house, widthDelta) {\n      each$1(house.columns, function (col) {\n        if (col.column < stats.minCol || col.column > stats.maxCol) {\n          remove$5(col.element);\n        }\n      });\n      var emptyRows = filter$2(firstLayer(replica, 'tr'), function (row) {\n        return row.dom.childElementCount === 0;\n      });\n      each$2(emptyRows, remove$5);\n      if (stats.minCol === stats.maxCol || stats.minRow === stats.maxRow) {\n        each$2(firstLayer(replica, 'th,td'), function (cell) {\n          remove$7(cell, 'rowspan');\n          remove$7(cell, 'colspan');\n        });\n      }\n      remove$7(replica, LOCKED_COL_ATTR);\n      remove$7(replica, 'data-snooker-col-series');\n      var tableSize = TableSize.getTableSize(replica);\n      tableSize.adjustTableWidth(widthDelta);\n    };\n    var getTableWidthDelta = function (table, warehouse, tableSize, stats) {\n      if (stats.minCol === 0 && warehouse.grid.columns === stats.maxCol + 1) {\n        return 0;\n      }\n      var colWidths = getPixelWidths(warehouse, table, tableSize);\n      var allColsWidth = foldl(colWidths, function (acc, width) {\n        return acc + width;\n      }, 0);\n      var selectedColsWidth = foldl(colWidths.slice(stats.minCol, stats.maxCol + 1), function (acc, width) {\n        return acc + width;\n      }, 0);\n      var newWidth = selectedColsWidth / allColsWidth * tableSize.pixelWidth();\n      var delta = newWidth - tableSize.pixelWidth();\n      return tableSize.getCellDelta(delta);\n    };\n    var extract$1 = function (table, selectedSelector) {\n      var isSelected = function (detail) {\n        return is$2(detail.element, selectedSelector);\n      };\n      var replica = deep(table);\n      var list = fromTable$1(replica);\n      var tableSize = TableSize.getTableSize(table);\n      var replicaHouse = Warehouse.generate(list);\n      var replicaStats = findSelectedStats(replicaHouse, isSelected);\n      var selector = 'th:not(' + selectedSelector + ')' + ',td:not(' + selectedSelector + ')';\n      var unselectedCells = filterFirstLayer(replica, 'th,td', function (cell) {\n        return is$2(cell, selector);\n      });\n      each$2(unselectedCells, remove$5);\n      fillInGaps(list, replicaHouse, replicaStats, isSelected);\n      var house = Warehouse.fromTable(table);\n      var widthDelta = getTableWidthDelta(table, house, tableSize, replicaStats);\n      clean(replica, replicaStats, replicaHouse, widthDelta);\n      return replica;\n    };\n\n    var nbsp = '\\xA0';\n\n    var getEnd = function (element) {\n      return name(element) === 'img' ? 1 : getOption(element).fold(function () {\n        return children$3(element).length;\n      }, function (v) {\n        return v.length;\n      });\n    };\n    var isTextNodeWithCursorPosition = function (el) {\n      return getOption(el).filter(function (text) {\n        return text.trim().length !== 0 || text.indexOf(nbsp) > -1;\n      }).isSome();\n    };\n    var elementsWithCursorPosition = [\n      'img',\n      'br'\n    ];\n    var isCursorPosition = function (elem) {\n      var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n      return hasCursorPosition || contains$2(elementsWithCursorPosition, name(elem));\n    };\n\n    var first = function (element) {\n      return descendant$1(element, isCursorPosition);\n    };\n    var last$1 = function (element) {\n      return descendantRtl(element, isCursorPosition);\n    };\n    var descendantRtl = function (scope, predicate) {\n      var descend = function (element) {\n        var children = children$3(element);\n        for (var i = children.length - 1; i >= 0; i--) {\n          var child = children[i];\n          if (predicate(child)) {\n            return Optional.some(child);\n          }\n          var res = descend(child);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Optional.none();\n      };\n      return descend(scope);\n    };\n\n    var transferableAttributes = {\n      scope: [\n        'row',\n        'col'\n      ]\n    };\n    var createCell = function (doc) {\n      return function () {\n        var td = SugarElement.fromTag('td', doc.dom);\n        append$1(td, SugarElement.fromTag('br', doc.dom));\n        return td;\n      };\n    };\n    var createCol = function (doc) {\n      return function () {\n        return SugarElement.fromTag('col', doc.dom);\n      };\n    };\n    var createColgroup = function (doc) {\n      return function () {\n        return SugarElement.fromTag('colgroup', doc.dom);\n      };\n    };\n    var createRow$1 = function (doc) {\n      return function () {\n        return SugarElement.fromTag('tr', doc.dom);\n      };\n    };\n    var replace$1 = function (cell, tag, attrs) {\n      var replica = copy$1(cell, tag);\n      each$1(attrs, function (v, k) {\n        if (v === null) {\n          remove$7(replica, k);\n        } else {\n          set$2(replica, k, v);\n        }\n      });\n      return replica;\n    };\n    var pasteReplace = function (cell) {\n      return cell;\n    };\n    var cloneFormats = function (oldCell, newCell, formats) {\n      var first$1 = first(oldCell);\n      return first$1.map(function (firstText) {\n        var formatSelector = formats.join(',');\n        var parents = ancestors$3(firstText, formatSelector, function (element) {\n          return eq$1(element, oldCell);\n        });\n        return foldr(parents, function (last, parent) {\n          var clonedFormat = shallow(parent);\n          remove$7(clonedFormat, 'contenteditable');\n          append$1(last, clonedFormat);\n          return clonedFormat;\n        }, newCell);\n      }).getOr(newCell);\n    };\n    var cloneAppropriateAttributes = function (original, clone) {\n      each$1(transferableAttributes, function (validAttributes, attributeName) {\n        return getOpt(original, attributeName).filter(function (attribute) {\n          return contains$2(validAttributes, attribute);\n        }).each(function (attribute) {\n          return set$2(clone, attributeName, attribute);\n        });\n      });\n    };\n    var cellOperations = function (mutate, doc, formatsToClone) {\n      var cloneCss = function (prev, clone) {\n        copy$2(prev.element, clone);\n        remove$6(clone, 'height');\n        if (prev.colspan !== 1) {\n          remove$6(clone, 'width');\n        }\n      };\n      var newCell = function (prev) {\n        var td = SugarElement.fromTag(name(prev.element), doc.dom);\n        var formats = formatsToClone.getOr([\n          'strong',\n          'em',\n          'b',\n          'i',\n          'span',\n          'font',\n          'h1',\n          'h2',\n          'h3',\n          'h4',\n          'h5',\n          'h6',\n          'p',\n          'div'\n        ]);\n        var lastNode = formats.length > 0 ? cloneFormats(prev.element, td, formats) : td;\n        append$1(lastNode, SugarElement.fromTag('br'));\n        cloneCss(prev, td);\n        cloneAppropriateAttributes(prev.element, td);\n        mutate(prev.element, td);\n        return td;\n      };\n      var newCol = function (prev) {\n        var col = SugarElement.fromTag(name(prev.element), doc.dom);\n        cloneCss(prev, col);\n        mutate(prev.element, col);\n        return col;\n      };\n      return {\n        col: newCol,\n        colgroup: createColgroup(doc),\n        row: createRow$1(doc),\n        cell: newCell,\n        replace: replace$1,\n        colGap: createCol(doc),\n        gap: createCell(doc)\n      };\n    };\n    var paste$1 = function (doc) {\n      return {\n        col: createCol(doc),\n        colgroup: createColgroup(doc),\n        row: createRow$1(doc),\n        cell: createCell(doc),\n        replace: pasteReplace,\n        colGap: createCol(doc),\n        gap: createCell(doc)\n      };\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return children$3(SugarElement.fromDom(div));\n    };\n    var fromDom = function (nodes) {\n      return map$1(nodes, SugarElement.fromDom);\n    };\n\n    var getNodeName = function (elm) {\n      return elm.nodeName.toLowerCase();\n    };\n    var getBody = function (editor) {\n      return SugarElement.fromDom(editor.getBody());\n    };\n    var getPixelWidth = function (elm) {\n      return elm.getBoundingClientRect().width;\n    };\n    var getPixelHeight = function (elm) {\n      return elm.getBoundingClientRect().height;\n    };\n    var getIsRoot = function (editor) {\n      return function (element) {\n        return eq$1(element, getBody(editor));\n      };\n    };\n    var removePxSuffix = function (size) {\n      return size ? size.replace(/px$/, '') : '';\n    };\n    var addPxSuffix = function (size) {\n      return /^\\d+(\\.\\d+)?$/.test(size) ? size + 'px' : size;\n    };\n    var removeDataStyle = function (table) {\n      remove$7(table, 'data-mce-style');\n      var removeStyleAttribute = function (element) {\n        return remove$7(element, 'data-mce-style');\n      };\n      each$2(cells$1(table), removeStyleAttribute);\n      each$2(columns$1(table), removeStyleAttribute);\n      each$2(rows$1(table), removeStyleAttribute);\n    };\n    var getRawWidth = function (editor, elm) {\n      var raw = editor.dom.getStyle(elm, 'width') || editor.dom.getAttrib(elm, 'width');\n      return Optional.from(raw).filter(isNotEmpty);\n    };\n    var isPercentage$1 = function (value) {\n      return /^(\\d+(\\.\\d+)?)%$/.test(value);\n    };\n    var isPixel = function (value) {\n      return /^(\\d+(\\.\\d+)?)px$/.test(value);\n    };\n    var getSelectionStart = function (editor) {\n      return SugarElement.fromDom(editor.selection.getStart());\n    };\n    var getSelectionEnd = function (editor) {\n      return SugarElement.fromDom(editor.selection.getEnd());\n    };\n\n    var selection = function (selections) {\n      return cata$2(selections.get(), constant([]), identity, pure);\n    };\n    var unmergable = function (selections) {\n      var hasSpan = function (elem, type) {\n        return getOpt(elem, type).exists(function (span) {\n          return parseInt(span, 10) > 1;\n        });\n      };\n      var hasRowOrColSpan = function (elem) {\n        return hasSpan(elem, 'rowspan') || hasSpan(elem, 'colspan');\n      };\n      var candidates = selection(selections);\n      return candidates.length > 0 && forall(candidates, hasRowOrColSpan) ? Optional.some(candidates) : Optional.none();\n    };\n    var mergable = function (table, selections, ephemera) {\n      return cata$2(selections.get(), Optional.none, function (cells) {\n        if (cells.length <= 1) {\n          return Optional.none();\n        } else {\n          return retrieveBox(table, ephemera.firstSelectedSelector, ephemera.lastSelectedSelector).map(function (bounds) {\n            return {\n              bounds: bounds,\n              cells: cells\n            };\n          });\n        }\n      }, Optional.none);\n    };\n\n    var strSelected = 'data-mce-selected';\n    var strSelectedSelector = 'td[' + strSelected + '],th[' + strSelected + ']';\n    var strAttributeSelector = '[' + strSelected + ']';\n    var strFirstSelected = 'data-mce-first-selected';\n    var strFirstSelectedSelector = 'td[' + strFirstSelected + '],th[' + strFirstSelected + ']';\n    var strLastSelected = 'data-mce-last-selected';\n    var strLastSelectedSelector = 'td[' + strLastSelected + '],th[' + strLastSelected + ']';\n    var attributeSelector = strAttributeSelector;\n    var ephemera = {\n      selected: strSelected,\n      selectedSelector: strSelectedSelector,\n      firstSelected: strFirstSelected,\n      firstSelectedSelector: strFirstSelectedSelector,\n      lastSelected: strLastSelected,\n      lastSelectedSelector: strLastSelectedSelector\n    };\n\n    var noMenu = function (cell) {\n      return {\n        element: cell,\n        mergable: Optional.none(),\n        unmergable: Optional.none(),\n        selection: [cell]\n      };\n    };\n    var forMenu = function (selections, table, cell) {\n      return {\n        element: cell,\n        mergable: mergable(table, selections, ephemera),\n        unmergable: unmergable(selections),\n        selection: selection(selections)\n      };\n    };\n    var paste = function (element, clipboard, generators) {\n      return {\n        element: element,\n        clipboard: clipboard,\n        generators: generators\n      };\n    };\n    var pasteRows = function (selections, cell, clipboard, generators) {\n      return {\n        selection: selection(selections),\n        clipboard: clipboard,\n        generators: generators\n      };\n    };\n\n    var getSelectionCellFallback = function (element) {\n      return table(element).bind(function (table) {\n        return retrieve(table, ephemera.firstSelectedSelector);\n      }).fold(constant(element), function (cells) {\n        return cells[0];\n      });\n    };\n    var getSelectionFromSelector = function (selector) {\n      return function (initCell, isRoot) {\n        var cellName = name(initCell);\n        var cell = cellName === 'col' || cellName === 'colgroup' ? getSelectionCellFallback(initCell) : initCell;\n        return closest$1(cell, selector, isRoot);\n      };\n    };\n    var getSelectionCellOrCaption = getSelectionFromSelector('th,td,caption');\n    var getSelectionCell = getSelectionFromSelector('th,td');\n    var getCellsFromSelection = function (selections) {\n      return selection(selections);\n    };\n    var getRowsFromSelection = function (selected, selector) {\n      var cellOpt = getSelectionCell(selected);\n      var rowsOpt = cellOpt.bind(function (cell) {\n        return table(cell);\n      }).map(function (table) {\n        return rows$1(table);\n      });\n      return lift2(cellOpt, rowsOpt, function (cell, rows) {\n        return filter$2(rows, function (row) {\n          return exists(fromDom(row.dom.cells), function (rowCell) {\n            return get$b(rowCell, selector) === '1' || eq$1(rowCell, cell);\n          });\n        });\n      }).getOr([]);\n    };\n\n    var extractSelected = function (cells) {\n      return table(cells[0]).map(function (table) {\n        var replica = extract$1(table, attributeSelector);\n        removeDataStyle(replica);\n        return [replica];\n      });\n    };\n    var serializeElements = function (editor, elements) {\n      return map$1(elements, function (elm) {\n        return editor.selection.serializer.serialize(elm.dom, {});\n      }).join('');\n    };\n    var getTextContent = function (elements) {\n      return map$1(elements, function (element) {\n        return element.dom.innerText;\n      }).join('');\n    };\n    var registerEvents = function (editor, selections, actions) {\n      editor.on('BeforeGetContent', function (e) {\n        var multiCellContext = function (cells) {\n          e.preventDefault();\n          extractSelected(cells).each(function (elements) {\n            e.content = e.format === 'text' ? getTextContent(elements) : serializeElements(editor, elements);\n          });\n        };\n        if (e.selection === true) {\n          cata$2(selections.get(), noop, multiCellContext, noop);\n        }\n      });\n      editor.on('BeforeSetContent', function (e) {\n        if (e.selection === true && e.paste === true) {\n          var selectedCells = getCellsFromSelection(selections);\n          head(selectedCells).each(function (cell) {\n            table(cell).each(function (table) {\n              var elements = filter$2(fromHtml(e.content), function (content) {\n                return name(content) !== 'meta';\n              });\n              var isTable = isTag('table');\n              if (elements.length === 1 && isTable(elements[0])) {\n                e.preventDefault();\n                var doc = SugarElement.fromDom(editor.getDoc());\n                var generators = paste$1(doc);\n                var targets = paste(cell, elements[0], generators);\n                actions.pasteCells(table, targets).each(function () {\n                  editor.focus();\n                });\n              }\n            });\n          });\n        }\n      });\n    };\n\n    var adt$7 = Adt.generate([\n      { none: [] },\n      { only: ['index'] },\n      {\n        left: [\n          'index',\n          'next'\n        ]\n      },\n      {\n        middle: [\n          'prev',\n          'index',\n          'next'\n        ]\n      },\n      {\n        right: [\n          'prev',\n          'index'\n        ]\n      }\n    ]);\n    var ColumnContext = __assign({}, adt$7);\n\n    var neighbours = function (input, index) {\n      if (input.length === 0) {\n        return ColumnContext.none();\n      }\n      if (input.length === 1) {\n        return ColumnContext.only(0);\n      }\n      if (index === 0) {\n        return ColumnContext.left(0, 1);\n      }\n      if (index === input.length - 1) {\n        return ColumnContext.right(index - 1, index);\n      }\n      if (index > 0 && index < input.length - 1) {\n        return ColumnContext.middle(index - 1, index, index + 1);\n      }\n      return ColumnContext.none();\n    };\n    var determine = function (input, column, step, tableSize, resize) {\n      var result = input.slice(0);\n      var context = neighbours(input, column);\n      var onNone = constant(map$1(result, constant(0)));\n      var onOnly = function (index) {\n        return tableSize.singleColumnWidth(result[index], step);\n      };\n      var onLeft = function (index, next) {\n        return resize.calcLeftEdgeDeltas(result, index, next, step, tableSize.minCellWidth(), tableSize.isRelative);\n      };\n      var onMiddle = function (prev, index, next) {\n        return resize.calcMiddleDeltas(result, prev, index, next, step, tableSize.minCellWidth(), tableSize.isRelative);\n      };\n      var onRight = function (prev, index) {\n        return resize.calcRightEdgeDeltas(result, prev, index, step, tableSize.minCellWidth(), tableSize.isRelative);\n      };\n      return context.fold(onNone, onOnly, onLeft, onMiddle, onRight);\n    };\n\n    var total = function (start, end, measures) {\n      var r = 0;\n      for (var i = start; i < end; i++) {\n        r += measures[i] !== undefined ? measures[i] : 0;\n      }\n      return r;\n    };\n    var recalculateWidthForCells = function (warehouse, widths) {\n      var all = Warehouse.justCells(warehouse);\n      return map$1(all, function (cell) {\n        var width = total(cell.column, cell.column + cell.colspan, widths);\n        return {\n          element: cell.element,\n          width: width,\n          colspan: cell.colspan\n        };\n      });\n    };\n    var recalculateWidthForColumns = function (warehouse, widths) {\n      var groups = Warehouse.justColumns(warehouse);\n      return map$1(groups, function (column, index) {\n        return {\n          element: column.element,\n          width: widths[index],\n          colspan: column.colspan\n        };\n      });\n    };\n    var recalculateHeightForCells = function (warehouse, heights) {\n      var all = Warehouse.justCells(warehouse);\n      return map$1(all, function (cell) {\n        var height = total(cell.row, cell.row + cell.rowspan, heights);\n        return {\n          element: cell.element,\n          height: height,\n          rowspan: cell.rowspan\n        };\n      });\n    };\n    var matchRowHeight = function (warehouse, heights) {\n      return map$1(warehouse.all, function (row, i) {\n        return {\n          element: row.element,\n          height: heights[i]\n        };\n      });\n    };\n\n    var sumUp = function (newSize) {\n      return foldr(newSize, function (b, a) {\n        return b + a;\n      }, 0);\n    };\n    var recalculate = function (warehouse, widths) {\n      if (Warehouse.hasColumns(warehouse)) {\n        return recalculateWidthForColumns(warehouse, widths);\n      } else {\n        return recalculateWidthForCells(warehouse, widths);\n      }\n    };\n    var recalculateAndApply = function (warehouse, widths, tableSize) {\n      var newSizes = recalculate(warehouse, widths);\n      each$2(newSizes, function (cell) {\n        tableSize.setElementWidth(cell.element, cell.width);\n      });\n    };\n    var adjustWidth = function (table, delta, index, resizing, tableSize) {\n      var warehouse = Warehouse.fromTable(table);\n      var step = tableSize.getCellDelta(delta);\n      var widths = tableSize.getWidths(warehouse, tableSize);\n      var isLastColumn = index === warehouse.grid.columns - 1;\n      var clampedStep = resizing.clampTableDelta(widths, index, step, tableSize.minCellWidth(), isLastColumn);\n      var deltas = determine(widths, index, clampedStep, tableSize, resizing);\n      var newWidths = map$1(deltas, function (dx, i) {\n        return dx + widths[i];\n      });\n      recalculateAndApply(warehouse, newWidths, tableSize);\n      resizing.resizeTable(tableSize.adjustTableWidth, clampedStep, isLastColumn);\n    };\n    var adjustHeight = function (table, delta, index, direction) {\n      var warehouse = Warehouse.fromTable(table);\n      var heights = getPixelHeights(warehouse, table, direction);\n      var newHeights = map$1(heights, function (dy, i) {\n        return index === i ? Math.max(delta + dy, minHeight()) : dy;\n      });\n      var newCellSizes = recalculateHeightForCells(warehouse, newHeights);\n      var newRowSizes = matchRowHeight(warehouse, newHeights);\n      each$2(newRowSizes, function (row) {\n        setHeight(row.element, row.height);\n      });\n      each$2(newCellSizes, function (cell) {\n        setHeight(cell.element, cell.height);\n      });\n      var total = sumUp(newHeights);\n      setHeight(table, total);\n    };\n    var adjustAndRedistributeWidths$1 = function (_table, list, details, tableSize, resizeBehaviour) {\n      var warehouse = Warehouse.generate(list);\n      var sizes = tableSize.getWidths(warehouse, tableSize);\n      var tablePixelWidth = tableSize.pixelWidth();\n      var _a = resizeBehaviour.calcRedestributedWidths(sizes, tablePixelWidth, details.pixelDelta, tableSize.isRelative), newSizes = _a.newSizes, delta = _a.delta;\n      recalculateAndApply(warehouse, newSizes, tableSize);\n      tableSize.adjustTableWidth(delta);\n    };\n    var adjustWidthTo = function (_table, list, _info, tableSize) {\n      var warehouse = Warehouse.generate(list);\n      var widths = tableSize.getWidths(warehouse, tableSize);\n      recalculateAndApply(warehouse, widths, tableSize);\n    };\n\n    var zero = function (array) {\n      return map$1(array, constant(0));\n    };\n    var surround = function (sizes, startIndex, endIndex, results, f) {\n      return f(sizes.slice(0, startIndex)).concat(results).concat(f(sizes.slice(endIndex)));\n    };\n    var clampDeltaHelper = function (predicate) {\n      return function (sizes, index, delta, minCellSize) {\n        if (!predicate(delta)) {\n          return delta;\n        } else {\n          var newSize = Math.max(minCellSize, sizes[index] - Math.abs(delta));\n          var diff = Math.abs(newSize - sizes[index]);\n          return delta >= 0 ? diff : -diff;\n        }\n      };\n    };\n    var clampNegativeDelta = clampDeltaHelper(function (delta) {\n      return delta < 0;\n    });\n    var clampDelta = clampDeltaHelper(always);\n    var resizeTable = function () {\n      var calcFixedDeltas = function (sizes, index, next, delta, minCellSize) {\n        var clampedDelta = clampNegativeDelta(sizes, index, delta, minCellSize);\n        return surround(sizes, index, next + 1, [\n          clampedDelta,\n          0\n        ], zero);\n      };\n      var calcRelativeDeltas = function (sizes, index, delta, minCellSize) {\n        var ratio = (100 + delta) / 100;\n        var newThis = Math.max(minCellSize, (sizes[index] + delta) / ratio);\n        return map$1(sizes, function (size, idx) {\n          var newSize = idx === index ? newThis : size / ratio;\n          return newSize - size;\n        });\n      };\n      var calcLeftEdgeDeltas = function (sizes, index, next, delta, minCellSize, isRelative) {\n        if (isRelative) {\n          return calcRelativeDeltas(sizes, index, delta, minCellSize);\n        } else {\n          return calcFixedDeltas(sizes, index, next, delta, minCellSize);\n        }\n      };\n      var calcMiddleDeltas = function (sizes, _prev, index, next, delta, minCellSize, isRelative) {\n        return calcLeftEdgeDeltas(sizes, index, next, delta, minCellSize, isRelative);\n      };\n      var resizeTable = function (resizer, delta) {\n        return resizer(delta);\n      };\n      var calcRightEdgeDeltas = function (sizes, _prev, index, delta, minCellSize, isRelative) {\n        if (isRelative) {\n          return calcRelativeDeltas(sizes, index, delta, minCellSize);\n        } else {\n          var clampedDelta = clampNegativeDelta(sizes, index, delta, minCellSize);\n          return zero(sizes.slice(0, index)).concat([clampedDelta]);\n        }\n      };\n      var calcRedestributedWidths = function (sizes, totalWidth, pixelDelta, isRelative) {\n        if (isRelative) {\n          var tableWidth = totalWidth + pixelDelta;\n          var ratio_1 = tableWidth / totalWidth;\n          var newSizes = map$1(sizes, function (size) {\n            return size / ratio_1;\n          });\n          return {\n            delta: ratio_1 * 100 - 100,\n            newSizes: newSizes\n          };\n        } else {\n          return {\n            delta: pixelDelta,\n            newSizes: sizes\n          };\n        }\n      };\n      return {\n        resizeTable: resizeTable,\n        clampTableDelta: clampNegativeDelta,\n        calcLeftEdgeDeltas: calcLeftEdgeDeltas,\n        calcMiddleDeltas: calcMiddleDeltas,\n        calcRightEdgeDeltas: calcRightEdgeDeltas,\n        calcRedestributedWidths: calcRedestributedWidths\n      };\n    };\n    var preserveTable = function () {\n      var calcLeftEdgeDeltas = function (sizes, index, next, delta, minCellSize) {\n        var idx = delta >= 0 ? next : index;\n        var clampedDelta = clampDelta(sizes, idx, delta, minCellSize);\n        return surround(sizes, index, next + 1, [\n          clampedDelta,\n          -clampedDelta\n        ], zero);\n      };\n      var calcMiddleDeltas = function (sizes, _prev, index, next, delta, minCellSize) {\n        return calcLeftEdgeDeltas(sizes, index, next, delta, minCellSize);\n      };\n      var resizeTable = function (resizer, delta, isLastColumn) {\n        if (isLastColumn) {\n          resizer(delta);\n        }\n      };\n      var calcRightEdgeDeltas = function (sizes, _prev, _index, delta, _minCellSize, isRelative) {\n        if (isRelative) {\n          return zero(sizes);\n        } else {\n          var diff = delta / sizes.length;\n          return map$1(sizes, constant(diff));\n        }\n      };\n      var clampTableDelta = function (sizes, index, delta, minCellSize, isLastColumn) {\n        if (isLastColumn) {\n          if (delta >= 0) {\n            return delta;\n          } else {\n            var maxDelta = foldl(sizes, function (a, b) {\n              return a + b - minCellSize;\n            }, 0);\n            return Math.max(-maxDelta, delta);\n          }\n        } else {\n          return clampNegativeDelta(sizes, index, delta, minCellSize);\n        }\n      };\n      var calcRedestributedWidths = function (sizes, _totalWidth, _pixelDelta, _isRelative) {\n        return {\n          delta: 0,\n          newSizes: sizes\n        };\n      };\n      return {\n        resizeTable: resizeTable,\n        clampTableDelta: clampTableDelta,\n        calcLeftEdgeDeltas: calcLeftEdgeDeltas,\n        calcMiddleDeltas: calcMiddleDeltas,\n        calcRightEdgeDeltas: calcRightEdgeDeltas,\n        calcRedestributedWidths: calcRedestributedWidths\n      };\n    };\n\n    var only = function (element, isResizable) {\n      var parent = Optional.from(element.dom.documentElement).map(SugarElement.fromDom).getOr(element);\n      return {\n        parent: constant(parent),\n        view: constant(element),\n        origin: constant(SugarPosition(0, 0)),\n        isResizable: isResizable\n      };\n    };\n    var detached = function (editable, chrome, isResizable) {\n      var origin = function () {\n        return absolute(chrome);\n      };\n      return {\n        parent: constant(chrome),\n        view: constant(editable),\n        origin: origin,\n        isResizable: isResizable\n      };\n    };\n    var body = function (editable, chrome, isResizable) {\n      return {\n        parent: constant(chrome),\n        view: constant(editable),\n        origin: constant(SugarPosition(0, 0)),\n        isResizable: isResizable\n      };\n    };\n    var ResizeWire = {\n      only: only,\n      detached: detached,\n      body: body\n    };\n\n    var adt$6 = Adt.generate([\n      { invalid: ['raw'] },\n      { pixels: ['value'] },\n      { percent: ['value'] }\n    ]);\n    var validateFor = function (suffix, type, value) {\n      var rawAmount = value.substring(0, value.length - suffix.length);\n      var amount = parseFloat(rawAmount);\n      return rawAmount === amount.toString() ? type(amount) : adt$6.invalid(value);\n    };\n    var from = function (value) {\n      if (endsWith(value, '%')) {\n        return validateFor('%', adt$6.percent, value);\n      }\n      if (endsWith(value, 'px')) {\n        return validateFor('px', adt$6.pixels, value);\n      }\n      return adt$6.invalid(value);\n    };\n    var Size = __assign(__assign({}, adt$6), { from: from });\n\n    var redistributeToPercent = function (widths, totalWidth) {\n      return map$1(widths, function (w) {\n        var colType = Size.from(w);\n        return colType.fold(function () {\n          return w;\n        }, function (px) {\n          var ratio = px / totalWidth * 100;\n          return ratio + '%';\n        }, function (pc) {\n          return pc + '%';\n        });\n      });\n    };\n    var redistributeToPx = function (widths, totalWidth, newTotalWidth) {\n      var scale = newTotalWidth / totalWidth;\n      return map$1(widths, function (w) {\n        var colType = Size.from(w);\n        return colType.fold(function () {\n          return w;\n        }, function (px) {\n          return px * scale + 'px';\n        }, function (pc) {\n          return pc / 100 * newTotalWidth + 'px';\n        });\n      });\n    };\n    var redistributeEmpty = function (newWidthType, columns) {\n      var f = newWidthType.fold(function () {\n        return constant('');\n      }, function (pixels) {\n        var num = pixels / columns;\n        return constant(num + 'px');\n      }, function () {\n        var num = 100 / columns;\n        return constant(num + '%');\n      });\n      return range$1(columns, f);\n    };\n    var redistributeValues = function (newWidthType, widths, totalWidth) {\n      return newWidthType.fold(function () {\n        return widths;\n      }, function (px) {\n        return redistributeToPx(widths, totalWidth, px);\n      }, function (_pc) {\n        return redistributeToPercent(widths, totalWidth);\n      });\n    };\n    var redistribute$1 = function (widths, totalWidth, newWidth) {\n      var newType = Size.from(newWidth);\n      var floats = forall(widths, function (s) {\n        return s === '0px';\n      }) ? redistributeEmpty(newType, widths.length) : redistributeValues(newType, widths, totalWidth);\n      return normalize(floats);\n    };\n    var sum = function (values, fallback) {\n      if (values.length === 0) {\n        return fallback;\n      }\n      return foldr(values, function (rest, v) {\n        return Size.from(v).fold(constant(0), identity, identity) + rest;\n      }, 0);\n    };\n    var roundDown = function (num, unit) {\n      var floored = Math.floor(num);\n      return {\n        value: floored + unit,\n        remainder: num - floored\n      };\n    };\n    var add$3 = function (value, amount) {\n      return Size.from(value).fold(constant(value), function (px) {\n        return px + amount + 'px';\n      }, function (pc) {\n        return pc + amount + '%';\n      });\n    };\n    var normalize = function (values) {\n      if (values.length === 0) {\n        return values;\n      }\n      var scan = foldr(values, function (rest, value) {\n        var info = Size.from(value).fold(function () {\n          return {\n            value: value,\n            remainder: 0\n          };\n        }, function (num) {\n          return roundDown(num, 'px');\n        }, function (num) {\n          return {\n            value: num + '%',\n            remainder: 0\n          };\n        });\n        return {\n          output: [info.value].concat(rest.output),\n          remainder: rest.remainder + info.remainder\n        };\n      }, {\n        output: [],\n        remainder: 0\n      });\n      var r = scan.output;\n      return r.slice(0, r.length - 1).concat([add$3(r[r.length - 1], Math.round(scan.remainder))]);\n    };\n    var validate = Size.from;\n\n    var redistributeToW = function (newWidths, cells, unit) {\n      each$2(cells, function (cell) {\n        var widths = newWidths.slice(cell.column, cell.colspan + cell.column);\n        var w = sum(widths, minWidth());\n        set$1(cell.element, 'width', w + unit);\n      });\n    };\n    var redistributeToColumns = function (newWidths, columns, unit) {\n      each$2(columns, function (column, index) {\n        var width = sum([newWidths[index]], minWidth());\n        set$1(column.element, 'width', width + unit);\n      });\n    };\n    var redistributeToH = function (newHeights, rows, cells, unit) {\n      each$2(cells, function (cell) {\n        var heights = newHeights.slice(cell.row, cell.rowspan + cell.row);\n        var h = sum(heights, minHeight());\n        set$1(cell.element, 'height', h + unit);\n      });\n      each$2(rows, function (row, i) {\n        set$1(row.element, 'height', newHeights[i]);\n      });\n    };\n    var getUnit = function (newSize) {\n      return validate(newSize).fold(constant('px'), constant('px'), constant('%'));\n    };\n    var redistribute = function (table, optWidth, optHeight) {\n      var warehouse = Warehouse.fromTable(table);\n      var rows = warehouse.all;\n      var cells = Warehouse.justCells(warehouse);\n      var columns = Warehouse.justColumns(warehouse);\n      optWidth.each(function (newWidth) {\n        var widthUnit = getUnit(newWidth);\n        var totalWidth = get$8(table);\n        var oldWidths = getRawWidths(warehouse, table);\n        var nuWidths = redistribute$1(oldWidths, totalWidth, newWidth);\n        if (Warehouse.hasColumns(warehouse)) {\n          redistributeToColumns(nuWidths, columns, widthUnit);\n        } else {\n          redistributeToW(nuWidths, cells, widthUnit);\n        }\n        set$1(table, 'width', newWidth);\n      });\n      optHeight.each(function (newHeight) {\n        var hUnit = getUnit(newHeight);\n        var totalHeight = get$7(table);\n        var oldHeights = getRawHeights(warehouse, table, height);\n        var nuHeights = redistribute$1(oldHeights, totalHeight, newHeight);\n        redistributeToH(nuHeights, rows, cells, hUnit);\n        set$1(table, 'height', newHeight);\n      });\n    };\n    var isPercentSizing = isPercentSizing$1;\n    var isPixelSizing = isPixelSizing$1;\n    var isNoneSizing = isNoneSizing$1;\n\n    var getGridSize = function (table) {\n      var warehouse = Warehouse.fromTable(table);\n      return warehouse.grid;\n    };\n\n    var Event = function (fields) {\n      var handlers = [];\n      var bind = function (handler) {\n        if (handler === undefined) {\n          throw new Error('Event bind error: undefined handler');\n        }\n        handlers.push(handler);\n      };\n      var unbind = function (handler) {\n        handlers = filter$2(handlers, function (h) {\n          return h !== handler;\n        });\n      };\n      var trigger = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        var event = {};\n        each$2(fields, function (name, i) {\n          event[name] = args[i];\n        });\n        each$2(handlers, function (handler) {\n          handler(event);\n        });\n      };\n      return {\n        bind: bind,\n        unbind: unbind,\n        trigger: trigger\n      };\n    };\n\n    var create$4 = function (typeDefs) {\n      var registry = map(typeDefs, function (event) {\n        return {\n          bind: event.bind,\n          unbind: event.unbind\n        };\n      });\n      var trigger = map(typeDefs, function (event) {\n        return event.trigger;\n      });\n      return {\n        registry: registry,\n        trigger: trigger\n      };\n    };\n\n    var last = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (!isNull(timer)) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        cancel();\n        timer = setTimeout(function () {\n          timer = null;\n          fn.apply(null, args);\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var sort = function (arr) {\n      return arr.slice(0).sort();\n    };\n    var reqMessage = function (required, keys) {\n      throw new Error('All required keys (' + sort(required).join(', ') + ') were not specified. Specified keys were: ' + sort(keys).join(', ') + '.');\n    };\n    var unsuppMessage = function (unsupported) {\n      throw new Error('Unsupported keys for object: ' + sort(unsupported).join(', '));\n    };\n    var validateStrArr = function (label, array) {\n      if (!isArray(array)) {\n        throw new Error('The ' + label + ' fields must be an array. Was: ' + array + '.');\n      }\n      each$2(array, function (a) {\n        if (!isString(a)) {\n          throw new Error('The value ' + a + ' in the ' + label + ' fields was not a string.');\n        }\n      });\n    };\n    var invalidTypeMessage = function (incorrect, type) {\n      throw new Error('All values need to be of type: ' + type + '. Keys (' + sort(incorrect).join(', ') + ') were not.');\n    };\n    var checkDupes = function (everything) {\n      var sorted = sort(everything);\n      var dupe = find$1(sorted, function (s, i) {\n        return i < sorted.length - 1 && s === sorted[i + 1];\n      });\n      dupe.each(function (d) {\n        throw new Error('The field: ' + d + ' occurs more than once in the combined fields: [' + sorted.join(', ') + '].');\n      });\n    };\n\n    var base = function (handleUnsupported, required) {\n      return baseWith(handleUnsupported, required, {\n        validate: isFunction,\n        label: 'function'\n      });\n    };\n    var baseWith = function (handleUnsupported, required, pred) {\n      if (required.length === 0) {\n        throw new Error('You must specify at least one required field.');\n      }\n      validateStrArr('required', required);\n      checkDupes(required);\n      return function (obj) {\n        var keys$1 = keys(obj);\n        var allReqd = forall(required, function (req) {\n          return contains$2(keys$1, req);\n        });\n        if (!allReqd) {\n          reqMessage(required, keys$1);\n        }\n        handleUnsupported(required, keys$1);\n        var invalidKeys = filter$2(required, function (key) {\n          return !pred.validate(obj[key], key);\n        });\n        if (invalidKeys.length > 0) {\n          invalidTypeMessage(invalidKeys, pred.label);\n        }\n        return obj;\n      };\n    };\n    var handleExact = function (required, keys) {\n      var unsupported = filter$2(keys, function (key) {\n        return !contains$2(required, key);\n      });\n      if (unsupported.length > 0) {\n        unsuppMessage(unsupported);\n      }\n    };\n    var exactly = function (required) {\n      return base(handleExact, required);\n    };\n\n    var DragMode = exactly([\n      'compare',\n      'extract',\n      'mutate',\n      'sink'\n    ]);\n    var DragSink = exactly([\n      'element',\n      'start',\n      'stop',\n      'destroy'\n    ]);\n    var DragApi = exactly([\n      'forceDrop',\n      'drop',\n      'move',\n      'delayDrop'\n    ]);\n\n    var InDrag = function () {\n      var previous = Optional.none();\n      var reset = function () {\n        previous = Optional.none();\n      };\n      var update = function (mode, nu) {\n        var result = previous.map(function (old) {\n          return mode.compare(old, nu);\n        });\n        previous = Optional.some(nu);\n        return result;\n      };\n      var onEvent = function (event, mode) {\n        var dataOption = mode.extract(event);\n        dataOption.each(function (data) {\n          var offset = update(mode, data);\n          offset.each(function (d) {\n            events.trigger.move(d);\n          });\n        });\n      };\n      var events = create$4({ move: Event(['info']) });\n      return {\n        onEvent: onEvent,\n        reset: reset,\n        events: events.registry\n      };\n    };\n\n    var NoDrag = function () {\n      var events = create$4({ move: Event(['info']) });\n      return {\n        onEvent: noop,\n        reset: noop,\n        events: events.registry\n      };\n    };\n\n    var Movement = function () {\n      var noDragState = NoDrag();\n      var inDragState = InDrag();\n      var dragState = noDragState;\n      var on = function () {\n        dragState.reset();\n        dragState = inDragState;\n      };\n      var off = function () {\n        dragState.reset();\n        dragState = noDragState;\n      };\n      var onEvent = function (event, mode) {\n        dragState.onEvent(event, mode);\n      };\n      var isOn = function () {\n        return dragState === inDragState;\n      };\n      return {\n        on: on,\n        off: off,\n        isOn: isOn,\n        onEvent: onEvent,\n        events: inDragState.events\n      };\n    };\n\n    var setup = function (mutation, mode, settings) {\n      var active = false;\n      var events = create$4({\n        start: Event([]),\n        stop: Event([])\n      });\n      var movement = Movement();\n      var drop = function () {\n        sink.stop();\n        if (movement.isOn()) {\n          movement.off();\n          events.trigger.stop();\n        }\n      };\n      var throttledDrop = last(drop, 200);\n      var go = function (parent) {\n        sink.start(parent);\n        movement.on();\n        events.trigger.start();\n      };\n      var mousemove = function (event) {\n        throttledDrop.cancel();\n        movement.onEvent(event, mode);\n      };\n      movement.events.move.bind(function (event) {\n        mode.mutate(mutation, event.info);\n      });\n      var on = function () {\n        active = true;\n      };\n      var off = function () {\n        active = false;\n      };\n      var runIfActive = function (f) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          if (active) {\n            f.apply(null, args);\n          }\n        };\n      };\n      var sink = mode.sink(DragApi({\n        forceDrop: drop,\n        drop: runIfActive(drop),\n        move: runIfActive(mousemove),\n        delayDrop: runIfActive(throttledDrop.throttle)\n      }), settings);\n      var destroy = function () {\n        sink.destroy();\n      };\n      return {\n        element: sink.element,\n        go: go,\n        on: on,\n        off: off,\n        destroy: destroy,\n        events: events.registry\n      };\n    };\n\n    var mkEvent = function (target, x, y, stop, prevent, kill, raw) {\n      return {\n        target: target,\n        x: x,\n        y: y,\n        stop: stop,\n        prevent: prevent,\n        kill: kill,\n        raw: raw\n      };\n    };\n    var fromRawEvent$1 = function (rawEvent) {\n      var target = SugarElement.fromDom(getOriginalEventTarget(rawEvent).getOr(rawEvent.target));\n      var stop = function () {\n        return rawEvent.stopPropagation();\n      };\n      var prevent = function () {\n        return rawEvent.preventDefault();\n      };\n      var kill = compose(prevent, stop);\n      return mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n    };\n    var handle$2 = function (filter, handler) {\n      return function (rawEvent) {\n        if (filter(rawEvent)) {\n          handler(fromRawEvent$1(rawEvent));\n        }\n      };\n    };\n    var binder = function (element, event, filter, handler, useCapture) {\n      var wrapped = handle$2(filter, handler);\n      element.dom.addEventListener(event, wrapped, useCapture);\n      return { unbind: curry(unbind, element, event, wrapped, useCapture) };\n    };\n    var bind$1 = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, false);\n    };\n    var unbind = function (element, event, handler, useCapture) {\n      element.dom.removeEventListener(event, handler, useCapture);\n    };\n\n    var filter = always;\n    var bind = function (element, event, handler) {\n      return bind$1(element, event, filter, handler);\n    };\n    var fromRawEvent = fromRawEvent$1;\n\n    var read = function (element, attr) {\n      var value = get$b(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add$2 = function (element, attr, id) {\n      var old = read(element, attr);\n      var nu = old.concat([id]);\n      set$2(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$4 = function (element, attr, id) {\n      var nu = filter$2(read(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set$2(element, attr, nu.join(' '));\n      } else {\n        remove$7(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom.classList !== undefined;\n    };\n    var get$5 = function (element) {\n      return read(element, 'class');\n    };\n    var add$1 = function (element, clazz) {\n      return add$2(element, 'class', clazz);\n    };\n    var remove$3 = function (element, clazz) {\n      return remove$4(element, 'class', clazz);\n    };\n\n    var add = function (element, clazz) {\n      if (supports(element)) {\n        element.dom.classList.add(clazz);\n      } else {\n        add$1(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom.classList : get$5(element);\n      if (classList.length === 0) {\n        remove$7(element, 'class');\n      }\n    };\n    var remove$2 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom.classList;\n        classList.remove(clazz);\n      } else {\n        remove$3(element, clazz);\n      }\n      cleanClass(element);\n    };\n    var has = function (element, clazz) {\n      return supports(element) && element.dom.classList.contains(clazz);\n    };\n\n    var css = function (namespace) {\n      var dashNamespace = namespace.replace(/\\./g, '-');\n      var resolve = function (str) {\n        return dashNamespace + '-' + str;\n      };\n      return { resolve: resolve };\n    };\n\n    var styles$1 = css('ephox-dragster');\n    var resolve$1 = styles$1.resolve;\n\n    var Blocker = function (options) {\n      var settings = __assign({ layerClass: resolve$1('blocker') }, options);\n      var div = SugarElement.fromTag('div');\n      set$2(div, 'role', 'presentation');\n      setAll(div, {\n        position: 'fixed',\n        left: '0px',\n        top: '0px',\n        width: '100%',\n        height: '100%'\n      });\n      add(div, resolve$1('blocker'));\n      add(div, settings.layerClass);\n      var element = constant(div);\n      var destroy = function () {\n        remove$5(div);\n      };\n      return {\n        element: element,\n        destroy: destroy\n      };\n    };\n\n    var compare = function (old, nu) {\n      return SugarPosition(nu.left - old.left, nu.top - old.top);\n    };\n    var extract = function (event) {\n      return Optional.some(SugarPosition(event.x, event.y));\n    };\n    var mutate = function (mutation, info) {\n      mutation.mutate(info.left, info.top);\n    };\n    var sink = function (dragApi, settings) {\n      var blocker = Blocker(settings);\n      var mdown = bind(blocker.element(), 'mousedown', dragApi.forceDrop);\n      var mup = bind(blocker.element(), 'mouseup', dragApi.drop);\n      var mmove = bind(blocker.element(), 'mousemove', dragApi.move);\n      var mout = bind(blocker.element(), 'mouseout', dragApi.delayDrop);\n      var destroy = function () {\n        blocker.destroy();\n        mup.unbind();\n        mmove.unbind();\n        mout.unbind();\n        mdown.unbind();\n      };\n      var start = function (parent) {\n        append$1(parent, blocker.element());\n      };\n      var stop = function () {\n        remove$5(blocker.element());\n      };\n      return DragSink({\n        element: blocker.element,\n        start: start,\n        stop: stop,\n        destroy: destroy\n      });\n    };\n    var MouseDrag = DragMode({\n      compare: compare,\n      extract: extract,\n      sink: sink,\n      mutate: mutate\n    });\n\n    var transform$1 = function (mutation, settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n      var mode = settings.mode !== undefined ? settings.mode : MouseDrag;\n      return setup(mutation, mode, settings);\n    };\n\n    var closest = function (target) {\n      return closest$1(target, '[contenteditable]');\n    };\n    var isEditable$1 = function (element, assumeEditable) {\n      if (assumeEditable === void 0) {\n        assumeEditable = false;\n      }\n      if (!detect$3().browser.isIE() && inBody(element)) {\n        return element.dom.isContentEditable;\n      } else {\n        return closest(element).fold(constant(assumeEditable), function (editable) {\n          return getRaw(editable) === 'true';\n        });\n      }\n    };\n    var getRaw = function (element) {\n      return element.dom.contentEditable;\n    };\n\n    var styles = css('ephox-snooker');\n    var resolve = styles.resolve;\n\n    var Mutation = function () {\n      var events = create$4({\n        drag: Event([\n          'xDelta',\n          'yDelta'\n        ])\n      });\n      var mutate = function (x, y) {\n        events.trigger.drag(x, y);\n      };\n      return {\n        mutate: mutate,\n        events: events.registry\n      };\n    };\n\n    var BarMutation = function () {\n      var events = create$4({\n        drag: Event([\n          'xDelta',\n          'yDelta',\n          'target'\n        ])\n      });\n      var target = Optional.none();\n      var delegate = Mutation();\n      delegate.events.drag.bind(function (event) {\n        target.each(function (t) {\n          events.trigger.drag(event.xDelta, event.yDelta, t);\n        });\n      });\n      var assign = function (t) {\n        target = Optional.some(t);\n      };\n      var get = function () {\n        return target;\n      };\n      return {\n        assign: assign,\n        get: get,\n        mutate: delegate.mutate,\n        events: events.registry\n      };\n    };\n\n    var col = function (column, x, y, w, h) {\n      var bar = SugarElement.fromTag('div');\n      setAll(bar, {\n        position: 'absolute',\n        left: x - w / 2 + 'px',\n        top: y + 'px',\n        height: h + 'px',\n        width: w + 'px'\n      });\n      setAll$1(bar, {\n        'data-column': column,\n        'role': 'presentation'\n      });\n      return bar;\n    };\n    var row = function (r, x, y, w, h) {\n      var bar = SugarElement.fromTag('div');\n      setAll(bar, {\n        position: 'absolute',\n        left: x + 'px',\n        top: y - h / 2 + 'px',\n        height: h + 'px',\n        width: w + 'px'\n      });\n      setAll$1(bar, {\n        'data-row': r,\n        'role': 'presentation'\n      });\n      return bar;\n    };\n\n    var resizeBar = resolve('resizer-bar');\n    var resizeRowBar = resolve('resizer-rows');\n    var resizeColBar = resolve('resizer-cols');\n    var BAR_THICKNESS = 7;\n    var resizableRows = function (warehouse, isResizable) {\n      return bind$2(warehouse.all, function (row, i) {\n        return isResizable(row.element) ? [i] : [];\n      });\n    };\n    var resizableColumns = function (warehouse, isResizable) {\n      var resizableCols = [];\n      range$1(warehouse.grid.columns, function (index) {\n        var colElmOpt = Warehouse.getColumnAt(warehouse, index).map(function (col) {\n          return col.element;\n        });\n        if (colElmOpt.forall(isResizable)) {\n          resizableCols.push(index);\n        }\n      });\n      return filter$2(resizableCols, function (colIndex) {\n        var columnCells = Warehouse.filterItems(warehouse, function (cell) {\n          return cell.column === colIndex;\n        });\n        return forall(columnCells, function (cell) {\n          return isResizable(cell.element);\n        });\n      });\n    };\n    var destroy = function (wire) {\n      var previous = descendants(wire.parent(), '.' + resizeBar);\n      each$2(previous, remove$5);\n    };\n    var drawBar = function (wire, positions, create) {\n      var origin = wire.origin();\n      each$2(positions, function (cpOption) {\n        cpOption.each(function (cp) {\n          var bar = create(origin, cp);\n          add(bar, resizeBar);\n          append$1(wire.parent(), bar);\n        });\n      });\n    };\n    var refreshCol = function (wire, colPositions, position, tableHeight) {\n      drawBar(wire, colPositions, function (origin, cp) {\n        var colBar = col(cp.col, cp.x - origin.left, position.top - origin.top, BAR_THICKNESS, tableHeight);\n        add(colBar, resizeColBar);\n        return colBar;\n      });\n    };\n    var refreshRow = function (wire, rowPositions, position, tableWidth) {\n      drawBar(wire, rowPositions, function (origin, cp) {\n        var rowBar = row(cp.row, position.left - origin.left, cp.y - origin.top, tableWidth, BAR_THICKNESS);\n        add(rowBar, resizeRowBar);\n        return rowBar;\n      });\n    };\n    var refreshGrid = function (warhouse, wire, table, rows, cols) {\n      var position = absolute(table);\n      var isResizable = wire.isResizable;\n      var rowPositions = rows.length > 0 ? height.positions(rows, table) : [];\n      var resizableRowBars = rowPositions.length > 0 ? resizableRows(warhouse, isResizable) : [];\n      var resizableRowPositions = filter$2(rowPositions, function (_pos, i) {\n        return exists(resizableRowBars, function (barIndex) {\n          return i === barIndex;\n        });\n      });\n      refreshRow(wire, resizableRowPositions, position, getOuter$2(table));\n      var colPositions = cols.length > 0 ? width.positions(cols, table) : [];\n      var resizableColBars = colPositions.length > 0 ? resizableColumns(warhouse, isResizable) : [];\n      var resizableColPositions = filter$2(colPositions, function (_pos, i) {\n        return exists(resizableColBars, function (barIndex) {\n          return i === barIndex;\n        });\n      });\n      refreshCol(wire, resizableColPositions, position, getOuter$1(table));\n    };\n    var refresh = function (wire, table) {\n      destroy(wire);\n      if (wire.isResizable(table)) {\n        var warehouse = Warehouse.fromTable(table);\n        var rows$1 = rows(warehouse);\n        var cols = columns(warehouse);\n        refreshGrid(warehouse, wire, table, rows$1, cols);\n      }\n    };\n    var each = function (wire, f) {\n      var bars = descendants(wire.parent(), '.' + resizeBar);\n      each$2(bars, f);\n    };\n    var hide = function (wire) {\n      each(wire, function (bar) {\n        set$1(bar, 'display', 'none');\n      });\n    };\n    var show = function (wire) {\n      each(wire, function (bar) {\n        set$1(bar, 'display', 'block');\n      });\n    };\n    var isRowBar = function (element) {\n      return has(element, resizeRowBar);\n    };\n    var isColBar = function (element) {\n      return has(element, resizeColBar);\n    };\n\n    var resizeBarDragging = resolve('resizer-bar-dragging');\n    var BarManager = function (wire) {\n      var mutation = BarMutation();\n      var resizing = transform$1(mutation, {});\n      var hoverTable = Optional.none();\n      var getResizer = function (element, type) {\n        return Optional.from(get$b(element, type));\n      };\n      mutation.events.drag.bind(function (event) {\n        getResizer(event.target, 'data-row').each(function (_dataRow) {\n          var currentRow = getCssValue(event.target, 'top');\n          set$1(event.target, 'top', currentRow + event.yDelta + 'px');\n        });\n        getResizer(event.target, 'data-column').each(function (_dataCol) {\n          var currentCol = getCssValue(event.target, 'left');\n          set$1(event.target, 'left', currentCol + event.xDelta + 'px');\n        });\n      });\n      var getDelta = function (target, dir) {\n        var newX = getCssValue(target, dir);\n        var oldX = getAttrValue(target, 'data-initial-' + dir, 0);\n        return newX - oldX;\n      };\n      resizing.events.stop.bind(function () {\n        mutation.get().each(function (target) {\n          hoverTable.each(function (table) {\n            getResizer(target, 'data-row').each(function (row) {\n              var delta = getDelta(target, 'top');\n              remove$7(target, 'data-initial-top');\n              events.trigger.adjustHeight(table, delta, parseInt(row, 10));\n            });\n            getResizer(target, 'data-column').each(function (column) {\n              var delta = getDelta(target, 'left');\n              remove$7(target, 'data-initial-left');\n              events.trigger.adjustWidth(table, delta, parseInt(column, 10));\n            });\n            refresh(wire, table);\n          });\n        });\n      });\n      var handler = function (target, dir) {\n        events.trigger.startAdjust();\n        mutation.assign(target);\n        set$2(target, 'data-initial-' + dir, getCssValue(target, dir));\n        add(target, resizeBarDragging);\n        set$1(target, 'opacity', '0.2');\n        resizing.go(wire.parent());\n      };\n      var mousedown = bind(wire.parent(), 'mousedown', function (event) {\n        if (isRowBar(event.target)) {\n          handler(event.target, 'top');\n        }\n        if (isColBar(event.target)) {\n          handler(event.target, 'left');\n        }\n      });\n      var isRoot = function (e) {\n        return eq$1(e, wire.view());\n      };\n      var findClosestEditableTable = function (target) {\n        return closest$1(target, 'table', isRoot).filter(isEditable$1);\n      };\n      var mouseover = bind(wire.view(), 'mouseover', function (event) {\n        findClosestEditableTable(event.target).fold(function () {\n          if (inBody(event.target)) {\n            destroy(wire);\n          }\n        }, function (table) {\n          hoverTable = Optional.some(table);\n          refresh(wire, table);\n        });\n      });\n      var destroy$1 = function () {\n        mousedown.unbind();\n        mouseover.unbind();\n        resizing.destroy();\n        destroy(wire);\n      };\n      var refresh$1 = function (tbl) {\n        refresh(wire, tbl);\n      };\n      var events = create$4({\n        adjustHeight: Event([\n          'table',\n          'delta',\n          'row'\n        ]),\n        adjustWidth: Event([\n          'table',\n          'delta',\n          'column'\n        ]),\n        startAdjust: Event([])\n      });\n      return {\n        destroy: destroy$1,\n        refresh: refresh$1,\n        on: resizing.on,\n        off: resizing.off,\n        hideBars: curry(hide, wire),\n        showBars: curry(show, wire),\n        events: events.registry\n      };\n    };\n\n    var create$3 = function (wire, resizing, lazySizing) {\n      var hdirection = height;\n      var vdirection = width;\n      var manager = BarManager(wire);\n      var events = create$4({\n        beforeResize: Event([\n          'table',\n          'type'\n        ]),\n        afterResize: Event([\n          'table',\n          'type'\n        ]),\n        startDrag: Event([])\n      });\n      manager.events.adjustHeight.bind(function (event) {\n        var table = event.table;\n        events.trigger.beforeResize(table, 'row');\n        var delta = hdirection.delta(event.delta, table);\n        adjustHeight(table, delta, event.row, hdirection);\n        events.trigger.afterResize(table, 'row');\n      });\n      manager.events.startAdjust.bind(function (_event) {\n        events.trigger.startDrag();\n      });\n      manager.events.adjustWidth.bind(function (event) {\n        var table = event.table;\n        events.trigger.beforeResize(table, 'col');\n        var delta = vdirection.delta(event.delta, table);\n        var tableSize = lazySizing(table);\n        adjustWidth(table, delta, event.column, resizing, tableSize);\n        events.trigger.afterResize(table, 'col');\n      });\n      return {\n        on: manager.on,\n        off: manager.off,\n        hideBars: manager.hideBars,\n        showBars: manager.showBars,\n        destroy: manager.destroy,\n        events: events.registry\n      };\n    };\n    var TableResize = { create: create$3 };\n\n    var fireNewRow = function (editor, row) {\n      return editor.fire('newrow', { node: row });\n    };\n    var fireNewCell = function (editor, cell) {\n      return editor.fire('newcell', { node: cell });\n    };\n    var fireObjectResizeStart = function (editor, target, width, height, origin) {\n      editor.fire('ObjectResizeStart', {\n        target: target,\n        width: width,\n        height: height,\n        origin: origin\n      });\n    };\n    var fireObjectResized = function (editor, target, width, height, origin) {\n      editor.fire('ObjectResized', {\n        target: target,\n        width: width,\n        height: height,\n        origin: origin\n      });\n    };\n    var fireTableSelectionChange = function (editor, cells, start, finish, otherCells) {\n      editor.fire('TableSelectionChange', {\n        cells: cells,\n        start: start,\n        finish: finish,\n        otherCells: otherCells\n      });\n    };\n    var fireTableSelectionClear = function (editor) {\n      editor.fire('TableSelectionClear');\n    };\n    var fireTableModified = function (editor, table, data) {\n      editor.fire('TableModified', __assign(__assign({}, data), { table: table }));\n    };\n    var styleModified = {\n      structure: false,\n      style: true\n    };\n    var structureModified = {\n      structure: true,\n      style: false\n    };\n    var styleAndStructureModified = {\n      structure: true,\n      style: true\n    };\n\n    var defaultTableToolbar = 'tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol';\n    var defaultStyles = {\n      'border-collapse': 'collapse',\n      'width': '100%'\n    };\n    var defaultCellBorderWidths = range$1(5, function (i) {\n      var size = i + 1 + 'px';\n      return {\n        title: size,\n        value: size\n      };\n    });\n    var defaultCellBorderStyles = map$1([\n      'Solid',\n      'Dotted',\n      'Dashed',\n      'Double',\n      'Groove',\n      'Ridge',\n      'Inset',\n      'Outset',\n      'None',\n      'Hidden'\n    ], function (type) {\n      return {\n        title: type,\n        value: type.toLowerCase()\n      };\n    });\n    var determineDefaultStyles = function (editor) {\n      var _a;\n      if (isPixelsForced(editor)) {\n        var dom = editor.dom;\n        var parentBlock = (_a = dom.getParent(editor.selection.getStart(), dom.isBlock)) !== null && _a !== void 0 ? _a : editor.getBody();\n        var contentWidth = getInner(SugarElement.fromDom(parentBlock));\n        return __assign(__assign({}, defaultStyles), { width: contentWidth + 'px' });\n      } else if (isResponsiveForced(editor)) {\n        return filter$1(defaultStyles, function (_value, key) {\n          return key !== 'width';\n        });\n      } else {\n        return defaultStyles;\n      }\n    };\n    var defaultAttributes = { border: '1' };\n    var defaultColumnResizingBehaviour = 'preservetable';\n    var getTableSizingMode = function (editor) {\n      return editor.getParam('table_sizing_mode', 'auto');\n    };\n    var getTableResponseWidth = function (editor) {\n      return editor.getParam('table_responsive_width');\n    };\n    var getTableBorderWidths = function (editor) {\n      return editor.getParam('table_border_widths', defaultCellBorderWidths, 'array');\n    };\n    var getTableBorderStyles = function (editor) {\n      return editor.getParam('table_border_styles', defaultCellBorderStyles, 'array');\n    };\n    var getDefaultAttributes = function (editor) {\n      return editor.getParam('table_default_attributes', defaultAttributes, 'object');\n    };\n    var getDefaultStyles = function (editor) {\n      return editor.getParam('table_default_styles', determineDefaultStyles(editor), 'object');\n    };\n    var hasTableResizeBars = function (editor) {\n      return editor.getParam('table_resize_bars', true, 'boolean');\n    };\n    var hasTabNavigation = function (editor) {\n      return editor.getParam('table_tab_navigation', true, 'boolean');\n    };\n    var hasAdvancedCellTab = function (editor) {\n      return editor.getParam('table_cell_advtab', true, 'boolean');\n    };\n    var hasAdvancedRowTab = function (editor) {\n      return editor.getParam('table_row_advtab', true, 'boolean');\n    };\n    var hasAdvancedTableTab = function (editor) {\n      return editor.getParam('table_advtab', true, 'boolean');\n    };\n    var hasAppearanceOptions = function (editor) {\n      return editor.getParam('table_appearance_options', true, 'boolean');\n    };\n    var hasTableGrid = function (editor) {\n      return editor.getParam('table_grid', true, 'boolean');\n    };\n    var shouldStyleWithCss = function (editor) {\n      return editor.getParam('table_style_by_css', false, 'boolean');\n    };\n    var getCellClassList = function (editor) {\n      return editor.getParam('table_cell_class_list', [], 'array');\n    };\n    var getRowClassList = function (editor) {\n      return editor.getParam('table_row_class_list', [], 'array');\n    };\n    var getTableClassList = function (editor) {\n      return editor.getParam('table_class_list', [], 'array');\n    };\n    var isPercentagesForced = function (editor) {\n      return getTableSizingMode(editor) === 'relative' || getTableResponseWidth(editor) === true;\n    };\n    var isPixelsForced = function (editor) {\n      return getTableSizingMode(editor) === 'fixed' || getTableResponseWidth(editor) === false;\n    };\n    var isResponsiveForced = function (editor) {\n      return getTableSizingMode(editor) === 'responsive';\n    };\n    var getToolbar = function (editor) {\n      return editor.getParam('table_toolbar', defaultTableToolbar);\n    };\n    var useColumnGroup = function (editor) {\n      return editor.getParam('table_use_colgroups', false, 'boolean');\n    };\n    var getTableHeaderType = function (editor) {\n      var defaultValue = 'section';\n      var value = editor.getParam('table_header_type', defaultValue, 'string');\n      var validValues = [\n        'section',\n        'cells',\n        'sectionCells',\n        'auto'\n      ];\n      if (!contains$2(validValues, value)) {\n        return defaultValue;\n      } else {\n        return value;\n      }\n    };\n    var getColumnResizingBehaviour = function (editor) {\n      var validModes = [\n        'preservetable',\n        'resizetable'\n      ];\n      var givenMode = editor.getParam('table_column_resizing', defaultColumnResizingBehaviour, 'string');\n      return find$1(validModes, function (mode) {\n        return mode === givenMode;\n      }).getOr(defaultColumnResizingBehaviour);\n    };\n    var isPreserveTableColumnResizing = function (editor) {\n      return getColumnResizingBehaviour(editor) === 'preservetable';\n    };\n    var isResizeTableColumnResizing = function (editor) {\n      return getColumnResizingBehaviour(editor) === 'resizetable';\n    };\n    var getCloneElements = function (editor) {\n      var cloneElements = editor.getParam('table_clone_elements');\n      if (isString(cloneElements)) {\n        return Optional.some(cloneElements.split(/[ ,]/));\n      } else if (Array.isArray(cloneElements)) {\n        return Optional.some(cloneElements);\n      } else {\n        return Optional.none();\n      }\n    };\n    var hasObjectResizing = function (editor) {\n      var objectResizing = editor.getParam('object_resizing', true);\n      return isString(objectResizing) ? objectResizing === 'table' : objectResizing;\n    };\n    var getTableBackgroundColorMap = function (editor) {\n      return editor.getParam('table_background_color_map', [], 'array');\n    };\n    var getTableBorderColorMap = function (editor) {\n      return editor.getParam('table_border_color_map', [], 'array');\n    };\n\n    var get$4 = function (editor, table) {\n      if (isPercentagesForced(editor)) {\n        return TableSize.percentageSize(table);\n      } else if (isPixelsForced(editor)) {\n        return TableSize.pixelSize(table);\n      } else {\n        return TableSize.getTableSize(table);\n      }\n    };\n\n    var cleanupLegacyAttributes = function (element) {\n      remove$7(element, 'width');\n    };\n    var convertToPercentSize = function (table) {\n      var newWidth = getPercentTableWidth(table);\n      redistribute(table, Optional.some(newWidth), Optional.none());\n      cleanupLegacyAttributes(table);\n    };\n    var convertToPixelSize = function (table) {\n      var newWidth = getPixelTableWidth(table);\n      redistribute(table, Optional.some(newWidth), Optional.none());\n      cleanupLegacyAttributes(table);\n    };\n    var convertToNoneSize = function (table) {\n      remove$6(table, 'width');\n      var columns = columns$1(table);\n      var rowElements = columns.length > 0 ? columns : cells$1(table);\n      each$2(rowElements, function (cell) {\n        remove$6(cell, 'width');\n        cleanupLegacyAttributes(cell);\n      });\n      cleanupLegacyAttributes(table);\n    };\n\n    var enforcePercentage = convertToPercentSize;\n    var enforcePixels = convertToPixelSize;\n    var enforceNone = convertToNoneSize;\n    var syncPixels = function (table) {\n      var warehouse = Warehouse.fromTable(table);\n      if (!Warehouse.hasColumns(warehouse)) {\n        each$2(cells$1(table), function (cell) {\n          var computedWidth = get$a(cell, 'width');\n          set$1(cell, 'width', computedWidth);\n          remove$7(cell, 'width');\n        });\n      }\n    };\n\n    var createContainer = function () {\n      var container = SugarElement.fromTag('div');\n      setAll(container, {\n        position: 'static',\n        height: '0',\n        width: '0',\n        padding: '0',\n        margin: '0',\n        border: '0'\n      });\n      append$1(body$1(), container);\n      return container;\n    };\n    var get$3 = function (editor, isResizable) {\n      return editor.inline ? ResizeWire.body(getBody(editor), createContainer(), isResizable) : ResizeWire.only(SugarElement.fromDom(editor.getDoc()), isResizable);\n    };\n    var remove$1 = function (editor, wire) {\n      if (editor.inline) {\n        remove$5(wire.parent());\n      }\n    };\n\n    var barResizerPrefix = 'bar-';\n    var isResizable = function (elm) {\n      return get$b(elm, 'data-mce-resize') !== 'false';\n    };\n    var getResizeHandler = function (editor) {\n      var selectionRng = Optional.none();\n      var resize = Optional.none();\n      var wire = Optional.none();\n      var startW;\n      var startRawW;\n      var isTable = function (elm) {\n        return elm.nodeName === 'TABLE';\n      };\n      var lazyResize = function () {\n        return resize;\n      };\n      var lazyWire = function () {\n        return wire.getOr(ResizeWire.only(SugarElement.fromDom(editor.getBody()), isResizable));\n      };\n      var lazySizing = function (table) {\n        return get$4(editor, table);\n      };\n      var lazyResizingBehaviour = function () {\n        return isPreserveTableColumnResizing(editor) ? preserveTable() : resizeTable();\n      };\n      var getNumColumns = function (table) {\n        return getGridSize(table).columns;\n      };\n      var afterCornerResize = function (table, origin, width) {\n        var isRightEdgeResize = endsWith(origin, 'e');\n        if (startRawW === '') {\n          enforcePercentage(table);\n        }\n        if (width !== startW && startRawW !== '') {\n          set$1(table, 'width', startRawW);\n          var resizing = lazyResizingBehaviour();\n          var tableSize = lazySizing(table);\n          var col = isPreserveTableColumnResizing(editor) || isRightEdgeResize ? getNumColumns(table) - 1 : 0;\n          adjustWidth(table, width - startW, col, resizing, tableSize);\n        } else if (isPercentage$1(startRawW)) {\n          var percentW = parseFloat(startRawW.replace('%', ''));\n          var targetPercentW = width * percentW / startW;\n          set$1(table, 'width', targetPercentW + '%');\n        }\n        if (isPixel(startRawW)) {\n          syncPixels(table);\n        }\n      };\n      var destroy = function () {\n        resize.each(function (sz) {\n          sz.destroy();\n        });\n        wire.each(function (w) {\n          remove$1(editor, w);\n        });\n      };\n      editor.on('init', function () {\n        var rawWire = get$3(editor, isResizable);\n        wire = Optional.some(rawWire);\n        if (hasObjectResizing(editor) && hasTableResizeBars(editor)) {\n          var resizing = lazyResizingBehaviour();\n          var sz = TableResize.create(rawWire, resizing, lazySizing);\n          sz.on();\n          sz.events.startDrag.bind(function (_event) {\n            selectionRng = Optional.some(editor.selection.getRng());\n          });\n          sz.events.beforeResize.bind(function (event) {\n            var rawTable = event.table.dom;\n            fireObjectResizeStart(editor, rawTable, getPixelWidth(rawTable), getPixelHeight(rawTable), barResizerPrefix + event.type);\n          });\n          sz.events.afterResize.bind(function (event) {\n            var table = event.table;\n            var rawTable = table.dom;\n            removeDataStyle(table);\n            selectionRng.each(function (rng) {\n              editor.selection.setRng(rng);\n              editor.focus();\n            });\n            fireObjectResized(editor, rawTable, getPixelWidth(rawTable), getPixelHeight(rawTable), barResizerPrefix + event.type);\n            editor.undoManager.add();\n          });\n          resize = Optional.some(sz);\n        }\n      });\n      editor.on('ObjectResizeStart', function (e) {\n        var targetElm = e.target;\n        if (isTable(targetElm)) {\n          var table = SugarElement.fromDom(targetElm);\n          each$2(editor.dom.select('.mce-clonedresizable'), function (clone) {\n            editor.dom.addClass(clone, 'mce-' + getColumnResizingBehaviour(editor) + '-columns');\n          });\n          if (!isPixelSizing(table) && isPixelsForced(editor)) {\n            enforcePixels(table);\n          } else if (!isPercentSizing(table) && isPercentagesForced(editor)) {\n            enforcePercentage(table);\n          }\n          if (isNoneSizing(table) && startsWith(e.origin, barResizerPrefix)) {\n            enforcePercentage(table);\n          }\n          startW = e.width;\n          startRawW = isResponsiveForced(editor) ? '' : getRawWidth(editor, targetElm).getOr('');\n        }\n      });\n      editor.on('ObjectResized', function (e) {\n        var targetElm = e.target;\n        if (isTable(targetElm)) {\n          var table = SugarElement.fromDom(targetElm);\n          var origin_1 = e.origin;\n          if (startsWith(origin_1, 'corner-')) {\n            afterCornerResize(table, origin_1, e.width);\n          }\n          removeDataStyle(table);\n          fireTableModified(editor, table.dom, styleModified);\n        }\n      });\n      editor.on('SwitchMode', function () {\n        lazyResize().each(function (resize) {\n          if (editor.mode.isReadOnly()) {\n            resize.hideBars();\n          } else {\n            resize.showBars();\n          }\n        });\n      });\n      return {\n        lazyResize: lazyResize,\n        lazyWire: lazyWire,\n        destroy: destroy\n      };\n    };\n\n    var point = function (element, offset) {\n      return {\n        element: element,\n        offset: offset\n      };\n    };\n\n    var scan$1 = function (universe, element, direction) {\n      if (universe.property().isText(element) && universe.property().getText(element).trim().length === 0 || universe.property().isComment(element)) {\n        return direction(element).bind(function (elem) {\n          return scan$1(universe, elem, direction).orThunk(function () {\n            return Optional.some(elem);\n          });\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n    var toEnd = function (universe, element) {\n      if (universe.property().isText(element)) {\n        return universe.property().getText(element).length;\n      }\n      var children = universe.property().children(element);\n      return children.length;\n    };\n    var freefallRtl$2 = function (universe, element) {\n      var candidate = scan$1(universe, element, universe.query().prevSibling).getOr(element);\n      if (universe.property().isText(candidate)) {\n        return point(candidate, toEnd(universe, candidate));\n      }\n      var children = universe.property().children(candidate);\n      return children.length > 0 ? freefallRtl$2(universe, children[children.length - 1]) : point(candidate, toEnd(universe, candidate));\n    };\n\n    var freefallRtl$1 = freefallRtl$2;\n\n    var universe$2 = DomUniverse();\n    var freefallRtl = function (element) {\n      return freefallRtl$1(universe$2, element);\n    };\n\n    var halve = function (main, other) {\n      var colspan = getSpan(main, 'colspan');\n      if (colspan === 1) {\n        var width = getGenericWidth(main);\n        width.each(function (w) {\n          var newWidth = w.value / 2;\n          setGenericWidth(main, newWidth, w.unit);\n          setGenericWidth(other, newWidth, w.unit);\n        });\n      }\n    };\n\n    var isHeaderCell = isTag('th');\n    var isHeaderCells = function (cells) {\n      return forall(cells, function (cell) {\n        return isHeaderCell(cell.element);\n      });\n    };\n    var getRowHeaderType = function (isHeaderRow, isHeaderCells) {\n      if (isHeaderRow && isHeaderCells) {\n        return 'sectionCells';\n      } else if (isHeaderRow) {\n        return 'section';\n      } else {\n        return 'cells';\n      }\n    };\n    var getRowType$1 = function (row) {\n      var isHeaderRow = row.section === 'thead';\n      var isHeaderCells = is(findCommonCellType(row.cells), 'th');\n      if (isHeaderRow || isHeaderCells) {\n        return {\n          type: 'header',\n          subType: getRowHeaderType(isHeaderRow, isHeaderCells)\n        };\n      } else if (row.section === 'tfoot') {\n        return { type: 'footer' };\n      } else {\n        return { type: 'body' };\n      }\n    };\n    var findCommonCellType = function (cells) {\n      var headerCells = filter$2(cells, function (cell) {\n        return isHeaderCell(cell.element);\n      });\n      if (headerCells.length === 0) {\n        return Optional.some('td');\n      } else if (headerCells.length === cells.length) {\n        return Optional.some('th');\n      } else {\n        return Optional.none();\n      }\n    };\n    var findCommonRowType = function (rows) {\n      var rowTypes = map$1(rows, function (row) {\n        return getRowType$1(row).type;\n      });\n      var hasHeader = contains$2(rowTypes, 'header');\n      var hasFooter = contains$2(rowTypes, 'footer');\n      if (!hasHeader && !hasFooter) {\n        return Optional.some('body');\n      } else {\n        var hasBody = contains$2(rowTypes, 'body');\n        if (hasHeader && !hasBody && !hasFooter) {\n          return Optional.some('header');\n        } else if (!hasHeader && !hasBody && hasFooter) {\n          return Optional.some('footer');\n        } else {\n          return Optional.none();\n        }\n      }\n    };\n    var findTableRowHeaderType = function (warehouse) {\n      return findMap(warehouse.all, function (row) {\n        var rowType = getRowType$1(row);\n        return rowType.type === 'header' ? Optional.from(rowType.subType) : Optional.none();\n      });\n    };\n\n    var transformCell = function (cell, comparator, substitution) {\n      return elementnew(substitution(cell.element, comparator), true, cell.isLocked);\n    };\n    var transformRow = function (row, section) {\n      return row.section !== section ? rowcells(row.element, row.cells, section, row.isNew) : row;\n    };\n    var section = function () {\n      return {\n        transformRow: transformRow,\n        transformCell: function (cell, comparator, substitution) {\n          var newCell = substitution(cell.element, comparator);\n          var fixedCell = name(newCell) !== 'td' ? mutate$1(newCell, 'td') : newCell;\n          return elementnew(fixedCell, cell.isNew, cell.isLocked);\n        }\n      };\n    };\n    var sectionCells = function () {\n      return {\n        transformRow: transformRow,\n        transformCell: transformCell\n      };\n    };\n    var cells = function () {\n      return {\n        transformRow: function (row, section) {\n          var newSection = section === 'thead' ? 'tbody' : section;\n          return transformRow(row, newSection);\n        },\n        transformCell: transformCell\n      };\n    };\n    var fallback = function () {\n      return {\n        transformRow: identity,\n        transformCell: transformCell\n      };\n    };\n    var getTableSectionType = function (table, fallback) {\n      var warehouse = Warehouse.fromTable(table);\n      var type = findTableRowHeaderType(warehouse).getOr(fallback);\n      switch (type) {\n      case 'section':\n        return section();\n      case 'sectionCells':\n        return sectionCells();\n      case 'cells':\n        return cells();\n      }\n    };\n    var TableSection = {\n      getTableSectionType: getTableSectionType,\n      section: section,\n      sectionCells: sectionCells,\n      cells: cells,\n      fallback: fallback\n    };\n\n    var setIfNot = function (element, property, value, ignore) {\n      if (value === ignore) {\n        remove$7(element, property);\n      } else {\n        set$2(element, property, value);\n      }\n    };\n    var insert$1 = function (table, selector, element) {\n      last$2(children$1(table, selector)).fold(function () {\n        return prepend(table, element);\n      }, function (child) {\n        return after$5(child, element);\n      });\n    };\n    var generateSection = function (table, sectionName) {\n      var section = child$1(table, sectionName).getOrThunk(function () {\n        var newSection = SugarElement.fromTag(sectionName, owner(table).dom);\n        if (sectionName === 'thead') {\n          insert$1(table, 'caption,colgroup', newSection);\n        } else if (sectionName === 'colgroup') {\n          insert$1(table, 'caption', newSection);\n        } else {\n          append$1(table, newSection);\n        }\n        return newSection;\n      });\n      empty(section);\n      return section;\n    };\n    var render$1 = function (table, grid) {\n      var newRows = [];\n      var newCells = [];\n      var syncRows = function (gridSection) {\n        return map$1(gridSection, function (row) {\n          if (row.isNew) {\n            newRows.push(row.element);\n          }\n          var tr = row.element;\n          empty(tr);\n          each$2(row.cells, function (cell) {\n            if (cell.isNew) {\n              newCells.push(cell.element);\n            }\n            setIfNot(cell.element, 'colspan', cell.colspan, 1);\n            setIfNot(cell.element, 'rowspan', cell.rowspan, 1);\n            append$1(tr, cell.element);\n          });\n          return tr;\n        });\n      };\n      var syncColGroup = function (gridSection) {\n        return bind$2(gridSection, function (colGroup) {\n          return map$1(colGroup.cells, function (col) {\n            setIfNot(col.element, 'span', col.colspan, 1);\n            return col.element;\n          });\n        });\n      };\n      var renderSection = function (gridSection, sectionName) {\n        var section = generateSection(table, sectionName);\n        var sync = sectionName === 'colgroup' ? syncColGroup : syncRows;\n        var sectionElems = sync(gridSection);\n        append(section, sectionElems);\n      };\n      var removeSection = function (sectionName) {\n        child$1(table, sectionName).each(remove$5);\n      };\n      var renderOrRemoveSection = function (gridSection, sectionName) {\n        if (gridSection.length > 0) {\n          renderSection(gridSection, sectionName);\n        } else {\n          removeSection(sectionName);\n        }\n      };\n      var headSection = [];\n      var bodySection = [];\n      var footSection = [];\n      var columnGroupsSection = [];\n      each$2(grid, function (row) {\n        switch (row.section) {\n        case 'thead':\n          headSection.push(row);\n          break;\n        case 'tbody':\n          bodySection.push(row);\n          break;\n        case 'tfoot':\n          footSection.push(row);\n          break;\n        case 'colgroup':\n          columnGroupsSection.push(row);\n          break;\n        }\n      });\n      renderOrRemoveSection(columnGroupsSection, 'colgroup');\n      renderOrRemoveSection(headSection, 'thead');\n      renderOrRemoveSection(bodySection, 'tbody');\n      renderOrRemoveSection(footSection, 'tfoot');\n      return {\n        newRows: newRows,\n        newCells: newCells\n      };\n    };\n    var copy = function (grid) {\n      return map$1(grid, function (row) {\n        var tr = shallow(row.element);\n        each$2(row.cells, function (cell) {\n          var clonedCell = deep(cell.element);\n          setIfNot(clonedCell, 'colspan', cell.colspan, 1);\n          setIfNot(clonedCell, 'rowspan', cell.rowspan, 1);\n          append$1(tr, clonedCell);\n        });\n        return tr;\n      });\n    };\n\n    var getColumn = function (grid, index) {\n      return map$1(grid, function (row) {\n        return getCell(row, index);\n      });\n    };\n    var getRow = function (grid, index) {\n      return grid[index];\n    };\n    var findDiff = function (xs, comp) {\n      if (xs.length === 0) {\n        return 0;\n      }\n      var first = xs[0];\n      var index = findIndex(xs, function (x) {\n        return !comp(first.element, x.element);\n      });\n      return index.getOr(xs.length);\n    };\n    var subgrid = function (grid, row, column, comparator) {\n      var gridRow = getRow(grid, row);\n      var isColRow = gridRow.section === 'colgroup';\n      var colspan = findDiff(gridRow.cells.slice(column), comparator);\n      var rowspan = isColRow ? 1 : findDiff(getColumn(grid.slice(row), column), comparator);\n      return {\n        colspan: colspan,\n        rowspan: rowspan\n      };\n    };\n\n    var toDetails = function (grid, comparator) {\n      var seen = map$1(grid, function (row) {\n        return map$1(row.cells, never);\n      });\n      var updateSeen = function (rowIndex, columnIndex, rowspan, colspan) {\n        for (var row = rowIndex; row < rowIndex + rowspan; row++) {\n          for (var column = columnIndex; column < columnIndex + colspan; column++) {\n            seen[row][column] = true;\n          }\n        }\n      };\n      return map$1(grid, function (row, rowIndex) {\n        var details = bind$2(row.cells, function (cell, columnIndex) {\n          if (seen[rowIndex][columnIndex] === false) {\n            var result = subgrid(grid, rowIndex, columnIndex, comparator);\n            updateSeen(rowIndex, columnIndex, result.rowspan, result.colspan);\n            return [detailnew(cell.element, result.rowspan, result.colspan, cell.isNew)];\n          } else {\n            return [];\n          }\n        });\n        return rowdetailnew(row.element, details, row.section, row.isNew);\n      });\n    };\n    var toGrid = function (warehouse, generators, isNew) {\n      var grid = [];\n      each$2(warehouse.colgroups, function (colgroup) {\n        var colgroupCols = [];\n        for (var columnIndex = 0; columnIndex < warehouse.grid.columns; columnIndex++) {\n          var element = Warehouse.getColumnAt(warehouse, columnIndex).map(function (column) {\n            return elementnew(column.element, isNew, false);\n          }).getOrThunk(function () {\n            return elementnew(generators.colGap(), true, false);\n          });\n          colgroupCols.push(element);\n        }\n        grid.push(rowcells(colgroup.element, colgroupCols, 'colgroup', isNew));\n      });\n      for (var rowIndex = 0; rowIndex < warehouse.grid.rows; rowIndex++) {\n        var rowCells = [];\n        for (var columnIndex = 0; columnIndex < warehouse.grid.columns; columnIndex++) {\n          var element = Warehouse.getAt(warehouse, rowIndex, columnIndex).map(function (item) {\n            return elementnew(item.element, isNew, item.isLocked);\n          }).getOrThunk(function () {\n            return elementnew(generators.gap(), true, false);\n          });\n          rowCells.push(element);\n        }\n        var rowDetail = warehouse.all[rowIndex];\n        var row = rowcells(rowDetail.element, rowCells, rowDetail.section, isNew);\n        grid.push(row);\n      }\n      return grid;\n    };\n\n    var fromWarehouse = function (warehouse, generators) {\n      return toGrid(warehouse, generators, false);\n    };\n    var toDetailList = function (grid) {\n      return toDetails(grid, eq$1);\n    };\n    var findInWarehouse = function (warehouse, element) {\n      return findMap(warehouse.all, function (r) {\n        return find$1(r.cells, function (e) {\n          return eq$1(element, e.element);\n        });\n      });\n    };\n    var extractCells = function (warehouse, target, predicate) {\n      var details = map$1(target.selection, function (cell$1) {\n        return cell(cell$1).bind(function (lc) {\n          return findInWarehouse(warehouse, lc);\n        }).filter(predicate);\n      });\n      var cells = cat(details);\n      return someIf(cells.length > 0, cells);\n    };\n    var run = function (operation, extract, adjustment, postAction, genWrappers) {\n      return function (wire, table, target, generators, behaviours) {\n        var warehouse = Warehouse.fromTable(table);\n        var tableSection = Optional.from(behaviours === null || behaviours === void 0 ? void 0 : behaviours.section).getOrThunk(TableSection.fallback);\n        var output = extract(warehouse, target).map(function (info) {\n          var model = fromWarehouse(warehouse, generators);\n          var result = operation(model, info, eq$1, genWrappers(generators), tableSection);\n          var lockedColumns = getLockedColumnsFromGrid(result.grid);\n          var grid = toDetailList(result.grid);\n          return {\n            info: info,\n            grid: grid,\n            cursor: result.cursor,\n            lockedColumns: lockedColumns\n          };\n        });\n        return output.bind(function (out) {\n          var newElements = render$1(table, out.grid);\n          var tableSizing = Optional.from(behaviours === null || behaviours === void 0 ? void 0 : behaviours.sizing).getOrThunk(function () {\n            return TableSize.getTableSize(table);\n          });\n          var resizing = Optional.from(behaviours === null || behaviours === void 0 ? void 0 : behaviours.resize).getOrThunk(preserveTable);\n          adjustment(table, out.grid, out.info, {\n            sizing: tableSizing,\n            resize: resizing,\n            section: tableSection\n          });\n          postAction(table);\n          refresh(wire, table);\n          remove$7(table, LOCKED_COL_ATTR);\n          if (out.lockedColumns.length > 0) {\n            set$2(table, LOCKED_COL_ATTR, out.lockedColumns.join(','));\n          }\n          return Optional.some({\n            cursor: out.cursor,\n            newRows: newElements.newRows,\n            newCells: newElements.newCells\n          });\n        });\n      };\n    };\n    var onPaste = function (warehouse, target) {\n      return cell(target.element).bind(function (cell) {\n        return findInWarehouse(warehouse, cell).map(function (details) {\n          var value = __assign(__assign({}, details), {\n            generators: target.generators,\n            clipboard: target.clipboard\n          });\n          return value;\n        });\n      });\n    };\n    var onPasteByEditor = function (warehouse, target) {\n      return extractCells(warehouse, target, always).map(function (cells) {\n        return {\n          cells: cells,\n          generators: target.generators,\n          clipboard: target.clipboard\n        };\n      });\n    };\n    var onMergable = function (_warehouse, target) {\n      return target.mergable;\n    };\n    var onUnmergable = function (_warehouse, target) {\n      return target.unmergable;\n    };\n    var onCells = function (warehouse, target) {\n      return extractCells(warehouse, target, always);\n    };\n    var onUnlockedCells = function (warehouse, target) {\n      return extractCells(warehouse, target, function (detail) {\n        return !detail.isLocked;\n      });\n    };\n    var isUnlockedTableCell = function (warehouse, cell) {\n      return findInWarehouse(warehouse, cell).exists(function (detail) {\n        return !detail.isLocked;\n      });\n    };\n    var allUnlocked = function (warehouse, cells) {\n      return forall(cells, function (cell) {\n        return isUnlockedTableCell(warehouse, cell);\n      });\n    };\n    var onUnlockedMergable = function (warehouse, target) {\n      return onMergable(warehouse, target).filter(function (mergeable) {\n        return allUnlocked(warehouse, mergeable.cells);\n      });\n    };\n    var onUnlockedUnmergable = function (warehouse, target) {\n      return onUnmergable(warehouse, target).filter(function (cells) {\n        return allUnlocked(warehouse, cells);\n      });\n    };\n\n    var merge$2 = function (grid, bounds, comparator, substitution) {\n      var rows = extractGridDetails(grid).rows;\n      if (rows.length === 0) {\n        return grid;\n      }\n      for (var i = bounds.startRow; i <= bounds.finishRow; i++) {\n        for (var j = bounds.startCol; j <= bounds.finishCol; j++) {\n          var row = rows[i];\n          var isLocked = getCell(row, j).isLocked;\n          mutateCell(row, j, elementnew(substitution(), false, isLocked));\n        }\n      }\n      return grid;\n    };\n    var unmerge = function (grid, target, comparator, substitution) {\n      var rows = extractGridDetails(grid).rows;\n      var first = true;\n      for (var i = 0; i < rows.length; i++) {\n        for (var j = 0; j < cellLength(rows[0]); j++) {\n          var row = rows[i];\n          var currentCell = getCell(row, j);\n          var currentCellElm = currentCell.element;\n          var isToReplace = comparator(currentCellElm, target);\n          if (isToReplace === true && first === false) {\n            mutateCell(row, j, elementnew(substitution(), true, currentCell.isLocked));\n          } else if (isToReplace === true) {\n            first = false;\n          }\n        }\n      }\n      return grid;\n    };\n    var uniqueCells = function (row, comparator) {\n      return foldl(row, function (rest, cell) {\n        return exists(rest, function (currentCell) {\n          return comparator(currentCell.element, cell.element);\n        }) ? rest : rest.concat([cell]);\n      }, []);\n    };\n    var splitCols = function (grid, index, comparator, substitution) {\n      if (index > 0 && index < grid[0].cells.length) {\n        each$2(grid, function (row) {\n          var prevCell = row.cells[index - 1];\n          var current = row.cells[index];\n          var isToReplace = comparator(current.element, prevCell.element);\n          if (isToReplace) {\n            mutateCell(row, index, elementnew(substitution(), true, current.isLocked));\n          }\n        });\n      }\n      return grid;\n    };\n    var splitRows = function (grid, index, comparator, substitution) {\n      var rows = extractGridDetails(grid).rows;\n      if (index > 0 && index < rows.length) {\n        var rowPrevCells = rows[index - 1].cells;\n        var cells = uniqueCells(rowPrevCells, comparator);\n        each$2(cells, function (cell) {\n          var replacement = Optional.none();\n          for (var i = index; i < rows.length; i++) {\n            var _loop_1 = function (j) {\n              var row = rows[i];\n              var current = getCell(row, j);\n              var isToReplace = comparator(current.element, cell.element);\n              if (isToReplace) {\n                if (replacement.isNone()) {\n                  replacement = Optional.some(substitution());\n                }\n                replacement.each(function (sub) {\n                  mutateCell(row, j, elementnew(sub, true, current.isLocked));\n                });\n              }\n            };\n            for (var j = 0; j < cellLength(rows[0]); j++) {\n              _loop_1(j);\n            }\n          }\n        });\n      }\n      return grid;\n    };\n\n    var value$1 = function (o) {\n      var or = function (_opt) {\n        return value$1(o);\n      };\n      var orThunk = function (_f) {\n        return value$1(o);\n      };\n      var map = function (f) {\n        return value$1(f(o));\n      };\n      var mapError = function (_f) {\n        return value$1(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOptional = function () {\n        return Optional.some(o);\n      };\n      return {\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOptional: toOptional\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = identity;\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (_f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (_f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOptional: Optional.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value$1);\n    };\n    var Result = {\n      value: value$1,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var measure = function (startAddress, gridA, gridB) {\n      if (startAddress.row >= gridA.length || startAddress.column > cellLength(gridA[0])) {\n        return Result.error('invalid start address out of table bounds, row: ' + startAddress.row + ', column: ' + startAddress.column);\n      }\n      var rowRemainder = gridA.slice(startAddress.row);\n      var colRemainder = rowRemainder[0].cells.slice(startAddress.column);\n      var colRequired = cellLength(gridB[0]);\n      var rowRequired = gridB.length;\n      return Result.value({\n        rowDelta: rowRemainder.length - rowRequired,\n        colDelta: colRemainder.length - colRequired\n      });\n    };\n    var measureWidth = function (gridA, gridB) {\n      var colLengthA = cellLength(gridA[0]);\n      var colLengthB = cellLength(gridB[0]);\n      return {\n        rowDelta: 0,\n        colDelta: colLengthA - colLengthB\n      };\n    };\n    var measureHeight = function (gridA, gridB) {\n      var rowLengthA = gridA.length;\n      var rowLengthB = gridB.length;\n      return {\n        rowDelta: rowLengthA - rowLengthB,\n        colDelta: 0\n      };\n    };\n    var generateElements = function (amount, row, generators, isLocked) {\n      var generator = row.section === 'colgroup' ? generators.col : generators.cell;\n      return range$1(amount, function (idx) {\n        return elementnew(generator(), true, isLocked(idx));\n      });\n    };\n    var rowFill = function (grid, amount, generators, lockedColumns) {\n      var exampleRow = grid[grid.length - 1];\n      return grid.concat(range$1(amount, function () {\n        var generator = exampleRow.section === 'colgroup' ? generators.colgroup : generators.row;\n        var row = clone$1(exampleRow, generator, identity);\n        var elements = generateElements(row.cells.length, row, generators, function (idx) {\n          return has$1(lockedColumns, idx.toString());\n        });\n        return setCells(row, elements);\n      }));\n    };\n    var colFill = function (grid, amount, generators, startIndex) {\n      return map$1(grid, function (row) {\n        var newChildren = generateElements(amount, row, generators, never);\n        return addCells(row, startIndex, newChildren);\n      });\n    };\n    var lockedColFill = function (grid, generators, lockedColumns) {\n      return map$1(grid, function (row) {\n        return foldl(lockedColumns, function (acc, colNum) {\n          var newChild = generateElements(1, row, generators, always)[0];\n          return addCell(acc, colNum, newChild);\n        }, row);\n      });\n    };\n    var tailor = function (gridA, delta, generators) {\n      var fillCols = delta.colDelta < 0 ? colFill : identity;\n      var fillRows = delta.rowDelta < 0 ? rowFill : identity;\n      var lockedColumns = getLockedColumnsFromGrid(gridA);\n      var gridWidth = cellLength(gridA[0]);\n      var isLastColLocked = exists(lockedColumns, function (locked) {\n        return locked === gridWidth - 1;\n      });\n      var modifiedCols = fillCols(gridA, Math.abs(delta.colDelta), generators, isLastColLocked ? gridWidth - 1 : gridWidth);\n      var newLockedColumns = getLockedColumnsFromGrid(modifiedCols);\n      return fillRows(modifiedCols, Math.abs(delta.rowDelta), generators, mapToObject(newLockedColumns, always));\n    };\n\n    var isSpanning = function (grid, row, col, comparator) {\n      var candidate = getCell(grid[row], col);\n      var matching = curry(comparator, candidate.element);\n      var currentRow = grid[row];\n      return grid.length > 1 && cellLength(currentRow) > 1 && (col > 0 && matching(getCellElement(currentRow, col - 1)) || col < currentRow.cells.length - 1 && matching(getCellElement(currentRow, col + 1)) || row > 0 && matching(getCellElement(grid[row - 1], col)) || row < grid.length - 1 && matching(getCellElement(grid[row + 1], col)));\n    };\n    var mergeTables = function (startAddress, gridA, gridB, generator, comparator, lockedColumns) {\n      var startRow = startAddress.row;\n      var startCol = startAddress.column;\n      var mergeHeight = gridB.length;\n      var mergeWidth = cellLength(gridB[0]);\n      var endRow = startRow + mergeHeight;\n      var endCol = startCol + mergeWidth + lockedColumns.length;\n      var lockedColumnObj = mapToObject(lockedColumns, always);\n      for (var r = startRow; r < endRow; r++) {\n        var skippedCol = 0;\n        for (var c = startCol; c < endCol; c++) {\n          if (lockedColumnObj[c]) {\n            skippedCol++;\n            continue;\n          }\n          if (isSpanning(gridA, r, c, comparator)) {\n            unmerge(gridA, getCellElement(gridA[r], c), comparator, generator.cell);\n          }\n          var gridBColIndex = c - startCol - skippedCol;\n          var newCell = getCell(gridB[r - startRow], gridBColIndex);\n          var newCellElm = newCell.element;\n          var replacement = generator.replace(newCellElm);\n          mutateCell(gridA[r], c, elementnew(replacement, true, newCell.isLocked));\n        }\n      }\n      return gridA;\n    };\n    var getValidStartAddress = function (currentStartAddress, grid, lockedColumns) {\n      var gridColLength = cellLength(grid[0]);\n      var adjustedRowAddress = extractGridDetails(grid).cols.length + currentStartAddress.row;\n      var possibleColAddresses = range$1(gridColLength - currentStartAddress.column, function (num) {\n        return num + currentStartAddress.column;\n      });\n      var validColAddress = find$1(possibleColAddresses, function (num) {\n        return forall(lockedColumns, function (col) {\n          return col !== num;\n        });\n      }).getOr(gridColLength - 1);\n      return {\n        row: adjustedRowAddress,\n        column: validColAddress\n      };\n    };\n    var getLockedColumnsWithinBounds = function (startAddress, grid, lockedColumns) {\n      return filter$2(lockedColumns, function (colNum) {\n        return colNum >= startAddress.column && colNum <= cellLength(grid[0]) + startAddress.column;\n      });\n    };\n    var merge$1 = function (startAddress, gridA, gridB, generator, comparator) {\n      var lockedColumns = getLockedColumnsFromGrid(gridA);\n      var validStartAddress = getValidStartAddress(startAddress, gridA, lockedColumns);\n      var gridBRows = extractGridDetails(gridB).rows;\n      var lockedColumnsWithinBounds = getLockedColumnsWithinBounds(validStartAddress, gridBRows, lockedColumns);\n      var result = measure(validStartAddress, gridA, gridBRows);\n      return result.map(function (diff) {\n        var delta = __assign(__assign({}, diff), { colDelta: diff.colDelta - lockedColumnsWithinBounds.length });\n        var fittedGrid = tailor(gridA, delta, generator);\n        var newLockedColumns = getLockedColumnsFromGrid(fittedGrid);\n        var newLockedColumnsWithinBounds = getLockedColumnsWithinBounds(validStartAddress, gridBRows, newLockedColumns);\n        return mergeTables(validStartAddress, fittedGrid, gridBRows, generator, comparator, newLockedColumnsWithinBounds);\n      });\n    };\n    var insertCols = function (index, gridA, gridB, generator, comparator) {\n      splitCols(gridA, index, comparator, generator.cell);\n      var delta = measureHeight(gridB, gridA);\n      var fittedNewGrid = tailor(gridB, delta, generator);\n      var secondDelta = measureHeight(gridA, fittedNewGrid);\n      var fittedOldGrid = tailor(gridA, secondDelta, generator);\n      return map$1(fittedOldGrid, function (gridRow, i) {\n        return addCells(gridRow, index, fittedNewGrid[i].cells);\n      });\n    };\n    var insertRows = function (index, gridA, gridB, generator, comparator) {\n      splitRows(gridA, index, comparator, generator.cell);\n      var locked = getLockedColumnsFromGrid(gridA);\n      var diff = measureWidth(gridA, gridB);\n      var delta = __assign(__assign({}, diff), { colDelta: diff.colDelta - locked.length });\n      var fittedOldGrid = tailor(gridA, delta, generator);\n      var _a = extractGridDetails(fittedOldGrid), oldCols = _a.cols, oldRows = _a.rows;\n      var newLocked = getLockedColumnsFromGrid(fittedOldGrid);\n      var secondDiff = measureWidth(gridB, gridA);\n      var secondDelta = __assign(__assign({}, secondDiff), { colDelta: secondDiff.colDelta + newLocked.length });\n      var fittedGridB = lockedColFill(gridB, generator, newLocked);\n      var fittedNewGrid = tailor(fittedGridB, secondDelta, generator);\n      return oldCols.concat(oldRows.slice(0, index)).concat(fittedNewGrid).concat(oldRows.slice(index, oldRows.length));\n    };\n\n    var cloneRow = function (row, cloneCell, comparator, substitution) {\n      return clone$1(row, function (elem) {\n        return substitution(elem, comparator);\n      }, cloneCell);\n    };\n    var insertRowAt = function (grid, index, example, comparator, substitution) {\n      var _a = extractGridDetails(grid), rows = _a.rows, cols = _a.cols;\n      var before = rows.slice(0, index);\n      var after = rows.slice(index);\n      var newRow = cloneRow(rows[example], function (ex, c) {\n        var withinSpan = index > 0 && index < rows.length && comparator(getCellElement(rows[index - 1], c), getCellElement(rows[index], c));\n        var ret = withinSpan ? getCell(rows[index], c) : elementnew(substitution(ex.element, comparator), true, ex.isLocked);\n        return ret;\n      }, comparator, substitution);\n      return cols.concat(before).concat([newRow]).concat(after);\n    };\n    var getElementFor = function (row, column, section, withinSpan, example, comparator, substitution) {\n      if (section === 'colgroup' || !withinSpan) {\n        var cell = getCell(row, example);\n        return elementnew(substitution(cell.element, comparator), true, false);\n      } else {\n        return getCell(row, column);\n      }\n    };\n    var insertColumnAt = function (grid, index, example, comparator, substitution) {\n      return map$1(grid, function (row) {\n        var withinSpan = index > 0 && index < cellLength(row) && comparator(getCellElement(row, index - 1), getCellElement(row, index));\n        var sub = getElementFor(row, index, row.section, withinSpan, example, comparator, substitution);\n        return addCell(row, index, sub);\n      });\n    };\n    var deleteColumnsAt = function (grid, columns) {\n      return bind$2(grid, function (row) {\n        var existingCells = row.cells;\n        var cells = foldr(columns, function (acc, column) {\n          return column >= 0 && column < acc.length ? acc.slice(0, column).concat(acc.slice(column + 1)) : acc;\n        }, existingCells);\n        return cells.length > 0 ? [rowcells(row.element, cells, row.section, row.isNew)] : [];\n      });\n    };\n    var deleteRowsAt = function (grid, start, finish) {\n      var _a = extractGridDetails(grid), rows = _a.rows, cols = _a.cols;\n      return cols.concat(rows.slice(0, start)).concat(rows.slice(finish + 1));\n    };\n\n    var notInStartRow = function (grid, rowIndex, colIndex, comparator) {\n      return getCellElement(grid[rowIndex], colIndex) !== undefined && (rowIndex > 0 && comparator(getCellElement(grid[rowIndex - 1], colIndex), getCellElement(grid[rowIndex], colIndex)));\n    };\n    var notInStartColumn = function (row, index, comparator) {\n      return index > 0 && comparator(getCellElement(row, index - 1), getCellElement(row, index));\n    };\n    var isDuplicatedCell = function (grid, rowIndex, colIndex, comparator) {\n      return notInStartRow(grid, rowIndex, colIndex, comparator) || notInStartColumn(grid[rowIndex], colIndex, comparator);\n    };\n    var rowReplacerPredicate = function (targetRow, columnHeaders) {\n      var entireTableIsHeader = forall(columnHeaders, identity) && isHeaderCells(targetRow.cells);\n      return entireTableIsHeader ? always : function (cell, _rowIndex, colIndex) {\n        var type = name(cell.element);\n        return !(type === 'th' && columnHeaders[colIndex]);\n      };\n    };\n    var columnReplacePredicate = function (targetColumn, rowHeaders) {\n      var entireTableIsHeader = forall(rowHeaders, identity) && isHeaderCells(targetColumn);\n      return entireTableIsHeader ? always : function (cell, rowIndex, _colIndex) {\n        var type = name(cell.element);\n        return !(type === 'th' && rowHeaders[rowIndex]);\n      };\n    };\n    var determineScope = function (applyScope, element, newScope, isInHeader) {\n      var hasSpan = function (scope) {\n        return scope === 'row' ? hasRowspan(element) : hasColspan(element);\n      };\n      var getScope = function (scope) {\n        return hasSpan(scope) ? scope + 'group' : scope;\n      };\n      if (applyScope) {\n        return isHeaderCell(element) ? getScope(newScope) : null;\n      } else if (isInHeader && isHeaderCell(element)) {\n        var oppositeScope = newScope === 'row' ? 'col' : 'row';\n        return getScope(oppositeScope);\n      } else {\n        return null;\n      }\n    };\n    var rowScopeGenerator = function (applyScope, columnHeaders) {\n      return function (cell, rowIndex, columnIndex) {\n        return Optional.some(determineScope(applyScope, cell.element, 'col', columnHeaders[columnIndex]));\n      };\n    };\n    var columnScopeGenerator = function (applyScope, rowHeaders) {\n      return function (cell, rowIndex) {\n        return Optional.some(determineScope(applyScope, cell.element, 'row', rowHeaders[rowIndex]));\n      };\n    };\n    var replace = function (cell, comparator, substitute) {\n      return elementnew(substitute(cell.element, comparator), true, cell.isLocked);\n    };\n    var replaceIn = function (grid, targets, comparator, substitute, replacer, genScope, shouldReplace) {\n      var isTarget = function (cell) {\n        return exists(targets, function (target) {\n          return comparator(cell.element, target.element);\n        });\n      };\n      return map$1(grid, function (row, rowIndex) {\n        return mapCells(row, function (cell, colIndex) {\n          if (isTarget(cell)) {\n            var newCell_1 = shouldReplace(cell, rowIndex, colIndex) ? replacer(cell, comparator, substitute) : cell;\n            genScope(newCell_1, rowIndex, colIndex).each(function (scope) {\n              setOptions(newCell_1.element, { scope: Optional.from(scope) });\n            });\n            return newCell_1;\n          } else {\n            return cell;\n          }\n        });\n      });\n    };\n    var getColumnCells = function (rows, columnIndex, comparator) {\n      return bind$2(rows, function (row, i) {\n        return isDuplicatedCell(rows, i, columnIndex, comparator) ? [] : [getCell(row, columnIndex)];\n      });\n    };\n    var getRowCells = function (rows, rowIndex, comparator) {\n      var targetRow = rows[rowIndex];\n      return bind$2(targetRow.cells, function (item, i) {\n        return isDuplicatedCell(rows, rowIndex, i, comparator) ? [] : [item];\n      });\n    };\n    var replaceColumns = function (grid, indexes, applyScope, comparator, substitution) {\n      var rows = extractGridDetails(grid).rows;\n      var targets = bind$2(indexes, function (index) {\n        return getColumnCells(rows, index, comparator);\n      });\n      var rowHeaders = map$1(grid, function (row) {\n        return isHeaderCells(row.cells);\n      });\n      var shouldReplaceCell = columnReplacePredicate(targets, rowHeaders);\n      var scopeGenerator = columnScopeGenerator(applyScope, rowHeaders);\n      return replaceIn(grid, targets, comparator, substitution, replace, scopeGenerator, shouldReplaceCell);\n    };\n    var replaceRows = function (grid, indexes, section, applyScope, comparator, substitution, tableSection) {\n      var _a = extractGridDetails(grid), cols = _a.cols, rows = _a.rows;\n      var targetRow = rows[indexes[0]];\n      var targets = bind$2(indexes, function (index) {\n        return getRowCells(rows, index, comparator);\n      });\n      var columnHeaders = map$1(targetRow.cells, function (_cell, index) {\n        return isHeaderCells(getColumnCells(rows, index, comparator));\n      });\n      var newRows = __spreadArray([], rows, true);\n      each$2(indexes, function (index) {\n        newRows[index] = tableSection.transformRow(rows[index], section);\n      });\n      var newGrid = cols.concat(newRows);\n      var shouldReplaceCell = rowReplacerPredicate(targetRow, columnHeaders);\n      var scopeGenerator = rowScopeGenerator(applyScope, columnHeaders);\n      return replaceIn(newGrid, targets, comparator, substitution, tableSection.transformCell, scopeGenerator, shouldReplaceCell);\n    };\n    var replaceCells = function (grid, details, comparator, substitution) {\n      var rows = extractGridDetails(grid).rows;\n      var targetCells = map$1(details, function (detail) {\n        return getCell(rows[detail.row], detail.column);\n      });\n      return replaceIn(grid, targetCells, comparator, substitution, replace, Optional.none, always);\n    };\n\n    var uniqueColumns = function (details) {\n      var uniqueCheck = function (rest, detail) {\n        var columnExists = exists(rest, function (currentDetail) {\n          return currentDetail.column === detail.column;\n        });\n        return columnExists ? rest : rest.concat([detail]);\n      };\n      return foldl(details, uniqueCheck, []).sort(function (detailA, detailB) {\n        return detailA.column - detailB.column;\n      });\n    };\n\n    var isCol = isTag('col');\n    var isColgroup = isTag('colgroup');\n    var isRow$1 = function (element) {\n      return name(element) === 'tr' || isColgroup(element);\n    };\n    var elementToData = function (element) {\n      var colspan = getAttrValue(element, 'colspan', 1);\n      var rowspan = getAttrValue(element, 'rowspan', 1);\n      return {\n        element: element,\n        colspan: colspan,\n        rowspan: rowspan\n      };\n    };\n    var modification = function (generators, toData) {\n      if (toData === void 0) {\n        toData = elementToData;\n      }\n      var nuCell = function (data) {\n        return isCol(data.element) ? generators.col(data) : generators.cell(data);\n      };\n      var nuRow = function (data) {\n        return isColgroup(data.element) ? generators.colgroup(data) : generators.row(data);\n      };\n      var add = function (element) {\n        if (isRow$1(element)) {\n          return nuRow({ element: element });\n        } else {\n          var replacement = nuCell(toData(element));\n          recent = Optional.some({\n            item: element,\n            replacement: replacement\n          });\n          return replacement;\n        }\n      };\n      var recent = Optional.none();\n      var getOrInit = function (element, comparator) {\n        return recent.fold(function () {\n          return add(element);\n        }, function (p) {\n          return comparator(element, p.item) ? p.replacement : add(element);\n        });\n      };\n      return { getOrInit: getOrInit };\n    };\n    var transform = function (tag) {\n      return function (generators) {\n        var list = [];\n        var find = function (element, comparator) {\n          return find$1(list, function (x) {\n            return comparator(x.item, element);\n          });\n        };\n        var makeNew = function (element) {\n          var attrs = tag === 'td' ? { scope: null } : {};\n          var cell = generators.replace(element, tag, attrs);\n          list.push({\n            item: element,\n            sub: cell\n          });\n          return cell;\n        };\n        var replaceOrInit = function (element, comparator) {\n          if (isRow$1(element) || isCol(element)) {\n            return element;\n          } else {\n            return find(element, comparator).fold(function () {\n              return makeNew(element);\n            }, function (p) {\n              return comparator(element, p.item) ? p.sub : makeNew(element);\n            });\n          }\n        };\n        return { replaceOrInit: replaceOrInit };\n      };\n    };\n    var getScopeAttribute = function (cell) {\n      return getOpt(cell, 'scope').map(function (attribute) {\n        return attribute.substr(0, 3);\n      });\n    };\n    var merging = function (generators) {\n      var unmerge = function (cell) {\n        var scope = getScopeAttribute(cell);\n        scope.each(function (attribute) {\n          return set$2(cell, 'scope', attribute);\n        });\n        return function () {\n          var raw = generators.cell({\n            element: cell,\n            colspan: 1,\n            rowspan: 1\n          });\n          remove$6(raw, 'width');\n          remove$6(cell, 'width');\n          scope.each(function (attribute) {\n            return set$2(raw, 'scope', attribute);\n          });\n          return raw;\n        };\n      };\n      var merge = function (cells) {\n        var getScopeProperty = function () {\n          var stringAttributes = cat(map$1(cells, getScopeAttribute));\n          if (stringAttributes.length === 0) {\n            return Optional.none();\n          } else {\n            var baseScope_1 = stringAttributes[0];\n            var scopes_1 = [\n              'row',\n              'col'\n            ];\n            var isMixed = exists(stringAttributes, function (attribute) {\n              return attribute !== baseScope_1 && contains$2(scopes_1, attribute);\n            });\n            return isMixed ? Optional.none() : Optional.from(baseScope_1);\n          }\n        };\n        remove$6(cells[0], 'width');\n        getScopeProperty().fold(function () {\n          return remove$7(cells[0], 'scope');\n        }, function (attribute) {\n          return set$2(cells[0], 'scope', attribute + 'group');\n        });\n        return constant(cells[0]);\n      };\n      return {\n        unmerge: unmerge,\n        merge: merge\n      };\n    };\n    var Generators = {\n      modification: modification,\n      transform: transform,\n      merging: merging\n    };\n\n    var blockList = [\n      'body',\n      'p',\n      'div',\n      'article',\n      'aside',\n      'figcaption',\n      'figure',\n      'footer',\n      'header',\n      'nav',\n      'section',\n      'ol',\n      'ul',\n      'table',\n      'thead',\n      'tfoot',\n      'tbody',\n      'caption',\n      'tr',\n      'td',\n      'th',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'blockquote',\n      'pre',\n      'address'\n    ];\n    var isList$1 = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return contains$2([\n        'ol',\n        'ul'\n      ], tagName);\n    };\n    var isBlock$1 = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return contains$2(blockList, tagName);\n    };\n    var isEmptyTag$1 = function (universe, item) {\n      return contains$2([\n        'br',\n        'img',\n        'hr',\n        'input'\n      ], universe.property().name(item));\n    };\n\n    var universe$1 = DomUniverse();\n    var isBlock = function (element) {\n      return isBlock$1(universe$1, element);\n    };\n    var isList = function (element) {\n      return isList$1(universe$1, element);\n    };\n    var isEmptyTag = function (element) {\n      return isEmptyTag$1(universe$1, element);\n    };\n\n    var merge = function (cells) {\n      var isBr = function (el) {\n        return name(el) === 'br';\n      };\n      var advancedBr = function (children) {\n        return forall(children, function (c) {\n          return isBr(c) || isText(c) && get$9(c).trim().length === 0;\n        });\n      };\n      var isListItem = function (el) {\n        return name(el) === 'li' || ancestor$2(el, isList).isSome();\n      };\n      var siblingIsBlock = function (el) {\n        return nextSibling(el).map(function (rightSibling) {\n          if (isBlock(rightSibling)) {\n            return true;\n          }\n          if (isEmptyTag(rightSibling)) {\n            return name(rightSibling) === 'img' ? false : true;\n          }\n          return false;\n        }).getOr(false);\n      };\n      var markCell = function (cell) {\n        return last$1(cell).bind(function (rightEdge) {\n          var rightSiblingIsBlock = siblingIsBlock(rightEdge);\n          return parent(rightEdge).map(function (parent) {\n            return rightSiblingIsBlock === true || isListItem(parent) || isBr(rightEdge) || isBlock(parent) && !eq$1(cell, parent) ? [] : [SugarElement.fromTag('br')];\n          });\n        }).getOr([]);\n      };\n      var markContent = function () {\n        var content = bind$2(cells, function (cell) {\n          var children = children$3(cell);\n          return advancedBr(children) ? [] : children.concat(markCell(cell));\n        });\n        return content.length === 0 ? [SugarElement.fromTag('br')] : content;\n      };\n      var contents = markContent();\n      empty(cells[0]);\n      append(cells[0], contents);\n    };\n\n    var isEditable = function (elem) {\n      return isEditable$1(elem, true);\n    };\n    var prune = function (table) {\n      var cells = cells$1(table);\n      if (cells.length === 0) {\n        remove$5(table);\n      }\n    };\n    var outcome = function (grid, cursor) {\n      return {\n        grid: grid,\n        cursor: cursor\n      };\n    };\n    var findEditableCursorPosition = function (rows) {\n      return findMap(rows, function (row) {\n        return findMap(row.cells, function (cell) {\n          var elem = cell.element;\n          return someIf(isEditable(elem), elem);\n        });\n      });\n    };\n    var elementFromGrid = function (grid, row, column) {\n      var _a, _b;\n      var rows = extractGridDetails(grid).rows;\n      return Optional.from((_b = (_a = rows[row]) === null || _a === void 0 ? void 0 : _a.cells[column]) === null || _b === void 0 ? void 0 : _b.element).filter(isEditable).orThunk(function () {\n        return findEditableCursorPosition(rows);\n      });\n    };\n    var bundle = function (grid, row, column) {\n      var cursorElement = elementFromGrid(grid, row, column);\n      return outcome(grid, cursorElement);\n    };\n    var uniqueRows = function (details) {\n      var rowCompilation = function (rest, detail) {\n        var rowExists = exists(rest, function (currentDetail) {\n          return currentDetail.row === detail.row;\n        });\n        return rowExists ? rest : rest.concat([detail]);\n      };\n      return foldl(details, rowCompilation, []).sort(function (detailA, detailB) {\n        return detailA.row - detailB.row;\n      });\n    };\n    var opInsertRowsBefore = function (grid, details, comparator, genWrappers) {\n      var targetIndex = details[0].row;\n      var rows = uniqueRows(details);\n      var newGrid = foldr(rows, function (acc, row) {\n        var newG = insertRowAt(acc.grid, targetIndex, row.row + acc.delta, comparator, genWrappers.getOrInit);\n        return {\n          grid: newG,\n          delta: acc.delta + 1\n        };\n      }, {\n        grid: grid,\n        delta: 0\n      }).grid;\n      return bundle(newGrid, targetIndex, details[0].column);\n    };\n    var opInsertRowsAfter = function (grid, details, comparator, genWrappers) {\n      var rows = uniqueRows(details);\n      var target = rows[rows.length - 1];\n      var targetIndex = target.row + target.rowspan;\n      var newGrid = foldr(rows, function (newG, row) {\n        return insertRowAt(newG, targetIndex, row.row, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, targetIndex, details[0].column);\n    };\n    var opInsertColumnsBefore = function (grid, extractDetail, comparator, genWrappers) {\n      var details = extractDetail.details;\n      var columns = uniqueColumns(details);\n      var targetIndex = columns[0].column;\n      var newGrid = foldr(columns, function (acc, col) {\n        var newG = insertColumnAt(acc.grid, targetIndex, col.column + acc.delta, comparator, genWrappers.getOrInit);\n        return {\n          grid: newG,\n          delta: acc.delta + 1\n        };\n      }, {\n        grid: grid,\n        delta: 0\n      }).grid;\n      return bundle(newGrid, details[0].row, targetIndex);\n    };\n    var opInsertColumnsAfter = function (grid, extractDetail, comparator, genWrappers) {\n      var details = extractDetail.details;\n      var target = details[details.length - 1];\n      var targetIndex = target.column + target.colspan;\n      var columns = uniqueColumns(details);\n      var newGrid = foldr(columns, function (newG, col) {\n        return insertColumnAt(newG, targetIndex, col.column, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, details[0].row, targetIndex);\n    };\n    var opMakeColumnsHeader = function (initialGrid, details, comparator, genWrappers) {\n      var columns = uniqueColumns(details);\n      var columnIndexes = map$1(columns, function (detail) {\n        return detail.column;\n      });\n      var newGrid = replaceColumns(initialGrid, columnIndexes, true, comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, details[0].row, details[0].column);\n    };\n    var opMakeCellsHeader = function (initialGrid, details, comparator, genWrappers) {\n      var newGrid = replaceCells(initialGrid, details, comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, details[0].row, details[0].column);\n    };\n    var opUnmakeColumnsHeader = function (initialGrid, details, comparator, genWrappers) {\n      var columns = uniqueColumns(details);\n      var columnIndexes = map$1(columns, function (detail) {\n        return detail.column;\n      });\n      var newGrid = replaceColumns(initialGrid, columnIndexes, false, comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, details[0].row, details[0].column);\n    };\n    var opUnmakeCellsHeader = function (initialGrid, details, comparator, genWrappers) {\n      var newGrid = replaceCells(initialGrid, details, comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, details[0].row, details[0].column);\n    };\n    var makeRowsSection = function (section, applyScope) {\n      return function (initialGrid, details, comparator, genWrappers, tableSection) {\n        var rows = uniqueRows(details);\n        var rowIndexes = map$1(rows, function (detail) {\n          return detail.row;\n        });\n        var newGrid = replaceRows(initialGrid, rowIndexes, section, applyScope, comparator, genWrappers.replaceOrInit, tableSection);\n        return bundle(newGrid, details[0].row, details[0].column);\n      };\n    };\n    var opMakeRowsHeader = makeRowsSection('thead', true);\n    var opMakeRowsBody = makeRowsSection('tbody', false);\n    var opMakeRowsFooter = makeRowsSection('tfoot', false);\n    var opEraseColumns = function (grid, extractDetail, _comparator, _genWrappers) {\n      var columns = uniqueColumns(extractDetail.details);\n      var newGrid = deleteColumnsAt(grid, map$1(columns, function (column) {\n        return column.column;\n      }));\n      var maxColIndex = newGrid.length > 0 ? newGrid[0].cells.length - 1 : 0;\n      return bundle(newGrid, columns[0].row, Math.min(columns[0].column, maxColIndex));\n    };\n    var opEraseRows = function (grid, details, _comparator, _genWrappers) {\n      var rows = uniqueRows(details);\n      var newGrid = deleteRowsAt(grid, rows[0].row, rows[rows.length - 1].row);\n      var maxRowIndex = newGrid.length > 0 ? newGrid.length - 1 : 0;\n      return bundle(newGrid, Math.min(details[0].row, maxRowIndex), details[0].column);\n    };\n    var opMergeCells = function (grid, mergable, comparator, genWrappers) {\n      var cells = mergable.cells;\n      merge(cells);\n      var newGrid = merge$2(grid, mergable.bounds, comparator, genWrappers.merge(cells));\n      return outcome(newGrid, Optional.from(cells[0]));\n    };\n    var opUnmergeCells = function (grid, unmergable, comparator, genWrappers) {\n      var unmerge$1 = function (b, cell) {\n        return unmerge(b, cell, comparator, genWrappers.unmerge(cell));\n      };\n      var newGrid = foldr(unmergable, unmerge$1, grid);\n      return outcome(newGrid, Optional.from(unmergable[0]));\n    };\n    var opPasteCells = function (grid, pasteDetails, comparator, _genWrappers) {\n      var gridify = function (table, generators) {\n        var wh = Warehouse.fromTable(table);\n        return toGrid(wh, generators, true);\n      };\n      var gridB = gridify(pasteDetails.clipboard, pasteDetails.generators);\n      var startAddress = address(pasteDetails.row, pasteDetails.column);\n      var mergedGrid = merge$1(startAddress, grid, gridB, pasteDetails.generators, comparator);\n      return mergedGrid.fold(function () {\n        return outcome(grid, Optional.some(pasteDetails.element));\n      }, function (newGrid) {\n        return bundle(newGrid, pasteDetails.row, pasteDetails.column);\n      });\n    };\n    var gridifyRows = function (rows, generators, context) {\n      var pasteDetails = fromPastedRows(rows, context.section);\n      var wh = Warehouse.generate(pasteDetails);\n      return toGrid(wh, generators, true);\n    };\n    var opPasteColsBefore = function (grid, pasteDetails, comparator, _genWrappers) {\n      var rows = extractGridDetails(grid).rows;\n      var index = pasteDetails.cells[0].column;\n      var context = rows[pasteDetails.cells[0].row];\n      var gridB = gridifyRows(pasteDetails.clipboard, pasteDetails.generators, context);\n      var mergedGrid = insertCols(index, grid, gridB, pasteDetails.generators, comparator);\n      return bundle(mergedGrid, pasteDetails.cells[0].row, pasteDetails.cells[0].column);\n    };\n    var opPasteColsAfter = function (grid, pasteDetails, comparator, _genWrappers) {\n      var rows = extractGridDetails(grid).rows;\n      var index = pasteDetails.cells[pasteDetails.cells.length - 1].column + pasteDetails.cells[pasteDetails.cells.length - 1].colspan;\n      var context = rows[pasteDetails.cells[0].row];\n      var gridB = gridifyRows(pasteDetails.clipboard, pasteDetails.generators, context);\n      var mergedGrid = insertCols(index, grid, gridB, pasteDetails.generators, comparator);\n      return bundle(mergedGrid, pasteDetails.cells[0].row, pasteDetails.cells[0].column);\n    };\n    var opPasteRowsBefore = function (grid, pasteDetails, comparator, _genWrappers) {\n      var rows = extractGridDetails(grid).rows;\n      var index = pasteDetails.cells[0].row;\n      var context = rows[index];\n      var gridB = gridifyRows(pasteDetails.clipboard, pasteDetails.generators, context);\n      var mergedGrid = insertRows(index, grid, gridB, pasteDetails.generators, comparator);\n      return bundle(mergedGrid, pasteDetails.cells[0].row, pasteDetails.cells[0].column);\n    };\n    var opPasteRowsAfter = function (grid, pasteDetails, comparator, _genWrappers) {\n      var rows = extractGridDetails(grid).rows;\n      var index = pasteDetails.cells[pasteDetails.cells.length - 1].row + pasteDetails.cells[pasteDetails.cells.length - 1].rowspan;\n      var context = rows[pasteDetails.cells[0].row];\n      var gridB = gridifyRows(pasteDetails.clipboard, pasteDetails.generators, context);\n      var mergedGrid = insertRows(index, grid, gridB, pasteDetails.generators, comparator);\n      return bundle(mergedGrid, pasteDetails.cells[0].row, pasteDetails.cells[0].column);\n    };\n    var opGetColumnsType = function (table, target) {\n      var house = Warehouse.fromTable(table);\n      var details = onCells(house, target);\n      return details.bind(function (selectedCells) {\n        var lastSelectedCell = selectedCells[selectedCells.length - 1];\n        var minColRange = selectedCells[0].column;\n        var maxColRange = lastSelectedCell.column + lastSelectedCell.colspan;\n        var selectedColumnCells = flatten$1(map$1(house.all, function (row) {\n          return filter$2(row.cells, function (cell) {\n            return cell.column >= minColRange && cell.column < maxColRange;\n          });\n        }));\n        return findCommonCellType(selectedColumnCells);\n      }).getOr('');\n    };\n    var opGetCellsType = function (table, target) {\n      var house = Warehouse.fromTable(table);\n      var details = onCells(house, target);\n      return details.bind(findCommonCellType).getOr('');\n    };\n    var opGetRowsType = function (table, target) {\n      var house = Warehouse.fromTable(table);\n      var details = onCells(house, target);\n      return details.bind(function (selectedCells) {\n        var lastSelectedCell = selectedCells[selectedCells.length - 1];\n        var minRowRange = selectedCells[0].row;\n        var maxRowRange = lastSelectedCell.row + lastSelectedCell.rowspan;\n        var selectedRows = house.all.slice(minRowRange, maxRowRange);\n        return findCommonRowType(selectedRows);\n      }).getOr('');\n    };\n    var resize = function (table, list, details, behaviours) {\n      return adjustWidthTo(table, list, details, behaviours.sizing);\n    };\n    var adjustAndRedistributeWidths = function (table, list, details, behaviours) {\n      return adjustAndRedistributeWidths$1(table, list, details, behaviours.sizing, behaviours.resize);\n    };\n    var firstColumnIsLocked = function (_warehouse, details) {\n      return exists(details, function (detail) {\n        return detail.column === 0 && detail.isLocked;\n      });\n    };\n    var lastColumnIsLocked = function (warehouse, details) {\n      return exists(details, function (detail) {\n        return detail.column + detail.colspan >= warehouse.grid.columns && detail.isLocked;\n      });\n    };\n    var getColumnsWidth = function (warehouse, details) {\n      var columns$1 = columns(warehouse);\n      var uniqueCols = uniqueColumns(details);\n      return foldl(uniqueCols, function (acc, detail) {\n        var column = columns$1[detail.column];\n        var colWidth = column.map(getOuter$2).getOr(0);\n        return acc + colWidth;\n      }, 0);\n    };\n    var insertColumnsExtractor = function (before) {\n      return function (warehouse, target) {\n        return onCells(warehouse, target).filter(function (details) {\n          var checkLocked = before ? firstColumnIsLocked : lastColumnIsLocked;\n          return !checkLocked(warehouse, details);\n        }).map(function (details) {\n          return {\n            details: details,\n            pixelDelta: getColumnsWidth(warehouse, details)\n          };\n        });\n      };\n    };\n    var eraseColumnsExtractor = function (warehouse, target) {\n      return onUnlockedCells(warehouse, target).map(function (details) {\n        return {\n          details: details,\n          pixelDelta: -getColumnsWidth(warehouse, details)\n        };\n      });\n    };\n    var pasteColumnsExtractor = function (before) {\n      return function (warehouse, target) {\n        return onPasteByEditor(warehouse, target).filter(function (details) {\n          var checkLocked = before ? firstColumnIsLocked : lastColumnIsLocked;\n          return !checkLocked(warehouse, details.cells);\n        });\n      };\n    };\n    var headerCellGenerator = Generators.transform('th');\n    var bodyCellGenerator = Generators.transform('td');\n    var insertRowsBefore = run(opInsertRowsBefore, onCells, noop, noop, Generators.modification);\n    var insertRowsAfter = run(opInsertRowsAfter, onCells, noop, noop, Generators.modification);\n    var insertColumnsBefore = run(opInsertColumnsBefore, insertColumnsExtractor(true), adjustAndRedistributeWidths, noop, Generators.modification);\n    var insertColumnsAfter = run(opInsertColumnsAfter, insertColumnsExtractor(false), adjustAndRedistributeWidths, noop, Generators.modification);\n    var eraseColumns = run(opEraseColumns, eraseColumnsExtractor, adjustAndRedistributeWidths, prune, Generators.modification);\n    var eraseRows = run(opEraseRows, onCells, noop, prune, Generators.modification);\n    var makeColumnsHeader = run(opMakeColumnsHeader, onUnlockedCells, noop, noop, headerCellGenerator);\n    var unmakeColumnsHeader = run(opUnmakeColumnsHeader, onUnlockedCells, noop, noop, bodyCellGenerator);\n    var makeRowsHeader = run(opMakeRowsHeader, onUnlockedCells, noop, noop, headerCellGenerator);\n    var makeRowsBody = run(opMakeRowsBody, onUnlockedCells, noop, noop, bodyCellGenerator);\n    var makeRowsFooter = run(opMakeRowsFooter, onUnlockedCells, noop, noop, bodyCellGenerator);\n    var makeCellsHeader = run(opMakeCellsHeader, onUnlockedCells, noop, noop, headerCellGenerator);\n    var unmakeCellsHeader = run(opUnmakeCellsHeader, onUnlockedCells, noop, noop, bodyCellGenerator);\n    var mergeCells = run(opMergeCells, onUnlockedMergable, resize, noop, Generators.merging);\n    var unmergeCells = run(opUnmergeCells, onUnlockedUnmergable, resize, noop, Generators.merging);\n    var pasteCells = run(opPasteCells, onPaste, resize, noop, Generators.modification);\n    var pasteColsBefore = run(opPasteColsBefore, pasteColumnsExtractor(true), noop, noop, Generators.modification);\n    var pasteColsAfter = run(opPasteColsAfter, pasteColumnsExtractor(false), noop, noop, Generators.modification);\n    var pasteRowsBefore = run(opPasteRowsBefore, onPasteByEditor, noop, noop, Generators.modification);\n    var pasteRowsAfter = run(opPasteRowsAfter, onPasteByEditor, noop, noop, Generators.modification);\n    var getColumnsType = opGetColumnsType;\n    var getCellsType = opGetCellsType;\n    var getRowsType = opGetRowsType;\n\n    var TableActions = function (editor, cellSelection, lazyWire) {\n      var isTableBody = function (editor) {\n        return name(getBody(editor)) === 'table';\n      };\n      var lastRowGuard = function (table) {\n        return isTableBody(editor) === false || getGridSize(table).rows > 1;\n      };\n      var lastColumnGuard = function (table) {\n        return isTableBody(editor) === false || getGridSize(table).columns > 1;\n      };\n      var cloneFormats = getCloneElements(editor);\n      var colMutationOp = isResizeTableColumnResizing(editor) ? noop : halve;\n      var getTableSectionType = function (table) {\n        switch (getTableHeaderType(editor)) {\n        case 'section':\n          return TableSection.section();\n        case 'sectionCells':\n          return TableSection.sectionCells();\n        case 'cells':\n          return TableSection.cells();\n        default:\n          return TableSection.getTableSectionType(table, 'section');\n        }\n      };\n      var setSelectionFromAction = function (table, result) {\n        return result.cursor.fold(function () {\n          var cells = cells$1(table);\n          return head(cells).filter(inBody).map(function (firstCell) {\n            cellSelection.clear(table);\n            var rng = editor.dom.createRng();\n            rng.selectNode(firstCell.dom);\n            editor.selection.setRng(rng);\n            set$2(firstCell, 'data-mce-selected', '1');\n            return rng;\n          });\n        }, function (cell) {\n          var des = freefallRtl(cell);\n          var rng = editor.dom.createRng();\n          rng.setStart(des.element.dom, des.offset);\n          rng.setEnd(des.element.dom, des.offset);\n          editor.selection.setRng(rng);\n          cellSelection.clear(table);\n          return Optional.some(rng);\n        });\n      };\n      var execute = function (operation, guard, mutate, lazyWire, effect) {\n        return function (table, target, noEvents) {\n          if (noEvents === void 0) {\n            noEvents = false;\n          }\n          removeDataStyle(table);\n          var wire = lazyWire();\n          var doc = SugarElement.fromDom(editor.getDoc());\n          var generators = cellOperations(mutate, doc, cloneFormats);\n          var behaviours = {\n            sizing: get$4(editor, table),\n            resize: isResizeTableColumnResizing(editor) ? resizeTable() : preserveTable(),\n            section: getTableSectionType(table)\n          };\n          return guard(table) ? operation(wire, table, target, generators, behaviours).bind(function (result) {\n            each$2(result.newRows, function (row) {\n              fireNewRow(editor, row.dom);\n            });\n            each$2(result.newCells, function (cell) {\n              fireNewCell(editor, cell.dom);\n            });\n            var range = setSelectionFromAction(table, result);\n            if (inBody(table)) {\n              removeDataStyle(table);\n              if (!noEvents) {\n                fireTableModified(editor, table.dom, effect);\n              }\n            }\n            return range.map(function (rng) {\n              return {\n                rng: rng,\n                effect: effect\n              };\n            });\n          }) : Optional.none();\n        };\n      };\n      var deleteRow = execute(eraseRows, lastRowGuard, noop, lazyWire, structureModified);\n      var deleteColumn = execute(eraseColumns, lastColumnGuard, noop, lazyWire, structureModified);\n      var insertRowsBefore$1 = execute(insertRowsBefore, always, noop, lazyWire, structureModified);\n      var insertRowsAfter$1 = execute(insertRowsAfter, always, noop, lazyWire, structureModified);\n      var insertColumnsBefore$1 = execute(insertColumnsBefore, always, colMutationOp, lazyWire, structureModified);\n      var insertColumnsAfter$1 = execute(insertColumnsAfter, always, colMutationOp, lazyWire, structureModified);\n      var mergeCells$1 = execute(mergeCells, always, noop, lazyWire, structureModified);\n      var unmergeCells$1 = execute(unmergeCells, always, noop, lazyWire, structureModified);\n      var pasteColsBefore$1 = execute(pasteColsBefore, always, noop, lazyWire, structureModified);\n      var pasteColsAfter$1 = execute(pasteColsAfter, always, noop, lazyWire, structureModified);\n      var pasteRowsBefore$1 = execute(pasteRowsBefore, always, noop, lazyWire, structureModified);\n      var pasteRowsAfter$1 = execute(pasteRowsAfter, always, noop, lazyWire, structureModified);\n      var pasteCells$1 = execute(pasteCells, always, noop, lazyWire, styleAndStructureModified);\n      var makeCellsHeader$1 = execute(makeCellsHeader, always, noop, lazyWire, structureModified);\n      var unmakeCellsHeader$1 = execute(unmakeCellsHeader, always, noop, lazyWire, structureModified);\n      var makeColumnsHeader$1 = execute(makeColumnsHeader, always, noop, lazyWire, structureModified);\n      var unmakeColumnsHeader$1 = execute(unmakeColumnsHeader, always, noop, lazyWire, structureModified);\n      var makeRowsHeader$1 = execute(makeRowsHeader, always, noop, lazyWire, structureModified);\n      var makeRowsBody$1 = execute(makeRowsBody, always, noop, lazyWire, structureModified);\n      var makeRowsFooter$1 = execute(makeRowsFooter, always, noop, lazyWire, structureModified);\n      var getTableCellType = getCellsType;\n      var getTableColType = getColumnsType;\n      var getTableRowType = getRowsType;\n      return {\n        deleteRow: deleteRow,\n        deleteColumn: deleteColumn,\n        insertRowsBefore: insertRowsBefore$1,\n        insertRowsAfter: insertRowsAfter$1,\n        insertColumnsBefore: insertColumnsBefore$1,\n        insertColumnsAfter: insertColumnsAfter$1,\n        mergeCells: mergeCells$1,\n        unmergeCells: unmergeCells$1,\n        pasteColsBefore: pasteColsBefore$1,\n        pasteColsAfter: pasteColsAfter$1,\n        pasteRowsBefore: pasteRowsBefore$1,\n        pasteRowsAfter: pasteRowsAfter$1,\n        pasteCells: pasteCells$1,\n        makeCellsHeader: makeCellsHeader$1,\n        unmakeCellsHeader: unmakeCellsHeader$1,\n        makeColumnsHeader: makeColumnsHeader$1,\n        unmakeColumnsHeader: unmakeColumnsHeader$1,\n        makeRowsHeader: makeRowsHeader$1,\n        makeRowsBody: makeRowsBody$1,\n        makeRowsFooter: makeRowsFooter$1,\n        getTableRowType: getTableRowType,\n        getTableCellType: getTableCellType,\n        getTableColType: getTableColType\n      };\n    };\n\n    var DefaultRenderOptions = {\n      styles: {\n        'border-collapse': 'collapse',\n        'width': '100%'\n      },\n      attributes: { border: '1' },\n      colGroups: false\n    };\n    var tableHeaderCell = function () {\n      return SugarElement.fromTag('th');\n    };\n    var tableCell = function () {\n      return SugarElement.fromTag('td');\n    };\n    var tableColumn = function () {\n      return SugarElement.fromTag('col');\n    };\n    var createRow = function (columns, rowHeaders, columnHeaders, rowIndex) {\n      var tr = SugarElement.fromTag('tr');\n      for (var j = 0; j < columns; j++) {\n        var td = rowIndex < rowHeaders || j < columnHeaders ? tableHeaderCell() : tableCell();\n        if (j < columnHeaders) {\n          set$2(td, 'scope', 'row');\n        }\n        if (rowIndex < rowHeaders) {\n          set$2(td, 'scope', 'col');\n        }\n        append$1(td, SugarElement.fromTag('br'));\n        append$1(tr, td);\n      }\n      return tr;\n    };\n    var createGroupRow = function (columns) {\n      var columnGroup = SugarElement.fromTag('colgroup');\n      range$1(columns, function () {\n        return append$1(columnGroup, tableColumn());\n      });\n      return columnGroup;\n    };\n    var createRows = function (rows, columns, rowHeaders, columnHeaders) {\n      return range$1(rows, function (r) {\n        return createRow(columns, rowHeaders, columnHeaders, r);\n      });\n    };\n    var render = function (rows, columns, rowHeaders, columnHeaders, headerType, renderOpts) {\n      if (renderOpts === void 0) {\n        renderOpts = DefaultRenderOptions;\n      }\n      var table = SugarElement.fromTag('table');\n      var rowHeadersGoInThead = headerType !== 'cells';\n      setAll(table, renderOpts.styles);\n      setAll$1(table, renderOpts.attributes);\n      if (renderOpts.colGroups) {\n        append$1(table, createGroupRow(columns));\n      }\n      var actualRowHeaders = Math.min(rows, rowHeaders);\n      if (rowHeadersGoInThead && rowHeaders > 0) {\n        var thead = SugarElement.fromTag('thead');\n        append$1(table, thead);\n        var theadRowHeaders = headerType === 'sectionCells' ? actualRowHeaders : 0;\n        var theadRows = createRows(rowHeaders, columns, theadRowHeaders, columnHeaders);\n        append(thead, theadRows);\n      }\n      var tbody = SugarElement.fromTag('tbody');\n      append$1(table, tbody);\n      var numRows = rowHeadersGoInThead ? rows - actualRowHeaders : rows;\n      var numRowHeaders = rowHeadersGoInThead ? 0 : rowHeaders;\n      var tbodyRows = createRows(numRows, columns, numRowHeaders, columnHeaders);\n      append(tbody, tbodyRows);\n      return table;\n    };\n\n    var get$2 = function (element) {\n      return element.dom.innerHTML;\n    };\n    var getOuter = function (element) {\n      var container = SugarElement.fromTag('div');\n      var clone = SugarElement.fromDom(element.dom.cloneNode(true));\n      append$1(container, clone);\n      return get$2(container);\n    };\n\n    var placeCaretInCell = function (editor, cell) {\n      editor.selection.select(cell.dom, true);\n      editor.selection.collapse(true);\n    };\n    var selectFirstCellInTable = function (editor, tableElm) {\n      descendant(tableElm, 'td,th').each(curry(placeCaretInCell, editor));\n    };\n    var fireEvents = function (editor, table) {\n      each$2(descendants(table, 'tr'), function (row) {\n        fireNewRow(editor, row.dom);\n        each$2(descendants(row, 'th,td'), function (cell) {\n          fireNewCell(editor, cell.dom);\n        });\n      });\n    };\n    var isPercentage = function (width) {\n      return isString(width) && width.indexOf('%') !== -1;\n    };\n    var insert = function (editor, columns, rows, colHeaders, rowHeaders) {\n      var defaultStyles = getDefaultStyles(editor);\n      var options = {\n        styles: defaultStyles,\n        attributes: getDefaultAttributes(editor),\n        colGroups: useColumnGroup(editor)\n      };\n      editor.undoManager.ignore(function () {\n        var table = render(rows, columns, rowHeaders, colHeaders, getTableHeaderType(editor), options);\n        set$2(table, 'data-mce-id', '__mce');\n        var html = getOuter(table);\n        editor.insertContent(html);\n        editor.addVisual();\n      });\n      return descendant(getBody(editor), 'table[data-mce-id=\"__mce\"]').map(function (table) {\n        if (isPixelsForced(editor)) {\n          enforcePixels(table);\n        } else if (isResponsiveForced(editor)) {\n          enforceNone(table);\n        } else if (isPercentagesForced(editor) || isPercentage(defaultStyles.width)) {\n          enforcePercentage(table);\n        }\n        removeDataStyle(table);\n        remove$7(table, 'data-mce-id');\n        fireEvents(editor, table);\n        selectFirstCellInTable(editor, table);\n        return table.dom;\n      }).getOr(null);\n    };\n    var insertTableWithDataValidation = function (editor, rows, columns, options, errorMsg) {\n      if (options === void 0) {\n        options = {};\n      }\n      var checkInput = function (val) {\n        return isNumber(val) && val > 0;\n      };\n      if (checkInput(rows) && checkInput(columns)) {\n        var headerRows = options.headerRows || 0;\n        var headerColumns = options.headerColumns || 0;\n        return insert(editor, columns, rows, headerColumns, headerRows);\n      } else {\n        console.error(errorMsg);\n        return null;\n      }\n    };\n\n    var getClipboardElements = function (getClipboard) {\n      return function () {\n        return getClipboard().fold(function () {\n          return [];\n        }, function (elems) {\n          return map$1(elems, function (e) {\n            return e.dom;\n          });\n        });\n      };\n    };\n    var setClipboardElements = function (setClipboard) {\n      return function (elems) {\n        var elmsOpt = elems.length > 0 ? Optional.some(fromDom(elems)) : Optional.none();\n        setClipboard(elmsOpt);\n      };\n    };\n    var insertTable = function (editor) {\n      return function (columns, rows, options) {\n        if (options === void 0) {\n          options = {};\n        }\n        var table = insertTableWithDataValidation(editor, rows, columns, options, 'Invalid values for insertTable - rows and columns values are required to insert a table.');\n        editor.undoManager.add();\n        return table;\n      };\n    };\n    var getApi = function (editor, clipboard, resizeHandler, selectionTargets) {\n      return {\n        insertTable: insertTable(editor),\n        setClipboardRows: setClipboardElements(clipboard.setRows),\n        getClipboardRows: getClipboardElements(clipboard.getRows),\n        setClipboardCols: setClipboardElements(clipboard.setColumns),\n        getClipboardCols: getClipboardElements(clipboard.getColumns),\n        resizeHandler: resizeHandler,\n        selectionTargets: selectionTargets\n      };\n    };\n\n    var constrainSpan = function (element, property, value) {\n      var currentColspan = getAttrValue(element, property, 1);\n      if (value === 1 || currentColspan <= 1) {\n        remove$7(element, property);\n      } else {\n        set$2(element, property, Math.min(value, currentColspan));\n      }\n    };\n    var generateColGroup = function (house, minColRange, maxColRange) {\n      if (Warehouse.hasColumns(house)) {\n        var colsToCopy = filter$2(Warehouse.justColumns(house), function (col) {\n          return col.column >= minColRange && col.column < maxColRange;\n        });\n        var copiedCols = map$1(colsToCopy, function (c) {\n          var clonedCol = deep(c.element);\n          constrainSpan(clonedCol, 'span', maxColRange - minColRange);\n          return clonedCol;\n        });\n        var fakeColgroup = SugarElement.fromTag('colgroup');\n        append(fakeColgroup, copiedCols);\n        return [fakeColgroup];\n      } else {\n        return [];\n      }\n    };\n    var generateRows = function (house, minColRange, maxColRange) {\n      return map$1(house.all, function (row) {\n        var cellsToCopy = filter$2(row.cells, function (cell) {\n          return cell.column >= minColRange && cell.column < maxColRange;\n        });\n        var copiedCells = map$1(cellsToCopy, function (cell) {\n          var clonedCell = deep(cell.element);\n          constrainSpan(clonedCell, 'colspan', maxColRange - minColRange);\n          return clonedCell;\n        });\n        var fakeTR = SugarElement.fromTag('tr');\n        append(fakeTR, copiedCells);\n        return fakeTR;\n      });\n    };\n    var copyCols = function (table, target) {\n      var house = Warehouse.fromTable(table);\n      var details = onUnlockedCells(house, target);\n      return details.map(function (selectedCells) {\n        var lastSelectedCell = selectedCells[selectedCells.length - 1];\n        var minColRange = selectedCells[0].column;\n        var maxColRange = lastSelectedCell.column + lastSelectedCell.colspan;\n        var fakeColGroups = generateColGroup(house, minColRange, maxColRange);\n        var fakeRows = generateRows(house, minColRange, maxColRange);\n        return __spreadArray(__spreadArray([], fakeColGroups, true), fakeRows, true);\n      });\n    };\n\n    var copyRows = function (table, target, generators) {\n      var warehouse = Warehouse.fromTable(table);\n      var details = onCells(warehouse, target);\n      return details.bind(function (selectedCells) {\n        var grid = toGrid(warehouse, generators, false);\n        var rows = extractGridDetails(grid).rows;\n        var slicedGrid = rows.slice(selectedCells[0].row, selectedCells[selectedCells.length - 1].row + selectedCells[selectedCells.length - 1].rowspan);\n        var filteredGrid = bind$2(slicedGrid, function (row) {\n          var newCells = filter$2(row.cells, function (cell) {\n            return !cell.isLocked;\n          });\n          return newCells.length > 0 ? [__assign(__assign({}, row), { cells: newCells })] : [];\n        });\n        var slicedDetails = toDetailList(filteredGrid);\n        return someIf(slicedDetails.length > 0, slicedDetails);\n      }).map(function (slicedDetails) {\n        return copy(slicedDetails);\n      });\n    };\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getTDTHOverallStyle = function (dom, elm, name) {\n      var cells = dom.select('td,th', elm);\n      var firstChildStyle;\n      var checkChildren = function (firstChildStyle, elms) {\n        for (var i = 0; i < elms.length; i++) {\n          var currentStyle = dom.getStyle(elms[i], name);\n          if (typeof firstChildStyle === 'undefined') {\n            firstChildStyle = currentStyle;\n          }\n          if (firstChildStyle !== currentStyle) {\n            return '';\n          }\n        }\n        return firstChildStyle;\n      };\n      return checkChildren(firstChildStyle, cells);\n    };\n    var applyAlign = function (editor, elm, name) {\n      if (name) {\n        editor.formatter.apply('align' + name, {}, elm);\n      }\n    };\n    var applyVAlign = function (editor, elm, name) {\n      if (name) {\n        editor.formatter.apply('valign' + name, {}, elm);\n      }\n    };\n    var unApplyAlign = function (editor, elm) {\n      global$2.each('left center right'.split(' '), function (name) {\n        editor.formatter.remove('align' + name, {}, elm);\n      });\n    };\n    var unApplyVAlign = function (editor, elm) {\n      global$2.each('top middle bottom'.split(' '), function (name) {\n        editor.formatter.remove('valign' + name, {}, elm);\n      });\n    };\n\n    var verticalAlignValues = [\n      {\n        text: 'None',\n        value: ''\n      },\n      {\n        text: 'Top',\n        value: 'top'\n      },\n      {\n        text: 'Middle',\n        value: 'middle'\n      },\n      {\n        text: 'Bottom',\n        value: 'bottom'\n      }\n    ];\n\n    var hexColour = function (value) {\n      return { value: value };\n    };\n    var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n    var longformRegex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\n    var isHexString = function (hex) {\n      return shorthandRegex.test(hex) || longformRegex.test(hex);\n    };\n    var normalizeHex = function (hex) {\n      return removeLeading(hex, '#').toUpperCase();\n    };\n    var fromString$1 = function (hex) {\n      return isHexString(hex) ? Optional.some({ value: normalizeHex(hex) }) : Optional.none();\n    };\n    var toHex = function (component) {\n      var hex = component.toString(16);\n      return (hex.length === 1 ? '0' + hex : hex).toUpperCase();\n    };\n    var fromRgba = function (rgbaColour) {\n      var value = toHex(rgbaColour.red) + toHex(rgbaColour.green) + toHex(rgbaColour.blue);\n      return hexColour(value);\n    };\n\n    var rgbRegex = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/;\n    var rgbaRegex = /^rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*(\\d?(?:\\.\\d+)?)\\)/;\n    var rgbaColour = function (red, green, blue, alpha) {\n      return {\n        red: red,\n        green: green,\n        blue: blue,\n        alpha: alpha\n      };\n    };\n    var fromStringValues = function (red, green, blue, alpha) {\n      var r = parseInt(red, 10);\n      var g = parseInt(green, 10);\n      var b = parseInt(blue, 10);\n      var a = parseFloat(alpha);\n      return rgbaColour(r, g, b, a);\n    };\n    var fromString = function (rgbaString) {\n      if (rgbaString === 'transparent') {\n        return Optional.some(rgbaColour(0, 0, 0, 0));\n      }\n      var rgbMatch = rgbRegex.exec(rgbaString);\n      if (rgbMatch !== null) {\n        return Optional.some(fromStringValues(rgbMatch[1], rgbMatch[2], rgbMatch[3], '1'));\n      }\n      var rgbaMatch = rgbaRegex.exec(rgbaString);\n      if (rgbaMatch !== null) {\n        return Optional.some(fromStringValues(rgbaMatch[1], rgbaMatch[2], rgbaMatch[3], rgbaMatch[4]));\n      }\n      return Optional.none();\n    };\n\n    var anyToHex = function (color) {\n      return fromString$1(color).orThunk(function () {\n        return fromString(color).map(fromRgba);\n      }).getOrThunk(function () {\n        var canvas = document.createElement('canvas');\n        canvas.height = 1;\n        canvas.width = 1;\n        var canvasContext = canvas.getContext('2d');\n        canvasContext.clearRect(0, 0, canvas.width, canvas.height);\n        canvasContext.fillStyle = '#FFFFFF';\n        canvasContext.fillStyle = color;\n        canvasContext.fillRect(0, 0, 1, 1);\n        var rgba = canvasContext.getImageData(0, 0, 1, 1).data;\n        var r = rgba[0];\n        var g = rgba[1];\n        var b = rgba[2];\n        var a = rgba[3];\n        return fromRgba(rgbaColour(r, g, b, a));\n      });\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var singleton = function (doRevoke) {\n      var subject = Cell(Optional.none());\n      var revoke = function () {\n        return subject.get().each(doRevoke);\n      };\n      var clear = function () {\n        revoke();\n        subject.set(Optional.none());\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      var get = function () {\n        return subject.get();\n      };\n      var set = function (s) {\n        revoke();\n        subject.set(Optional.some(s));\n      };\n      return {\n        clear: clear,\n        isSet: isSet,\n        get: get,\n        set: set\n      };\n    };\n    var unbindable = function () {\n      return singleton(function (s) {\n        return s.unbind();\n      });\n    };\n    var value = function () {\n      var subject = singleton(noop);\n      var on = function (f) {\n        return subject.get().each(f);\n      };\n      return __assign(__assign({}, subject), { on: on });\n    };\n\n    var onSetupToggle = function (editor, selections, formatName, formatValue) {\n      return function (api) {\n        var boundCallback = unbindable();\n        var isNone = isEmpty$1(formatValue);\n        var init = function () {\n          var selectedCells = getCellsFromSelection(selections);\n          var checkNode = function (cell) {\n            return editor.formatter.match(formatName, { value: formatValue }, cell.dom, isNone);\n          };\n          if (isNone) {\n            api.setActive(!exists(selectedCells, checkNode));\n            boundCallback.set(editor.formatter.formatChanged(formatName, function (match) {\n              return api.setActive(!match);\n            }, true));\n          } else {\n            api.setActive(forall(selectedCells, checkNode));\n            boundCallback.set(editor.formatter.formatChanged(formatName, api.setActive, false, { value: formatValue }));\n          }\n        };\n        editor.initialized ? init() : editor.on('init', init);\n        return boundCallback.clear;\n      };\n    };\n    var isListGroup = function (item) {\n      return hasNonNullableKey(item, 'menu');\n    };\n    var buildListItems = function (items) {\n      return map$1(items, function (item) {\n        var text = item.text || item.title;\n        if (isListGroup(item)) {\n          return {\n            text: text,\n            items: buildListItems(item.menu)\n          };\n        } else {\n          return {\n            text: text,\n            value: item.value\n          };\n        }\n      });\n    };\n    var buildMenuItems = function (editor, selections, items, format, onAction) {\n      return map$1(items, function (item) {\n        var text = item.text || item.title;\n        if (isListGroup(item)) {\n          return {\n            type: 'nestedmenuitem',\n            text: text,\n            getSubmenuItems: function () {\n              return buildMenuItems(editor, selections, item.menu, format, onAction);\n            }\n          };\n        } else {\n          return {\n            text: text,\n            type: 'togglemenuitem',\n            onAction: function () {\n              return onAction(item.value);\n            },\n            onSetup: onSetupToggle(editor, selections, format, item.value)\n          };\n        }\n      });\n    };\n    var applyTableCellStyle = function (editor, style) {\n      return function (value) {\n        var _a;\n        editor.execCommand('mceTableApplyCellStyle', false, (_a = {}, _a[style] = value, _a));\n      };\n    };\n    var filterNoneItem = function (list) {\n      return bind$2(list, function (item) {\n        if (isListGroup(item)) {\n          return [__assign(__assign({}, item), { menu: filterNoneItem(item.menu) })];\n        } else {\n          return isNotEmpty(item.value) ? [item] : [];\n        }\n      });\n    };\n    var generateMenuItemsCallback = function (editor, selections, items, format, onAction) {\n      return function (callback) {\n        return callback(buildMenuItems(editor, selections, items, format, onAction));\n      };\n    };\n    var buildColorMenu = function (editor, colorList, style) {\n      var colorMap = map$1(colorList, function (entry) {\n        return {\n          text: entry.title,\n          value: '#' + anyToHex(entry.value).value,\n          type: 'choiceitem'\n        };\n      });\n      return [{\n          type: 'fancymenuitem',\n          fancytype: 'colorswatch',\n          initData: {\n            colors: colorMap.length > 0 ? colorMap : undefined,\n            allowCustomColors: false\n          },\n          onAction: function (data) {\n            var _a;\n            var value = data.value === 'remove' ? '' : data.value;\n            editor.execCommand('mceTableApplyCellStyle', false, (_a = {}, _a[style] = value, _a));\n          }\n        }];\n    };\n    var changeRowHeader = function (editor) {\n      return function () {\n        var currentType = editor.queryCommandValue('mceTableRowType');\n        var newType = currentType === 'header' ? 'body' : 'header';\n        editor.execCommand('mceTableRowType', false, { type: newType });\n      };\n    };\n    var changeColumnHeader = function (editor) {\n      return function () {\n        var currentType = editor.queryCommandValue('mceTableColType');\n        var newType = currentType === 'th' ? 'td' : 'th';\n        editor.execCommand('mceTableColType', false, { type: newType });\n      };\n    };\n\n    var getClassList$1 = function (editor) {\n      var classes = buildListItems(getCellClassList(editor));\n      if (classes.length > 0) {\n        return Optional.some({\n          name: 'class',\n          type: 'listbox',\n          label: 'Class',\n          items: classes\n        });\n      }\n      return Optional.none();\n    };\n    var children = [\n      {\n        name: 'width',\n        type: 'input',\n        label: 'Width'\n      },\n      {\n        name: 'height',\n        type: 'input',\n        label: 'Height'\n      },\n      {\n        name: 'celltype',\n        type: 'listbox',\n        label: 'Cell type',\n        items: [\n          {\n            text: 'Cell',\n            value: 'td'\n          },\n          {\n            text: 'Header cell',\n            value: 'th'\n          }\n        ]\n      },\n      {\n        name: 'scope',\n        type: 'listbox',\n        label: 'Scope',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Row',\n            value: 'row'\n          },\n          {\n            text: 'Column',\n            value: 'col'\n          },\n          {\n            text: 'Row group',\n            value: 'rowgroup'\n          },\n          {\n            text: 'Column group',\n            value: 'colgroup'\n          }\n        ]\n      },\n      {\n        name: 'halign',\n        type: 'listbox',\n        label: 'Horizontal align',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Left',\n            value: 'left'\n          },\n          {\n            text: 'Center',\n            value: 'center'\n          },\n          {\n            text: 'Right',\n            value: 'right'\n          }\n        ]\n      },\n      {\n        name: 'valign',\n        type: 'listbox',\n        label: 'Vertical align',\n        items: verticalAlignValues\n      }\n    ];\n    var getItems$2 = function (editor) {\n      return children.concat(getClassList$1(editor).toArray());\n    };\n\n    var getAdvancedTab = function (editor, dialogName) {\n      var emptyBorderStyle = [{\n          text: 'Select...',\n          value: ''\n        }];\n      var advTabItems = [\n        {\n          name: 'borderstyle',\n          type: 'listbox',\n          label: 'Border style',\n          items: emptyBorderStyle.concat(buildListItems(getTableBorderStyles(editor)))\n        },\n        {\n          name: 'bordercolor',\n          type: 'colorinput',\n          label: 'Border color'\n        },\n        {\n          name: 'backgroundcolor',\n          type: 'colorinput',\n          label: 'Background color'\n        }\n      ];\n      var borderWidth = {\n        name: 'borderwidth',\n        type: 'input',\n        label: 'Border width'\n      };\n      var items = dialogName === 'cell' ? [borderWidth].concat(advTabItems) : advTabItems;\n      return {\n        title: 'Advanced',\n        name: 'advanced',\n        items: items\n      };\n    };\n\n    var modifiers = function (testTruthy) {\n      return function (editor, node) {\n        var dom = editor.dom;\n        var setAttrib = function (attr, value) {\n          if (!testTruthy || value) {\n            dom.setAttrib(node, attr, value);\n          }\n        };\n        var setStyle = function (prop, value) {\n          if (!testTruthy || value) {\n            dom.setStyle(node, prop, value);\n          }\n        };\n        var setFormat = function (formatName, value) {\n          if (!testTruthy || value) {\n            if (value === '') {\n              editor.formatter.remove(formatName, { value: null }, node, true);\n            } else {\n              editor.formatter.apply(formatName, { value: value }, node);\n            }\n          }\n        };\n        return {\n          setAttrib: setAttrib,\n          setStyle: setStyle,\n          setFormat: setFormat\n        };\n      };\n    };\n    var DomModifier = {\n      normal: modifiers(false),\n      ifTruthy: modifiers(true)\n    };\n\n    var rgbToHex = function (dom) {\n      return function (value) {\n        return startsWith(value, 'rgb') ? dom.toHex(value) : value;\n      };\n    };\n    var extractAdvancedStyles = function (dom, elm) {\n      var element = SugarElement.fromDom(elm);\n      return {\n        borderwidth: getRaw$2(element, 'border-width').getOr(''),\n        borderstyle: getRaw$2(element, 'border-style').getOr(''),\n        bordercolor: getRaw$2(element, 'border-color').map(rgbToHex(dom)).getOr(''),\n        backgroundcolor: getRaw$2(element, 'background-color').map(rgbToHex(dom)).getOr('')\n      };\n    };\n    var getSharedValues = function (data) {\n      var baseData = data[0];\n      var comparisonData = data.slice(1);\n      each$2(comparisonData, function (items) {\n        each$2(keys(baseData), function (key) {\n          each$1(items, function (itemValue, itemKey) {\n            var comparisonValue = baseData[key];\n            if (comparisonValue !== '' && key === itemKey) {\n              if (comparisonValue !== itemValue) {\n                baseData[key] = '';\n              }\n            }\n          });\n        });\n      });\n      return baseData;\n    };\n    var getAlignment = function (formats, formatName, editor, elm) {\n      return find$1(formats, function (name) {\n        return !isUndefined(editor.formatter.matchNode(elm, formatName + name));\n      }).getOr('');\n    };\n    var getHAlignment = curry(getAlignment, [\n      'left',\n      'center',\n      'right'\n    ], 'align');\n    var getVAlignment = curry(getAlignment, [\n      'top',\n      'middle',\n      'bottom'\n    ], 'valign');\n    var extractDataFromSettings = function (editor, hasAdvTableTab) {\n      var style = getDefaultStyles(editor);\n      var attrs = getDefaultAttributes(editor);\n      var extractAdvancedStyleData = function (dom) {\n        return {\n          borderstyle: get$c(style, 'border-style').getOr(''),\n          bordercolor: rgbToHex(dom)(get$c(style, 'border-color').getOr('')),\n          backgroundcolor: rgbToHex(dom)(get$c(style, 'background-color').getOr(''))\n        };\n      };\n      var defaultData = {\n        height: '',\n        width: '100%',\n        cellspacing: '',\n        cellpadding: '',\n        caption: false,\n        class: '',\n        align: '',\n        border: ''\n      };\n      var getBorder = function () {\n        var borderWidth = style['border-width'];\n        if (shouldStyleWithCss(editor) && borderWidth) {\n          return { border: borderWidth };\n        }\n        return get$c(attrs, 'border').fold(function () {\n          return {};\n        }, function (border) {\n          return { border: border };\n        });\n      };\n      var advStyle = hasAdvTableTab ? extractAdvancedStyleData(editor.dom) : {};\n      var getCellPaddingCellSpacing = function () {\n        var spacing = get$c(style, 'border-spacing').or(get$c(attrs, 'cellspacing')).fold(function () {\n          return {};\n        }, function (cellspacing) {\n          return { cellspacing: cellspacing };\n        });\n        var padding = get$c(style, 'border-padding').or(get$c(attrs, 'cellpadding')).fold(function () {\n          return {};\n        }, function (cellpadding) {\n          return { cellpadding: cellpadding };\n        });\n        return __assign(__assign({}, spacing), padding);\n      };\n      var data = __assign(__assign(__assign(__assign(__assign(__assign({}, defaultData), style), attrs), advStyle), getBorder()), getCellPaddingCellSpacing());\n      return data;\n    };\n    var getRowType = function (elm) {\n      return table(SugarElement.fromDom(elm)).map(function (table) {\n        var target = { selection: fromDom(elm.cells) };\n        return getRowsType(table, target);\n      }).getOr('');\n    };\n    var extractDataFromTableElement = function (editor, elm, hasAdvTableTab) {\n      var getBorder = function (dom, elm) {\n        var optBorderWidth = getRaw$2(SugarElement.fromDom(elm), 'border-width');\n        if (shouldStyleWithCss(editor) && optBorderWidth.isSome()) {\n          return optBorderWidth.getOr('');\n        }\n        return dom.getAttrib(elm, 'border') || getTDTHOverallStyle(editor.dom, elm, 'border-width') || getTDTHOverallStyle(editor.dom, elm, 'border');\n      };\n      var dom = editor.dom;\n      var cellspacing = shouldStyleWithCss(editor) ? dom.getStyle(elm, 'border-spacing') || dom.getAttrib(elm, 'cellspacing') : dom.getAttrib(elm, 'cellspacing') || dom.getStyle(elm, 'border-spacing');\n      var cellpadding = shouldStyleWithCss(editor) ? getTDTHOverallStyle(dom, elm, 'padding') || dom.getAttrib(elm, 'cellpadding') : dom.getAttrib(elm, 'cellpadding') || getTDTHOverallStyle(dom, elm, 'padding');\n      return __assign({\n        width: dom.getStyle(elm, 'width') || dom.getAttrib(elm, 'width'),\n        height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n        cellspacing: cellspacing,\n        cellpadding: cellpadding,\n        border: getBorder(dom, elm),\n        caption: !!dom.select('caption', elm)[0],\n        class: dom.getAttrib(elm, 'class', ''),\n        align: getHAlignment(editor, elm)\n      }, hasAdvTableTab ? extractAdvancedStyles(dom, elm) : {});\n    };\n    var extractDataFromRowElement = function (editor, elm, hasAdvancedRowTab) {\n      var dom = editor.dom;\n      return __assign({\n        height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n        class: dom.getAttrib(elm, 'class', ''),\n        type: getRowType(elm),\n        align: getHAlignment(editor, elm)\n      }, hasAdvancedRowTab ? extractAdvancedStyles(dom, elm) : {});\n    };\n    var extractDataFromCellElement = function (editor, cell, hasAdvancedCellTab, column) {\n      var dom = editor.dom;\n      var colElm = column.getOr(cell);\n      var getStyle = function (element, style) {\n        return dom.getStyle(element, style) || dom.getAttrib(element, style);\n      };\n      return __assign({\n        width: getStyle(colElm, 'width'),\n        height: getStyle(cell, 'height'),\n        scope: dom.getAttrib(cell, 'scope'),\n        celltype: getNodeName(cell),\n        class: dom.getAttrib(cell, 'class', ''),\n        halign: getHAlignment(editor, cell),\n        valign: getVAlignment(editor, cell)\n      }, hasAdvancedCellTab ? extractAdvancedStyles(dom, cell) : {});\n    };\n\n    var getSelectedCells = function (table, cells) {\n      var warehouse = Warehouse.fromTable(table);\n      var allCells = Warehouse.justCells(warehouse);\n      var filtered = filter$2(allCells, function (cellA) {\n        return exists(cells, function (cellB) {\n          return eq$1(cellA.element, cellB);\n        });\n      });\n      return map$1(filtered, function (cell) {\n        return {\n          element: cell.element.dom,\n          column: Warehouse.getColumnAt(warehouse, cell.column).map(function (col) {\n            return col.element.dom;\n          })\n        };\n      });\n    };\n    var updateSimpleProps$1 = function (modifier, colModifier, data) {\n      modifier.setAttrib('scope', data.scope);\n      modifier.setAttrib('class', data.class);\n      modifier.setStyle('height', addPxSuffix(data.height));\n      colModifier.setStyle('width', addPxSuffix(data.width));\n    };\n    var updateAdvancedProps$1 = function (modifier, data) {\n      modifier.setFormat('tablecellbackgroundcolor', data.backgroundcolor);\n      modifier.setFormat('tablecellbordercolor', data.bordercolor);\n      modifier.setFormat('tablecellborderstyle', data.borderstyle);\n      modifier.setFormat('tablecellborderwidth', addPxSuffix(data.borderwidth));\n    };\n    var applyStyleData$1 = function (editor, cells, data) {\n      var isSingleCell = cells.length === 1;\n      each$2(cells, function (item) {\n        var cellElm = item.element;\n        var modifier = isSingleCell ? DomModifier.normal(editor, cellElm) : DomModifier.ifTruthy(editor, cellElm);\n        var colModifier = item.column.map(function (col) {\n          return isSingleCell ? DomModifier.normal(editor, col) : DomModifier.ifTruthy(editor, col);\n        }).getOr(modifier);\n        updateSimpleProps$1(modifier, colModifier, data);\n        if (hasAdvancedCellTab(editor)) {\n          updateAdvancedProps$1(modifier, data);\n        }\n        if (isSingleCell) {\n          unApplyAlign(editor, cellElm);\n          unApplyVAlign(editor, cellElm);\n        }\n        if (data.halign) {\n          applyAlign(editor, cellElm, data.halign);\n        }\n        if (data.valign) {\n          applyVAlign(editor, cellElm, data.valign);\n        }\n      });\n    };\n    var applyStructureData$1 = function (editor, data) {\n      editor.execCommand('mceTableCellType', false, {\n        type: data.celltype,\n        no_events: true\n      });\n    };\n    var applyCellData = function (editor, cells, oldData, data) {\n      var modifiedData = filter$1(data, function (value, key) {\n        return oldData[key] !== value;\n      });\n      if (size(modifiedData) > 0 && cells.length >= 1) {\n        table(cells[0]).each(function (table) {\n          var selectedCells = getSelectedCells(table, cells);\n          var styleModified = size(filter$1(modifiedData, function (_value, key) {\n            return key !== 'scope' && key !== 'celltype';\n          })) > 0;\n          var structureModified = has$1(modifiedData, 'celltype');\n          if (styleModified || has$1(modifiedData, 'scope')) {\n            applyStyleData$1(editor, selectedCells, data);\n          }\n          if (structureModified) {\n            applyStructureData$1(editor, data);\n          }\n          fireTableModified(editor, table.dom, {\n            structure: structureModified,\n            style: styleModified\n          });\n        });\n      }\n    };\n    var onSubmitCellForm = function (editor, cells, oldData, api) {\n      var data = api.getData();\n      api.close();\n      editor.undoManager.transact(function () {\n        applyCellData(editor, cells, oldData, data);\n        editor.focus();\n      });\n    };\n    var getData = function (editor, cells) {\n      var cellsData = table(cells[0]).map(function (table) {\n        return map$1(getSelectedCells(table, cells), function (item) {\n          return extractDataFromCellElement(editor, item.element, hasAdvancedCellTab(editor), item.column);\n        });\n      });\n      return getSharedValues(cellsData.getOrDie());\n    };\n    var open$2 = function (editor, selections) {\n      var cells = getCellsFromSelection(selections);\n      if (cells.length === 0) {\n        return;\n      }\n      var data = getData(editor, cells);\n      var dialogTabPanel = {\n        type: 'tabpanel',\n        tabs: [\n          {\n            title: 'General',\n            name: 'general',\n            items: getItems$2(editor)\n          },\n          getAdvancedTab(editor, 'cell')\n        ]\n      };\n      var dialogPanel = {\n        type: 'panel',\n        items: [{\n            type: 'grid',\n            columns: 2,\n            items: getItems$2(editor)\n          }]\n      };\n      editor.windowManager.open({\n        title: 'Cell Properties',\n        size: 'normal',\n        body: hasAdvancedCellTab(editor) ? dialogTabPanel : dialogPanel,\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: data,\n        onSubmit: curry(onSubmitCellForm, editor, cells, data)\n      });\n    };\n\n    var getClassList = function (editor) {\n      var classes = buildListItems(getRowClassList(editor));\n      if (classes.length > 0) {\n        return Optional.some({\n          name: 'class',\n          type: 'listbox',\n          label: 'Class',\n          items: classes\n        });\n      }\n      return Optional.none();\n    };\n    var formChildren = [\n      {\n        type: 'listbox',\n        name: 'type',\n        label: 'Row type',\n        items: [\n          {\n            text: 'Header',\n            value: 'header'\n          },\n          {\n            text: 'Body',\n            value: 'body'\n          },\n          {\n            text: 'Footer',\n            value: 'footer'\n          }\n        ]\n      },\n      {\n        type: 'listbox',\n        name: 'align',\n        label: 'Alignment',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Left',\n            value: 'left'\n          },\n          {\n            text: 'Center',\n            value: 'center'\n          },\n          {\n            text: 'Right',\n            value: 'right'\n          }\n        ]\n      },\n      {\n        label: 'Height',\n        name: 'height',\n        type: 'input'\n      }\n    ];\n    var getItems$1 = function (editor) {\n      return formChildren.concat(getClassList(editor).toArray());\n    };\n\n    var updateSimpleProps = function (modifier, data) {\n      modifier.setAttrib('class', data.class);\n      modifier.setStyle('height', addPxSuffix(data.height));\n    };\n    var updateAdvancedProps = function (modifier, data) {\n      modifier.setStyle('background-color', data.backgroundcolor);\n      modifier.setStyle('border-color', data.bordercolor);\n      modifier.setStyle('border-style', data.borderstyle);\n    };\n    var applyStyleData = function (editor, rows, data, oldData) {\n      var isSingleRow = rows.length === 1;\n      each$2(rows, function (rowElm) {\n        var modifier = isSingleRow ? DomModifier.normal(editor, rowElm) : DomModifier.ifTruthy(editor, rowElm);\n        updateSimpleProps(modifier, data);\n        if (hasAdvancedRowTab(editor)) {\n          updateAdvancedProps(modifier, data);\n        }\n        if (data.align !== oldData.align) {\n          unApplyAlign(editor, rowElm);\n          applyAlign(editor, rowElm, data.align);\n        }\n      });\n    };\n    var applyStructureData = function (editor, data) {\n      editor.execCommand('mceTableRowType', false, {\n        type: data.type,\n        no_events: true\n      });\n    };\n    var applyRowData = function (editor, rows, oldData, data) {\n      var modifiedData = filter$1(data, function (value, key) {\n        return oldData[key] !== value;\n      });\n      if (size(modifiedData) > 0) {\n        var typeModified_1 = has$1(modifiedData, 'type');\n        var styleModified_1 = typeModified_1 ? size(modifiedData) > 1 : true;\n        if (styleModified_1) {\n          applyStyleData(editor, rows, data, oldData);\n        }\n        if (typeModified_1) {\n          applyStructureData(editor, data);\n        }\n        table(SugarElement.fromDom(rows[0])).each(function (table) {\n          return fireTableModified(editor, table.dom, {\n            structure: typeModified_1,\n            style: styleModified_1\n          });\n        });\n      }\n    };\n    var onSubmitRowForm = function (editor, rows, oldData, api) {\n      var data = api.getData();\n      api.close();\n      editor.undoManager.transact(function () {\n        applyRowData(editor, rows, oldData, data);\n        editor.focus();\n      });\n    };\n    var open$1 = function (editor) {\n      var rows = getRowsFromSelection(getSelectionStart(editor), ephemera.selected);\n      if (rows.length === 0) {\n        return;\n      }\n      var rowsData = map$1(rows, function (rowElm) {\n        return extractDataFromRowElement(editor, rowElm.dom, hasAdvancedRowTab(editor));\n      });\n      var data = getSharedValues(rowsData);\n      var dialogTabPanel = {\n        type: 'tabpanel',\n        tabs: [\n          {\n            title: 'General',\n            name: 'general',\n            items: getItems$1(editor)\n          },\n          getAdvancedTab(editor, 'row')\n        ]\n      };\n      var dialogPanel = {\n        type: 'panel',\n        items: [{\n            type: 'grid',\n            columns: 2,\n            items: getItems$1(editor)\n          }]\n      };\n      editor.windowManager.open({\n        title: 'Row Properties',\n        size: 'normal',\n        body: hasAdvancedRowTab(editor) ? dialogTabPanel : dialogPanel,\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: data,\n        onSubmit: curry(onSubmitRowForm, editor, map$1(rows, function (r) {\n          return r.dom;\n        }), data)\n      });\n    };\n\n    var getItems = function (editor, classes, insertNewTable) {\n      var rowColCountItems = !insertNewTable ? [] : [\n        {\n          type: 'input',\n          name: 'cols',\n          label: 'Cols',\n          inputMode: 'numeric'\n        },\n        {\n          type: 'input',\n          name: 'rows',\n          label: 'Rows',\n          inputMode: 'numeric'\n        }\n      ];\n      var alwaysItems = [\n        {\n          type: 'input',\n          name: 'width',\n          label: 'Width'\n        },\n        {\n          type: 'input',\n          name: 'height',\n          label: 'Height'\n        }\n      ];\n      var appearanceItems = hasAppearanceOptions(editor) ? [\n        {\n          type: 'input',\n          name: 'cellspacing',\n          label: 'Cell spacing',\n          inputMode: 'numeric'\n        },\n        {\n          type: 'input',\n          name: 'cellpadding',\n          label: 'Cell padding',\n          inputMode: 'numeric'\n        },\n        {\n          type: 'input',\n          name: 'border',\n          label: 'Border width'\n        },\n        {\n          type: 'label',\n          label: 'Caption',\n          items: [{\n              type: 'checkbox',\n              name: 'caption',\n              label: 'Show caption'\n            }]\n        }\n      ] : [];\n      var alignmentItem = [{\n          type: 'listbox',\n          name: 'align',\n          label: 'Alignment',\n          items: [\n            {\n              text: 'None',\n              value: ''\n            },\n            {\n              text: 'Left',\n              value: 'left'\n            },\n            {\n              text: 'Center',\n              value: 'center'\n            },\n            {\n              text: 'Right',\n              value: 'right'\n            }\n          ]\n        }];\n      var classListItem = classes.length > 0 ? [{\n          type: 'listbox',\n          name: 'class',\n          label: 'Class',\n          items: classes\n        }] : [];\n      return rowColCountItems.concat(alwaysItems).concat(appearanceItems).concat(alignmentItem).concat(classListItem);\n    };\n\n    var styleTDTH = function (dom, elm, name, value) {\n      if (elm.tagName === 'TD' || elm.tagName === 'TH') {\n        if (isString(name)) {\n          dom.setStyle(elm, name, value);\n        } else {\n          dom.setStyle(elm, name);\n        }\n      } else {\n        if (elm.children) {\n          for (var i = 0; i < elm.children.length; i++) {\n            styleTDTH(dom, elm.children[i], name, value);\n          }\n        }\n      }\n    };\n    var applyDataToElement = function (editor, tableElm, data) {\n      var dom = editor.dom;\n      var attrs = {};\n      var styles = {};\n      attrs.class = data.class;\n      styles.height = addPxSuffix(data.height);\n      if (dom.getAttrib(tableElm, 'width') && !shouldStyleWithCss(editor)) {\n        attrs.width = removePxSuffix(data.width);\n      } else {\n        styles.width = addPxSuffix(data.width);\n      }\n      if (shouldStyleWithCss(editor)) {\n        styles['border-width'] = addPxSuffix(data.border);\n        styles['border-spacing'] = addPxSuffix(data.cellspacing);\n      } else {\n        attrs.border = data.border;\n        attrs.cellpadding = data.cellpadding;\n        attrs.cellspacing = data.cellspacing;\n      }\n      if (shouldStyleWithCss(editor) && tableElm.children) {\n        for (var i = 0; i < tableElm.children.length; i++) {\n          styleTDTH(dom, tableElm.children[i], {\n            'border-width': addPxSuffix(data.border),\n            'padding': addPxSuffix(data.cellpadding)\n          });\n          if (hasAdvancedTableTab(editor)) {\n            styleTDTH(dom, tableElm.children[i], { 'border-color': data.bordercolor });\n          }\n        }\n      }\n      if (hasAdvancedTableTab(editor)) {\n        styles['background-color'] = data.backgroundcolor;\n        styles['border-color'] = data.bordercolor;\n        styles['border-style'] = data.borderstyle;\n      }\n      attrs.style = dom.serializeStyle(__assign(__assign({}, getDefaultStyles(editor)), styles));\n      dom.setAttribs(tableElm, __assign(__assign({}, getDefaultAttributes(editor)), attrs));\n    };\n    var onSubmitTableForm = function (editor, tableElm, oldData, api) {\n      var dom = editor.dom;\n      var data = api.getData();\n      var modifiedData = filter$1(data, function (value, key) {\n        return oldData[key] !== value;\n      });\n      api.close();\n      if (data.class === '') {\n        delete data.class;\n      }\n      editor.undoManager.transact(function () {\n        if (!tableElm) {\n          var cols = parseInt(data.cols, 10) || 1;\n          var rows = parseInt(data.rows, 10) || 1;\n          tableElm = insert(editor, cols, rows, 0, 0);\n        }\n        if (size(modifiedData) > 0) {\n          applyDataToElement(editor, tableElm, data);\n          var captionElm = dom.select('caption', tableElm)[0];\n          if (captionElm && !data.caption || !captionElm && data.caption) {\n            editor.execCommand('mceTableToggleCaption');\n          }\n          if (data.align === '') {\n            unApplyAlign(editor, tableElm);\n          } else {\n            applyAlign(editor, tableElm, data.align);\n          }\n        }\n        editor.focus();\n        editor.addVisual();\n        if (size(modifiedData) > 0) {\n          var captionModified = has$1(modifiedData, 'caption');\n          var styleModified = captionModified ? size(modifiedData) > 1 : true;\n          fireTableModified(editor, tableElm, {\n            structure: captionModified,\n            style: styleModified\n          });\n        }\n      });\n    };\n    var open = function (editor, insertNewTable) {\n      var dom = editor.dom;\n      var tableElm;\n      var data = extractDataFromSettings(editor, hasAdvancedTableTab(editor));\n      if (insertNewTable === false) {\n        tableElm = dom.getParent(editor.selection.getStart(), 'table', editor.getBody());\n        if (tableElm) {\n          data = extractDataFromTableElement(editor, tableElm, hasAdvancedTableTab(editor));\n        } else {\n          if (hasAdvancedTableTab(editor)) {\n            data.borderstyle = '';\n            data.bordercolor = '';\n            data.backgroundcolor = '';\n          }\n        }\n      } else {\n        data.cols = '1';\n        data.rows = '1';\n        if (hasAdvancedTableTab(editor)) {\n          data.borderstyle = '';\n          data.bordercolor = '';\n          data.backgroundcolor = '';\n        }\n      }\n      var classes = buildListItems(getTableClassList(editor));\n      if (classes.length > 0) {\n        if (data.class) {\n          data.class = data.class.replace(/\\s*mce\\-item\\-table\\s*/g, '');\n        }\n      }\n      var generalPanel = {\n        type: 'grid',\n        columns: 2,\n        items: getItems(editor, classes, insertNewTable)\n      };\n      var nonAdvancedForm = function () {\n        return {\n          type: 'panel',\n          items: [generalPanel]\n        };\n      };\n      var advancedForm = function () {\n        return {\n          type: 'tabpanel',\n          tabs: [\n            {\n              title: 'General',\n              name: 'general',\n              items: [generalPanel]\n            },\n            getAdvancedTab(editor, 'table')\n          ]\n        };\n      };\n      var dialogBody = hasAdvancedTableTab(editor) ? advancedForm() : nonAdvancedForm();\n      editor.windowManager.open({\n        title: 'Table Properties',\n        size: 'normal',\n        body: dialogBody,\n        onSubmit: curry(onSubmitTableForm, editor, tableElm, data),\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: data\n      });\n    };\n\n    var getSelectionStartCellOrCaption = function (editor) {\n      return getSelectionCellOrCaption(getSelectionStart(editor), getIsRoot(editor));\n    };\n    var getSelectionStartCell = function (editor) {\n      return getSelectionCell(getSelectionStart(editor), getIsRoot(editor));\n    };\n    var registerCommands = function (editor, actions, cellSelection, selections, clipboard) {\n      var isRoot = getIsRoot(editor);\n      var eraseTable = function () {\n        return getSelectionStartCellOrCaption(editor).each(function (cellOrCaption) {\n          table(cellOrCaption, isRoot).filter(not(isRoot)).each(function (table) {\n            var cursor = SugarElement.fromText('');\n            after$5(table, cursor);\n            remove$5(table);\n            if (editor.dom.isEmpty(editor.getBody())) {\n              editor.setContent('');\n              editor.selection.setCursorLocation();\n            } else {\n              var rng = editor.dom.createRng();\n              rng.setStart(cursor.dom, 0);\n              rng.setEnd(cursor.dom, 0);\n              editor.selection.setRng(rng);\n              editor.nodeChanged();\n            }\n          });\n        });\n      };\n      var setSizingMode = function (sizing) {\n        return getSelectionStartCellOrCaption(editor).each(function (cellOrCaption) {\n          var isForcedSizing = isResponsiveForced(editor) || isPixelsForced(editor) || isPercentagesForced(editor);\n          if (!isForcedSizing) {\n            table(cellOrCaption, isRoot).each(function (table) {\n              if (sizing === 'relative' && !isPercentSizing(table)) {\n                enforcePercentage(table);\n              } else if (sizing === 'fixed' && !isPixelSizing(table)) {\n                enforcePixels(table);\n              } else if (sizing === 'responsive' && !isNoneSizing(table)) {\n                enforceNone(table);\n              }\n              removeDataStyle(table);\n              fireTableModified(editor, table.dom, structureModified);\n            });\n          }\n        });\n      };\n      var getTableFromCell = function (cell) {\n        return table(cell, isRoot);\n      };\n      var performActionOnSelection = function (action) {\n        return getSelectionStartCell(editor).bind(function (cell) {\n          return getTableFromCell(cell).map(function (table) {\n            return action(table, cell);\n          });\n        });\n      };\n      var toggleTableClass = function (_ui, clazz) {\n        performActionOnSelection(function (table) {\n          editor.formatter.toggle('tableclass', { value: clazz }, table.dom);\n          fireTableModified(editor, table.dom, styleModified);\n        });\n      };\n      var toggleTableCellClass = function (_ui, clazz) {\n        performActionOnSelection(function (table) {\n          var selectedCells = getCellsFromSelection(selections);\n          var allHaveClass = forall(selectedCells, function (cell) {\n            return editor.formatter.match('tablecellclass', { value: clazz }, cell.dom);\n          });\n          var formatterAction = allHaveClass ? editor.formatter.remove : editor.formatter.apply;\n          each$2(selectedCells, function (cell) {\n            return formatterAction('tablecellclass', { value: clazz }, cell.dom);\n          });\n          fireTableModified(editor, table.dom, styleModified);\n        });\n      };\n      var toggleCaption = function () {\n        getSelectionStartCellOrCaption(editor).each(function (cellOrCaption) {\n          table(cellOrCaption, isRoot).each(function (table) {\n            child$1(table, 'caption').fold(function () {\n              var caption = SugarElement.fromTag('caption');\n              append$1(caption, SugarElement.fromText('Caption'));\n              appendAt(table, caption, 0);\n              editor.selection.setCursorLocation(caption.dom, 0);\n            }, function (caption) {\n              if (isTag('caption')(cellOrCaption)) {\n                one('td', table).each(function (td) {\n                  return editor.selection.setCursorLocation(td.dom, 0);\n                });\n              }\n              remove$5(caption);\n            });\n            fireTableModified(editor, table.dom, structureModified);\n          });\n        });\n      };\n      var postExecute = function (_data) {\n        editor.focus();\n      };\n      var actOnSelection = function (execute, noEvents) {\n        if (noEvents === void 0) {\n          noEvents = false;\n        }\n        return performActionOnSelection(function (table, startCell) {\n          var targets = forMenu(selections, table, startCell);\n          execute(table, targets, noEvents).each(postExecute);\n        });\n      };\n      var copyRowSelection = function () {\n        return performActionOnSelection(function (table, startCell) {\n          var targets = forMenu(selections, table, startCell);\n          var generators = cellOperations(noop, SugarElement.fromDom(editor.getDoc()), Optional.none());\n          return copyRows(table, targets, generators);\n        });\n      };\n      var copyColSelection = function () {\n        return performActionOnSelection(function (table, startCell) {\n          var targets = forMenu(selections, table, startCell);\n          return copyCols(table, targets);\n        });\n      };\n      var pasteOnSelection = function (execute, getRows) {\n        return getRows().each(function (rows) {\n          var clonedRows = map$1(rows, function (row) {\n            return deep(row);\n          });\n          performActionOnSelection(function (table, startCell) {\n            var generators = paste$1(SugarElement.fromDom(editor.getDoc()));\n            var targets = pasteRows(selections, startCell, clonedRows, generators);\n            execute(table, targets).each(postExecute);\n          });\n        });\n      };\n      var actOnType = function (getAction) {\n        return function (_ui, args) {\n          return get$c(args, 'type').each(function (type) {\n            actOnSelection(getAction(type), args.no_events);\n          });\n        };\n      };\n      each$1({\n        mceTableSplitCells: function () {\n          return actOnSelection(actions.unmergeCells);\n        },\n        mceTableMergeCells: function () {\n          return actOnSelection(actions.mergeCells);\n        },\n        mceTableInsertRowBefore: function () {\n          return actOnSelection(actions.insertRowsBefore);\n        },\n        mceTableInsertRowAfter: function () {\n          return actOnSelection(actions.insertRowsAfter);\n        },\n        mceTableInsertColBefore: function () {\n          return actOnSelection(actions.insertColumnsBefore);\n        },\n        mceTableInsertColAfter: function () {\n          return actOnSelection(actions.insertColumnsAfter);\n        },\n        mceTableDeleteCol: function () {\n          return actOnSelection(actions.deleteColumn);\n        },\n        mceTableDeleteRow: function () {\n          return actOnSelection(actions.deleteRow);\n        },\n        mceTableCutCol: function () {\n          return copyColSelection().each(function (selection) {\n            clipboard.setColumns(selection);\n            actOnSelection(actions.deleteColumn);\n          });\n        },\n        mceTableCutRow: function () {\n          return copyRowSelection().each(function (selection) {\n            clipboard.setRows(selection);\n            actOnSelection(actions.deleteRow);\n          });\n        },\n        mceTableCopyCol: function () {\n          return copyColSelection().each(function (selection) {\n            return clipboard.setColumns(selection);\n          });\n        },\n        mceTableCopyRow: function () {\n          return copyRowSelection().each(function (selection) {\n            return clipboard.setRows(selection);\n          });\n        },\n        mceTablePasteColBefore: function () {\n          return pasteOnSelection(actions.pasteColsBefore, clipboard.getColumns);\n        },\n        mceTablePasteColAfter: function () {\n          return pasteOnSelection(actions.pasteColsAfter, clipboard.getColumns);\n        },\n        mceTablePasteRowBefore: function () {\n          return pasteOnSelection(actions.pasteRowsBefore, clipboard.getRows);\n        },\n        mceTablePasteRowAfter: function () {\n          return pasteOnSelection(actions.pasteRowsAfter, clipboard.getRows);\n        },\n        mceTableDelete: eraseTable,\n        mceTableCellToggleClass: toggleTableCellClass,\n        mceTableToggleClass: toggleTableClass,\n        mceTableToggleCaption: toggleCaption,\n        mceTableSizingMode: function (_ui, sizing) {\n          return setSizingMode(sizing);\n        },\n        mceTableCellType: actOnType(function (type) {\n          return type === 'th' ? actions.makeCellsHeader : actions.unmakeCellsHeader;\n        }),\n        mceTableColType: actOnType(function (type) {\n          return type === 'th' ? actions.makeColumnsHeader : actions.unmakeColumnsHeader;\n        }),\n        mceTableRowType: actOnType(function (type) {\n          switch (type) {\n          case 'header':\n            return actions.makeRowsHeader;\n          case 'footer':\n            return actions.makeRowsFooter;\n          default:\n            return actions.makeRowsBody;\n          }\n        })\n      }, function (func, name) {\n        return editor.addCommand(name, func);\n      });\n      each$1({\n        mceTableProps: curry(open, editor, false),\n        mceTableRowProps: curry(open$1, editor),\n        mceTableCellProps: curry(open$2, editor, selections)\n      }, function (func, name) {\n        return editor.addCommand(name, function () {\n          return func();\n        });\n      });\n      editor.addCommand('mceInsertTable', function (_ui, args) {\n        if (isObject(args) && keys(args).length > 0) {\n          insertTableWithDataValidation(editor, args.rows, args.columns, args.options, 'Invalid values for mceInsertTable - rows and columns values are required to insert a table.');\n        } else {\n          open(editor, true);\n        }\n      });\n      editor.addCommand('mceTableApplyCellStyle', function (_ui, args) {\n        var getFormatName = function (style) {\n          return 'tablecell' + style.toLowerCase().replace('-', '');\n        };\n        if (!isObject(args)) {\n          return;\n        }\n        var cells = getCellsFromSelection(selections);\n        if (cells.length === 0) {\n          return;\n        }\n        var validArgs = filter$1(args, function (value, style) {\n          return editor.formatter.has(getFormatName(style)) && isString(value);\n        });\n        if (isEmpty(validArgs)) {\n          return;\n        }\n        each$1(validArgs, function (value, style) {\n          each$2(cells, function (cell) {\n            DomModifier.normal(editor, cell.dom).setFormat(getFormatName(style), value);\n          });\n        });\n        getTableFromCell(cells[0]).each(function (table) {\n          return fireTableModified(editor, table.dom, styleModified);\n        });\n      });\n    };\n\n    var registerQueryCommands = function (editor, actions, selections) {\n      var isRoot = getIsRoot(editor);\n      var lookupOnSelection = function (action) {\n        return getSelectionCell(getSelectionStart(editor)).bind(function (cell) {\n          return table(cell, isRoot).map(function (table) {\n            var targets = forMenu(selections, table, cell);\n            return action(table, targets);\n          });\n        }).getOr('');\n      };\n      each$1({\n        mceTableRowType: function () {\n          return lookupOnSelection(actions.getTableRowType);\n        },\n        mceTableCellType: function () {\n          return lookupOnSelection(actions.getTableCellType);\n        },\n        mceTableColType: function () {\n          return lookupOnSelection(actions.getTableColType);\n        }\n      }, function (func, name) {\n        return editor.addQueryValueHandler(name, func);\n      });\n    };\n\n    var Clipboard = function () {\n      var rows = value();\n      var cols = value();\n      return {\n        getRows: rows.get,\n        setRows: function (r) {\n          r.fold(rows.clear, rows.set);\n          cols.clear();\n        },\n        clearRows: rows.clear,\n        getColumns: cols.get,\n        setColumns: function (c) {\n          c.fold(cols.clear, cols.set);\n          rows.clear();\n        },\n        clearColumns: cols.clear\n      };\n    };\n\n    var genericBase = {\n      remove_similar: true,\n      inherit: false\n    };\n    var cellBase = __assign({ selector: 'td,th' }, genericBase);\n    var cellFormats = {\n      tablecellbackgroundcolor: __assign({ styles: { backgroundColor: '%value' } }, cellBase),\n      tablecellverticalalign: __assign({ styles: { 'vertical-align': '%value' } }, cellBase),\n      tablecellbordercolor: __assign({ styles: { borderColor: '%value' } }, cellBase),\n      tablecellclass: __assign({ classes: ['%value'] }, cellBase),\n      tableclass: __assign({\n        selector: 'table',\n        classes: ['%value']\n      }, genericBase),\n      tablecellborderstyle: __assign({ styles: { borderStyle: '%value' } }, cellBase),\n      tablecellborderwidth: __assign({ styles: { borderWidth: '%value' } }, cellBase)\n    };\n    var registerFormats = function (editor) {\n      editor.formatter.register(cellFormats);\n    };\n\n    var adt$5 = Adt.generate([\n      { none: ['current'] },\n      { first: ['current'] },\n      {\n        middle: [\n          'current',\n          'target'\n        ]\n      },\n      { last: ['current'] }\n    ]);\n    var none = function (current) {\n      if (current === void 0) {\n        current = undefined;\n      }\n      return adt$5.none(current);\n    };\n    var CellLocation = __assign(__assign({}, adt$5), { none: none });\n\n    var walk = function (all, current, index, direction, isEligible) {\n      if (isEligible === void 0) {\n        isEligible = always;\n      }\n      var forwards = direction === 1;\n      if (!forwards && index <= 0) {\n        return CellLocation.first(all[0]);\n      } else if (forwards && index >= all.length - 1) {\n        return CellLocation.last(all[all.length - 1]);\n      } else {\n        var newIndex = index + direction;\n        var elem = all[newIndex];\n        return isEligible(elem) ? CellLocation.middle(current, elem) : walk(all, current, newIndex, direction, isEligible);\n      }\n    };\n    var detect$1 = function (current, isRoot) {\n      return table(current, isRoot).bind(function (table) {\n        var all = cells$1(table);\n        var index = findIndex(all, function (x) {\n          return eq$1(current, x);\n        });\n        return index.map(function (index) {\n          return {\n            index: index,\n            all: all\n          };\n        });\n      });\n    };\n    var next = function (current, isEligible, isRoot) {\n      var detection = detect$1(current, isRoot);\n      return detection.fold(function () {\n        return CellLocation.none(current);\n      }, function (info) {\n        return walk(info.all, current, info.index, 1, isEligible);\n      });\n    };\n    var prev = function (current, isEligible, isRoot) {\n      var detection = detect$1(current, isRoot);\n      return detection.fold(function () {\n        return CellLocation.none();\n      }, function (info) {\n        return walk(info.all, current, info.index, -1, isEligible);\n      });\n    };\n\n    var create$2 = function (start, soffset, finish, foffset) {\n      return {\n        start: start,\n        soffset: soffset,\n        finish: finish,\n        foffset: foffset\n      };\n    };\n    var SimRange = { create: create$2 };\n\n    var adt$4 = Adt.generate([\n      { before: ['element'] },\n      {\n        on: [\n          'element',\n          'offset'\n        ]\n      },\n      { after: ['element'] }\n    ]);\n    var cata$1 = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n    var getStart$1 = function (situ) {\n      return situ.fold(identity, identity, identity);\n    };\n    var before$2 = adt$4.before;\n    var on = adt$4.on;\n    var after$3 = adt$4.after;\n    var Situ = {\n      before: before$2,\n      on: on,\n      after: after$3,\n      cata: cata$1,\n      getStart: getStart$1\n    };\n\n    var adt$3 = Adt.generate([\n      { domRange: ['rng'] },\n      {\n        relative: [\n          'startSitu',\n          'finishSitu'\n        ]\n      },\n      {\n        exact: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var exactFromRange = function (simRange) {\n      return adt$3.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n    };\n    var getStart = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return SugarElement.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, _finishSitu) {\n          return Situ.getStart(startSitu);\n        },\n        exact: function (start, _soffset, _finish, _foffset) {\n          return start;\n        }\n      });\n    };\n    var domRange = adt$3.domRange;\n    var relative = adt$3.relative;\n    var exact = adt$3.exact;\n    var getWin = function (selection) {\n      var start = getStart(selection);\n      return defaultView(start);\n    };\n    var range = SimRange.create;\n    var SimSelection = {\n      domRange: domRange,\n      relative: relative,\n      exact: exact,\n      exactFromRange: exactFromRange,\n      getWin: getWin,\n      range: range\n    };\n\n    var selectNode = function (win, element) {\n      var rng = win.document.createRange();\n      rng.selectNode(element.dom);\n      return rng;\n    };\n    var selectNodeContents = function (win, element) {\n      var rng = win.document.createRange();\n      selectNodeContentsUsing(rng, element);\n      return rng;\n    };\n    var selectNodeContentsUsing = function (rng, element) {\n      return rng.selectNodeContents(element.dom);\n    };\n    var setStart = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setStartBefore(e.dom);\n      }, function (e, o) {\n        rng.setStart(e.dom, o);\n      }, function (e) {\n        rng.setStartAfter(e.dom);\n      });\n    };\n    var setFinish = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setEndBefore(e.dom);\n      }, function (e, o) {\n        rng.setEnd(e.dom, o);\n      }, function (e) {\n        rng.setEndAfter(e.dom);\n      });\n    };\n    var relativeToNative = function (win, startSitu, finishSitu) {\n      var range = win.document.createRange();\n      setStart(range, startSitu);\n      setFinish(range, finishSitu);\n      return range;\n    };\n    var exactToNative = function (win, start, soffset, finish, foffset) {\n      var rng = win.document.createRange();\n      rng.setStart(start.dom, soffset);\n      rng.setEnd(finish.dom, foffset);\n      return rng;\n    };\n    var toRect = function (rect) {\n      return {\n        left: rect.left,\n        top: rect.top,\n        right: rect.right,\n        bottom: rect.bottom,\n        width: rect.width,\n        height: rect.height\n      };\n    };\n    var getFirstRect$1 = function (rng) {\n      var rects = rng.getClientRects();\n      var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n      return rect.width > 0 || rect.height > 0 ? Optional.some(rect).map(toRect) : Optional.none();\n    };\n\n    var adt$2 = Adt.generate([\n      {\n        ltr: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      },\n      {\n        rtl: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var fromRange = function (win, type, range) {\n      return type(SugarElement.fromDom(range.startContainer), range.startOffset, SugarElement.fromDom(range.endContainer), range.endOffset);\n    };\n    var getRanges = function (win, selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return {\n            ltr: constant(rng),\n            rtl: Optional.none\n          };\n        },\n        relative: function (startSitu, finishSitu) {\n          return {\n            ltr: cached(function () {\n              return relativeToNative(win, startSitu, finishSitu);\n            }),\n            rtl: cached(function () {\n              return Optional.some(relativeToNative(win, finishSitu, startSitu));\n            })\n          };\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return {\n            ltr: cached(function () {\n              return exactToNative(win, start, soffset, finish, foffset);\n            }),\n            rtl: cached(function () {\n              return Optional.some(exactToNative(win, finish, foffset, start, soffset));\n            })\n          };\n        }\n      });\n    };\n    var doDiagnose = function (win, ranges) {\n      var rng = ranges.ltr();\n      if (rng.collapsed) {\n        var reversed = ranges.rtl().filter(function (rev) {\n          return rev.collapsed === false;\n        });\n        return reversed.map(function (rev) {\n          return adt$2.rtl(SugarElement.fromDom(rev.endContainer), rev.endOffset, SugarElement.fromDom(rev.startContainer), rev.startOffset);\n        }).getOrThunk(function () {\n          return fromRange(win, adt$2.ltr, rng);\n        });\n      } else {\n        return fromRange(win, adt$2.ltr, rng);\n      }\n    };\n    var diagnose = function (win, selection) {\n      var ranges = getRanges(win, selection);\n      return doDiagnose(win, ranges);\n    };\n    var asLtrRange = function (win, selection) {\n      var diagnosis = diagnose(win, selection);\n      return diagnosis.match({\n        ltr: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(start.dom, soffset);\n          rng.setEnd(finish.dom, foffset);\n          return rng;\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(finish.dom, foffset);\n          rng.setEnd(start.dom, soffset);\n          return rng;\n        }\n      });\n    };\n    adt$2.ltr;\n    adt$2.rtl;\n\n    var searchForPoint = function (rectForOffset, x, y, maxX, length) {\n      if (length === 0) {\n        return 0;\n      } else if (x === maxX) {\n        return length - 1;\n      }\n      var xDelta = maxX;\n      for (var i = 1; i < length; i++) {\n        var rect = rectForOffset(i);\n        var curDeltaX = Math.abs(x - rect.left);\n        if (y <= rect.bottom) {\n          if (y < rect.top || curDeltaX > xDelta) {\n            return i - 1;\n          } else {\n            xDelta = curDeltaX;\n          }\n        }\n      }\n      return 0;\n    };\n    var inRect = function (rect, x, y) {\n      return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;\n    };\n\n    var locateOffset = function (doc, textnode, x, y, rect) {\n      var rangeForOffset = function (o) {\n        var r = doc.dom.createRange();\n        r.setStart(textnode.dom, o);\n        r.collapse(true);\n        return r;\n      };\n      var rectForOffset = function (o) {\n        var r = rangeForOffset(o);\n        return r.getBoundingClientRect();\n      };\n      var length = get$9(textnode).length;\n      var offset = searchForPoint(rectForOffset, x, y, rect.right, length);\n      return rangeForOffset(offset);\n    };\n    var locate$1 = function (doc, node, x, y) {\n      var r = doc.dom.createRange();\n      r.selectNode(node.dom);\n      var rects = r.getClientRects();\n      var foundRect = findMap(rects, function (rect) {\n        return inRect(rect, x, y) ? Optional.some(rect) : Optional.none();\n      });\n      return foundRect.map(function (rect) {\n        return locateOffset(doc, node, x, y, rect);\n      });\n    };\n\n    var searchInChildren = function (doc, node, x, y) {\n      var r = doc.dom.createRange();\n      var nodes = children$3(node);\n      return findMap(nodes, function (n) {\n        r.selectNode(n.dom);\n        return inRect(r.getBoundingClientRect(), x, y) ? locateNode(doc, n, x, y) : Optional.none();\n      });\n    };\n    var locateNode = function (doc, node, x, y) {\n      return isText(node) ? locate$1(doc, node, x, y) : searchInChildren(doc, node, x, y);\n    };\n    var locate = function (doc, node, x, y) {\n      var r = doc.dom.createRange();\n      r.selectNode(node.dom);\n      var rect = r.getBoundingClientRect();\n      var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n      var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n      return locateNode(doc, node, boundedX, boundedY);\n    };\n\n    var COLLAPSE_TO_LEFT = true;\n    var COLLAPSE_TO_RIGHT = false;\n    var getCollapseDirection = function (rect, x) {\n      return x - rect.left < rect.right - x ? COLLAPSE_TO_LEFT : COLLAPSE_TO_RIGHT;\n    };\n    var createCollapsedNode = function (doc, target, collapseDirection) {\n      var r = doc.dom.createRange();\n      r.selectNode(target.dom);\n      r.collapse(collapseDirection);\n      return r;\n    };\n    var locateInElement = function (doc, node, x) {\n      var cursorRange = doc.dom.createRange();\n      cursorRange.selectNode(node.dom);\n      var rect = cursorRange.getBoundingClientRect();\n      var collapseDirection = getCollapseDirection(rect, x);\n      var f = collapseDirection === COLLAPSE_TO_LEFT ? first : last$1;\n      return f(node).map(function (target) {\n        return createCollapsedNode(doc, target, collapseDirection);\n      });\n    };\n    var locateInEmpty = function (doc, node, x) {\n      var rect = node.dom.getBoundingClientRect();\n      var collapseDirection = getCollapseDirection(rect, x);\n      return Optional.some(createCollapsedNode(doc, node, collapseDirection));\n    };\n    var search = function (doc, node, x) {\n      var f = children$3(node).length === 0 ? locateInEmpty : locateInElement;\n      return f(doc, node, x);\n    };\n\n    var caretPositionFromPoint = function (doc, x, y) {\n      var _a, _b;\n      return Optional.from((_b = (_a = doc.dom).caretPositionFromPoint) === null || _b === void 0 ? void 0 : _b.call(_a, x, y)).bind(function (pos) {\n        if (pos.offsetNode === null) {\n          return Optional.none();\n        }\n        var r = doc.dom.createRange();\n        r.setStart(pos.offsetNode, pos.offset);\n        r.collapse();\n        return Optional.some(r);\n      });\n    };\n    var caretRangeFromPoint = function (doc, x, y) {\n      var _a, _b;\n      return Optional.from((_b = (_a = doc.dom).caretRangeFromPoint) === null || _b === void 0 ? void 0 : _b.call(_a, x, y));\n    };\n    var searchTextNodes = function (doc, node, x, y) {\n      var r = doc.dom.createRange();\n      r.selectNode(node.dom);\n      var rect = r.getBoundingClientRect();\n      var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n      var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n      return locate(doc, node, boundedX, boundedY);\n    };\n    var searchFromPoint = function (doc, x, y) {\n      return SugarElement.fromPoint(doc, x, y).bind(function (elem) {\n        var fallback = function () {\n          return search(doc, elem, x);\n        };\n        return children$3(elem).length === 0 ? fallback() : searchTextNodes(doc, elem, x, y).orThunk(fallback);\n      });\n    };\n    var availableSearch = function () {\n      if (document.caretPositionFromPoint) {\n        return caretPositionFromPoint;\n      } else if (document.caretRangeFromPoint) {\n        return caretRangeFromPoint;\n      } else {\n        return searchFromPoint;\n      }\n    }();\n    var fromPoint = function (win, x, y) {\n      var doc = SugarElement.fromDom(win.document);\n      return availableSearch(doc, x, y).map(function (rng) {\n        return SimRange.create(SugarElement.fromDom(rng.startContainer), rng.startOffset, SugarElement.fromDom(rng.endContainer), rng.endOffset);\n      });\n    };\n\n    var beforeSpecial = function (element, offset) {\n      var name$1 = name(element);\n      if ('input' === name$1) {\n        return Situ.after(element);\n      } else if (!contains$2([\n          'br',\n          'img'\n        ], name$1)) {\n        return Situ.on(element, offset);\n      } else {\n        return offset === 0 ? Situ.before(element) : Situ.after(element);\n      }\n    };\n    var preprocessRelative = function (startSitu, finishSitu) {\n      var start = startSitu.fold(Situ.before, beforeSpecial, Situ.after);\n      var finish = finishSitu.fold(Situ.before, beforeSpecial, Situ.after);\n      return SimSelection.relative(start, finish);\n    };\n    var preprocessExact = function (start, soffset, finish, foffset) {\n      var startSitu = beforeSpecial(start, soffset);\n      var finishSitu = beforeSpecial(finish, foffset);\n      return SimSelection.relative(startSitu, finishSitu);\n    };\n    var preprocess = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          var start = SugarElement.fromDom(rng.startContainer);\n          var finish = SugarElement.fromDom(rng.endContainer);\n          return preprocessExact(start, rng.startOffset, finish, rng.endOffset);\n        },\n        relative: preprocessRelative,\n        exact: preprocessExact\n      });\n    };\n\n    var makeRange = function (start, soffset, finish, foffset) {\n      var doc = owner(start);\n      var rng = doc.dom.createRange();\n      rng.setStart(start.dom, soffset);\n      rng.setEnd(finish.dom, foffset);\n      return rng;\n    };\n    var after$2 = function (start, soffset, finish, foffset) {\n      var r = makeRange(start, soffset, finish, foffset);\n      var same = eq$1(start, finish) && soffset === foffset;\n      return r.collapsed && !same;\n    };\n\n    var getNativeSelection = function (win) {\n      return Optional.from(win.getSelection());\n    };\n    var doSetNativeRange = function (win, rng) {\n      getNativeSelection(win).each(function (selection) {\n        selection.removeAllRanges();\n        selection.addRange(rng);\n      });\n    };\n    var doSetRange = function (win, start, soffset, finish, foffset) {\n      var rng = exactToNative(win, start, soffset, finish, foffset);\n      doSetNativeRange(win, rng);\n    };\n    var setLegacyRtlRange = function (win, selection, start, soffset, finish, foffset) {\n      selection.collapse(start.dom, soffset);\n      selection.extend(finish.dom, foffset);\n    };\n    var setRangeFromRelative = function (win, relative) {\n      return diagnose(win, relative).match({\n        ltr: function (start, soffset, finish, foffset) {\n          doSetRange(win, start, soffset, finish, foffset);\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          getNativeSelection(win).each(function (selection) {\n            if (selection.setBaseAndExtent) {\n              selection.setBaseAndExtent(start.dom, soffset, finish.dom, foffset);\n            } else if (selection.extend) {\n              try {\n                setLegacyRtlRange(win, selection, start, soffset, finish, foffset);\n              } catch (e) {\n                doSetRange(win, finish, foffset, start, soffset);\n              }\n            } else {\n              doSetRange(win, finish, foffset, start, soffset);\n            }\n          });\n        }\n      });\n    };\n    var setExact = function (win, start, soffset, finish, foffset) {\n      var relative = preprocessExact(start, soffset, finish, foffset);\n      setRangeFromRelative(win, relative);\n    };\n    var setRelative = function (win, startSitu, finishSitu) {\n      var relative = preprocessRelative(startSitu, finishSitu);\n      setRangeFromRelative(win, relative);\n    };\n    var toNative = function (selection) {\n      var win = SimSelection.getWin(selection).dom;\n      var getDomRange = function (start, soffset, finish, foffset) {\n        return exactToNative(win, start, soffset, finish, foffset);\n      };\n      var filtered = preprocess(selection);\n      return diagnose(win, filtered).match({\n        ltr: getDomRange,\n        rtl: getDomRange\n      });\n    };\n    var readRange = function (selection) {\n      if (selection.rangeCount > 0) {\n        var firstRng = selection.getRangeAt(0);\n        var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n        return Optional.some(SimRange.create(SugarElement.fromDom(firstRng.startContainer), firstRng.startOffset, SugarElement.fromDom(lastRng.endContainer), lastRng.endOffset));\n      } else {\n        return Optional.none();\n      }\n    };\n    var doGetExact = function (selection) {\n      if (selection.anchorNode === null || selection.focusNode === null) {\n        return readRange(selection);\n      } else {\n        var anchor = SugarElement.fromDom(selection.anchorNode);\n        var focus_1 = SugarElement.fromDom(selection.focusNode);\n        return after$2(anchor, selection.anchorOffset, focus_1, selection.focusOffset) ? Optional.some(SimRange.create(anchor, selection.anchorOffset, focus_1, selection.focusOffset)) : readRange(selection);\n      }\n    };\n    var setToElement = function (win, element, selectNodeContents$1) {\n      if (selectNodeContents$1 === void 0) {\n        selectNodeContents$1 = true;\n      }\n      var rngGetter = selectNodeContents$1 ? selectNodeContents : selectNode;\n      var rng = rngGetter(win, element);\n      doSetNativeRange(win, rng);\n    };\n    var getExact = function (win) {\n      return getNativeSelection(win).filter(function (sel) {\n        return sel.rangeCount > 0;\n      }).bind(doGetExact);\n    };\n    var get$1 = function (win) {\n      return getExact(win).map(function (range) {\n        return SimSelection.exact(range.start, range.soffset, range.finish, range.foffset);\n      });\n    };\n    var getFirstRect = function (win, selection) {\n      var rng = asLtrRange(win, selection);\n      return getFirstRect$1(rng);\n    };\n    var getAtPoint = function (win, x, y) {\n      return fromPoint(win, x, y);\n    };\n    var clear = function (win) {\n      getNativeSelection(win).each(function (selection) {\n        return selection.removeAllRanges();\n      });\n    };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var forward = function (editor, isRoot, cell) {\n      return go$1(editor, isRoot, next(cell, isEditable$1));\n    };\n    var backward = function (editor, isRoot, cell) {\n      return go$1(editor, isRoot, prev(cell, isEditable$1));\n    };\n    var getCellFirstCursorPosition = function (editor, cell) {\n      var selection = SimSelection.exact(cell, 0, cell, 0);\n      return toNative(selection);\n    };\n    var go$1 = function (editor, isRoot, cell) {\n      return cell.fold(Optional.none, Optional.none, function (current, next) {\n        return first(next).map(function (cell) {\n          return getCellFirstCursorPosition(editor, cell);\n        });\n      }, function (current) {\n        editor.execCommand('mceTableInsertRowAfter');\n        return forward(editor, isRoot, current);\n      });\n    };\n    var rootElements = [\n      'table',\n      'li',\n      'dl'\n    ];\n    var handle$1 = function (event, editor, cellSelection) {\n      if (event.keyCode === global$1.TAB) {\n        var body_1 = getBody(editor);\n        var isRoot_1 = function (element) {\n          var name$1 = name(element);\n          return eq$1(element, body_1) || contains$2(rootElements, name$1);\n        };\n        var rng = editor.selection.getRng();\n        var container = SugarElement.fromDom(event.shiftKey ? rng.startContainer : rng.endContainer);\n        cell(container, isRoot_1).each(function (cell) {\n          event.preventDefault();\n          table(cell, isRoot_1).each(cellSelection.clear);\n          editor.selection.collapse(event.shiftKey);\n          var navigation = event.shiftKey ? backward : forward;\n          var rng = navigation(editor, isRoot_1, cell);\n          rng.each(function (range) {\n            editor.selection.setRng(range);\n          });\n        });\n      }\n    };\n\n    var create$1 = function (selection, kill) {\n      return {\n        selection: selection,\n        kill: kill\n      };\n    };\n    var Response = { create: create$1 };\n\n    var create = function (start, soffset, finish, foffset) {\n      return {\n        start: Situ.on(start, soffset),\n        finish: Situ.on(finish, foffset)\n      };\n    };\n    var Situs = { create: create };\n\n    var convertToRange = function (win, selection) {\n      var rng = asLtrRange(win, selection);\n      return SimRange.create(SugarElement.fromDom(rng.startContainer), rng.startOffset, SugarElement.fromDom(rng.endContainer), rng.endOffset);\n    };\n    var makeSitus = Situs.create;\n\n    var sync = function (container, isRoot, start, soffset, finish, foffset, selectRange) {\n      if (!(eq$1(start, finish) && soffset === foffset)) {\n        return closest$1(start, 'td,th', isRoot).bind(function (s) {\n          return closest$1(finish, 'td,th', isRoot).bind(function (f) {\n            return detect(container, isRoot, s, f, selectRange);\n          });\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n    var detect = function (container, isRoot, start, finish, selectRange) {\n      if (!eq$1(start, finish)) {\n        return identify(start, finish, isRoot).bind(function (cellSel) {\n          var boxes = cellSel.boxes.getOr([]);\n          if (boxes.length > 1) {\n            selectRange(container, boxes, cellSel.start, cellSel.finish);\n            return Optional.some(Response.create(Optional.some(makeSitus(start, 0, start, getEnd(start))), true));\n          } else {\n            return Optional.none();\n          }\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n    var update = function (rows, columns, container, selected, annotations) {\n      var updateSelection = function (newSels) {\n        annotations.clearBeforeUpdate(container);\n        annotations.selectRange(container, newSels.boxes, newSels.start, newSels.finish);\n        return newSels.boxes;\n      };\n      return shiftSelection(selected, rows, columns, annotations.firstSelectedSelector, annotations.lastSelectedSelector).map(updateSelection);\n    };\n\n    var traverse = function (item, mode) {\n      return {\n        item: item,\n        mode: mode\n      };\n    };\n    var backtrack = function (universe, item, _direction, transition) {\n      if (transition === void 0) {\n        transition = sidestep;\n      }\n      return universe.property().parent(item).map(function (p) {\n        return traverse(p, transition);\n      });\n    };\n    var sidestep = function (universe, item, direction, transition) {\n      if (transition === void 0) {\n        transition = advance;\n      }\n      return direction.sibling(universe, item).map(function (p) {\n        return traverse(p, transition);\n      });\n    };\n    var advance = function (universe, item, direction, transition) {\n      if (transition === void 0) {\n        transition = advance;\n      }\n      var children = universe.property().children(item);\n      var result = direction.first(children);\n      return result.map(function (r) {\n        return traverse(r, transition);\n      });\n    };\n    var successors = [\n      {\n        current: backtrack,\n        next: sidestep,\n        fallback: Optional.none()\n      },\n      {\n        current: sidestep,\n        next: advance,\n        fallback: Optional.some(backtrack)\n      },\n      {\n        current: advance,\n        next: advance,\n        fallback: Optional.some(sidestep)\n      }\n    ];\n    var go = function (universe, item, mode, direction, rules) {\n      if (rules === void 0) {\n        rules = successors;\n      }\n      var ruleOpt = find$1(rules, function (succ) {\n        return succ.current === mode;\n      });\n      return ruleOpt.bind(function (rule) {\n        return rule.current(universe, item, direction, rule.next).orThunk(function () {\n          return rule.fallback.bind(function (fb) {\n            return go(universe, item, fb, direction);\n          });\n        });\n      });\n    };\n\n    var left$1 = function () {\n      var sibling = function (universe, item) {\n        return universe.query().prevSibling(item);\n      };\n      var first = function (children) {\n        return children.length > 0 ? Optional.some(children[children.length - 1]) : Optional.none();\n      };\n      return {\n        sibling: sibling,\n        first: first\n      };\n    };\n    var right$1 = function () {\n      var sibling = function (universe, item) {\n        return universe.query().nextSibling(item);\n      };\n      var first = function (children) {\n        return children.length > 0 ? Optional.some(children[0]) : Optional.none();\n      };\n      return {\n        sibling: sibling,\n        first: first\n      };\n    };\n    var Walkers = {\n      left: left$1,\n      right: right$1\n    };\n\n    var hone = function (universe, item, predicate, mode, direction, isRoot) {\n      var next = go(universe, item, mode, direction);\n      return next.bind(function (n) {\n        if (isRoot(n.item)) {\n          return Optional.none();\n        } else {\n          return predicate(n.item) ? Optional.some(n.item) : hone(universe, n.item, predicate, n.mode, direction, isRoot);\n        }\n      });\n    };\n    var left = function (universe, item, predicate, isRoot) {\n      return hone(universe, item, predicate, sidestep, Walkers.left(), isRoot);\n    };\n    var right = function (universe, item, predicate, isRoot) {\n      return hone(universe, item, predicate, sidestep, Walkers.right(), isRoot);\n    };\n\n    var isLeaf = function (universe) {\n      return function (element) {\n        return universe.property().children(element).length === 0;\n      };\n    };\n    var before$1 = function (universe, item, isRoot) {\n      return seekLeft$1(universe, item, isLeaf(universe), isRoot);\n    };\n    var after$1 = function (universe, item, isRoot) {\n      return seekRight$1(universe, item, isLeaf(universe), isRoot);\n    };\n    var seekLeft$1 = left;\n    var seekRight$1 = right;\n\n    var universe = DomUniverse();\n    var before = function (element, isRoot) {\n      return before$1(universe, element, isRoot);\n    };\n    var after = function (element, isRoot) {\n      return after$1(universe, element, isRoot);\n    };\n    var seekLeft = function (element, predicate, isRoot) {\n      return seekLeft$1(universe, element, predicate, isRoot);\n    };\n    var seekRight = function (element, predicate, isRoot) {\n      return seekRight$1(universe, element, predicate, isRoot);\n    };\n\n    var ancestor = function (scope, predicate, isRoot) {\n      return ancestor$2(scope, predicate, isRoot).isSome();\n    };\n\n    var adt$1 = Adt.generate([\n      { none: ['message'] },\n      { success: [] },\n      { failedUp: ['cell'] },\n      { failedDown: ['cell'] }\n    ]);\n    var isOverlapping = function (bridge, before, after) {\n      var beforeBounds = bridge.getRect(before);\n      var afterBounds = bridge.getRect(after);\n      return afterBounds.right > beforeBounds.left && afterBounds.left < beforeBounds.right;\n    };\n    var isRow = function (elem) {\n      return closest$1(elem, 'tr');\n    };\n    var verify = function (bridge, before, beforeOffset, after, afterOffset, failure, isRoot) {\n      return closest$1(after, 'td,th', isRoot).bind(function (afterCell) {\n        return closest$1(before, 'td,th', isRoot).map(function (beforeCell) {\n          if (!eq$1(afterCell, beforeCell)) {\n            return sharedOne(isRow, [\n              afterCell,\n              beforeCell\n            ]).fold(function () {\n              return isOverlapping(bridge, beforeCell, afterCell) ? adt$1.success() : failure(beforeCell);\n            }, function (_sharedRow) {\n              return failure(beforeCell);\n            });\n          } else {\n            return eq$1(after, afterCell) && getEnd(afterCell) === afterOffset ? failure(beforeCell) : adt$1.none('in same cell');\n          }\n        });\n      }).getOr(adt$1.none('default'));\n    };\n    var cata = function (subject, onNone, onSuccess, onFailedUp, onFailedDown) {\n      return subject.fold(onNone, onSuccess, onFailedUp, onFailedDown);\n    };\n    var BeforeAfter = __assign(__assign({}, adt$1), {\n      verify: verify,\n      cata: cata\n    });\n\n    var inParent = function (parent, children, element, index) {\n      return {\n        parent: parent,\n        children: children,\n        element: element,\n        index: index\n      };\n    };\n    var indexInParent = function (element) {\n      return parent(element).bind(function (parent) {\n        var children = children$3(parent);\n        return indexOf(children, element).map(function (index) {\n          return inParent(parent, children, element, index);\n        });\n      });\n    };\n    var indexOf = function (elements, element) {\n      return findIndex(elements, curry(eq$1, element));\n    };\n\n    var isBr = function (elem) {\n      return name(elem) === 'br';\n    };\n    var gatherer = function (cand, gather, isRoot) {\n      return gather(cand, isRoot).bind(function (target) {\n        return isText(target) && get$9(target).trim().length === 0 ? gatherer(target, gather, isRoot) : Optional.some(target);\n      });\n    };\n    var handleBr = function (isRoot, element, direction) {\n      return direction.traverse(element).orThunk(function () {\n        return gatherer(element, direction.gather, isRoot);\n      }).map(direction.relative);\n    };\n    var findBr = function (element, offset) {\n      return child$3(element, offset).filter(isBr).orThunk(function () {\n        return child$3(element, offset - 1).filter(isBr);\n      });\n    };\n    var handleParent = function (isRoot, element, offset, direction) {\n      return findBr(element, offset).bind(function (br) {\n        return direction.traverse(br).fold(function () {\n          return gatherer(br, direction.gather, isRoot).map(direction.relative);\n        }, function (adjacent) {\n          return indexInParent(adjacent).map(function (info) {\n            return Situ.on(info.parent, info.index);\n          });\n        });\n      });\n    };\n    var tryBr = function (isRoot, element, offset, direction) {\n      var target = isBr(element) ? handleBr(isRoot, element, direction) : handleParent(isRoot, element, offset, direction);\n      return target.map(function (tgt) {\n        return {\n          start: tgt,\n          finish: tgt\n        };\n      });\n    };\n    var process = function (analysis) {\n      return BeforeAfter.cata(analysis, function (_message) {\n        return Optional.none();\n      }, function () {\n        return Optional.none();\n      }, function (cell) {\n        return Optional.some(point(cell, 0));\n      }, function (cell) {\n        return Optional.some(point(cell, getEnd(cell)));\n      });\n    };\n\n    var moveDown = function (caret, amount) {\n      return {\n        left: caret.left,\n        top: caret.top + amount,\n        right: caret.right,\n        bottom: caret.bottom + amount\n      };\n    };\n    var moveUp = function (caret, amount) {\n      return {\n        left: caret.left,\n        top: caret.top - amount,\n        right: caret.right,\n        bottom: caret.bottom - amount\n      };\n    };\n    var translate = function (caret, xDelta, yDelta) {\n      return {\n        left: caret.left + xDelta,\n        top: caret.top + yDelta,\n        right: caret.right + xDelta,\n        bottom: caret.bottom + yDelta\n      };\n    };\n    var getTop = function (caret) {\n      return caret.top;\n    };\n    var getBottom = function (caret) {\n      return caret.bottom;\n    };\n\n    var getPartialBox = function (bridge, element, offset) {\n      if (offset >= 0 && offset < getEnd(element)) {\n        return bridge.getRangedRect(element, offset, element, offset + 1);\n      } else if (offset > 0) {\n        return bridge.getRangedRect(element, offset - 1, element, offset);\n      }\n      return Optional.none();\n    };\n    var toCaret = function (rect) {\n      return {\n        left: rect.left,\n        top: rect.top,\n        right: rect.right,\n        bottom: rect.bottom\n      };\n    };\n    var getElemBox = function (bridge, element) {\n      return Optional.some(bridge.getRect(element));\n    };\n    var getBoxAt = function (bridge, element, offset) {\n      if (isElement(element)) {\n        return getElemBox(bridge, element).map(toCaret);\n      } else if (isText(element)) {\n        return getPartialBox(bridge, element, offset).map(toCaret);\n      } else {\n        return Optional.none();\n      }\n    };\n    var getEntireBox = function (bridge, element) {\n      if (isElement(element)) {\n        return getElemBox(bridge, element).map(toCaret);\n      } else if (isText(element)) {\n        return bridge.getRangedRect(element, 0, element, getEnd(element)).map(toCaret);\n      } else {\n        return Optional.none();\n      }\n    };\n\n    var JUMP_SIZE = 5;\n    var NUM_RETRIES = 100;\n    var adt = Adt.generate([\n      { none: [] },\n      { retry: ['caret'] }\n    ]);\n    var isOutside = function (caret, box) {\n      return caret.left < box.left || Math.abs(box.right - caret.left) < 1 || caret.left > box.right;\n    };\n    var inOutsideBlock = function (bridge, element, caret) {\n      return closest$2(element, isBlock).fold(never, function (cell) {\n        return getEntireBox(bridge, cell).exists(function (box) {\n          return isOutside(caret, box);\n        });\n      });\n    };\n    var adjustDown = function (bridge, element, guessBox, original, caret) {\n      var lowerCaret = moveDown(caret, JUMP_SIZE);\n      if (Math.abs(guessBox.bottom - original.bottom) < 1) {\n        return adt.retry(lowerCaret);\n      } else if (guessBox.top > caret.bottom) {\n        return adt.retry(lowerCaret);\n      } else if (guessBox.top === caret.bottom) {\n        return adt.retry(moveDown(caret, 1));\n      } else {\n        return inOutsideBlock(bridge, element, caret) ? adt.retry(translate(lowerCaret, JUMP_SIZE, 0)) : adt.none();\n      }\n    };\n    var adjustUp = function (bridge, element, guessBox, original, caret) {\n      var higherCaret = moveUp(caret, JUMP_SIZE);\n      if (Math.abs(guessBox.top - original.top) < 1) {\n        return adt.retry(higherCaret);\n      } else if (guessBox.bottom < caret.top) {\n        return adt.retry(higherCaret);\n      } else if (guessBox.bottom === caret.top) {\n        return adt.retry(moveUp(caret, 1));\n      } else {\n        return inOutsideBlock(bridge, element, caret) ? adt.retry(translate(higherCaret, JUMP_SIZE, 0)) : adt.none();\n      }\n    };\n    var upMovement = {\n      point: getTop,\n      adjuster: adjustUp,\n      move: moveUp,\n      gather: before\n    };\n    var downMovement = {\n      point: getBottom,\n      adjuster: adjustDown,\n      move: moveDown,\n      gather: after\n    };\n    var isAtTable = function (bridge, x, y) {\n      return bridge.elementFromPoint(x, y).filter(function (elm) {\n        return name(elm) === 'table';\n      }).isSome();\n    };\n    var adjustForTable = function (bridge, movement, original, caret, numRetries) {\n      return adjustTil(bridge, movement, original, movement.move(caret, JUMP_SIZE), numRetries);\n    };\n    var adjustTil = function (bridge, movement, original, caret, numRetries) {\n      if (numRetries === 0) {\n        return Optional.some(caret);\n      }\n      if (isAtTable(bridge, caret.left, movement.point(caret))) {\n        return adjustForTable(bridge, movement, original, caret, numRetries - 1);\n      }\n      return bridge.situsFromPoint(caret.left, movement.point(caret)).bind(function (guess) {\n        return guess.start.fold(Optional.none, function (element) {\n          return getEntireBox(bridge, element).bind(function (guessBox) {\n            return movement.adjuster(bridge, element, guessBox, original, caret).fold(Optional.none, function (newCaret) {\n              return adjustTil(bridge, movement, original, newCaret, numRetries - 1);\n            });\n          }).orThunk(function () {\n            return Optional.some(caret);\n          });\n        }, Optional.none);\n      });\n    };\n    var ieTryDown = function (bridge, caret) {\n      return bridge.situsFromPoint(caret.left, caret.bottom + JUMP_SIZE);\n    };\n    var ieTryUp = function (bridge, caret) {\n      return bridge.situsFromPoint(caret.left, caret.top - JUMP_SIZE);\n    };\n    var checkScroll = function (movement, adjusted, bridge) {\n      if (movement.point(adjusted) > bridge.getInnerHeight()) {\n        return Optional.some(movement.point(adjusted) - bridge.getInnerHeight());\n      } else if (movement.point(adjusted) < 0) {\n        return Optional.some(-movement.point(adjusted));\n      } else {\n        return Optional.none();\n      }\n    };\n    var retry = function (movement, bridge, caret) {\n      var moved = movement.move(caret, JUMP_SIZE);\n      var adjusted = adjustTil(bridge, movement, caret, moved, NUM_RETRIES).getOr(moved);\n      return checkScroll(movement, adjusted, bridge).fold(function () {\n        return bridge.situsFromPoint(adjusted.left, movement.point(adjusted));\n      }, function (delta) {\n        bridge.scrollBy(0, delta);\n        return bridge.situsFromPoint(adjusted.left, movement.point(adjusted) - delta);\n      });\n    };\n    var Retries = {\n      tryUp: curry(retry, upMovement),\n      tryDown: curry(retry, downMovement),\n      ieTryUp: ieTryUp,\n      ieTryDown: ieTryDown,\n      getJumpSize: constant(JUMP_SIZE)\n    };\n\n    var MAX_RETRIES = 20;\n    var findSpot = function (bridge, isRoot, direction) {\n      return bridge.getSelection().bind(function (sel) {\n        return tryBr(isRoot, sel.finish, sel.foffset, direction).fold(function () {\n          return Optional.some(point(sel.finish, sel.foffset));\n        }, function (brNeighbour) {\n          var range = bridge.fromSitus(brNeighbour);\n          var analysis = BeforeAfter.verify(bridge, sel.finish, sel.foffset, range.finish, range.foffset, direction.failure, isRoot);\n          return process(analysis);\n        });\n      });\n    };\n    var scan = function (bridge, isRoot, element, offset, direction, numRetries) {\n      if (numRetries === 0) {\n        return Optional.none();\n      }\n      return tryCursor(bridge, isRoot, element, offset, direction).bind(function (situs) {\n        var range = bridge.fromSitus(situs);\n        var analysis = BeforeAfter.verify(bridge, element, offset, range.finish, range.foffset, direction.failure, isRoot);\n        return BeforeAfter.cata(analysis, function () {\n          return Optional.none();\n        }, function () {\n          return Optional.some(situs);\n        }, function (cell) {\n          if (eq$1(element, cell) && offset === 0) {\n            return tryAgain(bridge, element, offset, moveUp, direction);\n          } else {\n            return scan(bridge, isRoot, cell, 0, direction, numRetries - 1);\n          }\n        }, function (cell) {\n          if (eq$1(element, cell) && offset === getEnd(cell)) {\n            return tryAgain(bridge, element, offset, moveDown, direction);\n          } else {\n            return scan(bridge, isRoot, cell, getEnd(cell), direction, numRetries - 1);\n          }\n        });\n      });\n    };\n    var tryAgain = function (bridge, element, offset, move, direction) {\n      return getBoxAt(bridge, element, offset).bind(function (box) {\n        return tryAt(bridge, direction, move(box, Retries.getJumpSize()));\n      });\n    };\n    var tryAt = function (bridge, direction, box) {\n      var browser = detect$3().browser;\n      if (browser.isChrome() || browser.isSafari() || browser.isFirefox() || browser.isEdge()) {\n        return direction.otherRetry(bridge, box);\n      } else if (browser.isIE()) {\n        return direction.ieRetry(bridge, box);\n      } else {\n        return Optional.none();\n      }\n    };\n    var tryCursor = function (bridge, isRoot, element, offset, direction) {\n      return getBoxAt(bridge, element, offset).bind(function (box) {\n        return tryAt(bridge, direction, box);\n      });\n    };\n    var handle = function (bridge, isRoot, direction) {\n      return findSpot(bridge, isRoot, direction).bind(function (spot) {\n        return scan(bridge, isRoot, spot.element, spot.offset, direction, MAX_RETRIES).map(bridge.fromSitus);\n      });\n    };\n\n    var inSameTable = function (elem, table) {\n      return ancestor(elem, function (e) {\n        return parent(e).exists(function (p) {\n          return eq$1(p, table);\n        });\n      });\n    };\n    var simulate = function (bridge, isRoot, direction, initial, anchor) {\n      return closest$1(initial, 'td,th', isRoot).bind(function (start) {\n        return closest$1(start, 'table', isRoot).bind(function (table) {\n          if (!inSameTable(anchor, table)) {\n            return Optional.none();\n          }\n          return handle(bridge, isRoot, direction).bind(function (range) {\n            return closest$1(range.finish, 'td,th', isRoot).map(function (finish) {\n              return {\n                start: start,\n                finish: finish,\n                range: range\n              };\n            });\n          });\n        });\n      });\n    };\n    var navigate = function (bridge, isRoot, direction, initial, anchor, precheck) {\n      if (detect$3().browser.isIE()) {\n        return Optional.none();\n      } else {\n        return precheck(initial, isRoot).orThunk(function () {\n          return simulate(bridge, isRoot, direction, initial, anchor).map(function (info) {\n            var range = info.range;\n            return Response.create(Optional.some(makeSitus(range.start, range.soffset, range.finish, range.foffset)), true);\n          });\n        });\n      }\n    };\n    var firstUpCheck = function (initial, isRoot) {\n      return closest$1(initial, 'tr', isRoot).bind(function (startRow) {\n        return closest$1(startRow, 'table', isRoot).bind(function (table) {\n          var rows = descendants(table, 'tr');\n          if (eq$1(startRow, rows[0])) {\n            return seekLeft(table, function (element) {\n              return last$1(element).isSome();\n            }, isRoot).map(function (last) {\n              var lastOffset = getEnd(last);\n              return Response.create(Optional.some(makeSitus(last, lastOffset, last, lastOffset)), true);\n            });\n          } else {\n            return Optional.none();\n          }\n        });\n      });\n    };\n    var lastDownCheck = function (initial, isRoot) {\n      return closest$1(initial, 'tr', isRoot).bind(function (startRow) {\n        return closest$1(startRow, 'table', isRoot).bind(function (table) {\n          var rows = descendants(table, 'tr');\n          if (eq$1(startRow, rows[rows.length - 1])) {\n            return seekRight(table, function (element) {\n              return first(element).isSome();\n            }, isRoot).map(function (first) {\n              return Response.create(Optional.some(makeSitus(first, 0, first, 0)), true);\n            });\n          } else {\n            return Optional.none();\n          }\n        });\n      });\n    };\n    var select = function (bridge, container, isRoot, direction, initial, anchor, selectRange) {\n      return simulate(bridge, isRoot, direction, initial, anchor).bind(function (info) {\n        return detect(container, isRoot, info.start, info.finish, selectRange);\n      });\n    };\n\n    var findCell = function (target, isRoot) {\n      return closest$1(target, 'td,th', isRoot);\n    };\n    var MouseSelection = function (bridge, container, isRoot, annotations) {\n      var cursor = value();\n      var clearstate = cursor.clear;\n      var applySelection = function (event) {\n        cursor.on(function (start) {\n          annotations.clearBeforeUpdate(container);\n          findCell(event.target, isRoot).each(function (finish) {\n            identify(start, finish, isRoot).each(function (cellSel) {\n              var boxes = cellSel.boxes.getOr([]);\n              if (boxes.length === 1) {\n                var singleCell = boxes[0];\n                var isNonEditableCell = getRaw(singleCell) === 'false';\n                var isCellClosestContentEditable = is(closest(event.target), singleCell, eq$1);\n                if (isNonEditableCell && isCellClosestContentEditable) {\n                  annotations.selectRange(container, boxes, singleCell, singleCell);\n                  bridge.selectContents(singleCell);\n                }\n              } else if (boxes.length > 1) {\n                annotations.selectRange(container, boxes, cellSel.start, cellSel.finish);\n                bridge.selectContents(finish);\n              }\n            });\n          });\n        });\n      };\n      var mousedown = function (event) {\n        annotations.clear(container);\n        findCell(event.target, isRoot).each(cursor.set);\n      };\n      var mouseover = function (event) {\n        applySelection(event);\n      };\n      var mouseup = function (event) {\n        applySelection(event);\n        clearstate();\n      };\n      return {\n        clearstate: clearstate,\n        mousedown: mousedown,\n        mouseover: mouseover,\n        mouseup: mouseup\n      };\n    };\n\n    var down = {\n      traverse: nextSibling,\n      gather: after,\n      relative: Situ.before,\n      otherRetry: Retries.tryDown,\n      ieRetry: Retries.ieTryDown,\n      failure: BeforeAfter.failedDown\n    };\n    var up = {\n      traverse: prevSibling,\n      gather: before,\n      relative: Situ.before,\n      otherRetry: Retries.tryUp,\n      ieRetry: Retries.ieTryUp,\n      failure: BeforeAfter.failedUp\n    };\n\n    var isKey = function (key) {\n      return function (keycode) {\n        return keycode === key;\n      };\n    };\n    var isUp = isKey(38);\n    var isDown = isKey(40);\n    var isNavigation = function (keycode) {\n      return keycode >= 37 && keycode <= 40;\n    };\n    var ltr = {\n      isBackward: isKey(37),\n      isForward: isKey(39)\n    };\n    var rtl = {\n      isBackward: isKey(39),\n      isForward: isKey(37)\n    };\n\n    var get = function (_DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return SugarPosition(x, y);\n    };\n    var by = function (x, y, _DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var win = doc.defaultView;\n      if (win) {\n        win.scrollBy(x, y);\n      }\n    };\n\n    var WindowBridge = function (win) {\n      var elementFromPoint = function (x, y) {\n        return SugarElement.fromPoint(SugarElement.fromDom(win.document), x, y);\n      };\n      var getRect = function (element) {\n        return element.dom.getBoundingClientRect();\n      };\n      var getRangedRect = function (start, soffset, finish, foffset) {\n        var sel = SimSelection.exact(start, soffset, finish, foffset);\n        return getFirstRect(win, sel);\n      };\n      var getSelection = function () {\n        return get$1(win).map(function (exactAdt) {\n          return convertToRange(win, exactAdt);\n        });\n      };\n      var fromSitus = function (situs) {\n        var relative = SimSelection.relative(situs.start, situs.finish);\n        return convertToRange(win, relative);\n      };\n      var situsFromPoint = function (x, y) {\n        return getAtPoint(win, x, y).map(function (exact) {\n          return Situs.create(exact.start, exact.soffset, exact.finish, exact.foffset);\n        });\n      };\n      var clearSelection = function () {\n        clear(win);\n      };\n      var collapseSelection = function (toStart) {\n        if (toStart === void 0) {\n          toStart = false;\n        }\n        get$1(win).each(function (sel) {\n          return sel.fold(function (rng) {\n            return rng.collapse(toStart);\n          }, function (startSitu, finishSitu) {\n            var situ = toStart ? startSitu : finishSitu;\n            setRelative(win, situ, situ);\n          }, function (start, soffset, finish, foffset) {\n            var node = toStart ? start : finish;\n            var offset = toStart ? soffset : foffset;\n            setExact(win, node, offset, node, offset);\n          });\n        });\n      };\n      var selectNode = function (element) {\n        setToElement(win, element, false);\n      };\n      var selectContents = function (element) {\n        setToElement(win, element);\n      };\n      var setSelection = function (sel) {\n        setExact(win, sel.start, sel.soffset, sel.finish, sel.foffset);\n      };\n      var setRelativeSelection = function (start, finish) {\n        setRelative(win, start, finish);\n      };\n      var getInnerHeight = function () {\n        return win.innerHeight;\n      };\n      var getScrollY = function () {\n        var pos = get(SugarElement.fromDom(win.document));\n        return pos.top;\n      };\n      var scrollBy = function (x, y) {\n        by(x, y, SugarElement.fromDom(win.document));\n      };\n      return {\n        elementFromPoint: elementFromPoint,\n        getRect: getRect,\n        getRangedRect: getRangedRect,\n        getSelection: getSelection,\n        fromSitus: fromSitus,\n        situsFromPoint: situsFromPoint,\n        clearSelection: clearSelection,\n        collapseSelection: collapseSelection,\n        setSelection: setSelection,\n        setRelativeSelection: setRelativeSelection,\n        selectNode: selectNode,\n        selectContents: selectContents,\n        getInnerHeight: getInnerHeight,\n        getScrollY: getScrollY,\n        scrollBy: scrollBy\n      };\n    };\n\n    var rc = function (rows, cols) {\n      return {\n        rows: rows,\n        cols: cols\n      };\n    };\n    var mouse = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n      var handlers = MouseSelection(bridge, container, isRoot, annotations);\n      return {\n        clearstate: handlers.clearstate,\n        mousedown: handlers.mousedown,\n        mouseover: handlers.mouseover,\n        mouseup: handlers.mouseup\n      };\n    };\n    var keyboard = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n      var clearToNavigate = function () {\n        annotations.clear(container);\n        return Optional.none();\n      };\n      var keydown = function (event, start, soffset, finish, foffset, direction) {\n        var realEvent = event.raw;\n        var keycode = realEvent.which;\n        var shiftKey = realEvent.shiftKey === true;\n        var handler = retrieve$1(container, annotations.selectedSelector).fold(function () {\n          if (isNavigation(keycode) && !shiftKey) {\n            annotations.clearBeforeUpdate(container);\n          }\n          if (isDown(keycode) && shiftKey) {\n            return curry(select, bridge, container, isRoot, down, finish, start, annotations.selectRange);\n          } else if (isUp(keycode) && shiftKey) {\n            return curry(select, bridge, container, isRoot, up, finish, start, annotations.selectRange);\n          } else if (isDown(keycode)) {\n            return curry(navigate, bridge, isRoot, down, finish, start, lastDownCheck);\n          } else if (isUp(keycode)) {\n            return curry(navigate, bridge, isRoot, up, finish, start, firstUpCheck);\n          } else {\n            return Optional.none;\n          }\n        }, function (selected) {\n          var update$1 = function (attempts) {\n            return function () {\n              var navigation = findMap(attempts, function (delta) {\n                return update(delta.rows, delta.cols, container, selected, annotations);\n              });\n              return navigation.fold(function () {\n                return getEdges(container, annotations.firstSelectedSelector, annotations.lastSelectedSelector).map(function (edges) {\n                  var relative = isDown(keycode) || direction.isForward(keycode) ? Situ.after : Situ.before;\n                  bridge.setRelativeSelection(Situ.on(edges.first, 0), relative(edges.table));\n                  annotations.clear(container);\n                  return Response.create(Optional.none(), true);\n                });\n              }, function (_) {\n                return Optional.some(Response.create(Optional.none(), true));\n              });\n            };\n          };\n          if (isDown(keycode) && shiftKey) {\n            return update$1([rc(+1, 0)]);\n          } else if (isUp(keycode) && shiftKey) {\n            return update$1([rc(-1, 0)]);\n          } else if (direction.isBackward(keycode) && shiftKey) {\n            return update$1([\n              rc(0, -1),\n              rc(-1, 0)\n            ]);\n          } else if (direction.isForward(keycode) && shiftKey) {\n            return update$1([\n              rc(0, +1),\n              rc(+1, 0)\n            ]);\n          } else if (isNavigation(keycode) && !shiftKey) {\n            return clearToNavigate;\n          } else {\n            return Optional.none;\n          }\n        });\n        return handler();\n      };\n      var keyup = function (event, start, soffset, finish, foffset) {\n        return retrieve$1(container, annotations.selectedSelector).fold(function () {\n          var realEvent = event.raw;\n          var keycode = realEvent.which;\n          var shiftKey = realEvent.shiftKey === true;\n          if (!shiftKey) {\n            return Optional.none();\n          }\n          if (isNavigation(keycode)) {\n            return sync(container, isRoot, start, soffset, finish, foffset, annotations.selectRange);\n          } else {\n            return Optional.none();\n          }\n        }, Optional.none);\n      };\n      return {\n        keydown: keydown,\n        keyup: keyup\n      };\n    };\n    var external = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n      return function (start, finish) {\n        annotations.clearBeforeUpdate(container);\n        identify(start, finish, isRoot).each(function (cellSel) {\n          var boxes = cellSel.boxes.getOr([]);\n          annotations.selectRange(container, boxes, cellSel.start, cellSel.finish);\n          bridge.selectContents(finish);\n          bridge.collapseSelection();\n        });\n      };\n    };\n\n    var remove = function (element, classes) {\n      each$2(classes, function (x) {\n        remove$2(element, x);\n      });\n    };\n\n    var addClass = function (clazz) {\n      return function (element) {\n        add(element, clazz);\n      };\n    };\n    var removeClasses = function (classes) {\n      return function (element) {\n        remove(element, classes);\n      };\n    };\n\n    var byClass = function (ephemera) {\n      var addSelectionClass = addClass(ephemera.selected);\n      var removeSelectionClasses = removeClasses([\n        ephemera.selected,\n        ephemera.lastSelected,\n        ephemera.firstSelected\n      ]);\n      var clear = function (container) {\n        var sels = descendants(container, ephemera.selectedSelector);\n        each$2(sels, removeSelectionClasses);\n      };\n      var selectRange = function (container, cells, start, finish) {\n        clear(container);\n        each$2(cells, addSelectionClass);\n        add(start, ephemera.firstSelected);\n        add(finish, ephemera.lastSelected);\n      };\n      return {\n        clearBeforeUpdate: clear,\n        clear: clear,\n        selectRange: selectRange,\n        selectedSelector: ephemera.selectedSelector,\n        firstSelectedSelector: ephemera.firstSelectedSelector,\n        lastSelectedSelector: ephemera.lastSelectedSelector\n      };\n    };\n    var byAttr = function (ephemera, onSelection, onClear) {\n      var removeSelectionAttributes = function (element) {\n        remove$7(element, ephemera.selected);\n        remove$7(element, ephemera.firstSelected);\n        remove$7(element, ephemera.lastSelected);\n      };\n      var addSelectionAttribute = function (element) {\n        set$2(element, ephemera.selected, '1');\n      };\n      var clear = function (container) {\n        clearBeforeUpdate(container);\n        onClear();\n      };\n      var clearBeforeUpdate = function (container) {\n        var sels = descendants(container, ephemera.selectedSelector + ',' + ephemera.firstSelectedSelector + ',' + ephemera.lastSelectedSelector);\n        each$2(sels, removeSelectionAttributes);\n      };\n      var selectRange = function (container, cells, start, finish) {\n        clear(container);\n        each$2(cells, addSelectionAttribute);\n        set$2(start, ephemera.firstSelected, '1');\n        set$2(finish, ephemera.lastSelected, '1');\n        onSelection(cells, start, finish);\n      };\n      return {\n        clearBeforeUpdate: clearBeforeUpdate,\n        clear: clear,\n        selectRange: selectRange,\n        selectedSelector: ephemera.selectedSelector,\n        firstSelectedSelector: ephemera.firstSelectedSelector,\n        lastSelectedSelector: ephemera.lastSelectedSelector\n      };\n    };\n    var SelectionAnnotation = {\n      byClass: byClass,\n      byAttr: byAttr\n    };\n\n    var getUpOrLeftCells = function (grid, selectedCells) {\n      var upGrid = grid.slice(0, selectedCells[selectedCells.length - 1].row + 1);\n      var upDetails = toDetailList(upGrid);\n      return bind$2(upDetails, function (detail) {\n        var slicedCells = detail.cells.slice(0, selectedCells[selectedCells.length - 1].column + 1);\n        return map$1(slicedCells, function (cell) {\n          return cell.element;\n        });\n      });\n    };\n    var getDownOrRightCells = function (grid, selectedCells) {\n      var downGrid = grid.slice(selectedCells[0].row + selectedCells[0].rowspan - 1, grid.length);\n      var downDetails = toDetailList(downGrid);\n      return bind$2(downDetails, function (detail) {\n        var slicedCells = detail.cells.slice(selectedCells[0].column + selectedCells[0].colspan - 1, detail.cells.length);\n        return map$1(slicedCells, function (cell) {\n          return cell.element;\n        });\n      });\n    };\n    var getOtherCells = function (table, target, generators) {\n      var warehouse = Warehouse.fromTable(table);\n      var details = onCells(warehouse, target);\n      return details.map(function (selectedCells) {\n        var grid = toGrid(warehouse, generators, false);\n        var upOrLeftCells = getUpOrLeftCells(grid, selectedCells);\n        var downOrRightCells = getDownOrRightCells(grid, selectedCells);\n        return {\n          upOrLeftCells: upOrLeftCells,\n          downOrRightCells: downOrRightCells\n        };\n      });\n    };\n\n    var global = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var hasInternalTarget = function (e) {\n      return has(SugarElement.fromDom(e.target), 'ephox-snooker-resizer-bar') === false;\n    };\n    function CellSelection (editor, lazyResize, selectionTargets) {\n      var onSelection = function (cells, start, finish) {\n        selectionTargets.targets().each(function (targets) {\n          var tableOpt = table(start);\n          tableOpt.each(function (table) {\n            var cloneFormats = getCloneElements(editor);\n            var generators = cellOperations(noop, SugarElement.fromDom(editor.getDoc()), cloneFormats);\n            var otherCells = getOtherCells(table, targets, generators);\n            fireTableSelectionChange(editor, cells, start, finish, otherCells);\n          });\n        });\n      };\n      var onClear = function () {\n        return fireTableSelectionClear(editor);\n      };\n      var annotations = SelectionAnnotation.byAttr(ephemera, onSelection, onClear);\n      editor.on('init', function (_e) {\n        var win = editor.getWin();\n        var body = getBody(editor);\n        var isRoot = getIsRoot(editor);\n        var syncSelection = function () {\n          var sel = editor.selection;\n          var start = SugarElement.fromDom(sel.getStart());\n          var end = SugarElement.fromDom(sel.getEnd());\n          var shared = sharedOne(table, [\n            start,\n            end\n          ]);\n          shared.fold(function () {\n            return annotations.clear(body);\n          }, noop);\n        };\n        var mouseHandlers = mouse(win, body, isRoot, annotations);\n        var keyHandlers = keyboard(win, body, isRoot, annotations);\n        var external$1 = external(win, body, isRoot, annotations);\n        var hasShiftKey = function (event) {\n          return event.raw.shiftKey === true;\n        };\n        editor.on('TableSelectorChange', function (e) {\n          return external$1(e.start, e.finish);\n        });\n        var handleResponse = function (event, response) {\n          if (!hasShiftKey(event)) {\n            return;\n          }\n          if (response.kill) {\n            event.kill();\n          }\n          response.selection.each(function (ns) {\n            var relative = SimSelection.relative(ns.start, ns.finish);\n            var rng = asLtrRange(win, relative);\n            editor.selection.setRng(rng);\n          });\n        };\n        var keyup = function (event) {\n          var wrappedEvent = fromRawEvent(event);\n          if (wrappedEvent.raw.shiftKey && isNavigation(wrappedEvent.raw.which)) {\n            var rng = editor.selection.getRng();\n            var start = SugarElement.fromDom(rng.startContainer);\n            var end = SugarElement.fromDom(rng.endContainer);\n            keyHandlers.keyup(wrappedEvent, start, rng.startOffset, end, rng.endOffset).each(function (response) {\n              handleResponse(wrappedEvent, response);\n            });\n          }\n        };\n        var keydown = function (event) {\n          var wrappedEvent = fromRawEvent(event);\n          lazyResize().each(function (resize) {\n            return resize.hideBars();\n          });\n          var rng = editor.selection.getRng();\n          var start = SugarElement.fromDom(rng.startContainer);\n          var end = SugarElement.fromDom(rng.endContainer);\n          var direction = onDirection(ltr, rtl)(SugarElement.fromDom(editor.selection.getStart()));\n          keyHandlers.keydown(wrappedEvent, start, rng.startOffset, end, rng.endOffset, direction).each(function (response) {\n            handleResponse(wrappedEvent, response);\n          });\n          lazyResize().each(function (resize) {\n            return resize.showBars();\n          });\n        };\n        var isLeftMouse = function (raw) {\n          return raw.button === 0;\n        };\n        var isLeftButtonPressed = function (raw) {\n          if (raw.buttons === undefined) {\n            return true;\n          }\n          if (global.browser.isEdge() && raw.buttons === 0) {\n            return true;\n          }\n          return (raw.buttons & 1) !== 0;\n        };\n        var dragStart = function (_e) {\n          mouseHandlers.clearstate();\n        };\n        var mouseDown = function (e) {\n          if (isLeftMouse(e) && hasInternalTarget(e)) {\n            mouseHandlers.mousedown(fromRawEvent(e));\n          }\n        };\n        var mouseOver = function (e) {\n          if (isLeftButtonPressed(e) && hasInternalTarget(e)) {\n            mouseHandlers.mouseover(fromRawEvent(e));\n          }\n        };\n        var mouseUp = function (e) {\n          if (isLeftMouse(e) && hasInternalTarget(e)) {\n            mouseHandlers.mouseup(fromRawEvent(e));\n          }\n        };\n        var getDoubleTap = function () {\n          var lastTarget = Cell(SugarElement.fromDom(body));\n          var lastTimeStamp = Cell(0);\n          var touchEnd = function (t) {\n            var target = SugarElement.fromDom(t.target);\n            if (name(target) === 'td' || name(target) === 'th') {\n              var lT = lastTarget.get();\n              var lTS = lastTimeStamp.get();\n              if (eq$1(lT, target) && t.timeStamp - lTS < 300) {\n                t.preventDefault();\n                external$1(target, target);\n              }\n            }\n            lastTarget.set(target);\n            lastTimeStamp.set(t.timeStamp);\n          };\n          return { touchEnd: touchEnd };\n        };\n        var doubleTap = getDoubleTap();\n        editor.on('dragstart', dragStart);\n        editor.on('mousedown', mouseDown);\n        editor.on('mouseover', mouseOver);\n        editor.on('mouseup', mouseUp);\n        editor.on('touchend', doubleTap.touchEnd);\n        editor.on('keyup', keyup);\n        editor.on('keydown', keydown);\n        editor.on('NodeChange', syncSelection);\n      });\n      return { clear: annotations.clear };\n    }\n\n    var child = function (scope, selector) {\n      return child$1(scope, selector).isSome();\n    };\n\n    var getSelectionTargets = function (editor, selections) {\n      var targets = Cell(Optional.none());\n      var changeHandlers = Cell([]);\n      var selectionDetails = Optional.none();\n      var isCaption = isTag('caption');\n      var isDisabledForSelection = function (key) {\n        return selectionDetails.forall(function (details) {\n          return !details[key];\n        });\n      };\n      var getStart = function () {\n        return getSelectionCellOrCaption(getSelectionStart(editor), getIsRoot(editor));\n      };\n      var getEnd = function () {\n        return getSelectionCellOrCaption(getSelectionEnd(editor), getIsRoot(editor));\n      };\n      var findTargets = function () {\n        return getStart().bind(function (startCellOrCaption) {\n          return flatten(lift2(table(startCellOrCaption), getEnd().bind(table), function (startTable, endTable) {\n            if (eq$1(startTable, endTable)) {\n              if (isCaption(startCellOrCaption)) {\n                return Optional.some(noMenu(startCellOrCaption));\n              } else {\n                return Optional.some(forMenu(selections, startTable, startCellOrCaption));\n              }\n            }\n            return Optional.none();\n          }));\n        });\n      };\n      var getExtractedDetails = function (targets) {\n        var tableOpt = table(targets.element);\n        return tableOpt.map(function (table) {\n          var warehouse = Warehouse.fromTable(table);\n          var selectedCells = onCells(warehouse, targets).getOr([]);\n          var locked = foldl(selectedCells, function (acc, cell) {\n            if (cell.isLocked) {\n              acc.onAny = true;\n              if (cell.column === 0) {\n                acc.onFirst = true;\n              } else if (cell.column + cell.colspan >= warehouse.grid.columns) {\n                acc.onLast = true;\n              }\n            }\n            return acc;\n          }, {\n            onAny: false,\n            onFirst: false,\n            onLast: false\n          });\n          return {\n            mergeable: onUnlockedMergable(warehouse, targets).isSome(),\n            unmergeable: onUnlockedUnmergable(warehouse, targets).isSome(),\n            locked: locked\n          };\n        });\n      };\n      var resetTargets = function () {\n        targets.set(cached(findTargets)());\n        selectionDetails = targets.get().bind(getExtractedDetails);\n        each$2(changeHandlers.get(), function (handler) {\n          return handler();\n        });\n      };\n      var setupHandler = function (handler) {\n        handler();\n        changeHandlers.set(changeHandlers.get().concat([handler]));\n        return function () {\n          changeHandlers.set(filter$2(changeHandlers.get(), function (h) {\n            return h !== handler;\n          }));\n        };\n      };\n      var onSetup = function (api, isDisabled) {\n        return setupHandler(function () {\n          return targets.get().fold(function () {\n            api.setDisabled(true);\n          }, function (targets) {\n            api.setDisabled(isDisabled(targets));\n          });\n        });\n      };\n      var onSetupWithToggle = function (api, isDisabled, isActive) {\n        return setupHandler(function () {\n          return targets.get().fold(function () {\n            api.setDisabled(true);\n            api.setActive(false);\n          }, function (targets) {\n            api.setDisabled(isDisabled(targets));\n            api.setActive(isActive(targets));\n          });\n        });\n      };\n      var isDisabledFromLocked = function (lockedDisable) {\n        return selectionDetails.exists(function (details) {\n          return details.locked[lockedDisable];\n        });\n      };\n      var onSetupTable = function (api) {\n        return onSetup(api, function (_) {\n          return false;\n        });\n      };\n      var onSetupCellOrRow = function (api) {\n        return onSetup(api, function (targets) {\n          return isCaption(targets.element);\n        });\n      };\n      var onSetupColumn = function (lockedDisable) {\n        return function (api) {\n          return onSetup(api, function (targets) {\n            return isCaption(targets.element) || isDisabledFromLocked(lockedDisable);\n          });\n        };\n      };\n      var onSetupPasteable = function (getClipboardData) {\n        return function (api) {\n          return onSetup(api, function (targets) {\n            return isCaption(targets.element) || getClipboardData().isNone();\n          });\n        };\n      };\n      var onSetupPasteableColumn = function (getClipboardData, lockedDisable) {\n        return function (api) {\n          return onSetup(api, function (targets) {\n            return isCaption(targets.element) || getClipboardData().isNone() || isDisabledFromLocked(lockedDisable);\n          });\n        };\n      };\n      var onSetupMergeable = function (api) {\n        return onSetup(api, function (_targets) {\n          return isDisabledForSelection('mergeable');\n        });\n      };\n      var onSetupUnmergeable = function (api) {\n        return onSetup(api, function (_targets) {\n          return isDisabledForSelection('unmergeable');\n        });\n      };\n      var onSetupTableWithCaption = function (api) {\n        return onSetupWithToggle(api, never, function (targets) {\n          var tableOpt = table(targets.element, getIsRoot(editor));\n          return tableOpt.exists(function (table) {\n            return child(table, 'caption');\n          });\n        });\n      };\n      var onSetupTableHeaders = function (command, headerType) {\n        return function (api) {\n          return onSetupWithToggle(api, function (targets) {\n            return isCaption(targets.element);\n          }, function () {\n            return editor.queryCommandValue(command) === headerType;\n          });\n        };\n      };\n      var onSetupTableRowHeaders = onSetupTableHeaders('mceTableRowType', 'header');\n      var onSetupTableColumnHeaders = onSetupTableHeaders('mceTableColType', 'th');\n      editor.on('NodeChange ExecCommand TableSelectorChange', resetTargets);\n      return {\n        onSetupTable: onSetupTable,\n        onSetupCellOrRow: onSetupCellOrRow,\n        onSetupColumn: onSetupColumn,\n        onSetupPasteable: onSetupPasteable,\n        onSetupPasteableColumn: onSetupPasteableColumn,\n        onSetupMergeable: onSetupMergeable,\n        onSetupUnmergeable: onSetupUnmergeable,\n        resetTargets: resetTargets,\n        onSetupTableWithCaption: onSetupTableWithCaption,\n        onSetupTableRowHeaders: onSetupTableRowHeaders,\n        onSetupTableColumnHeaders: onSetupTableColumnHeaders,\n        targets: targets.get\n      };\n    };\n\n    var addButtons = function (editor, selections, selectionTargets, clipboard) {\n      editor.ui.registry.addMenuButton('table', {\n        tooltip: 'Table',\n        icon: 'table',\n        fetch: function (callback) {\n          return callback('inserttable | cell row column | advtablesort | tableprops deletetable');\n        }\n      });\n      var cmd = function (command) {\n        return function () {\n          return editor.execCommand(command);\n        };\n      };\n      editor.ui.registry.addButton('tableprops', {\n        tooltip: 'Table properties',\n        onAction: cmd('mceTableProps'),\n        icon: 'table',\n        onSetup: selectionTargets.onSetupTable\n      });\n      editor.ui.registry.addButton('tabledelete', {\n        tooltip: 'Delete table',\n        onAction: cmd('mceTableDelete'),\n        icon: 'table-delete-table',\n        onSetup: selectionTargets.onSetupTable\n      });\n      editor.ui.registry.addButton('tablecellprops', {\n        tooltip: 'Cell properties',\n        onAction: cmd('mceTableCellProps'),\n        icon: 'table-cell-properties',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablemergecells', {\n        tooltip: 'Merge cells',\n        onAction: cmd('mceTableMergeCells'),\n        icon: 'table-merge-cells',\n        onSetup: selectionTargets.onSetupMergeable\n      });\n      editor.ui.registry.addButton('tablesplitcells', {\n        tooltip: 'Split cell',\n        onAction: cmd('mceTableSplitCells'),\n        icon: 'table-split-cells',\n        onSetup: selectionTargets.onSetupUnmergeable\n      });\n      editor.ui.registry.addButton('tableinsertrowbefore', {\n        tooltip: 'Insert row before',\n        onAction: cmd('mceTableInsertRowBefore'),\n        icon: 'table-insert-row-above',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tableinsertrowafter', {\n        tooltip: 'Insert row after',\n        onAction: cmd('mceTableInsertRowAfter'),\n        icon: 'table-insert-row-after',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tabledeleterow', {\n        tooltip: 'Delete row',\n        onAction: cmd('mceTableDeleteRow'),\n        icon: 'table-delete-row',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablerowprops', {\n        tooltip: 'Row properties',\n        onAction: cmd('mceTableRowProps'),\n        icon: 'table-row-properties',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tableinsertcolbefore', {\n        tooltip: 'Insert column before',\n        onAction: cmd('mceTableInsertColBefore'),\n        icon: 'table-insert-column-before',\n        onSetup: selectionTargets.onSetupColumn('onFirst')\n      });\n      editor.ui.registry.addButton('tableinsertcolafter', {\n        tooltip: 'Insert column after',\n        onAction: cmd('mceTableInsertColAfter'),\n        icon: 'table-insert-column-after',\n        onSetup: selectionTargets.onSetupColumn('onLast')\n      });\n      editor.ui.registry.addButton('tabledeletecol', {\n        tooltip: 'Delete column',\n        onAction: cmd('mceTableDeleteCol'),\n        icon: 'table-delete-column',\n        onSetup: selectionTargets.onSetupColumn('onAny')\n      });\n      editor.ui.registry.addButton('tablecutrow', {\n        tooltip: 'Cut row',\n        icon: 'cut-row',\n        onAction: cmd('mceTableCutRow'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablecopyrow', {\n        tooltip: 'Copy row',\n        icon: 'duplicate-row',\n        onAction: cmd('mceTableCopyRow'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablepasterowbefore', {\n        tooltip: 'Paste row before',\n        icon: 'paste-row-before',\n        onAction: cmd('mceTablePasteRowBefore'),\n        onSetup: selectionTargets.onSetupPasteable(clipboard.getRows)\n      });\n      editor.ui.registry.addButton('tablepasterowafter', {\n        tooltip: 'Paste row after',\n        icon: 'paste-row-after',\n        onAction: cmd('mceTablePasteRowAfter'),\n        onSetup: selectionTargets.onSetupPasteable(clipboard.getRows)\n      });\n      editor.ui.registry.addButton('tablecutcol', {\n        tooltip: 'Cut column',\n        icon: 'cut-column',\n        onAction: cmd('mceTableCutCol'),\n        onSetup: selectionTargets.onSetupColumn('onAny')\n      });\n      editor.ui.registry.addButton('tablecopycol', {\n        tooltip: 'Copy column',\n        icon: 'duplicate-column',\n        onAction: cmd('mceTableCopyCol'),\n        onSetup: selectionTargets.onSetupColumn('onAny')\n      });\n      editor.ui.registry.addButton('tablepastecolbefore', {\n        tooltip: 'Paste column before',\n        icon: 'paste-column-before',\n        onAction: cmd('mceTablePasteColBefore'),\n        onSetup: selectionTargets.onSetupPasteableColumn(clipboard.getColumns, 'onFirst')\n      });\n      editor.ui.registry.addButton('tablepastecolafter', {\n        tooltip: 'Paste column after',\n        icon: 'paste-column-after',\n        onAction: cmd('mceTablePasteColAfter'),\n        onSetup: selectionTargets.onSetupPasteableColumn(clipboard.getColumns, 'onLast')\n      });\n      editor.ui.registry.addButton('tableinsertdialog', {\n        tooltip: 'Insert table',\n        onAction: cmd('mceInsertTable'),\n        icon: 'table'\n      });\n      var tableClassList = filterNoneItem(getTableClassList(editor));\n      if (tableClassList.length !== 0) {\n        editor.ui.registry.addMenuButton('tableclass', {\n          icon: 'table-classes',\n          tooltip: 'Table styles',\n          fetch: generateMenuItemsCallback(editor, selections, tableClassList, 'tableclass', function (value) {\n            return editor.execCommand('mceTableToggleClass', false, value);\n          }),\n          onSetup: selectionTargets.onSetupTable\n        });\n      }\n      var tableCellClassList = filterNoneItem(getCellClassList(editor));\n      if (tableCellClassList.length !== 0) {\n        editor.ui.registry.addMenuButton('tablecellclass', {\n          icon: 'table-cell-classes',\n          tooltip: 'Cell styles',\n          fetch: generateMenuItemsCallback(editor, selections, tableCellClassList, 'tablecellclass', function (value) {\n            return editor.execCommand('mceTableCellToggleClass', false, value);\n          }),\n          onSetup: selectionTargets.onSetupCellOrRow\n        });\n      }\n      editor.ui.registry.addMenuButton('tablecellvalign', {\n        icon: 'vertical-align',\n        tooltip: 'Vertical align',\n        fetch: generateMenuItemsCallback(editor, selections, verticalAlignValues, 'tablecellverticalalign', applyTableCellStyle(editor, 'vertical-align')),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuButton('tablecellborderwidth', {\n        icon: 'border-width',\n        tooltip: 'Border width',\n        fetch: generateMenuItemsCallback(editor, selections, getTableBorderWidths(editor), 'tablecellborderwidth', applyTableCellStyle(editor, 'border-width')),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuButton('tablecellborderstyle', {\n        icon: 'border-style',\n        tooltip: 'Border style',\n        fetch: generateMenuItemsCallback(editor, selections, getTableBorderStyles(editor), 'tablecellborderstyle', applyTableCellStyle(editor, 'border-style')),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addToggleButton('tablecaption', {\n        tooltip: 'Table caption',\n        onAction: cmd('mceTableToggleCaption'),\n        icon: 'table-caption',\n        onSetup: selectionTargets.onSetupTableWithCaption\n      });\n      editor.ui.registry.addMenuButton('tablecellbackgroundcolor', {\n        icon: 'cell-background-color',\n        tooltip: 'Background color',\n        fetch: function (callback) {\n          return callback(buildColorMenu(editor, getTableBackgroundColorMap(editor), 'background-color'));\n        },\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuButton('tablecellbordercolor', {\n        icon: 'cell-border-color',\n        tooltip: 'Border color',\n        fetch: function (callback) {\n          return callback(buildColorMenu(editor, getTableBorderColorMap(editor), 'border-color'));\n        },\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addToggleButton('tablerowheader', {\n        tooltip: 'Row header',\n        icon: 'table-top-header',\n        onAction: changeRowHeader(editor),\n        onSetup: selectionTargets.onSetupTableRowHeaders\n      });\n      editor.ui.registry.addToggleButton('tablecolheader', {\n        tooltip: 'Column header',\n        icon: 'table-left-header',\n        onAction: changeColumnHeader(editor),\n        onSetup: selectionTargets.onSetupTableColumnHeaders\n      });\n    };\n    var addToolbars = function (editor) {\n      var isTable = function (table) {\n        return editor.dom.is(table, 'table') && editor.getBody().contains(table);\n      };\n      var toolbar = getToolbar(editor);\n      if (toolbar.length > 0) {\n        editor.ui.registry.addContextToolbar('table', {\n          predicate: isTable,\n          items: toolbar,\n          scope: 'node',\n          position: 'node'\n        });\n      }\n    };\n\n    var addMenuItems = function (editor, selections, selectionTargets, clipboard) {\n      var cmd = function (command) {\n        return function () {\n          return editor.execCommand(command);\n        };\n      };\n      var insertTableAction = function (data) {\n        editor.execCommand('mceInsertTable', false, {\n          rows: data.numRows,\n          columns: data.numColumns\n        });\n      };\n      var tableProperties = {\n        text: 'Table properties',\n        onSetup: selectionTargets.onSetupTable,\n        onAction: cmd('mceTableProps')\n      };\n      var deleteTable = {\n        text: 'Delete table',\n        icon: 'table-delete-table',\n        onSetup: selectionTargets.onSetupTable,\n        onAction: cmd('mceTableDelete')\n      };\n      editor.ui.registry.addMenuItem('tableinsertrowbefore', {\n        text: 'Insert row before',\n        icon: 'table-insert-row-above',\n        onAction: cmd('mceTableInsertRowBefore'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tableinsertrowafter', {\n        text: 'Insert row after',\n        icon: 'table-insert-row-after',\n        onAction: cmd('mceTableInsertRowAfter'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tabledeleterow', {\n        text: 'Delete row',\n        icon: 'table-delete-row',\n        onAction: cmd('mceTableDeleteRow'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tablerowprops', {\n        text: 'Row properties',\n        icon: 'table-row-properties',\n        onAction: cmd('mceTableRowProps'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tablecutrow', {\n        text: 'Cut row',\n        icon: 'cut-row',\n        onAction: cmd('mceTableCutRow'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tablecopyrow', {\n        text: 'Copy row',\n        icon: 'duplicate-row',\n        onAction: cmd('mceTableCopyRow'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tablepasterowbefore', {\n        text: 'Paste row before',\n        icon: 'paste-row-before',\n        onAction: cmd('mceTablePasteRowBefore'),\n        onSetup: selectionTargets.onSetupPasteable(clipboard.getRows)\n      });\n      editor.ui.registry.addMenuItem('tablepasterowafter', {\n        text: 'Paste row after',\n        icon: 'paste-row-after',\n        onAction: cmd('mceTablePasteRowAfter'),\n        onSetup: selectionTargets.onSetupPasteable(clipboard.getRows)\n      });\n      var row = {\n        type: 'nestedmenuitem',\n        text: 'Row',\n        getSubmenuItems: constant('tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter')\n      };\n      editor.ui.registry.addMenuItem('tableinsertcolumnbefore', {\n        text: 'Insert column before',\n        icon: 'table-insert-column-before',\n        onAction: cmd('mceTableInsertColBefore'),\n        onSetup: selectionTargets.onSetupColumn('onFirst')\n      });\n      editor.ui.registry.addMenuItem('tableinsertcolumnafter', {\n        text: 'Insert column after',\n        icon: 'table-insert-column-after',\n        onAction: cmd('mceTableInsertColAfter'),\n        onSetup: selectionTargets.onSetupColumn('onLast')\n      });\n      editor.ui.registry.addMenuItem('tabledeletecolumn', {\n        text: 'Delete column',\n        icon: 'table-delete-column',\n        onAction: cmd('mceTableDeleteCol'),\n        onSetup: selectionTargets.onSetupColumn('onAny')\n      });\n      editor.ui.registry.addMenuItem('tablecutcolumn', {\n        text: 'Cut column',\n        icon: 'cut-column',\n        onAction: cmd('mceTableCutCol'),\n        onSetup: selectionTargets.onSetupColumn('onAny')\n      });\n      editor.ui.registry.addMenuItem('tablecopycolumn', {\n        text: 'Copy column',\n        icon: 'duplicate-column',\n        onAction: cmd('mceTableCopyCol'),\n        onSetup: selectionTargets.onSetupColumn('onAny')\n      });\n      editor.ui.registry.addMenuItem('tablepastecolumnbefore', {\n        text: 'Paste column before',\n        icon: 'paste-column-before',\n        onAction: cmd('mceTablePasteColBefore'),\n        onSetup: selectionTargets.onSetupPasteableColumn(clipboard.getColumns, 'onFirst')\n      });\n      editor.ui.registry.addMenuItem('tablepastecolumnafter', {\n        text: 'Paste column after',\n        icon: 'paste-column-after',\n        onAction: cmd('mceTablePasteColAfter'),\n        onSetup: selectionTargets.onSetupPasteableColumn(clipboard.getColumns, 'onLast')\n      });\n      var column = {\n        type: 'nestedmenuitem',\n        text: 'Column',\n        getSubmenuItems: constant('tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter')\n      };\n      editor.ui.registry.addMenuItem('tablecellprops', {\n        text: 'Cell properties',\n        icon: 'table-cell-properties',\n        onAction: cmd('mceTableCellProps'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tablemergecells', {\n        text: 'Merge cells',\n        icon: 'table-merge-cells',\n        onAction: cmd('mceTableMergeCells'),\n        onSetup: selectionTargets.onSetupMergeable\n      });\n      editor.ui.registry.addMenuItem('tablesplitcells', {\n        text: 'Split cell',\n        icon: 'table-split-cells',\n        onAction: cmd('mceTableSplitCells'),\n        onSetup: selectionTargets.onSetupUnmergeable\n      });\n      var cell = {\n        type: 'nestedmenuitem',\n        text: 'Cell',\n        getSubmenuItems: constant('tablecellprops tablemergecells tablesplitcells')\n      };\n      if (hasTableGrid(editor) === false) {\n        editor.ui.registry.addMenuItem('inserttable', {\n          text: 'Table',\n          icon: 'table',\n          onAction: cmd('mceInsertTable')\n        });\n      } else {\n        editor.ui.registry.addNestedMenuItem('inserttable', {\n          text: 'Table',\n          icon: 'table',\n          getSubmenuItems: function () {\n            return [{\n                type: 'fancymenuitem',\n                fancytype: 'inserttable',\n                onAction: insertTableAction\n              }];\n          }\n        });\n      }\n      editor.ui.registry.addMenuItem('inserttabledialog', {\n        text: 'Insert table',\n        icon: 'table',\n        onAction: cmd('mceInsertTable')\n      });\n      editor.ui.registry.addMenuItem('tableprops', tableProperties);\n      editor.ui.registry.addMenuItem('deletetable', deleteTable);\n      editor.ui.registry.addNestedMenuItem('row', row);\n      editor.ui.registry.addNestedMenuItem('column', column);\n      editor.ui.registry.addNestedMenuItem('cell', cell);\n      editor.ui.registry.addContextMenu('table', {\n        update: function () {\n          selectionTargets.resetTargets();\n          return selectionTargets.targets().fold(constant(''), function (targets) {\n            if (name(targets.element) === 'caption') {\n              return 'tableprops deletetable';\n            } else {\n              return 'cell row column | advtablesort | tableprops deletetable';\n            }\n          });\n        }\n      });\n      var tableClassList = filterNoneItem(getTableClassList(editor));\n      if (tableClassList.length !== 0) {\n        editor.ui.registry.addNestedMenuItem('tableclass', {\n          icon: 'table-classes',\n          text: 'Table styles',\n          getSubmenuItems: function () {\n            return buildMenuItems(editor, selections, tableClassList, 'tableclass', function (value) {\n              return editor.execCommand('mceTableToggleClass', false, value);\n            });\n          },\n          onSetup: selectionTargets.onSetupTable\n        });\n      }\n      var tableCellClassList = filterNoneItem(getCellClassList(editor));\n      if (tableCellClassList.length !== 0) {\n        editor.ui.registry.addNestedMenuItem('tablecellclass', {\n          icon: 'table-cell-classes',\n          text: 'Cell styles',\n          getSubmenuItems: function () {\n            return buildMenuItems(editor, selections, tableCellClassList, 'tablecellclass', function (value) {\n              return editor.execCommand('mceTableCellToggleClass', false, value);\n            });\n          },\n          onSetup: selectionTargets.onSetupCellOrRow\n        });\n      }\n      editor.ui.registry.addNestedMenuItem('tablecellvalign', {\n        icon: 'vertical-align',\n        text: 'Vertical align',\n        getSubmenuItems: function () {\n          return buildMenuItems(editor, selections, verticalAlignValues, 'tablecellverticalalign', applyTableCellStyle(editor, 'vertical-align'));\n        },\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addNestedMenuItem('tablecellborderwidth', {\n        icon: 'border-width',\n        text: 'Border width',\n        getSubmenuItems: function () {\n          return buildMenuItems(editor, selections, getTableBorderWidths(editor), 'tablecellborderwidth', applyTableCellStyle(editor, 'border-width'));\n        },\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addNestedMenuItem('tablecellborderstyle', {\n        icon: 'border-style',\n        text: 'Border style',\n        getSubmenuItems: function () {\n          return buildMenuItems(editor, selections, getTableBorderStyles(editor), 'tablecellborderstyle', applyTableCellStyle(editor, 'border-style'));\n        },\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addToggleMenuItem('tablecaption', {\n        icon: 'table-caption',\n        text: 'Table caption',\n        onAction: cmd('mceTableToggleCaption'),\n        onSetup: selectionTargets.onSetupTableWithCaption\n      });\n      editor.ui.registry.addNestedMenuItem('tablecellbackgroundcolor', {\n        icon: 'cell-background-color',\n        text: 'Background color',\n        getSubmenuItems: function () {\n          return buildColorMenu(editor, getTableBackgroundColorMap(editor), 'background-color');\n        },\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addNestedMenuItem('tablecellbordercolor', {\n        icon: 'cell-border-color',\n        text: 'Border color',\n        getSubmenuItems: function () {\n          return buildColorMenu(editor, getTableBorderColorMap(editor), 'border-color');\n        },\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addToggleMenuItem('tablerowheader', {\n        text: 'Row header',\n        icon: 'table-top-header',\n        onAction: changeRowHeader(editor),\n        onSetup: selectionTargets.onSetupTableRowHeaders\n      });\n      editor.ui.registry.addToggleMenuItem('tablecolheader', {\n        text: 'Column header',\n        icon: 'table-left-header',\n        onAction: changeColumnHeader(editor),\n        onSetup: selectionTargets.onSetupTableColumnHeaders\n      });\n    };\n\n    var Plugin = function (editor) {\n      var selections = Selections(function () {\n        return getBody(editor);\n      }, function () {\n        return getSelectionCell(getSelectionStart(editor), getIsRoot(editor));\n      }, ephemera.selectedSelector);\n      var selectionTargets = getSelectionTargets(editor, selections);\n      var resizeHandler = getResizeHandler(editor);\n      var cellSelection = CellSelection(editor, resizeHandler.lazyResize, selectionTargets);\n      var actions = TableActions(editor, cellSelection, resizeHandler.lazyWire);\n      var clipboard = Clipboard();\n      registerCommands(editor, actions, cellSelection, selections, clipboard);\n      registerQueryCommands(editor, actions, selections);\n      registerEvents(editor, selections, actions);\n      addMenuItems(editor, selections, selectionTargets, clipboard);\n      addButtons(editor, selections, selectionTargets, clipboard);\n      addToolbars(editor);\n      editor.on('PreInit', function () {\n        editor.serializer.addTempAttr(ephemera.firstSelected);\n        editor.serializer.addTempAttr(ephemera.lastSelected);\n        registerFormats(editor);\n      });\n      if (hasTabNavigation(editor)) {\n        editor.on('keydown', function (e) {\n          handle$1(e, editor, cellSelection);\n        });\n      }\n      editor.on('remove', function () {\n        resizeHandler.destroy();\n      });\n      return getApi(editor, clipboard, resizeHandler, selectionTargets);\n    };\n    function Plugin$1 () {\n      global$3.add('table', Plugin);\n    }\n\n    Plugin$1();\n\n}());\n"]},"metadata":{},"sourceType":"script"}