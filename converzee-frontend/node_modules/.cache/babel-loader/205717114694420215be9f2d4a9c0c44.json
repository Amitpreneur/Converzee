{"ast":null,"code":"import React,{Component}from\"react\";import SideBar from\"./SideBar\";import ToolUtil,{generateIframeContant,getDefaultItems}from\"../../utils/ToolUtil\";import Util,{generateFile,parseImgUrl}from\"../Util\";import Text from\"./Text\";import Responders from\"./Responders\";import CTA from\"./CTA\";import{ToolLayout,ButtonsGroup}from\"../layout/ToolLayout\";import{getPath,GET_PIXEL,SAVE_TOOL,GET_ONE_TOOL}from\"../../actions/URLs\";import RequestHandler from\"../../actions/RequestHandler\";import{Modal}from\"antd\";import Style from\"./Style\";import Code from\"./Code\";import{OptinFormModalResponse,OptinFormModal}from\"../utils/Modal\";import Time from\"./Time\";import{Preview}from\"./Preview\";import{ReponsiveImage}from\"../comman/PreviewAble\";import Video from\"../pages/tools/VideoPopup/Video\";import Image from\"../pages/tools/VideoPopup/Image\";import Icons from\"./Icons\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default class OptinForm extends Component{constructor(){super(...arguments);this.state={video:{url:\"\",videoType:\"youtube\"},toolName:\"\",toolId:\"\",preview:false,_id:null,activeTab:2,toolData:{text:'<span style=\"font-size: 36px;\"><font color=\"#ff9c00\">Converzee</font></span>',cta:'<font color=\"#efefef\"><span style=\"font-size: 18px;\">Buy Now</span></font>',layout:0,style:[{name:\"Background\",id:\"backgound\",value:\"TRANSPARENT\"},{name:\"CTA Backgound\",id:\"ctabackgound\",value:\"#ff3a65\"}],timerType:\"DATE_AND_TIME_BASED\",endDateTime:new Date(),timeZone:Util.getTimeZoneList()[0].value,postExpiryAction:\"hide\",ctaRedirectUrl:\"\",redirectUrl:\"\",days:2,hours:2,minutes:2,seconds:2,bgImg:\"#fff\",isBGIMG:false,noThanks:\"No thanks\",subTitle:\"Subtitle here\",position:\"TOP\",isNameInput:false,ctaAction:\"redirect\"},CODE:{include:[{type:\"contains\",url:\"\"}],exclude:[{type:\"contains\",url:null}]},AutoResponder:{mailServer:\"MAILCHIMP\",uid:\"\",formData:\"\"}};this.loaded=false;this.layouts=[\"asset/optin-layouts/0.png\",\"asset/optin-layouts/0.png\",\"asset/optin-layouts/0.png\"];this.getLayoutName=i=>{if(i==0)return\"Hello Bar\";if(i==1)return\"Hello Bar + Timer\";if(i==2)return\"Exit Intent\";if(i==3)return\"Autoplay Video\";if(i==4)return\"Purchase Proof\";};this.onLayoutChange=index=>{const{toolData}=this.state;this.setState({toolData:{...toolData,layout:index}});};this.onChangeActive=tabIndex=>{const{activeTab}=this.state;if(activeTab!==tabIndex){this.setState({activeTab:tabIndex});}};this.codeChange=data=>{this.setState({CODE:data});};this.changeAutoResponder=data=>{this.setState({AutoResponder:{...this.state.AutoResponder,...data}});};this.onUpdate=data=>{const{toolData}=this.state;this.setState({toolData:{...toolData,...data}});};this.renderMain=()=>{const{activeTab,toolData,CODE}=this.state;let component=null;if(!this.loaded)return null;switch(activeTab){case 1:component=/*#__PURE__*/_jsx(Video,{onVideoChange:this.onVideoChange,layout:toolData.layout,items:this.layouts,onChange:this.onUpdate});break;case 2:component=/*#__PURE__*/_jsx(Text,{text:toolData.text,isNameInput:toolData.isNameInput,subTitle:toolData.subTitle,layout:toolData.layout,onChange:this.onUpdate});break;case 3:component=/*#__PURE__*/_jsx(CTA,{cta:toolData.cta,ctaRedirectUrl:toolData.ctaRedirectUrl,ctaAction:toolData.ctaAction,position:toolData.position,layout:toolData.layout,onChange:this.onUpdate});break;case 4:component=/*#__PURE__*/_jsx(Style,{style:toolData.style,bgImg:toolData.bgImg,isBGIMG:toolData.isBGIMG,layout:toolData.layout,onChange:this.onUpdate});break;case 5:component=/*#__PURE__*/_jsx(Code,{...CODE,onChange:this.codeChange});break;case 6:component=/*#__PURE__*/_jsx(Time,{timerType:toolData.timerType,endDateTime:toolData.endDateTime,timeZone:toolData.timeZone,postExpiryAction:toolData.postExpiryAction,redirectUrl:toolData.redirectUrl,days:toolData.days,hours:toolData.hours,minutes:toolData.minutes,seconds:toolData.seconds,onChange:this.onUpdate});break;case 7:component=/*#__PURE__*/_jsx(Responders,{mailServer:this.state.AutoResponder.mailServer,uid:this.state.AutoResponder.uid,onChange:this.changeAutoResponder});break;case 8:component=/*#__PURE__*/_jsx(Image,{layout:toolData.layout,items:this.layouts,onChange:this.onUpdate});break;case 9:component=/*#__PURE__*/_jsx(Icons,{layout:toolData.layout,items:this.layouts,onChange:this.onUpdate});break;default:component=/*#__PURE__*/_jsx(Text,{onChange:this.onUpdate});break;}return component;};this.onClickSave=()=>{if(this.state.CODE.include[0].url!==\"\"){RequestHandler.PostRequest(SAVE_TOOL,{toolData:OptinFormModal(this.state)},(res,err)=>{if(res){const data1=res.data;if(data1.success){Modal.success({content:data1.message});setTimeout(()=>{this.props.history.push(\"/Campaigns\");},1000);}}});}else{Modal.warning({content:\"Should Contain atleast one trigger point\"});}};this.renderRight=()=>{const{toolData,activeTab}=this.state;if(toolData.layout===2&&toolData.isBGIMG){return/*#__PURE__*/_jsx(ReponsiveImage,{isImg:true,url:toolData.bgImg});}if(toolData.layout===0&&activeTab!==7){return/*#__PURE__*/_jsx(ReponsiveImage,{isAs:true,url:\"asset/hb3.png\"});}if(toolData.layout===1&&activeTab!==7){return/*#__PURE__*/_jsx(ReponsiveImage,{isAs:true,url:\"asset/hbt3.png\"});}if(toolData.layout===2&&activeTab!==7){return/*#__PURE__*/_jsx(ReponsiveImage,{isAs:true,url:\"asset/exit_pop_up.png\"});}};this.back=()=>{this.props.history.push(\"/Dashboard\");};this.togglePreview=()=>{const{preview}=this.state;this.setState({preview:!preview});};}componentWillMount(){if(window.gs.ie){const ie=getDefaultItems(window.gs.ie);let{toolData}=this.state;this.state.toolData={...toolData,...ie};window.gs.ie=null;}}componentDidMount(){const id=this.props.match?this.props.match.params?this.props.match.params.id:null:null;if(id){RequestHandler.PostRequest(GET_ONE_TOOL+id,{},(res,err)=>{this.loaded=true;if(res){Util.isRedirected=true;const data=OptinFormModalResponse(res);if(data){this.setState(data,()=>{window.gs.navTitle(ToolUtil.getTool(data.toolId)+\"  \"+this.getLayoutName(this.state.toolData.layout)+\"  \"+\"(\"+data.name+\")\");});}}});}else{let toolId=19;this.loaded=true;const defLayout=window.gs.defaultLayout||0;this.onLayoutChange(defLayout);if(defLayout===3){this.setState({activeTab:1});}this.setState({toolId:toolId,toolName:ToolUtil.getTool(toolId),name:Util.CAMPAIGNS_NAME});Util.RedirectWhenCampaignEmpty(this.props);window.gs.navTitle(ToolUtil.getTool(toolId)+\"  \"+this.getLayoutName(defLayout)+\"  \"+\"(\"+Util.CAMPAIGNS_NAME+\")\");delete window.gs.defaultLayout;}}render(){const{preview,activeTab}=this.state;return/*#__PURE__*/_jsxs(ToolLayout,{children:[preview?/*#__PURE__*/_jsx(Preview,{...this.state,onClose:this.togglePreview}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-10 toolItem\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:activeTab===7?\"col-md-12\":\"col-md-6\",children:this.renderMain()}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6 mt-2\",children:this.renderRight()}),/*#__PURE__*/_jsx(ButtonsGroup,{preview:()=>{this.setState({preview:!preview});},backUrl:this.back,save:this.onClickSave})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-1 sideBarButtomPanel\",children:/*#__PURE__*/_jsx(SideBar,{layout:this.state.toolData.layout,activeTab:this.state.activeTab,onChangeActive:this.onChangeActive})})]})]});}}","map":{"version":3,"sources":["/opt/bitnami/apache/htdocs/converzee-frontend/src/components/OptinForm/index.js"],"names":["React","Component","SideBar","ToolUtil","generateIframeContant","getDefaultItems","Util","generateFile","parseImgUrl","Text","Responders","CTA","ToolLayout","ButtonsGroup","getPath","GET_PIXEL","SAVE_TOOL","GET_ONE_TOOL","RequestHandler","Modal","Style","Code","OptinFormModalResponse","OptinFormModal","Time","Preview","ReponsiveImage","Video","Image","Icons","OptinForm","state","video","url","videoType","toolName","toolId","preview","_id","activeTab","toolData","text","cta","layout","style","name","id","value","timerType","endDateTime","Date","timeZone","getTimeZoneList","postExpiryAction","ctaRedirectUrl","redirectUrl","days","hours","minutes","seconds","bgImg","isBGIMG","noThanks","subTitle","position","isNameInput","ctaAction","CODE","include","type","exclude","AutoResponder","mailServer","uid","formData","loaded","layouts","getLayoutName","i","onLayoutChange","index","setState","onChangeActive","tabIndex","codeChange","data","changeAutoResponder","onUpdate","renderMain","component","onVideoChange","onClickSave","PostRequest","res","err","data1","success","content","message","setTimeout","props","history","push","warning","renderRight","back","togglePreview","componentWillMount","window","gs","ie","componentDidMount","match","params","isRedirected","navTitle","getTool","defLayout","defaultLayout","CAMPAIGNS_NAME","RedirectWhenCampaignEmpty","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport SideBar from \"./SideBar\";\r\nimport ToolUtil, { generateIframeContant, getDefaultItems } from \"../../utils/ToolUtil\";\r\nimport Util, { generateFile, parseImgUrl } from \"../Util\";\r\nimport Text from \"./Text\";\r\nimport Responders from \"./Responders\";\r\nimport CTA from \"./CTA\";\r\nimport { ToolLayout, ButtonsGroup } from \"../layout/ToolLayout\";\r\nimport { getPath, GET_PIXEL, SAVE_TOOL, GET_ONE_TOOL } from \"../../actions/URLs\";\r\nimport RequestHandler from \"../../actions/RequestHandler\";\r\nimport { Modal } from \"antd\";\r\nimport Style from \"./Style\";\r\nimport Code from \"./Code\";\r\nimport { OptinFormModalResponse, OptinFormModal } from \"../utils/Modal\";\r\nimport Time from \"./Time\";\r\nimport { Preview } from \"./Preview\";\r\nimport { ReponsiveImage } from \"../comman/PreviewAble\";\r\nimport Video from \"../pages/tools/VideoPopup/Video\";\r\nimport Image from \"../pages/tools/VideoPopup/Image\";\r\nimport Icons from \"./Icons\";\r\n\r\nexport default class OptinForm extends Component {\r\n  state = {\r\n    video: { url: \"\", videoType: \"youtube\" },\r\n    toolName: \"\",\r\n    toolId: \"\",\r\n    preview: false,\r\n    _id: null,\r\n    activeTab: 2,\r\n    toolData: {\r\n      text: '<span style=\"font-size: 36px;\"><font color=\"#ff9c00\">Converzee</font></span>',\r\n      cta: '<font color=\"#efefef\"><span style=\"font-size: 18px;\">Buy Now</span></font>',\r\n      layout: 0,\r\n      style: [\r\n        { name: \"Background\", id: \"backgound\", value: \"TRANSPARENT\" },\r\n        { name: \"CTA Backgound\", id: \"ctabackgound\", value: \"#ff3a65\" },\r\n      ],\r\n      timerType: \"DATE_AND_TIME_BASED\",\r\n      endDateTime: new Date(),\r\n      timeZone: Util.getTimeZoneList()[0].value,\r\n      postExpiryAction: \"hide\",\r\n      ctaRedirectUrl: \"\",\r\n      redirectUrl: \"\",\r\n      days: 2,\r\n      hours: 2,\r\n      minutes: 2,\r\n      seconds: 2,\r\n      bgImg: \"#fff\",\r\n      isBGIMG: false,\r\n      noThanks: \"No thanks\",\r\n      subTitle: \"Subtitle here\",\r\n      position: \"TOP\",\r\n      isNameInput: false,\r\n      ctaAction: \"redirect\",\r\n    },\r\n    CODE: { include: [{ type: \"contains\", url: \"\" }], exclude: [{ type: \"contains\", url: null }] },\r\n    AutoResponder: {\r\n      mailServer: \"MAILCHIMP\",\r\n      uid: \"\",\r\n      formData: \"\"\r\n    },\r\n  };\r\n  loaded = false;\r\n  layouts = [\"asset/optin-layouts/0.png\", \"asset/optin-layouts/0.png\", \"asset/optin-layouts/0.png\"];\r\n\r\n  componentWillMount() {\r\n    if (window.gs.ie) {\r\n      const ie = getDefaultItems(window.gs.ie);\r\n      let { toolData } = this.state;\r\n      this.state.toolData = { ...toolData, ...ie };\r\n      window.gs.ie = null;\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const id = this.props.match ? (this.props.match.params ? this.props.match.params.id : null) : null;\r\n    if (id) {\r\n      RequestHandler.PostRequest(GET_ONE_TOOL + id, {}, (res, err) => {\r\n        this.loaded = true;\r\n        if (res) {\r\n          Util.isRedirected = true;\r\n          const data = OptinFormModalResponse(res);\r\n          if (data) {\r\n            this.setState(data, () => {\r\n              window.gs.navTitle(ToolUtil.getTool(data.toolId) + \"  \" + this.getLayoutName(this.state.toolData.layout) + \"  \" + \"(\" + data.name + \")\");\r\n            });\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      let toolId = 19; this.loaded = true;\r\n      const defLayout = window.gs.defaultLayout || 0;\r\n      this.onLayoutChange(defLayout);\r\n      if(defLayout === 3){\r\n        this.setState({ activeTab: 1 });\r\n      }\r\n      this.setState({ toolId: toolId, toolName: ToolUtil.getTool(toolId), name: Util.CAMPAIGNS_NAME });\r\n      Util.RedirectWhenCampaignEmpty(this.props);\r\n      window.gs.navTitle(ToolUtil.getTool(toolId) + \"  \" + this.getLayoutName(defLayout) + \"  \" + \"(\" + Util.CAMPAIGNS_NAME + \")\");\r\n      delete window.gs.defaultLayout;\r\n    }\r\n\r\n  }\r\n  getLayoutName = (i) => {\r\n    if (i == 0) return \"Hello Bar\";\r\n    if (i == 1) return \"Hello Bar + Timer\";\r\n    if (i == 2) return \"Exit Intent\";\r\n    if (i == 3) return \"Autoplay Video\";\r\n    if (i == 4) return \"Purchase Proof\";\r\n  };\r\n  onLayoutChange = (index) => {\r\n    const { toolData } = this.state;\r\n    this.setState({ toolData: { ...toolData, layout: index } });\r\n  };\r\n\r\n  onChangeActive = (tabIndex) => {\r\n    const { activeTab } = this.state;\r\n    if (activeTab !== tabIndex) {\r\n      this.setState({ activeTab: tabIndex });\r\n    }\r\n  };\r\n\r\n  codeChange = (data) => {\r\n    this.setState({ CODE: data });\r\n  };\r\n\r\n  changeAutoResponder = (data) => {\r\n    this.setState({AutoResponder: { ...this.state.AutoResponder, ...data} });\r\n  }\r\n\r\n  onUpdate = (data) => {\r\n    const { toolData } = this.state;\r\n    this.setState({ toolData: { ...toolData, ...data } });\r\n  };\r\n\r\n  renderMain = () => {\r\n    const { activeTab, toolData, CODE } = this.state;\r\n    let component = null;\r\n    if (!this.loaded) return null;\r\n    switch (activeTab) {\r\n      case 1:\r\n        component = <Video onVideoChange={this.onVideoChange} layout={toolData.layout} items={this.layouts} onChange={this.onUpdate}/>;\r\n        break;\r\n      case 2:\r\n        component = <Text text={toolData.text} isNameInput={toolData.isNameInput} subTitle={toolData.subTitle} layout={toolData.layout} onChange={this.onUpdate} />;\r\n        break;\r\n      case 3:\r\n        component = <CTA cta={toolData.cta} ctaRedirectUrl={toolData.ctaRedirectUrl} ctaAction={toolData.ctaAction} position={toolData.position} layout={toolData.layout} onChange={this.onUpdate} />;\r\n        break;\r\n      case 4:\r\n        component = <Style style={toolData.style} bgImg={toolData.bgImg} isBGIMG={toolData.isBGIMG} layout={toolData.layout} onChange={this.onUpdate} />;\r\n        break;\r\n      case 5:\r\n        component = <Code {...CODE} onChange={this.codeChange} />;\r\n        break;\r\n      case 6:\r\n        component = (\r\n          <Time\r\n            timerType={toolData.timerType}\r\n            endDateTime={toolData.endDateTime}\r\n            timeZone={toolData.timeZone}\r\n            postExpiryAction={toolData.postExpiryAction}\r\n            redirectUrl={toolData.redirectUrl}\r\n            days={toolData.days}\r\n            hours={toolData.hours}\r\n            minutes={toolData.minutes}\r\n            seconds={toolData.seconds}\r\n            onChange={this.onUpdate}\r\n          />\r\n        );\r\n        break;\r\n      case 7:\r\n        component = <Responders mailServer={this.state.AutoResponder.mailServer} uid={this.state.AutoResponder.uid} onChange={this.changeAutoResponder} />;\r\n        break;\r\n      case 8:\r\n        component = <Image layout={toolData.layout} items={this.layouts} onChange={this.onUpdate} />;\r\n        break;\r\n      case 9:\r\n        component = <Icons layout={toolData.layout} items={this.layouts} onChange={this.onUpdate} />;\r\n        break;\r\n      default:\r\n        component = <Text onChange={this.onUpdate} />;\r\n        break;\r\n    }\r\n    return component;\r\n  };\r\n\r\n  onClickSave = () => {\r\n    if (this.state.CODE.include[0].url !== \"\") {\r\n      RequestHandler.PostRequest(SAVE_TOOL, { toolData: OptinFormModal(this.state) }, (res, err) => {\r\n        if (res) {\r\n          const data1 = res.data;\r\n          if (data1.success) {\r\n            Modal.success({\r\n              content: data1.message,\r\n            });\r\n            setTimeout(() => {\r\n              this.props.history.push(\"/Campaigns\");\r\n            }, 1000);\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      Modal.warning({\r\n        content: \"Should Contain atleast one trigger point\",\r\n      });\r\n    }\r\n  };\r\n\r\n  renderRight = () => {\r\n    const { toolData, activeTab } = this.state;\r\n    if (toolData.layout === 2 && toolData.isBGIMG) {\r\n      return <ReponsiveImage isImg={true} url={toolData.bgImg} />;\r\n    }\r\n    if (toolData.layout === 0 && activeTab !== 7) {\r\n      return <ReponsiveImage isAs={true} url={\"asset/hb3.png\"} />;\r\n    }\r\n    if (toolData.layout === 1 && activeTab !== 7) {\r\n      return <ReponsiveImage isAs={true} url={\"asset/hbt3.png\"} />;\r\n    }\r\n    if (toolData.layout === 2 && activeTab !== 7) {\r\n      return <ReponsiveImage isAs={true} url={\"asset/exit_pop_up.png\"} />;\r\n    }\r\n  };\r\n\r\n  back = () => {\r\n    this.props.history.push(\"/Dashboard\");\r\n  };\r\n\r\n  togglePreview = () => {\r\n    const { preview } = this.state;\r\n    this.setState({ preview: !preview });\r\n  };\r\n\r\n  render() {\r\n    const { preview, activeTab } = this.state;\r\n    return (\r\n      <ToolLayout>\r\n        {preview ? <Preview {...this.state} onClose={this.togglePreview} /> : null}\r\n        <div className=\"row\">\r\n          <div className=\"col-10 toolItem\">\r\n            <div className=\"row\">\r\n              <div className={ activeTab===7 ? \"col-md-12\":\"col-md-6\"}>{this.renderMain()}</div>\r\n              <div className=\"col-md-6 mt-2\">{this.renderRight()}</div>\r\n              <ButtonsGroup   \r\n               preview={ () => {\r\n                this.setState({ preview: !preview });\r\n              }}\r\n              backUrl={this.back}\r\n              save={this.onClickSave} />\r\n            </div>\r\n          </div>\r\n          <div className=\"col-1 sideBarButtomPanel\">\r\n            <SideBar layout={this.state.toolData.layout} activeTab={this.state.activeTab} onChangeActive={this.onChangeActive} />\r\n          </div>\r\n        </div>\r\n      </ToolLayout>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}