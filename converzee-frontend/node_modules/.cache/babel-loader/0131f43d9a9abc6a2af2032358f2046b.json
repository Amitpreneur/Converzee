{"ast":null,"code":"/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.10.2 (2021-11-17)\n */\n(function () {\n  'use strict';\n\n  var typeOf = function (x) {\n    var t = typeof x;\n\n    if (x === null) {\n      return 'null';\n    } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    } else {\n      return t;\n    }\n  };\n\n  var isType$1 = function (type) {\n    return function (value) {\n      return typeOf(value) === type;\n    };\n  };\n\n  var isSimpleType = function (type) {\n    return function (value) {\n      return typeof value === type;\n    };\n  };\n\n  var eq$1 = function (t) {\n    return function (a) {\n      return t === a;\n    };\n  };\n\n  var isString = isType$1('string');\n  var isObject = isType$1('object');\n  var isArray = isType$1('array');\n  var isNull = eq$1(null);\n  var isBoolean = isSimpleType('boolean');\n  var isUndefined = eq$1(undefined);\n\n  var isNullable = function (a) {\n    return a === null || a === undefined;\n  };\n\n  var isNonNullable = function (a) {\n    return !isNullable(a);\n  };\n\n  var isFunction = isSimpleType('function');\n  var isNumber = isSimpleType('number');\n\n  var isArrayOf = function (value, pred) {\n    if (isArray(value)) {\n      for (var i = 0, len = value.length; i < len; ++i) {\n        if (!pred(value[i])) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  var noop = function () {};\n\n  var noarg = function (f) {\n    return function () {\n      return f();\n    };\n  };\n\n  var compose = function (fa, fb) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return fa(fb.apply(null, args));\n    };\n  };\n\n  var compose1 = function (fbc, fab) {\n    return function (a) {\n      return fbc(fab(a));\n    };\n  };\n\n  var constant$1 = function (value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var identity$1 = function (x) {\n    return x;\n  };\n\n  var tripleEquals = function (a, b) {\n    return a === b;\n  };\n\n  function curry(fn) {\n    var initialArgs = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      initialArgs[_i - 1] = arguments[_i];\n    }\n\n    return function () {\n      var restArgs = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        restArgs[_i] = arguments[_i];\n      }\n\n      var all = initialArgs.concat(restArgs);\n      return fn.apply(null, all);\n    };\n  }\n\n  var not = function (f) {\n    return function (t) {\n      return !f(t);\n    };\n  };\n\n  var die = function (msg) {\n    return function () {\n      throw new Error(msg);\n    };\n  };\n\n  var never = constant$1(false);\n  var always = constant$1(true);\n  var global$g = tinymce.util.Tools.resolve('tinymce.ThemeManager');\n\n  var __assign = function () {\n    __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n\n      return t;\n    };\n\n    return __assign.apply(this, arguments);\n  };\n\n  function __rest(s, e) {\n    var t = {};\n\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n    if (s != null && typeof Object.getOwnPropertySymbols === 'function') for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n      if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n    }\n    return t;\n  }\n\n  function __spreadArray(to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n        if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n        ar[i] = from[i];\n      }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n  }\n\n  var none = function () {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var call = function (thunk) {\n      return thunk();\n    };\n\n    var id = identity$1;\n    var me = {\n      fold: function (n, _s) {\n        return n();\n      },\n      isSome: never,\n      isNone: always,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function (msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: constant$1(null),\n      getOrUndefined: constant$1(undefined),\n      or: id,\n      orThunk: call,\n      map: none,\n      each: noop,\n      bind: none,\n      exists: never,\n      forall: always,\n      filter: function () {\n        return none();\n      },\n      toArray: function () {\n        return [];\n      },\n      toString: constant$1('none()')\n    };\n    return me;\n  }();\n\n  var some = function (a) {\n    var constant_a = constant$1(a);\n\n    var self = function () {\n      return me;\n    };\n\n    var bind = function (f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function (n, s) {\n        return s(a);\n      },\n      isSome: always,\n      isNone: never,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: function (f) {\n        return some(f(a));\n      },\n      each: function (f) {\n        f(a);\n      },\n      bind: bind,\n      exists: bind,\n      forall: bind,\n      filter: function (f) {\n        return f(a) ? me : NONE;\n      },\n      toArray: function () {\n        return [a];\n      },\n      toString: function () {\n        return 'some(' + a + ')';\n      }\n    };\n    return me;\n  };\n\n  var from$1 = function (value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Optional = {\n    some: some,\n    none: none,\n    from: from$1\n  };\n  var nativeSlice = Array.prototype.slice;\n  var nativeIndexOf = Array.prototype.indexOf;\n  var nativePush = Array.prototype.push;\n\n  var rawIndexOf = function (ts, t) {\n    return nativeIndexOf.call(ts, t);\n  };\n\n  var indexOf = function (xs, x) {\n    var r = rawIndexOf(xs, x);\n    return r === -1 ? Optional.none() : Optional.some(r);\n  };\n\n  var contains$2 = function (xs, x) {\n    return rawIndexOf(xs, x) > -1;\n  };\n\n  var exists = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var range$2 = function (num, f) {\n    var r = [];\n\n    for (var i = 0; i < num; i++) {\n      r.push(f(i));\n    }\n\n    return r;\n  };\n\n  var chunk$1 = function (array, size) {\n    var r = [];\n\n    for (var i = 0; i < array.length; i += size) {\n      var s = nativeSlice.call(array, i, i + size);\n      r.push(s);\n    }\n\n    return r;\n  };\n\n  var map$2 = function (xs, f) {\n    var len = xs.length;\n    var r = new Array(len);\n\n    for (var i = 0; i < len; i++) {\n      var x = xs[i];\n      r[i] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var each$1 = function (xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var eachr = function (xs, f) {\n    for (var i = xs.length - 1; i >= 0; i--) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var partition$3 = function (xs, pred) {\n    var pass = [];\n    var fail = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      var arr = pred(x, i) ? pass : fail;\n      arr.push(x);\n    }\n\n    return {\n      pass: pass,\n      fail: fail\n    };\n  };\n\n  var filter$2 = function (xs, pred) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        r.push(x);\n      }\n    }\n\n    return r;\n  };\n\n  var foldr = function (xs, f, acc) {\n    eachr(xs, function (x, i) {\n      acc = f(acc, x, i);\n    });\n    return acc;\n  };\n\n  var foldl = function (xs, f, acc) {\n    each$1(xs, function (x, i) {\n      acc = f(acc, x, i);\n    });\n    return acc;\n  };\n\n  var findUntil = function (xs, pred, until) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(x);\n      } else if (until(x, i)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var find$5 = function (xs, pred) {\n    return findUntil(xs, pred, never);\n  };\n\n  var findIndex$1 = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(i);\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var flatten = function (xs) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (!isArray(xs[i])) {\n        throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n      }\n\n      nativePush.apply(r, xs[i]);\n    }\n\n    return r;\n  };\n\n  var bind$3 = function (xs, f) {\n    return flatten(map$2(xs, f));\n  };\n\n  var forall = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      var x = xs[i];\n\n      if (pred(x, i) !== true) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  var reverse = function (xs) {\n    var r = nativeSlice.call(xs, 0);\n    r.reverse();\n    return r;\n  };\n\n  var difference = function (a1, a2) {\n    return filter$2(a1, function (x) {\n      return !contains$2(a2, x);\n    });\n  };\n\n  var mapToObject = function (xs, f) {\n    var r = {};\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      r[String(x)] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var pure$2 = function (x) {\n    return [x];\n  };\n\n  var sort = function (xs, comparator) {\n    var copy = nativeSlice.call(xs, 0);\n    copy.sort(comparator);\n    return copy;\n  };\n\n  var get$f = function (xs, i) {\n    return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n  };\n\n  var head = function (xs) {\n    return get$f(xs, 0);\n  };\n\n  var last$2 = function (xs) {\n    return get$f(xs, xs.length - 1);\n  };\n\n  var from = isFunction(Array.from) ? Array.from : function (x) {\n    return nativeSlice.call(x);\n  };\n\n  var findMap = function (arr, f) {\n    for (var i = 0; i < arr.length; i++) {\n      var r = f(arr[i], i);\n\n      if (r.isSome()) {\n        return r;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var keys = Object.keys;\n  var hasOwnProperty = Object.hasOwnProperty;\n\n  var each = function (obj, f) {\n    var props = keys(obj);\n\n    for (var k = 0, len = props.length; k < len; k++) {\n      var i = props[k];\n      var x = obj[i];\n      f(x, i);\n    }\n  };\n\n  var map$1 = function (obj, f) {\n    return tupleMap(obj, function (x, i) {\n      return {\n        k: i,\n        v: f(x, i)\n      };\n    });\n  };\n\n  var tupleMap = function (obj, f) {\n    var r = {};\n    each(obj, function (x, i) {\n      var tuple = f(x, i);\n      r[tuple.k] = tuple.v;\n    });\n    return r;\n  };\n\n  var objAcc = function (r) {\n    return function (x, i) {\n      r[i] = x;\n    };\n  };\n\n  var internalFilter = function (obj, pred, onTrue, onFalse) {\n    var r = {};\n    each(obj, function (x, i) {\n      (pred(x, i) ? onTrue : onFalse)(x, i);\n    });\n    return r;\n  };\n\n  var filter$1 = function (obj, pred) {\n    var t = {};\n    internalFilter(obj, pred, objAcc(t), noop);\n    return t;\n  };\n\n  var mapToArray = function (obj, f) {\n    var r = [];\n    each(obj, function (value, name) {\n      r.push(f(value, name));\n    });\n    return r;\n  };\n\n  var find$4 = function (obj, pred) {\n    var props = keys(obj);\n\n    for (var k = 0, len = props.length; k < len; k++) {\n      var i = props[k];\n      var x = obj[i];\n\n      if (pred(x, i, obj)) {\n        return Optional.some(x);\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var values = function (obj) {\n    return mapToArray(obj, identity$1);\n  };\n\n  var get$e = function (obj, key) {\n    return has$2(obj, key) ? Optional.from(obj[key]) : Optional.none();\n  };\n\n  var has$2 = function (obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  var hasNonNullableKey = function (obj, key) {\n    return has$2(obj, key) && obj[key] !== undefined && obj[key] !== null;\n  };\n\n  var is$1 = function (lhs, rhs, comparator) {\n    if (comparator === void 0) {\n      comparator = tripleEquals;\n    }\n\n    return lhs.exists(function (left) {\n      return comparator(left, rhs);\n    });\n  };\n\n  var equals = function (lhs, rhs, comparator) {\n    if (comparator === void 0) {\n      comparator = tripleEquals;\n    }\n\n    return lift2(lhs, rhs, comparator).getOr(lhs.isNone() && rhs.isNone());\n  };\n\n  var cat = function (arr) {\n    var r = [];\n\n    var push = function (x) {\n      r.push(x);\n    };\n\n    for (var i = 0; i < arr.length; i++) {\n      arr[i].each(push);\n    }\n\n    return r;\n  };\n\n  var sequence = function (arr) {\n    var r = [];\n\n    for (var i = 0; i < arr.length; i++) {\n      var x = arr[i];\n\n      if (x.isSome()) {\n        r.push(x.getOrDie());\n      } else {\n        return Optional.none();\n      }\n    }\n\n    return Optional.some(r);\n  };\n\n  var lift2 = function (oa, ob, f) {\n    return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n  };\n\n  var lift3 = function (oa, ob, oc, f) {\n    return oa.isSome() && ob.isSome() && oc.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Optional.none();\n  };\n\n  var mapFrom = function (a, f) {\n    return a !== undefined && a !== null ? Optional.some(f(a)) : Optional.none();\n  };\n\n  var someIf = function (b, a) {\n    return b ? Optional.some(a) : Optional.none();\n  };\n\n  var addToEnd = function (str, suffix) {\n    return str + suffix;\n  };\n\n  var removeFromStart = function (str, numChars) {\n    return str.substring(numChars);\n  };\n\n  var checkRange = function (str, substr, start) {\n    return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n  };\n\n  var removeLeading = function (str, prefix) {\n    return startsWith(str, prefix) ? removeFromStart(str, prefix.length) : str;\n  };\n\n  var ensureTrailing = function (str, suffix) {\n    return endsWith(str, suffix) ? str : addToEnd(str, suffix);\n  };\n\n  var contains$1 = function (str, substr) {\n    return str.indexOf(substr) !== -1;\n  };\n\n  var startsWith = function (str, prefix) {\n    return checkRange(str, prefix, 0);\n  };\n\n  var endsWith = function (str, suffix) {\n    return checkRange(str, suffix, str.length - suffix.length);\n  };\n\n  var blank = function (r) {\n    return function (s) {\n      return s.replace(r, '');\n    };\n  };\n\n  var trim$1 = blank(/^\\s+|\\s+$/g);\n\n  var isNotEmpty = function (s) {\n    return s.length > 0;\n  };\n\n  var isEmpty = function (s) {\n    return !isNotEmpty(s);\n  };\n\n  var isSupported$1 = function (dom) {\n    return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n  };\n\n  var fromHtml$2 = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n\n    if (!div.hasChildNodes() || div.childNodes.length > 1) {\n      console.error('HTML does not have a single root node', html);\n      throw new Error('HTML must have a single root node');\n    }\n\n    return fromDom(div.childNodes[0]);\n  };\n\n  var fromTag = function (tag, scope) {\n    var doc = scope || document;\n    var node = doc.createElement(tag);\n    return fromDom(node);\n  };\n\n  var fromText = function (text, scope) {\n    var doc = scope || document;\n    var node = doc.createTextNode(text);\n    return fromDom(node);\n  };\n\n  var fromDom = function (node) {\n    if (node === null || node === undefined) {\n      throw new Error('Node cannot be null or undefined');\n    }\n\n    return {\n      dom: node\n    };\n  };\n\n  var fromPoint = function (docElm, x, y) {\n    return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n  };\n\n  var SugarElement = {\n    fromHtml: fromHtml$2,\n    fromTag: fromTag,\n    fromText: fromText,\n    fromDom: fromDom,\n    fromPoint: fromPoint\n  };\n  typeof window !== 'undefined' ? window : Function('return this;')();\n  var DOCUMENT = 9;\n  var DOCUMENT_FRAGMENT = 11;\n  var ELEMENT = 1;\n  var TEXT = 3;\n\n  var name$2 = function (element) {\n    var r = element.dom.nodeName;\n    return r.toLowerCase();\n  };\n\n  var type = function (element) {\n    return element.dom.nodeType;\n  };\n\n  var isType = function (t) {\n    return function (element) {\n      return type(element) === t;\n    };\n  };\n\n  var isElement$2 = isType(ELEMENT);\n  var isText$1 = isType(TEXT);\n  var isDocument = isType(DOCUMENT);\n  var isDocumentFragment = isType(DOCUMENT_FRAGMENT);\n\n  var cached = function (f) {\n    var called = false;\n    var r;\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (!called) {\n        called = true;\n        r = f.apply(null, args);\n      }\n\n      return r;\n    };\n  };\n\n  var DeviceType = function (os, browser, userAgent, mediaMatch) {\n    var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n    var isiPhone = os.isiOS() && !isiPad;\n    var isMobile = os.isiOS() || os.isAndroid();\n    var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n    var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n    var isPhone = isiPhone || isMobile && !isTablet;\n    var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n    var isDesktop = !isPhone && !isTablet && !iOSwebview;\n    return {\n      isiPad: constant$1(isiPad),\n      isiPhone: constant$1(isiPhone),\n      isTablet: constant$1(isTablet),\n      isPhone: constant$1(isPhone),\n      isTouch: constant$1(isTouch),\n      isAndroid: os.isAndroid,\n      isiOS: os.isiOS,\n      isWebView: constant$1(iOSwebview),\n      isDesktop: constant$1(isDesktop)\n    };\n  };\n\n  var firstMatch = function (regexes, s) {\n    for (var i = 0; i < regexes.length; i++) {\n      var x = regexes[i];\n\n      if (x.test(s)) {\n        return x;\n      }\n    }\n\n    return undefined;\n  };\n\n  var find$3 = function (regexes, agent) {\n    var r = firstMatch(regexes, agent);\n\n    if (!r) {\n      return {\n        major: 0,\n        minor: 0\n      };\n    }\n\n    var group = function (i) {\n      return Number(agent.replace(r, '$' + i));\n    };\n\n    return nu$d(group(1), group(2));\n  };\n\n  var detect$4 = function (versionRegexes, agent) {\n    var cleanedAgent = String(agent).toLowerCase();\n\n    if (versionRegexes.length === 0) {\n      return unknown$3();\n    }\n\n    return find$3(versionRegexes, cleanedAgent);\n  };\n\n  var unknown$3 = function () {\n    return nu$d(0, 0);\n  };\n\n  var nu$d = function (major, minor) {\n    return {\n      major: major,\n      minor: minor\n    };\n  };\n\n  var Version = {\n    nu: nu$d,\n    detect: detect$4,\n    unknown: unknown$3\n  };\n\n  var detectBrowser$1 = function (browsers, userAgentData) {\n    return findMap(userAgentData.brands, function (uaBrand) {\n      var lcBrand = uaBrand.brand.toLowerCase();\n      return find$5(browsers, function (browser) {\n        var _a;\n\n        return lcBrand === ((_a = browser.brand) === null || _a === void 0 ? void 0 : _a.toLowerCase());\n      }).map(function (info) {\n        return {\n          current: info.name,\n          version: Version.nu(parseInt(uaBrand.version, 10), 0)\n        };\n      });\n    });\n  };\n\n  var detect$3 = function (candidates, userAgent) {\n    var agent = String(userAgent).toLowerCase();\n    return find$5(candidates, function (candidate) {\n      return candidate.search(agent);\n    });\n  };\n\n  var detectBrowser = function (browsers, userAgent) {\n    return detect$3(browsers, userAgent).map(function (browser) {\n      var version = Version.detect(browser.versionRegexes, userAgent);\n      return {\n        current: browser.name,\n        version: version\n      };\n    });\n  };\n\n  var detectOs = function (oses, userAgent) {\n    return detect$3(oses, userAgent).map(function (os) {\n      var version = Version.detect(os.versionRegexes, userAgent);\n      return {\n        current: os.name,\n        version: version\n      };\n    });\n  };\n\n  var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n\n  var checkContains = function (target) {\n    return function (uastring) {\n      return contains$1(uastring, target);\n    };\n  };\n\n  var browsers = [{\n    name: 'Edge',\n    versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n    search: function (uastring) {\n      return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n    }\n  }, {\n    name: 'Chrome',\n    brand: 'Chromium',\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/, normalVersionRegex],\n    search: function (uastring) {\n      return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n    }\n  }, {\n    name: 'IE',\n    versionRegexes: [/.*?msie\\ ?([0-9]+)\\.([0-9]+).*/, /.*?rv:([0-9]+)\\.([0-9]+).*/],\n    search: function (uastring) {\n      return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n    }\n  }, {\n    name: 'Opera',\n    versionRegexes: [normalVersionRegex, /.*?opera\\/([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('opera')\n  }, {\n    name: 'Firefox',\n    versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('firefox')\n  }, {\n    name: 'Safari',\n    versionRegexes: [normalVersionRegex, /.*?cpu os ([0-9]+)_([0-9]+).*/],\n    search: function (uastring) {\n      return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n    }\n  }];\n  var oses = [{\n    name: 'Windows',\n    search: checkContains('win'),\n    versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'iOS',\n    search: function (uastring) {\n      return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n    },\n    versionRegexes: [/.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Android',\n    search: checkContains('android'),\n    versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'OSX',\n    search: checkContains('mac os x'),\n    versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Linux',\n    search: checkContains('linux'),\n    versionRegexes: []\n  }, {\n    name: 'Solaris',\n    search: checkContains('sunos'),\n    versionRegexes: []\n  }, {\n    name: 'FreeBSD',\n    search: checkContains('freebsd'),\n    versionRegexes: []\n  }, {\n    name: 'ChromeOS',\n    search: checkContains('cros'),\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n  }];\n  var PlatformInfo = {\n    browsers: constant$1(browsers),\n    oses: constant$1(oses)\n  };\n  var edge = 'Edge';\n  var chrome = 'Chrome';\n  var ie = 'IE';\n  var opera = 'Opera';\n  var firefox = 'Firefox';\n  var safari = 'Safari';\n\n  var unknown$2 = function () {\n    return nu$c({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$c = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isBrowser = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isEdge: isBrowser(edge),\n      isChrome: isBrowser(chrome),\n      isIE: isBrowser(ie),\n      isOpera: isBrowser(opera),\n      isFirefox: isBrowser(firefox),\n      isSafari: isBrowser(safari)\n    };\n  };\n\n  var Browser = {\n    unknown: unknown$2,\n    nu: nu$c,\n    edge: constant$1(edge),\n    chrome: constant$1(chrome),\n    ie: constant$1(ie),\n    opera: constant$1(opera),\n    firefox: constant$1(firefox),\n    safari: constant$1(safari)\n  };\n  var windows = 'Windows';\n  var ios = 'iOS';\n  var android = 'Android';\n  var linux = 'Linux';\n  var osx = 'OSX';\n  var solaris = 'Solaris';\n  var freebsd = 'FreeBSD';\n  var chromeos = 'ChromeOS';\n\n  var unknown$1 = function () {\n    return nu$b({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$b = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isOS = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isWindows: isOS(windows),\n      isiOS: isOS(ios),\n      isAndroid: isOS(android),\n      isOSX: isOS(osx),\n      isLinux: isOS(linux),\n      isSolaris: isOS(solaris),\n      isFreeBSD: isOS(freebsd),\n      isChromeOS: isOS(chromeos)\n    };\n  };\n\n  var OperatingSystem = {\n    unknown: unknown$1,\n    nu: nu$b,\n    windows: constant$1(windows),\n    ios: constant$1(ios),\n    android: constant$1(android),\n    linux: constant$1(linux),\n    osx: constant$1(osx),\n    solaris: constant$1(solaris),\n    freebsd: constant$1(freebsd),\n    chromeos: constant$1(chromeos)\n  };\n\n  var detect$2 = function (userAgent, userAgentDataOpt, mediaMatch) {\n    var browsers = PlatformInfo.browsers();\n    var oses = PlatformInfo.oses();\n    var browser = userAgentDataOpt.bind(function (userAgentData) {\n      return detectBrowser$1(browsers, userAgentData);\n    }).orThunk(function () {\n      return detectBrowser(browsers, userAgent);\n    }).fold(Browser.unknown, Browser.nu);\n    var os = detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n    var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n    return {\n      browser: browser,\n      os: os,\n      deviceType: deviceType\n    };\n  };\n\n  var PlatformDetection = {\n    detect: detect$2\n  };\n\n  var mediaMatch = function (query) {\n    return window.matchMedia(query).matches;\n  };\n\n  var platform = cached(function () {\n    return PlatformDetection.detect(navigator.userAgent, Optional.from(navigator.userAgentData), mediaMatch);\n  });\n\n  var detect$1 = function () {\n    return platform();\n  };\n\n  var compareDocumentPosition = function (a, b, match) {\n    return (a.compareDocumentPosition(b) & match) !== 0;\n  };\n\n  var documentPositionContainedBy = function (a, b) {\n    return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n  };\n\n  var is = function (element, selector) {\n    var dom = element.dom;\n\n    if (dom.nodeType !== ELEMENT) {\n      return false;\n    } else {\n      var elem = dom;\n\n      if (elem.matches !== undefined) {\n        return elem.matches(selector);\n      } else if (elem.msMatchesSelector !== undefined) {\n        return elem.msMatchesSelector(selector);\n      } else if (elem.webkitMatchesSelector !== undefined) {\n        return elem.webkitMatchesSelector(selector);\n      } else if (elem.mozMatchesSelector !== undefined) {\n        return elem.mozMatchesSelector(selector);\n      } else {\n        throw new Error('Browser lacks native selectors');\n      }\n    }\n  };\n\n  var bypassSelector = function (dom) {\n    return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n  };\n\n  var all$3 = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? [] : map$2(base.querySelectorAll(selector), SugarElement.fromDom);\n  };\n\n  var one = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n  };\n\n  var eq = function (e1, e2) {\n    return e1.dom === e2.dom;\n  };\n\n  var regularContains = function (e1, e2) {\n    var d1 = e1.dom;\n    var d2 = e2.dom;\n    return d1 === d2 ? false : d1.contains(d2);\n  };\n\n  var ieContains = function (e1, e2) {\n    return documentPositionContainedBy(e1.dom, e2.dom);\n  };\n\n  var contains = function (e1, e2) {\n    return detect$1().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n  };\n\n  var owner$4 = function (element) {\n    return SugarElement.fromDom(element.dom.ownerDocument);\n  };\n\n  var documentOrOwner = function (dos) {\n    return isDocument(dos) ? dos : owner$4(dos);\n  };\n\n  var documentElement = function (element) {\n    return SugarElement.fromDom(documentOrOwner(element).dom.documentElement);\n  };\n\n  var defaultView = function (element) {\n    return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n  };\n\n  var parent = function (element) {\n    return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n  };\n\n  var parentNode = function (element) {\n    return parent(element);\n  };\n\n  var offsetParent = function (element) {\n    return Optional.from(element.dom.offsetParent).map(SugarElement.fromDom);\n  };\n\n  var nextSibling = function (element) {\n    return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n  };\n\n  var children = function (element) {\n    return map$2(element.dom.childNodes, SugarElement.fromDom);\n  };\n\n  var child$2 = function (element, index) {\n    var cs = element.dom.childNodes;\n    return Optional.from(cs[index]).map(SugarElement.fromDom);\n  };\n\n  var firstChild = function (element) {\n    return child$2(element, 0);\n  };\n\n  var spot = function (element, offset) {\n    return {\n      element: element,\n      offset: offset\n    };\n  };\n\n  var leaf = function (element, offset) {\n    var cs = children(element);\n    return cs.length > 0 && offset < cs.length ? spot(cs[offset], 0) : spot(element, offset);\n  };\n\n  var isShadowRoot = function (dos) {\n    return isDocumentFragment(dos) && isNonNullable(dos.dom.host);\n  };\n\n  var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n  var isSupported = constant$1(supported);\n  var getRootNode = supported ? function (e) {\n    return SugarElement.fromDom(e.dom.getRootNode());\n  } : documentOrOwner;\n\n  var getContentContainer = function (dos) {\n    return isShadowRoot(dos) ? dos : SugarElement.fromDom(documentOrOwner(dos).dom.body);\n  };\n\n  var isInShadowRoot = function (e) {\n    return getShadowRoot(e).isSome();\n  };\n\n  var getShadowRoot = function (e) {\n    var r = getRootNode(e);\n    return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n  };\n\n  var getShadowHost = function (e) {\n    return SugarElement.fromDom(e.dom.host);\n  };\n\n  var getOriginalEventTarget = function (event) {\n    if (isSupported() && isNonNullable(event.target)) {\n      var el = SugarElement.fromDom(event.target);\n\n      if (isElement$2(el) && isOpenShadowHost(el)) {\n        if (event.composed && event.composedPath) {\n          var composedPath = event.composedPath();\n\n          if (composedPath) {\n            return head(composedPath);\n          }\n        }\n      }\n    }\n\n    return Optional.from(event.target);\n  };\n\n  var isOpenShadowHost = function (element) {\n    return isNonNullable(element.dom.shadowRoot);\n  };\n\n  var inBody = function (element) {\n    var dom = isText$1(element) ? element.dom.parentNode : element.dom;\n\n    if (dom === undefined || dom === null || dom.ownerDocument === null) {\n      return false;\n    }\n\n    var doc = dom.ownerDocument;\n    return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n      return doc.body.contains(dom);\n    }, compose1(inBody, getShadowHost));\n  };\n\n  var body = function () {\n    return getBody(SugarElement.fromDom(document));\n  };\n\n  var getBody = function (doc) {\n    var b = doc.dom.body;\n\n    if (b === null || b === undefined) {\n      throw new Error('Body is not available yet');\n    }\n\n    return SugarElement.fromDom(b);\n  };\n\n  var rawSet = function (dom, key, value) {\n    if (isString(value) || isBoolean(value) || isNumber(value)) {\n      dom.setAttribute(key, value + '');\n    } else {\n      console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n      throw new Error('Attribute value was not simple');\n    }\n  };\n\n  var set$8 = function (element, key, value) {\n    rawSet(element.dom, key, value);\n  };\n\n  var setAll$1 = function (element, attrs) {\n    var dom = element.dom;\n    each(attrs, function (v, k) {\n      rawSet(dom, k, v);\n    });\n  };\n\n  var get$d = function (element, key) {\n    var v = element.dom.getAttribute(key);\n    return v === null ? undefined : v;\n  };\n\n  var getOpt = function (element, key) {\n    return Optional.from(get$d(element, key));\n  };\n\n  var has$1 = function (element, key) {\n    var dom = element.dom;\n    return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n  };\n\n  var remove$7 = function (element, key) {\n    element.dom.removeAttribute(key);\n  };\n\n  var internalSet = function (dom, property, value) {\n    if (!isString(value)) {\n      console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n      throw new Error('CSS value must be a string: ' + value);\n    }\n\n    if (isSupported$1(dom)) {\n      dom.style.setProperty(property, value);\n    }\n  };\n\n  var internalRemove = function (dom, property) {\n    if (isSupported$1(dom)) {\n      dom.style.removeProperty(property);\n    }\n  };\n\n  var set$7 = function (element, property, value) {\n    var dom = element.dom;\n    internalSet(dom, property, value);\n  };\n\n  var setAll = function (element, css) {\n    var dom = element.dom;\n    each(css, function (v, k) {\n      internalSet(dom, k, v);\n    });\n  };\n\n  var setOptions = function (element, css) {\n    var dom = element.dom;\n    each(css, function (v, k) {\n      v.fold(function () {\n        internalRemove(dom, k);\n      }, function (value) {\n        internalSet(dom, k, value);\n      });\n    });\n  };\n\n  var get$c = function (element, property) {\n    var dom = element.dom;\n    var styles = window.getComputedStyle(dom);\n    var r = styles.getPropertyValue(property);\n    return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n  };\n\n  var getUnsafeProperty = function (dom, property) {\n    return isSupported$1(dom) ? dom.style.getPropertyValue(property) : '';\n  };\n\n  var getRaw = function (element, property) {\n    var dom = element.dom;\n    var raw = getUnsafeProperty(dom, property);\n    return Optional.from(raw).filter(function (r) {\n      return r.length > 0;\n    });\n  };\n\n  var getAllRaw = function (element) {\n    var css = {};\n    var dom = element.dom;\n\n    if (isSupported$1(dom)) {\n      for (var i = 0; i < dom.style.length; i++) {\n        var ruleName = dom.style.item(i);\n        css[ruleName] = dom.style[ruleName];\n      }\n    }\n\n    return css;\n  };\n\n  var isValidValue = function (tag, property, value) {\n    var element = SugarElement.fromTag(tag);\n    set$7(element, property, value);\n    var style = getRaw(element, property);\n    return style.isSome();\n  };\n\n  var remove$6 = function (element, property) {\n    var dom = element.dom;\n    internalRemove(dom, property);\n\n    if (is$1(getOpt(element, 'style').map(trim$1), '')) {\n      remove$7(element, 'style');\n    }\n  };\n\n  var reflow = function (e) {\n    return e.dom.offsetWidth;\n  };\n\n  var Dimension = function (name, getOffset) {\n    var set = function (element, h) {\n      if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n        throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n      }\n\n      var dom = element.dom;\n\n      if (isSupported$1(dom)) {\n        dom.style[name] = h + 'px';\n      }\n    };\n\n    var get = function (element) {\n      var r = getOffset(element);\n\n      if (r <= 0 || r === null) {\n        var css = get$c(element, name);\n        return parseFloat(css) || 0;\n      }\n\n      return r;\n    };\n\n    var getOuter = get;\n\n    var aggregate = function (element, properties) {\n      return foldl(properties, function (acc, property) {\n        var val = get$c(element, property);\n        var value = val === undefined ? 0 : parseInt(val, 10);\n        return isNaN(value) ? acc : acc + value;\n      }, 0);\n    };\n\n    var max = function (element, value, properties) {\n      var cumulativeInclusions = aggregate(element, properties);\n      var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n      return absoluteMax;\n    };\n\n    return {\n      set: set,\n      get: get,\n      getOuter: getOuter,\n      aggregate: aggregate,\n      max: max\n    };\n  };\n\n  var api$3 = Dimension('height', function (element) {\n    var dom = element.dom;\n    return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n  });\n\n  var get$b = function (element) {\n    return api$3.get(element);\n  };\n\n  var getOuter$2 = function (element) {\n    return api$3.getOuter(element);\n  };\n\n  var setMax$1 = function (element, value) {\n    var inclusions = ['margin-top', 'border-top-width', 'padding-top', 'padding-bottom', 'border-bottom-width', 'margin-bottom'];\n    var absMax = api$3.max(element, value, inclusions);\n    set$7(element, 'max-height', absMax + 'px');\n  };\n\n  var r$1 = function (left, top) {\n    var translate = function (x, y) {\n      return r$1(left + x, top + y);\n    };\n\n    return {\n      left: left,\n      top: top,\n      translate: translate\n    };\n  };\n\n  var SugarPosition = r$1;\n\n  var boxPosition = function (dom) {\n    var box = dom.getBoundingClientRect();\n    return SugarPosition(box.left, box.top);\n  };\n\n  var firstDefinedOrZero = function (a, b) {\n    if (a !== undefined) {\n      return a;\n    } else {\n      return b !== undefined ? b : 0;\n    }\n  };\n\n  var absolute$3 = function (element) {\n    var doc = element.dom.ownerDocument;\n    var body = doc.body;\n    var win = doc.defaultView;\n    var html = doc.documentElement;\n\n    if (body === element.dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n    var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n    var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n    var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n    return viewport$1(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n  };\n\n  var viewport$1 = function (element) {\n    var dom = element.dom;\n    var doc = dom.ownerDocument;\n    var body = doc.body;\n\n    if (body === dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    if (!inBody(element)) {\n      return SugarPosition(0, 0);\n    }\n\n    return boxPosition(dom);\n  };\n\n  var api$2 = Dimension('width', function (element) {\n    return element.dom.offsetWidth;\n  });\n\n  var set$6 = function (element, h) {\n    return api$2.set(element, h);\n  };\n\n  var get$a = function (element) {\n    return api$2.get(element);\n  };\n\n  var getOuter$1 = function (element) {\n    return api$2.getOuter(element);\n  };\n\n  var setMax = function (element, value) {\n    var inclusions = ['margin-left', 'border-left-width', 'padding-left', 'padding-right', 'border-right-width', 'margin-right'];\n    var absMax = api$2.max(element, value, inclusions);\n    set$7(element, 'max-width', absMax + 'px');\n  };\n\n  var mkEvent = function (target, x, y, stop, prevent, kill, raw) {\n    return {\n      target: target,\n      x: x,\n      y: y,\n      stop: stop,\n      prevent: prevent,\n      kill: kill,\n      raw: raw\n    };\n  };\n\n  var fromRawEvent$1 = function (rawEvent) {\n    var target = SugarElement.fromDom(getOriginalEventTarget(rawEvent).getOr(rawEvent.target));\n\n    var stop = function () {\n      return rawEvent.stopPropagation();\n    };\n\n    var prevent = function () {\n      return rawEvent.preventDefault();\n    };\n\n    var kill = compose(prevent, stop);\n    return mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n  };\n\n  var handle = function (filter, handler) {\n    return function (rawEvent) {\n      if (filter(rawEvent)) {\n        handler(fromRawEvent$1(rawEvent));\n      }\n    };\n  };\n\n  var binder = function (element, event, filter, handler, useCapture) {\n    var wrapped = handle(filter, handler);\n    element.dom.addEventListener(event, wrapped, useCapture);\n    return {\n      unbind: curry(unbind, element, event, wrapped, useCapture)\n    };\n  };\n\n  var bind$2 = function (element, event, filter, handler) {\n    return binder(element, event, filter, handler, false);\n  };\n\n  var capture$1 = function (element, event, filter, handler) {\n    return binder(element, event, filter, handler, true);\n  };\n\n  var unbind = function (element, event, handler, useCapture) {\n    element.dom.removeEventListener(event, handler, useCapture);\n  };\n\n  var before$2 = function (marker, element) {\n    var parent$1 = parent(marker);\n    parent$1.each(function (v) {\n      v.dom.insertBefore(element.dom, marker.dom);\n    });\n  };\n\n  var after$2 = function (marker, element) {\n    var sibling = nextSibling(marker);\n    sibling.fold(function () {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        append$2(v, element);\n      });\n    }, function (v) {\n      before$2(v, element);\n    });\n  };\n\n  var prepend$1 = function (parent, element) {\n    var firstChild$1 = firstChild(parent);\n    firstChild$1.fold(function () {\n      append$2(parent, element);\n    }, function (v) {\n      parent.dom.insertBefore(element.dom, v.dom);\n    });\n  };\n\n  var append$2 = function (parent, element) {\n    parent.dom.appendChild(element.dom);\n  };\n\n  var appendAt = function (parent, element, index) {\n    child$2(parent, index).fold(function () {\n      append$2(parent, element);\n    }, function (v) {\n      before$2(v, element);\n    });\n  };\n\n  var before$1 = function (marker, elements) {\n    each$1(elements, function (x) {\n      before$2(marker, x);\n    });\n  };\n\n  var append$1 = function (parent, elements) {\n    each$1(elements, function (x) {\n      append$2(parent, x);\n    });\n  };\n\n  var empty = function (element) {\n    element.dom.textContent = '';\n    each$1(children(element), function (rogue) {\n      remove$5(rogue);\n    });\n  };\n\n  var remove$5 = function (element) {\n    var dom = element.dom;\n\n    if (dom.parentNode !== null) {\n      dom.parentNode.removeChild(dom);\n    }\n  };\n\n  var unwrap = function (wrapper) {\n    var children$1 = children(wrapper);\n\n    if (children$1.length > 0) {\n      before$1(wrapper, children$1);\n    }\n\n    remove$5(wrapper);\n  };\n\n  var get$9 = function (_DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n    var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n    return SugarPosition(x, y);\n  };\n\n  var to = function (x, y, _DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var win = doc.defaultView;\n\n    if (win) {\n      win.scrollTo(x, y);\n    }\n  };\n\n  var get$8 = function (_win) {\n    var win = _win === undefined ? window : _win;\n\n    if (detect$1().browser.isFirefox()) {\n      return Optional.none();\n    } else {\n      return Optional.from(win['visualViewport']);\n    }\n  };\n\n  var bounds$1 = function (x, y, width, height) {\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height,\n      right: x + width,\n      bottom: y + height\n    };\n  };\n\n  var getBounds$3 = function (_win) {\n    var win = _win === undefined ? window : _win;\n    var doc = win.document;\n    var scroll = get$9(SugarElement.fromDom(doc));\n    return get$8(win).fold(function () {\n      var html = win.document.documentElement;\n      var width = html.clientWidth;\n      var height = html.clientHeight;\n      return bounds$1(scroll.left, scroll.top, width, height);\n    }, function (visualViewport) {\n      return bounds$1(Math.max(visualViewport.pageLeft, scroll.left), Math.max(visualViewport.pageTop, scroll.top), visualViewport.width, visualViewport.height);\n    });\n  };\n\n  var walkUp = function (navigation, doc) {\n    var frame = navigation.view(doc);\n    return frame.fold(constant$1([]), function (f) {\n      var parent = navigation.owner(f);\n      var rest = walkUp(navigation, parent);\n      return [f].concat(rest);\n    });\n  };\n\n  var pathTo = function (element, navigation) {\n    var d = navigation.owner(element);\n    var paths = walkUp(navigation, d);\n    return Optional.some(paths);\n  };\n\n  var view = function (doc) {\n    var _a;\n\n    var element = doc.dom === document ? Optional.none() : Optional.from((_a = doc.dom.defaultView) === null || _a === void 0 ? void 0 : _a.frameElement);\n    return element.map(SugarElement.fromDom);\n  };\n\n  var owner$3 = function (element) {\n    return owner$4(element);\n  };\n\n  var Navigation = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    view: view,\n    owner: owner$3\n  });\n\n  var find$2 = function (element) {\n    var doc = SugarElement.fromDom(document);\n    var scroll = get$9(doc);\n    var path = pathTo(element, Navigation);\n    return path.fold(curry(absolute$3, element), function (frames) {\n      var offset = viewport$1(element);\n      var r = foldr(frames, function (b, a) {\n        var loc = viewport$1(a);\n        return {\n          left: b.left + loc.left,\n          top: b.top + loc.top\n        };\n      }, {\n        left: 0,\n        top: 0\n      });\n      return SugarPosition(r.left + offset.left + scroll.left, r.top + offset.top + scroll.top);\n    });\n  };\n\n  var pointed = function (point, width, height) {\n    return {\n      point: point,\n      width: width,\n      height: height\n    };\n  };\n\n  var rect = function (x, y, width, height) {\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n  };\n\n  var bounds = function (x, y, width, height) {\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height,\n      right: x + width,\n      bottom: y + height\n    };\n  };\n\n  var box$1 = function (element) {\n    var xy = absolute$3(element);\n    var w = getOuter$1(element);\n    var h = getOuter$2(element);\n    return bounds(xy.left, xy.top, w, h);\n  };\n\n  var absolute$2 = function (element) {\n    var position = find$2(element);\n    var width = getOuter$1(element);\n    var height = getOuter$2(element);\n    return bounds(position.left, position.top, width, height);\n  };\n\n  var win = function () {\n    return getBounds$3(window);\n  };\n\n  var value$3 = function (o) {\n    var or = function (_opt) {\n      return value$3(o);\n    };\n\n    var orThunk = function (_f) {\n      return value$3(o);\n    };\n\n    var map = function (f) {\n      return value$3(f(o));\n    };\n\n    var mapError = function (_f) {\n      return value$3(o);\n    };\n\n    var each = function (f) {\n      f(o);\n    };\n\n    var bind = function (f) {\n      return f(o);\n    };\n\n    var fold = function (_, onValue) {\n      return onValue(o);\n    };\n\n    var exists = function (f) {\n      return f(o);\n    };\n\n    var forall = function (f) {\n      return f(o);\n    };\n\n    var toOptional = function () {\n      return Optional.some(o);\n    };\n\n    return {\n      isValue: always,\n      isError: never,\n      getOr: constant$1(o),\n      getOrThunk: constant$1(o),\n      getOrDie: constant$1(o),\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: each,\n      bind: bind,\n      exists: exists,\n      forall: forall,\n      toOptional: toOptional\n    };\n  };\n\n  var error$1 = function (message) {\n    var getOrThunk = function (f) {\n      return f();\n    };\n\n    var getOrDie = function () {\n      return die(String(message))();\n    };\n\n    var or = identity$1;\n\n    var orThunk = function (f) {\n      return f();\n    };\n\n    var map = function (_f) {\n      return error$1(message);\n    };\n\n    var mapError = function (f) {\n      return error$1(f(message));\n    };\n\n    var bind = function (_f) {\n      return error$1(message);\n    };\n\n    var fold = function (onError, _) {\n      return onError(message);\n    };\n\n    return {\n      isValue: never,\n      isError: always,\n      getOr: identity$1,\n      getOrThunk: getOrThunk,\n      getOrDie: getOrDie,\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: noop,\n      bind: bind,\n      exists: never,\n      forall: always,\n      toOptional: Optional.none\n    };\n  };\n\n  var fromOption = function (opt, err) {\n    return opt.fold(function () {\n      return error$1(err);\n    }, value$3);\n  };\n\n  var Result = {\n    value: value$3,\n    error: error$1,\n    fromOption: fromOption\n  };\n  var SimpleResultType;\n\n  (function (SimpleResultType) {\n    SimpleResultType[SimpleResultType['Error'] = 0] = 'Error';\n    SimpleResultType[SimpleResultType['Value'] = 1] = 'Value';\n  })(SimpleResultType || (SimpleResultType = {}));\n\n  var fold$1 = function (res, onError, onValue) {\n    return res.stype === SimpleResultType.Error ? onError(res.serror) : onValue(res.svalue);\n  };\n\n  var partition$2 = function (results) {\n    var values = [];\n    var errors = [];\n    each$1(results, function (obj) {\n      fold$1(obj, function (err) {\n        return errors.push(err);\n      }, function (val) {\n        return values.push(val);\n      });\n    });\n    return {\n      values: values,\n      errors: errors\n    };\n  };\n\n  var mapError = function (res, f) {\n    if (res.stype === SimpleResultType.Error) {\n      return {\n        stype: SimpleResultType.Error,\n        serror: f(res.serror)\n      };\n    } else {\n      return res;\n    }\n  };\n\n  var map = function (res, f) {\n    if (res.stype === SimpleResultType.Value) {\n      return {\n        stype: SimpleResultType.Value,\n        svalue: f(res.svalue)\n      };\n    } else {\n      return res;\n    }\n  };\n\n  var bind$1 = function (res, f) {\n    if (res.stype === SimpleResultType.Value) {\n      return f(res.svalue);\n    } else {\n      return res;\n    }\n  };\n\n  var bindError = function (res, f) {\n    if (res.stype === SimpleResultType.Error) {\n      return f(res.serror);\n    } else {\n      return res;\n    }\n  };\n\n  var svalue = function (v) {\n    return {\n      stype: SimpleResultType.Value,\n      svalue: v\n    };\n  };\n\n  var serror = function (e) {\n    return {\n      stype: SimpleResultType.Error,\n      serror: e\n    };\n  };\n\n  var toResult$1 = function (res) {\n    return fold$1(res, Result.error, Result.value);\n  };\n\n  var fromResult$1 = function (res) {\n    return res.fold(serror, svalue);\n  };\n\n  var SimpleResult = {\n    fromResult: fromResult$1,\n    toResult: toResult$1,\n    svalue: svalue,\n    partition: partition$2,\n    serror: serror,\n    bind: bind$1,\n    bindError: bindError,\n    map: map,\n    mapError: mapError,\n    fold: fold$1\n  };\n\n  var field$2 = function (key, newKey, presence, prop) {\n    return {\n      tag: 'field',\n      key: key,\n      newKey: newKey,\n      presence: presence,\n      prop: prop\n    };\n  };\n\n  var customField$1 = function (newKey, instantiator) {\n    return {\n      tag: 'custom',\n      newKey: newKey,\n      instantiator: instantiator\n    };\n  };\n\n  var fold = function (value, ifField, ifCustom) {\n    switch (value.tag) {\n      case 'field':\n        return ifField(value.key, value.newKey, value.presence, value.prop);\n\n      case 'custom':\n        return ifCustom(value.newKey, value.instantiator);\n    }\n  };\n\n  var shallow$1 = function (old, nu) {\n    return nu;\n  };\n\n  var deep = function (old, nu) {\n    var bothObjects = isObject(old) && isObject(nu);\n    return bothObjects ? deepMerge(old, nu) : nu;\n  };\n\n  var baseMerge = function (merger) {\n    return function () {\n      var objects = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        objects[_i] = arguments[_i];\n      }\n\n      if (objects.length === 0) {\n        throw new Error('Can\\'t merge zero objects');\n      }\n\n      var ret = {};\n\n      for (var j = 0; j < objects.length; j++) {\n        var curObject = objects[j];\n\n        for (var key in curObject) {\n          if (has$2(curObject, key)) {\n            ret[key] = merger(ret[key], curObject[key]);\n          }\n        }\n      }\n\n      return ret;\n    };\n  };\n\n  var deepMerge = baseMerge(deep);\n  var merge$1 = baseMerge(shallow$1);\n\n  var required$2 = function () {\n    return {\n      tag: 'required',\n      process: {}\n    };\n  };\n\n  var defaultedThunk = function (fallbackThunk) {\n    return {\n      tag: 'defaultedThunk',\n      process: fallbackThunk\n    };\n  };\n\n  var defaulted$1 = function (fallback) {\n    return defaultedThunk(constant$1(fallback));\n  };\n\n  var asOption = function () {\n    return {\n      tag: 'option',\n      process: {}\n    };\n  };\n\n  var mergeWithThunk = function (baseThunk) {\n    return {\n      tag: 'mergeWithThunk',\n      process: baseThunk\n    };\n  };\n\n  var mergeWith = function (base) {\n    return mergeWithThunk(constant$1(base));\n  };\n\n  var mergeValues$1 = function (values, base) {\n    return values.length > 0 ? SimpleResult.svalue(deepMerge(base, merge$1.apply(undefined, values))) : SimpleResult.svalue(base);\n  };\n\n  var mergeErrors$1 = function (errors) {\n    return compose(SimpleResult.serror, flatten)(errors);\n  };\n\n  var consolidateObj = function (objects, base) {\n    var partition = SimpleResult.partition(objects);\n    return partition.errors.length > 0 ? mergeErrors$1(partition.errors) : mergeValues$1(partition.values, base);\n  };\n\n  var consolidateArr = function (objects) {\n    var partitions = SimpleResult.partition(objects);\n    return partitions.errors.length > 0 ? mergeErrors$1(partitions.errors) : SimpleResult.svalue(partitions.values);\n  };\n\n  var ResultCombine = {\n    consolidateObj: consolidateObj,\n    consolidateArr: consolidateArr\n  };\n\n  var formatObj = function (input) {\n    return isObject(input) && keys(input).length > 100 ? ' removed due to size' : JSON.stringify(input, null, 2);\n  };\n\n  var formatErrors = function (errors) {\n    var es = errors.length > 10 ? errors.slice(0, 10).concat([{\n      path: [],\n      getErrorInfo: constant$1('... (only showing first ten failures)')\n    }]) : errors;\n    return map$2(es, function (e) {\n      return 'Failed path: (' + e.path.join(' > ') + ')\\n' + e.getErrorInfo();\n    });\n  };\n\n  var nu$a = function (path, getErrorInfo) {\n    return SimpleResult.serror([{\n      path: path,\n      getErrorInfo: getErrorInfo\n    }]);\n  };\n\n  var missingRequired = function (path, key, obj) {\n    return nu$a(path, function () {\n      return 'Could not find valid *required* value for \"' + key + '\" in ' + formatObj(obj);\n    });\n  };\n\n  var missingKey = function (path, key) {\n    return nu$a(path, function () {\n      return 'Choice schema did not contain choice key: \"' + key + '\"';\n    });\n  };\n\n  var missingBranch = function (path, branches, branch) {\n    return nu$a(path, function () {\n      return 'The chosen schema: \"' + branch + '\" did not exist in branches: ' + formatObj(branches);\n    });\n  };\n\n  var unsupportedFields = function (path, unsupported) {\n    return nu$a(path, function () {\n      return 'There are unsupported fields: [' + unsupported.join(', ') + '] specified';\n    });\n  };\n\n  var custom = function (path, err) {\n    return nu$a(path, constant$1(err));\n  };\n\n  var value$2 = function (validator) {\n    var extract = function (path, val) {\n      return SimpleResult.bindError(validator(val), function (err) {\n        return custom(path, err);\n      });\n    };\n\n    var toString = constant$1('val');\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var anyValue$1 = value$2(SimpleResult.svalue);\n\n  var requiredAccess = function (path, obj, key, bundle) {\n    return get$e(obj, key).fold(function () {\n      return missingRequired(path, key, obj);\n    }, bundle);\n  };\n\n  var fallbackAccess = function (obj, key, fallback, bundle) {\n    var v = get$e(obj, key).getOrThunk(function () {\n      return fallback(obj);\n    });\n    return bundle(v);\n  };\n\n  var optionAccess = function (obj, key, bundle) {\n    return bundle(get$e(obj, key));\n  };\n\n  var optionDefaultedAccess = function (obj, key, fallback, bundle) {\n    var opt = get$e(obj, key).map(function (val) {\n      return val === true ? fallback(obj) : val;\n    });\n    return bundle(opt);\n  };\n\n  var extractField = function (field, path, obj, key, prop) {\n    var bundle = function (av) {\n      return prop.extract(path.concat([key]), av);\n    };\n\n    var bundleAsOption = function (optValue) {\n      return optValue.fold(function () {\n        return SimpleResult.svalue(Optional.none());\n      }, function (ov) {\n        var result = prop.extract(path.concat([key]), ov);\n        return SimpleResult.map(result, Optional.some);\n      });\n    };\n\n    switch (field.tag) {\n      case 'required':\n        return requiredAccess(path, obj, key, bundle);\n\n      case 'defaultedThunk':\n        return fallbackAccess(obj, key, field.process, bundle);\n\n      case 'option':\n        return optionAccess(obj, key, bundleAsOption);\n\n      case 'defaultedOptionThunk':\n        return optionDefaultedAccess(obj, key, field.process, bundleAsOption);\n\n      case 'mergeWithThunk':\n        {\n          return fallbackAccess(obj, key, constant$1({}), function (v) {\n            var result = deepMerge(field.process(obj), v);\n            return bundle(result);\n          });\n        }\n    }\n  };\n\n  var extractFields = function (path, obj, fields) {\n    var success = {};\n    var errors = [];\n\n    for (var _i = 0, fields_1 = fields; _i < fields_1.length; _i++) {\n      var field = fields_1[_i];\n      fold(field, function (key, newKey, presence, prop) {\n        var result = extractField(presence, path, obj, key, prop);\n        SimpleResult.fold(result, function (err) {\n          errors.push.apply(errors, err);\n        }, function (res) {\n          success[newKey] = res;\n        });\n      }, function (newKey, instantiator) {\n        success[newKey] = instantiator(obj);\n      });\n    }\n\n    return errors.length > 0 ? SimpleResult.serror(errors) : SimpleResult.svalue(success);\n  };\n\n  var valueThunk = function (getDelegate) {\n    var extract = function (path, val) {\n      return getDelegate().extract(path, val);\n    };\n\n    var toString = function () {\n      return getDelegate().toString();\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var getSetKeys = function (obj) {\n    return keys(filter$1(obj, isNonNullable));\n  };\n\n  var objOfOnly = function (fields) {\n    var delegate = objOf(fields);\n    var fieldNames = foldr(fields, function (acc, value) {\n      return fold(value, function (key) {\n        var _a;\n\n        return deepMerge(acc, (_a = {}, _a[key] = true, _a));\n      }, constant$1(acc));\n    }, {});\n\n    var extract = function (path, o) {\n      var keys = isBoolean(o) ? [] : getSetKeys(o);\n      var extra = filter$2(keys, function (k) {\n        return !hasNonNullableKey(fieldNames, k);\n      });\n      return extra.length === 0 ? delegate.extract(path, o) : unsupportedFields(path, extra);\n    };\n\n    return {\n      extract: extract,\n      toString: delegate.toString\n    };\n  };\n\n  var objOf = function (values) {\n    var extract = function (path, o) {\n      return extractFields(path, o, values);\n    };\n\n    var toString = function () {\n      var fieldStrings = map$2(values, function (value) {\n        return fold(value, function (key, _okey, _presence, prop) {\n          return key + ' -> ' + prop.toString();\n        }, function (newKey, _instantiator) {\n          return 'state(' + newKey + ')';\n        });\n      });\n      return 'obj{\\n' + fieldStrings.join('\\n') + '}';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var arrOf = function (prop) {\n    var extract = function (path, array) {\n      var results = map$2(array, function (a, i) {\n        return prop.extract(path.concat(['[' + i + ']']), a);\n      });\n      return ResultCombine.consolidateArr(results);\n    };\n\n    var toString = function () {\n      return 'array(' + prop.toString() + ')';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var oneOf = function (props) {\n    var extract = function (path, val) {\n      var errors = [];\n\n      for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {\n        var prop = props_1[_i];\n        var res = prop.extract(path, val);\n\n        if (res.stype === SimpleResultType.Value) {\n          return res;\n        }\n\n        errors.push(res);\n      }\n\n      return ResultCombine.consolidateArr(errors);\n    };\n\n    var toString = function () {\n      return 'oneOf(' + map$2(props, function (prop) {\n        return prop.toString();\n      }).join(', ') + ')';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var setOf$1 = function (validator, prop) {\n    var validateKeys = function (path, keys) {\n      return arrOf(value$2(validator)).extract(path, keys);\n    };\n\n    var extract = function (path, o) {\n      var keys$1 = keys(o);\n      var validatedKeys = validateKeys(path, keys$1);\n      return SimpleResult.bind(validatedKeys, function (validKeys) {\n        var schema = map$2(validKeys, function (vk) {\n          return field$2(vk, vk, required$2(), prop);\n        });\n        return objOf(schema).extract(path, o);\n      });\n    };\n\n    var toString = function () {\n      return 'setOf(' + prop.toString() + ')';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var thunk = function (_desc, processor) {\n    var getP = cached(processor);\n\n    var extract = function (path, val) {\n      return getP().extract(path, val);\n    };\n\n    var toString = function () {\n      return getP().toString();\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var arrOfObj = compose(arrOf, objOf);\n  var anyValue = constant$1(anyValue$1);\n\n  var typedValue = function (validator, expectedType) {\n    return value$2(function (a) {\n      var actualType = typeof a;\n      return validator(a) ? SimpleResult.svalue(a) : SimpleResult.serror('Expected type: ' + expectedType + ' but got: ' + actualType);\n    });\n  };\n\n  var number = typedValue(isNumber, 'number');\n  var string = typedValue(isString, 'string');\n  var boolean = typedValue(isBoolean, 'boolean');\n  var functionProcessor = typedValue(isFunction, 'function');\n\n  var isPostMessageable = function (val) {\n    if (Object(val) !== val) {\n      return true;\n    }\n\n    switch ({}.toString.call(val).slice(8, -1)) {\n      case 'Boolean':\n      case 'Number':\n      case 'String':\n      case 'Date':\n      case 'RegExp':\n      case 'Blob':\n      case 'FileList':\n      case 'ImageData':\n      case 'ImageBitmap':\n      case 'ArrayBuffer':\n        return true;\n\n      case 'Array':\n      case 'Object':\n        return Object.keys(val).every(function (prop) {\n          return isPostMessageable(val[prop]);\n        });\n\n      default:\n        return false;\n    }\n  };\n\n  var postMessageable = value$2(function (a) {\n    if (isPostMessageable(a)) {\n      return SimpleResult.svalue(a);\n    } else {\n      return SimpleResult.serror('Expected value to be acceptable for sending via postMessage');\n    }\n  });\n\n  var chooseFrom = function (path, input, branches, ch) {\n    var fields = get$e(branches, ch);\n    return fields.fold(function () {\n      return missingBranch(path, branches, ch);\n    }, function (vp) {\n      return vp.extract(path.concat(['branch: ' + ch]), input);\n    });\n  };\n\n  var choose$2 = function (key, branches) {\n    var extract = function (path, input) {\n      var choice = get$e(input, key);\n      return choice.fold(function () {\n        return missingKey(path, key);\n      }, function (chosen) {\n        return chooseFrom(path, input, branches, chosen);\n      });\n    };\n\n    var toString = function () {\n      return 'chooseOn(' + key + '). Possible values: ' + keys(branches);\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var arrOfVal = function () {\n    return arrOf(anyValue$1);\n  };\n\n  var valueOf = function (validator) {\n    return value$2(function (v) {\n      return validator(v).fold(SimpleResult.serror, SimpleResult.svalue);\n    });\n  };\n\n  var setOf = function (validator, prop) {\n    return setOf$1(function (v) {\n      return SimpleResult.fromResult(validator(v));\n    }, prop);\n  };\n\n  var extractValue = function (label, prop, obj) {\n    var res = prop.extract([label], obj);\n    return SimpleResult.mapError(res, function (errs) {\n      return {\n        input: obj,\n        errors: errs\n      };\n    });\n  };\n\n  var asRaw = function (label, prop, obj) {\n    return SimpleResult.toResult(extractValue(label, prop, obj));\n  };\n\n  var getOrDie = function (extraction) {\n    return extraction.fold(function (errInfo) {\n      throw new Error(formatError(errInfo));\n    }, identity$1);\n  };\n\n  var asRawOrDie$1 = function (label, prop, obj) {\n    return getOrDie(asRaw(label, prop, obj));\n  };\n\n  var formatError = function (errInfo) {\n    return 'Errors: \\n' + formatErrors(errInfo.errors).join('\\n') + '\\n\\nInput object: ' + formatObj(errInfo.input);\n  };\n\n  var choose$1 = function (key, branches) {\n    return choose$2(key, map$1(branches, objOf));\n  };\n\n  var thunkOf = function (desc, schema) {\n    return thunk(desc, schema);\n  };\n\n  var field$1 = field$2;\n  var customField = customField$1;\n\n  var validateEnum = function (values) {\n    return valueOf(function (value) {\n      return contains$2(values, value) ? Result.value(value) : Result.error('Unsupported value: \"' + value + '\", choose one of \"' + values.join(', ') + '\".');\n    });\n  };\n\n  var required$1 = function (key) {\n    return field$1(key, key, required$2(), anyValue());\n  };\n\n  var requiredOf = function (key, schema) {\n    return field$1(key, key, required$2(), schema);\n  };\n\n  var requiredNumber = function (key) {\n    return requiredOf(key, number);\n  };\n\n  var requiredString = function (key) {\n    return requiredOf(key, string);\n  };\n\n  var requiredStringEnum = function (key, values) {\n    return field$1(key, key, required$2(), validateEnum(values));\n  };\n\n  var requiredBoolean = function (key) {\n    return requiredOf(key, boolean);\n  };\n\n  var requiredFunction = function (key) {\n    return requiredOf(key, functionProcessor);\n  };\n\n  var forbid = function (key, message) {\n    return field$1(key, key, asOption(), value$2(function (_v) {\n      return SimpleResult.serror('The field: ' + key + ' is forbidden. ' + message);\n    }));\n  };\n\n  var requiredObjOf = function (key, objSchema) {\n    return field$1(key, key, required$2(), objOf(objSchema));\n  };\n\n  var requiredArrayOfObj = function (key, objFields) {\n    return field$1(key, key, required$2(), arrOfObj(objFields));\n  };\n\n  var requiredArrayOf = function (key, schema) {\n    return field$1(key, key, required$2(), arrOf(schema));\n  };\n\n  var option = function (key) {\n    return field$1(key, key, asOption(), anyValue());\n  };\n\n  var optionOf = function (key, schema) {\n    return field$1(key, key, asOption(), schema);\n  };\n\n  var optionNumber = function (key) {\n    return optionOf(key, number);\n  };\n\n  var optionString = function (key) {\n    return optionOf(key, string);\n  };\n\n  var optionFunction = function (key) {\n    return optionOf(key, functionProcessor);\n  };\n\n  var optionArrayOf = function (key, schema) {\n    return optionOf(key, arrOf(schema));\n  };\n\n  var optionObjOf = function (key, objSchema) {\n    return optionOf(key, objOf(objSchema));\n  };\n\n  var optionObjOfOnly = function (key, objSchema) {\n    return optionOf(key, objOfOnly(objSchema));\n  };\n\n  var defaulted = function (key, fallback) {\n    return field$1(key, key, defaulted$1(fallback), anyValue());\n  };\n\n  var defaultedOf = function (key, fallback, schema) {\n    return field$1(key, key, defaulted$1(fallback), schema);\n  };\n\n  var defaultedNumber = function (key, fallback) {\n    return defaultedOf(key, fallback, number);\n  };\n\n  var defaultedString = function (key, fallback) {\n    return defaultedOf(key, fallback, string);\n  };\n\n  var defaultedStringEnum = function (key, fallback, values) {\n    return defaultedOf(key, fallback, validateEnum(values));\n  };\n\n  var defaultedBoolean = function (key, fallback) {\n    return defaultedOf(key, fallback, boolean);\n  };\n\n  var defaultedFunction = function (key, fallback) {\n    return defaultedOf(key, fallback, functionProcessor);\n  };\n\n  var defaultedPostMsg = function (key, fallback) {\n    return defaultedOf(key, fallback, postMessageable);\n  };\n\n  var defaultedArrayOf = function (key, fallback, schema) {\n    return defaultedOf(key, fallback, arrOf(schema));\n  };\n\n  var defaultedObjOf = function (key, fallback, objSchema) {\n    return defaultedOf(key, fallback, objOf(objSchema));\n  };\n\n  var Cell = function (initial) {\n    var value = initial;\n\n    var get = function () {\n      return value;\n    };\n\n    var set = function (v) {\n      value = v;\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var generate$7 = function (cases) {\n    if (!isArray(cases)) {\n      throw new Error('cases must be an array');\n    }\n\n    if (cases.length === 0) {\n      throw new Error('there must be at least one case');\n    }\n\n    var constructors = [];\n    var adt = {};\n    each$1(cases, function (acase, count) {\n      var keys$1 = keys(acase);\n\n      if (keys$1.length !== 1) {\n        throw new Error('one and only one name per case');\n      }\n\n      var key = keys$1[0];\n      var value = acase[key];\n\n      if (adt[key] !== undefined) {\n        throw new Error('duplicate key detected:' + key);\n      } else if (key === 'cata') {\n        throw new Error('cannot have a case named cata (sorry)');\n      } else if (!isArray(value)) {\n        throw new Error('case arguments must be an array');\n      }\n\n      constructors.push(key);\n\n      adt[key] = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        var argLength = args.length;\n\n        if (argLength !== value.length) {\n          throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n        }\n\n        var match = function (branches) {\n          var branchKeys = keys(branches);\n\n          if (constructors.length !== branchKeys.length) {\n            throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n          }\n\n          var allReqd = forall(constructors, function (reqKey) {\n            return contains$2(branchKeys, reqKey);\n          });\n\n          if (!allReqd) {\n            throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n          }\n\n          return branches[key].apply(null, args);\n        };\n\n        return {\n          fold: function () {\n            var foldArgs = [];\n\n            for (var _i = 0; _i < arguments.length; _i++) {\n              foldArgs[_i] = arguments[_i];\n            }\n\n            if (foldArgs.length !== cases.length) {\n              throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n            }\n\n            var target = foldArgs[count];\n            return target.apply(null, args);\n          },\n          match: match,\n          log: function (label) {\n            console.log(label, {\n              constructors: constructors,\n              constructor: key,\n              params: args\n            });\n          }\n        };\n      };\n    });\n    return adt;\n  };\n\n  var Adt = {\n    generate: generate$7\n  };\n  Adt.generate([{\n    bothErrors: ['error1', 'error2']\n  }, {\n    firstError: ['error1', 'value2']\n  }, {\n    secondError: ['value1', 'error2']\n  }, {\n    bothValues: ['value1', 'value2']\n  }]);\n\n  var partition$1 = function (results) {\n    var errors = [];\n    var values = [];\n    each$1(results, function (result) {\n      result.fold(function (err) {\n        errors.push(err);\n      }, function (value) {\n        values.push(value);\n      });\n    });\n    return {\n      errors: errors,\n      values: values\n    };\n  };\n\n  var exclude$1 = function (obj, fields) {\n    var r = {};\n    each(obj, function (v, k) {\n      if (!contains$2(fields, k)) {\n        r[k] = v;\n      }\n    });\n    return r;\n  };\n\n  var wrap$2 = function (key, value) {\n    var _a;\n\n    return _a = {}, _a[key] = value, _a;\n  };\n\n  var wrapAll$1 = function (keyvalues) {\n    var r = {};\n    each$1(keyvalues, function (kv) {\n      r[kv.key] = kv.value;\n    });\n    return r;\n  };\n\n  var exclude = function (obj, fields) {\n    return exclude$1(obj, fields);\n  };\n\n  var wrap$1 = function (key, value) {\n    return wrap$2(key, value);\n  };\n\n  var wrapAll = function (keyvalues) {\n    return wrapAll$1(keyvalues);\n  };\n\n  var mergeValues = function (values, base) {\n    return values.length === 0 ? Result.value(base) : Result.value(deepMerge(base, merge$1.apply(undefined, values)));\n  };\n\n  var mergeErrors = function (errors) {\n    return Result.error(flatten(errors));\n  };\n\n  var consolidate = function (objs, base) {\n    var partitions = partition$1(objs);\n    return partitions.errors.length > 0 ? mergeErrors(partitions.errors) : mergeValues(partitions.values, base);\n  };\n\n  var ensureIsRoot = function (isRoot) {\n    return isFunction(isRoot) ? isRoot : never;\n  };\n\n  var ancestor$2 = function (scope, transform, isRoot) {\n    var element = scope.dom;\n    var stop = ensureIsRoot(isRoot);\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = SugarElement.fromDom(element);\n      var transformed = transform(el);\n\n      if (transformed.isSome()) {\n        return transformed;\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var closest$4 = function (scope, transform, isRoot) {\n    var current = transform(scope);\n    var stop = ensureIsRoot(isRoot);\n    return current.orThunk(function () {\n      return stop(scope) ? Optional.none() : ancestor$2(scope, transform, stop);\n    });\n  };\n\n  var isSource = function (component, simulatedEvent) {\n    return eq(component.element, simulatedEvent.event.target);\n  };\n\n  var defaultEventHandler = {\n    can: always,\n    abort: never,\n    run: noop\n  };\n\n  var nu$9 = function (parts) {\n    if (!hasNonNullableKey(parts, 'can') && !hasNonNullableKey(parts, 'abort') && !hasNonNullableKey(parts, 'run')) {\n      throw new Error('EventHandler defined by: ' + JSON.stringify(parts, null, 2) + ' does not have can, abort, or run!');\n    }\n\n    return __assign(__assign({}, defaultEventHandler), parts);\n  };\n\n  var all$2 = function (handlers, f) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return foldl(handlers, function (acc, handler) {\n        return acc && f(handler).apply(undefined, args);\n      }, true);\n    };\n  };\n\n  var any = function (handlers, f) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return foldl(handlers, function (acc, handler) {\n        return acc || f(handler).apply(undefined, args);\n      }, false);\n    };\n  };\n\n  var read$2 = function (handler) {\n    return isFunction(handler) ? {\n      can: always,\n      abort: never,\n      run: handler\n    } : handler;\n  };\n\n  var fuse$1 = function (handlers) {\n    var can = all$2(handlers, function (handler) {\n      return handler.can;\n    });\n    var abort = any(handlers, function (handler) {\n      return handler.abort;\n    });\n\n    var run = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      each$1(handlers, function (handler) {\n        handler.run.apply(undefined, args);\n      });\n    };\n\n    return {\n      can: can,\n      abort: abort,\n      run: run\n    };\n  };\n\n  var constant = constant$1;\n  var touchstart = constant('touchstart');\n  var touchmove = constant('touchmove');\n  var touchend = constant('touchend');\n  var touchcancel = constant('touchcancel');\n  var mousedown = constant('mousedown');\n  var mousemove = constant('mousemove');\n  var mouseout = constant('mouseout');\n  var mouseup = constant('mouseup');\n  var mouseover = constant('mouseover');\n  var focusin = constant('focusin');\n  var focusout = constant('focusout');\n  var keydown = constant('keydown');\n  var keyup = constant('keyup');\n  var input = constant('input');\n  var change = constant('change');\n  var click = constant('click');\n  var transitioncancel = constant('transitioncancel');\n  var transitionend = constant('transitionend');\n  var transitionstart = constant('transitionstart');\n  var selectstart = constant('selectstart');\n\n  var prefixName = function (name) {\n    return constant$1('alloy.' + name);\n  };\n\n  var alloy = {\n    tap: prefixName('tap')\n  };\n  var focus$4 = prefixName('focus');\n  var postBlur = prefixName('blur.post');\n  var postPaste = prefixName('paste.post');\n  var receive = prefixName('receive');\n  var execute$5 = prefixName('execute');\n  var focusItem = prefixName('focus.item');\n  var tap = alloy.tap;\n  var longpress = prefixName('longpress');\n  var sandboxClose = prefixName('sandbox.close');\n  var typeaheadCancel = prefixName('typeahead.cancel');\n  var systemInit = prefixName('system.init');\n  var documentTouchmove = prefixName('system.touchmove');\n  var documentTouchend = prefixName('system.touchend');\n  var windowScroll = prefixName('system.scroll');\n  var windowResize = prefixName('system.resize');\n  var attachedToDom = prefixName('system.attached');\n  var detachedFromDom = prefixName('system.detached');\n  var dismissRequested = prefixName('system.dismissRequested');\n  var repositionRequested = prefixName('system.repositionRequested');\n  var focusShifted = prefixName('focusmanager.shifted');\n  var slotVisibility = prefixName('slotcontainer.visibility');\n  var changeTab = prefixName('change.tab');\n  var dismissTab = prefixName('dismiss.tab');\n  var highlight$1 = prefixName('highlight');\n  var dehighlight$1 = prefixName('dehighlight');\n\n  var emit = function (component, event) {\n    dispatchWith(component, component.element, event, {});\n  };\n\n  var emitWith = function (component, event, properties) {\n    dispatchWith(component, component.element, event, properties);\n  };\n\n  var emitExecute = function (component) {\n    emit(component, execute$5());\n  };\n\n  var dispatch = function (component, target, event) {\n    dispatchWith(component, target, event, {});\n  };\n\n  var dispatchWith = function (component, target, event, properties) {\n    var data = __assign({\n      target: target\n    }, properties);\n\n    component.getSystem().triggerEvent(event, target, data);\n  };\n\n  var dispatchEvent = function (component, target, event, simulatedEvent) {\n    component.getSystem().triggerEvent(event, target, simulatedEvent.event);\n  };\n\n  var derive$2 = function (configs) {\n    return wrapAll(configs);\n  };\n\n  var abort = function (name, predicate) {\n    return {\n      key: name,\n      value: nu$9({\n        abort: predicate\n      })\n    };\n  };\n\n  var can = function (name, predicate) {\n    return {\n      key: name,\n      value: nu$9({\n        can: predicate\n      })\n    };\n  };\n\n  var preventDefault = function (name) {\n    return {\n      key: name,\n      value: nu$9({\n        run: function (component, simulatedEvent) {\n          simulatedEvent.event.prevent();\n        }\n      })\n    };\n  };\n\n  var run$1 = function (name, handler) {\n    return {\n      key: name,\n      value: nu$9({\n        run: handler\n      })\n    };\n  };\n\n  var runActionExtra = function (name, action, extra) {\n    return {\n      key: name,\n      value: nu$9({\n        run: function (component, simulatedEvent) {\n          action.apply(undefined, [component, simulatedEvent].concat(extra));\n        }\n      })\n    };\n  };\n\n  var runOnName = function (name) {\n    return function (handler) {\n      return run$1(name, handler);\n    };\n  };\n\n  var runOnSourceName = function (name) {\n    return function (handler) {\n      return {\n        key: name,\n        value: nu$9({\n          run: function (component, simulatedEvent) {\n            if (isSource(component, simulatedEvent)) {\n              handler(component, simulatedEvent);\n            }\n          }\n        })\n      };\n    };\n  };\n\n  var redirectToUid = function (name, uid) {\n    return run$1(name, function (component, simulatedEvent) {\n      component.getSystem().getByUid(uid).each(function (redirectee) {\n        dispatchEvent(redirectee, redirectee.element, name, simulatedEvent);\n      });\n    });\n  };\n\n  var redirectToPart = function (name, detail, partName) {\n    var uid = detail.partUids[partName];\n    return redirectToUid(name, uid);\n  };\n\n  var runWithTarget = function (name, f) {\n    return run$1(name, function (component, simulatedEvent) {\n      var ev = simulatedEvent.event;\n      var target = component.getSystem().getByDom(ev.target).getOrThunk(function () {\n        var closest = closest$4(ev.target, function (el) {\n          return component.getSystem().getByDom(el).toOptional();\n        }, never);\n        return closest.getOr(component);\n      });\n      f(component, target, simulatedEvent);\n    });\n  };\n\n  var cutter = function (name) {\n    return run$1(name, function (component, simulatedEvent) {\n      simulatedEvent.cut();\n    });\n  };\n\n  var stopper = function (name) {\n    return run$1(name, function (component, simulatedEvent) {\n      simulatedEvent.stop();\n    });\n  };\n\n  var runOnSource = function (name, f) {\n    return runOnSourceName(name)(f);\n  };\n\n  var runOnAttached = runOnSourceName(attachedToDom());\n  var runOnDetached = runOnSourceName(detachedFromDom());\n  var runOnInit = runOnSourceName(systemInit());\n  var runOnExecute$1 = runOnName(execute$5());\n\n  var fromHtml$1 = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n    return children(SugarElement.fromDom(div));\n  };\n\n  var get$7 = function (element) {\n    return element.dom.innerHTML;\n  };\n\n  var set$5 = function (element, content) {\n    var owner = owner$4(element);\n    var docDom = owner.dom;\n    var fragment = SugarElement.fromDom(docDom.createDocumentFragment());\n    var contentElements = fromHtml$1(content, docDom);\n    append$1(fragment, contentElements);\n    empty(element);\n    append$2(element, fragment);\n  };\n\n  var getOuter = function (element) {\n    var container = SugarElement.fromTag('div');\n    var clone = SugarElement.fromDom(element.dom.cloneNode(true));\n    append$2(container, clone);\n    return get$7(container);\n  };\n\n  var clone$1 = function (original, isDeep) {\n    return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n  };\n\n  var shallow = function (original) {\n    return clone$1(original, false);\n  };\n\n  var getHtml = function (element) {\n    if (isShadowRoot(element)) {\n      return '#shadow-root';\n    } else {\n      var clone = shallow(element);\n      return getOuter(clone);\n    }\n  };\n\n  var element = function (elem) {\n    return getHtml(elem);\n  };\n\n  var isRecursive = function (component, originator, target) {\n    return eq(originator, component.element) && !eq(originator, target);\n  };\n\n  var events$i = derive$2([can(focus$4(), function (component, simulatedEvent) {\n    var event = simulatedEvent.event;\n    var originator = event.originator;\n    var target = event.target;\n\n    if (isRecursive(component, originator, target)) {\n      console.warn(focus$4() + ' did not get interpreted by the desired target. ' + '\\nOriginator: ' + element(originator) + '\\nTarget: ' + element(target) + '\\nCheck the ' + focus$4() + ' event handlers');\n      return false;\n    } else {\n      return true;\n    }\n  })]);\n  var DefaultEvents = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$i\n  });\n  var unique = 0;\n\n  var generate$6 = function (prefix) {\n    var date = new Date();\n    var time = date.getTime();\n    var random = Math.floor(Math.random() * 1000000000);\n    unique++;\n    return prefix + '_' + random + unique + String(time);\n  };\n\n  var prefix$1 = constant$1('alloy-id-');\n  var idAttr$1 = constant$1('data-alloy-id');\n  var prefix = prefix$1();\n  var idAttr = idAttr$1();\n\n  var write = function (label, elem) {\n    var id = generate$6(prefix + label);\n    writeOnly(elem, id);\n    return id;\n  };\n\n  var writeOnly = function (elem, uid) {\n    Object.defineProperty(elem.dom, idAttr, {\n      value: uid,\n      writable: true\n    });\n  };\n\n  var read$1 = function (elem) {\n    var id = isElement$2(elem) ? elem.dom[idAttr] : null;\n    return Optional.from(id);\n  };\n\n  var generate$5 = function (prefix) {\n    return generate$6(prefix);\n  };\n\n  var make$8 = identity$1;\n\n  var NoContextApi = function (getComp) {\n    var getMessage = function (event) {\n      return 'The component must be in a context to execute: ' + event + (getComp ? '\\n' + element(getComp().element) + ' is not in context.' : '');\n    };\n\n    var fail = function (event) {\n      return function () {\n        throw new Error(getMessage(event));\n      };\n    };\n\n    var warn = function (event) {\n      return function () {\n        console.warn(getMessage(event));\n      };\n    };\n\n    return {\n      debugInfo: constant$1('fake'),\n      triggerEvent: warn('triggerEvent'),\n      triggerFocus: warn('triggerFocus'),\n      triggerEscape: warn('triggerEscape'),\n      broadcast: warn('broadcast'),\n      broadcastOn: warn('broadcastOn'),\n      broadcastEvent: warn('broadcastEvent'),\n      build: fail('build'),\n      addToWorld: fail('addToWorld'),\n      removeFromWorld: fail('removeFromWorld'),\n      addToGui: fail('addToGui'),\n      removeFromGui: fail('removeFromGui'),\n      getByUid: fail('getByUid'),\n      getByDom: fail('getByDom'),\n      isConnected: never\n    };\n  };\n\n  var singleton$1 = NoContextApi();\n\n  var markAsBehaviourApi = function (f, apiName, apiFunction) {\n    var delegate = apiFunction.toString();\n    var endIndex = delegate.indexOf(')') + 1;\n    var openBracketIndex = delegate.indexOf('(');\n    var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n\n    f.toFunctionAnnotation = function () {\n      return {\n        name: apiName,\n        parameters: cleanParameters(parameters.slice(0, 1).concat(parameters.slice(3)))\n      };\n    };\n\n    return f;\n  };\n\n  var cleanParameters = function (parameters) {\n    return map$2(parameters, function (p) {\n      return endsWith(p, '/*') ? p.substring(0, p.length - '/*'.length) : p;\n    });\n  };\n\n  var markAsExtraApi = function (f, extraName) {\n    var delegate = f.toString();\n    var endIndex = delegate.indexOf(')') + 1;\n    var openBracketIndex = delegate.indexOf('(');\n    var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n\n    f.toFunctionAnnotation = function () {\n      return {\n        name: extraName,\n        parameters: cleanParameters(parameters)\n      };\n    };\n\n    return f;\n  };\n\n  var markAsSketchApi = function (f, apiFunction) {\n    var delegate = apiFunction.toString();\n    var endIndex = delegate.indexOf(')') + 1;\n    var openBracketIndex = delegate.indexOf('(');\n    var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n\n    f.toFunctionAnnotation = function () {\n      return {\n        name: 'OVERRIDE',\n        parameters: cleanParameters(parameters.slice(1))\n      };\n    };\n\n    return f;\n  };\n\n  var premadeTag = generate$6('alloy-premade');\n\n  var premade$1 = function (comp) {\n    return wrap$1(premadeTag, comp);\n  };\n\n  var getPremade = function (spec) {\n    return get$e(spec, premadeTag);\n  };\n\n  var makeApi = function (f) {\n    return markAsSketchApi(function (component) {\n      var rest = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        rest[_i - 1] = arguments[_i];\n      }\n\n      return f.apply(void 0, __spreadArray([component.getApis(), component], rest, false));\n    }, f);\n  };\n\n  var NoState = {\n    init: function () {\n      return nu$8({\n        readState: constant$1('No State required')\n      });\n    }\n  };\n\n  var nu$8 = function (spec) {\n    return spec;\n  };\n\n  var generateFrom$1 = function (spec, all) {\n    var schema = map$2(all, function (a) {\n      return optionObjOf(a.name(), [required$1('config'), defaulted('state', NoState)]);\n    });\n    var validated = asRaw('component.behaviours', objOf(schema), spec.behaviours).fold(function (errInfo) {\n      throw new Error(formatError(errInfo) + '\\nComplete spec:\\n' + JSON.stringify(spec, null, 2));\n    }, identity$1);\n    return {\n      list: all,\n      data: map$1(validated, function (optBlobThunk) {\n        var output = optBlobThunk.map(function (blob) {\n          return {\n            config: blob.config,\n            state: blob.state.init(blob.config)\n          };\n        });\n        return constant$1(output);\n      })\n    };\n  };\n\n  var getBehaviours$3 = function (bData) {\n    return bData.list;\n  };\n\n  var getData$2 = function (bData) {\n    return bData.data;\n  };\n\n  var byInnerKey = function (data, tuple) {\n    var r = {};\n    each(data, function (detail, key) {\n      each(detail, function (value, indexKey) {\n        var chain = get$e(r, indexKey).getOr([]);\n        r[indexKey] = chain.concat([tuple(key, value)]);\n      });\n    });\n    return r;\n  };\n\n  var nu$7 = function (s) {\n    return {\n      classes: isUndefined(s.classes) ? [] : s.classes,\n      attributes: isUndefined(s.attributes) ? {} : s.attributes,\n      styles: isUndefined(s.styles) ? {} : s.styles\n    };\n  };\n\n  var merge = function (defnA, mod) {\n    return __assign(__assign({}, defnA), {\n      attributes: __assign(__assign({}, defnA.attributes), mod.attributes),\n      styles: __assign(__assign({}, defnA.styles), mod.styles),\n      classes: defnA.classes.concat(mod.classes)\n    });\n  };\n\n  var combine$2 = function (info, baseMod, behaviours, base) {\n    var modsByBehaviour = __assign({}, baseMod);\n\n    each$1(behaviours, function (behaviour) {\n      modsByBehaviour[behaviour.name()] = behaviour.exhibit(info, base);\n    });\n    var byAspect = byInnerKey(modsByBehaviour, function (name, modification) {\n      return {\n        name: name,\n        modification: modification\n      };\n    });\n\n    var combineObjects = function (objects) {\n      return foldr(objects, function (b, a) {\n        return __assign(__assign({}, a.modification), b);\n      }, {});\n    };\n\n    var combinedClasses = foldr(byAspect.classes, function (b, a) {\n      return a.modification.concat(b);\n    }, []);\n    var combinedAttributes = combineObjects(byAspect.attributes);\n    var combinedStyles = combineObjects(byAspect.styles);\n    return nu$7({\n      classes: combinedClasses,\n      attributes: combinedAttributes,\n      styles: combinedStyles\n    });\n  };\n\n  var sortKeys = function (label, keyName, array, order) {\n    try {\n      var sorted = sort(array, function (a, b) {\n        var aKey = a[keyName];\n        var bKey = b[keyName];\n        var aIndex = order.indexOf(aKey);\n        var bIndex = order.indexOf(bKey);\n\n        if (aIndex === -1) {\n          throw new Error('The ordering for ' + label + ' does not have an entry for ' + aKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n        }\n\n        if (bIndex === -1) {\n          throw new Error('The ordering for ' + label + ' does not have an entry for ' + bKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n        }\n\n        if (aIndex < bIndex) {\n          return -1;\n        } else if (bIndex < aIndex) {\n          return 1;\n        } else {\n          return 0;\n        }\n      });\n      return Result.value(sorted);\n    } catch (err) {\n      return Result.error([err]);\n    }\n  };\n\n  var uncurried = function (handler, purpose) {\n    return {\n      handler: handler,\n      purpose: purpose\n    };\n  };\n\n  var curried = function (handler, purpose) {\n    return {\n      cHandler: handler,\n      purpose: purpose\n    };\n  };\n\n  var curryArgs = function (descHandler, extraArgs) {\n    return curried(curry.apply(undefined, [descHandler.handler].concat(extraArgs)), descHandler.purpose);\n  };\n\n  var getCurried = function (descHandler) {\n    return descHandler.cHandler;\n  };\n\n  var behaviourTuple = function (name, handler) {\n    return {\n      name: name,\n      handler: handler\n    };\n  };\n\n  var nameToHandlers = function (behaviours, info) {\n    var r = {};\n    each$1(behaviours, function (behaviour) {\n      r[behaviour.name()] = behaviour.handlers(info);\n    });\n    return r;\n  };\n\n  var groupByEvents = function (info, behaviours, base) {\n    var behaviourEvents = __assign(__assign({}, base), nameToHandlers(behaviours, info));\n\n    return byInnerKey(behaviourEvents, behaviourTuple);\n  };\n\n  var combine$1 = function (info, eventOrder, behaviours, base) {\n    var byEventName = groupByEvents(info, behaviours, base);\n    return combineGroups(byEventName, eventOrder);\n  };\n\n  var assemble = function (rawHandler) {\n    var handler = read$2(rawHandler);\n    return function (component, simulatedEvent) {\n      var rest = [];\n\n      for (var _i = 2; _i < arguments.length; _i++) {\n        rest[_i - 2] = arguments[_i];\n      }\n\n      var args = [component, simulatedEvent].concat(rest);\n\n      if (handler.abort.apply(undefined, args)) {\n        simulatedEvent.stop();\n      } else if (handler.can.apply(undefined, args)) {\n        handler.run.apply(undefined, args);\n      }\n    };\n  };\n\n  var missingOrderError = function (eventName, tuples) {\n    return Result.error(['The event (' + eventName + ') has more than one behaviour that listens to it.\\nWhen this occurs, you must ' + 'specify an event ordering for the behaviours in your spec (e.g. [ \"listing\", \"toggling\" ]).\\nThe behaviours that ' + 'can trigger it are: ' + JSON.stringify(map$2(tuples, function (c) {\n      return c.name;\n    }), null, 2)]);\n  };\n\n  var fuse = function (tuples, eventOrder, eventName) {\n    var order = eventOrder[eventName];\n\n    if (!order) {\n      return missingOrderError(eventName, tuples);\n    } else {\n      return sortKeys('Event: ' + eventName, 'name', tuples, order).map(function (sortedTuples) {\n        var handlers = map$2(sortedTuples, function (tuple) {\n          return tuple.handler;\n        });\n        return fuse$1(handlers);\n      });\n    }\n  };\n\n  var combineGroups = function (byEventName, eventOrder) {\n    var r = mapToArray(byEventName, function (tuples, eventName) {\n      var combined = tuples.length === 1 ? Result.value(tuples[0].handler) : fuse(tuples, eventOrder, eventName);\n      return combined.map(function (handler) {\n        var assembled = assemble(handler);\n        var purpose = tuples.length > 1 ? filter$2(eventOrder[eventName], function (o) {\n          return exists(tuples, function (t) {\n            return t.name === o;\n          });\n        }).join(' > ') : tuples[0].name;\n        return wrap$1(eventName, uncurried(assembled, purpose));\n      });\n    });\n    return consolidate(r, {});\n  };\n\n  var _a$2;\n\n  var baseBehaviour = 'alloy.base.behaviour';\n  var schema$z = objOf([field$1('dom', 'dom', required$2(), objOf([required$1('tag'), defaulted('styles', {}), defaulted('classes', []), defaulted('attributes', {}), option('value'), option('innerHtml')])), required$1('components'), required$1('uid'), defaulted('events', {}), defaulted('apis', {}), field$1('eventOrder', 'eventOrder', mergeWith((_a$2 = {}, _a$2[execute$5()] = ['disabling', baseBehaviour, 'toggling', 'typeaheadevents'], _a$2[focus$4()] = [baseBehaviour, 'focusing', 'keying'], _a$2[systemInit()] = [baseBehaviour, 'disabling', 'toggling', 'representing'], _a$2[input()] = [baseBehaviour, 'representing', 'streaming', 'invalidating'], _a$2[detachedFromDom()] = [baseBehaviour, 'representing', 'item-events', 'tooltipping'], _a$2[mousedown()] = ['focusing', baseBehaviour, 'item-type-events'], _a$2[touchstart()] = ['focusing', baseBehaviour, 'item-type-events'], _a$2[mouseover()] = ['item-type-events', 'tooltipping'], _a$2[receive()] = ['receiving', 'reflecting', 'tooltipping'], _a$2)), anyValue()), option('domModification')]);\n\n  var toInfo = function (spec) {\n    return asRaw('custom.definition', schema$z, spec);\n  };\n\n  var toDefinition = function (detail) {\n    return __assign(__assign({}, detail.dom), {\n      uid: detail.uid,\n      domChildren: map$2(detail.components, function (comp) {\n        return comp.element;\n      })\n    });\n  };\n\n  var toModification = function (detail) {\n    return detail.domModification.fold(function () {\n      return nu$7({});\n    }, nu$7);\n  };\n\n  var toEvents = function (info) {\n    return info.events;\n  };\n\n  var read = function (element, attr) {\n    var value = get$d(element, attr);\n    return value === undefined || value === '' ? [] : value.split(' ');\n  };\n\n  var add$4 = function (element, attr, id) {\n    var old = read(element, attr);\n    var nu = old.concat([id]);\n    set$8(element, attr, nu.join(' '));\n    return true;\n  };\n\n  var remove$4 = function (element, attr, id) {\n    var nu = filter$2(read(element, attr), function (v) {\n      return v !== id;\n    });\n\n    if (nu.length > 0) {\n      set$8(element, attr, nu.join(' '));\n    } else {\n      remove$7(element, attr);\n    }\n\n    return false;\n  };\n\n  var supports = function (element) {\n    return element.dom.classList !== undefined;\n  };\n\n  var get$6 = function (element) {\n    return read(element, 'class');\n  };\n\n  var add$3 = function (element, clazz) {\n    return add$4(element, 'class', clazz);\n  };\n\n  var remove$3 = function (element, clazz) {\n    return remove$4(element, 'class', clazz);\n  };\n\n  var add$2 = function (element, clazz) {\n    if (supports(element)) {\n      element.dom.classList.add(clazz);\n    } else {\n      add$3(element, clazz);\n    }\n  };\n\n  var cleanClass = function (element) {\n    var classList = supports(element) ? element.dom.classList : get$6(element);\n\n    if (classList.length === 0) {\n      remove$7(element, 'class');\n    }\n  };\n\n  var remove$2 = function (element, clazz) {\n    if (supports(element)) {\n      var classList = element.dom.classList;\n      classList.remove(clazz);\n    } else {\n      remove$3(element, clazz);\n    }\n\n    cleanClass(element);\n  };\n\n  var has = function (element, clazz) {\n    return supports(element) && element.dom.classList.contains(clazz);\n  };\n\n  var add$1 = function (element, classes) {\n    each$1(classes, function (x) {\n      add$2(element, x);\n    });\n  };\n\n  var remove$1 = function (element, classes) {\n    each$1(classes, function (x) {\n      remove$2(element, x);\n    });\n  };\n\n  var hasAll = function (element, classes) {\n    return forall(classes, function (clazz) {\n      return has(element, clazz);\n    });\n  };\n\n  var get$5 = function (element) {\n    return element.dom.value;\n  };\n\n  var set$4 = function (element, value) {\n    if (value === undefined) {\n      throw new Error('Value.set was undefined');\n    }\n\n    element.dom.value = value;\n  };\n\n  var renderToDom = function (definition) {\n    var subject = SugarElement.fromTag(definition.tag);\n    setAll$1(subject, definition.attributes);\n    add$1(subject, definition.classes);\n    setAll(subject, definition.styles);\n    definition.innerHtml.each(function (html) {\n      return set$5(subject, html);\n    });\n    var children = definition.domChildren;\n    append$1(subject, children);\n    definition.value.each(function (value) {\n      set$4(subject, value);\n    });\n\n    if (!definition.uid) {\n      debugger;\n    }\n\n    writeOnly(subject, definition.uid);\n    return subject;\n  };\n\n  var getBehaviours$2 = function (spec) {\n    var behaviours = get$e(spec, 'behaviours').getOr({});\n    return bind$3(keys(behaviours), function (name) {\n      var behaviour = behaviours[name];\n      return isNonNullable(behaviour) ? [behaviour.me] : [];\n    });\n  };\n\n  var generateFrom = function (spec, all) {\n    return generateFrom$1(spec, all);\n  };\n\n  var generate$4 = function (spec) {\n    var all = getBehaviours$2(spec);\n    return generateFrom(spec, all);\n  };\n\n  var getDomDefinition = function (info, bList, bData) {\n    var definition = toDefinition(info);\n    var infoModification = toModification(info);\n    var baseModification = {\n      'alloy.base.modification': infoModification\n    };\n    var modification = bList.length > 0 ? combine$2(bData, baseModification, bList, definition) : infoModification;\n    return merge(definition, modification);\n  };\n\n  var getEvents = function (info, bList, bData) {\n    var baseEvents = {\n      'alloy.base.behaviour': toEvents(info)\n    };\n    return combine$1(bData, info.eventOrder, bList, baseEvents).getOrDie();\n  };\n\n  var build$2 = function (spec) {\n    var getMe = function () {\n      return me;\n    };\n\n    var systemApi = Cell(singleton$1);\n    var info = getOrDie(toInfo(spec));\n    var bBlob = generate$4(spec);\n    var bList = getBehaviours$3(bBlob);\n    var bData = getData$2(bBlob);\n    var modDefinition = getDomDefinition(info, bList, bData);\n    var item = renderToDom(modDefinition);\n    var events = getEvents(info, bList, bData);\n    var subcomponents = Cell(info.components);\n\n    var connect = function (newApi) {\n      systemApi.set(newApi);\n    };\n\n    var disconnect = function () {\n      systemApi.set(NoContextApi(getMe));\n    };\n\n    var syncComponents = function () {\n      var children$1 = children(item);\n      var subs = bind$3(children$1, function (child) {\n        return systemApi.get().getByDom(child).fold(function () {\n          return [];\n        }, pure$2);\n      });\n      subcomponents.set(subs);\n    };\n\n    var config = function (behaviour) {\n      var b = bData;\n      var f = isFunction(b[behaviour.name()]) ? b[behaviour.name()] : function () {\n        throw new Error('Could not find ' + behaviour.name() + ' in ' + JSON.stringify(spec, null, 2));\n      };\n      return f();\n    };\n\n    var hasConfigured = function (behaviour) {\n      return isFunction(bData[behaviour.name()]);\n    };\n\n    var getApis = function () {\n      return info.apis;\n    };\n\n    var readState = function (behaviourName) {\n      return bData[behaviourName]().map(function (b) {\n        return b.state.readState();\n      }).getOr('not enabled');\n    };\n\n    var me = {\n      uid: spec.uid,\n      getSystem: systemApi.get,\n      config: config,\n      hasConfigured: hasConfigured,\n      spec: spec,\n      readState: readState,\n      getApis: getApis,\n      connect: connect,\n      disconnect: disconnect,\n      element: item,\n      syncComponents: syncComponents,\n      components: subcomponents.get,\n      events: events\n    };\n    return me;\n  };\n\n  var buildSubcomponents = function (spec) {\n    var components = get$e(spec, 'components').getOr([]);\n    return map$2(components, build$1);\n  };\n\n  var buildFromSpec = function (userSpec) {\n    var _a = make$8(userSpec),\n        specEvents = _a.events,\n        spec = __rest(_a, ['events']);\n\n    var components = buildSubcomponents(spec);\n\n    var completeSpec = __assign(__assign({}, spec), {\n      events: __assign(__assign({}, DefaultEvents), specEvents),\n      components: components\n    });\n\n    return Result.value(build$2(completeSpec));\n  };\n\n  var text = function (textContent) {\n    var element = SugarElement.fromText(textContent);\n    return external$2({\n      element: element\n    });\n  };\n\n  var external$2 = function (spec) {\n    var extSpec = asRawOrDie$1('external.component', objOfOnly([required$1('element'), option('uid')]), spec);\n    var systemApi = Cell(NoContextApi());\n\n    var connect = function (newApi) {\n      systemApi.set(newApi);\n    };\n\n    var disconnect = function () {\n      systemApi.set(NoContextApi(function () {\n        return me;\n      }));\n    };\n\n    var uid = extSpec.uid.getOrThunk(function () {\n      return generate$5('external');\n    });\n    writeOnly(extSpec.element, uid);\n    var me = {\n      uid: uid,\n      getSystem: systemApi.get,\n      config: Optional.none,\n      hasConfigured: never,\n      connect: connect,\n      disconnect: disconnect,\n      getApis: function () {\n        return {};\n      },\n      element: extSpec.element,\n      spec: spec,\n      readState: constant$1('No state'),\n      syncComponents: noop,\n      components: constant$1([]),\n      events: {}\n    };\n    return premade$1(me);\n  };\n\n  var uids = generate$5;\n\n  var isSketchSpec$1 = function (spec) {\n    return has$2(spec, 'uid');\n  };\n\n  var build$1 = function (spec) {\n    return getPremade(spec).getOrThunk(function () {\n      var userSpecWithUid = isSketchSpec$1(spec) ? spec : __assign({\n        uid: uids('')\n      }, spec);\n      return buildFromSpec(userSpecWithUid).getOrDie();\n    });\n  };\n\n  var premade = premade$1;\n\n  function ClosestOrAncestor(is, ancestor, scope, a, isRoot) {\n    if (is(scope, a)) {\n      return Optional.some(scope);\n    } else if (isFunction(isRoot) && isRoot(scope)) {\n      return Optional.none();\n    } else {\n      return ancestor(scope, a, isRoot);\n    }\n  }\n\n  var ancestor$1 = function (scope, predicate, isRoot) {\n    var element = scope.dom;\n    var stop = isFunction(isRoot) ? isRoot : never;\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = SugarElement.fromDom(element);\n\n      if (predicate(el)) {\n        return Optional.some(el);\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var closest$3 = function (scope, predicate, isRoot) {\n    var is = function (s, test) {\n      return test(s);\n    };\n\n    return ClosestOrAncestor(is, ancestor$1, scope, predicate, isRoot);\n  };\n\n  var child$1 = function (scope, predicate) {\n    var pred = function (node) {\n      return predicate(SugarElement.fromDom(node));\n    };\n\n    var result = find$5(scope.dom.childNodes, pred);\n    return result.map(SugarElement.fromDom);\n  };\n\n  var descendant$1 = function (scope, predicate) {\n    var descend = function (node) {\n      for (var i = 0; i < node.childNodes.length; i++) {\n        var child_1 = SugarElement.fromDom(node.childNodes[i]);\n\n        if (predicate(child_1)) {\n          return Optional.some(child_1);\n        }\n\n        var res = descend(node.childNodes[i]);\n\n        if (res.isSome()) {\n          return res;\n        }\n      }\n\n      return Optional.none();\n    };\n\n    return descend(scope.dom);\n  };\n\n  var closest$2 = function (scope, predicate, isRoot) {\n    return closest$3(scope, predicate, isRoot).isSome();\n  };\n\n  var ancestor = function (scope, selector, isRoot) {\n    return ancestor$1(scope, function (e) {\n      return is(e, selector);\n    }, isRoot);\n  };\n\n  var child = function (scope, selector) {\n    return child$1(scope, function (e) {\n      return is(e, selector);\n    });\n  };\n\n  var descendant = function (scope, selector) {\n    return one(selector, scope);\n  };\n\n  var closest$1 = function (scope, selector, isRoot) {\n    var is$1 = function (element, selector) {\n      return is(element, selector);\n    };\n\n    return ClosestOrAncestor(is$1, ancestor, scope, selector, isRoot);\n  };\n\n  var find$1 = function (queryElem) {\n    var dependent = closest$3(queryElem, function (elem) {\n      if (!isElement$2(elem)) {\n        return false;\n      }\n\n      var id = get$d(elem, 'id');\n      return id !== undefined && id.indexOf('aria-owns') > -1;\n    });\n    return dependent.bind(function (dep) {\n      var id = get$d(dep, 'id');\n      var dos = getRootNode(dep);\n      return descendant(dos, '[aria-owns=\"' + id + '\"]');\n    });\n  };\n\n  var manager = function () {\n    var ariaId = generate$6('aria-owns');\n\n    var link = function (elem) {\n      set$8(elem, 'aria-owns', ariaId);\n    };\n\n    var unlink = function (elem) {\n      remove$7(elem, 'aria-owns');\n    };\n\n    return {\n      id: ariaId,\n      link: link,\n      unlink: unlink\n    };\n  };\n\n  var isAriaPartOf = function (component, queryElem) {\n    return find$1(queryElem).exists(function (owner) {\n      return isPartOf$1(component, owner);\n    });\n  };\n\n  var isPartOf$1 = function (component, queryElem) {\n    return closest$2(queryElem, function (el) {\n      return eq(el, component.element);\n    }, never) || isAriaPartOf(component, queryElem);\n  };\n\n  var unknown = 'unknown';\n  var EventConfiguration;\n\n  (function (EventConfiguration) {\n    EventConfiguration[EventConfiguration['STOP'] = 0] = 'STOP';\n    EventConfiguration[EventConfiguration['NORMAL'] = 1] = 'NORMAL';\n    EventConfiguration[EventConfiguration['LOGGING'] = 2] = 'LOGGING';\n  })(EventConfiguration || (EventConfiguration = {}));\n\n  var eventConfig = Cell({});\n\n  var makeEventLogger = function (eventName, initialTarget) {\n    var sequence = [];\n    var startTime = new Date().getTime();\n    return {\n      logEventCut: function (_name, target, purpose) {\n        sequence.push({\n          outcome: 'cut',\n          target: target,\n          purpose: purpose\n        });\n      },\n      logEventStopped: function (_name, target, purpose) {\n        sequence.push({\n          outcome: 'stopped',\n          target: target,\n          purpose: purpose\n        });\n      },\n      logNoParent: function (_name, target, purpose) {\n        sequence.push({\n          outcome: 'no-parent',\n          target: target,\n          purpose: purpose\n        });\n      },\n      logEventNoHandlers: function (_name, target) {\n        sequence.push({\n          outcome: 'no-handlers-left',\n          target: target\n        });\n      },\n      logEventResponse: function (_name, target, purpose) {\n        sequence.push({\n          outcome: 'response',\n          purpose: purpose,\n          target: target\n        });\n      },\n      write: function () {\n        var finishTime = new Date().getTime();\n\n        if (contains$2(['mousemove', 'mouseover', 'mouseout', systemInit()], eventName)) {\n          return;\n        }\n\n        console.log(eventName, {\n          event: eventName,\n          time: finishTime - startTime,\n          target: initialTarget.dom,\n          sequence: map$2(sequence, function (s) {\n            if (!contains$2(['cut', 'stopped', 'response'], s.outcome)) {\n              return s.outcome;\n            } else {\n              return '{' + s.purpose + '} ' + s.outcome + ' at (' + element(s.target) + ')';\n            }\n          })\n        });\n      }\n    };\n  };\n\n  var processEvent = function (eventName, initialTarget, f) {\n    var status = get$e(eventConfig.get(), eventName).orThunk(function () {\n      var patterns = keys(eventConfig.get());\n      return findMap(patterns, function (p) {\n        return eventName.indexOf(p) > -1 ? Optional.some(eventConfig.get()[p]) : Optional.none();\n      });\n    }).getOr(EventConfiguration.NORMAL);\n\n    switch (status) {\n      case EventConfiguration.NORMAL:\n        return f(noLogger());\n\n      case EventConfiguration.LOGGING:\n        {\n          var logger = makeEventLogger(eventName, initialTarget);\n          var output = f(logger);\n          logger.write();\n          return output;\n        }\n\n      case EventConfiguration.STOP:\n        return true;\n    }\n  };\n\n  var path = ['alloy/data/Fields', 'alloy/debugging/Debugging'];\n\n  var getTrace = function () {\n    var err = new Error();\n\n    if (err.stack !== undefined) {\n      var lines = err.stack.split('\\n');\n      return find$5(lines, function (line) {\n        return line.indexOf('alloy') > 0 && !exists(path, function (p) {\n          return line.indexOf(p) > -1;\n        });\n      }).getOr(unknown);\n    } else {\n      return unknown;\n    }\n  };\n\n  var ignoreEvent = {\n    logEventCut: noop,\n    logEventStopped: noop,\n    logNoParent: noop,\n    logEventNoHandlers: noop,\n    logEventResponse: noop,\n    write: noop\n  };\n\n  var monitorEvent = function (eventName, initialTarget, f) {\n    return processEvent(eventName, initialTarget, f);\n  };\n\n  var noLogger = constant$1(ignoreEvent);\n  var menuFields = constant$1([required$1('menu'), required$1('selectedMenu')]);\n  var itemFields = constant$1([required$1('item'), required$1('selectedItem')]);\n  constant$1(objOf(itemFields().concat(menuFields())));\n  var itemSchema$3 = constant$1(objOf(itemFields()));\n\n  var _initSize = requiredObjOf('initSize', [required$1('numColumns'), required$1('numRows')]);\n\n  var itemMarkers = function () {\n    return requiredOf('markers', itemSchema$3());\n  };\n\n  var tieredMenuMarkers = function () {\n    return requiredObjOf('markers', [required$1('backgroundMenu')].concat(menuFields()).concat(itemFields()));\n  };\n\n  var markers$1 = function (required) {\n    return requiredObjOf('markers', map$2(required, required$1));\n  };\n\n  var onPresenceHandler = function (label, fieldName, presence) {\n    getTrace();\n    return field$1(fieldName, fieldName, presence, valueOf(function (f) {\n      return Result.value(function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return f.apply(undefined, args);\n      });\n    }));\n  };\n\n  var onHandler = function (fieldName) {\n    return onPresenceHandler('onHandler', fieldName, defaulted$1(noop));\n  };\n\n  var onKeyboardHandler = function (fieldName) {\n    return onPresenceHandler('onKeyboardHandler', fieldName, defaulted$1(Optional.none));\n  };\n\n  var onStrictHandler = function (fieldName) {\n    return onPresenceHandler('onHandler', fieldName, required$2());\n  };\n\n  var onStrictKeyboardHandler = function (fieldName) {\n    return onPresenceHandler('onKeyboardHandler', fieldName, required$2());\n  };\n\n  var output$1 = function (name, value) {\n    return customField(name, constant$1(value));\n  };\n\n  var snapshot = function (name) {\n    return customField(name, identity$1);\n  };\n\n  var initSize = constant$1(_initSize);\n\n  var nu$6 = function (x, y, bubble, direction, placement, boundsRestriction, labelPrefix, alwaysFit) {\n    if (alwaysFit === void 0) {\n      alwaysFit = false;\n    }\n\n    return {\n      x: x,\n      y: y,\n      bubble: bubble,\n      direction: direction,\n      placement: placement,\n      restriction: boundsRestriction,\n      label: labelPrefix + '-' + placement,\n      alwaysFit: alwaysFit\n    };\n  };\n\n  var adt$a = Adt.generate([{\n    southeast: []\n  }, {\n    southwest: []\n  }, {\n    northeast: []\n  }, {\n    northwest: []\n  }, {\n    south: []\n  }, {\n    north: []\n  }, {\n    east: []\n  }, {\n    west: []\n  }]);\n\n  var cata$2 = function (subject, southeast, southwest, northeast, northwest, south, north, east, west) {\n    return subject.fold(southeast, southwest, northeast, northwest, south, north, east, west);\n  };\n\n  var cataVertical = function (subject, south, middle, north) {\n    return subject.fold(south, south, north, north, south, north, middle, middle);\n  };\n\n  var cataHorizontal = function (subject, east, middle, west) {\n    return subject.fold(east, west, east, west, middle, middle, east, west);\n  };\n\n  var southeast$3 = adt$a.southeast;\n  var southwest$3 = adt$a.southwest;\n  var northeast$3 = adt$a.northeast;\n  var northwest$3 = adt$a.northwest;\n  var south$3 = adt$a.south;\n  var north$3 = adt$a.north;\n  var east$3 = adt$a.east;\n  var west$3 = adt$a.west;\n\n  var cycleBy = function (value, delta, min, max) {\n    var r = value + delta;\n\n    if (r > max) {\n      return min;\n    } else if (r < min) {\n      return max;\n    } else {\n      return r;\n    }\n  };\n\n  var clamp$1 = function (value, min, max) {\n    return Math.min(Math.max(value, min), max);\n  };\n\n  var getRestriction = function (anchor, restriction) {\n    switch (restriction) {\n      case 1:\n        return anchor.x;\n\n      case 0:\n        return anchor.x + anchor.width;\n\n      case 2:\n        return anchor.y;\n\n      case 3:\n        return anchor.y + anchor.height;\n    }\n  };\n\n  var boundsRestriction = function (anchor, restrictions) {\n    return mapToObject(['left', 'right', 'top', 'bottom'], function (dir) {\n      return get$e(restrictions, dir).map(function (restriction) {\n        return getRestriction(anchor, restriction);\n      });\n    });\n  };\n\n  var adjustBounds = function (bounds$1, restriction, bubbleOffset) {\n    var applyRestriction = function (dir, current) {\n      return restriction[dir].map(function (pos) {\n        var isVerticalAxis = dir === 'top' || dir === 'bottom';\n        var offset = isVerticalAxis ? bubbleOffset.top : bubbleOffset.left;\n        var comparator = dir === 'left' || dir === 'top' ? Math.max : Math.min;\n        var newPos = comparator(pos, current) + offset;\n        return isVerticalAxis ? clamp$1(newPos, bounds$1.y, bounds$1.bottom) : clamp$1(newPos, bounds$1.x, bounds$1.right);\n      }).getOr(current);\n    };\n\n    var adjustedLeft = applyRestriction('left', bounds$1.x);\n    var adjustedTop = applyRestriction('top', bounds$1.y);\n    var adjustedRight = applyRestriction('right', bounds$1.right);\n    var adjustedBottom = applyRestriction('bottom', bounds$1.bottom);\n    return bounds(adjustedLeft, adjustedTop, adjustedRight - adjustedLeft, adjustedBottom - adjustedTop);\n  };\n\n  var labelPrefix$2 = 'layout';\n\n  var eastX$1 = function (anchor) {\n    return anchor.x;\n  };\n\n  var middleX$1 = function (anchor, element) {\n    return anchor.x + anchor.width / 2 - element.width / 2;\n  };\n\n  var westX$1 = function (anchor, element) {\n    return anchor.x + anchor.width - element.width;\n  };\n\n  var northY$2 = function (anchor, element) {\n    return anchor.y - element.height;\n  };\n\n  var southY$2 = function (anchor) {\n    return anchor.y + anchor.height;\n  };\n\n  var centreY$1 = function (anchor, element) {\n    return anchor.y + anchor.height / 2 - element.height / 2;\n  };\n\n  var eastEdgeX$1 = function (anchor) {\n    return anchor.x + anchor.width;\n  };\n\n  var westEdgeX$1 = function (anchor, element) {\n    return anchor.x - element.width;\n  };\n\n  var southeast$2 = function (anchor, element, bubbles) {\n    return nu$6(eastX$1(anchor), southY$2(anchor), bubbles.southeast(), southeast$3(), 'southeast', boundsRestriction(anchor, {\n      left: 1,\n      top: 3\n    }), labelPrefix$2);\n  };\n\n  var southwest$2 = function (anchor, element, bubbles) {\n    return nu$6(westX$1(anchor, element), southY$2(anchor), bubbles.southwest(), southwest$3(), 'southwest', boundsRestriction(anchor, {\n      right: 0,\n      top: 3\n    }), labelPrefix$2);\n  };\n\n  var northeast$2 = function (anchor, element, bubbles) {\n    return nu$6(eastX$1(anchor), northY$2(anchor, element), bubbles.northeast(), northeast$3(), 'northeast', boundsRestriction(anchor, {\n      left: 1,\n      bottom: 2\n    }), labelPrefix$2);\n  };\n\n  var northwest$2 = function (anchor, element, bubbles) {\n    return nu$6(westX$1(anchor, element), northY$2(anchor, element), bubbles.northwest(), northwest$3(), 'northwest', boundsRestriction(anchor, {\n      right: 0,\n      bottom: 2\n    }), labelPrefix$2);\n  };\n\n  var north$2 = function (anchor, element, bubbles) {\n    return nu$6(middleX$1(anchor, element), northY$2(anchor, element), bubbles.north(), north$3(), 'north', boundsRestriction(anchor, {\n      bottom: 2\n    }), labelPrefix$2);\n  };\n\n  var south$2 = function (anchor, element, bubbles) {\n    return nu$6(middleX$1(anchor, element), southY$2(anchor), bubbles.south(), south$3(), 'south', boundsRestriction(anchor, {\n      top: 3\n    }), labelPrefix$2);\n  };\n\n  var east$2 = function (anchor, element, bubbles) {\n    return nu$6(eastEdgeX$1(anchor), centreY$1(anchor, element), bubbles.east(), east$3(), 'east', boundsRestriction(anchor, {\n      left: 0\n    }), labelPrefix$2);\n  };\n\n  var west$2 = function (anchor, element, bubbles) {\n    return nu$6(westEdgeX$1(anchor, element), centreY$1(anchor, element), bubbles.west(), west$3(), 'west', boundsRestriction(anchor, {\n      right: 1\n    }), labelPrefix$2);\n  };\n\n  var all$1 = function () {\n    return [southeast$2, southwest$2, northeast$2, northwest$2, south$2, north$2, east$2, west$2];\n  };\n\n  var allRtl$1 = function () {\n    return [southwest$2, southeast$2, northwest$2, northeast$2, south$2, north$2, east$2, west$2];\n  };\n\n  var aboveOrBelow = function () {\n    return [northeast$2, northwest$2, southeast$2, southwest$2, north$2, south$2];\n  };\n\n  var aboveOrBelowRtl = function () {\n    return [northwest$2, northeast$2, southwest$2, southeast$2, north$2, south$2];\n  };\n\n  var belowOrAbove = function () {\n    return [southeast$2, southwest$2, northeast$2, northwest$2, south$2, north$2];\n  };\n\n  var belowOrAboveRtl = function () {\n    return [southwest$2, southeast$2, northwest$2, northeast$2, south$2, north$2];\n  };\n\n  var chooseChannels = function (channels, message) {\n    return message.universal ? channels : filter$2(channels, function (ch) {\n      return contains$2(message.channels, ch);\n    });\n  };\n\n  var events$h = function (receiveConfig) {\n    return derive$2([run$1(receive(), function (component, message) {\n      var channelMap = receiveConfig.channels;\n      var channels = keys(channelMap);\n      var receivingData = message;\n      var targetChannels = chooseChannels(channels, receivingData);\n      each$1(targetChannels, function (ch) {\n        var channelInfo = channelMap[ch];\n        var channelSchema = channelInfo.schema;\n        var data = asRawOrDie$1('channel[' + ch + '] data\\nReceiver: ' + element(component.element), channelSchema, receivingData.data);\n        channelInfo.onReceive(component, data);\n      });\n    })]);\n  };\n\n  var ActiveReceiving = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$h\n  });\n  var ReceivingSchema = [requiredOf('channels', setOf(Result.value, objOfOnly([onStrictHandler('onReceive'), defaulted('schema', anyValue())])))];\n\n  var executeEvent = function (bConfig, bState, executor) {\n    return runOnExecute$1(function (component) {\n      executor(component, bConfig, bState);\n    });\n  };\n\n  var loadEvent = function (bConfig, bState, f) {\n    return runOnInit(function (component, _simulatedEvent) {\n      f(component, bConfig, bState);\n    });\n  };\n\n  var create$8 = function (schema, name, active, apis, extra, state) {\n    var configSchema = objOfOnly(schema);\n    var schemaSchema = optionObjOf(name, [optionObjOfOnly('config', schema)]);\n    return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n  };\n\n  var createModes$1 = function (modes, name, active, apis, extra, state) {\n    var configSchema = modes;\n    var schemaSchema = optionObjOf(name, [optionOf('config', modes)]);\n    return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n  };\n\n  var wrapApi = function (bName, apiFunction, apiName) {\n    var f = function (component) {\n      var rest = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        rest[_i - 1] = arguments[_i];\n      }\n\n      var args = [component].concat(rest);\n      return component.config({\n        name: constant$1(bName)\n      }).fold(function () {\n        throw new Error('We could not find any behaviour configuration for: ' + bName + '. Using API: ' + apiName);\n      }, function (info) {\n        var rest = Array.prototype.slice.call(args, 1);\n        return apiFunction.apply(undefined, [component, info.config, info.state].concat(rest));\n      });\n    };\n\n    return markAsBehaviourApi(f, apiName, apiFunction);\n  };\n\n  var revokeBehaviour = function (name) {\n    return {\n      key: name,\n      value: undefined\n    };\n  };\n\n  var doCreate = function (configSchema, schemaSchema, name, active, apis, extra, state) {\n    var getConfig = function (info) {\n      return hasNonNullableKey(info, name) ? info[name]() : Optional.none();\n    };\n\n    var wrappedApis = map$1(apis, function (apiF, apiName) {\n      return wrapApi(name, apiF, apiName);\n    });\n    var wrappedExtra = map$1(extra, function (extraF, extraName) {\n      return markAsExtraApi(extraF, extraName);\n    });\n\n    var me = __assign(__assign(__assign({}, wrappedExtra), wrappedApis), {\n      revoke: curry(revokeBehaviour, name),\n      config: function (spec) {\n        var prepared = asRawOrDie$1(name + '-config', configSchema, spec);\n        return {\n          key: name,\n          value: {\n            config: prepared,\n            me: me,\n            configAsRaw: cached(function () {\n              return asRawOrDie$1(name + '-config', configSchema, spec);\n            }),\n            initialConfig: spec,\n            state: state\n          }\n        };\n      },\n      schema: constant$1(schemaSchema),\n      exhibit: function (info, base) {\n        return lift2(getConfig(info), get$e(active, 'exhibit'), function (behaviourInfo, exhibitor) {\n          return exhibitor(base, behaviourInfo.config, behaviourInfo.state);\n        }).getOrThunk(function () {\n          return nu$7({});\n        });\n      },\n      name: constant$1(name),\n      handlers: function (info) {\n        return getConfig(info).map(function (behaviourInfo) {\n          var getEvents = get$e(active, 'events').getOr(function () {\n            return {};\n          });\n          return getEvents(behaviourInfo.config, behaviourInfo.state);\n        }).getOr({});\n      }\n    });\n\n    return me;\n  };\n\n  var derive$1 = function (capabilities) {\n    return wrapAll(capabilities);\n  };\n\n  var simpleSchema = objOfOnly([required$1('fields'), required$1('name'), defaulted('active', {}), defaulted('apis', {}), defaulted('state', NoState), defaulted('extra', {})]);\n\n  var create$7 = function (data) {\n    var value = asRawOrDie$1('Creating behaviour: ' + data.name, simpleSchema, data);\n    return create$8(value.fields, value.name, value.active, value.apis, value.extra, value.state);\n  };\n\n  var modeSchema = objOfOnly([required$1('branchKey'), required$1('branches'), required$1('name'), defaulted('active', {}), defaulted('apis', {}), defaulted('state', NoState), defaulted('extra', {})]);\n\n  var createModes = function (data) {\n    var value = asRawOrDie$1('Creating behaviour: ' + data.name, modeSchema, data);\n    return createModes$1(choose$1(value.branchKey, value.branches), value.name, value.active, value.apis, value.extra, value.state);\n  };\n\n  var revoke = constant$1(undefined);\n  var Receiving = create$7({\n    fields: ReceivingSchema,\n    name: 'receiving',\n    active: ActiveReceiving\n  });\n\n  var exhibit$6 = function (base, posConfig) {\n    return nu$7({\n      classes: [],\n      styles: posConfig.useFixed() ? {} : {\n        position: 'relative'\n      }\n    });\n  };\n\n  var ActivePosition = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$6\n  });\n\n  var getDocument = function () {\n    return SugarElement.fromDom(document);\n  };\n\n  var focus$3 = function (element) {\n    return element.dom.focus();\n  };\n\n  var blur$1 = function (element) {\n    return element.dom.blur();\n  };\n\n  var hasFocus = function (element) {\n    var root = getRootNode(element).dom;\n    return element.dom === root.activeElement;\n  };\n\n  var active = function (root) {\n    if (root === void 0) {\n      root = getDocument();\n    }\n\n    return Optional.from(root.dom.activeElement).map(SugarElement.fromDom);\n  };\n\n  var search = function (element) {\n    return active(getRootNode(element)).filter(function (e) {\n      return element.dom.contains(e.dom);\n    });\n  };\n\n  var preserve$1 = function (f, container) {\n    var dos = getRootNode(container);\n    var refocus = active(dos).bind(function (focused) {\n      var hasFocus = function (elem) {\n        return eq(focused, elem);\n      };\n\n      return hasFocus(container) ? Optional.some(container) : descendant$1(container, hasFocus);\n    });\n    var result = f(container);\n    refocus.each(function (oldFocus) {\n      active(dos).filter(function (newFocus) {\n        return eq(newFocus, oldFocus);\n      }).fold(function () {\n        focus$3(oldFocus);\n      }, noop);\n    });\n    return result;\n  };\n\n  var NuPositionCss = function (position, left, top, right, bottom) {\n    var toPx = function (num) {\n      return num + 'px';\n    };\n\n    return {\n      position: position,\n      left: left.map(toPx),\n      top: top.map(toPx),\n      right: right.map(toPx),\n      bottom: bottom.map(toPx)\n    };\n  };\n\n  var toOptions = function (position) {\n    return __assign(__assign({}, position), {\n      position: Optional.some(position.position)\n    });\n  };\n\n  var applyPositionCss = function (element, position) {\n    setOptions(element, toOptions(position));\n  };\n\n  var adt$9 = Adt.generate([{\n    none: []\n  }, {\n    relative: ['x', 'y', 'width', 'height']\n  }, {\n    fixed: ['x', 'y', 'width', 'height']\n  }]);\n\n  var positionWithDirection = function (posName, decision, x, y, width, height) {\n    var decisionRect = decision.rect;\n    var decisionX = decisionRect.x - x;\n    var decisionY = decisionRect.y - y;\n    var decisionWidth = decisionRect.width;\n    var decisionHeight = decisionRect.height;\n    var decisionRight = width - (decisionX + decisionWidth);\n    var decisionBottom = height - (decisionY + decisionHeight);\n    var left = Optional.some(decisionX);\n    var top = Optional.some(decisionY);\n    var right = Optional.some(decisionRight);\n    var bottom = Optional.some(decisionBottom);\n    var none = Optional.none();\n    return cata$2(decision.direction, function () {\n      return NuPositionCss(posName, left, top, none, none);\n    }, function () {\n      return NuPositionCss(posName, none, top, right, none);\n    }, function () {\n      return NuPositionCss(posName, left, none, none, bottom);\n    }, function () {\n      return NuPositionCss(posName, none, none, right, bottom);\n    }, function () {\n      return NuPositionCss(posName, left, top, none, none);\n    }, function () {\n      return NuPositionCss(posName, left, none, none, bottom);\n    }, function () {\n      return NuPositionCss(posName, left, top, none, none);\n    }, function () {\n      return NuPositionCss(posName, none, top, right, none);\n    });\n  };\n\n  var reposition = function (origin, decision) {\n    return origin.fold(function () {\n      var decisionRect = decision.rect;\n      return NuPositionCss('absolute', Optional.some(decisionRect.x), Optional.some(decisionRect.y), Optional.none(), Optional.none());\n    }, function (x, y, width, height) {\n      return positionWithDirection('absolute', decision, x, y, width, height);\n    }, function (x, y, width, height) {\n      return positionWithDirection('fixed', decision, x, y, width, height);\n    });\n  };\n\n  var toBox = function (origin, element) {\n    var rel = curry(find$2, element);\n    var position = origin.fold(rel, rel, function () {\n      var scroll = get$9();\n      return find$2(element).translate(-scroll.left, -scroll.top);\n    });\n    var width = getOuter$1(element);\n    var height = getOuter$2(element);\n    return bounds(position.left, position.top, width, height);\n  };\n\n  var viewport = function (origin, getBounds) {\n    return getBounds.fold(function () {\n      return origin.fold(win, win, bounds);\n    }, function (b) {\n      return origin.fold(b, b, function () {\n        var bounds$1 = b();\n        var pos = translate$2(origin, bounds$1.x, bounds$1.y);\n        return bounds(pos.left, pos.top, bounds$1.width, bounds$1.height);\n      });\n    });\n  };\n\n  var translate$2 = function (origin, x, y) {\n    var pos = SugarPosition(x, y);\n\n    var removeScroll = function () {\n      var outerScroll = get$9();\n      return pos.translate(-outerScroll.left, -outerScroll.top);\n    };\n\n    return origin.fold(constant$1(pos), constant$1(pos), removeScroll);\n  };\n\n  var cata$1 = function (subject, onNone, onRelative, onFixed) {\n    return subject.fold(onNone, onRelative, onFixed);\n  };\n\n  adt$9.none;\n  var relative$1 = adt$9.relative;\n  var fixed$1 = adt$9.fixed;\n\n  var anchor = function (anchorBox, origin) {\n    return {\n      anchorBox: anchorBox,\n      origin: origin\n    };\n  };\n\n  var box = function (anchorBox, origin) {\n    return anchor(anchorBox, origin);\n  };\n\n  var placementAttribute = 'data-alloy-placement';\n\n  var setPlacement$1 = function (element, placement) {\n    set$8(element, placementAttribute, placement);\n  };\n\n  var getPlacement = function (element) {\n    return getOpt(element, placementAttribute);\n  };\n\n  var reset$2 = function (element) {\n    return remove$7(element, placementAttribute);\n  };\n\n  var adt$8 = Adt.generate([{\n    fit: ['reposition']\n  }, {\n    nofit: ['reposition', 'visibleW', 'visibleH', 'isVisible']\n  }]);\n\n  var determinePosition = function (box, bounds) {\n    var boundsX = bounds.x,\n        boundsY = bounds.y,\n        boundsRight = bounds.right,\n        boundsBottom = bounds.bottom;\n    var x = box.x,\n        y = box.y,\n        right = box.right,\n        bottom = box.bottom,\n        width = box.width,\n        height = box.height;\n    var xInBounds = x >= boundsX && x <= boundsRight;\n    var yInBounds = y >= boundsY && y <= boundsBottom;\n    var originInBounds = xInBounds && yInBounds;\n    var rightInBounds = right <= boundsRight && right >= boundsX;\n    var bottomInBounds = bottom <= boundsBottom && bottom >= boundsY;\n    var sizeInBounds = rightInBounds && bottomInBounds;\n    var visibleW = Math.min(width, x >= boundsX ? boundsRight - x : right - boundsX);\n    var visibleH = Math.min(height, y >= boundsY ? boundsBottom - y : bottom - boundsY);\n    return {\n      originInBounds: originInBounds,\n      sizeInBounds: sizeInBounds,\n      visibleW: visibleW,\n      visibleH: visibleH\n    };\n  };\n\n  var calcReposition = function (box, bounds$1) {\n    var boundsX = bounds$1.x,\n        boundsY = bounds$1.y,\n        boundsRight = bounds$1.right,\n        boundsBottom = bounds$1.bottom;\n    var x = box.x,\n        y = box.y,\n        width = box.width,\n        height = box.height;\n    var maxX = Math.max(boundsX, boundsRight - width);\n    var maxY = Math.max(boundsY, boundsBottom - height);\n    var restrictedX = clamp$1(x, boundsX, maxX);\n    var restrictedY = clamp$1(y, boundsY, maxY);\n    var restrictedWidth = Math.min(restrictedX + width, boundsRight) - restrictedX;\n    var restrictedHeight = Math.min(restrictedY + height, boundsBottom) - restrictedY;\n    return bounds(restrictedX, restrictedY, restrictedWidth, restrictedHeight);\n  };\n\n  var calcMaxSizes = function (direction, box, bounds) {\n    var upAvailable = constant$1(box.bottom - bounds.y);\n    var downAvailable = constant$1(bounds.bottom - box.y);\n    var maxHeight = cataVertical(direction, downAvailable, downAvailable, upAvailable);\n    var westAvailable = constant$1(box.right - bounds.x);\n    var eastAvailable = constant$1(bounds.right - box.x);\n    var maxWidth = cataHorizontal(direction, eastAvailable, eastAvailable, westAvailable);\n    return {\n      maxWidth: maxWidth,\n      maxHeight: maxHeight\n    };\n  };\n\n  var attempt = function (candidate, width, height, bounds$1) {\n    var bubble = candidate.bubble;\n    var bubbleOffset = bubble.offset;\n    var adjustedBounds = adjustBounds(bounds$1, candidate.restriction, bubbleOffset);\n    var newX = candidate.x + bubbleOffset.left;\n    var newY = candidate.y + bubbleOffset.top;\n    var box = bounds(newX, newY, width, height);\n\n    var _a = determinePosition(box, adjustedBounds),\n        originInBounds = _a.originInBounds,\n        sizeInBounds = _a.sizeInBounds,\n        visibleW = _a.visibleW,\n        visibleH = _a.visibleH;\n\n    var fits = originInBounds && sizeInBounds;\n    var fittedBox = fits ? box : calcReposition(box, adjustedBounds);\n    var isPartlyVisible = fittedBox.width > 0 && fittedBox.height > 0;\n\n    var _b = calcMaxSizes(candidate.direction, fittedBox, bounds$1),\n        maxWidth = _b.maxWidth,\n        maxHeight = _b.maxHeight;\n\n    var reposition = {\n      rect: fittedBox,\n      maxHeight: maxHeight,\n      maxWidth: maxWidth,\n      direction: candidate.direction,\n      placement: candidate.placement,\n      classes: {\n        on: bubble.classesOn,\n        off: bubble.classesOff\n      },\n      layout: candidate.label,\n      testY: newY\n    };\n    return fits || candidate.alwaysFit ? adt$8.fit(reposition) : adt$8.nofit(reposition, visibleW, visibleH, isPartlyVisible);\n  };\n\n  var attempts = function (element, candidates, anchorBox, elementBox, bubbles, bounds) {\n    var panelWidth = elementBox.width;\n    var panelHeight = elementBox.height;\n\n    var attemptBestFit = function (layout, reposition, visibleW, visibleH, isVisible) {\n      var next = layout(anchorBox, elementBox, bubbles, element, bounds);\n      var attemptLayout = attempt(next, panelWidth, panelHeight, bounds);\n      return attemptLayout.fold(constant$1(attemptLayout), function (newReposition, newVisibleW, newVisibleH, newIsVisible) {\n        var improved = isVisible === newIsVisible ? newVisibleH > visibleH || newVisibleW > visibleW : !isVisible && newIsVisible;\n        return improved ? attemptLayout : adt$8.nofit(reposition, visibleW, visibleH, isVisible);\n      });\n    };\n\n    var abc = foldl(candidates, function (b, a) {\n      var bestNext = curry(attemptBestFit, a);\n      return b.fold(constant$1(b), bestNext);\n    }, adt$8.nofit({\n      rect: anchorBox,\n      maxHeight: elementBox.height,\n      maxWidth: elementBox.width,\n      direction: southeast$3(),\n      placement: 'southeast',\n      classes: {\n        on: [],\n        off: []\n      },\n      layout: 'none',\n      testY: anchorBox.y\n    }, -1, -1, false));\n    return abc.fold(identity$1, identity$1);\n  };\n\n  var singleton = function (doRevoke) {\n    var subject = Cell(Optional.none());\n\n    var revoke = function () {\n      return subject.get().each(doRevoke);\n    };\n\n    var clear = function () {\n      revoke();\n      subject.set(Optional.none());\n    };\n\n    var isSet = function () {\n      return subject.get().isSome();\n    };\n\n    var get = function () {\n      return subject.get();\n    };\n\n    var set = function (s) {\n      revoke();\n      subject.set(Optional.some(s));\n    };\n\n    return {\n      clear: clear,\n      isSet: isSet,\n      get: get,\n      set: set\n    };\n  };\n\n  var destroyable = function () {\n    return singleton(function (s) {\n      return s.destroy();\n    });\n  };\n\n  var unbindable = function () {\n    return singleton(function (s) {\n      return s.unbind();\n    });\n  };\n\n  var api$1 = function () {\n    var subject = destroyable();\n\n    var run = function (f) {\n      return subject.get().each(f);\n    };\n\n    return __assign(__assign({}, subject), {\n      run: run\n    });\n  };\n\n  var value$1 = function () {\n    var subject = singleton(noop);\n\n    var on = function (f) {\n      return subject.get().each(f);\n    };\n\n    return __assign(__assign({}, subject), {\n      on: on\n    });\n  };\n\n  var filter = always;\n\n  var bind = function (element, event, handler) {\n    return bind$2(element, event, filter, handler);\n  };\n\n  var capture = function (element, event, handler) {\n    return capture$1(element, event, filter, handler);\n  };\n\n  var fromRawEvent = fromRawEvent$1;\n  var properties = ['top', 'bottom', 'right', 'left'];\n  var timerAttr = 'data-alloy-transition-timer';\n\n  var isTransitioning$1 = function (element, transition) {\n    return hasAll(element, transition.classes);\n  };\n\n  var shouldApplyTransitionCss = function (transition, decision, lastPlacement) {\n    return lastPlacement.exists(function (placer) {\n      var mode = transition.mode;\n      return mode === 'all' ? true : placer[mode] !== decision[mode];\n    });\n  };\n\n  var hasChanges = function (position, intermediate) {\n    var round = function (value) {\n      return parseFloat(value).toFixed(3);\n    };\n\n    return find$4(intermediate, function (value, key) {\n      var newValue = position[key].map(round);\n      var val = value.map(round);\n      return !equals(newValue, val);\n    }).isSome();\n  };\n\n  var getTransitionDuration = function (element) {\n    var get = function (name) {\n      var style = get$c(element, name);\n      var times = isString(style) ? style.split(/\\s*,\\s*/) : [];\n      return filter$2(times, isNotEmpty);\n    };\n\n    var parse = function (value) {\n      if (isString(value) && /^[\\d.]+/.test(value)) {\n        var num = parseFloat(value);\n        return endsWith(value, 'ms') ? num : num * 1000;\n      } else {\n        return 0;\n      }\n    };\n\n    var delay = get('transition-delay');\n    var duration = get('transition-duration');\n    return foldl(duration, function (acc, dur, i) {\n      var time = parse(delay[i]) + parse(dur);\n      return Math.max(acc, time);\n    }, 0);\n  };\n\n  var setupTransitionListeners = function (element, transition) {\n    var transitionEnd = unbindable();\n    var transitionCancel = unbindable();\n    var timer;\n\n    var isSourceTransition = function (e) {\n      var _a;\n\n      var pseudoElement = (_a = e.raw.pseudoElement) !== null && _a !== void 0 ? _a : '';\n      return eq(e.target, element) && isEmpty(pseudoElement) && contains$2(properties, e.raw.propertyName);\n    };\n\n    var transitionDone = function (e) {\n      if (isNullable(e) || isSourceTransition(e)) {\n        transitionEnd.clear();\n        transitionCancel.clear();\n        var type = e === null || e === void 0 ? void 0 : e.raw.type;\n\n        if (isNullable(type) || type === transitionend()) {\n          clearTimeout(timer);\n          remove$7(element, timerAttr);\n          remove$1(element, transition.classes);\n        }\n      }\n    };\n\n    var transitionStarted = function () {\n      transitionEnd.set(bind(element, transitionend(), transitionDone));\n      transitionCancel.set(bind(element, transitioncancel(), transitionDone));\n    };\n\n    if ('ontransitionstart' in element.dom) {\n      var transitionStart_1 = bind(element, transitionstart(), function (e) {\n        if (isSourceTransition(e)) {\n          transitionStart_1.unbind();\n          transitionStarted();\n        }\n      });\n    } else {\n      transitionStarted();\n    }\n\n    var duration = getTransitionDuration(element);\n    requestAnimationFrame(function () {\n      timer = setTimeout(transitionDone, duration + 17);\n      set$8(element, timerAttr, timer);\n    });\n  };\n\n  var startTransitioning = function (element, transition) {\n    add$1(element, transition.classes);\n    getOpt(element, timerAttr).each(function (timerId) {\n      clearTimeout(parseInt(timerId, 10));\n      remove$7(element, timerAttr);\n    });\n    setupTransitionListeners(element, transition);\n  };\n\n  var applyTransitionCss = function (element, origin, position, transition, decision, lastPlacement) {\n    var shouldTransition = shouldApplyTransitionCss(transition, decision, lastPlacement);\n\n    if (shouldTransition || isTransitioning$1(element, transition)) {\n      set$7(element, 'position', position.position);\n      var rect = toBox(origin, element);\n      var intermediatePosition_1 = reposition(origin, __assign(__assign({}, decision), {\n        rect: rect\n      }));\n      var intermediateCssOptions = mapToObject(properties, function (prop) {\n        return intermediatePosition_1[prop];\n      });\n\n      if (hasChanges(position, intermediateCssOptions)) {\n        setOptions(element, intermediateCssOptions);\n\n        if (shouldTransition) {\n          startTransitioning(element, transition);\n        }\n\n        reflow(element);\n      }\n    } else {\n      remove$1(element, transition.classes);\n    }\n  };\n\n  var elementSize = function (p) {\n    return {\n      width: getOuter$1(p),\n      height: getOuter$2(p)\n    };\n  };\n\n  var layout = function (anchorBox, element, bubbles, options) {\n    remove$6(element, 'max-height');\n    remove$6(element, 'max-width');\n    var elementBox = elementSize(element);\n    return attempts(element, options.preference, anchorBox, elementBox, bubbles, options.bounds);\n  };\n\n  var setClasses = function (element, decision) {\n    var classInfo = decision.classes;\n    remove$1(element, classInfo.off);\n    add$1(element, classInfo.on);\n  };\n\n  var setHeight = function (element, decision, options) {\n    var maxHeightFunction = options.maxHeightFunction;\n    maxHeightFunction(element, decision.maxHeight);\n  };\n\n  var setWidth = function (element, decision, options) {\n    var maxWidthFunction = options.maxWidthFunction;\n    maxWidthFunction(element, decision.maxWidth);\n  };\n\n  var position$2 = function (element, decision, options) {\n    var positionCss = reposition(options.origin, decision);\n    options.transition.each(function (transition) {\n      applyTransitionCss(element, options.origin, positionCss, transition, decision, options.lastPlacement);\n    });\n    applyPositionCss(element, positionCss);\n  };\n\n  var setPlacement = function (element, decision) {\n    setPlacement$1(element, decision.placement);\n  };\n\n  var setMaxHeight = function (element, maxHeight) {\n    setMax$1(element, Math.floor(maxHeight));\n  };\n\n  var anchored = constant$1(function (element, available) {\n    setMaxHeight(element, available);\n    setAll(element, {\n      'overflow-x': 'hidden',\n      'overflow-y': 'auto'\n    });\n  });\n  var expandable$1 = constant$1(function (element, available) {\n    setMaxHeight(element, available);\n  });\n\n  var defaultOr = function (options, key, dephault) {\n    return options[key] === undefined ? dephault : options[key];\n  };\n\n  var simple = function (anchor, element, bubble, layouts, lastPlacement, getBounds, overrideOptions, transition) {\n    var maxHeightFunction = defaultOr(overrideOptions, 'maxHeightFunction', anchored());\n    var maxWidthFunction = defaultOr(overrideOptions, 'maxWidthFunction', noop);\n    var anchorBox = anchor.anchorBox;\n    var origin = anchor.origin;\n    var options = {\n      bounds: viewport(origin, getBounds),\n      origin: origin,\n      preference: layouts,\n      maxHeightFunction: maxHeightFunction,\n      maxWidthFunction: maxWidthFunction,\n      lastPlacement: lastPlacement,\n      transition: transition\n    };\n    return go(anchorBox, element, bubble, options);\n  };\n\n  var go = function (anchorBox, element, bubble, options) {\n    var decision = layout(anchorBox, element, bubble, options);\n    position$2(element, decision, options);\n    setPlacement(element, decision);\n    setClasses(element, decision);\n    setHeight(element, decision, options);\n    setWidth(element, decision, options);\n    return {\n      layout: decision.layout,\n      placement: decision.placement\n    };\n  };\n\n  var allAlignments = ['valignCentre', 'alignLeft', 'alignRight', 'alignCentre', 'top', 'bottom', 'left', 'right', 'inset'];\n\n  var nu$5 = function (xOffset, yOffset, classes, insetModifier) {\n    if (insetModifier === void 0) {\n      insetModifier = 1;\n    }\n\n    var insetXOffset = xOffset * insetModifier;\n    var insetYOffset = yOffset * insetModifier;\n\n    var getClasses = function (prop) {\n      return get$e(classes, prop).getOr([]);\n    };\n\n    var make = function (xDelta, yDelta, alignmentsOn) {\n      var alignmentsOff = difference(allAlignments, alignmentsOn);\n      return {\n        offset: SugarPosition(xDelta, yDelta),\n        classesOn: bind$3(alignmentsOn, getClasses),\n        classesOff: bind$3(alignmentsOff, getClasses)\n      };\n    };\n\n    return {\n      southeast: function () {\n        return make(-xOffset, yOffset, ['top', 'alignLeft']);\n      },\n      southwest: function () {\n        return make(xOffset, yOffset, ['top', 'alignRight']);\n      },\n      south: function () {\n        return make(-xOffset / 2, yOffset, ['top', 'alignCentre']);\n      },\n      northeast: function () {\n        return make(-xOffset, -yOffset, ['bottom', 'alignLeft']);\n      },\n      northwest: function () {\n        return make(xOffset, -yOffset, ['bottom', 'alignRight']);\n      },\n      north: function () {\n        return make(-xOffset / 2, -yOffset, ['bottom', 'alignCentre']);\n      },\n      east: function () {\n        return make(xOffset, -yOffset / 2, ['valignCentre', 'left']);\n      },\n      west: function () {\n        return make(-xOffset, -yOffset / 2, ['valignCentre', 'right']);\n      },\n      insetNortheast: function () {\n        return make(insetXOffset, insetYOffset, ['top', 'alignLeft', 'inset']);\n      },\n      insetNorthwest: function () {\n        return make(-insetXOffset, insetYOffset, ['top', 'alignRight', 'inset']);\n      },\n      insetNorth: function () {\n        return make(-insetXOffset / 2, insetYOffset, ['top', 'alignCentre', 'inset']);\n      },\n      insetSoutheast: function () {\n        return make(insetXOffset, -insetYOffset, ['bottom', 'alignLeft', 'inset']);\n      },\n      insetSouthwest: function () {\n        return make(-insetXOffset, -insetYOffset, ['bottom', 'alignRight', 'inset']);\n      },\n      insetSouth: function () {\n        return make(-insetXOffset / 2, -insetYOffset, ['bottom', 'alignCentre', 'inset']);\n      },\n      insetEast: function () {\n        return make(-insetXOffset, -insetYOffset / 2, ['valignCentre', 'right', 'inset']);\n      },\n      insetWest: function () {\n        return make(insetXOffset, -insetYOffset / 2, ['valignCentre', 'left', 'inset']);\n      }\n    };\n  };\n\n  var fallback = function () {\n    return nu$5(0, 0, {});\n  };\n\n  var nu$4 = identity$1;\n\n  var onDirection = function (isLtr, isRtl) {\n    return function (element) {\n      return getDirection(element) === 'rtl' ? isRtl : isLtr;\n    };\n  };\n\n  var getDirection = function (element) {\n    return get$c(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n  };\n\n  var AttributeValue;\n\n  (function (AttributeValue) {\n    AttributeValue['TopToBottom'] = 'toptobottom';\n    AttributeValue['BottomToTop'] = 'bottomtotop';\n  })(AttributeValue || (AttributeValue = {}));\n\n  var Attribute = 'data-alloy-vertical-dir';\n\n  var isBottomToTopDir = function (el) {\n    return closest$2(el, function (current) {\n      return isElement$2(current) && get$d(current, 'data-alloy-vertical-dir') === AttributeValue.BottomToTop;\n    });\n  };\n\n  var schema$y = function () {\n    return optionObjOf('layouts', [required$1('onLtr'), required$1('onRtl'), option('onBottomLtr'), option('onBottomRtl')]);\n  };\n\n  var get$4 = function (elem, info, defaultLtr, defaultRtl, defaultBottomLtr, defaultBottomRtl, dirElement) {\n    var isBottomToTop = dirElement.map(isBottomToTopDir).getOr(false);\n    var customLtr = info.layouts.map(function (ls) {\n      return ls.onLtr(elem);\n    });\n    var customRtl = info.layouts.map(function (ls) {\n      return ls.onRtl(elem);\n    });\n    var ltr = isBottomToTop ? info.layouts.bind(function (ls) {\n      return ls.onBottomLtr.map(function (f) {\n        return f(elem);\n      });\n    }).or(customLtr).getOr(defaultBottomLtr) : customLtr.getOr(defaultLtr);\n    var rtl = isBottomToTop ? info.layouts.bind(function (ls) {\n      return ls.onBottomRtl.map(function (f) {\n        return f(elem);\n      });\n    }).or(customRtl).getOr(defaultBottomRtl) : customRtl.getOr(defaultRtl);\n    var f = onDirection(ltr, rtl);\n    return f(elem);\n  };\n\n  var placement$4 = function (component, anchorInfo, origin) {\n    var hotspot = anchorInfo.hotspot;\n    var anchorBox = toBox(origin, hotspot.element);\n    var layouts = get$4(component.element, anchorInfo, belowOrAbove(), belowOrAboveRtl(), aboveOrBelow(), aboveOrBelowRtl(), Optional.some(anchorInfo.hotspot.element));\n    return Optional.some(nu$4({\n      anchorBox: anchorBox,\n      bubble: anchorInfo.bubble.getOr(fallback()),\n      overrides: anchorInfo.overrides,\n      layouts: layouts,\n      placer: Optional.none()\n    }));\n  };\n\n  var HotspotAnchor = [required$1('hotspot'), option('bubble'), defaulted('overrides', {}), schema$y(), output$1('placement', placement$4)];\n\n  var placement$3 = function (component, anchorInfo, origin) {\n    var pos = translate$2(origin, anchorInfo.x, anchorInfo.y);\n    var anchorBox = bounds(pos.left, pos.top, anchorInfo.width, anchorInfo.height);\n    var layouts = get$4(component.element, anchorInfo, all$1(), allRtl$1(), all$1(), allRtl$1(), Optional.none());\n    return Optional.some(nu$4({\n      anchorBox: anchorBox,\n      bubble: anchorInfo.bubble,\n      overrides: anchorInfo.overrides,\n      layouts: layouts,\n      placer: Optional.none()\n    }));\n  };\n\n  var MakeshiftAnchor = [required$1('x'), required$1('y'), defaulted('height', 0), defaulted('width', 0), defaulted('bubble', fallback()), defaulted('overrides', {}), schema$y(), output$1('placement', placement$3)];\n  var adt$7 = Adt.generate([{\n    screen: ['point']\n  }, {\n    absolute: ['point', 'scrollLeft', 'scrollTop']\n  }]);\n\n  var toFixed = function (pos) {\n    return pos.fold(identity$1, function (point, scrollLeft, scrollTop) {\n      return point.translate(-scrollLeft, -scrollTop);\n    });\n  };\n\n  var toAbsolute = function (pos) {\n    return pos.fold(identity$1, identity$1);\n  };\n\n  var sum = function (points) {\n    return foldl(points, function (b, a) {\n      return b.translate(a.left, a.top);\n    }, SugarPosition(0, 0));\n  };\n\n  var sumAsFixed = function (positions) {\n    var points = map$2(positions, toFixed);\n    return sum(points);\n  };\n\n  var sumAsAbsolute = function (positions) {\n    var points = map$2(positions, toAbsolute);\n    return sum(points);\n  };\n\n  var screen = adt$7.screen;\n  var absolute$1 = adt$7.absolute;\n\n  var getOffset = function (component, origin, anchorInfo) {\n    var win = defaultView(anchorInfo.root).dom;\n\n    var hasSameOwner = function (frame) {\n      var frameOwner = owner$4(frame);\n      var compOwner = owner$4(component.element);\n      return eq(frameOwner, compOwner);\n    };\n\n    return Optional.from(win.frameElement).map(SugarElement.fromDom).filter(hasSameOwner).map(absolute$3);\n  };\n\n  var getRootPoint = function (component, origin, anchorInfo) {\n    var doc = owner$4(component.element);\n    var outerScroll = get$9(doc);\n    var offset = getOffset(component, origin, anchorInfo).getOr(outerScroll);\n    return absolute$1(offset, outerScroll.left, outerScroll.top);\n  };\n\n  var getBox = function (left, top, width, height) {\n    var point = screen(SugarPosition(left, top));\n    return Optional.some(pointed(point, width, height));\n  };\n\n  var calcNewAnchor = function (optBox, rootPoint, anchorInfo, origin, elem) {\n    return optBox.map(function (box) {\n      var points = [rootPoint, box.point];\n      var topLeft = cata$1(origin, function () {\n        return sumAsAbsolute(points);\n      }, function () {\n        return sumAsAbsolute(points);\n      }, function () {\n        return sumAsFixed(points);\n      });\n      var anchorBox = rect(topLeft.left, topLeft.top, box.width, box.height);\n      var layoutsLtr = anchorInfo.showAbove ? aboveOrBelow() : belowOrAbove();\n      var layoutsRtl = anchorInfo.showAbove ? aboveOrBelowRtl() : belowOrAboveRtl();\n      var layouts = get$4(elem, anchorInfo, layoutsLtr, layoutsRtl, layoutsLtr, layoutsRtl, Optional.none());\n      return nu$4({\n        anchorBox: anchorBox,\n        bubble: anchorInfo.bubble.getOr(fallback()),\n        overrides: anchorInfo.overrides,\n        layouts: layouts,\n        placer: Optional.none()\n      });\n    });\n  };\n\n  var placement$2 = function (component, anchorInfo, origin) {\n    var rootPoint = getRootPoint(component, origin, anchorInfo);\n    return anchorInfo.node.filter(inBody).bind(function (target) {\n      var rect = target.dom.getBoundingClientRect();\n      var nodeBox = getBox(rect.left, rect.top, rect.width, rect.height);\n      var elem = anchorInfo.node.getOr(component.element);\n      return calcNewAnchor(nodeBox, rootPoint, anchorInfo, origin, elem);\n    });\n  };\n\n  var NodeAnchor = [required$1('node'), required$1('root'), option('bubble'), schema$y(), defaulted('overrides', {}), defaulted('showAbove', false), output$1('placement', placement$2)];\n  var zeroWidth = '\\uFEFF';\n  var nbsp = '\\xA0';\n\n  var create$6 = function (start, soffset, finish, foffset) {\n    return {\n      start: start,\n      soffset: soffset,\n      finish: finish,\n      foffset: foffset\n    };\n  };\n\n  var SimRange = {\n    create: create$6\n  };\n  var adt$6 = Adt.generate([{\n    before: ['element']\n  }, {\n    on: ['element', 'offset']\n  }, {\n    after: ['element']\n  }]);\n\n  var cata = function (subject, onBefore, onOn, onAfter) {\n    return subject.fold(onBefore, onOn, onAfter);\n  };\n\n  var getStart$1 = function (situ) {\n    return situ.fold(identity$1, identity$1, identity$1);\n  };\n\n  var before = adt$6.before;\n  var on$1 = adt$6.on;\n  var after$1 = adt$6.after;\n  var Situ = {\n    before: before,\n    on: on$1,\n    after: after$1,\n    cata: cata,\n    getStart: getStart$1\n  };\n  var adt$5 = Adt.generate([{\n    domRange: ['rng']\n  }, {\n    relative: ['startSitu', 'finishSitu']\n  }, {\n    exact: ['start', 'soffset', 'finish', 'foffset']\n  }]);\n\n  var exactFromRange = function (simRange) {\n    return adt$5.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n  };\n\n  var getStart = function (selection) {\n    return selection.match({\n      domRange: function (rng) {\n        return SugarElement.fromDom(rng.startContainer);\n      },\n      relative: function (startSitu, _finishSitu) {\n        return Situ.getStart(startSitu);\n      },\n      exact: function (start, _soffset, _finish, _foffset) {\n        return start;\n      }\n    });\n  };\n\n  var domRange = adt$5.domRange;\n  var relative = adt$5.relative;\n  var exact = adt$5.exact;\n\n  var getWin = function (selection) {\n    var start = getStart(selection);\n    return defaultView(start);\n  };\n\n  var range$1 = SimRange.create;\n  var SimSelection = {\n    domRange: domRange,\n    relative: relative,\n    exact: exact,\n    exactFromRange: exactFromRange,\n    getWin: getWin,\n    range: range$1\n  };\n\n  var setStart = function (rng, situ) {\n    situ.fold(function (e) {\n      rng.setStartBefore(e.dom);\n    }, function (e, o) {\n      rng.setStart(e.dom, o);\n    }, function (e) {\n      rng.setStartAfter(e.dom);\n    });\n  };\n\n  var setFinish = function (rng, situ) {\n    situ.fold(function (e) {\n      rng.setEndBefore(e.dom);\n    }, function (e, o) {\n      rng.setEnd(e.dom, o);\n    }, function (e) {\n      rng.setEndAfter(e.dom);\n    });\n  };\n\n  var relativeToNative = function (win, startSitu, finishSitu) {\n    var range = win.document.createRange();\n    setStart(range, startSitu);\n    setFinish(range, finishSitu);\n    return range;\n  };\n\n  var exactToNative = function (win, start, soffset, finish, foffset) {\n    var rng = win.document.createRange();\n    rng.setStart(start.dom, soffset);\n    rng.setEnd(finish.dom, foffset);\n    return rng;\n  };\n\n  var toRect = function (rect) {\n    return {\n      left: rect.left,\n      top: rect.top,\n      right: rect.right,\n      bottom: rect.bottom,\n      width: rect.width,\n      height: rect.height\n    };\n  };\n\n  var getFirstRect$1 = function (rng) {\n    var rects = rng.getClientRects();\n    var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n    return rect.width > 0 || rect.height > 0 ? Optional.some(rect).map(toRect) : Optional.none();\n  };\n\n  var getBounds$2 = function (rng) {\n    var rect = rng.getBoundingClientRect();\n    return rect.width > 0 || rect.height > 0 ? Optional.some(rect).map(toRect) : Optional.none();\n  };\n\n  var adt$4 = Adt.generate([{\n    ltr: ['start', 'soffset', 'finish', 'foffset']\n  }, {\n    rtl: ['start', 'soffset', 'finish', 'foffset']\n  }]);\n\n  var fromRange = function (win, type, range) {\n    return type(SugarElement.fromDom(range.startContainer), range.startOffset, SugarElement.fromDom(range.endContainer), range.endOffset);\n  };\n\n  var getRanges = function (win, selection) {\n    return selection.match({\n      domRange: function (rng) {\n        return {\n          ltr: constant$1(rng),\n          rtl: Optional.none\n        };\n      },\n      relative: function (startSitu, finishSitu) {\n        return {\n          ltr: cached(function () {\n            return relativeToNative(win, startSitu, finishSitu);\n          }),\n          rtl: cached(function () {\n            return Optional.some(relativeToNative(win, finishSitu, startSitu));\n          })\n        };\n      },\n      exact: function (start, soffset, finish, foffset) {\n        return {\n          ltr: cached(function () {\n            return exactToNative(win, start, soffset, finish, foffset);\n          }),\n          rtl: cached(function () {\n            return Optional.some(exactToNative(win, finish, foffset, start, soffset));\n          })\n        };\n      }\n    });\n  };\n\n  var doDiagnose = function (win, ranges) {\n    var rng = ranges.ltr();\n\n    if (rng.collapsed) {\n      var reversed = ranges.rtl().filter(function (rev) {\n        return rev.collapsed === false;\n      });\n      return reversed.map(function (rev) {\n        return adt$4.rtl(SugarElement.fromDom(rev.endContainer), rev.endOffset, SugarElement.fromDom(rev.startContainer), rev.startOffset);\n      }).getOrThunk(function () {\n        return fromRange(win, adt$4.ltr, rng);\n      });\n    } else {\n      return fromRange(win, adt$4.ltr, rng);\n    }\n  };\n\n  var diagnose = function (win, selection) {\n    var ranges = getRanges(win, selection);\n    return doDiagnose(win, ranges);\n  };\n\n  var asLtrRange = function (win, selection) {\n    var diagnosis = diagnose(win, selection);\n    return diagnosis.match({\n      ltr: function (start, soffset, finish, foffset) {\n        var rng = win.document.createRange();\n        rng.setStart(start.dom, soffset);\n        rng.setEnd(finish.dom, foffset);\n        return rng;\n      },\n      rtl: function (start, soffset, finish, foffset) {\n        var rng = win.document.createRange();\n        rng.setStart(finish.dom, foffset);\n        rng.setEnd(start.dom, soffset);\n        return rng;\n      }\n    });\n  };\n\n  adt$4.ltr;\n  adt$4.rtl;\n\n  var NodeValue = function (is, name) {\n    var get = function (element) {\n      if (!is(element)) {\n        throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n      }\n\n      return getOption(element).getOr('');\n    };\n\n    var getOption = function (element) {\n      return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n    };\n\n    var set = function (element, value) {\n      if (!is(element)) {\n        throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n      }\n\n      element.dom.nodeValue = value;\n    };\n\n    return {\n      get: get,\n      getOption: getOption,\n      set: set\n    };\n  };\n\n  var api = NodeValue(isText$1, 'text');\n\n  var get$3 = function (element) {\n    return api.get(element);\n  };\n\n  var getOption = function (element) {\n    return api.getOption(element);\n  };\n\n  var getEnd = function (element) {\n    return name$2(element) === 'img' ? 1 : getOption(element).fold(function () {\n      return children(element).length;\n    }, function (v) {\n      return v.length;\n    });\n  };\n\n  var isTextNodeWithCursorPosition = function (el) {\n    return getOption(el).filter(function (text) {\n      return text.trim().length !== 0 || text.indexOf(nbsp) > -1;\n    }).isSome();\n  };\n\n  var elementsWithCursorPosition = ['img', 'br'];\n\n  var isCursorPosition = function (elem) {\n    var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n    return hasCursorPosition || contains$2(elementsWithCursorPosition, name$2(elem));\n  };\n\n  var last$1 = function (element) {\n    return descendantRtl(element, isCursorPosition);\n  };\n\n  var descendantRtl = function (scope, predicate) {\n    var descend = function (element) {\n      var children$1 = children(element);\n\n      for (var i = children$1.length - 1; i >= 0; i--) {\n        var child = children$1[i];\n\n        if (predicate(child)) {\n          return Optional.some(child);\n        }\n\n        var res = descend(child);\n\n        if (res.isSome()) {\n          return res;\n        }\n      }\n\n      return Optional.none();\n    };\n\n    return descend(scope);\n  };\n\n  var descendants = function (scope, selector) {\n    return all$3(selector, scope);\n  };\n\n  var makeRange = function (start, soffset, finish, foffset) {\n    var doc = owner$4(start);\n    var rng = doc.dom.createRange();\n    rng.setStart(start.dom, soffset);\n    rng.setEnd(finish.dom, foffset);\n    return rng;\n  };\n\n  var after = function (start, soffset, finish, foffset) {\n    var r = makeRange(start, soffset, finish, foffset);\n    var same = eq(start, finish) && soffset === foffset;\n    return r.collapsed && !same;\n  };\n\n  var getNativeSelection = function (win) {\n    return Optional.from(win.getSelection());\n  };\n\n  var readRange = function (selection) {\n    if (selection.rangeCount > 0) {\n      var firstRng = selection.getRangeAt(0);\n      var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n      return Optional.some(SimRange.create(SugarElement.fromDom(firstRng.startContainer), firstRng.startOffset, SugarElement.fromDom(lastRng.endContainer), lastRng.endOffset));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var doGetExact = function (selection) {\n    if (selection.anchorNode === null || selection.focusNode === null) {\n      return readRange(selection);\n    } else {\n      var anchor = SugarElement.fromDom(selection.anchorNode);\n      var focus_1 = SugarElement.fromDom(selection.focusNode);\n      return after(anchor, selection.anchorOffset, focus_1, selection.focusOffset) ? Optional.some(SimRange.create(anchor, selection.anchorOffset, focus_1, selection.focusOffset)) : readRange(selection);\n    }\n  };\n\n  var getExact = function (win) {\n    return getNativeSelection(win).filter(function (sel) {\n      return sel.rangeCount > 0;\n    }).bind(doGetExact);\n  };\n\n  var getFirstRect = function (win, selection) {\n    var rng = asLtrRange(win, selection);\n    return getFirstRect$1(rng);\n  };\n\n  var getBounds$1 = function (win, selection) {\n    var rng = asLtrRange(win, selection);\n    return getBounds$2(rng);\n  };\n\n  var point$1 = function (element, offset) {\n    return {\n      element: element,\n      offset: offset\n    };\n  };\n\n  var descendOnce$1 = function (element, offset) {\n    var children$1 = children(element);\n\n    if (children$1.length === 0) {\n      return point$1(element, offset);\n    } else if (offset < children$1.length) {\n      return point$1(children$1[offset], 0);\n    } else {\n      var last = children$1[children$1.length - 1];\n      var len = isText$1(last) ? get$3(last).length : children(last).length;\n      return point$1(last, len);\n    }\n  };\n\n  var descendOnce = function (element, offset) {\n    return isText$1(element) ? point$1(element, offset) : descendOnce$1(element, offset);\n  };\n\n  var getAnchorSelection = function (win, anchorInfo) {\n    var getSelection = anchorInfo.getSelection.getOrThunk(function () {\n      return function () {\n        return getExact(win);\n      };\n    });\n    return getSelection().map(function (sel) {\n      var modStart = descendOnce(sel.start, sel.soffset);\n      var modFinish = descendOnce(sel.finish, sel.foffset);\n      return SimSelection.range(modStart.element, modStart.offset, modFinish.element, modFinish.offset);\n    });\n  };\n\n  var placement$1 = function (component, anchorInfo, origin) {\n    var win = defaultView(anchorInfo.root).dom;\n    var rootPoint = getRootPoint(component, origin, anchorInfo);\n    var selectionBox = getAnchorSelection(win, anchorInfo).bind(function (sel) {\n      var optRect = getBounds$1(win, SimSelection.exactFromRange(sel)).orThunk(function () {\n        var x = SugarElement.fromText(zeroWidth);\n        before$2(sel.start, x);\n        var rect = getFirstRect(win, SimSelection.exact(x, 0, x, 1));\n        remove$5(x);\n        return rect;\n      });\n      return optRect.bind(function (rawRect) {\n        return getBox(rawRect.left, rawRect.top, rawRect.width, rawRect.height);\n      });\n    });\n    var targetElement = getAnchorSelection(win, anchorInfo).bind(function (sel) {\n      return isElement$2(sel.start) ? Optional.some(sel.start) : parentNode(sel.start);\n    });\n    var elem = targetElement.getOr(component.element);\n    return calcNewAnchor(selectionBox, rootPoint, anchorInfo, origin, elem);\n  };\n\n  var SelectionAnchor = [option('getSelection'), required$1('root'), option('bubble'), schema$y(), defaulted('overrides', {}), defaulted('showAbove', false), output$1('placement', placement$1)];\n  var labelPrefix$1 = 'link-layout';\n\n  var eastX = function (anchor) {\n    return anchor.x + anchor.width;\n  };\n\n  var westX = function (anchor, element) {\n    return anchor.x - element.width;\n  };\n\n  var northY$1 = function (anchor, element) {\n    return anchor.y - element.height + anchor.height;\n  };\n\n  var southY$1 = function (anchor) {\n    return anchor.y;\n  };\n\n  var southeast$1 = function (anchor, element, bubbles) {\n    return nu$6(eastX(anchor), southY$1(anchor), bubbles.southeast(), southeast$3(), 'southeast', boundsRestriction(anchor, {\n      left: 0,\n      top: 2\n    }), labelPrefix$1);\n  };\n\n  var southwest$1 = function (anchor, element, bubbles) {\n    return nu$6(westX(anchor, element), southY$1(anchor), bubbles.southwest(), southwest$3(), 'southwest', boundsRestriction(anchor, {\n      right: 1,\n      top: 2\n    }), labelPrefix$1);\n  };\n\n  var northeast$1 = function (anchor, element, bubbles) {\n    return nu$6(eastX(anchor), northY$1(anchor, element), bubbles.northeast(), northeast$3(), 'northeast', boundsRestriction(anchor, {\n      left: 0,\n      bottom: 3\n    }), labelPrefix$1);\n  };\n\n  var northwest$1 = function (anchor, element, bubbles) {\n    return nu$6(westX(anchor, element), northY$1(anchor, element), bubbles.northwest(), northwest$3(), 'northwest', boundsRestriction(anchor, {\n      right: 1,\n      bottom: 3\n    }), labelPrefix$1);\n  };\n\n  var all = function () {\n    return [southeast$1, southwest$1, northeast$1, northwest$1];\n  };\n\n  var allRtl = function () {\n    return [southwest$1, southeast$1, northwest$1, northeast$1];\n  };\n\n  var placement = function (component, submenuInfo, origin) {\n    var anchorBox = toBox(origin, submenuInfo.item.element);\n    var layouts = get$4(component.element, submenuInfo, all(), allRtl(), all(), allRtl(), Optional.none());\n    return Optional.some(nu$4({\n      anchorBox: anchorBox,\n      bubble: fallback(),\n      overrides: submenuInfo.overrides,\n      layouts: layouts,\n      placer: Optional.none()\n    }));\n  };\n\n  var SubmenuAnchor = [required$1('item'), schema$y(), defaulted('overrides', {}), output$1('placement', placement)];\n  var AnchorSchema = choose$1('type', {\n    selection: SelectionAnchor,\n    node: NodeAnchor,\n    hotspot: HotspotAnchor,\n    submenu: SubmenuAnchor,\n    makeshift: MakeshiftAnchor\n  });\n  var TransitionSchema = [requiredArrayOf('classes', string), defaultedStringEnum('mode', 'all', ['all', 'layout', 'placement'])];\n  var PositionSchema = [defaulted('useFixed', never), option('getBounds')];\n  var PlacementSchema = [requiredOf('anchor', AnchorSchema), optionObjOf('transition', TransitionSchema)];\n\n  var getFixedOrigin = function () {\n    var html = document.documentElement;\n    return fixed$1(0, 0, html.clientWidth, html.clientHeight);\n  };\n\n  var getRelativeOrigin = function (component) {\n    var position = absolute$3(component.element);\n    var bounds = component.element.dom.getBoundingClientRect();\n    return relative$1(position.left, position.top, bounds.width, bounds.height);\n  };\n\n  var place = function (component, origin, anchoring, getBounds, placee, lastPlace, transition) {\n    var anchor = box(anchoring.anchorBox, origin);\n    return simple(anchor, placee.element, anchoring.bubble, anchoring.layouts, lastPlace, getBounds, anchoring.overrides, transition);\n  };\n\n  var position$1 = function (component, posConfig, posState, placee, placementSpec) {\n    positionWithin(component, posConfig, posState, placee, placementSpec, Optional.none());\n  };\n\n  var positionWithin = function (component, posConfig, posState, placee, placementSpec, boxElement) {\n    var boundsBox = boxElement.map(box$1);\n    return positionWithinBounds(component, posConfig, posState, placee, placementSpec, boundsBox);\n  };\n\n  var positionWithinBounds = function (component, posConfig, posState, placee, placementSpec, bounds) {\n    var placeeDetail = asRawOrDie$1('placement.info', objOf(PlacementSchema), placementSpec);\n    var anchorage = placeeDetail.anchor;\n    var element = placee.element;\n    var placeeState = posState.get(placee.uid);\n    preserve$1(function () {\n      set$7(element, 'position', 'fixed');\n      var oldVisibility = getRaw(element, 'visibility');\n      set$7(element, 'visibility', 'hidden');\n      var origin = posConfig.useFixed() ? getFixedOrigin() : getRelativeOrigin(component);\n      var placer = anchorage.placement;\n      var getBounds = bounds.map(constant$1).or(posConfig.getBounds);\n      placer(component, anchorage, origin).each(function (anchoring) {\n        var doPlace = anchoring.placer.getOr(place);\n        var newState = doPlace(component, origin, anchoring, getBounds, placee, placeeState, placeeDetail.transition);\n        posState.set(placee.uid, newState);\n      });\n      oldVisibility.fold(function () {\n        remove$6(element, 'visibility');\n      }, function (vis) {\n        set$7(element, 'visibility', vis);\n      });\n\n      if (getRaw(element, 'left').isNone() && getRaw(element, 'top').isNone() && getRaw(element, 'right').isNone() && getRaw(element, 'bottom').isNone() && is$1(getRaw(element, 'position'), 'fixed')) {\n        remove$6(element, 'position');\n      }\n    }, element);\n  };\n\n  var getMode = function (component, pConfig, _pState) {\n    return pConfig.useFixed() ? 'fixed' : 'absolute';\n  };\n\n  var reset$1 = function (component, pConfig, posState, placee) {\n    var element = placee.element;\n    each$1(['position', 'left', 'right', 'top', 'bottom'], function (prop) {\n      return remove$6(element, prop);\n    });\n    reset$2(element);\n    posState.clear(placee.uid);\n  };\n\n  var PositionApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    position: position$1,\n    positionWithin: positionWithin,\n    positionWithinBounds: positionWithinBounds,\n    getMode: getMode,\n    reset: reset$1\n  });\n\n  var init$g = function () {\n    var state = {};\n\n    var set = function (id, data) {\n      state[id] = data;\n    };\n\n    var get = function (id) {\n      return get$e(state, id);\n    };\n\n    var clear = function (id) {\n      if (isNonNullable(id)) {\n        delete state[id];\n      } else {\n        state = {};\n      }\n    };\n\n    return nu$8({\n      readState: function () {\n        return state;\n      },\n      clear: clear,\n      set: set,\n      get: get\n    });\n  };\n\n  var PositioningState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$g\n  });\n  var Positioning = create$7({\n    fields: PositionSchema,\n    name: 'positioning',\n    active: ActivePosition,\n    apis: PositionApis,\n    state: PositioningState\n  });\n\n  var fireDetaching = function (component) {\n    emit(component, detachedFromDom());\n    var children = component.components();\n    each$1(children, fireDetaching);\n  };\n\n  var fireAttaching = function (component) {\n    var children = component.components();\n    each$1(children, fireAttaching);\n    emit(component, attachedToDom());\n  };\n\n  var attach$1 = function (parent, child) {\n    append$2(parent.element, child.element);\n  };\n\n  var detachChildren$1 = function (component) {\n    each$1(component.components(), function (childComp) {\n      return remove$5(childComp.element);\n    });\n    empty(component.element);\n    component.syncComponents();\n  };\n\n  var replaceChildren = function (component, newChildren) {\n    var subs = component.components();\n    detachChildren$1(component);\n    var deleted = difference(subs, newChildren);\n    each$1(deleted, function (comp) {\n      fireDetaching(comp);\n      component.getSystem().removeFromWorld(comp);\n    });\n    each$1(newChildren, function (childComp) {\n      if (!childComp.getSystem().isConnected()) {\n        component.getSystem().addToWorld(childComp);\n        attach$1(component, childComp);\n\n        if (inBody(component.element)) {\n          fireAttaching(childComp);\n        }\n      } else {\n        attach$1(component, childComp);\n      }\n\n      component.syncComponents();\n    });\n  };\n\n  var attach = function (parent, child) {\n    attachWith(parent, child, append$2);\n  };\n\n  var attachWith = function (parent, child, insertion) {\n    parent.getSystem().addToWorld(child);\n    insertion(parent.element, child.element);\n\n    if (inBody(parent.element)) {\n      fireAttaching(child);\n    }\n\n    parent.syncComponents();\n  };\n\n  var doDetach = function (component) {\n    fireDetaching(component);\n    remove$5(component.element);\n    component.getSystem().removeFromWorld(component);\n  };\n\n  var detach = function (component) {\n    var parent$1 = parent(component.element).bind(function (p) {\n      return component.getSystem().getByDom(p).toOptional();\n    });\n    doDetach(component);\n    parent$1.each(function (p) {\n      p.syncComponents();\n    });\n  };\n\n  var detachChildren = function (component) {\n    var subs = component.components();\n    each$1(subs, doDetach);\n    empty(component.element);\n    component.syncComponents();\n  };\n\n  var attachSystem = function (element, guiSystem) {\n    attachSystemWith(element, guiSystem, append$2);\n  };\n\n  var attachSystemAfter = function (element, guiSystem) {\n    attachSystemWith(element, guiSystem, after$2);\n  };\n\n  var attachSystemWith = function (element, guiSystem, inserter) {\n    inserter(element, guiSystem.element);\n    var children$1 = children(guiSystem.element);\n    each$1(children$1, function (child) {\n      guiSystem.getByDom(child).each(fireAttaching);\n    });\n  };\n\n  var detachSystem = function (guiSystem) {\n    var children$1 = children(guiSystem.element);\n    each$1(children$1, function (child) {\n      guiSystem.getByDom(child).each(fireDetaching);\n    });\n    remove$5(guiSystem.element);\n  };\n\n  var rebuild = function (sandbox, sConfig, sState, data) {\n    sState.get().each(function (_data) {\n      detachChildren(sandbox);\n    });\n    var point = sConfig.getAttachPoint(sandbox);\n    attach(point, sandbox);\n    var built = sandbox.getSystem().build(data);\n    attach(sandbox, built);\n    sState.set(built);\n    return built;\n  };\n\n  var open$1 = function (sandbox, sConfig, sState, data) {\n    var newState = rebuild(sandbox, sConfig, sState, data);\n    sConfig.onOpen(sandbox, newState);\n    return newState;\n  };\n\n  var setContent = function (sandbox, sConfig, sState, data) {\n    return sState.get().map(function () {\n      return rebuild(sandbox, sConfig, sState, data);\n    });\n  };\n\n  var openWhileCloaked = function (sandbox, sConfig, sState, data, transaction) {\n    cloak(sandbox, sConfig);\n    open$1(sandbox, sConfig, sState, data);\n    transaction();\n    decloak(sandbox, sConfig);\n  };\n\n  var close$1 = function (sandbox, sConfig, sState) {\n    sState.get().each(function (data) {\n      detachChildren(sandbox);\n      detach(sandbox);\n      sConfig.onClose(sandbox, data);\n      sState.clear();\n    });\n  };\n\n  var isOpen$1 = function (_sandbox, _sConfig, sState) {\n    return sState.isOpen();\n  };\n\n  var isPartOf = function (sandbox, sConfig, sState, queryElem) {\n    return isOpen$1(sandbox, sConfig, sState) && sState.get().exists(function (data) {\n      return sConfig.isPartOf(sandbox, data, queryElem);\n    });\n  };\n\n  var getState$2 = function (_sandbox, _sConfig, sState) {\n    return sState.get();\n  };\n\n  var store = function (sandbox, cssKey, attr, newValue) {\n    getRaw(sandbox.element, cssKey).fold(function () {\n      remove$7(sandbox.element, attr);\n    }, function (v) {\n      set$8(sandbox.element, attr, v);\n    });\n    set$7(sandbox.element, cssKey, newValue);\n  };\n\n  var restore = function (sandbox, cssKey, attr) {\n    getOpt(sandbox.element, attr).fold(function () {\n      return remove$6(sandbox.element, cssKey);\n    }, function (oldValue) {\n      return set$7(sandbox.element, cssKey, oldValue);\n    });\n  };\n\n  var cloak = function (sandbox, sConfig, _sState) {\n    var sink = sConfig.getAttachPoint(sandbox);\n    set$7(sandbox.element, 'position', Positioning.getMode(sink));\n    store(sandbox, 'visibility', sConfig.cloakVisibilityAttr, 'hidden');\n  };\n\n  var hasPosition = function (element) {\n    return exists(['top', 'left', 'right', 'bottom'], function (pos) {\n      return getRaw(element, pos).isSome();\n    });\n  };\n\n  var decloak = function (sandbox, sConfig, _sState) {\n    if (!hasPosition(sandbox.element)) {\n      remove$6(sandbox.element, 'position');\n    }\n\n    restore(sandbox, 'visibility', sConfig.cloakVisibilityAttr);\n  };\n\n  var SandboxApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    cloak: cloak,\n    decloak: decloak,\n    open: open$1,\n    openWhileCloaked: openWhileCloaked,\n    close: close$1,\n    isOpen: isOpen$1,\n    isPartOf: isPartOf,\n    getState: getState$2,\n    setContent: setContent\n  });\n\n  var events$g = function (sandboxConfig, sandboxState) {\n    return derive$2([run$1(sandboxClose(), function (sandbox, _simulatedEvent) {\n      close$1(sandbox, sandboxConfig, sandboxState);\n    })]);\n  };\n\n  var ActiveSandbox = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$g\n  });\n  var SandboxSchema = [onHandler('onOpen'), onHandler('onClose'), required$1('isPartOf'), required$1('getAttachPoint'), defaulted('cloakVisibilityAttr', 'data-precloak-visibility')];\n\n  var init$f = function () {\n    var contents = value$1();\n    var readState = constant$1('not-implemented');\n    return nu$8({\n      readState: readState,\n      isOpen: contents.isSet,\n      clear: contents.clear,\n      set: contents.set,\n      get: contents.get\n    });\n  };\n\n  var SandboxState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$f\n  });\n  var Sandboxing = create$7({\n    fields: SandboxSchema,\n    name: 'sandboxing',\n    active: ActiveSandbox,\n    apis: SandboxApis,\n    state: SandboxState\n  });\n  var dismissPopups = constant$1('dismiss.popups');\n  var repositionPopups = constant$1('reposition.popups');\n  var mouseReleased = constant$1('mouse.released');\n  var schema$x = objOfOnly([defaulted('isExtraPart', never), optionObjOf('fireEventInstead', [defaulted('event', dismissRequested())])]);\n\n  var receivingChannel$1 = function (rawSpec) {\n    var _a;\n\n    var detail = asRawOrDie$1('Dismissal', schema$x, rawSpec);\n    return _a = {}, _a[dismissPopups()] = {\n      schema: objOfOnly([required$1('target')]),\n      onReceive: function (sandbox, data) {\n        if (Sandboxing.isOpen(sandbox)) {\n          var isPart = Sandboxing.isPartOf(sandbox, data.target) || detail.isExtraPart(sandbox, data.target);\n\n          if (!isPart) {\n            detail.fireEventInstead.fold(function () {\n              return Sandboxing.close(sandbox);\n            }, function (fe) {\n              return emit(sandbox, fe.event);\n            });\n          }\n        }\n      }\n    }, _a;\n  };\n\n  var schema$w = objOfOnly([optionObjOf('fireEventInstead', [defaulted('event', repositionRequested())]), requiredFunction('doReposition')]);\n\n  var receivingChannel = function (rawSpec) {\n    var _a;\n\n    var detail = asRawOrDie$1('Reposition', schema$w, rawSpec);\n    return _a = {}, _a[repositionPopups()] = {\n      onReceive: function (sandbox) {\n        if (Sandboxing.isOpen(sandbox)) {\n          detail.fireEventInstead.fold(function () {\n            return detail.doReposition(sandbox);\n          }, function (fe) {\n            return emit(sandbox, fe.event);\n          });\n        }\n      }\n    }, _a;\n  };\n\n  var onLoad$5 = function (component, repConfig, repState) {\n    repConfig.store.manager.onLoad(component, repConfig, repState);\n  };\n\n  var onUnload$2 = function (component, repConfig, repState) {\n    repConfig.store.manager.onUnload(component, repConfig, repState);\n  };\n\n  var setValue$3 = function (component, repConfig, repState, data) {\n    repConfig.store.manager.setValue(component, repConfig, repState, data);\n  };\n\n  var getValue$3 = function (component, repConfig, repState) {\n    return repConfig.store.manager.getValue(component, repConfig, repState);\n  };\n\n  var getState$1 = function (component, repConfig, repState) {\n    return repState;\n  };\n\n  var RepresentApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    onLoad: onLoad$5,\n    onUnload: onUnload$2,\n    setValue: setValue$3,\n    getValue: getValue$3,\n    getState: getState$1\n  });\n\n  var events$f = function (repConfig, repState) {\n    var es = repConfig.resetOnDom ? [runOnAttached(function (comp, _se) {\n      onLoad$5(comp, repConfig, repState);\n    }), runOnDetached(function (comp, _se) {\n      onUnload$2(comp, repConfig, repState);\n    })] : [loadEvent(repConfig, repState, onLoad$5)];\n    return derive$2(es);\n  };\n\n  var ActiveRepresenting = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$f\n  });\n\n  var memory$1 = function () {\n    var data = Cell(null);\n\n    var readState = function () {\n      return {\n        mode: 'memory',\n        value: data.get()\n      };\n    };\n\n    var isNotSet = function () {\n      return data.get() === null;\n    };\n\n    var clear = function () {\n      data.set(null);\n    };\n\n    return nu$8({\n      set: data.set,\n      get: data.get,\n      isNotSet: isNotSet,\n      clear: clear,\n      readState: readState\n    });\n  };\n\n  var manual = function () {\n    var readState = noop;\n    return nu$8({\n      readState: readState\n    });\n  };\n\n  var dataset = function () {\n    var dataByValue = Cell({});\n    var dataByText = Cell({});\n\n    var readState = function () {\n      return {\n        mode: 'dataset',\n        dataByValue: dataByValue.get(),\n        dataByText: dataByText.get()\n      };\n    };\n\n    var clear = function () {\n      dataByValue.set({});\n      dataByText.set({});\n    };\n\n    var lookup = function (itemString) {\n      return get$e(dataByValue.get(), itemString).orThunk(function () {\n        return get$e(dataByText.get(), itemString);\n      });\n    };\n\n    var update = function (items) {\n      var currentDataByValue = dataByValue.get();\n      var currentDataByText = dataByText.get();\n      var newDataByValue = {};\n      var newDataByText = {};\n      each$1(items, function (item) {\n        newDataByValue[item.value] = item;\n        get$e(item, 'meta').each(function (meta) {\n          get$e(meta, 'text').each(function (text) {\n            newDataByText[text] = item;\n          });\n        });\n      });\n      dataByValue.set(__assign(__assign({}, currentDataByValue), newDataByValue));\n      dataByText.set(__assign(__assign({}, currentDataByText), newDataByText));\n    };\n\n    return nu$8({\n      readState: readState,\n      lookup: lookup,\n      update: update,\n      clear: clear\n    });\n  };\n\n  var init$e = function (spec) {\n    return spec.store.manager.state(spec);\n  };\n\n  var RepresentState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    memory: memory$1,\n    dataset: dataset,\n    manual: manual,\n    init: init$e\n  });\n\n  var setValue$2 = function (component, repConfig, repState, data) {\n    var store = repConfig.store;\n    repState.update([data]);\n    store.setValue(component, data);\n    repConfig.onSetValue(component, data);\n  };\n\n  var getValue$2 = function (component, repConfig, repState) {\n    var store = repConfig.store;\n    var key = store.getDataKey(component);\n    return repState.lookup(key).getOrThunk(function () {\n      return store.getFallbackEntry(key);\n    });\n  };\n\n  var onLoad$4 = function (component, repConfig, repState) {\n    var store = repConfig.store;\n    store.initialValue.each(function (data) {\n      setValue$2(component, repConfig, repState, data);\n    });\n  };\n\n  var onUnload$1 = function (component, repConfig, repState) {\n    repState.clear();\n  };\n\n  var DatasetStore = [option('initialValue'), required$1('getFallbackEntry'), required$1('getDataKey'), required$1('setValue'), output$1('manager', {\n    setValue: setValue$2,\n    getValue: getValue$2,\n    onLoad: onLoad$4,\n    onUnload: onUnload$1,\n    state: dataset\n  })];\n\n  var getValue$1 = function (component, repConfig, _repState) {\n    return repConfig.store.getValue(component);\n  };\n\n  var setValue$1 = function (component, repConfig, _repState, data) {\n    repConfig.store.setValue(component, data);\n    repConfig.onSetValue(component, data);\n  };\n\n  var onLoad$3 = function (component, repConfig, _repState) {\n    repConfig.store.initialValue.each(function (data) {\n      repConfig.store.setValue(component, data);\n    });\n  };\n\n  var ManualStore = [required$1('getValue'), defaulted('setValue', noop), option('initialValue'), output$1('manager', {\n    setValue: setValue$1,\n    getValue: getValue$1,\n    onLoad: onLoad$3,\n    onUnload: noop,\n    state: NoState.init\n  })];\n\n  var setValue = function (component, repConfig, repState, data) {\n    repState.set(data);\n    repConfig.onSetValue(component, data);\n  };\n\n  var getValue = function (component, repConfig, repState) {\n    return repState.get();\n  };\n\n  var onLoad$2 = function (component, repConfig, repState) {\n    repConfig.store.initialValue.each(function (initVal) {\n      if (repState.isNotSet()) {\n        repState.set(initVal);\n      }\n    });\n  };\n\n  var onUnload = function (component, repConfig, repState) {\n    repState.clear();\n  };\n\n  var MemoryStore = [option('initialValue'), output$1('manager', {\n    setValue: setValue,\n    getValue: getValue,\n    onLoad: onLoad$2,\n    onUnload: onUnload,\n    state: memory$1\n  })];\n  var RepresentSchema = [defaultedOf('store', {\n    mode: 'memory'\n  }, choose$1('mode', {\n    memory: MemoryStore,\n    manual: ManualStore,\n    dataset: DatasetStore\n  })), onHandler('onSetValue'), defaulted('resetOnDom', false)];\n  var Representing = create$7({\n    fields: RepresentSchema,\n    name: 'representing',\n    active: ActiveRepresenting,\n    apis: RepresentApis,\n    extra: {\n      setValueFrom: function (component, source) {\n        var value = Representing.getValue(source);\n        Representing.setValue(component, value);\n      }\n    },\n    state: RepresentState\n  });\n\n  var field = function (name, forbidden) {\n    return defaultedObjOf(name, {}, map$2(forbidden, function (f) {\n      return forbid(f.name(), 'Cannot configure ' + f.name() + ' for ' + name);\n    }).concat([customField('dump', identity$1)]));\n  };\n\n  var get$2 = function (data) {\n    return data.dump;\n  };\n\n  var augment = function (data, original) {\n    return __assign(__assign({}, derive$1(original)), data.dump);\n  };\n\n  var SketchBehaviours = {\n    field: field,\n    augment: augment,\n    get: get$2\n  };\n  var _placeholder = 'placeholder';\n  var adt$3 = Adt.generate([{\n    single: ['required', 'valueThunk']\n  }, {\n    multiple: ['required', 'valueThunks']\n  }]);\n\n  var isSubstituted = function (spec) {\n    return has$2(spec, 'uiType');\n  };\n\n  var subPlaceholder = function (owner, detail, compSpec, placeholders) {\n    if (owner.exists(function (o) {\n      return o !== compSpec.owner;\n    })) {\n      return adt$3.single(true, constant$1(compSpec));\n    }\n\n    return get$e(placeholders, compSpec.name).fold(function () {\n      throw new Error('Unknown placeholder component: ' + compSpec.name + '\\nKnown: [' + keys(placeholders) + ']\\nNamespace: ' + owner.getOr('none') + '\\nSpec: ' + JSON.stringify(compSpec, null, 2));\n    }, function (newSpec) {\n      return newSpec.replace();\n    });\n  };\n\n  var scan = function (owner, detail, compSpec, placeholders) {\n    if (isSubstituted(compSpec) && compSpec.uiType === _placeholder) {\n      return subPlaceholder(owner, detail, compSpec, placeholders);\n    } else {\n      return adt$3.single(false, constant$1(compSpec));\n    }\n  };\n\n  var substitute = function (owner, detail, compSpec, placeholders) {\n    var base = scan(owner, detail, compSpec, placeholders);\n    return base.fold(function (req, valueThunk) {\n      var value = isSubstituted(compSpec) ? valueThunk(detail, compSpec.config, compSpec.validated) : valueThunk(detail);\n      var childSpecs = get$e(value, 'components').getOr([]);\n      var substituted = bind$3(childSpecs, function (c) {\n        return substitute(owner, detail, c, placeholders);\n      });\n      return [__assign(__assign({}, value), {\n        components: substituted\n      })];\n    }, function (req, valuesThunk) {\n      if (isSubstituted(compSpec)) {\n        var values = valuesThunk(detail, compSpec.config, compSpec.validated);\n        var preprocessor = compSpec.validated.preprocess.getOr(identity$1);\n        return preprocessor(values);\n      } else {\n        return valuesThunk(detail);\n      }\n    });\n  };\n\n  var substituteAll = function (owner, detail, components, placeholders) {\n    return bind$3(components, function (c) {\n      return substitute(owner, detail, c, placeholders);\n    });\n  };\n\n  var oneReplace = function (label, replacements) {\n    var called = false;\n\n    var used = function () {\n      return called;\n    };\n\n    var replace = function () {\n      if (called) {\n        throw new Error('Trying to use the same placeholder more than once: ' + label);\n      }\n\n      called = true;\n      return replacements;\n    };\n\n    var required = function () {\n      return replacements.fold(function (req, _) {\n        return req;\n      }, function (req, _) {\n        return req;\n      });\n    };\n\n    return {\n      name: constant$1(label),\n      required: required,\n      used: used,\n      replace: replace\n    };\n  };\n\n  var substitutePlaces = function (owner, detail, components, placeholders) {\n    var ps = map$1(placeholders, function (ph, name) {\n      return oneReplace(name, ph);\n    });\n    var outcome = substituteAll(owner, detail, components, ps);\n    each(ps, function (p) {\n      if (p.used() === false && p.required()) {\n        throw new Error('Placeholder: ' + p.name() + ' was not found in components list\\nNamespace: ' + owner.getOr('none') + '\\nComponents: ' + JSON.stringify(detail.components, null, 2));\n      }\n    });\n    return outcome;\n  };\n\n  var single$2 = adt$3.single;\n  var multiple = adt$3.multiple;\n  var placeholder = constant$1(_placeholder);\n  var adt$2 = Adt.generate([{\n    required: ['data']\n  }, {\n    external: ['data']\n  }, {\n    optional: ['data']\n  }, {\n    group: ['data']\n  }]);\n  var fFactory = defaulted('factory', {\n    sketch: identity$1\n  });\n  var fSchema = defaulted('schema', []);\n  var fName = required$1('name');\n  var fPname = field$1('pname', 'pname', defaultedThunk(function (typeSpec) {\n    return '<alloy.' + generate$6(typeSpec.name) + '>';\n  }), anyValue());\n  var fGroupSchema = customField('schema', function () {\n    return [option('preprocess')];\n  });\n  var fDefaults = defaulted('defaults', constant$1({}));\n  var fOverrides = defaulted('overrides', constant$1({}));\n  var requiredSpec = objOf([fFactory, fSchema, fName, fPname, fDefaults, fOverrides]);\n  var externalSpec = objOf([fFactory, fSchema, fName, fDefaults, fOverrides]);\n  var optionalSpec = objOf([fFactory, fSchema, fName, fPname, fDefaults, fOverrides]);\n  var groupSpec = objOf([fFactory, fGroupSchema, fName, required$1('unit'), fPname, fDefaults, fOverrides]);\n\n  var asNamedPart = function (part) {\n    return part.fold(Optional.some, Optional.none, Optional.some, Optional.some);\n  };\n\n  var name$1 = function (part) {\n    var get = function (data) {\n      return data.name;\n    };\n\n    return part.fold(get, get, get, get);\n  };\n\n  var asCommon = function (part) {\n    return part.fold(identity$1, identity$1, identity$1, identity$1);\n  };\n\n  var convert = function (adtConstructor, partSchema) {\n    return function (spec) {\n      var data = asRawOrDie$1('Converting part type', partSchema, spec);\n      return adtConstructor(data);\n    };\n  };\n\n  var required = convert(adt$2.required, requiredSpec);\n  var external$1 = convert(adt$2.external, externalSpec);\n  var optional = convert(adt$2.optional, optionalSpec);\n  var group = convert(adt$2.group, groupSpec);\n  var original = constant$1('entirety');\n  var PartType = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    required: required,\n    external: external$1,\n    optional: optional,\n    group: group,\n    asNamedPart: asNamedPart,\n    name: name$1,\n    asCommon: asCommon,\n    original: original\n  });\n\n  var combine = function (detail, data, partSpec, partValidated) {\n    return deepMerge(data.defaults(detail, partSpec, partValidated), partSpec, {\n      uid: detail.partUids[data.name]\n    }, data.overrides(detail, partSpec, partValidated));\n  };\n\n  var subs = function (owner, detail, parts) {\n    var internals = {};\n    var externals = {};\n    each$1(parts, function (part) {\n      part.fold(function (data) {\n        internals[data.pname] = single$2(true, function (detail, partSpec, partValidated) {\n          return data.factory.sketch(combine(detail, data, partSpec, partValidated));\n        });\n      }, function (data) {\n        var partSpec = detail.parts[data.name];\n        externals[data.name] = constant$1(data.factory.sketch(combine(detail, data, partSpec[original()]), partSpec));\n      }, function (data) {\n        internals[data.pname] = single$2(false, function (detail, partSpec, partValidated) {\n          return data.factory.sketch(combine(detail, data, partSpec, partValidated));\n        });\n      }, function (data) {\n        internals[data.pname] = multiple(true, function (detail, _partSpec, _partValidated) {\n          var units = detail[data.name];\n          return map$2(units, function (u) {\n            return data.factory.sketch(deepMerge(data.defaults(detail, u, _partValidated), u, data.overrides(detail, u)));\n          });\n        });\n      });\n    });\n    return {\n      internals: constant$1(internals),\n      externals: constant$1(externals)\n    };\n  };\n\n  var generate$3 = function (owner, parts) {\n    var r = {};\n    each$1(parts, function (part) {\n      asNamedPart(part).each(function (np) {\n        var g = doGenerateOne(owner, np.pname);\n\n        r[np.name] = function (config) {\n          var validated = asRawOrDie$1('Part: ' + np.name + ' in ' + owner, objOf(np.schema), config);\n          return __assign(__assign({}, g), {\n            config: config,\n            validated: validated\n          });\n        };\n      });\n    });\n    return r;\n  };\n\n  var doGenerateOne = function (owner, pname) {\n    return {\n      uiType: placeholder(),\n      owner: owner,\n      name: pname\n    };\n  };\n\n  var generateOne$1 = function (owner, pname, config) {\n    return {\n      uiType: placeholder(),\n      owner: owner,\n      name: pname,\n      config: config,\n      validated: {}\n    };\n  };\n\n  var schemas = function (parts) {\n    return bind$3(parts, function (part) {\n      return part.fold(Optional.none, Optional.some, Optional.none, Optional.none).map(function (data) {\n        return requiredObjOf(data.name, data.schema.concat([snapshot(original())]));\n      }).toArray();\n    });\n  };\n\n  var names = function (parts) {\n    return map$2(parts, name$1);\n  };\n\n  var substitutes = function (owner, detail, parts) {\n    return subs(owner, detail, parts);\n  };\n\n  var components$1 = function (owner, detail, internals) {\n    return substitutePlaces(Optional.some(owner), detail, detail.components, internals);\n  };\n\n  var getPart = function (component, detail, partKey) {\n    var uid = detail.partUids[partKey];\n    return component.getSystem().getByUid(uid).toOptional();\n  };\n\n  var getPartOrDie = function (component, detail, partKey) {\n    return getPart(component, detail, partKey).getOrDie('Could not find part: ' + partKey);\n  };\n\n  var getParts = function (component, detail, partKeys) {\n    var r = {};\n    var uids = detail.partUids;\n    var system = component.getSystem();\n    each$1(partKeys, function (pk) {\n      r[pk] = constant$1(system.getByUid(uids[pk]));\n    });\n    return r;\n  };\n\n  var getAllParts = function (component, detail) {\n    var system = component.getSystem();\n    return map$1(detail.partUids, function (pUid, _k) {\n      return constant$1(system.getByUid(pUid));\n    });\n  };\n\n  var getAllPartNames = function (detail) {\n    return keys(detail.partUids);\n  };\n\n  var getPartsOrDie = function (component, detail, partKeys) {\n    var r = {};\n    var uids = detail.partUids;\n    var system = component.getSystem();\n    each$1(partKeys, function (pk) {\n      r[pk] = constant$1(system.getByUid(uids[pk]).getOrDie());\n    });\n    return r;\n  };\n\n  var defaultUids = function (baseUid, partTypes) {\n    var partNames = names(partTypes);\n    return wrapAll(map$2(partNames, function (pn) {\n      return {\n        key: pn,\n        value: baseUid + '-' + pn\n      };\n    }));\n  };\n\n  var defaultUidsSchema = function (partTypes) {\n    return field$1('partUids', 'partUids', mergeWithThunk(function (spec) {\n      return defaultUids(spec.uid, partTypes);\n    }), anyValue());\n  };\n\n  var AlloyParts = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    generate: generate$3,\n    generateOne: generateOne$1,\n    schemas: schemas,\n    names: names,\n    substitutes: substitutes,\n    components: components$1,\n    defaultUids: defaultUids,\n    defaultUidsSchema: defaultUidsSchema,\n    getAllParts: getAllParts,\n    getAllPartNames: getAllPartNames,\n    getPart: getPart,\n    getPartOrDie: getPartOrDie,\n    getParts: getParts,\n    getPartsOrDie: getPartsOrDie\n  });\n\n  var base = function (partSchemas, partUidsSchemas) {\n    var ps = partSchemas.length > 0 ? [requiredObjOf('parts', partSchemas)] : [];\n    return ps.concat([required$1('uid'), defaulted('dom', {}), defaulted('components', []), snapshot('originalSpec'), defaulted('debug.sketcher', {})]).concat(partUidsSchemas);\n  };\n\n  var asRawOrDie = function (label, schema, spec, partSchemas, partUidsSchemas) {\n    var baseS = base(partSchemas, partUidsSchemas);\n    return asRawOrDie$1(label + ' [SpecSchema]', objOfOnly(baseS.concat(schema)), spec);\n  };\n\n  var single$1 = function (owner, schema, factory, spec) {\n    var specWithUid = supplyUid(spec);\n    var detail = asRawOrDie(owner, schema, specWithUid, [], []);\n    return factory(detail, specWithUid);\n  };\n\n  var composite$1 = function (owner, schema, partTypes, factory, spec) {\n    var specWithUid = supplyUid(spec);\n    var partSchemas = schemas(partTypes);\n    var partUidsSchema = defaultUidsSchema(partTypes);\n    var detail = asRawOrDie(owner, schema, specWithUid, partSchemas, [partUidsSchema]);\n    var subs = substitutes(owner, detail, partTypes);\n    var components = components$1(owner, detail, subs.internals());\n    return factory(detail, components, specWithUid, subs.externals());\n  };\n\n  var hasUid = function (spec) {\n    return has$2(spec, 'uid');\n  };\n\n  var supplyUid = function (spec) {\n    return hasUid(spec) ? spec : __assign(__assign({}, spec), {\n      uid: generate$5('uid')\n    });\n  };\n\n  var isSketchSpec = function (spec) {\n    return spec.uid !== undefined;\n  };\n\n  var singleSchema = objOfOnly([required$1('name'), required$1('factory'), required$1('configFields'), defaulted('apis', {}), defaulted('extraApis', {})]);\n  var compositeSchema = objOfOnly([required$1('name'), required$1('factory'), required$1('configFields'), required$1('partFields'), defaulted('apis', {}), defaulted('extraApis', {})]);\n\n  var single = function (rawConfig) {\n    var config = asRawOrDie$1('Sketcher for ' + rawConfig.name, singleSchema, rawConfig);\n\n    var sketch = function (spec) {\n      return single$1(config.name, config.configFields, config.factory, spec);\n    };\n\n    var apis = map$1(config.apis, makeApi);\n    var extraApis = map$1(config.extraApis, function (f, k) {\n      return markAsExtraApi(f, k);\n    });\n    return __assign(__assign({\n      name: config.name,\n      configFields: config.configFields,\n      sketch: sketch\n    }, apis), extraApis);\n  };\n\n  var composite = function (rawConfig) {\n    var config = asRawOrDie$1('Sketcher for ' + rawConfig.name, compositeSchema, rawConfig);\n\n    var sketch = function (spec) {\n      return composite$1(config.name, config.configFields, config.partFields, config.factory, spec);\n    };\n\n    var parts = generate$3(config.name, config.partFields);\n    var apis = map$1(config.apis, makeApi);\n    var extraApis = map$1(config.extraApis, function (f, k) {\n      return markAsExtraApi(f, k);\n    });\n    return __assign(__assign({\n      name: config.name,\n      partFields: config.partFields,\n      configFields: config.configFields,\n      sketch: sketch,\n      parts: parts\n    }, apis), extraApis);\n  };\n\n  var inside = function (target) {\n    return name$2(target) === 'input' && get$d(target, 'type') !== 'radio' || name$2(target) === 'textarea';\n  };\n\n  var getCurrent = function (component, composeConfig, _composeState) {\n    return composeConfig.find(component);\n  };\n\n  var ComposeApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getCurrent: getCurrent\n  });\n  var ComposeSchema = [required$1('find')];\n  var Composing = create$7({\n    fields: ComposeSchema,\n    name: 'composing',\n    apis: ComposeApis\n  });\n  var nativeDisabled = ['input', 'button', 'textarea', 'select'];\n\n  var onLoad$1 = function (component, disableConfig, disableState) {\n    var f = disableConfig.disabled() ? disable$1 : enable$1;\n    f(component, disableConfig);\n  };\n\n  var hasNative = function (component, config) {\n    return config.useNative === true && contains$2(nativeDisabled, name$2(component.element));\n  };\n\n  var nativeIsDisabled = function (component) {\n    return has$1(component.element, 'disabled');\n  };\n\n  var nativeDisable = function (component) {\n    set$8(component.element, 'disabled', 'disabled');\n  };\n\n  var nativeEnable = function (component) {\n    remove$7(component.element, 'disabled');\n  };\n\n  var ariaIsDisabled = function (component) {\n    return get$d(component.element, 'aria-disabled') === 'true';\n  };\n\n  var ariaDisable = function (component) {\n    set$8(component.element, 'aria-disabled', 'true');\n  };\n\n  var ariaEnable = function (component) {\n    set$8(component.element, 'aria-disabled', 'false');\n  };\n\n  var disable$1 = function (component, disableConfig, _disableState) {\n    disableConfig.disableClass.each(function (disableClass) {\n      add$2(component.element, disableClass);\n    });\n    var f = hasNative(component, disableConfig) ? nativeDisable : ariaDisable;\n    f(component);\n    disableConfig.onDisabled(component);\n  };\n\n  var enable$1 = function (component, disableConfig, _disableState) {\n    disableConfig.disableClass.each(function (disableClass) {\n      remove$2(component.element, disableClass);\n    });\n    var f = hasNative(component, disableConfig) ? nativeEnable : ariaEnable;\n    f(component);\n    disableConfig.onEnabled(component);\n  };\n\n  var isDisabled = function (component, disableConfig) {\n    return hasNative(component, disableConfig) ? nativeIsDisabled(component) : ariaIsDisabled(component);\n  };\n\n  var set$3 = function (component, disableConfig, disableState, disabled) {\n    var f = disabled ? disable$1 : enable$1;\n    f(component, disableConfig);\n  };\n\n  var DisableApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    enable: enable$1,\n    disable: disable$1,\n    isDisabled: isDisabled,\n    onLoad: onLoad$1,\n    set: set$3\n  });\n\n  var exhibit$5 = function (base, disableConfig) {\n    return nu$7({\n      classes: disableConfig.disabled() ? disableConfig.disableClass.toArray() : []\n    });\n  };\n\n  var events$e = function (disableConfig, disableState) {\n    return derive$2([abort(execute$5(), function (component, _simulatedEvent) {\n      return isDisabled(component, disableConfig);\n    }), loadEvent(disableConfig, disableState, onLoad$1)]);\n  };\n\n  var ActiveDisable = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$5,\n    events: events$e\n  });\n  var DisableSchema = [defaultedFunction('disabled', never), defaulted('useNative', true), option('disableClass'), onHandler('onDisabled'), onHandler('onEnabled')];\n  var Disabling = create$7({\n    fields: DisableSchema,\n    name: 'disabling',\n    active: ActiveDisable,\n    apis: DisableApis\n  });\n\n  var dehighlightAllExcept = function (component, hConfig, hState, skip) {\n    var highlighted = descendants(component.element, '.' + hConfig.highlightClass);\n    each$1(highlighted, function (h) {\n      if (!exists(skip, function (skipComp) {\n        return skipComp.element === h;\n      })) {\n        remove$2(h, hConfig.highlightClass);\n        component.getSystem().getByDom(h).each(function (target) {\n          hConfig.onDehighlight(component, target);\n          emit(target, dehighlight$1());\n        });\n      }\n    });\n  };\n\n  var dehighlightAll = function (component, hConfig, hState) {\n    return dehighlightAllExcept(component, hConfig, hState, []);\n  };\n\n  var dehighlight = function (component, hConfig, hState, target) {\n    if (isHighlighted(component, hConfig, hState, target)) {\n      remove$2(target.element, hConfig.highlightClass);\n      hConfig.onDehighlight(component, target);\n      emit(target, dehighlight$1());\n    }\n  };\n\n  var highlight = function (component, hConfig, hState, target) {\n    dehighlightAllExcept(component, hConfig, hState, [target]);\n\n    if (!isHighlighted(component, hConfig, hState, target)) {\n      add$2(target.element, hConfig.highlightClass);\n      hConfig.onHighlight(component, target);\n      emit(target, highlight$1());\n    }\n  };\n\n  var highlightFirst = function (component, hConfig, hState) {\n    getFirst(component, hConfig).each(function (firstComp) {\n      highlight(component, hConfig, hState, firstComp);\n    });\n  };\n\n  var highlightLast = function (component, hConfig, hState) {\n    getLast(component, hConfig).each(function (lastComp) {\n      highlight(component, hConfig, hState, lastComp);\n    });\n  };\n\n  var highlightAt = function (component, hConfig, hState, index) {\n    getByIndex(component, hConfig, hState, index).fold(function (err) {\n      throw err;\n    }, function (firstComp) {\n      highlight(component, hConfig, hState, firstComp);\n    });\n  };\n\n  var highlightBy = function (component, hConfig, hState, predicate) {\n    var candidates = getCandidates(component, hConfig);\n    var targetComp = find$5(candidates, predicate);\n    targetComp.each(function (c) {\n      highlight(component, hConfig, hState, c);\n    });\n  };\n\n  var isHighlighted = function (component, hConfig, hState, queryTarget) {\n    return has(queryTarget.element, hConfig.highlightClass);\n  };\n\n  var getHighlighted = function (component, hConfig, _hState) {\n    return descendant(component.element, '.' + hConfig.highlightClass).bind(function (e) {\n      return component.getSystem().getByDom(e).toOptional();\n    });\n  };\n\n  var getByIndex = function (component, hConfig, hState, index) {\n    var items = descendants(component.element, '.' + hConfig.itemClass);\n    return Optional.from(items[index]).fold(function () {\n      return Result.error(new Error('No element found with index ' + index));\n    }, component.getSystem().getByDom);\n  };\n\n  var getFirst = function (component, hConfig, _hState) {\n    return descendant(component.element, '.' + hConfig.itemClass).bind(function (e) {\n      return component.getSystem().getByDom(e).toOptional();\n    });\n  };\n\n  var getLast = function (component, hConfig, _hState) {\n    var items = descendants(component.element, '.' + hConfig.itemClass);\n    var last = items.length > 0 ? Optional.some(items[items.length - 1]) : Optional.none();\n    return last.bind(function (c) {\n      return component.getSystem().getByDom(c).toOptional();\n    });\n  };\n\n  var getDelta$2 = function (component, hConfig, hState, delta) {\n    var items = descendants(component.element, '.' + hConfig.itemClass);\n    var current = findIndex$1(items, function (item) {\n      return has(item, hConfig.highlightClass);\n    });\n    return current.bind(function (selected) {\n      var dest = cycleBy(selected, delta, 0, items.length - 1);\n      return component.getSystem().getByDom(items[dest]).toOptional();\n    });\n  };\n\n  var getPrevious = function (component, hConfig, hState) {\n    return getDelta$2(component, hConfig, hState, -1);\n  };\n\n  var getNext = function (component, hConfig, hState) {\n    return getDelta$2(component, hConfig, hState, +1);\n  };\n\n  var getCandidates = function (component, hConfig, _hState) {\n    var items = descendants(component.element, '.' + hConfig.itemClass);\n    return cat(map$2(items, function (i) {\n      return component.getSystem().getByDom(i).toOptional();\n    }));\n  };\n\n  var HighlightApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    dehighlightAll: dehighlightAll,\n    dehighlight: dehighlight,\n    highlight: highlight,\n    highlightFirst: highlightFirst,\n    highlightLast: highlightLast,\n    highlightAt: highlightAt,\n    highlightBy: highlightBy,\n    isHighlighted: isHighlighted,\n    getHighlighted: getHighlighted,\n    getFirst: getFirst,\n    getLast: getLast,\n    getPrevious: getPrevious,\n    getNext: getNext,\n    getCandidates: getCandidates\n  });\n  var HighlightSchema = [required$1('highlightClass'), required$1('itemClass'), onHandler('onHighlight'), onHandler('onDehighlight')];\n  var Highlighting = create$7({\n    fields: HighlightSchema,\n    name: 'highlighting',\n    apis: HighlightApis\n  });\n  var BACKSPACE = [8];\n  var TAB = [9];\n  var ENTER = [13];\n  var ESCAPE = [27];\n  var SPACE = [32];\n  var LEFT = [37];\n  var UP = [38];\n  var RIGHT = [39];\n  var DOWN = [40];\n\n  var cyclePrev = function (values, index, predicate) {\n    var before = reverse(values.slice(0, index));\n    var after = reverse(values.slice(index + 1));\n    return find$5(before.concat(after), predicate);\n  };\n\n  var tryPrev = function (values, index, predicate) {\n    var before = reverse(values.slice(0, index));\n    return find$5(before, predicate);\n  };\n\n  var cycleNext = function (values, index, predicate) {\n    var before = values.slice(0, index);\n    var after = values.slice(index + 1);\n    return find$5(after.concat(before), predicate);\n  };\n\n  var tryNext = function (values, index, predicate) {\n    var after = values.slice(index + 1);\n    return find$5(after, predicate);\n  };\n\n  var inSet = function (keys) {\n    return function (event) {\n      var raw = event.raw;\n      return contains$2(keys, raw.which);\n    };\n  };\n\n  var and = function (preds) {\n    return function (event) {\n      return forall(preds, function (pred) {\n        return pred(event);\n      });\n    };\n  };\n\n  var isShift = function (event) {\n    var raw = event.raw;\n    return raw.shiftKey === true;\n  };\n\n  var isControl = function (event) {\n    var raw = event.raw;\n    return raw.ctrlKey === true;\n  };\n\n  var isNotShift = not(isShift);\n\n  var rule = function (matches, action) {\n    return {\n      matches: matches,\n      classification: action\n    };\n  };\n\n  var choose = function (transitions, event) {\n    var transition = find$5(transitions, function (t) {\n      return t.matches(event);\n    });\n    return transition.map(function (t) {\n      return t.classification;\n    });\n  };\n\n  var reportFocusShifting = function (component, prevFocus, newFocus) {\n    var noChange = prevFocus.exists(function (p) {\n      return newFocus.exists(function (n) {\n        return eq(n, p);\n      });\n    });\n\n    if (!noChange) {\n      emitWith(component, focusShifted(), {\n        prevFocus: prevFocus,\n        newFocus: newFocus\n      });\n    }\n  };\n\n  var dom$2 = function () {\n    var get = function (component) {\n      return search(component.element);\n    };\n\n    var set = function (component, focusee) {\n      var prevFocus = get(component);\n      component.getSystem().triggerFocus(focusee, component.element);\n      var newFocus = get(component);\n      reportFocusShifting(component, prevFocus, newFocus);\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var highlights = function () {\n    var get = function (component) {\n      return Highlighting.getHighlighted(component).map(function (item) {\n        return item.element;\n      });\n    };\n\n    var set = function (component, element) {\n      var prevFocus = get(component);\n      component.getSystem().getByDom(element).fold(noop, function (item) {\n        Highlighting.highlight(component, item);\n      });\n      var newFocus = get(component);\n      reportFocusShifting(component, prevFocus, newFocus);\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var FocusInsideModes;\n\n  (function (FocusInsideModes) {\n    FocusInsideModes['OnFocusMode'] = 'onFocus';\n    FocusInsideModes['OnEnterOrSpaceMode'] = 'onEnterOrSpace';\n    FocusInsideModes['OnApiMode'] = 'onApi';\n  })(FocusInsideModes || (FocusInsideModes = {}));\n\n  var typical = function (infoSchema, stateInit, getKeydownRules, getKeyupRules, optFocusIn) {\n    var schema = function () {\n      return infoSchema.concat([defaulted('focusManager', dom$2()), defaultedOf('focusInside', 'onFocus', valueOf(function (val) {\n        return contains$2(['onFocus', 'onEnterOrSpace', 'onApi'], val) ? Result.value(val) : Result.error('Invalid value for focusInside');\n      })), output$1('handler', me), output$1('state', stateInit), output$1('sendFocusIn', optFocusIn)]);\n    };\n\n    var processKey = function (component, simulatedEvent, getRules, keyingConfig, keyingState) {\n      var rules = getRules(component, simulatedEvent, keyingConfig, keyingState);\n      return choose(rules, simulatedEvent.event).bind(function (rule) {\n        return rule(component, simulatedEvent, keyingConfig, keyingState);\n      });\n    };\n\n    var toEvents = function (keyingConfig, keyingState) {\n      var onFocusHandler = keyingConfig.focusInside !== FocusInsideModes.OnFocusMode ? Optional.none() : optFocusIn(keyingConfig).map(function (focusIn) {\n        return run$1(focus$4(), function (component, simulatedEvent) {\n          focusIn(component, keyingConfig, keyingState);\n          simulatedEvent.stop();\n        });\n      });\n\n      var tryGoInsideComponent = function (component, simulatedEvent) {\n        var isEnterOrSpace = inSet(SPACE.concat(ENTER))(simulatedEvent.event);\n\n        if (keyingConfig.focusInside === FocusInsideModes.OnEnterOrSpaceMode && isEnterOrSpace && isSource(component, simulatedEvent)) {\n          optFocusIn(keyingConfig).each(function (focusIn) {\n            focusIn(component, keyingConfig, keyingState);\n            simulatedEvent.stop();\n          });\n        }\n      };\n\n      var keyboardEvents = [run$1(keydown(), function (component, simulatedEvent) {\n        processKey(component, simulatedEvent, getKeydownRules, keyingConfig, keyingState).fold(function () {\n          tryGoInsideComponent(component, simulatedEvent);\n        }, function (_) {\n          simulatedEvent.stop();\n        });\n      }), run$1(keyup(), function (component, simulatedEvent) {\n        processKey(component, simulatedEvent, getKeyupRules, keyingConfig, keyingState).each(function (_) {\n          simulatedEvent.stop();\n        });\n      })];\n      return derive$2(onFocusHandler.toArray().concat(keyboardEvents));\n    };\n\n    var me = {\n      schema: schema,\n      processKey: processKey,\n      toEvents: toEvents\n    };\n    return me;\n  };\n\n  var create$5 = function (cyclicField) {\n    var schema = [option('onEscape'), option('onEnter'), defaulted('selector', '[data-alloy-tabstop=\"true\"]:not(:disabled)'), defaulted('firstTabstop', 0), defaulted('useTabstopAt', always), option('visibilitySelector')].concat([cyclicField]);\n\n    var isVisible = function (tabbingConfig, element) {\n      var target = tabbingConfig.visibilitySelector.bind(function (sel) {\n        return closest$1(element, sel);\n      }).getOr(element);\n      return get$b(target) > 0;\n    };\n\n    var findInitial = function (component, tabbingConfig) {\n      var tabstops = descendants(component.element, tabbingConfig.selector);\n      var visibles = filter$2(tabstops, function (elem) {\n        return isVisible(tabbingConfig, elem);\n      });\n      return Optional.from(visibles[tabbingConfig.firstTabstop]);\n    };\n\n    var findCurrent = function (component, tabbingConfig) {\n      return tabbingConfig.focusManager.get(component).bind(function (elem) {\n        return closest$1(elem, tabbingConfig.selector);\n      });\n    };\n\n    var isTabstop = function (tabbingConfig, element) {\n      return isVisible(tabbingConfig, element) && tabbingConfig.useTabstopAt(element);\n    };\n\n    var focusIn = function (component, tabbingConfig, _tabbingState) {\n      findInitial(component, tabbingConfig).each(function (target) {\n        tabbingConfig.focusManager.set(component, target);\n      });\n    };\n\n    var goFromTabstop = function (component, tabstops, stopIndex, tabbingConfig, cycle) {\n      return cycle(tabstops, stopIndex, function (elem) {\n        return isTabstop(tabbingConfig, elem);\n      }).fold(function () {\n        return tabbingConfig.cyclic ? Optional.some(true) : Optional.none();\n      }, function (target) {\n        tabbingConfig.focusManager.set(component, target);\n        return Optional.some(true);\n      });\n    };\n\n    var go = function (component, _simulatedEvent, tabbingConfig, cycle) {\n      var tabstops = descendants(component.element, tabbingConfig.selector);\n      return findCurrent(component, tabbingConfig).bind(function (tabstop) {\n        var optStopIndex = findIndex$1(tabstops, curry(eq, tabstop));\n        return optStopIndex.bind(function (stopIndex) {\n          return goFromTabstop(component, tabstops, stopIndex, tabbingConfig, cycle);\n        });\n      });\n    };\n\n    var goBackwards = function (component, simulatedEvent, tabbingConfig) {\n      var navigate = tabbingConfig.cyclic ? cyclePrev : tryPrev;\n      return go(component, simulatedEvent, tabbingConfig, navigate);\n    };\n\n    var goForwards = function (component, simulatedEvent, tabbingConfig) {\n      var navigate = tabbingConfig.cyclic ? cycleNext : tryNext;\n      return go(component, simulatedEvent, tabbingConfig, navigate);\n    };\n\n    var execute = function (component, simulatedEvent, tabbingConfig) {\n      return tabbingConfig.onEnter.bind(function (f) {\n        return f(component, simulatedEvent);\n      });\n    };\n\n    var exit = function (component, simulatedEvent, tabbingConfig) {\n      return tabbingConfig.onEscape.bind(function (f) {\n        return f(component, simulatedEvent);\n      });\n    };\n\n    var getKeydownRules = constant$1([rule(and([isShift, inSet(TAB)]), goBackwards), rule(inSet(TAB), goForwards), rule(inSet(ESCAPE), exit), rule(and([isNotShift, inSet(ENTER)]), execute)]);\n    var getKeyupRules = constant$1([]);\n    return typical(schema, NoState.init, getKeydownRules, getKeyupRules, function () {\n      return Optional.some(focusIn);\n    });\n  };\n\n  var AcyclicType = create$5(customField('cyclic', never));\n  var CyclicType = create$5(customField('cyclic', always));\n\n  var doDefaultExecute = function (component, _simulatedEvent, focused) {\n    dispatch(component, focused, execute$5());\n    return Optional.some(true);\n  };\n\n  var defaultExecute = function (component, simulatedEvent, focused) {\n    var isComplex = inside(focused) && inSet(SPACE)(simulatedEvent.event);\n    return isComplex ? Optional.none() : doDefaultExecute(component, simulatedEvent, focused);\n  };\n\n  var stopEventForFirefox = function (_component, _simulatedEvent) {\n    return Optional.some(true);\n  };\n\n  var schema$v = [defaulted('execute', defaultExecute), defaulted('useSpace', false), defaulted('useEnter', true), defaulted('useControlEnter', false), defaulted('useDown', false)];\n\n  var execute$4 = function (component, simulatedEvent, executeConfig) {\n    return executeConfig.execute(component, simulatedEvent, component.element);\n  };\n\n  var getKeydownRules$5 = function (component, _simulatedEvent, executeConfig, _executeState) {\n    var spaceExec = executeConfig.useSpace && !inside(component.element) ? SPACE : [];\n    var enterExec = executeConfig.useEnter ? ENTER : [];\n    var downExec = executeConfig.useDown ? DOWN : [];\n    var execKeys = spaceExec.concat(enterExec).concat(downExec);\n    return [rule(inSet(execKeys), execute$4)].concat(executeConfig.useControlEnter ? [rule(and([isControl, inSet(ENTER)]), execute$4)] : []);\n  };\n\n  var getKeyupRules$5 = function (component, _simulatedEvent, executeConfig, _executeState) {\n    return executeConfig.useSpace && !inside(component.element) ? [rule(inSet(SPACE), stopEventForFirefox)] : [];\n  };\n\n  var ExecutionType = typical(schema$v, NoState.init, getKeydownRules$5, getKeyupRules$5, function () {\n    return Optional.none();\n  });\n\n  var flatgrid$1 = function () {\n    var dimensions = value$1();\n\n    var setGridSize = function (numRows, numColumns) {\n      dimensions.set({\n        numRows: numRows,\n        numColumns: numColumns\n      });\n    };\n\n    var getNumRows = function () {\n      return dimensions.get().map(function (d) {\n        return d.numRows;\n      });\n    };\n\n    var getNumColumns = function () {\n      return dimensions.get().map(function (d) {\n        return d.numColumns;\n      });\n    };\n\n    return nu$8({\n      readState: function () {\n        return dimensions.get().map(function (d) {\n          return {\n            numRows: String(d.numRows),\n            numColumns: String(d.numColumns)\n          };\n        }).getOr({\n          numRows: '?',\n          numColumns: '?'\n        });\n      },\n      setGridSize: setGridSize,\n      getNumRows: getNumRows,\n      getNumColumns: getNumColumns\n    });\n  };\n\n  var init$d = function (spec) {\n    return spec.state(spec);\n  };\n\n  var KeyingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    flatgrid: flatgrid$1,\n    init: init$d\n  });\n\n  var useH = function (movement) {\n    return function (component, simulatedEvent, config, state) {\n      var move = movement(component.element);\n      return use(move, component, simulatedEvent, config, state);\n    };\n  };\n\n  var west$1 = function (moveLeft, moveRight) {\n    var movement = onDirection(moveLeft, moveRight);\n    return useH(movement);\n  };\n\n  var east$1 = function (moveLeft, moveRight) {\n    var movement = onDirection(moveRight, moveLeft);\n    return useH(movement);\n  };\n\n  var useV = function (move) {\n    return function (component, simulatedEvent, config, state) {\n      return use(move, component, simulatedEvent, config, state);\n    };\n  };\n\n  var use = function (move, component, simulatedEvent, config, state) {\n    var outcome = config.focusManager.get(component).bind(function (focused) {\n      return move(component.element, focused, config, state);\n    });\n    return outcome.map(function (newFocus) {\n      config.focusManager.set(component, newFocus);\n      return true;\n    });\n  };\n\n  var north$1 = useV;\n  var south$1 = useV;\n  var move$1 = useV;\n\n  var isHidden$1 = function (dom) {\n    return dom.offsetWidth <= 0 && dom.offsetHeight <= 0;\n  };\n\n  var isVisible = function (element) {\n    return !isHidden$1(element.dom);\n  };\n\n  var locate = function (candidates, predicate) {\n    return findIndex$1(candidates, predicate).map(function (index) {\n      return {\n        index: index,\n        candidates: candidates\n      };\n    });\n  };\n\n  var locateVisible = function (container, current, selector) {\n    var predicate = function (x) {\n      return eq(x, current);\n    };\n\n    var candidates = descendants(container, selector);\n    var visible = filter$2(candidates, isVisible);\n    return locate(visible, predicate);\n  };\n\n  var findIndex = function (elements, target) {\n    return findIndex$1(elements, function (elem) {\n      return eq(target, elem);\n    });\n  };\n\n  var withGrid = function (values, index, numCols, f) {\n    var oldRow = Math.floor(index / numCols);\n    var oldColumn = index % numCols;\n    return f(oldRow, oldColumn).bind(function (address) {\n      var newIndex = address.row * numCols + address.column;\n      return newIndex >= 0 && newIndex < values.length ? Optional.some(values[newIndex]) : Optional.none();\n    });\n  };\n\n  var cycleHorizontal$1 = function (values, index, numRows, numCols, delta) {\n    return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n      var onLastRow = oldRow === numRows - 1;\n      var colsInRow = onLastRow ? values.length - oldRow * numCols : numCols;\n      var newColumn = cycleBy(oldColumn, delta, 0, colsInRow - 1);\n      return Optional.some({\n        row: oldRow,\n        column: newColumn\n      });\n    });\n  };\n\n  var cycleVertical$1 = function (values, index, numRows, numCols, delta) {\n    return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n      var newRow = cycleBy(oldRow, delta, 0, numRows - 1);\n      var onLastRow = newRow === numRows - 1;\n      var colsInRow = onLastRow ? values.length - newRow * numCols : numCols;\n      var newCol = clamp$1(oldColumn, 0, colsInRow - 1);\n      return Optional.some({\n        row: newRow,\n        column: newCol\n      });\n    });\n  };\n\n  var cycleRight$1 = function (values, index, numRows, numCols) {\n    return cycleHorizontal$1(values, index, numRows, numCols, +1);\n  };\n\n  var cycleLeft$1 = function (values, index, numRows, numCols) {\n    return cycleHorizontal$1(values, index, numRows, numCols, -1);\n  };\n\n  var cycleUp$1 = function (values, index, numRows, numCols) {\n    return cycleVertical$1(values, index, numRows, numCols, -1);\n  };\n\n  var cycleDown$1 = function (values, index, numRows, numCols) {\n    return cycleVertical$1(values, index, numRows, numCols, +1);\n  };\n\n  var schema$u = [required$1('selector'), defaulted('execute', defaultExecute), onKeyboardHandler('onEscape'), defaulted('captureTab', false), initSize()];\n\n  var focusIn$3 = function (component, gridConfig, _gridState) {\n    descendant(component.element, gridConfig.selector).each(function (first) {\n      gridConfig.focusManager.set(component, first);\n    });\n  };\n\n  var findCurrent$1 = function (component, gridConfig) {\n    return gridConfig.focusManager.get(component).bind(function (elem) {\n      return closest$1(elem, gridConfig.selector);\n    });\n  };\n\n  var execute$3 = function (component, simulatedEvent, gridConfig, _gridState) {\n    return findCurrent$1(component, gridConfig).bind(function (focused) {\n      return gridConfig.execute(component, simulatedEvent, focused);\n    });\n  };\n\n  var doMove$2 = function (cycle) {\n    return function (element, focused, gridConfig, gridState) {\n      return locateVisible(element, focused, gridConfig.selector).bind(function (identified) {\n        return cycle(identified.candidates, identified.index, gridState.getNumRows().getOr(gridConfig.initSize.numRows), gridState.getNumColumns().getOr(gridConfig.initSize.numColumns));\n      });\n    };\n  };\n\n  var handleTab = function (_component, _simulatedEvent, gridConfig) {\n    return gridConfig.captureTab ? Optional.some(true) : Optional.none();\n  };\n\n  var doEscape$1 = function (component, simulatedEvent, gridConfig) {\n    return gridConfig.onEscape(component, simulatedEvent);\n  };\n\n  var moveLeft$3 = doMove$2(cycleLeft$1);\n  var moveRight$3 = doMove$2(cycleRight$1);\n  var moveNorth$1 = doMove$2(cycleUp$1);\n  var moveSouth$1 = doMove$2(cycleDown$1);\n  var getKeydownRules$4 = constant$1([rule(inSet(LEFT), west$1(moveLeft$3, moveRight$3)), rule(inSet(RIGHT), east$1(moveLeft$3, moveRight$3)), rule(inSet(UP), north$1(moveNorth$1)), rule(inSet(DOWN), south$1(moveSouth$1)), rule(and([isShift, inSet(TAB)]), handleTab), rule(and([isNotShift, inSet(TAB)]), handleTab), rule(inSet(ESCAPE), doEscape$1), rule(inSet(SPACE.concat(ENTER)), execute$3)]);\n  var getKeyupRules$4 = constant$1([rule(inSet(SPACE), stopEventForFirefox)]);\n  var FlatgridType = typical(schema$u, flatgrid$1, getKeydownRules$4, getKeyupRules$4, function () {\n    return Optional.some(focusIn$3);\n  });\n\n  var horizontal = function (container, selector, current, delta) {\n    var isDisabledButton = function (candidate) {\n      return name$2(candidate) === 'button' && get$d(candidate, 'disabled') === 'disabled';\n    };\n\n    var tryCycle = function (initial, index, candidates) {\n      var newIndex = cycleBy(index, delta, 0, candidates.length - 1);\n\n      if (newIndex === initial) {\n        return Optional.none();\n      } else {\n        return isDisabledButton(candidates[newIndex]) ? tryCycle(initial, newIndex, candidates) : Optional.from(candidates[newIndex]);\n      }\n    };\n\n    return locateVisible(container, current, selector).bind(function (identified) {\n      var index = identified.index;\n      var candidates = identified.candidates;\n      return tryCycle(index, index, candidates);\n    });\n  };\n\n  var schema$t = [required$1('selector'), defaulted('getInitial', Optional.none), defaulted('execute', defaultExecute), onKeyboardHandler('onEscape'), defaulted('executeOnMove', false), defaulted('allowVertical', true)];\n\n  var findCurrent = function (component, flowConfig) {\n    return flowConfig.focusManager.get(component).bind(function (elem) {\n      return closest$1(elem, flowConfig.selector);\n    });\n  };\n\n  var execute$2 = function (component, simulatedEvent, flowConfig) {\n    return findCurrent(component, flowConfig).bind(function (focused) {\n      return flowConfig.execute(component, simulatedEvent, focused);\n    });\n  };\n\n  var focusIn$2 = function (component, flowConfig, _state) {\n    flowConfig.getInitial(component).orThunk(function () {\n      return descendant(component.element, flowConfig.selector);\n    }).each(function (first) {\n      flowConfig.focusManager.set(component, first);\n    });\n  };\n\n  var moveLeft$2 = function (element, focused, info) {\n    return horizontal(element, info.selector, focused, -1);\n  };\n\n  var moveRight$2 = function (element, focused, info) {\n    return horizontal(element, info.selector, focused, +1);\n  };\n\n  var doMove$1 = function (movement) {\n    return function (component, simulatedEvent, flowConfig, flowState) {\n      return movement(component, simulatedEvent, flowConfig, flowState).bind(function () {\n        return flowConfig.executeOnMove ? execute$2(component, simulatedEvent, flowConfig) : Optional.some(true);\n      });\n    };\n  };\n\n  var doEscape = function (component, simulatedEvent, flowConfig) {\n    return flowConfig.onEscape(component, simulatedEvent);\n  };\n\n  var getKeydownRules$3 = function (_component, _se, flowConfig, _flowState) {\n    var westMovers = LEFT.concat(flowConfig.allowVertical ? UP : []);\n    var eastMovers = RIGHT.concat(flowConfig.allowVertical ? DOWN : []);\n    return [rule(inSet(westMovers), doMove$1(west$1(moveLeft$2, moveRight$2))), rule(inSet(eastMovers), doMove$1(east$1(moveLeft$2, moveRight$2))), rule(inSet(ENTER), execute$2), rule(inSet(SPACE), execute$2), rule(inSet(ESCAPE), doEscape)];\n  };\n\n  var getKeyupRules$3 = constant$1([rule(inSet(SPACE), stopEventForFirefox)]);\n  var FlowType = typical(schema$t, NoState.init, getKeydownRules$3, getKeyupRules$3, function () {\n    return Optional.some(focusIn$2);\n  });\n\n  var toCell = function (matrix, rowIndex, columnIndex) {\n    return Optional.from(matrix[rowIndex]).bind(function (row) {\n      return Optional.from(row[columnIndex]).map(function (cell) {\n        return {\n          rowIndex: rowIndex,\n          columnIndex: columnIndex,\n          cell: cell\n        };\n      });\n    });\n  };\n\n  var cycleHorizontal = function (matrix, rowIndex, startCol, deltaCol) {\n    var row = matrix[rowIndex];\n    var colsInRow = row.length;\n    var newColIndex = cycleBy(startCol, deltaCol, 0, colsInRow - 1);\n    return toCell(matrix, rowIndex, newColIndex);\n  };\n\n  var cycleVertical = function (matrix, colIndex, startRow, deltaRow) {\n    var nextRowIndex = cycleBy(startRow, deltaRow, 0, matrix.length - 1);\n    var colsInNextRow = matrix[nextRowIndex].length;\n    var nextColIndex = clamp$1(colIndex, 0, colsInNextRow - 1);\n    return toCell(matrix, nextRowIndex, nextColIndex);\n  };\n\n  var moveHorizontal = function (matrix, rowIndex, startCol, deltaCol) {\n    var row = matrix[rowIndex];\n    var colsInRow = row.length;\n    var newColIndex = clamp$1(startCol + deltaCol, 0, colsInRow - 1);\n    return toCell(matrix, rowIndex, newColIndex);\n  };\n\n  var moveVertical = function (matrix, colIndex, startRow, deltaRow) {\n    var nextRowIndex = clamp$1(startRow + deltaRow, 0, matrix.length - 1);\n    var colsInNextRow = matrix[nextRowIndex].length;\n    var nextColIndex = clamp$1(colIndex, 0, colsInNextRow - 1);\n    return toCell(matrix, nextRowIndex, nextColIndex);\n  };\n\n  var cycleRight = function (matrix, startRow, startCol) {\n    return cycleHorizontal(matrix, startRow, startCol, +1);\n  };\n\n  var cycleLeft = function (matrix, startRow, startCol) {\n    return cycleHorizontal(matrix, startRow, startCol, -1);\n  };\n\n  var cycleUp = function (matrix, startRow, startCol) {\n    return cycleVertical(matrix, startCol, startRow, -1);\n  };\n\n  var cycleDown = function (matrix, startRow, startCol) {\n    return cycleVertical(matrix, startCol, startRow, +1);\n  };\n\n  var moveLeft$1 = function (matrix, startRow, startCol) {\n    return moveHorizontal(matrix, startRow, startCol, -1);\n  };\n\n  var moveRight$1 = function (matrix, startRow, startCol) {\n    return moveHorizontal(matrix, startRow, startCol, +1);\n  };\n\n  var moveUp$1 = function (matrix, startRow, startCol) {\n    return moveVertical(matrix, startCol, startRow, -1);\n  };\n\n  var moveDown$1 = function (matrix, startRow, startCol) {\n    return moveVertical(matrix, startCol, startRow, +1);\n  };\n\n  var schema$s = [requiredObjOf('selectors', [required$1('row'), required$1('cell')]), defaulted('cycles', true), defaulted('previousSelector', Optional.none), defaulted('execute', defaultExecute)];\n\n  var focusIn$1 = function (component, matrixConfig, _state) {\n    var focused = matrixConfig.previousSelector(component).orThunk(function () {\n      var selectors = matrixConfig.selectors;\n      return descendant(component.element, selectors.cell);\n    });\n    focused.each(function (cell) {\n      matrixConfig.focusManager.set(component, cell);\n    });\n  };\n\n  var execute$1 = function (component, simulatedEvent, matrixConfig) {\n    return search(component.element).bind(function (focused) {\n      return matrixConfig.execute(component, simulatedEvent, focused);\n    });\n  };\n\n  var toMatrix = function (rows, matrixConfig) {\n    return map$2(rows, function (row) {\n      return descendants(row, matrixConfig.selectors.cell);\n    });\n  };\n\n  var doMove = function (ifCycle, ifMove) {\n    return function (element, focused, matrixConfig) {\n      var move = matrixConfig.cycles ? ifCycle : ifMove;\n      return closest$1(focused, matrixConfig.selectors.row).bind(function (inRow) {\n        var cellsInRow = descendants(inRow, matrixConfig.selectors.cell);\n        return findIndex(cellsInRow, focused).bind(function (colIndex) {\n          var allRows = descendants(element, matrixConfig.selectors.row);\n          return findIndex(allRows, inRow).bind(function (rowIndex) {\n            var matrix = toMatrix(allRows, matrixConfig);\n            return move(matrix, rowIndex, colIndex).map(function (next) {\n              return next.cell;\n            });\n          });\n        });\n      });\n    };\n  };\n\n  var moveLeft = doMove(cycleLeft, moveLeft$1);\n  var moveRight = doMove(cycleRight, moveRight$1);\n  var moveNorth = doMove(cycleUp, moveUp$1);\n  var moveSouth = doMove(cycleDown, moveDown$1);\n  var getKeydownRules$2 = constant$1([rule(inSet(LEFT), west$1(moveLeft, moveRight)), rule(inSet(RIGHT), east$1(moveLeft, moveRight)), rule(inSet(UP), north$1(moveNorth)), rule(inSet(DOWN), south$1(moveSouth)), rule(inSet(SPACE.concat(ENTER)), execute$1)]);\n  var getKeyupRules$2 = constant$1([rule(inSet(SPACE), stopEventForFirefox)]);\n  var MatrixType = typical(schema$s, NoState.init, getKeydownRules$2, getKeyupRules$2, function () {\n    return Optional.some(focusIn$1);\n  });\n  var schema$r = [required$1('selector'), defaulted('execute', defaultExecute), defaulted('moveOnTab', false)];\n\n  var execute = function (component, simulatedEvent, menuConfig) {\n    return menuConfig.focusManager.get(component).bind(function (focused) {\n      return menuConfig.execute(component, simulatedEvent, focused);\n    });\n  };\n\n  var focusIn = function (component, menuConfig, _state) {\n    descendant(component.element, menuConfig.selector).each(function (first) {\n      menuConfig.focusManager.set(component, first);\n    });\n  };\n\n  var moveUp = function (element, focused, info) {\n    return horizontal(element, info.selector, focused, -1);\n  };\n\n  var moveDown = function (element, focused, info) {\n    return horizontal(element, info.selector, focused, +1);\n  };\n\n  var fireShiftTab = function (component, simulatedEvent, menuConfig, menuState) {\n    return menuConfig.moveOnTab ? move$1(moveUp)(component, simulatedEvent, menuConfig, menuState) : Optional.none();\n  };\n\n  var fireTab = function (component, simulatedEvent, menuConfig, menuState) {\n    return menuConfig.moveOnTab ? move$1(moveDown)(component, simulatedEvent, menuConfig, menuState) : Optional.none();\n  };\n\n  var getKeydownRules$1 = constant$1([rule(inSet(UP), move$1(moveUp)), rule(inSet(DOWN), move$1(moveDown)), rule(and([isShift, inSet(TAB)]), fireShiftTab), rule(and([isNotShift, inSet(TAB)]), fireTab), rule(inSet(ENTER), execute), rule(inSet(SPACE), execute)]);\n  var getKeyupRules$1 = constant$1([rule(inSet(SPACE), stopEventForFirefox)]);\n  var MenuType = typical(schema$r, NoState.init, getKeydownRules$1, getKeyupRules$1, function () {\n    return Optional.some(focusIn);\n  });\n  var schema$q = [onKeyboardHandler('onSpace'), onKeyboardHandler('onEnter'), onKeyboardHandler('onShiftEnter'), onKeyboardHandler('onLeft'), onKeyboardHandler('onRight'), onKeyboardHandler('onTab'), onKeyboardHandler('onShiftTab'), onKeyboardHandler('onUp'), onKeyboardHandler('onDown'), onKeyboardHandler('onEscape'), defaulted('stopSpaceKeyup', false), option('focusIn')];\n\n  var getKeydownRules = function (component, simulatedEvent, specialInfo) {\n    return [rule(inSet(SPACE), specialInfo.onSpace), rule(and([isNotShift, inSet(ENTER)]), specialInfo.onEnter), rule(and([isShift, inSet(ENTER)]), specialInfo.onShiftEnter), rule(and([isShift, inSet(TAB)]), specialInfo.onShiftTab), rule(and([isNotShift, inSet(TAB)]), specialInfo.onTab), rule(inSet(UP), specialInfo.onUp), rule(inSet(DOWN), specialInfo.onDown), rule(inSet(LEFT), specialInfo.onLeft), rule(inSet(RIGHT), specialInfo.onRight), rule(inSet(SPACE), specialInfo.onSpace), rule(inSet(ESCAPE), specialInfo.onEscape)];\n  };\n\n  var getKeyupRules = function (component, simulatedEvent, specialInfo) {\n    return specialInfo.stopSpaceKeyup ? [rule(inSet(SPACE), stopEventForFirefox)] : [];\n  };\n\n  var SpecialType = typical(schema$q, NoState.init, getKeydownRules, getKeyupRules, function (specialInfo) {\n    return specialInfo.focusIn;\n  });\n  var acyclic = AcyclicType.schema();\n  var cyclic = CyclicType.schema();\n  var flow = FlowType.schema();\n  var flatgrid = FlatgridType.schema();\n  var matrix = MatrixType.schema();\n  var execution = ExecutionType.schema();\n  var menu = MenuType.schema();\n  var special = SpecialType.schema();\n  var KeyboardBranches = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    acyclic: acyclic,\n    cyclic: cyclic,\n    flow: flow,\n    flatgrid: flatgrid,\n    matrix: matrix,\n    execution: execution,\n    menu: menu,\n    special: special\n  });\n\n  var isFlatgridState = function (keyState) {\n    return hasNonNullableKey(keyState, 'setGridSize');\n  };\n\n  var Keying = createModes({\n    branchKey: 'mode',\n    branches: KeyboardBranches,\n    name: 'keying',\n    active: {\n      events: function (keyingConfig, keyingState) {\n        var handler = keyingConfig.handler;\n        return handler.toEvents(keyingConfig, keyingState);\n      }\n    },\n    apis: {\n      focusIn: function (component, keyConfig, keyState) {\n        keyConfig.sendFocusIn(keyConfig).fold(function () {\n          component.getSystem().triggerFocus(component.element, component.element);\n        }, function (sendFocusIn) {\n          sendFocusIn(component, keyConfig, keyState);\n        });\n      },\n      setGridSize: function (component, keyConfig, keyState, numRows, numColumns) {\n        if (!isFlatgridState(keyState)) {\n          console.error('Layout does not support setGridSize');\n        } else {\n          keyState.setGridSize(numRows, numColumns);\n        }\n      }\n    },\n    state: KeyingState\n  });\n\n  var set$2 = function (component, replaceConfig, replaceState, data) {\n    preserve$1(function () {\n      var newChildren = map$2(data, component.getSystem().build);\n      replaceChildren(component, newChildren);\n    }, component.element);\n  };\n\n  var insert = function (component, replaceConfig, insertion, childSpec) {\n    var child = component.getSystem().build(childSpec);\n    attachWith(component, child, insertion);\n  };\n\n  var append = function (component, replaceConfig, replaceState, appendee) {\n    insert(component, replaceConfig, append$2, appendee);\n  };\n\n  var prepend = function (component, replaceConfig, replaceState, prependee) {\n    insert(component, replaceConfig, prepend$1, prependee);\n  };\n\n  var remove = function (component, replaceConfig, replaceState, removee) {\n    var children = contents(component);\n    var foundChild = find$5(children, function (child) {\n      return eq(removee.element, child.element);\n    });\n    foundChild.each(detach);\n  };\n\n  var contents = function (component, _replaceConfig) {\n    return component.components();\n  };\n\n  var replaceAt = function (component, replaceConfig, replaceState, replaceeIndex, replacer) {\n    var children = contents(component);\n    return Optional.from(children[replaceeIndex]).map(function (replacee) {\n      remove(component, replaceConfig, replaceState, replacee);\n      replacer.each(function (r) {\n        insert(component, replaceConfig, function (p, c) {\n          appendAt(p, c, replaceeIndex);\n        }, r);\n      });\n      return replacee;\n    });\n  };\n\n  var replaceBy = function (component, replaceConfig, replaceState, replaceePred, replacer) {\n    var children = contents(component);\n    return findIndex$1(children, replaceePred).bind(function (replaceeIndex) {\n      return replaceAt(component, replaceConfig, replaceState, replaceeIndex, replacer);\n    });\n  };\n\n  var ReplaceApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    append: append,\n    prepend: prepend,\n    remove: remove,\n    replaceAt: replaceAt,\n    replaceBy: replaceBy,\n    set: set$2,\n    contents: contents\n  });\n  var Replacing = create$7({\n    fields: [],\n    name: 'replacing',\n    apis: ReplaceApis\n  });\n\n  var events$d = function (name, eventHandlers) {\n    var events = derive$2(eventHandlers);\n    return create$7({\n      fields: [required$1('enabled')],\n      name: name,\n      active: {\n        events: constant$1(events)\n      }\n    });\n  };\n\n  var config = function (name, eventHandlers) {\n    var me = events$d(name, eventHandlers);\n    return {\n      key: name,\n      value: {\n        config: {},\n        me: me,\n        configAsRaw: constant$1({}),\n        initialConfig: {},\n        state: NoState\n      }\n    };\n  };\n\n  var focus$2 = function (component, focusConfig) {\n    if (!focusConfig.ignore) {\n      focus$3(component.element);\n      focusConfig.onFocus(component);\n    }\n  };\n\n  var blur = function (component, focusConfig) {\n    if (!focusConfig.ignore) {\n      blur$1(component.element);\n    }\n  };\n\n  var isFocused = function (component) {\n    return hasFocus(component.element);\n  };\n\n  var FocusApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    focus: focus$2,\n    blur: blur,\n    isFocused: isFocused\n  });\n\n  var exhibit$4 = function (base, focusConfig) {\n    var mod = focusConfig.ignore ? {} : {\n      attributes: {\n        tabindex: '-1'\n      }\n    };\n    return nu$7(mod);\n  };\n\n  var events$c = function (focusConfig) {\n    return derive$2([run$1(focus$4(), function (component, simulatedEvent) {\n      focus$2(component, focusConfig);\n      simulatedEvent.stop();\n    })].concat(focusConfig.stopMousedown ? [run$1(mousedown(), function (_, simulatedEvent) {\n      simulatedEvent.event.prevent();\n    })] : []));\n  };\n\n  var ActiveFocus = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$4,\n    events: events$c\n  });\n  var FocusSchema = [onHandler('onFocus'), defaulted('stopMousedown', false), defaulted('ignore', false)];\n  var Focusing = create$7({\n    fields: FocusSchema,\n    name: 'focusing',\n    active: ActiveFocus,\n    apis: FocusApis\n  });\n\n  var SetupBehaviourCellState = function (initialState) {\n    var init = function () {\n      var cell = Cell(initialState);\n\n      var get = function () {\n        return cell.get();\n      };\n\n      var set = function (newState) {\n        return cell.set(newState);\n      };\n\n      var clear = function () {\n        return cell.set(initialState);\n      };\n\n      var readState = function () {\n        return cell.get();\n      };\n\n      return {\n        get: get,\n        set: set,\n        clear: clear,\n        readState: readState\n      };\n    };\n\n    return {\n      init: init\n    };\n  };\n\n  var updateAriaState = function (component, toggleConfig, toggleState) {\n    var ariaInfo = toggleConfig.aria;\n    ariaInfo.update(component, ariaInfo, toggleState.get());\n  };\n\n  var updateClass = function (component, toggleConfig, toggleState) {\n    toggleConfig.toggleClass.each(function (toggleClass) {\n      if (toggleState.get()) {\n        add$2(component.element, toggleClass);\n      } else {\n        remove$2(component.element, toggleClass);\n      }\n    });\n  };\n\n  var toggle$2 = function (component, toggleConfig, toggleState) {\n    set$1(component, toggleConfig, toggleState, !toggleState.get());\n  };\n\n  var on = function (component, toggleConfig, toggleState) {\n    toggleState.set(true);\n    updateClass(component, toggleConfig, toggleState);\n    updateAriaState(component, toggleConfig, toggleState);\n  };\n\n  var off = function (component, toggleConfig, toggleState) {\n    toggleState.set(false);\n    updateClass(component, toggleConfig, toggleState);\n    updateAriaState(component, toggleConfig, toggleState);\n  };\n\n  var set$1 = function (component, toggleConfig, toggleState, state) {\n    var action = state ? on : off;\n    action(component, toggleConfig, toggleState);\n  };\n\n  var isOn = function (component, toggleConfig, toggleState) {\n    return toggleState.get();\n  };\n\n  var onLoad = function (component, toggleConfig, toggleState) {\n    set$1(component, toggleConfig, toggleState, toggleConfig.selected);\n  };\n\n  var ToggleApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    onLoad: onLoad,\n    toggle: toggle$2,\n    isOn: isOn,\n    on: on,\n    off: off,\n    set: set$1\n  });\n\n  var exhibit$3 = function () {\n    return nu$7({});\n  };\n\n  var events$b = function (toggleConfig, toggleState) {\n    var execute = executeEvent(toggleConfig, toggleState, toggle$2);\n    var load = loadEvent(toggleConfig, toggleState, onLoad);\n    return derive$2(flatten([toggleConfig.toggleOnExecute ? [execute] : [], [load]]));\n  };\n\n  var ActiveToggle = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$3,\n    events: events$b\n  });\n\n  var updatePressed = function (component, ariaInfo, status) {\n    set$8(component.element, 'aria-pressed', status);\n\n    if (ariaInfo.syncWithExpanded) {\n      updateExpanded(component, ariaInfo, status);\n    }\n  };\n\n  var updateSelected = function (component, ariaInfo, status) {\n    set$8(component.element, 'aria-selected', status);\n  };\n\n  var updateChecked = function (component, ariaInfo, status) {\n    set$8(component.element, 'aria-checked', status);\n  };\n\n  var updateExpanded = function (component, ariaInfo, status) {\n    set$8(component.element, 'aria-expanded', status);\n  };\n\n  var ToggleSchema = [defaulted('selected', false), option('toggleClass'), defaulted('toggleOnExecute', true), defaultedOf('aria', {\n    mode: 'none'\n  }, choose$1('mode', {\n    pressed: [defaulted('syncWithExpanded', false), output$1('update', updatePressed)],\n    checked: [output$1('update', updateChecked)],\n    expanded: [output$1('update', updateExpanded)],\n    selected: [output$1('update', updateSelected)],\n    none: [output$1('update', noop)]\n  }))];\n  var Toggling = create$7({\n    fields: ToggleSchema,\n    name: 'toggling',\n    active: ActiveToggle,\n    apis: ToggleApis,\n    state: SetupBehaviourCellState(false)\n  });\n\n  var pointerEvents = function () {\n    var onClick = function (component, simulatedEvent) {\n      simulatedEvent.stop();\n      emitExecute(component);\n    };\n\n    return [run$1(click(), onClick), run$1(tap(), onClick), cutter(touchstart()), cutter(mousedown())];\n  };\n\n  var events$a = function (optAction) {\n    var executeHandler = function (action) {\n      return runOnExecute$1(function (component, simulatedEvent) {\n        action(component);\n        simulatedEvent.stop();\n      });\n    };\n\n    return derive$2(flatten([optAction.map(executeHandler).toArray(), pointerEvents()]));\n  };\n\n  var hoverEvent = 'alloy.item-hover';\n  var focusEvent = 'alloy.item-focus';\n\n  var onHover = function (item) {\n    if (search(item.element).isNone() || Focusing.isFocused(item)) {\n      if (!Focusing.isFocused(item)) {\n        Focusing.focus(item);\n      }\n\n      emitWith(item, hoverEvent, {\n        item: item\n      });\n    }\n  };\n\n  var onFocus$1 = function (item) {\n    emitWith(item, focusEvent, {\n      item: item\n    });\n  };\n\n  var hover = constant$1(hoverEvent);\n  var focus$1 = constant$1(focusEvent);\n\n  var builder$2 = function (detail) {\n    return {\n      dom: detail.dom,\n      domModification: __assign(__assign({}, detail.domModification), {\n        attributes: __assign(__assign(__assign({\n          'role': detail.toggling.isSome() ? 'menuitemcheckbox' : 'menuitem'\n        }, detail.domModification.attributes), {\n          'aria-haspopup': detail.hasSubmenu\n        }), detail.hasSubmenu ? {\n          'aria-expanded': false\n        } : {})\n      }),\n      behaviours: SketchBehaviours.augment(detail.itemBehaviours, [detail.toggling.fold(Toggling.revoke, function (tConfig) {\n        return Toggling.config(__assign({\n          aria: {\n            mode: 'checked'\n          }\n        }, tConfig));\n      }), Focusing.config({\n        ignore: detail.ignoreFocus,\n        stopMousedown: detail.ignoreFocus,\n        onFocus: function (component) {\n          onFocus$1(component);\n        }\n      }), Keying.config({\n        mode: 'execution'\n      }), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: detail.data\n        }\n      }), config('item-type-events', __spreadArray(__spreadArray([], pointerEvents(), true), [run$1(mouseover(), onHover), run$1(focusItem(), Focusing.focus)], false))]),\n      components: detail.components,\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var schema$p = [required$1('data'), required$1('components'), required$1('dom'), defaulted('hasSubmenu', false), option('toggling'), SketchBehaviours.field('itemBehaviours', [Toggling, Focusing, Keying, Representing]), defaulted('ignoreFocus', false), defaulted('domModification', {}), output$1('builder', builder$2), defaulted('eventOrder', {})];\n\n  var builder$1 = function (detail) {\n    return {\n      dom: detail.dom,\n      components: detail.components,\n      events: derive$2([stopper(focusItem())])\n    };\n  };\n\n  var schema$o = [required$1('dom'), required$1('components'), output$1('builder', builder$1)];\n  var owner$2 = constant$1('item-widget');\n  var parts$h = constant$1([required({\n    name: 'widget',\n    overrides: function (detail) {\n      return {\n        behaviours: derive$1([Representing.config({\n          store: {\n            mode: 'manual',\n            getValue: function (_component) {\n              return detail.data;\n            },\n            setValue: noop\n          }\n        })])\n      };\n    }\n  })]);\n\n  var builder = function (detail) {\n    var subs = substitutes(owner$2(), detail, parts$h());\n    var components = components$1(owner$2(), detail, subs.internals());\n\n    var focusWidget = function (component) {\n      return getPart(component, detail, 'widget').map(function (widget) {\n        Keying.focusIn(widget);\n        return widget;\n      });\n    };\n\n    var onHorizontalArrow = function (component, simulatedEvent) {\n      return inside(simulatedEvent.event.target) ? Optional.none() : function () {\n        if (detail.autofocus) {\n          simulatedEvent.setSource(component.element);\n          return Optional.none();\n        } else {\n          return Optional.none();\n        }\n      }();\n    };\n\n    return {\n      dom: detail.dom,\n      components: components,\n      domModification: detail.domModification,\n      events: derive$2([runOnExecute$1(function (component, simulatedEvent) {\n        focusWidget(component).each(function (_widget) {\n          simulatedEvent.stop();\n        });\n      }), run$1(mouseover(), onHover), run$1(focusItem(), function (component, _simulatedEvent) {\n        if (detail.autofocus) {\n          focusWidget(component);\n        } else {\n          Focusing.focus(component);\n        }\n      })]),\n      behaviours: SketchBehaviours.augment(detail.widgetBehaviours, [Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: detail.data\n        }\n      }), Focusing.config({\n        ignore: detail.ignoreFocus,\n        onFocus: function (component) {\n          onFocus$1(component);\n        }\n      }), Keying.config({\n        mode: 'special',\n        focusIn: detail.autofocus ? function (component) {\n          focusWidget(component);\n        } : revoke(),\n        onLeft: onHorizontalArrow,\n        onRight: onHorizontalArrow,\n        onEscape: function (component, simulatedEvent) {\n          if (!Focusing.isFocused(component) && !detail.autofocus) {\n            Focusing.focus(component);\n            return Optional.some(true);\n          } else if (detail.autofocus) {\n            simulatedEvent.setSource(component.element);\n            return Optional.none();\n          } else {\n            return Optional.none();\n          }\n        }\n      })])\n    };\n  };\n\n  var schema$n = [required$1('uid'), required$1('data'), required$1('components'), required$1('dom'), defaulted('autofocus', false), defaulted('ignoreFocus', false), SketchBehaviours.field('widgetBehaviours', [Representing, Focusing, Keying]), defaulted('domModification', {}), defaultUidsSchema(parts$h()), output$1('builder', builder)];\n  var itemSchema$2 = choose$1('type', {\n    widget: schema$n,\n    item: schema$p,\n    separator: schema$o\n  });\n\n  var configureGrid = function (detail, movementInfo) {\n    return {\n      mode: 'flatgrid',\n      selector: '.' + detail.markers.item,\n      initSize: {\n        numColumns: movementInfo.initSize.numColumns,\n        numRows: movementInfo.initSize.numRows\n      },\n      focusManager: detail.focusManager\n    };\n  };\n\n  var configureMatrix = function (detail, movementInfo) {\n    return {\n      mode: 'matrix',\n      selectors: {\n        row: movementInfo.rowSelector,\n        cell: '.' + detail.markers.item\n      },\n      focusManager: detail.focusManager\n    };\n  };\n\n  var configureMenu = function (detail, movementInfo) {\n    return {\n      mode: 'menu',\n      selector: '.' + detail.markers.item,\n      moveOnTab: movementInfo.moveOnTab,\n      focusManager: detail.focusManager\n    };\n  };\n\n  var parts$g = constant$1([group({\n    factory: {\n      sketch: function (spec) {\n        var itemInfo = asRawOrDie$1('menu.spec item', itemSchema$2, spec);\n        return itemInfo.builder(itemInfo);\n      }\n    },\n    name: 'items',\n    unit: 'item',\n    defaults: function (detail, u) {\n      return has$2(u, 'uid') ? u : __assign(__assign({}, u), {\n        uid: generate$5('item')\n      });\n    },\n    overrides: function (detail, u) {\n      return {\n        type: u.type,\n        ignoreFocus: detail.fakeFocus,\n        domModification: {\n          classes: [detail.markers.item]\n        }\n      };\n    }\n  })]);\n  var schema$m = constant$1([required$1('value'), required$1('items'), required$1('dom'), required$1('components'), defaulted('eventOrder', {}), field('menuBehaviours', [Highlighting, Representing, Composing, Keying]), defaultedOf('movement', {\n    mode: 'menu',\n    moveOnTab: true\n  }, choose$1('mode', {\n    grid: [initSize(), output$1('config', configureGrid)],\n    matrix: [output$1('config', configureMatrix), required$1('rowSelector')],\n    menu: [defaulted('moveOnTab', true), output$1('config', configureMenu)]\n  })), itemMarkers(), defaulted('fakeFocus', false), defaulted('focusManager', dom$2()), onHandler('onHighlight')]);\n  var focus = constant$1('alloy.menu-focus');\n\n  var make$7 = function (detail, components, _spec, _externals) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      markers: detail.markers,\n      behaviours: augment(detail.menuBehaviours, [Highlighting.config({\n        highlightClass: detail.markers.selectedItem,\n        itemClass: detail.markers.item,\n        onHighlight: detail.onHighlight\n      }), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: detail.value\n        }\n      }), Composing.config({\n        find: Optional.some\n      }), Keying.config(detail.movement.config(detail, detail.movement))]),\n      events: derive$2([run$1(focus$1(), function (menu, simulatedEvent) {\n        var event = simulatedEvent.event;\n        menu.getSystem().getByDom(event.target).each(function (item) {\n          Highlighting.highlight(menu, item);\n          simulatedEvent.stop();\n          emitWith(menu, focus(), {\n            menu: menu,\n            item: item\n          });\n        });\n      }), run$1(hover(), function (menu, simulatedEvent) {\n        var item = simulatedEvent.event.item;\n        Highlighting.highlight(menu, item);\n      })]),\n      components: components,\n      eventOrder: detail.eventOrder,\n      domModification: {\n        attributes: {\n          role: 'menu'\n        }\n      }\n    };\n  };\n\n  var Menu = composite({\n    name: 'Menu',\n    configFields: schema$m(),\n    partFields: parts$g(),\n    factory: make$7\n  });\n\n  var transpose$1 = function (obj) {\n    return tupleMap(obj, function (v, k) {\n      return {\n        k: v,\n        v: k\n      };\n    });\n  };\n\n  var trace = function (items, byItem, byMenu, finish) {\n    return get$e(byMenu, finish).bind(function (triggerItem) {\n      return get$e(items, triggerItem).bind(function (triggerMenu) {\n        var rest = trace(items, byItem, byMenu, triggerMenu);\n        return Optional.some([triggerMenu].concat(rest));\n      });\n    }).getOr([]);\n  };\n\n  var generate$2 = function (menus, expansions) {\n    var items = {};\n    each(menus, function (menuItems, menu) {\n      each$1(menuItems, function (item) {\n        items[item] = menu;\n      });\n    });\n    var byItem = expansions;\n    var byMenu = transpose$1(expansions);\n    var menuPaths = map$1(byMenu, function (_triggerItem, submenu) {\n      return [submenu].concat(trace(items, byItem, byMenu, submenu));\n    });\n    return map$1(items, function (menu) {\n      return get$e(menuPaths, menu).getOr([menu]);\n    });\n  };\n\n  var init$c = function () {\n    var expansions = Cell({});\n    var menus = Cell({});\n    var paths = Cell({});\n    var primary = value$1();\n    var directory = Cell({});\n\n    var clear = function () {\n      expansions.set({});\n      menus.set({});\n      paths.set({});\n      primary.clear();\n    };\n\n    var isClear = function () {\n      return primary.get().isNone();\n    };\n\n    var setMenuBuilt = function (menuName, built) {\n      var _a;\n\n      menus.set(__assign(__assign({}, menus.get()), (_a = {}, _a[menuName] = {\n        type: 'prepared',\n        menu: built\n      }, _a)));\n    };\n\n    var setContents = function (sPrimary, sMenus, sExpansions, dir) {\n      primary.set(sPrimary);\n      expansions.set(sExpansions);\n      menus.set(sMenus);\n      directory.set(dir);\n      var sPaths = generate$2(dir, sExpansions);\n      paths.set(sPaths);\n    };\n\n    var getTriggeringItem = function (menuValue) {\n      return find$4(expansions.get(), function (v, _k) {\n        return v === menuValue;\n      });\n    };\n\n    var getTriggerData = function (menuValue, getItemByValue, path) {\n      return getPreparedMenu(menuValue).bind(function (menu) {\n        return getTriggeringItem(menuValue).bind(function (triggeringItemValue) {\n          return getItemByValue(triggeringItemValue).map(function (triggeredItem) {\n            return {\n              triggeredMenu: menu,\n              triggeringItem: triggeredItem,\n              triggeringPath: path\n            };\n          });\n        });\n      });\n    };\n\n    var getTriggeringPath = function (itemValue, getItemByValue) {\n      var extraPath = filter$2(lookupItem(itemValue).toArray(), function (menuValue) {\n        return getPreparedMenu(menuValue).isSome();\n      });\n      return get$e(paths.get(), itemValue).bind(function (path) {\n        var revPath = reverse(extraPath.concat(path));\n        var triggers = bind$3(revPath, function (menuValue, menuIndex) {\n          return getTriggerData(menuValue, getItemByValue, revPath.slice(0, menuIndex + 1)).fold(function () {\n            return is$1(primary.get(), menuValue) ? [] : [Optional.none()];\n          }, function (data) {\n            return [Optional.some(data)];\n          });\n        });\n        return sequence(triggers);\n      });\n    };\n\n    var expand = function (itemValue) {\n      return get$e(expansions.get(), itemValue).map(function (menu) {\n        var current = get$e(paths.get(), itemValue).getOr([]);\n        return [menu].concat(current);\n      });\n    };\n\n    var collapse = function (itemValue) {\n      return get$e(paths.get(), itemValue).bind(function (path) {\n        return path.length > 1 ? Optional.some(path.slice(1)) : Optional.none();\n      });\n    };\n\n    var refresh = function (itemValue) {\n      return get$e(paths.get(), itemValue);\n    };\n\n    var getPreparedMenu = function (menuValue) {\n      return lookupMenu(menuValue).bind(extractPreparedMenu);\n    };\n\n    var lookupMenu = function (menuValue) {\n      return get$e(menus.get(), menuValue);\n    };\n\n    var lookupItem = function (itemValue) {\n      return get$e(expansions.get(), itemValue);\n    };\n\n    var otherMenus = function (path) {\n      var menuValues = directory.get();\n      return difference(keys(menuValues), path);\n    };\n\n    var getPrimary = function () {\n      return primary.get().bind(getPreparedMenu);\n    };\n\n    var getMenus = function () {\n      return menus.get();\n    };\n\n    return {\n      setMenuBuilt: setMenuBuilt,\n      setContents: setContents,\n      expand: expand,\n      refresh: refresh,\n      collapse: collapse,\n      lookupMenu: lookupMenu,\n      lookupItem: lookupItem,\n      otherMenus: otherMenus,\n      getPrimary: getPrimary,\n      getMenus: getMenus,\n      clear: clear,\n      isClear: isClear,\n      getTriggeringPath: getTriggeringPath\n    };\n  };\n\n  var extractPreparedMenu = function (prep) {\n    return prep.type === 'prepared' ? Optional.some(prep.menu) : Optional.none();\n  };\n\n  var LayeredState = {\n    init: init$c,\n    extractPreparedMenu: extractPreparedMenu\n  };\n\n  var make$6 = function (detail, _rawUiSpec) {\n    var submenuParentItems = value$1();\n\n    var buildMenus = function (container, primaryName, menus) {\n      return map$1(menus, function (spec, name) {\n        var makeSketch = function () {\n          return Menu.sketch(__assign(__assign({}, spec), {\n            value: name,\n            markers: detail.markers,\n            fakeFocus: detail.fakeFocus,\n            onHighlight: detail.onHighlight,\n            focusManager: detail.fakeFocus ? highlights() : dom$2()\n          }));\n        };\n\n        return name === primaryName ? {\n          type: 'prepared',\n          menu: container.getSystem().build(makeSketch())\n        } : {\n          type: 'notbuilt',\n          nbMenu: makeSketch\n        };\n      });\n    };\n\n    var layeredState = LayeredState.init();\n\n    var setup = function (container) {\n      var componentMap = buildMenus(container, detail.data.primary, detail.data.menus);\n      var directory = toDirectory();\n      layeredState.setContents(detail.data.primary, componentMap, detail.data.expansions, directory);\n      return layeredState.getPrimary();\n    };\n\n    var getItemValue = function (item) {\n      return Representing.getValue(item).value;\n    };\n\n    var getItemByValue = function (_container, menus, itemValue) {\n      return findMap(menus, function (menu) {\n        if (!menu.getSystem().isConnected()) {\n          return Optional.none();\n        }\n\n        var candidates = Highlighting.getCandidates(menu);\n        return find$5(candidates, function (c) {\n          return getItemValue(c) === itemValue;\n        });\n      });\n    };\n\n    var toDirectory = function (_container) {\n      return map$1(detail.data.menus, function (data, _menuName) {\n        return bind$3(data.items, function (item) {\n          return item.type === 'separator' ? [] : [item.data.value];\n        });\n      });\n    };\n\n    var setActiveMenu = function (container, menu) {\n      Highlighting.highlight(container, menu);\n      Highlighting.getHighlighted(menu).orThunk(function () {\n        return Highlighting.getFirst(menu);\n      }).each(function (item) {\n        dispatch(container, item.element, focusItem());\n      });\n    };\n\n    var getMenus = function (state, menuValues) {\n      return cat(map$2(menuValues, function (mv) {\n        return state.lookupMenu(mv).bind(function (prep) {\n          return prep.type === 'prepared' ? Optional.some(prep.menu) : Optional.none();\n        });\n      }));\n    };\n\n    var closeOthers = function (container, state, path) {\n      var others = getMenus(state, state.otherMenus(path));\n      each$1(others, function (o) {\n        remove$1(o.element, [detail.markers.backgroundMenu]);\n\n        if (!detail.stayInDom) {\n          Replacing.remove(container, o);\n        }\n      });\n    };\n\n    var getSubmenuParents = function (container) {\n      return submenuParentItems.get().getOrThunk(function () {\n        var r = {};\n        var items = descendants(container.element, '.' + detail.markers.item);\n        var parentItems = filter$2(items, function (i) {\n          return get$d(i, 'aria-haspopup') === 'true';\n        });\n        each$1(parentItems, function (i) {\n          container.getSystem().getByDom(i).each(function (itemComp) {\n            var key = getItemValue(itemComp);\n            r[key] = itemComp;\n          });\n        });\n        submenuParentItems.set(r);\n        return r;\n      });\n    };\n\n    var updateAriaExpansions = function (container, path) {\n      var parentItems = getSubmenuParents(container);\n      each(parentItems, function (v, k) {\n        var expanded = contains$2(path, k);\n        set$8(v.element, 'aria-expanded', expanded);\n      });\n    };\n\n    var updateMenuPath = function (container, state, path) {\n      return Optional.from(path[0]).bind(function (latestMenuName) {\n        return state.lookupMenu(latestMenuName).bind(function (menuPrep) {\n          if (menuPrep.type === 'notbuilt') {\n            return Optional.none();\n          } else {\n            var activeMenu = menuPrep.menu;\n            var rest = getMenus(state, path.slice(1));\n            each$1(rest, function (r) {\n              add$2(r.element, detail.markers.backgroundMenu);\n            });\n\n            if (!inBody(activeMenu.element)) {\n              Replacing.append(container, premade(activeMenu));\n            }\n\n            remove$1(activeMenu.element, [detail.markers.backgroundMenu]);\n            setActiveMenu(container, activeMenu);\n            closeOthers(container, state, path);\n            return Optional.some(activeMenu);\n          }\n        });\n      });\n    };\n\n    var ExpandHighlightDecision;\n\n    (function (ExpandHighlightDecision) {\n      ExpandHighlightDecision[ExpandHighlightDecision['HighlightSubmenu'] = 0] = 'HighlightSubmenu';\n      ExpandHighlightDecision[ExpandHighlightDecision['HighlightParent'] = 1] = 'HighlightParent';\n    })(ExpandHighlightDecision || (ExpandHighlightDecision = {}));\n\n    var buildIfRequired = function (container, menuName, menuPrep) {\n      if (menuPrep.type === 'notbuilt') {\n        var menu = container.getSystem().build(menuPrep.nbMenu());\n        layeredState.setMenuBuilt(menuName, menu);\n        return menu;\n      } else {\n        return menuPrep.menu;\n      }\n    };\n\n    var expandRight = function (container, item, decision) {\n      if (decision === void 0) {\n        decision = ExpandHighlightDecision.HighlightSubmenu;\n      }\n\n      if (item.hasConfigured(Disabling) && Disabling.isDisabled(item)) {\n        return Optional.some(item);\n      } else {\n        var value = getItemValue(item);\n        return layeredState.expand(value).bind(function (path) {\n          updateAriaExpansions(container, path);\n          return Optional.from(path[0]).bind(function (menuName) {\n            return layeredState.lookupMenu(menuName).bind(function (activeMenuPrep) {\n              var activeMenu = buildIfRequired(container, menuName, activeMenuPrep);\n\n              if (!inBody(activeMenu.element)) {\n                Replacing.append(container, premade(activeMenu));\n              }\n\n              detail.onOpenSubmenu(container, item, activeMenu, reverse(path));\n\n              if (decision === ExpandHighlightDecision.HighlightSubmenu) {\n                Highlighting.highlightFirst(activeMenu);\n                return updateMenuPath(container, layeredState, path);\n              } else {\n                Highlighting.dehighlightAll(activeMenu);\n                return Optional.some(item);\n              }\n            });\n          });\n        });\n      }\n    };\n\n    var collapseLeft = function (container, item) {\n      var value = getItemValue(item);\n      return layeredState.collapse(value).bind(function (path) {\n        updateAriaExpansions(container, path);\n        return updateMenuPath(container, layeredState, path).map(function (activeMenu) {\n          detail.onCollapseMenu(container, item, activeMenu);\n          return activeMenu;\n        });\n      });\n    };\n\n    var updateView = function (container, item) {\n      var value = getItemValue(item);\n      return layeredState.refresh(value).bind(function (path) {\n        updateAriaExpansions(container, path);\n        return updateMenuPath(container, layeredState, path);\n      });\n    };\n\n    var onRight = function (container, item) {\n      return inside(item.element) ? Optional.none() : expandRight(container, item, ExpandHighlightDecision.HighlightSubmenu);\n    };\n\n    var onLeft = function (container, item) {\n      return inside(item.element) ? Optional.none() : collapseLeft(container, item);\n    };\n\n    var onEscape = function (container, item) {\n      return collapseLeft(container, item).orThunk(function () {\n        return detail.onEscape(container, item).map(function () {\n          return container;\n        });\n      });\n    };\n\n    var keyOnItem = function (f) {\n      return function (container, simulatedEvent) {\n        return closest$1(simulatedEvent.getSource(), '.' + detail.markers.item).bind(function (target) {\n          return container.getSystem().getByDom(target).toOptional().bind(function (item) {\n            return f(container, item).map(always);\n          });\n        });\n      };\n    };\n\n    var events = derive$2([run$1(focus(), function (sandbox, simulatedEvent) {\n      var item = simulatedEvent.event.item;\n      layeredState.lookupItem(getItemValue(item)).each(function () {\n        var menu = simulatedEvent.event.menu;\n        Highlighting.highlight(sandbox, menu);\n        var value = getItemValue(simulatedEvent.event.item);\n        layeredState.refresh(value).each(function (path) {\n          return closeOthers(sandbox, layeredState, path);\n        });\n      });\n    }), runOnExecute$1(function (component, simulatedEvent) {\n      var target = simulatedEvent.event.target;\n      component.getSystem().getByDom(target).each(function (item) {\n        var itemValue = getItemValue(item);\n\n        if (itemValue.indexOf('collapse-item') === 0) {\n          collapseLeft(component, item);\n        }\n\n        expandRight(component, item, ExpandHighlightDecision.HighlightSubmenu).fold(function () {\n          detail.onExecute(component, item);\n        }, noop);\n      });\n    }), runOnAttached(function (container, _simulatedEvent) {\n      setup(container).each(function (primary) {\n        Replacing.append(container, premade(primary));\n        detail.onOpenMenu(container, primary);\n\n        if (detail.highlightImmediately) {\n          setActiveMenu(container, primary);\n        }\n      });\n    })].concat(detail.navigateOnHover ? [run$1(hover(), function (sandbox, simulatedEvent) {\n      var item = simulatedEvent.event.item;\n      updateView(sandbox, item);\n      expandRight(sandbox, item, ExpandHighlightDecision.HighlightParent);\n      detail.onHover(sandbox, item);\n    })] : []));\n\n    var getActiveItem = function (container) {\n      return Highlighting.getHighlighted(container).bind(Highlighting.getHighlighted);\n    };\n\n    var collapseMenuApi = function (container) {\n      getActiveItem(container).each(function (currentItem) {\n        collapseLeft(container, currentItem);\n      });\n    };\n\n    var highlightPrimary = function (container) {\n      layeredState.getPrimary().each(function (primary) {\n        setActiveMenu(container, primary);\n      });\n    };\n\n    var extractMenuFromContainer = function (container) {\n      return Optional.from(container.components()[0]).filter(function (comp) {\n        return get$d(comp.element, 'role') === 'menu';\n      });\n    };\n\n    var repositionMenus = function (container) {\n      var maybeActivePrimary = layeredState.getPrimary().bind(function (primary) {\n        return getActiveItem(container).bind(function (currentItem) {\n          var itemValue = getItemValue(currentItem);\n          var allMenus = values(layeredState.getMenus());\n          var preparedMenus = cat(map$2(allMenus, LayeredState.extractPreparedMenu));\n          return layeredState.getTriggeringPath(itemValue, function (v) {\n            return getItemByValue(container, preparedMenus, v);\n          });\n        }).map(function (triggeringPath) {\n          return {\n            primary: primary,\n            triggeringPath: triggeringPath\n          };\n        });\n      });\n      maybeActivePrimary.fold(function () {\n        extractMenuFromContainer(container).each(function (primaryMenu) {\n          detail.onRepositionMenu(container, primaryMenu, []);\n        });\n      }, function (_a) {\n        var primary = _a.primary,\n            triggeringPath = _a.triggeringPath;\n        detail.onRepositionMenu(container, primary, triggeringPath);\n      });\n    };\n\n    var apis = {\n      collapseMenu: collapseMenuApi,\n      highlightPrimary: highlightPrimary,\n      repositionMenus: repositionMenus\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      markers: detail.markers,\n      behaviours: augment(detail.tmenuBehaviours, [Keying.config({\n        mode: 'special',\n        onRight: keyOnItem(onRight),\n        onLeft: keyOnItem(onLeft),\n        onEscape: keyOnItem(onEscape),\n        focusIn: function (container, _keyInfo) {\n          layeredState.getPrimary().each(function (primary) {\n            dispatch(container, primary.element, focusItem());\n          });\n        }\n      }), Highlighting.config({\n        highlightClass: detail.markers.selectedMenu,\n        itemClass: detail.markers.menu\n      }), Composing.config({\n        find: function (container) {\n          return Highlighting.getHighlighted(container);\n        }\n      }), Replacing.config({})]),\n      eventOrder: detail.eventOrder,\n      apis: apis,\n      events: events\n    };\n  };\n\n  var collapseItem$1 = constant$1('collapse-item');\n\n  var tieredData = function (primary, menus, expansions) {\n    return {\n      primary: primary,\n      menus: menus,\n      expansions: expansions\n    };\n  };\n\n  var singleData = function (name, menu) {\n    return {\n      primary: name,\n      menus: wrap$1(name, menu),\n      expansions: {}\n    };\n  };\n\n  var collapseItem = function (text) {\n    return {\n      value: generate$6(collapseItem$1()),\n      meta: {\n        text: text\n      }\n    };\n  };\n\n  var tieredMenu = single({\n    name: 'TieredMenu',\n    configFields: [onStrictKeyboardHandler('onExecute'), onStrictKeyboardHandler('onEscape'), onStrictHandler('onOpenMenu'), onStrictHandler('onOpenSubmenu'), onHandler('onRepositionMenu'), onHandler('onCollapseMenu'), defaulted('highlightImmediately', true), requiredObjOf('data', [required$1('primary'), required$1('menus'), required$1('expansions')]), defaulted('fakeFocus', false), onHandler('onHighlight'), onHandler('onHover'), tieredMenuMarkers(), required$1('dom'), defaulted('navigateOnHover', true), defaulted('stayInDom', false), field('tmenuBehaviours', [Keying, Highlighting, Composing, Replacing]), defaulted('eventOrder', {})],\n    apis: {\n      collapseMenu: function (apis, tmenu) {\n        apis.collapseMenu(tmenu);\n      },\n      highlightPrimary: function (apis, tmenu) {\n        apis.highlightPrimary(tmenu);\n      },\n      repositionMenus: function (apis, tmenu) {\n        apis.repositionMenus(tmenu);\n      }\n    },\n    factory: make$6,\n    extraApis: {\n      tieredData: tieredData,\n      singleData: singleData,\n      collapseItem: collapseItem\n    }\n  });\n\n  var makeMenu = function (detail, menuSandbox, placementSpec, menuSpec, getBounds) {\n    var lazySink = function () {\n      return detail.lazySink(menuSandbox);\n    };\n\n    var layouts = menuSpec.type === 'horizontal' ? {\n      layouts: {\n        onLtr: function () {\n          return belowOrAbove();\n        },\n        onRtl: function () {\n          return belowOrAboveRtl();\n        }\n      }\n    } : {};\n\n    var isFirstTierSubmenu = function (triggeringPaths) {\n      return triggeringPaths.length === 2;\n    };\n\n    var getSubmenuLayouts = function (triggeringPaths) {\n      return isFirstTierSubmenu(triggeringPaths) ? layouts : {};\n    };\n\n    return tieredMenu.sketch({\n      dom: {\n        tag: 'div'\n      },\n      data: menuSpec.data,\n      markers: menuSpec.menu.markers,\n      highlightImmediately: menuSpec.menu.highlightImmediately,\n      onEscape: function () {\n        Sandboxing.close(menuSandbox);\n        detail.onEscape.map(function (handler) {\n          return handler(menuSandbox);\n        });\n        return Optional.some(true);\n      },\n      onExecute: function () {\n        return Optional.some(true);\n      },\n      onOpenMenu: function (tmenu, menu) {\n        Positioning.positionWithinBounds(lazySink().getOrDie(), menu, placementSpec, getBounds());\n      },\n      onOpenSubmenu: function (tmenu, item, submenu, triggeringPaths) {\n        var sink = lazySink().getOrDie();\n        Positioning.position(sink, submenu, {\n          anchor: __assign({\n            type: 'submenu',\n            item: item\n          }, getSubmenuLayouts(triggeringPaths))\n        });\n      },\n      onRepositionMenu: function (tmenu, primaryMenu, submenuTriggers) {\n        var sink = lazySink().getOrDie();\n        Positioning.positionWithinBounds(sink, primaryMenu, placementSpec, getBounds());\n        each$1(submenuTriggers, function (st) {\n          var submenuLayouts = getSubmenuLayouts(st.triggeringPath);\n          Positioning.position(sink, st.triggeredMenu, {\n            anchor: __assign({\n              type: 'submenu',\n              item: st.triggeringItem\n            }, submenuLayouts)\n          });\n        });\n      }\n    });\n  };\n\n  var factory$m = function (detail, spec) {\n    var isPartOfRelated = function (sandbox, queryElem) {\n      var related = detail.getRelated(sandbox);\n      return related.exists(function (rel) {\n        return isPartOf$1(rel, queryElem);\n      });\n    };\n\n    var setContent = function (sandbox, thing) {\n      Sandboxing.setContent(sandbox, thing);\n    };\n\n    var showAt = function (sandbox, thing, placementSpec) {\n      showWithin(sandbox, thing, placementSpec, Optional.none());\n    };\n\n    var showWithin = function (sandbox, thing, placementSpec, boxElement) {\n      showWithinBounds(sandbox, thing, placementSpec, function () {\n        return boxElement.map(function (elem) {\n          return box$1(elem);\n        });\n      });\n    };\n\n    var showWithinBounds = function (sandbox, thing, placementSpec, getBounds) {\n      var sink = detail.lazySink(sandbox).getOrDie();\n      Sandboxing.openWhileCloaked(sandbox, thing, function () {\n        return Positioning.positionWithinBounds(sink, sandbox, placementSpec, getBounds());\n      });\n      Representing.setValue(sandbox, Optional.some({\n        mode: 'position',\n        config: placementSpec,\n        getBounds: getBounds\n      }));\n    };\n\n    var showMenuAt = function (sandbox, placementSpec, menuSpec) {\n      showMenuWithinBounds(sandbox, placementSpec, menuSpec, Optional.none);\n    };\n\n    var showMenuWithinBounds = function (sandbox, placementSpec, menuSpec, getBounds) {\n      var menu = makeMenu(detail, sandbox, placementSpec, menuSpec, getBounds);\n      Sandboxing.open(sandbox, menu);\n      Representing.setValue(sandbox, Optional.some({\n        mode: 'menu',\n        menu: menu\n      }));\n    };\n\n    var hide = function (sandbox) {\n      if (Sandboxing.isOpen(sandbox)) {\n        Representing.setValue(sandbox, Optional.none());\n        Sandboxing.close(sandbox);\n      }\n    };\n\n    var getContent = function (sandbox) {\n      return Sandboxing.getState(sandbox);\n    };\n\n    var reposition = function (sandbox) {\n      if (Sandboxing.isOpen(sandbox)) {\n        Representing.getValue(sandbox).each(function (state) {\n          switch (state.mode) {\n            case 'menu':\n              Sandboxing.getState(sandbox).each(tieredMenu.repositionMenus);\n              break;\n\n            case 'position':\n              var sink = detail.lazySink(sandbox).getOrDie();\n              Positioning.positionWithinBounds(sink, sandbox, state.config, state.getBounds());\n              break;\n          }\n        });\n      }\n    };\n\n    var apis = {\n      setContent: setContent,\n      showAt: showAt,\n      showWithin: showWithin,\n      showWithinBounds: showWithinBounds,\n      showMenuAt: showMenuAt,\n      showMenuWithinBounds: showMenuWithinBounds,\n      hide: hide,\n      getContent: getContent,\n      reposition: reposition,\n      isOpen: Sandboxing.isOpen\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      behaviours: augment(detail.inlineBehaviours, [Sandboxing.config({\n        isPartOf: function (sandbox, data, queryElem) {\n          return isPartOf$1(data, queryElem) || isPartOfRelated(sandbox, queryElem);\n        },\n        getAttachPoint: function (sandbox) {\n          return detail.lazySink(sandbox).getOrDie();\n        },\n        onOpen: function (sandbox) {\n          detail.onShow(sandbox);\n        },\n        onClose: function (sandbox) {\n          detail.onHide(sandbox);\n        }\n      }), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: Optional.none()\n        }\n      }), Receiving.config({\n        channels: __assign(__assign({}, receivingChannel$1(__assign({\n          isExtraPart: spec.isExtraPart\n        }, detail.fireDismissalEventInstead.map(function (fe) {\n          return {\n            fireEventInstead: {\n              event: fe.event\n            }\n          };\n        }).getOr({})))), receivingChannel(__assign(__assign({}, detail.fireRepositionEventInstead.map(function (fe) {\n          return {\n            fireEventInstead: {\n              event: fe.event\n            }\n          };\n        }).getOr({})), {\n          doReposition: reposition\n        })))\n      })]),\n      eventOrder: detail.eventOrder,\n      apis: apis\n    };\n  };\n\n  var InlineView = single({\n    name: 'InlineView',\n    configFields: [required$1('lazySink'), onHandler('onShow'), onHandler('onHide'), optionFunction('onEscape'), field('inlineBehaviours', [Sandboxing, Representing, Receiving]), optionObjOf('fireDismissalEventInstead', [defaulted('event', dismissRequested())]), optionObjOf('fireRepositionEventInstead', [defaulted('event', repositionRequested())]), defaulted('getRelated', Optional.none), defaulted('isExtraPart', never), defaulted('eventOrder', Optional.none)],\n    factory: factory$m,\n    apis: {\n      showAt: function (apis, component, anchor, thing) {\n        apis.showAt(component, anchor, thing);\n      },\n      showWithin: function (apis, component, anchor, thing, boxElement) {\n        apis.showWithin(component, anchor, thing, boxElement);\n      },\n      showWithinBounds: function (apis, component, anchor, thing, bounds) {\n        apis.showWithinBounds(component, anchor, thing, bounds);\n      },\n      showMenuAt: function (apis, component, anchor, menuSpec) {\n        apis.showMenuAt(component, anchor, menuSpec);\n      },\n      showMenuWithinBounds: function (apis, component, anchor, menuSpec, bounds) {\n        apis.showMenuWithinBounds(component, anchor, menuSpec, bounds);\n      },\n      hide: function (apis, component) {\n        apis.hide(component);\n      },\n      isOpen: function (apis, component) {\n        return apis.isOpen(component);\n      },\n      getContent: function (apis, component) {\n        return apis.getContent(component);\n      },\n      setContent: function (apis, component, thing) {\n        apis.setContent(component, thing);\n      },\n      reposition: function (apis, component) {\n        apis.reposition(component);\n      }\n    }\n  });\n  var labelPrefix = 'layout-inset';\n\n  var westEdgeX = function (anchor) {\n    return anchor.x;\n  };\n\n  var middleX = function (anchor, element) {\n    return anchor.x + anchor.width / 2 - element.width / 2;\n  };\n\n  var eastEdgeX = function (anchor, element) {\n    return anchor.x + anchor.width - element.width;\n  };\n\n  var northY = function (anchor) {\n    return anchor.y;\n  };\n\n  var southY = function (anchor, element) {\n    return anchor.y + anchor.height - element.height;\n  };\n\n  var centreY = function (anchor, element) {\n    return anchor.y + anchor.height / 2 - element.height / 2;\n  };\n\n  var southwest = function (anchor, element, bubbles) {\n    return nu$6(eastEdgeX(anchor, element), southY(anchor, element), bubbles.insetSouthwest(), northwest$3(), 'southwest', boundsRestriction(anchor, {\n      right: 0,\n      bottom: 3\n    }), labelPrefix);\n  };\n\n  var southeast = function (anchor, element, bubbles) {\n    return nu$6(westEdgeX(anchor), southY(anchor, element), bubbles.insetSoutheast(), northeast$3(), 'southeast', boundsRestriction(anchor, {\n      left: 1,\n      bottom: 3\n    }), labelPrefix);\n  };\n\n  var northwest = function (anchor, element, bubbles) {\n    return nu$6(eastEdgeX(anchor, element), northY(anchor), bubbles.insetNorthwest(), southwest$3(), 'northwest', boundsRestriction(anchor, {\n      right: 0,\n      top: 2\n    }), labelPrefix);\n  };\n\n  var northeast = function (anchor, element, bubbles) {\n    return nu$6(westEdgeX(anchor), northY(anchor), bubbles.insetNortheast(), southeast$3(), 'northeast', boundsRestriction(anchor, {\n      left: 1,\n      top: 2\n    }), labelPrefix);\n  };\n\n  var north = function (anchor, element, bubbles) {\n    return nu$6(middleX(anchor, element), northY(anchor), bubbles.insetNorth(), south$3(), 'north', boundsRestriction(anchor, {\n      top: 2\n    }), labelPrefix);\n  };\n\n  var south = function (anchor, element, bubbles) {\n    return nu$6(middleX(anchor, element), southY(anchor, element), bubbles.insetSouth(), north$3(), 'south', boundsRestriction(anchor, {\n      bottom: 3\n    }), labelPrefix);\n  };\n\n  var east = function (anchor, element, bubbles) {\n    return nu$6(eastEdgeX(anchor, element), centreY(anchor, element), bubbles.insetEast(), west$3(), 'east', boundsRestriction(anchor, {\n      right: 0\n    }), labelPrefix);\n  };\n\n  var west = function (anchor, element, bubbles) {\n    return nu$6(westEdgeX(anchor), centreY(anchor, element), bubbles.insetWest(), east$3(), 'west', boundsRestriction(anchor, {\n      left: 1\n    }), labelPrefix);\n  };\n\n  var lookupPreserveLayout = function (lastPlacement) {\n    switch (lastPlacement) {\n      case 'north':\n        return north;\n\n      case 'northeast':\n        return northeast;\n\n      case 'northwest':\n        return northwest;\n\n      case 'south':\n        return south;\n\n      case 'southeast':\n        return southeast;\n\n      case 'southwest':\n        return southwest;\n\n      case 'east':\n        return east;\n\n      case 'west':\n        return west;\n    }\n  };\n\n  var preserve = function (anchor, element, bubbles, placee, bounds) {\n    var layout = getPlacement(placee).map(lookupPreserveLayout).getOr(north);\n    return layout(anchor, element, bubbles, placee, bounds);\n  };\n\n  var lookupFlippedLayout = function (lastPlacement) {\n    switch (lastPlacement) {\n      case 'north':\n        return south;\n\n      case 'northeast':\n        return southeast;\n\n      case 'northwest':\n        return southwest;\n\n      case 'south':\n        return north;\n\n      case 'southeast':\n        return northeast;\n\n      case 'southwest':\n        return northwest;\n\n      case 'east':\n        return west;\n\n      case 'west':\n        return east;\n    }\n  };\n\n  var flip$2 = function (anchor, element, bubbles, placee, bounds) {\n    var layout = getPlacement(placee).map(lookupFlippedLayout).getOr(north);\n    return layout(anchor, element, bubbles, placee, bounds);\n  };\n\n  var global$f = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n  var factory$l = function (detail) {\n    var events = events$a(detail.action);\n    var tag = detail.dom.tag;\n\n    var lookupAttr = function (attr) {\n      return get$e(detail.dom, 'attributes').bind(function (attrs) {\n        return get$e(attrs, attr);\n      });\n    };\n\n    var getModAttributes = function () {\n      if (tag === 'button') {\n        var type = lookupAttr('type').getOr('button');\n        var roleAttrs = lookupAttr('role').map(function (role) {\n          return {\n            role: role\n          };\n        }).getOr({});\n        return __assign({\n          type: type\n        }, roleAttrs);\n      } else {\n        var role = lookupAttr('role').getOr('button');\n        return {\n          role: role\n        };\n      }\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: detail.components,\n      events: events,\n      behaviours: SketchBehaviours.augment(detail.buttonBehaviours, [Focusing.config({}), Keying.config({\n        mode: 'execution',\n        useSpace: true,\n        useEnter: true\n      })]),\n      domModification: {\n        attributes: getModAttributes()\n      },\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var Button = single({\n    name: 'Button',\n    factory: factory$l,\n    configFields: [defaulted('uid', undefined), required$1('dom'), defaulted('components', []), SketchBehaviours.field('buttonBehaviours', [Focusing, Keying]), option('action'), option('role'), defaulted('eventOrder', {})]\n  });\n\n  var record = function (spec) {\n    var uid = isSketchSpec(spec) && hasNonNullableKey(spec, 'uid') ? spec.uid : generate$5('memento');\n\n    var get = function (anyInSystem) {\n      return anyInSystem.getSystem().getByUid(uid).getOrDie();\n    };\n\n    var getOpt = function (anyInSystem) {\n      return anyInSystem.getSystem().getByUid(uid).toOptional();\n    };\n\n    var asSpec = function () {\n      return __assign(__assign({}, spec), {\n        uid: uid\n      });\n    };\n\n    return {\n      get: get,\n      getOpt: getOpt,\n      asSpec: asSpec\n    };\n  };\n\n  var global$e = tinymce.util.Tools.resolve('tinymce.util.I18n');\n  var rtlTransform = {\n    'indent': true,\n    'outdent': true,\n    'table-insert-column-after': true,\n    'table-insert-column-before': true,\n    'paste-column-after': true,\n    'paste-column-before': true,\n    'unordered-list': true,\n    'list-bull-circle': true,\n    'list-bull-default': true,\n    'list-bull-square': true\n  };\n  var defaultIconName = 'temporary-placeholder';\n\n  var defaultIcon = function (icons) {\n    return function () {\n      return get$e(icons, defaultIconName).getOr('!not found!');\n    };\n  };\n\n  var getIconName = function (name, icons) {\n    var lcName = name.toLowerCase();\n\n    if (global$e.isRtl()) {\n      var rtlName = ensureTrailing(lcName, '-rtl');\n      return has$2(icons, rtlName) ? rtlName : lcName;\n    } else {\n      return lcName;\n    }\n  };\n\n  var lookupIcon = function (name, icons) {\n    return get$e(icons, getIconName(name, icons));\n  };\n\n  var get$1 = function (name, iconProvider) {\n    var icons = iconProvider();\n    return lookupIcon(name, icons).getOrThunk(defaultIcon(icons));\n  };\n\n  var getOr = function (name, iconProvider, fallbackIcon) {\n    var icons = iconProvider();\n    return lookupIcon(name, icons).or(fallbackIcon).getOrThunk(defaultIcon(icons));\n  };\n\n  var needsRtlTransform = function (iconName) {\n    return global$e.isRtl() ? has$2(rtlTransform, iconName) : false;\n  };\n\n  var addFocusableBehaviour = function () {\n    return config('add-focusable', [runOnAttached(function (comp) {\n      child(comp.element, 'svg').each(function (svg) {\n        return set$8(svg, 'focusable', 'false');\n      });\n    })]);\n  };\n\n  var renderIcon$2 = function (spec, iconName, icons, fallbackIcon) {\n    var _a, _b;\n\n    var rtlIconClasses = needsRtlTransform(iconName) ? ['tox-icon--flip'] : [];\n    var iconHtml = get$e(icons, getIconName(iconName, icons)).or(fallbackIcon).getOrThunk(defaultIcon(icons));\n    return {\n      dom: {\n        tag: spec.tag,\n        attributes: (_a = spec.attributes) !== null && _a !== void 0 ? _a : {},\n        classes: spec.classes.concat(rtlIconClasses),\n        innerHtml: iconHtml\n      },\n      behaviours: derive$1(__spreadArray(__spreadArray([], (_b = spec.behaviours) !== null && _b !== void 0 ? _b : [], true), [addFocusableBehaviour()], false))\n    };\n  };\n\n  var render$3 = function (iconName, spec, iconProvider, fallbackIcon) {\n    if (fallbackIcon === void 0) {\n      fallbackIcon = Optional.none();\n    }\n\n    return renderIcon$2(spec, iconName, iconProvider(), fallbackIcon);\n  };\n\n  var renderFirst = function (iconNames, spec, iconProvider) {\n    var icons = iconProvider();\n    var iconName = find$5(iconNames, function (name) {\n      return has$2(icons, getIconName(name, icons));\n    });\n    return renderIcon$2(spec, iconName.getOr(defaultIconName), icons, Optional.none());\n  };\n\n  var notificationIconMap = {\n    success: 'checkmark',\n    error: 'warning',\n    err: 'error',\n    warning: 'warning',\n    warn: 'warning',\n    info: 'info'\n  };\n\n  var factory$k = function (detail) {\n    var memBannerText = record({\n      dom: {\n        tag: 'p',\n        innerHtml: detail.translationProvider(detail.text)\n      },\n      behaviours: derive$1([Replacing.config({})])\n    });\n\n    var renderPercentBar = function (percent) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-bar'],\n          attributes: {\n            style: 'width: ' + percent + '%'\n          }\n        }\n      };\n    };\n\n    var renderPercentText = function (percent) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-text'],\n          innerHtml: percent + '%'\n        }\n      };\n    };\n\n    var memBannerProgress = record({\n      dom: {\n        tag: 'div',\n        classes: detail.progress ? ['tox-progress-bar', 'tox-progress-indicator'] : ['tox-progress-bar']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-bar-container']\n        },\n        components: [renderPercentBar(0)]\n      }, renderPercentText(0)],\n      behaviours: derive$1([Replacing.config({})])\n    });\n\n    var updateProgress = function (comp, percent) {\n      if (comp.getSystem().isConnected()) {\n        memBannerProgress.getOpt(comp).each(function (progress) {\n          Replacing.set(progress, [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-bar-container']\n            },\n            components: [renderPercentBar(percent)]\n          }, renderPercentText(percent)]);\n        });\n      }\n    };\n\n    var updateText = function (comp, text$1) {\n      if (comp.getSystem().isConnected()) {\n        var banner = memBannerText.get(comp);\n        Replacing.set(banner, [text(text$1)]);\n      }\n    };\n\n    var apis = {\n      updateProgress: updateProgress,\n      updateText: updateText\n    };\n    var iconChoices = flatten([detail.icon.toArray(), detail.level.toArray(), detail.level.bind(function (level) {\n      return Optional.from(notificationIconMap[level]);\n    }).toArray()]);\n    var memButton = record(Button.sketch({\n      dom: {\n        tag: 'button',\n        classes: ['tox-notification__dismiss', 'tox-button', 'tox-button--naked', 'tox-button--icon']\n      },\n      components: [render$3('close', {\n        tag: 'div',\n        classes: ['tox-icon'],\n        attributes: {\n          'aria-label': detail.translationProvider('Close')\n        }\n      }, detail.iconProvider)],\n      action: function (comp) {\n        detail.onAction(comp);\n      }\n    }));\n    var notificationIconSpec = renderFirst(iconChoices, {\n      tag: 'div',\n      classes: ['tox-notification__icon']\n    }, detail.iconProvider);\n    var notificationBodySpec = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-notification__body']\n      },\n      components: [memBannerText.asSpec()],\n      behaviours: derive$1([Replacing.config({})])\n    };\n    var components = [notificationIconSpec, notificationBodySpec];\n    return {\n      uid: detail.uid,\n      dom: {\n        tag: 'div',\n        attributes: {\n          role: 'alert'\n        },\n        classes: detail.level.map(function (level) {\n          return ['tox-notification', 'tox-notification--in', 'tox-notification--' + level];\n        }).getOr(['tox-notification', 'tox-notification--in'])\n      },\n      behaviours: derive$1([Focusing.config({}), config('notification-events', [run$1(focusin(), function (comp) {\n        memButton.getOpt(comp).each(Focusing.focus);\n      })])]),\n      components: components.concat(detail.progress ? [memBannerProgress.asSpec()] : []).concat(!detail.closeButton ? [] : [memButton.asSpec()]),\n      apis: apis\n    };\n  };\n\n  var Notification = single({\n    name: 'Notification',\n    factory: factory$k,\n    configFields: [option('level'), required$1('progress'), required$1('icon'), required$1('onAction'), required$1('text'), required$1('iconProvider'), required$1('translationProvider'), defaultedBoolean('closeButton', true)],\n    apis: {\n      updateProgress: function (apis, comp, percent) {\n        apis.updateProgress(comp, percent);\n      },\n      updateText: function (apis, comp, text) {\n        apis.updateText(comp, text);\n      }\n    }\n  });\n\n  function NotificationManagerImpl(editor, extras, uiMothership) {\n    var sharedBackstage = extras.backstage.shared;\n\n    var getLayoutDirection = function (rel) {\n      switch (rel) {\n        case 'bc-bc':\n          return south;\n\n        case 'tc-tc':\n          return north;\n\n        case 'tc-bc':\n          return north$2;\n\n        case 'bc-tc':\n        default:\n          return south$2;\n      }\n    };\n\n    var reposition = function (notifications) {\n      if (notifications.length > 0) {\n        each$1(notifications, function (notification, index) {\n          if (index === 0) {\n            notification.moveRel(null, 'banner');\n          } else {\n            notification.moveRel(notifications[index - 1].getEl(), 'bc-tc');\n          }\n        });\n      }\n    };\n\n    var open = function (settings, closeCallback) {\n      var hideCloseButton = !settings.closeButton && settings.timeout && (settings.timeout > 0 || settings.timeout < 0);\n\n      var close = function () {\n        closeCallback();\n        InlineView.hide(notificationWrapper);\n      };\n\n      var notification = build$1(Notification.sketch({\n        text: settings.text,\n        level: contains$2(['success', 'error', 'warning', 'warn', 'info'], settings.type) ? settings.type : undefined,\n        progress: settings.progressBar === true,\n        icon: Optional.from(settings.icon),\n        closeButton: !hideCloseButton,\n        onAction: close,\n        iconProvider: sharedBackstage.providers.icons,\n        translationProvider: sharedBackstage.providers.translate\n      }));\n      var notificationWrapper = build$1(InlineView.sketch(__assign({\n        dom: {\n          tag: 'div',\n          classes: ['tox-notifications-container']\n        },\n        lazySink: sharedBackstage.getSink,\n        fireDismissalEventInstead: {}\n      }, sharedBackstage.header.isPositionedAtTop() ? {} : {\n        fireRepositionEventInstead: {}\n      })));\n      uiMothership.add(notificationWrapper);\n\n      if (settings.timeout > 0) {\n        global$f.setTimeout(function () {\n          close();\n        }, settings.timeout);\n      }\n\n      var getBounds = function () {\n        var contentArea = box$1(SugarElement.fromDom(editor.getContentAreaContainer()));\n        var win$1 = win();\n        var x = clamp$1(win$1.x, contentArea.x, contentArea.right);\n        var y = clamp$1(win$1.y, contentArea.y, contentArea.bottom);\n        var right = Math.max(contentArea.right, win$1.right);\n        var bottom = Math.max(contentArea.bottom, win$1.bottom);\n        return Optional.some(bounds(x, y, right - x, bottom - y));\n      };\n\n      return {\n        close: close,\n        moveTo: function (x, y) {\n          InlineView.showAt(notificationWrapper, premade(notification), {\n            anchor: {\n              type: 'makeshift',\n              x: x,\n              y: y\n            }\n          });\n        },\n        moveRel: function (element, rel) {\n          var notificationSpec = premade(notification);\n          var anchorOverrides = {\n            maxHeightFunction: expandable$1()\n          };\n\n          if (rel !== 'banner' && isNonNullable(element)) {\n            var layoutDirection_1 = getLayoutDirection(rel);\n            var nodeAnchor = {\n              type: 'node',\n              root: body(),\n              node: Optional.some(SugarElement.fromDom(element)),\n              overrides: anchorOverrides,\n              layouts: {\n                onRtl: function () {\n                  return [layoutDirection_1];\n                },\n                onLtr: function () {\n                  return [layoutDirection_1];\n                }\n              }\n            };\n            InlineView.showWithinBounds(notificationWrapper, notificationSpec, {\n              anchor: nodeAnchor\n            }, getBounds);\n          } else {\n            var anchor = __assign(__assign({}, sharedBackstage.anchors.banner()), {\n              overrides: anchorOverrides\n            });\n\n            InlineView.showWithinBounds(notificationWrapper, notificationSpec, {\n              anchor: anchor\n            }, getBounds);\n          }\n        },\n        text: function (nuText) {\n          Notification.updateText(notification, nuText);\n        },\n        settings: settings,\n        getEl: function () {\n          return notification.element.dom;\n        },\n        progressBar: {\n          value: function (percent) {\n            Notification.updateProgress(notification, percent);\n          }\n        }\n      };\n    };\n\n    var close = function (notification) {\n      notification.close();\n    };\n\n    var getArgs = function (notification) {\n      return notification.settings;\n    };\n\n    return {\n      open: open,\n      close: close,\n      reposition: reposition,\n      getArgs: getArgs\n    };\n  }\n\n  var first = function (fn, rate) {\n    var timer = null;\n\n    var cancel = function () {\n      if (!isNull(timer)) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (isNull(timer)) {\n        timer = setTimeout(function () {\n          timer = null;\n          fn.apply(null, args);\n        }, rate);\n      }\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  var last = function (fn, rate) {\n    var timer = null;\n\n    var cancel = function () {\n      if (!isNull(timer)) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      cancel();\n      timer = setTimeout(function () {\n        timer = null;\n        fn.apply(null, args);\n      }, rate);\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  var global$d = tinymce.util.Tools.resolve('tinymce.dom.TextSeeker');\n\n  var isBoundary = function (dom, node) {\n    return dom.isBlock(node) || contains$2(['BR', 'IMG', 'HR', 'INPUT'], node.nodeName) || dom.getContentEditable(node) === 'false';\n  };\n\n  var repeatLeft = function (dom, node, offset, process, rootNode) {\n    var search = global$d(dom, function (node) {\n      return isBoundary(dom, node);\n    });\n    return Optional.from(search.backwards(node, offset, process, rootNode));\n  };\n\n  var autocompleteSelector = '[data-mce-autocompleter]';\n\n  var create$4 = function (editor, range) {\n    return detect(SugarElement.fromDom(editor.selection.getNode())).getOrThunk(function () {\n      var wrapper = SugarElement.fromHtml('<span data-mce-autocompleter=\"1\" data-mce-bogus=\"1\"></span>', editor.getDoc());\n      append$2(wrapper, SugarElement.fromDom(range.extractContents()));\n      range.insertNode(wrapper.dom);\n      parent(wrapper).each(function (elm) {\n        return elm.dom.normalize();\n      });\n      last$1(wrapper).map(function (last) {\n        editor.selection.setCursorLocation(last.dom, getEnd(last));\n      });\n      return wrapper;\n    });\n  };\n\n  var detect = function (elm) {\n    return closest$1(elm, autocompleteSelector);\n  };\n\n  var isValidTextRange = function (rng) {\n    return rng.collapsed && rng.startContainer.nodeType === 3;\n  };\n\n  var getText = function (rng) {\n    return rng.toString().replace(/\\u00A0/g, ' ').replace(/\\uFEFF/g, '');\n  };\n\n  var isWhitespace = function (chr) {\n    return chr !== '' && ' \\xA0\\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n  };\n\n  var stripTriggerChar = function (text, triggerCh) {\n    return text.substring(triggerCh.length);\n  };\n\n  var findChar = function (text, index, ch) {\n    var i;\n\n    for (i = index - 1; i >= 0; i--) {\n      var char = text.charAt(i);\n\n      if (isWhitespace(char)) {\n        return Optional.none();\n      }\n\n      if (char === ch) {\n        break;\n      }\n    }\n\n    return Optional.some(i);\n  };\n\n  var findStart = function (dom, initRange, ch, minChars) {\n    if (minChars === void 0) {\n      minChars = 0;\n    }\n\n    if (!isValidTextRange(initRange)) {\n      return Optional.none();\n    }\n\n    var findTriggerChIndex = function (element, offset, text) {\n      return findChar(text, offset, ch).getOr(offset);\n    };\n\n    var root = dom.getParent(initRange.startContainer, dom.isBlock) || dom.getRoot();\n    return repeatLeft(dom, initRange.startContainer, initRange.startOffset, findTriggerChIndex, root).bind(function (spot) {\n      var range = initRange.cloneRange();\n      range.setStart(spot.container, spot.offset);\n      range.setEnd(initRange.endContainer, initRange.endOffset);\n\n      if (range.collapsed) {\n        return Optional.none();\n      }\n\n      var text = getText(range);\n      var triggerCharIndex = text.lastIndexOf(ch);\n\n      if (triggerCharIndex !== 0 || stripTriggerChar(text, ch).length < minChars) {\n        return Optional.none();\n      } else {\n        return Optional.some({\n          text: stripTriggerChar(text, ch),\n          range: range,\n          triggerChar: ch\n        });\n      }\n    });\n  };\n\n  var getContext = function (dom, initRange, ch, minChars) {\n    if (minChars === void 0) {\n      minChars = 0;\n    }\n\n    return detect(SugarElement.fromDom(initRange.startContainer)).fold(function () {\n      return findStart(dom, initRange, ch, minChars);\n    }, function (elm) {\n      var range = dom.createRng();\n      range.selectNode(elm.dom);\n      var text = getText(range);\n      return Optional.some({\n        range: range,\n        text: stripTriggerChar(text, ch),\n        triggerChar: ch\n      });\n    });\n  };\n\n  var setup$e = function (api, editor) {\n    editor.on('keypress compositionend', api.onKeypress.throttle);\n    editor.on('remove', api.onKeypress.cancel);\n\n    var redirectKeyToItem = function (item, e) {\n      emitWith(item, keydown(), {\n        raw: e\n      });\n    };\n\n    editor.on('keydown', function (e) {\n      var getItem = function () {\n        return api.getView().bind(Highlighting.getHighlighted);\n      };\n\n      if (e.which === 8) {\n        api.onKeypress.throttle(e);\n      }\n\n      if (api.isActive()) {\n        if (e.which === 27) {\n          api.cancelIfNecessary();\n        }\n\n        if (api.isMenuOpen()) {\n          if (e.which === 13) {\n            getItem().each(emitExecute);\n            e.preventDefault();\n          } else if (e.which === 40) {\n            getItem().fold(function () {\n              api.getView().each(Highlighting.highlightFirst);\n            }, function (item) {\n              redirectKeyToItem(item, e);\n            });\n            e.preventDefault();\n            e.stopImmediatePropagation();\n          } else if (e.which === 37 || e.which === 38 || e.which === 39) {\n            getItem().each(function (item) {\n              redirectKeyToItem(item, e);\n              e.preventDefault();\n              e.stopImmediatePropagation();\n            });\n          }\n        } else {\n          if (e.which === 13 || e.which === 38 || e.which === 40) {\n            api.cancelIfNecessary();\n          }\n        }\n      }\n    });\n    editor.on('NodeChange', function (e) {\n      if (api.isActive() && !api.isProcessingAction() && detect(SugarElement.fromDom(e.element)).isNone()) {\n        api.cancelIfNecessary();\n      }\n    });\n  };\n\n  var AutocompleterEditorEvents = {\n    setup: setup$e\n  };\n  var global$c = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n  var point = function (container, offset) {\n    return {\n      container: container,\n      offset: offset\n    };\n  };\n\n  var isText = function (node) {\n    return node.nodeType === TEXT;\n  };\n\n  var isElement$1 = function (node) {\n    return node.nodeType === ELEMENT;\n  };\n\n  var toLast = function (node) {\n    if (isText(node)) {\n      return point(node, node.data.length);\n    } else {\n      var children = node.childNodes;\n      return children.length > 0 ? toLast(children[children.length - 1]) : point(node, children.length);\n    }\n  };\n\n  var toLeaf = function (node, offset) {\n    var children = node.childNodes;\n\n    if (children.length > 0 && offset < children.length) {\n      return toLeaf(children[offset], 0);\n    } else if (children.length > 0 && isElement$1(node) && children.length === offset) {\n      return toLast(children[children.length - 1]);\n    } else {\n      return point(node, offset);\n    }\n  };\n\n  var isPreviousCharContent = function (dom, leaf) {\n    return repeatLeft(dom, leaf.container, leaf.offset, function (element, offset) {\n      return offset === 0 ? -1 : offset;\n    }, dom.getRoot()).filter(function (spot) {\n      var char = spot.container.data.charAt(spot.offset - 1);\n      return !isWhitespace(char);\n    }).isSome();\n  };\n\n  var isStartOfWord = function (dom) {\n    return function (rng) {\n      var leaf = toLeaf(rng.startContainer, rng.startOffset);\n      return !isPreviousCharContent(dom, leaf);\n    };\n  };\n\n  var getTriggerContext = function (dom, initRange, database) {\n    return findMap(database.triggerChars, function (ch) {\n      return getContext(dom, initRange, ch);\n    });\n  };\n\n  var lookup$2 = function (editor, getDatabase) {\n    var database = getDatabase();\n    var rng = editor.selection.getRng();\n    return getTriggerContext(editor.dom, rng, database).bind(function (context) {\n      return lookupWithContext(editor, getDatabase, context);\n    });\n  };\n\n  var lookupWithContext = function (editor, getDatabase, context, fetchOptions) {\n    if (fetchOptions === void 0) {\n      fetchOptions = {};\n    }\n\n    var database = getDatabase();\n    var rng = editor.selection.getRng();\n    var startText = rng.startContainer.nodeValue;\n    var autocompleters = filter$2(database.lookupByChar(context.triggerChar), function (autocompleter) {\n      return context.text.length >= autocompleter.minChars && autocompleter.matches.getOrThunk(function () {\n        return isStartOfWord(editor.dom);\n      })(context.range, startText, context.text);\n    });\n\n    if (autocompleters.length === 0) {\n      return Optional.none();\n    }\n\n    var lookupData = global$c.all(map$2(autocompleters, function (ac) {\n      var fetchResult = ac.fetch(context.text, ac.maxResults, fetchOptions);\n      return fetchResult.then(function (results) {\n        return {\n          matchText: context.text,\n          items: results,\n          columns: ac.columns,\n          onAction: ac.onAction,\n          highlightOn: ac.highlightOn\n        };\n      });\n    }));\n    return Optional.some({\n      lookupData: lookupData,\n      context: context\n    });\n  };\n\n  var separatorMenuItemSchema = objOf([requiredString('type'), optionString('text')]);\n\n  var createSeparatorMenuItem = function (spec) {\n    return asRaw('separatormenuitem', separatorMenuItemSchema, spec);\n  };\n\n  var autocompleterItemSchema = objOf([defaulted('type', 'autocompleteitem'), defaulted('active', false), defaulted('disabled', false), defaulted('meta', {}), requiredString('value'), optionString('text'), optionString('icon')]);\n  var autocompleterSchema = objOf([requiredString('type'), requiredString('ch'), defaultedNumber('minChars', 1), defaulted('columns', 1), defaultedNumber('maxResults', 10), optionFunction('matches'), requiredFunction('fetch'), requiredFunction('onAction'), defaultedArrayOf('highlightOn', [], string)]);\n\n  var createSeparatorItem = function (spec) {\n    return asRaw('Autocompleter.Separator', separatorMenuItemSchema, spec);\n  };\n\n  var createAutocompleterItem = function (spec) {\n    return asRaw('Autocompleter.Item', autocompleterItemSchema, spec);\n  };\n\n  var createAutocompleter = function (spec) {\n    return asRaw('Autocompleter', autocompleterSchema, spec);\n  };\n\n  var baseToolbarButtonFields = [defaultedBoolean('disabled', false), optionString('tooltip'), optionString('icon'), optionString('text'), defaultedFunction('onSetup', function () {\n    return noop;\n  })];\n  var toolbarButtonSchema = objOf([requiredString('type'), requiredFunction('onAction')].concat(baseToolbarButtonFields));\n\n  var createToolbarButton = function (spec) {\n    return asRaw('toolbarbutton', toolbarButtonSchema, spec);\n  };\n\n  var baseToolbarToggleButtonFields = [defaultedBoolean('active', false)].concat(baseToolbarButtonFields);\n  var toggleButtonSchema = objOf(baseToolbarToggleButtonFields.concat([requiredString('type'), requiredFunction('onAction')]));\n\n  var createToggleButton = function (spec) {\n    return asRaw('ToggleButton', toggleButtonSchema, spec);\n  };\n\n  var contextBarFields = [defaultedFunction('predicate', never), defaultedStringEnum('scope', 'node', ['node', 'editor']), defaultedStringEnum('position', 'selection', ['node', 'selection', 'line'])];\n  var contextButtonFields = baseToolbarButtonFields.concat([defaulted('type', 'contextformbutton'), defaulted('primary', false), requiredFunction('onAction'), customField('original', identity$1)]);\n  var contextToggleButtonFields = baseToolbarToggleButtonFields.concat([defaulted('type', 'contextformbutton'), defaulted('primary', false), requiredFunction('onAction'), customField('original', identity$1)]);\n  var launchButtonFields = baseToolbarButtonFields.concat([defaulted('type', 'contextformbutton')]);\n  var launchToggleButtonFields = baseToolbarToggleButtonFields.concat([defaulted('type', 'contextformtogglebutton')]);\n  var toggleOrNormal = choose$1('type', {\n    contextformbutton: contextButtonFields,\n    contextformtogglebutton: contextToggleButtonFields\n  });\n  var contextFormSchema = objOf([defaulted('type', 'contextform'), defaultedFunction('initValue', constant$1('')), optionString('label'), requiredArrayOf('commands', toggleOrNormal), optionOf('launch', choose$1('type', {\n    contextformbutton: launchButtonFields,\n    contextformtogglebutton: launchToggleButtonFields\n  }))].concat(contextBarFields));\n\n  var createContextForm = function (spec) {\n    return asRaw('ContextForm', contextFormSchema, spec);\n  };\n\n  var contextToolbarSchema = objOf([defaulted('type', 'contexttoolbar'), requiredString('items')].concat(contextBarFields));\n\n  var createContextToolbar = function (spec) {\n    return asRaw('ContextToolbar', contextToolbarSchema, spec);\n  };\n\n  var stringArray = function (a) {\n    var all = {};\n    each$1(a, function (key) {\n      all[key] = {};\n    });\n    return keys(all);\n  };\n\n  var register$b = function (editor) {\n    var popups = editor.ui.registry.getAll().popups;\n    var dataset = map$1(popups, function (popup) {\n      return createAutocompleter(popup).fold(function (err) {\n        throw new Error(formatError(err));\n      }, identity$1);\n    });\n    var triggerChars = stringArray(mapToArray(dataset, function (v) {\n      return v.ch;\n    }));\n    var datasetValues = values(dataset);\n\n    var lookupByChar = function (ch) {\n      return filter$2(datasetValues, function (dv) {\n        return dv.ch === ch;\n      });\n    };\n\n    return {\n      dataset: dataset,\n      triggerChars: triggerChars,\n      lookupByChar: lookupByChar\n    };\n  };\n\n  var ItemResponse;\n\n  (function (ItemResponse) {\n    ItemResponse[ItemResponse['CLOSE_ON_EXECUTE'] = 0] = 'CLOSE_ON_EXECUTE';\n    ItemResponse[ItemResponse['BUBBLE_TO_SANDBOX'] = 1] = 'BUBBLE_TO_SANDBOX';\n  })(ItemResponse || (ItemResponse = {}));\n\n  var ItemResponse$1 = ItemResponse;\n  var navClass = 'tox-menu-nav__js';\n  var selectableClass = 'tox-collection__item';\n  var colorClass = 'tox-swatch';\n  var presetClasses = {\n    normal: navClass,\n    color: colorClass\n  };\n  var tickedClass = 'tox-collection__item--enabled';\n  var groupHeadingClass = 'tox-collection__group-heading';\n  var iconClass = 'tox-collection__item-icon';\n  var textClass = 'tox-collection__item-label';\n  var accessoryClass = 'tox-collection__item-accessory';\n  var caretClass = 'tox-collection__item-caret';\n  var checkmarkClass = 'tox-collection__item-checkmark';\n  var activeClass = 'tox-collection__item--active';\n  var containerClass = 'tox-collection__item-container';\n  var containerColumnClass = 'tox-collection__item-container--column';\n  var containerRowClass = 'tox-collection__item-container--row';\n  var containerAlignRightClass = 'tox-collection__item-container--align-right';\n  var containerAlignLeftClass = 'tox-collection__item-container--align-left';\n  var containerValignTopClass = 'tox-collection__item-container--valign-top';\n  var containerValignMiddleClass = 'tox-collection__item-container--valign-middle';\n  var containerValignBottomClass = 'tox-collection__item-container--valign-bottom';\n\n  var classForPreset = function (presets) {\n    return get$e(presetClasses, presets).getOr(navClass);\n  };\n\n  var forMenu = function (presets) {\n    if (presets === 'color') {\n      return 'tox-swatches';\n    } else {\n      return 'tox-menu';\n    }\n  };\n\n  var classes = function (presets) {\n    return {\n      backgroundMenu: 'tox-background-menu',\n      selectedMenu: 'tox-selected-menu',\n      selectedItem: 'tox-collection__item--active',\n      hasIcons: 'tox-menu--has-icons',\n      menu: forMenu(presets),\n      tieredMenu: 'tox-tiered-menu'\n    };\n  };\n\n  var markers = function (presets) {\n    var menuClasses = classes(presets);\n    return {\n      backgroundMenu: menuClasses.backgroundMenu,\n      selectedMenu: menuClasses.selectedMenu,\n      menu: menuClasses.menu,\n      selectedItem: menuClasses.selectedItem,\n      item: classForPreset(presets)\n    };\n  };\n\n  var dom$1 = function (hasIcons, columns, presets) {\n    var menuClasses = classes(presets);\n    return {\n      tag: 'div',\n      classes: flatten([[menuClasses.menu, 'tox-menu-' + columns + '-column'], hasIcons ? [menuClasses.hasIcons] : []])\n    };\n  };\n\n  var components = [Menu.parts.items({})];\n\n  var part = function (hasIcons, columns, presets) {\n    var menuClasses = classes(presets);\n    var d = {\n      tag: 'div',\n      classes: flatten([[menuClasses.tieredMenu]])\n    };\n    return {\n      dom: d,\n      markers: markers(presets)\n    };\n  };\n\n  var chunk = function (rowDom, numColumns) {\n    return function (items) {\n      var chunks = chunk$1(items, numColumns);\n      return map$2(chunks, function (c) {\n        return {\n          dom: rowDom,\n          components: c\n        };\n      });\n    };\n  };\n\n  var forSwatch = function (columns) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-menu', 'tox-swatches-menu']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-swatches']\n        },\n        components: [Menu.parts.items({\n          preprocess: columns !== 'auto' ? chunk({\n            tag: 'div',\n            classes: ['tox-swatches__row']\n          }, columns) : identity$1\n        })]\n      }]\n    };\n  };\n\n  var forToolbar = function (columns) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-menu', 'tox-collection', 'tox-collection--toolbar', 'tox-collection--toolbar-lg']\n      },\n      components: [Menu.parts.items({\n        preprocess: chunk({\n          tag: 'div',\n          classes: ['tox-collection__group']\n        }, columns)\n      })]\n    };\n  };\n\n  var preprocessCollection = function (items, isSeparator) {\n    var allSplits = [];\n    var currentSplit = [];\n    each$1(items, function (item, i) {\n      if (isSeparator(item, i)) {\n        if (currentSplit.length > 0) {\n          allSplits.push(currentSplit);\n        }\n\n        currentSplit = [];\n\n        if (has$2(item.dom, 'innerHtml')) {\n          currentSplit.push(item);\n        }\n      } else {\n        currentSplit.push(item);\n      }\n    });\n\n    if (currentSplit.length > 0) {\n      allSplits.push(currentSplit);\n    }\n\n    return map$2(allSplits, function (s) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-collection__group']\n        },\n        components: s\n      };\n    });\n  };\n\n  var forCollection = function (columns, initItems, _hasIcons) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-menu', 'tox-collection'].concat(columns === 1 ? ['tox-collection--list'] : ['tox-collection--grid'])\n      },\n      components: [Menu.parts.items({\n        preprocess: function (items) {\n          if (columns !== 'auto' && columns > 1) {\n            return chunk({\n              tag: 'div',\n              classes: ['tox-collection__group']\n            }, columns)(items);\n          } else {\n            return preprocessCollection(items, function (_item, i) {\n              return initItems[i].type === 'separator';\n            });\n          }\n        }\n      })]\n    };\n  };\n\n  var forHorizontalCollection = function (initItems, _hasIcons) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-collection', 'tox-collection--horizontal']\n      },\n      components: [Menu.parts.items({\n        preprocess: function (items) {\n          return preprocessCollection(items, function (_item, i) {\n            return initItems[i].type === 'separator';\n          });\n        }\n      })]\n    };\n  };\n\n  var menuHasIcons = function (xs) {\n    return exists(xs, function (item) {\n      return 'icon' in item && item.icon !== undefined;\n    });\n  };\n\n  var handleError = function (error) {\n    console.error(formatError(error));\n    console.log(error);\n    return Optional.none();\n  };\n\n  var createHorizontalPartialMenuWithAlloyItems = function (value, _hasIcons, items, _columns, _presets) {\n    var structure = forHorizontalCollection(items);\n    return {\n      value: value,\n      dom: structure.dom,\n      components: structure.components,\n      items: items\n    };\n  };\n\n  var createPartialMenuWithAlloyItems = function (value, hasIcons, items, columns, presets) {\n    if (presets === 'color') {\n      var structure = forSwatch(columns);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    if (presets === 'normal' && columns === 'auto') {\n      var structure = forCollection(columns, items);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    if (presets === 'normal' && columns === 1) {\n      var structure = forCollection(1, items);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    if (presets === 'normal') {\n      var structure = forCollection(columns, items);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    if (presets === 'listpreview' && columns !== 'auto') {\n      var structure = forToolbar(columns);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    return {\n      value: value,\n      dom: dom$1(hasIcons, columns, presets),\n      components: components,\n      items: items\n    };\n  };\n\n  var cardImageFields = [requiredString('type'), requiredString('src'), optionString('alt'), defaultedArrayOf('classes', [], string)];\n  var cardImageSchema = objOf(cardImageFields);\n  var cardTextFields = [requiredString('type'), requiredString('text'), optionString('name'), defaultedArrayOf('classes', ['tox-collection__item-label'], string)];\n  var cardTextSchema = objOf(cardTextFields);\n  var itemSchema$1 = valueThunk(function () {\n    return choose$2('type', {\n      cardimage: cardImageSchema,\n      cardtext: cardTextSchema,\n      cardcontainer: cardContainerSchema\n    });\n  });\n  var cardContainerSchema = objOf([requiredString('type'), defaultedString('direction', 'horizontal'), defaultedString('align', 'left'), defaultedString('valign', 'middle'), requiredArrayOf('items', itemSchema$1)]);\n  var commonMenuItemFields = [defaultedBoolean('disabled', false), optionString('text'), optionString('shortcut'), field$1('value', 'value', defaultedThunk(function () {\n    return generate$6('menuitem-value');\n  }), anyValue()), defaulted('meta', {})];\n  var cardMenuItemSchema = objOf([requiredString('type'), optionString('label'), requiredArrayOf('items', itemSchema$1), defaultedFunction('onSetup', function () {\n    return noop;\n  }), defaultedFunction('onAction', noop)].concat(commonMenuItemFields));\n\n  var createCardMenuItem = function (spec) {\n    return asRaw('cardmenuitem', cardMenuItemSchema, spec);\n  };\n\n  var choiceMenuItemSchema = objOf([requiredString('type'), defaultedBoolean('active', false), optionString('icon')].concat(commonMenuItemFields));\n\n  var createChoiceMenuItem = function (spec) {\n    return asRaw('choicemenuitem', choiceMenuItemSchema, spec);\n  };\n\n  var baseFields = [requiredString('type'), requiredString('fancytype'), defaultedFunction('onAction', noop)];\n  var insertTableFields = [defaulted('initData', {})].concat(baseFields);\n  var colorSwatchFields = [defaultedObjOf('initData', {}, [defaultedBoolean('allowCustomColors', true), optionArrayOf('colors', anyValue())])].concat(baseFields);\n  var fancyMenuItemSchema = choose$1('fancytype', {\n    inserttable: insertTableFields,\n    colorswatch: colorSwatchFields\n  });\n\n  var createFancyMenuItem = function (spec) {\n    return asRaw('fancymenuitem', fancyMenuItemSchema, spec);\n  };\n\n  var menuItemSchema = objOf([requiredString('type'), defaultedFunction('onSetup', function () {\n    return noop;\n  }), defaultedFunction('onAction', noop), optionString('icon')].concat(commonMenuItemFields));\n\n  var createMenuItem = function (spec) {\n    return asRaw('menuitem', menuItemSchema, spec);\n  };\n\n  var nestedMenuItemSchema = objOf([requiredString('type'), requiredFunction('getSubmenuItems'), defaultedFunction('onSetup', function () {\n    return noop;\n  }), optionString('icon')].concat(commonMenuItemFields));\n\n  var createNestedMenuItem = function (spec) {\n    return asRaw('nestedmenuitem', nestedMenuItemSchema, spec);\n  };\n\n  var toggleMenuItemSchema = objOf([requiredString('type'), optionString('icon'), defaultedBoolean('active', false), defaultedFunction('onSetup', function () {\n    return noop;\n  }), requiredFunction('onAction')].concat(commonMenuItemFields));\n\n  var createToggleMenuItem = function (spec) {\n    return asRaw('togglemenuitem', toggleMenuItemSchema, spec);\n  };\n\n  var detectSize = function (comp, margin, selectorClass) {\n    var descendants$1 = descendants(comp.element, '.' + selectorClass);\n\n    if (descendants$1.length > 0) {\n      var columnLength = findIndex$1(descendants$1, function (c) {\n        var thisTop = c.dom.getBoundingClientRect().top;\n        var cTop = descendants$1[0].dom.getBoundingClientRect().top;\n        return Math.abs(thisTop - cTop) > margin;\n      }).getOr(descendants$1.length);\n      return Optional.some({\n        numColumns: columnLength,\n        numRows: Math.ceil(descendants$1.length / columnLength)\n      });\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var namedEvents = function (name, handlers) {\n    return derive$1([config(name, handlers)]);\n  };\n\n  var unnamedEvents = function (handlers) {\n    return namedEvents(generate$6('unnamed-events'), handlers);\n  };\n\n  var SimpleBehaviours = {\n    namedEvents: namedEvents,\n    unnamedEvents: unnamedEvents\n  };\n  var ExclusivityChannel = generate$6('tooltip.exclusive');\n  var ShowTooltipEvent = generate$6('tooltip.show');\n  var HideTooltipEvent = generate$6('tooltip.hide');\n\n  var hideAllExclusive = function (component, _tConfig, _tState) {\n    component.getSystem().broadcastOn([ExclusivityChannel], {});\n  };\n\n  var setComponents = function (component, tConfig, tState, specs) {\n    tState.getTooltip().each(function (tooltip) {\n      if (tooltip.getSystem().isConnected()) {\n        Replacing.set(tooltip, specs);\n      }\n    });\n  };\n\n  var TooltippingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    hideAllExclusive: hideAllExclusive,\n    setComponents: setComponents\n  });\n\n  var events$9 = function (tooltipConfig, state) {\n    var hide = function (comp) {\n      state.getTooltip().each(function (p) {\n        detach(p);\n        tooltipConfig.onHide(comp, p);\n        state.clearTooltip();\n      });\n      state.clearTimer();\n    };\n\n    var show = function (comp) {\n      if (!state.isShowing()) {\n        hideAllExclusive(comp);\n        var sink = tooltipConfig.lazySink(comp).getOrDie();\n        var popup = comp.getSystem().build({\n          dom: tooltipConfig.tooltipDom,\n          components: tooltipConfig.tooltipComponents,\n          events: derive$2(tooltipConfig.mode === 'normal' ? [run$1(mouseover(), function (_) {\n            emit(comp, ShowTooltipEvent);\n          }), run$1(mouseout(), function (_) {\n            emit(comp, HideTooltipEvent);\n          })] : []),\n          behaviours: derive$1([Replacing.config({})])\n        });\n        state.setTooltip(popup);\n        attach(sink, popup);\n        tooltipConfig.onShow(comp, popup);\n        Positioning.position(sink, popup, {\n          anchor: tooltipConfig.anchor(comp)\n        });\n      }\n    };\n\n    return derive$2(flatten([[run$1(ShowTooltipEvent, function (comp) {\n      state.resetTimer(function () {\n        show(comp);\n      }, tooltipConfig.delay);\n    }), run$1(HideTooltipEvent, function (comp) {\n      state.resetTimer(function () {\n        hide(comp);\n      }, tooltipConfig.delay);\n    }), run$1(receive(), function (comp, message) {\n      var receivingData = message;\n\n      if (!receivingData.universal) {\n        if (contains$2(receivingData.channels, ExclusivityChannel)) {\n          hide(comp);\n        }\n      }\n    }), runOnDetached(function (comp) {\n      hide(comp);\n    })], tooltipConfig.mode === 'normal' ? [run$1(focusin(), function (comp) {\n      emit(comp, ShowTooltipEvent);\n    }), run$1(postBlur(), function (comp) {\n      emit(comp, HideTooltipEvent);\n    }), run$1(mouseover(), function (comp) {\n      emit(comp, ShowTooltipEvent);\n    }), run$1(mouseout(), function (comp) {\n      emit(comp, HideTooltipEvent);\n    })] : [run$1(highlight$1(), function (comp, _se) {\n      emit(comp, ShowTooltipEvent);\n    }), run$1(dehighlight$1(), function (comp) {\n      emit(comp, HideTooltipEvent);\n    })]]));\n  };\n\n  var ActiveTooltipping = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$9\n  });\n  var TooltippingSchema = [required$1('lazySink'), required$1('tooltipDom'), defaulted('exclusive', true), defaulted('tooltipComponents', []), defaulted('delay', 300), defaultedStringEnum('mode', 'normal', ['normal', 'follow-highlight']), defaulted('anchor', function (comp) {\n    return {\n      type: 'hotspot',\n      hotspot: comp,\n      layouts: {\n        onLtr: constant$1([south$2, north$2, southeast$2, northeast$2, southwest$2, northwest$2]),\n        onRtl: constant$1([south$2, north$2, southeast$2, northeast$2, southwest$2, northwest$2])\n      }\n    };\n  }), onHandler('onHide'), onHandler('onShow')];\n\n  var init$b = function () {\n    var timer = value$1();\n    var popup = value$1();\n\n    var clearTimer = function () {\n      timer.on(clearTimeout);\n    };\n\n    var resetTimer = function (f, delay) {\n      clearTimer();\n      timer.set(setTimeout(f, delay));\n    };\n\n    var readState = constant$1('not-implemented');\n    return nu$8({\n      getTooltip: popup.get,\n      isShowing: popup.isSet,\n      setTooltip: popup.set,\n      clearTooltip: popup.clear,\n      clearTimer: clearTimer,\n      resetTimer: resetTimer,\n      readState: readState\n    });\n  };\n\n  var TooltippingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$b\n  });\n  var Tooltipping = create$7({\n    fields: TooltippingSchema,\n    name: 'tooltipping',\n    active: ActiveTooltipping,\n    state: TooltippingState,\n    apis: TooltippingApis\n  });\n\n  var escape = function (text) {\n    return text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n  };\n\n  var global$b = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n  var global$a = tinymce.util.Tools.resolve('tinymce.EditorManager');\n\n  var getSkinUrl = function (editor) {\n    var skin = editor.getParam('skin');\n    var skinUrl = editor.getParam('skin_url');\n\n    if (skin !== false) {\n      var skinName = skin ? skin : 'oxide';\n\n      if (skinUrl) {\n        skinUrl = editor.documentBaseURI.toAbsolute(skinUrl);\n      } else {\n        skinUrl = global$a.baseURL + '/skins/ui/' + skinName;\n      }\n    }\n\n    return skinUrl;\n  };\n\n  var isReadOnly = function (editor) {\n    return editor.getParam('readonly', false, 'boolean');\n  };\n\n  var isSkinDisabled = function (editor) {\n    return editor.getParam('skin') === false;\n  };\n\n  var getHeightSetting = function (editor) {\n    return editor.getParam('height', Math.max(editor.getElement().offsetHeight, 200));\n  };\n\n  var getWidthSetting = function (editor) {\n    return editor.getParam('width', global$b.DOM.getStyle(editor.getElement(), 'width'));\n  };\n\n  var getMinWidthSetting = function (editor) {\n    return Optional.from(editor.getParam('min_width')).filter(isNumber);\n  };\n\n  var getMinHeightSetting = function (editor) {\n    return Optional.from(editor.getParam('min_height')).filter(isNumber);\n  };\n\n  var getMaxWidthSetting = function (editor) {\n    return Optional.from(editor.getParam('max_width')).filter(isNumber);\n  };\n\n  var getMaxHeightSetting = function (editor) {\n    return Optional.from(editor.getParam('max_height')).filter(isNumber);\n  };\n\n  var getUserStyleFormats = function (editor) {\n    return Optional.from(editor.getParam('style_formats')).filter(isArray);\n  };\n\n  var isMergeStyleFormats = function (editor) {\n    return editor.getParam('style_formats_merge', false, 'boolean');\n  };\n\n  var getLineHeightFormats = function (editor) {\n    return editor.getParam('lineheight_formats', '1 1.1 1.2 1.3 1.4 1.5 2', 'string').split(' ');\n  };\n\n  var getContentLanguages = function (editor) {\n    return editor.getParam('content_langs', undefined, 'array');\n  };\n\n  var getRemovedMenuItems = function (editor) {\n    return editor.getParam('removed_menuitems', '');\n  };\n\n  var isMenubarEnabled = function (editor) {\n    return editor.getParam('menubar', true, 'boolean') !== false;\n  };\n\n  var isToolbarEnabled = function (editor) {\n    var toolbar = editor.getParam('toolbar', true);\n    var isToolbarTrue = toolbar === true;\n    var isToolbarString = isString(toolbar);\n    var isToolbarObjectArray = isArray(toolbar) && toolbar.length > 0;\n    return !isMultipleToolbars(editor) && (isToolbarObjectArray || isToolbarString || isToolbarTrue);\n  };\n\n  var getMultipleToolbarsSetting = function (editor) {\n    var toolbars = range$2(9, function (num) {\n      return editor.getParam('toolbar' + (num + 1), false, 'string');\n    });\n    var toolbarArray = filter$2(toolbars, function (toolbar) {\n      return typeof toolbar === 'string';\n    });\n    return toolbarArray.length > 0 ? Optional.some(toolbarArray) : Optional.none();\n  };\n\n  var isMultipleToolbars = function (editor) {\n    return getMultipleToolbarsSetting(editor).fold(function () {\n      var toolbar = editor.getParam('toolbar', [], 'string[]');\n      return toolbar.length > 0;\n    }, always);\n  };\n\n  var ToolbarMode;\n\n  (function (ToolbarMode) {\n    ToolbarMode['default'] = 'wrap';\n    ToolbarMode['floating'] = 'floating';\n    ToolbarMode['sliding'] = 'sliding';\n    ToolbarMode['scrolling'] = 'scrolling';\n  })(ToolbarMode || (ToolbarMode = {}));\n\n  var getToolbarMode = function (editor) {\n    return editor.getParam('toolbar_mode', '', 'string');\n  };\n\n  var ToolbarLocation;\n\n  (function (ToolbarLocation) {\n    ToolbarLocation['auto'] = 'auto';\n    ToolbarLocation['top'] = 'top';\n    ToolbarLocation['bottom'] = 'bottom';\n  })(ToolbarLocation || (ToolbarLocation = {}));\n\n  var getToolbarGroups = function (editor) {\n    return editor.getParam('toolbar_groups', {}, 'object');\n  };\n\n  var getToolbarLocation = function (editor) {\n    return editor.getParam('toolbar_location', ToolbarLocation.auto, 'string');\n  };\n\n  var isToolbarLocationBottom = function (editor) {\n    return getToolbarLocation(editor) === ToolbarLocation.bottom;\n  };\n\n  var fixedContainerSelector = function (editor) {\n    return editor.getParam('fixed_toolbar_container', '', 'string');\n  };\n\n  var fixedToolbarContainerTarget = function (editor) {\n    return editor.getParam('fixed_toolbar_container_target');\n  };\n\n  var isToolbarPersist = function (editor) {\n    return editor.getParam('toolbar_persist', false, 'boolean');\n  };\n\n  var fixedContainerTarget = function (editor) {\n    if (!editor.inline) {\n      return Optional.none();\n    }\n\n    var selector = fixedContainerSelector(editor);\n\n    if (selector.length > 0) {\n      return descendant(body(), selector);\n    }\n\n    var element = fixedToolbarContainerTarget(editor);\n\n    if (isNonNullable(element)) {\n      return Optional.some(SugarElement.fromDom(element));\n    }\n\n    return Optional.none();\n  };\n\n  var useFixedContainer = function (editor) {\n    return editor.inline && fixedContainerTarget(editor).isSome();\n  };\n\n  var getUiContainer = function (editor) {\n    var fixedContainer = fixedContainerTarget(editor);\n    return fixedContainer.getOrThunk(function () {\n      return getContentContainer(getRootNode(SugarElement.fromDom(editor.getElement())));\n    });\n  };\n\n  var isDistractionFree = function (editor) {\n    return editor.inline && !isMenubarEnabled(editor) && !isToolbarEnabled(editor) && !isMultipleToolbars(editor);\n  };\n\n  var isStickyToolbar = function (editor) {\n    var isStickyToolbar = editor.getParam('toolbar_sticky', false, 'boolean');\n    return (isStickyToolbar || editor.inline) && !useFixedContainer(editor) && !isDistractionFree(editor);\n  };\n\n  var getStickyToolbarOffset = function (editor) {\n    return editor.getParam('toolbar_sticky_offset', 0, 'number');\n  };\n\n  var isDraggableModal$1 = function (editor) {\n    return editor.getParam('draggable_modal', false, 'boolean');\n  };\n\n  var getMenus = function (editor) {\n    var menu = editor.getParam('menu');\n\n    if (menu) {\n      return map$1(menu, function (menu) {\n        return __assign(__assign({}, menu), {\n          items: menu.items\n        });\n      });\n    } else {\n      return {};\n    }\n  };\n\n  var getMenubar = function (editor) {\n    return editor.getParam('menubar');\n  };\n\n  var getToolbar = function (editor) {\n    return editor.getParam('toolbar', true);\n  };\n\n  var getFilePickerCallback = function (editor) {\n    return editor.getParam('file_picker_callback');\n  };\n\n  var getFilePickerTypes = function (editor) {\n    return editor.getParam('file_picker_types');\n  };\n\n  var getFileBrowserCallbackTypes = function (editor) {\n    return editor.getParam('file_browser_callback_types');\n  };\n\n  var noTypeaheadUrls = function (editor) {\n    return editor.getParam('typeahead_urls') === false;\n  };\n\n  var getAnchorTop = function (editor) {\n    return editor.getParam('anchor_top', '#top');\n  };\n\n  var getAnchorBottom = function (editor) {\n    return editor.getParam('anchor_bottom', '#bottom');\n  };\n\n  var getFilePickerValidatorHandler = function (editor) {\n    var handler = editor.getParam('file_picker_validator_handler', undefined, 'function');\n\n    if (handler === undefined) {\n      return editor.getParam('filepicker_validator_handler', undefined, 'function');\n    } else {\n      return handler;\n    }\n  };\n\n  var ReadOnlyChannel = 'silver.readonly';\n  var ReadOnlyDataSchema = objOf([requiredBoolean('readonly')]);\n\n  var broadcastReadonly = function (uiComponents, readonly) {\n    var outerContainer = uiComponents.outerContainer;\n    var target = outerContainer.element;\n\n    if (readonly) {\n      uiComponents.mothership.broadcastOn([dismissPopups()], {\n        target: target\n      });\n      uiComponents.uiMothership.broadcastOn([dismissPopups()], {\n        target: target\n      });\n    }\n\n    uiComponents.mothership.broadcastOn([ReadOnlyChannel], {\n      readonly: readonly\n    });\n    uiComponents.uiMothership.broadcastOn([ReadOnlyChannel], {\n      readonly: readonly\n    });\n  };\n\n  var setupReadonlyModeSwitch = function (editor, uiComponents) {\n    editor.on('init', function () {\n      if (editor.mode.isReadOnly()) {\n        broadcastReadonly(uiComponents, true);\n      }\n    });\n    editor.on('SwitchMode', function () {\n      return broadcastReadonly(uiComponents, editor.mode.isReadOnly());\n    });\n\n    if (isReadOnly(editor)) {\n      editor.setMode('readonly');\n    }\n  };\n\n  var receivingConfig = function () {\n    var _a;\n\n    return Receiving.config({\n      channels: (_a = {}, _a[ReadOnlyChannel] = {\n        schema: ReadOnlyDataSchema,\n        onReceive: function (comp, data) {\n          Disabling.set(comp, data.readonly);\n        }\n      }, _a)\n    });\n  };\n\n  var item = function (disabled) {\n    return Disabling.config({\n      disabled: disabled,\n      disableClass: 'tox-collection__item--state-disabled'\n    });\n  };\n\n  var button = function (disabled) {\n    return Disabling.config({\n      disabled: disabled\n    });\n  };\n\n  var splitButton = function (disabled) {\n    return Disabling.config({\n      disabled: disabled,\n      disableClass: 'tox-tbtn--disabled'\n    });\n  };\n\n  var toolbarButton = function (disabled) {\n    return Disabling.config({\n      disabled: disabled,\n      disableClass: 'tox-tbtn--disabled',\n      useNative: false\n    });\n  };\n\n  var DisablingConfigs = {\n    item: item,\n    button: button,\n    splitButton: splitButton,\n    toolbarButton: toolbarButton\n  };\n\n  var runWithApi = function (info, comp) {\n    var api = info.getApi(comp);\n    return function (f) {\n      f(api);\n    };\n  };\n\n  var onControlAttached = function (info, editorOffCell) {\n    return runOnAttached(function (comp) {\n      var run = runWithApi(info, comp);\n      run(function (api) {\n        var onDestroy = info.onSetup(api);\n\n        if (isFunction(onDestroy)) {\n          editorOffCell.set(onDestroy);\n        }\n      });\n    });\n  };\n\n  var onControlDetached = function (getApi, editorOffCell) {\n    return runOnDetached(function (comp) {\n      return runWithApi(getApi, comp)(editorOffCell.get());\n    });\n  };\n\n  var _a$1;\n\n  var onMenuItemExecute = function (info, itemResponse) {\n    return runOnExecute$1(function (comp, simulatedEvent) {\n      runWithApi(info, comp)(info.onAction);\n\n      if (!info.triggersSubmenu && itemResponse === ItemResponse$1.CLOSE_ON_EXECUTE) {\n        emit(comp, sandboxClose());\n        simulatedEvent.stop();\n      }\n    });\n  };\n\n  var menuItemEventOrder = (_a$1 = {}, _a$1[execute$5()] = ['disabling', 'alloy.base.behaviour', 'toggling', 'item-events'], _a$1);\n  var componentRenderPipeline = cat;\n\n  var renderCommonItem = function (spec, structure, itemResponse, providersbackstage) {\n    var editorOffCell = Cell(noop);\n    return {\n      type: 'item',\n      dom: structure.dom,\n      components: componentRenderPipeline(structure.optComponents),\n      data: spec.data,\n      eventOrder: menuItemEventOrder,\n      hasSubmenu: spec.triggersSubmenu,\n      itemBehaviours: derive$1([config('item-events', [onMenuItemExecute(spec, itemResponse), onControlAttached(spec, editorOffCell), onControlDetached(spec, editorOffCell)]), DisablingConfigs.item(function () {\n        return spec.disabled || providersbackstage.isDisabled();\n      }), receivingConfig(), Replacing.config({})].concat(spec.itemBehaviours))\n    };\n  };\n\n  var buildData = function (source) {\n    return {\n      value: source.value,\n      meta: __assign({\n        text: source.text.getOr('')\n      }, source.meta)\n    };\n  };\n\n  var global$9 = tinymce.util.Tools.resolve('tinymce.Env');\n\n  var convertText = function (source) {\n    var mac = {\n      alt: '&#x2325;',\n      ctrl: '&#x2303;',\n      shift: '&#x21E7;',\n      meta: '&#x2318;',\n      access: '&#x2303;&#x2325;'\n    };\n    var other = {\n      meta: 'Ctrl',\n      access: 'Shift+Alt'\n    };\n    var replace = global$9.mac ? mac : other;\n    var shortcut = source.split('+');\n    var updated = map$2(shortcut, function (segment) {\n      var search = segment.toLowerCase().trim();\n      return has$2(replace, search) ? replace[search] : segment;\n    });\n    return global$9.mac ? updated.join('') : updated.join('+');\n  };\n\n  var renderIcon$1 = function (name, icons, classes) {\n    if (classes === void 0) {\n      classes = [iconClass];\n    }\n\n    return render$3(name, {\n      tag: 'div',\n      classes: classes\n    }, icons);\n  };\n\n  var renderText = function (text$1) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [textClass]\n      },\n      components: [text(global$e.translate(text$1))]\n    };\n  };\n\n  var renderHtml = function (html, classes) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: classes,\n        innerHtml: html\n      }\n    };\n  };\n\n  var renderStyledText = function (style, text$1) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [textClass]\n      },\n      components: [{\n        dom: {\n          tag: style.tag,\n          styles: style.styles\n        },\n        components: [text(global$e.translate(text$1))]\n      }]\n    };\n  };\n\n  var renderShortcut = function (shortcut) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [accessoryClass],\n        innerHtml: convertText(shortcut)\n      }\n    };\n  };\n\n  var renderCheckmark = function (icons) {\n    return renderIcon$1('checkmark', icons, [checkmarkClass]);\n  };\n\n  var renderSubmenuCaret = function (icons) {\n    return renderIcon$1('chevron-right', icons, [caretClass]);\n  };\n\n  var renderDownwardsCaret = function (icons) {\n    return renderIcon$1('chevron-down', icons, [caretClass]);\n  };\n\n  var renderContainer = function (container, components) {\n    var directionClass = container.direction === 'vertical' ? containerColumnClass : containerRowClass;\n    var alignClass = container.align === 'left' ? containerAlignLeftClass : containerAlignRightClass;\n\n    var getValignClass = function () {\n      switch (container.valign) {\n        case 'top':\n          return containerValignTopClass;\n\n        case 'middle':\n          return containerValignMiddleClass;\n\n        case 'bottom':\n          return containerValignBottomClass;\n      }\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        classes: [containerClass, directionClass, alignClass, getValignClass()]\n      },\n      components: components\n    };\n  };\n\n  var renderImage = function (src, classes, alt) {\n    return {\n      dom: {\n        tag: 'img',\n        classes: classes,\n        attributes: {\n          src: src,\n          alt: alt.getOr('')\n        }\n      }\n    };\n  };\n\n  var renderColorStructure = function (item, providerBackstage, fallbackIcon) {\n    var colorPickerCommand = 'custom';\n    var removeColorCommand = 'remove';\n    var itemText = item.ariaLabel;\n    var itemValue = item.value;\n    var iconSvg = item.iconContent.map(function (name) {\n      return getOr(name, providerBackstage.icons, fallbackIcon);\n    });\n\n    var getDom = function () {\n      var common = colorClass;\n      var icon = iconSvg.getOr('');\n      var attributes = itemText.map(function (text) {\n        return {\n          title: providerBackstage.translate(text)\n        };\n      }).getOr({});\n      var baseDom = {\n        tag: 'div',\n        attributes: attributes,\n        classes: [common]\n      };\n\n      if (itemValue === colorPickerCommand) {\n        return __assign(__assign({}, baseDom), {\n          tag: 'button',\n          classes: __spreadArray(__spreadArray([], baseDom.classes, true), ['tox-swatches__picker-btn'], false),\n          innerHtml: icon\n        });\n      } else if (itemValue === removeColorCommand) {\n        return __assign(__assign({}, baseDom), {\n          classes: __spreadArray(__spreadArray([], baseDom.classes, true), ['tox-swatch--remove'], false),\n          innerHtml: icon\n        });\n      } else {\n        return __assign(__assign({}, baseDom), {\n          attributes: __assign(__assign({}, baseDom.attributes), {\n            'data-mce-color': itemValue\n          }),\n          styles: {\n            'background-color': itemValue\n          }\n        });\n      }\n    };\n\n    return {\n      dom: getDom(),\n      optComponents: []\n    };\n  };\n\n  var renderItemDomStructure = function (ariaLabel) {\n    var domTitle = ariaLabel.map(function (label) {\n      return {\n        attributes: {\n          title: global$e.translate(label)\n        }\n      };\n    }).getOr({});\n    return __assign({\n      tag: 'div',\n      classes: [navClass, selectableClass]\n    }, domTitle);\n  };\n\n  var renderNormalItemStructure = function (info, providersBackstage, renderIcons, fallbackIcon) {\n    var iconSpec = {\n      tag: 'div',\n      classes: [iconClass]\n    };\n\n    var renderIcon = function (iconName) {\n      return render$3(iconName, iconSpec, providersBackstage.icons, fallbackIcon);\n    };\n\n    var renderEmptyIcon = function () {\n      return Optional.some({\n        dom: iconSpec\n      });\n    };\n\n    var leftIcon = renderIcons ? info.iconContent.map(renderIcon).orThunk(renderEmptyIcon) : Optional.none();\n    var checkmark = info.checkMark;\n    var textRender = Optional.from(info.meta).fold(function () {\n      return renderText;\n    }, function (meta) {\n      return has$2(meta, 'style') ? curry(renderStyledText, meta.style) : renderText;\n    });\n    var content = info.htmlContent.fold(function () {\n      return info.textContent.map(textRender);\n    }, function (html) {\n      return Optional.some(renderHtml(html, [textClass]));\n    });\n    var menuItem = {\n      dom: renderItemDomStructure(info.ariaLabel),\n      optComponents: [leftIcon, content, info.shortcutContent.map(renderShortcut), checkmark, info.caret]\n    };\n    return menuItem;\n  };\n\n  var renderItemStructure = function (info, providersBackstage, renderIcons, fallbackIcon) {\n    if (fallbackIcon === void 0) {\n      fallbackIcon = Optional.none();\n    }\n\n    if (info.presets === 'color') {\n      return renderColorStructure(info, providersBackstage, fallbackIcon);\n    } else {\n      return renderNormalItemStructure(info, providersBackstage, renderIcons, fallbackIcon);\n    }\n  };\n\n  var tooltipBehaviour = function (meta, sharedBackstage) {\n    return get$e(meta, 'tooltipWorker').map(function (tooltipWorker) {\n      return [Tooltipping.config({\n        lazySink: sharedBackstage.getSink,\n        tooltipDom: {\n          tag: 'div',\n          classes: ['tox-tooltip-worker-container']\n        },\n        tooltipComponents: [],\n        anchor: function (comp) {\n          return {\n            type: 'submenu',\n            item: comp,\n            overrides: {\n              maxHeightFunction: expandable$1\n            }\n          };\n        },\n        mode: 'follow-highlight',\n        onShow: function (component, _tooltip) {\n          tooltipWorker(function (elm) {\n            Tooltipping.setComponents(component, [external$2({\n              element: SugarElement.fromDom(elm)\n            })]);\n          });\n        }\n      })];\n    }).getOr([]);\n  };\n\n  var encodeText = function (text) {\n    return global$b.DOM.encode(text);\n  };\n\n  var replaceText = function (text, matchText) {\n    var translated = global$e.translate(text);\n    var encoded = encodeText(translated);\n\n    if (matchText.length > 0) {\n      var escapedMatchRegex = new RegExp(escape(matchText), 'gi');\n      return encoded.replace(escapedMatchRegex, function (match) {\n        return '<span class=\"tox-autocompleter-highlight\">' + match + '</span>';\n      });\n    } else {\n      return encoded;\n    }\n  };\n\n  var renderAutocompleteItem = function (spec, matchText, useText, presets, onItemValueHandler, itemResponse, sharedBackstage, renderIcons) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    var structure = renderItemStructure({\n      presets: presets,\n      textContent: Optional.none(),\n      htmlContent: useText ? spec.text.map(function (text) {\n        return replaceText(text, matchText);\n      }) : Optional.none(),\n      ariaLabel: spec.text,\n      iconContent: spec.icon,\n      shortcutContent: Optional.none(),\n      checkMark: Optional.none(),\n      caret: Optional.none(),\n      value: spec.value\n    }, sharedBackstage.providers, renderIcons, spec.icon);\n    return renderCommonItem({\n      data: buildData(spec),\n      disabled: spec.disabled,\n      getApi: constant$1({}),\n      onAction: function (_api) {\n        return onItemValueHandler(spec.value, spec.meta);\n      },\n      onSetup: constant$1(noop),\n      triggersSubmenu: false,\n      itemBehaviours: tooltipBehaviour(spec.meta, sharedBackstage)\n    }, structure, itemResponse, sharedBackstage.providers);\n  };\n\n  var render$2 = function (items, extras) {\n    return map$2(items, function (item) {\n      switch (item.type) {\n        case 'cardcontainer':\n          return renderContainer(item, render$2(item.items, extras));\n\n        case 'cardimage':\n          return renderImage(item.src, item.classes, item.alt);\n\n        case 'cardtext':\n          var shouldHighlight = item.name.exists(function (name) {\n            return contains$2(extras.cardText.highlightOn, name);\n          });\n          var matchText = shouldHighlight ? Optional.from(extras.cardText.matchText).getOr('') : '';\n          return renderHtml(replaceText(item.text, matchText), item.classes);\n      }\n    });\n  };\n\n  var renderCardMenuItem = function (spec, itemResponse, sharedBackstage, extras) {\n    var getApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          Disabling.set(component, state);\n          each$1(descendants(component.element, '*'), function (elm) {\n            component.getSystem().getByDom(elm).each(function (comp) {\n              if (comp.hasConfigured(Disabling)) {\n                Disabling.set(comp, state);\n              }\n            });\n          });\n        }\n      };\n    };\n\n    var structure = {\n      dom: renderItemDomStructure(spec.label),\n      optComponents: [Optional.some({\n        dom: {\n          tag: 'div',\n          classes: [containerClass, containerRowClass]\n        },\n        components: render$2(spec.items, extras)\n      })]\n    };\n    return renderCommonItem({\n      data: buildData(__assign({\n        text: Optional.none()\n      }, spec)),\n      disabled: spec.disabled,\n      getApi: getApi,\n      onAction: spec.onAction,\n      onSetup: spec.onSetup,\n      triggersSubmenu: false,\n      itemBehaviours: Optional.from(extras.itemBehaviours).getOr([])\n    }, structure, itemResponse, sharedBackstage.providers);\n  };\n\n  var renderChoiceItem = function (spec, useText, presets, onItemValueHandler, isSelected, itemResponse, providersBackstage, renderIcons) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    var getApi = function (component) {\n      return {\n        setActive: function (state) {\n          Toggling.set(component, state);\n        },\n        isActive: function () {\n          return Toggling.isOn(component);\n        },\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n\n    var structure = renderItemStructure({\n      presets: presets,\n      textContent: useText ? spec.text : Optional.none(),\n      htmlContent: Optional.none(),\n      ariaLabel: spec.text,\n      iconContent: spec.icon,\n      shortcutContent: useText ? spec.shortcut : Optional.none(),\n      checkMark: useText ? Optional.some(renderCheckmark(providersBackstage.icons)) : Optional.none(),\n      caret: Optional.none(),\n      value: spec.value\n    }, providersBackstage, renderIcons);\n    return deepMerge(renderCommonItem({\n      data: buildData(spec),\n      disabled: spec.disabled,\n      getApi: getApi,\n      onAction: function (_api) {\n        return onItemValueHandler(spec.value);\n      },\n      onSetup: function (api) {\n        api.setActive(isSelected);\n        return noop;\n      },\n      triggersSubmenu: false,\n      itemBehaviours: []\n    }, structure, itemResponse, providersBackstage), {\n      toggling: {\n        toggleClass: tickedClass,\n        toggleOnExecute: false,\n        selected: spec.active\n      }\n    });\n  };\n\n  var parts$f = generate$3(owner$2(), parts$h());\n\n  var hexColour = function (value) {\n    return {\n      value: value\n    };\n  };\n\n  var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n  var longformRegex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\n\n  var isHexString = function (hex) {\n    return shorthandRegex.test(hex) || longformRegex.test(hex);\n  };\n\n  var normalizeHex = function (hex) {\n    return removeLeading(hex, '#').toUpperCase();\n  };\n\n  var fromString$1 = function (hex) {\n    return isHexString(hex) ? Optional.some({\n      value: normalizeHex(hex)\n    }) : Optional.none();\n  };\n\n  var getLongForm = function (hex) {\n    var hexString = hex.value.replace(shorthandRegex, function (m, r, g, b) {\n      return r + r + g + g + b + b;\n    });\n    return {\n      value: hexString\n    };\n  };\n\n  var extractValues = function (hex) {\n    var longForm = getLongForm(hex);\n    var splitForm = longformRegex.exec(longForm.value);\n    return splitForm === null ? ['FFFFFF', 'FF', 'FF', 'FF'] : splitForm;\n  };\n\n  var toHex = function (component) {\n    var hex = component.toString(16);\n    return (hex.length === 1 ? '0' + hex : hex).toUpperCase();\n  };\n\n  var fromRgba = function (rgbaColour) {\n    var value = toHex(rgbaColour.red) + toHex(rgbaColour.green) + toHex(rgbaColour.blue);\n    return hexColour(value);\n  };\n\n  var min = Math.min;\n  var max = Math.max;\n  var round$1 = Math.round;\n  var rgbRegex = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/;\n  var rgbaRegex = /^rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*(\\d?(?:\\.\\d+)?)\\)/;\n\n  var rgbaColour = function (red, green, blue, alpha) {\n    return {\n      red: red,\n      green: green,\n      blue: blue,\n      alpha: alpha\n    };\n  };\n\n  var isRgbaComponent = function (value) {\n    var num = parseInt(value, 10);\n    return num.toString() === value && num >= 0 && num <= 255;\n  };\n\n  var fromHsv = function (hsv) {\n    var r;\n    var g;\n    var b;\n    var hue = (hsv.hue || 0) % 360;\n    var saturation = hsv.saturation / 100;\n    var brightness = hsv.value / 100;\n    saturation = max(0, min(saturation, 1));\n    brightness = max(0, min(brightness, 1));\n\n    if (saturation === 0) {\n      r = g = b = round$1(255 * brightness);\n      return rgbaColour(r, g, b, 1);\n    }\n\n    var side = hue / 60;\n    var chroma = brightness * saturation;\n    var x = chroma * (1 - Math.abs(side % 2 - 1));\n    var match = brightness - chroma;\n\n    switch (Math.floor(side)) {\n      case 0:\n        r = chroma;\n        g = x;\n        b = 0;\n        break;\n\n      case 1:\n        r = x;\n        g = chroma;\n        b = 0;\n        break;\n\n      case 2:\n        r = 0;\n        g = chroma;\n        b = x;\n        break;\n\n      case 3:\n        r = 0;\n        g = x;\n        b = chroma;\n        break;\n\n      case 4:\n        r = x;\n        g = 0;\n        b = chroma;\n        break;\n\n      case 5:\n        r = chroma;\n        g = 0;\n        b = x;\n        break;\n\n      default:\n        r = g = b = 0;\n    }\n\n    r = round$1(255 * (r + match));\n    g = round$1(255 * (g + match));\n    b = round$1(255 * (b + match));\n    return rgbaColour(r, g, b, 1);\n  };\n\n  var fromHex = function (hexColour) {\n    var result = extractValues(hexColour);\n    var red = parseInt(result[1], 16);\n    var green = parseInt(result[2], 16);\n    var blue = parseInt(result[3], 16);\n    return rgbaColour(red, green, blue, 1);\n  };\n\n  var fromStringValues = function (red, green, blue, alpha) {\n    var r = parseInt(red, 10);\n    var g = parseInt(green, 10);\n    var b = parseInt(blue, 10);\n    var a = parseFloat(alpha);\n    return rgbaColour(r, g, b, a);\n  };\n\n  var fromString = function (rgbaString) {\n    if (rgbaString === 'transparent') {\n      return Optional.some(rgbaColour(0, 0, 0, 0));\n    }\n\n    var rgbMatch = rgbRegex.exec(rgbaString);\n\n    if (rgbMatch !== null) {\n      return Optional.some(fromStringValues(rgbMatch[1], rgbMatch[2], rgbMatch[3], '1'));\n    }\n\n    var rgbaMatch = rgbaRegex.exec(rgbaString);\n\n    if (rgbaMatch !== null) {\n      return Optional.some(fromStringValues(rgbaMatch[1], rgbaMatch[2], rgbaMatch[3], rgbaMatch[4]));\n    }\n\n    return Optional.none();\n  };\n\n  var toString = function (rgba) {\n    return 'rgba(' + rgba.red + ',' + rgba.green + ',' + rgba.blue + ',' + rgba.alpha + ')';\n  };\n\n  var red = rgbaColour(255, 0, 0, 1);\n\n  var fireSkinLoaded$1 = function (editor) {\n    return editor.fire('SkinLoaded');\n  };\n\n  var fireSkinLoadError$1 = function (editor, error) {\n    return editor.fire('SkinLoadError', error);\n  };\n\n  var fireResizeEditor = function (editor) {\n    return editor.fire('ResizeEditor');\n  };\n\n  var fireResizeContent = function (editor, e) {\n    return editor.fire('ResizeContent', e);\n  };\n\n  var fireScrollContent = function (editor, e) {\n    return editor.fire('ScrollContent', e);\n  };\n\n  var fireTextColorChange = function (editor, data) {\n    return editor.fire('TextColorChange', data);\n  };\n\n  var hsvColour = function (hue, saturation, value) {\n    return {\n      hue: hue,\n      saturation: saturation,\n      value: value\n    };\n  };\n\n  var fromRgb = function (rgbaColour) {\n    var h = 0;\n    var s = 0;\n    var v = 0;\n    var r = rgbaColour.red / 255;\n    var g = rgbaColour.green / 255;\n    var b = rgbaColour.blue / 255;\n    var minRGB = Math.min(r, Math.min(g, b));\n    var maxRGB = Math.max(r, Math.max(g, b));\n\n    if (minRGB === maxRGB) {\n      v = minRGB;\n      return hsvColour(0, 0, v * 100);\n    }\n\n    var d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n    h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n    h = 60 * (h - d / (maxRGB - minRGB));\n    s = (maxRGB - minRGB) / maxRGB;\n    v = maxRGB;\n    return hsvColour(Math.round(h), Math.round(s * 100), Math.round(v * 100));\n  };\n\n  var hexToHsv = function (hex) {\n    return fromRgb(fromHex(hex));\n  };\n\n  var hsvToHex = function (hsv) {\n    return fromRgba(fromHsv(hsv));\n  };\n\n  var anyToHex = function (color) {\n    return fromString$1(color).orThunk(function () {\n      return fromString(color).map(fromRgba);\n    }).getOrThunk(function () {\n      var canvas = document.createElement('canvas');\n      canvas.height = 1;\n      canvas.width = 1;\n      var canvasContext = canvas.getContext('2d');\n      canvasContext.clearRect(0, 0, canvas.width, canvas.height);\n      canvasContext.fillStyle = '#FFFFFF';\n      canvasContext.fillStyle = color;\n      canvasContext.fillRect(0, 0, 1, 1);\n      var rgba = canvasContext.getImageData(0, 0, 1, 1).data;\n      var r = rgba[0];\n      var g = rgba[1];\n      var b = rgba[2];\n      var a = rgba[3];\n      return fromRgba(rgbaColour(r, g, b, a));\n    });\n  };\n\n  var global$8 = tinymce.util.Tools.resolve('tinymce.util.LocalStorage');\n  var storageName = 'tinymce-custom-colors';\n\n  function ColorCache(max) {\n    if (max === void 0) {\n      max = 10;\n    }\n\n    var storageString = global$8.getItem(storageName);\n    var localstorage = isString(storageString) ? JSON.parse(storageString) : [];\n\n    var prune = function (list) {\n      var diff = max - list.length;\n      return diff < 0 ? list.slice(0, max) : list;\n    };\n\n    var cache = prune(localstorage);\n\n    var add = function (key) {\n      indexOf(cache, key).each(remove);\n      cache.unshift(key);\n\n      if (cache.length > max) {\n        cache.pop();\n      }\n\n      global$8.setItem(storageName, JSON.stringify(cache));\n    };\n\n    var remove = function (idx) {\n      cache.splice(idx, 1);\n    };\n\n    var state = function () {\n      return cache.slice(0);\n    };\n\n    return {\n      add: add,\n      state: state\n    };\n  }\n\n  var choiceItem = 'choiceitem';\n  var defaultColors = [{\n    type: choiceItem,\n    text: 'Light Green',\n    value: '#BFEDD2'\n  }, {\n    type: choiceItem,\n    text: 'Light Yellow',\n    value: '#FBEEB8'\n  }, {\n    type: choiceItem,\n    text: 'Light Red',\n    value: '#F8CAC6'\n  }, {\n    type: choiceItem,\n    text: 'Light Purple',\n    value: '#ECCAFA'\n  }, {\n    type: choiceItem,\n    text: 'Light Blue',\n    value: '#C2E0F4'\n  }, {\n    type: choiceItem,\n    text: 'Green',\n    value: '#2DC26B'\n  }, {\n    type: choiceItem,\n    text: 'Yellow',\n    value: '#F1C40F'\n  }, {\n    type: choiceItem,\n    text: 'Red',\n    value: '#E03E2D'\n  }, {\n    type: choiceItem,\n    text: 'Purple',\n    value: '#B96AD9'\n  }, {\n    type: choiceItem,\n    text: 'Blue',\n    value: '#3598DB'\n  }, {\n    type: choiceItem,\n    text: 'Dark Turquoise',\n    value: '#169179'\n  }, {\n    type: choiceItem,\n    text: 'Orange',\n    value: '#E67E23'\n  }, {\n    type: choiceItem,\n    text: 'Dark Red',\n    value: '#BA372A'\n  }, {\n    type: choiceItem,\n    text: 'Dark Purple',\n    value: '#843FA1'\n  }, {\n    type: choiceItem,\n    text: 'Dark Blue',\n    value: '#236FA1'\n  }, {\n    type: choiceItem,\n    text: 'Light Gray',\n    value: '#ECF0F1'\n  }, {\n    type: choiceItem,\n    text: 'Medium Gray',\n    value: '#CED4D9'\n  }, {\n    type: choiceItem,\n    text: 'Gray',\n    value: '#95A5A6'\n  }, {\n    type: choiceItem,\n    text: 'Dark Gray',\n    value: '#7E8C8D'\n  }, {\n    type: choiceItem,\n    text: 'Navy Blue',\n    value: '#34495E'\n  }, {\n    type: choiceItem,\n    text: 'Black',\n    value: '#000000'\n  }, {\n    type: choiceItem,\n    text: 'White',\n    value: '#ffffff'\n  }];\n  var colorCache = ColorCache(10);\n\n  var mapColors = function (colorMap) {\n    var colors = [];\n\n    for (var i = 0; i < colorMap.length; i += 2) {\n      colors.push({\n        text: colorMap[i + 1],\n        value: '#' + anyToHex(colorMap[i]).value,\n        type: 'choiceitem'\n      });\n    }\n\n    return colors;\n  };\n\n  var getColorCols$2 = function (editor, defaultCols) {\n    return editor.getParam('color_cols', defaultCols, 'number');\n  };\n\n  var hasCustomColors$1 = function (editor) {\n    return editor.getParam('custom_colors') !== false;\n  };\n\n  var getColorMap = function (editor) {\n    return editor.getParam('color_map');\n  };\n\n  var getColors$2 = function (editor) {\n    var unmapped = getColorMap(editor);\n    return unmapped !== undefined ? mapColors(unmapped) : defaultColors;\n  };\n\n  var getCurrentColors = function () {\n    return map$2(colorCache.state(), function (color) {\n      return {\n        type: choiceItem,\n        text: color,\n        value: color\n      };\n    });\n  };\n\n  var addColor = function (color) {\n    colorCache.add(color);\n  };\n\n  var fallbackColor = '#000000';\n\n  var getCurrentColor = function (editor, format) {\n    var color;\n    editor.dom.getParents(editor.selection.getStart(), function (elm) {\n      var value;\n\n      if (value = elm.style[format === 'forecolor' ? 'color' : 'background-color']) {\n        color = color ? color : value;\n      }\n    });\n    return Optional.from(color);\n  };\n\n  var applyFormat = function (editor, format, value) {\n    editor.undoManager.transact(function () {\n      editor.focus();\n      editor.formatter.apply(format, {\n        value: value\n      });\n      editor.nodeChanged();\n    });\n  };\n\n  var removeFormat = function (editor, format) {\n    editor.undoManager.transact(function () {\n      editor.focus();\n      editor.formatter.remove(format, {\n        value: null\n      }, null, true);\n      editor.nodeChanged();\n    });\n  };\n\n  var registerCommands = function (editor) {\n    editor.addCommand('mceApplyTextcolor', function (format, value) {\n      applyFormat(editor, format, value);\n    });\n    editor.addCommand('mceRemoveTextcolor', function (format) {\n      removeFormat(editor, format);\n    });\n  };\n\n  var calcCols = function (colors) {\n    return Math.max(5, Math.ceil(Math.sqrt(colors)));\n  };\n\n  var getColorCols$1 = function (editor) {\n    var colors = getColors$2(editor);\n    var defaultCols = calcCols(colors.length);\n    return getColorCols$2(editor, defaultCols);\n  };\n\n  var getAdditionalColors = function (hasCustom) {\n    var type = 'choiceitem';\n    var remove = {\n      type: type,\n      text: 'Remove color',\n      icon: 'color-swatch-remove-color',\n      value: 'remove'\n    };\n    var custom = {\n      type: type,\n      text: 'Custom color',\n      icon: 'color-picker',\n      value: 'custom'\n    };\n    return hasCustom ? [remove, custom] : [remove];\n  };\n\n  var applyColor = function (editor, format, value, onChoice) {\n    if (value === 'custom') {\n      var dialog = colorPickerDialog(editor);\n      dialog(function (colorOpt) {\n        colorOpt.each(function (color) {\n          addColor(color);\n          editor.execCommand('mceApplyTextcolor', format, color);\n          onChoice(color);\n        });\n      }, fallbackColor);\n    } else if (value === 'remove') {\n      onChoice('');\n      editor.execCommand('mceRemoveTextcolor', format);\n    } else {\n      onChoice(value);\n      editor.execCommand('mceApplyTextcolor', format, value);\n    }\n  };\n\n  var getColors$1 = function (colors, hasCustom) {\n    return colors.concat(getCurrentColors().concat(getAdditionalColors(hasCustom)));\n  };\n\n  var getFetch$1 = function (colors, hasCustom) {\n    return function (callback) {\n      callback(getColors$1(colors, hasCustom));\n    };\n  };\n\n  var setIconColor = function (splitButtonApi, name, newColor) {\n    var id = name === 'forecolor' ? 'tox-icon-text-color__color' : 'tox-icon-highlight-bg-color__color';\n    splitButtonApi.setIconFill(id, newColor);\n  };\n\n  var registerTextColorButton = function (editor, name, format, tooltip, lastColor) {\n    editor.ui.registry.addSplitButton(name, {\n      tooltip: tooltip,\n      presets: 'color',\n      icon: name === 'forecolor' ? 'text-color' : 'highlight-bg-color',\n      select: function (value) {\n        var optCurrentRgb = getCurrentColor(editor, format);\n        return optCurrentRgb.bind(function (currentRgb) {\n          return fromString(currentRgb).map(function (rgba) {\n            var currentHex = fromRgba(rgba).value;\n            return contains$1(value.toLowerCase(), currentHex);\n          });\n        }).getOr(false);\n      },\n      columns: getColorCols$1(editor),\n      fetch: getFetch$1(getColors$2(editor), hasCustomColors$1(editor)),\n      onAction: function (_splitButtonApi) {\n        applyColor(editor, format, lastColor.get(), noop);\n      },\n      onItemAction: function (_splitButtonApi, value) {\n        applyColor(editor, format, value, function (newColor) {\n          lastColor.set(newColor);\n          fireTextColorChange(editor, {\n            name: name,\n            color: newColor\n          });\n        });\n      },\n      onSetup: function (splitButtonApi) {\n        setIconColor(splitButtonApi, name, lastColor.get());\n\n        var handler = function (e) {\n          if (e.name === name) {\n            setIconColor(splitButtonApi, e.name, e.color);\n          }\n        };\n\n        editor.on('TextColorChange', handler);\n        return function () {\n          editor.off('TextColorChange', handler);\n        };\n      }\n    });\n  };\n\n  var registerTextColorMenuItem = function (editor, name, format, text) {\n    editor.ui.registry.addNestedMenuItem(name, {\n      text: text,\n      icon: name === 'forecolor' ? 'text-color' : 'highlight-bg-color',\n      getSubmenuItems: function () {\n        return [{\n          type: 'fancymenuitem',\n          fancytype: 'colorswatch',\n          onAction: function (data) {\n            applyColor(editor, format, data.value, noop);\n          }\n        }];\n      }\n    });\n  };\n\n  var colorPickerDialog = function (editor) {\n    return function (callback, value) {\n      var isValid = false;\n\n      var onSubmit = function (api) {\n        var data = api.getData();\n        var hex = data.colorpicker;\n\n        if (isValid) {\n          callback(Optional.from(hex));\n          api.close();\n        } else {\n          editor.windowManager.alert(editor.translate(['Invalid hex color code: {0}', hex]));\n        }\n      };\n\n      var onAction = function (_api, details) {\n        if (details.name === 'hex-valid') {\n          isValid = details.value;\n        }\n      };\n\n      var initialData = {\n        colorpicker: value\n      };\n      editor.windowManager.open({\n        title: 'Color Picker',\n        size: 'normal',\n        body: {\n          type: 'panel',\n          items: [{\n            type: 'colorpicker',\n            name: 'colorpicker',\n            label: 'Color'\n          }]\n        },\n        buttons: [{\n          type: 'cancel',\n          name: 'cancel',\n          text: 'Cancel'\n        }, {\n          type: 'submit',\n          name: 'save',\n          text: 'Save',\n          primary: true\n        }],\n        initialData: initialData,\n        onAction: onAction,\n        onSubmit: onSubmit,\n        onClose: noop,\n        onCancel: function () {\n          callback(Optional.none());\n        }\n      });\n    };\n  };\n\n  var register$a = function (editor) {\n    registerCommands(editor);\n    var lastForeColor = Cell(fallbackColor);\n    var lastBackColor = Cell(fallbackColor);\n    registerTextColorButton(editor, 'forecolor', 'forecolor', 'Text color', lastForeColor);\n    registerTextColorButton(editor, 'backcolor', 'hilitecolor', 'Background color', lastBackColor);\n    registerTextColorMenuItem(editor, 'forecolor', 'forecolor', 'Text color');\n    registerTextColorMenuItem(editor, 'backcolor', 'hilitecolor', 'Background color');\n  };\n\n  var createPartialChoiceMenu = function (value, items, onItemValueHandler, columns, presets, itemResponse, select, providersBackstage) {\n    var hasIcons = menuHasIcons(items);\n    var presetItemTypes = presets !== 'color' ? 'normal' : 'color';\n    var alloyItems = createChoiceItems(items, onItemValueHandler, columns, presetItemTypes, itemResponse, select, providersBackstage);\n    return createPartialMenuWithAlloyItems(value, hasIcons, alloyItems, columns, presets);\n  };\n\n  var createChoiceItems = function (items, onItemValueHandler, columns, itemPresets, itemResponse, select, providersBackstage) {\n    return cat(map$2(items, function (item) {\n      if (item.type === 'choiceitem') {\n        return createChoiceMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(renderChoiceItem(d, columns === 1, itemPresets, onItemValueHandler, select(item.value), itemResponse, providersBackstage, menuHasIcons(items)));\n        });\n      } else {\n        return Optional.none();\n      }\n    }));\n  };\n\n  var deriveMenuMovement = function (columns, presets) {\n    var menuMarkers = markers(presets);\n\n    if (columns === 1) {\n      return {\n        mode: 'menu',\n        moveOnTab: true\n      };\n    } else if (columns === 'auto') {\n      return {\n        mode: 'grid',\n        selector: '.' + menuMarkers.item,\n        initSize: {\n          numColumns: 1,\n          numRows: 1\n        }\n      };\n    } else {\n      var rowClass = presets === 'color' ? 'tox-swatches__row' : 'tox-collection__group';\n      return {\n        mode: 'matrix',\n        rowSelector: '.' + rowClass\n      };\n    }\n  };\n\n  var deriveCollectionMovement = function (columns, presets) {\n    if (columns === 1) {\n      return {\n        mode: 'menu',\n        moveOnTab: false,\n        selector: '.tox-collection__item'\n      };\n    } else if (columns === 'auto') {\n      return {\n        mode: 'flatgrid',\n        selector: '.' + 'tox-collection__item',\n        initSize: {\n          numColumns: 1,\n          numRows: 1\n        }\n      };\n    } else {\n      return {\n        mode: 'matrix',\n        selectors: {\n          row: presets === 'color' ? '.tox-swatches__row' : '.tox-collection__group',\n          cell: presets === 'color' ? '.' + colorClass : '.' + selectableClass\n        }\n      };\n    }\n  };\n\n  var renderColorSwatchItem = function (spec, backstage) {\n    var items = getColorItems(spec, backstage);\n    var columns = backstage.colorinput.getColorCols();\n    var presets = 'color';\n    var menuSpec = createPartialChoiceMenu(generate$6('menu-value'), items, function (value) {\n      spec.onAction({\n        value: value\n      });\n    }, columns, presets, ItemResponse$1.CLOSE_ON_EXECUTE, never, backstage.shared.providers);\n\n    var widgetSpec = __assign(__assign({}, menuSpec), {\n      markers: markers(presets),\n      movement: deriveMenuMovement(columns, presets)\n    });\n\n    return {\n      type: 'widget',\n      data: {\n        value: generate$6('widget-id')\n      },\n      dom: {\n        tag: 'div',\n        classes: ['tox-fancymenuitem']\n      },\n      autofocus: true,\n      components: [parts$f.widget(Menu.sketch(widgetSpec))]\n    };\n  };\n\n  var getColorItems = function (spec, backstage) {\n    var useCustomColors = spec.initData.allowCustomColors && backstage.colorinput.hasCustomColors();\n    return spec.initData.colors.fold(function () {\n      return getColors$1(backstage.colorinput.getColors(), useCustomColors);\n    }, function (colors) {\n      return colors.concat(getAdditionalColors(useCustomColors));\n    });\n  };\n\n  var cellOverEvent = generate$6('cell-over');\n  var cellExecuteEvent = generate$6('cell-execute');\n\n  var makeCell = function (row, col, labelId) {\n    var _a;\n\n    var emitCellOver = function (c) {\n      return emitWith(c, cellOverEvent, {\n        row: row,\n        col: col\n      });\n    };\n\n    var emitExecute = function (c) {\n      return emitWith(c, cellExecuteEvent, {\n        row: row,\n        col: col\n      });\n    };\n\n    var onClick = function (c, se) {\n      se.stop();\n      emitExecute(c);\n    };\n\n    return build$1({\n      dom: {\n        tag: 'div',\n        attributes: (_a = {\n          role: 'button'\n        }, _a['aria-labelledby'] = labelId, _a)\n      },\n      behaviours: derive$1([config('insert-table-picker-cell', [run$1(mouseover(), Focusing.focus), run$1(execute$5(), emitExecute), run$1(click(), onClick), run$1(tap(), onClick)]), Toggling.config({\n        toggleClass: 'tox-insert-table-picker__selected',\n        toggleOnExecute: false\n      }), Focusing.config({\n        onFocus: emitCellOver\n      })])\n    });\n  };\n\n  var makeCells = function (labelId, numRows, numCols) {\n    var cells = [];\n\n    for (var i = 0; i < numRows; i++) {\n      var row = [];\n\n      for (var j = 0; j < numCols; j++) {\n        row.push(makeCell(i, j, labelId));\n      }\n\n      cells.push(row);\n    }\n\n    return cells;\n  };\n\n  var selectCells = function (cells, selectedRow, selectedColumn, numRows, numColumns) {\n    for (var i = 0; i < numRows; i++) {\n      for (var j = 0; j < numColumns; j++) {\n        Toggling.set(cells[i][j], i <= selectedRow && j <= selectedColumn);\n      }\n    }\n  };\n\n  var makeComponents = function (cells) {\n    return bind$3(cells, function (cellRow) {\n      return map$2(cellRow, premade);\n    });\n  };\n\n  var makeLabelText = function (row, col) {\n    return text(col + 'x' + row);\n  };\n\n  var renderInsertTableMenuItem = function (spec) {\n    var numRows = 10;\n    var numColumns = 10;\n    var sizeLabelId = generate$6('size-label');\n    var cells = makeCells(sizeLabelId, numRows, numColumns);\n    var emptyLabelText = makeLabelText(0, 0);\n    var memLabel = record({\n      dom: {\n        tag: 'span',\n        classes: ['tox-insert-table-picker__label'],\n        attributes: {\n          id: sizeLabelId\n        }\n      },\n      components: [emptyLabelText],\n      behaviours: derive$1([Replacing.config({})])\n    });\n    return {\n      type: 'widget',\n      data: {\n        value: generate$6('widget-id')\n      },\n      dom: {\n        tag: 'div',\n        classes: ['tox-fancymenuitem']\n      },\n      autofocus: true,\n      components: [parts$f.widget({\n        dom: {\n          tag: 'div',\n          classes: ['tox-insert-table-picker']\n        },\n        components: makeComponents(cells).concat(memLabel.asSpec()),\n        behaviours: derive$1([config('insert-table-picker', [runOnAttached(function (c) {\n          Replacing.set(memLabel.get(c), [emptyLabelText]);\n        }), runWithTarget(cellOverEvent, function (c, t, e) {\n          var _a = e.event,\n              row = _a.row,\n              col = _a.col;\n          selectCells(cells, row, col, numRows, numColumns);\n          Replacing.set(memLabel.get(c), [makeLabelText(row + 1, col + 1)]);\n        }), runWithTarget(cellExecuteEvent, function (c, _, e) {\n          var _a = e.event,\n              row = _a.row,\n              col = _a.col;\n          spec.onAction({\n            numRows: row + 1,\n            numColumns: col + 1\n          });\n          emit(c, sandboxClose());\n        })]), Keying.config({\n          initSize: {\n            numRows: numRows,\n            numColumns: numColumns\n          },\n          mode: 'flatgrid',\n          selector: '[role=\"button\"]'\n        })])\n      })]\n    };\n  };\n\n  var fancyMenuItems = {\n    inserttable: renderInsertTableMenuItem,\n    colorswatch: renderColorSwatchItem\n  };\n\n  var renderFancyMenuItem = function (spec, backstage) {\n    return get$e(fancyMenuItems, spec.fancytype).map(function (render) {\n      return render(spec, backstage);\n    });\n  };\n\n  var renderNestedItem = function (spec, itemResponse, providersBackstage, renderIcons, downwardsCaret) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    if (downwardsCaret === void 0) {\n      downwardsCaret = false;\n    }\n\n    var caret = downwardsCaret ? renderDownwardsCaret(providersBackstage.icons) : renderSubmenuCaret(providersBackstage.icons);\n\n    var getApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n\n    var structure = renderItemStructure({\n      presets: 'normal',\n      iconContent: spec.icon,\n      textContent: spec.text,\n      htmlContent: Optional.none(),\n      ariaLabel: spec.text,\n      caret: Optional.some(caret),\n      checkMark: Optional.none(),\n      shortcutContent: spec.shortcut\n    }, providersBackstage, renderIcons);\n    return renderCommonItem({\n      data: buildData(spec),\n      getApi: getApi,\n      disabled: spec.disabled,\n      onAction: noop,\n      onSetup: spec.onSetup,\n      triggersSubmenu: true,\n      itemBehaviours: []\n    }, structure, itemResponse, providersBackstage);\n  };\n\n  var renderNormalItem = function (spec, itemResponse, providersBackstage, renderIcons) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    var getApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n\n    var structure = renderItemStructure({\n      presets: 'normal',\n      iconContent: spec.icon,\n      textContent: spec.text,\n      htmlContent: Optional.none(),\n      ariaLabel: spec.text,\n      caret: Optional.none(),\n      checkMark: Optional.none(),\n      shortcutContent: spec.shortcut\n    }, providersBackstage, renderIcons);\n    return renderCommonItem({\n      data: buildData(spec),\n      getApi: getApi,\n      disabled: spec.disabled,\n      onAction: spec.onAction,\n      onSetup: spec.onSetup,\n      triggersSubmenu: false,\n      itemBehaviours: []\n    }, structure, itemResponse, providersBackstage);\n  };\n\n  var renderSeparatorItem = function (spec) {\n    var innerHtml = spec.text.fold(function () {\n      return {};\n    }, function (text) {\n      return {\n        innerHtml: text\n      };\n    });\n    return {\n      type: 'separator',\n      dom: __assign({\n        tag: 'div',\n        classes: [selectableClass, groupHeadingClass]\n      }, innerHtml),\n      components: []\n    };\n  };\n\n  var renderToggleMenuItem = function (spec, itemResponse, providersBackstage, renderIcons) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    var getApi = function (component) {\n      return {\n        setActive: function (state) {\n          Toggling.set(component, state);\n        },\n        isActive: function () {\n          return Toggling.isOn(component);\n        },\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n\n    var structure = renderItemStructure({\n      iconContent: spec.icon,\n      textContent: spec.text,\n      htmlContent: Optional.none(),\n      ariaLabel: spec.text,\n      checkMark: Optional.some(renderCheckmark(providersBackstage.icons)),\n      caret: Optional.none(),\n      shortcutContent: spec.shortcut,\n      presets: 'normal',\n      meta: spec.meta\n    }, providersBackstage, renderIcons);\n    return deepMerge(renderCommonItem({\n      data: buildData(spec),\n      disabled: spec.disabled,\n      getApi: getApi,\n      onAction: spec.onAction,\n      onSetup: spec.onSetup,\n      triggersSubmenu: false,\n      itemBehaviours: []\n    }, structure, itemResponse, providersBackstage), {\n      toggling: {\n        toggleClass: tickedClass,\n        toggleOnExecute: false,\n        selected: spec.active\n      }\n    });\n  };\n\n  var autocomplete = renderAutocompleteItem;\n  var separator$3 = renderSeparatorItem;\n  var normal = renderNormalItem;\n  var nested = renderNestedItem;\n  var toggle$1 = renderToggleMenuItem;\n  var fancy = renderFancyMenuItem;\n  var card = renderCardMenuItem;\n  var FocusMode;\n\n  (function (FocusMode) {\n    FocusMode[FocusMode['ContentFocus'] = 0] = 'ContentFocus';\n    FocusMode[FocusMode['UiFocus'] = 1] = 'UiFocus';\n  })(FocusMode || (FocusMode = {}));\n\n  var createMenuItemFromBridge = function (item, itemResponse, backstage, menuHasIcons, isHorizontalMenu) {\n    var providersBackstage = backstage.shared.providers;\n\n    var parseForHorizontalMenu = function (menuitem) {\n      return !isHorizontalMenu ? menuitem : __assign(__assign({}, menuitem), {\n        shortcut: Optional.none(),\n        icon: menuitem.text.isSome() ? Optional.none() : menuitem.icon\n      });\n    };\n\n    switch (item.type) {\n      case 'menuitem':\n        return createMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(normal(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons));\n        });\n\n      case 'nestedmenuitem':\n        return createNestedMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(nested(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons, isHorizontalMenu));\n        });\n\n      case 'togglemenuitem':\n        return createToggleMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(toggle$1(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons));\n        });\n\n      case 'separator':\n        return createSeparatorMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(separator$3(d));\n        });\n\n      case 'fancymenuitem':\n        return createFancyMenuItem(item).fold(handleError, function (d) {\n          return fancy(parseForHorizontalMenu(d), backstage);\n        });\n\n      default:\n        {\n          console.error('Unknown item in general menu', item);\n          return Optional.none();\n        }\n    }\n  };\n\n  var createAutocompleteItems = function (items, matchText, onItemValueHandler, columns, itemResponse, sharedBackstage, highlightOn) {\n    var renderText = columns === 1;\n    var renderIcons = !renderText || menuHasIcons(items);\n    return cat(map$2(items, function (item) {\n      switch (item.type) {\n        case 'separator':\n          return createSeparatorItem(item).fold(handleError, function (d) {\n            return Optional.some(separator$3(d));\n          });\n\n        case 'cardmenuitem':\n          return createCardMenuItem(item).fold(handleError, function (d) {\n            return Optional.some(card(__assign(__assign({}, d), {\n              onAction: function (api) {\n                d.onAction(api);\n                onItemValueHandler(d.value, d.meta);\n              }\n            }), itemResponse, sharedBackstage, {\n              itemBehaviours: tooltipBehaviour(d.meta, sharedBackstage),\n              cardText: {\n                matchText: matchText,\n                highlightOn: highlightOn\n              }\n            }));\n          });\n\n        case 'autocompleteitem':\n        default:\n          return createAutocompleterItem(item).fold(handleError, function (d) {\n            return Optional.some(autocomplete(d, matchText, renderText, 'normal', onItemValueHandler, itemResponse, sharedBackstage, renderIcons));\n          });\n      }\n    }));\n  };\n\n  var createPartialMenu = function (value, items, itemResponse, backstage, isHorizontalMenu) {\n    var hasIcons = menuHasIcons(items);\n    var alloyItems = cat(map$2(items, function (item) {\n      var itemHasIcon = function (i) {\n        return isHorizontalMenu ? !has$2(i, 'text') : hasIcons;\n      };\n\n      var createItem = function (i) {\n        return createMenuItemFromBridge(i, itemResponse, backstage, itemHasIcon(i), isHorizontalMenu);\n      };\n\n      if (item.type === 'nestedmenuitem' && item.getSubmenuItems().length <= 0) {\n        return createItem(__assign(__assign({}, item), {\n          disabled: true\n        }));\n      } else {\n        return createItem(item);\n      }\n    }));\n    var createPartial = isHorizontalMenu ? createHorizontalPartialMenuWithAlloyItems : createPartialMenuWithAlloyItems;\n    return createPartial(value, hasIcons, alloyItems, 1, 'normal');\n  };\n\n  var createTieredDataFrom = function (partialMenu) {\n    return tieredMenu.singleData(partialMenu.value, partialMenu);\n  };\n\n  var createMenuFrom = function (partialMenu, columns, focusMode, presets) {\n    var focusManager = focusMode === FocusMode.ContentFocus ? highlights() : dom$2();\n    var movement = deriveMenuMovement(columns, presets);\n    var menuMarkers = markers(presets);\n    return {\n      dom: partialMenu.dom,\n      components: partialMenu.components,\n      items: partialMenu.items,\n      value: partialMenu.value,\n      markers: {\n        selectedItem: menuMarkers.selectedItem,\n        item: menuMarkers.item\n      },\n      movement: movement,\n      fakeFocus: focusMode === FocusMode.ContentFocus,\n      focusManager: focusManager,\n      menuBehaviours: SimpleBehaviours.unnamedEvents(columns !== 'auto' ? [] : [runOnAttached(function (comp, _se) {\n        detectSize(comp, 4, menuMarkers.item).each(function (_a) {\n          var numColumns = _a.numColumns,\n              numRows = _a.numRows;\n          Keying.setGridSize(comp, numRows, numColumns);\n        });\n      })])\n    };\n  };\n\n  var register$9 = function (editor, sharedBackstage) {\n    var activeAutocompleter = value$1();\n    var processingAction = Cell(false);\n    var autocompleter = build$1(InlineView.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-autocompleter']\n      },\n      components: [],\n      fireDismissalEventInstead: {},\n      inlineBehaviours: derive$1([config('dismissAutocompleter', [run$1(dismissRequested(), function () {\n        return cancelIfNecessary();\n      })])]),\n      lazySink: sharedBackstage.getSink\n    }));\n\n    var isMenuOpen = function () {\n      return InlineView.isOpen(autocompleter);\n    };\n\n    var isActive = function () {\n      return activeAutocompleter.get().isSome();\n    };\n\n    var hideIfNecessary = function () {\n      if (isActive()) {\n        InlineView.hide(autocompleter);\n      }\n    };\n\n    var cancelIfNecessary = function () {\n      if (isActive()) {\n        var lastElement = activeAutocompleter.get().map(function (ac) {\n          return ac.element;\n        });\n        detect(lastElement.getOr(SugarElement.fromDom(editor.selection.getNode()))).each(unwrap);\n        hideIfNecessary();\n        activeAutocompleter.clear();\n        processingAction.set(false);\n      }\n    };\n\n    var getAutocompleters = cached(function () {\n      return register$b(editor);\n    });\n\n    var getCombinedItems = function (triggerChar, matches) {\n      var columns = findMap(matches, function (m) {\n        return Optional.from(m.columns);\n      }).getOr(1);\n      return bind$3(matches, function (match) {\n        var choices = match.items;\n        return createAutocompleteItems(choices, match.matchText, function (itemValue, itemMeta) {\n          var nr = editor.selection.getRng();\n          getContext(editor.dom, nr, triggerChar).fold(function () {\n            return console.error('Lost context. Cursor probably moved');\n          }, function (_a) {\n            var range = _a.range;\n            var autocompleterApi = {\n              hide: function () {\n                cancelIfNecessary();\n              },\n              reload: function (fetchOptions) {\n                hideIfNecessary();\n                load(fetchOptions);\n              }\n            };\n            processingAction.set(true);\n            match.onAction(autocompleterApi, range, itemValue, itemMeta);\n            processingAction.set(false);\n          });\n        }, columns, ItemResponse$1.BUBBLE_TO_SANDBOX, sharedBackstage, match.highlightOn);\n      });\n    };\n\n    var commenceIfNecessary = function (context) {\n      if (!isActive()) {\n        var wrapper = create$4(editor, context.range);\n        activeAutocompleter.set({\n          triggerChar: context.triggerChar,\n          element: wrapper,\n          matchLength: context.text.length\n        });\n        processingAction.set(false);\n      }\n    };\n\n    var display = function (ac, context, lookupData, items) {\n      ac.matchLength = context.text.length;\n      var columns = findMap(lookupData, function (ld) {\n        return Optional.from(ld.columns);\n      }).getOr(1);\n      InlineView.showAt(autocompleter, Menu.sketch(createMenuFrom(createPartialMenuWithAlloyItems('autocompleter-value', true, items, columns, 'normal'), columns, FocusMode.ContentFocus, 'normal')), {\n        anchor: {\n          type: 'node',\n          root: SugarElement.fromDom(editor.getBody()),\n          node: Optional.from(ac.element)\n        }\n      });\n      InlineView.getContent(autocompleter).each(Highlighting.highlightFirst);\n    };\n\n    var doLookup = function (fetchOptions) {\n      return activeAutocompleter.get().map(function (ac) {\n        return getContext(editor.dom, editor.selection.getRng(), ac.triggerChar).bind(function (newContext) {\n          return lookupWithContext(editor, getAutocompleters, newContext, fetchOptions);\n        });\n      }).getOrThunk(function () {\n        return lookup$2(editor, getAutocompleters);\n      });\n    };\n\n    var load = function (fetchOptions) {\n      doLookup(fetchOptions).fold(cancelIfNecessary, function (lookupInfo) {\n        commenceIfNecessary(lookupInfo.context);\n        lookupInfo.lookupData.then(function (lookupData) {\n          activeAutocompleter.get().map(function (ac) {\n            var context = lookupInfo.context;\n\n            if (ac.triggerChar === context.triggerChar) {\n              var combinedItems = getCombinedItems(context.triggerChar, lookupData);\n\n              if (combinedItems.length > 0) {\n                display(ac, context, lookupData, combinedItems);\n              } else if (context.text.length - ac.matchLength >= 10) {\n                cancelIfNecessary();\n              } else {\n                hideIfNecessary();\n              }\n            }\n          });\n        });\n      });\n    };\n\n    var onKeypress = last(function (e) {\n      if (e.which === 27) {\n        return;\n      }\n\n      load();\n    }, 50);\n    var autocompleterUiApi = {\n      onKeypress: onKeypress,\n      cancelIfNecessary: cancelIfNecessary,\n      isMenuOpen: isMenuOpen,\n      isActive: isActive,\n      isProcessingAction: processingAction.get,\n      getView: function () {\n        return InlineView.getContent(autocompleter);\n      }\n    };\n\n    if (editor.hasPlugin('rtc') === false) {\n      AutocompleterEditorEvents.setup(autocompleterUiApi, editor);\n    }\n  };\n\n  var Autocompleter = {\n    register: register$9\n  };\n\n  var closest = function (scope, selector, isRoot) {\n    return closest$1(scope, selector, isRoot).isSome();\n  };\n\n  var DelayedFunction = function (fun, delay) {\n    var ref = null;\n\n    var schedule = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      ref = setTimeout(function () {\n        fun.apply(null, args);\n        ref = null;\n      }, delay);\n    };\n\n    var cancel = function () {\n      if (ref !== null) {\n        clearTimeout(ref);\n        ref = null;\n      }\n    };\n\n    return {\n      cancel: cancel,\n      schedule: schedule\n    };\n  };\n\n  var SIGNIFICANT_MOVE = 5;\n  var LONGPRESS_DELAY = 400;\n\n  var getTouch = function (event) {\n    var raw = event.raw;\n\n    if (raw.touches === undefined || raw.touches.length !== 1) {\n      return Optional.none();\n    }\n\n    return Optional.some(raw.touches[0]);\n  };\n\n  var isFarEnough = function (touch, data) {\n    var distX = Math.abs(touch.clientX - data.x);\n    var distY = Math.abs(touch.clientY - data.y);\n    return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n  };\n\n  var monitor = function (settings) {\n    var startData = value$1();\n    var longpressFired = Cell(false);\n    var longpress$1 = DelayedFunction(function (event) {\n      settings.triggerEvent(longpress(), event);\n      longpressFired.set(true);\n    }, LONGPRESS_DELAY);\n\n    var handleTouchstart = function (event) {\n      getTouch(event).each(function (touch) {\n        longpress$1.cancel();\n        var data = {\n          x: touch.clientX,\n          y: touch.clientY,\n          target: event.target\n        };\n        longpress$1.schedule(event);\n        longpressFired.set(false);\n        startData.set(data);\n      });\n      return Optional.none();\n    };\n\n    var handleTouchmove = function (event) {\n      longpress$1.cancel();\n      getTouch(event).each(function (touch) {\n        startData.on(function (data) {\n          if (isFarEnough(touch, data)) {\n            startData.clear();\n          }\n        });\n      });\n      return Optional.none();\n    };\n\n    var handleTouchend = function (event) {\n      longpress$1.cancel();\n\n      var isSame = function (data) {\n        return eq(data.target, event.target);\n      };\n\n      return startData.get().filter(isSame).map(function (_data) {\n        if (longpressFired.get()) {\n          event.prevent();\n          return false;\n        } else {\n          return settings.triggerEvent(tap(), event);\n        }\n      });\n    };\n\n    var handlers = wrapAll([{\n      key: touchstart(),\n      value: handleTouchstart\n    }, {\n      key: touchmove(),\n      value: handleTouchmove\n    }, {\n      key: touchend(),\n      value: handleTouchend\n    }]);\n\n    var fireIfReady = function (event, type) {\n      return get$e(handlers, type).bind(function (handler) {\n        return handler(event);\n      });\n    };\n\n    return {\n      fireIfReady: fireIfReady\n    };\n  };\n\n  var isDangerous = function (event) {\n    var keyEv = event.raw;\n    return keyEv.which === BACKSPACE[0] && !contains$2(['input', 'textarea'], name$2(event.target)) && !closest(event.target, '[contenteditable=\"true\"]');\n  };\n\n  var isFirefox = function () {\n    return detect$1().browser.isFirefox();\n  };\n\n  var bindFocus = function (container, handler) {\n    if (isFirefox()) {\n      return capture(container, 'focus', handler);\n    } else {\n      return bind(container, 'focusin', handler);\n    }\n  };\n\n  var bindBlur = function (container, handler) {\n    if (isFirefox()) {\n      return capture(container, 'blur', handler);\n    } else {\n      return bind(container, 'focusout', handler);\n    }\n  };\n\n  var setup$d = function (container, rawSettings) {\n    var settings = __assign({\n      stopBackspace: true\n    }, rawSettings);\n\n    var pointerEvents = ['touchstart', 'touchmove', 'touchend', 'touchcancel', 'gesturestart', 'mousedown', 'mouseup', 'mouseover', 'mousemove', 'mouseout', 'click'];\n    var tapEvent = monitor(settings);\n    var simpleEvents = map$2(pointerEvents.concat(['selectstart', 'input', 'contextmenu', 'change', 'transitionend', 'transitioncancel', 'drag', 'dragstart', 'dragend', 'dragenter', 'dragleave', 'dragover', 'drop', 'keyup']), function (type) {\n      return bind(container, type, function (event) {\n        tapEvent.fireIfReady(event, type).each(function (tapStopped) {\n          if (tapStopped) {\n            event.kill();\n          }\n        });\n        var stopped = settings.triggerEvent(type, event);\n\n        if (stopped) {\n          event.kill();\n        }\n      });\n    });\n    var pasteTimeout = value$1();\n    var onPaste = bind(container, 'paste', function (event) {\n      tapEvent.fireIfReady(event, 'paste').each(function (tapStopped) {\n        if (tapStopped) {\n          event.kill();\n        }\n      });\n      var stopped = settings.triggerEvent('paste', event);\n\n      if (stopped) {\n        event.kill();\n      }\n\n      pasteTimeout.set(setTimeout(function () {\n        settings.triggerEvent(postPaste(), event);\n      }, 0));\n    });\n    var onKeydown = bind(container, 'keydown', function (event) {\n      var stopped = settings.triggerEvent('keydown', event);\n\n      if (stopped) {\n        event.kill();\n      } else if (settings.stopBackspace && isDangerous(event)) {\n        event.prevent();\n      }\n    });\n    var onFocusIn = bindFocus(container, function (event) {\n      var stopped = settings.triggerEvent('focusin', event);\n\n      if (stopped) {\n        event.kill();\n      }\n    });\n    var focusoutTimeout = value$1();\n    var onFocusOut = bindBlur(container, function (event) {\n      var stopped = settings.triggerEvent('focusout', event);\n\n      if (stopped) {\n        event.kill();\n      }\n\n      focusoutTimeout.set(setTimeout(function () {\n        settings.triggerEvent(postBlur(), event);\n      }, 0));\n    });\n\n    var unbind = function () {\n      each$1(simpleEvents, function (e) {\n        e.unbind();\n      });\n      onKeydown.unbind();\n      onFocusIn.unbind();\n      onFocusOut.unbind();\n      onPaste.unbind();\n      pasteTimeout.on(clearTimeout);\n      focusoutTimeout.on(clearTimeout);\n    };\n\n    return {\n      unbind: unbind\n    };\n  };\n\n  var derive = function (rawEvent, rawTarget) {\n    var source = get$e(rawEvent, 'target').getOr(rawTarget);\n    return Cell(source);\n  };\n\n  var fromSource = function (event, source) {\n    var stopper = Cell(false);\n    var cutter = Cell(false);\n\n    var stop = function () {\n      stopper.set(true);\n    };\n\n    var cut = function () {\n      cutter.set(true);\n    };\n\n    return {\n      stop: stop,\n      cut: cut,\n      isStopped: stopper.get,\n      isCut: cutter.get,\n      event: event,\n      setSource: source.set,\n      getSource: source.get\n    };\n  };\n\n  var fromExternal = function (event) {\n    var stopper = Cell(false);\n\n    var stop = function () {\n      stopper.set(true);\n    };\n\n    return {\n      stop: stop,\n      cut: noop,\n      isStopped: stopper.get,\n      isCut: never,\n      event: event,\n      setSource: die('Cannot set source of a broadcasted event'),\n      getSource: die('Cannot get source of a broadcasted event')\n    };\n  };\n\n  var adt$1 = Adt.generate([{\n    stopped: []\n  }, {\n    resume: ['element']\n  }, {\n    complete: []\n  }]);\n\n  var doTriggerHandler = function (lookup, eventType, rawEvent, target, source, logger) {\n    var handler = lookup(eventType, target);\n    var simulatedEvent = fromSource(rawEvent, source);\n    return handler.fold(function () {\n      logger.logEventNoHandlers(eventType, target);\n      return adt$1.complete();\n    }, function (handlerInfo) {\n      var descHandler = handlerInfo.descHandler;\n      var eventHandler = getCurried(descHandler);\n      eventHandler(simulatedEvent);\n\n      if (simulatedEvent.isStopped()) {\n        logger.logEventStopped(eventType, handlerInfo.element, descHandler.purpose);\n        return adt$1.stopped();\n      } else if (simulatedEvent.isCut()) {\n        logger.logEventCut(eventType, handlerInfo.element, descHandler.purpose);\n        return adt$1.complete();\n      } else {\n        return parent(handlerInfo.element).fold(function () {\n          logger.logNoParent(eventType, handlerInfo.element, descHandler.purpose);\n          return adt$1.complete();\n        }, function (parent) {\n          logger.logEventResponse(eventType, handlerInfo.element, descHandler.purpose);\n          return adt$1.resume(parent);\n        });\n      }\n    });\n  };\n\n  var doTriggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, source, logger) {\n    return doTriggerHandler(lookup, eventType, rawEvent, rawTarget, source, logger).fold(always, function (parent) {\n      return doTriggerOnUntilStopped(lookup, eventType, rawEvent, parent, source, logger);\n    }, never);\n  };\n\n  var triggerHandler = function (lookup, eventType, rawEvent, target, logger) {\n    var source = derive(rawEvent, target);\n    return doTriggerHandler(lookup, eventType, rawEvent, target, source, logger);\n  };\n\n  var broadcast = function (listeners, rawEvent, _logger) {\n    var simulatedEvent = fromExternal(rawEvent);\n    each$1(listeners, function (listener) {\n      var descHandler = listener.descHandler;\n      var handler = getCurried(descHandler);\n      handler(simulatedEvent);\n    });\n    return simulatedEvent.isStopped();\n  };\n\n  var triggerUntilStopped = function (lookup, eventType, rawEvent, logger) {\n    return triggerOnUntilStopped(lookup, eventType, rawEvent, rawEvent.target, logger);\n  };\n\n  var triggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, logger) {\n    var source = derive(rawEvent, rawTarget);\n    return doTriggerOnUntilStopped(lookup, eventType, rawEvent, rawTarget, source, logger);\n  };\n\n  var eventHandler = function (element, descHandler) {\n    return {\n      element: element,\n      descHandler: descHandler\n    };\n  };\n\n  var broadcastHandler = function (id, handler) {\n    return {\n      id: id,\n      descHandler: handler\n    };\n  };\n\n  var EventRegistry = function () {\n    var registry = {};\n\n    var registerId = function (extraArgs, id, events) {\n      each(events, function (v, k) {\n        var handlers = registry[k] !== undefined ? registry[k] : {};\n        handlers[id] = curryArgs(v, extraArgs);\n        registry[k] = handlers;\n      });\n    };\n\n    var findHandler = function (handlers, elem) {\n      return read$1(elem).bind(function (id) {\n        return get$e(handlers, id);\n      }).map(function (descHandler) {\n        return eventHandler(elem, descHandler);\n      });\n    };\n\n    var filterByType = function (type) {\n      return get$e(registry, type).map(function (handlers) {\n        return mapToArray(handlers, function (f, id) {\n          return broadcastHandler(id, f);\n        });\n      }).getOr([]);\n    };\n\n    var find = function (isAboveRoot, type, target) {\n      return get$e(registry, type).bind(function (handlers) {\n        return closest$4(target, function (elem) {\n          return findHandler(handlers, elem);\n        }, isAboveRoot);\n      });\n    };\n\n    var unregisterId = function (id) {\n      each(registry, function (handlersById, _eventName) {\n        if (has$2(handlersById, id)) {\n          delete handlersById[id];\n        }\n      });\n    };\n\n    return {\n      registerId: registerId,\n      unregisterId: unregisterId,\n      filterByType: filterByType,\n      find: find\n    };\n  };\n\n  var Registry = function () {\n    var events = EventRegistry();\n    var components = {};\n\n    var readOrTag = function (component) {\n      var elem = component.element;\n      return read$1(elem).getOrThunk(function () {\n        return write('uid-', component.element);\n      });\n    };\n\n    var failOnDuplicate = function (component, tagId) {\n      var conflict = components[tagId];\n\n      if (conflict === component) {\n        unregister(component);\n      } else {\n        throw new Error('The tagId \"' + tagId + '\" is already used by: ' + element(conflict.element) + '\\nCannot use it for: ' + element(component.element) + '\\n' + 'The conflicting element is' + (inBody(conflict.element) ? ' ' : ' not ') + 'already in the DOM');\n      }\n    };\n\n    var register = function (component) {\n      var tagId = readOrTag(component);\n\n      if (hasNonNullableKey(components, tagId)) {\n        failOnDuplicate(component, tagId);\n      }\n\n      var extraArgs = [component];\n      events.registerId(extraArgs, tagId, component.events);\n      components[tagId] = component;\n    };\n\n    var unregister = function (component) {\n      read$1(component.element).each(function (tagId) {\n        delete components[tagId];\n        events.unregisterId(tagId);\n      });\n    };\n\n    var filter = function (type) {\n      return events.filterByType(type);\n    };\n\n    var find = function (isAboveRoot, type, target) {\n      return events.find(isAboveRoot, type, target);\n    };\n\n    var getById = function (id) {\n      return get$e(components, id);\n    };\n\n    return {\n      find: find,\n      filter: filter,\n      register: register,\n      unregister: unregister,\n      getById: getById\n    };\n  };\n\n  var factory$j = function (detail) {\n    var _a = detail.dom,\n        attributes = _a.attributes,\n        domWithoutAttributes = __rest(_a, ['attributes']);\n\n    return {\n      uid: detail.uid,\n      dom: __assign({\n        tag: 'div',\n        attributes: __assign({\n          role: 'presentation'\n        }, attributes)\n      }, domWithoutAttributes),\n      components: detail.components,\n      behaviours: get$2(detail.containerBehaviours),\n      events: detail.events,\n      domModification: detail.domModification,\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var Container = single({\n    name: 'Container',\n    factory: factory$j,\n    configFields: [defaulted('components', []), field('containerBehaviours', []), defaulted('events', {}), defaulted('domModification', {}), defaulted('eventOrder', {})]\n  });\n\n  var takeover = function (root) {\n    var isAboveRoot = function (el) {\n      return parent(root.element).fold(always, function (parent) {\n        return eq(el, parent);\n      });\n    };\n\n    var registry = Registry();\n\n    var lookup = function (eventName, target) {\n      return registry.find(isAboveRoot, eventName, target);\n    };\n\n    var domEvents = setup$d(root.element, {\n      triggerEvent: function (eventName, event) {\n        return monitorEvent(eventName, event.target, function (logger) {\n          return triggerUntilStopped(lookup, eventName, event, logger);\n        });\n      }\n    });\n    var systemApi = {\n      debugInfo: constant$1('real'),\n      triggerEvent: function (eventName, target, data) {\n        monitorEvent(eventName, target, function (logger) {\n          return triggerOnUntilStopped(lookup, eventName, data, target, logger);\n        });\n      },\n      triggerFocus: function (target, originator) {\n        read$1(target).fold(function () {\n          focus$3(target);\n        }, function (_alloyId) {\n          monitorEvent(focus$4(), target, function (logger) {\n            triggerHandler(lookup, focus$4(), {\n              originator: originator,\n              kill: noop,\n              prevent: noop,\n              target: target\n            }, target, logger);\n            return false;\n          });\n        });\n      },\n      triggerEscape: function (comp, simulatedEvent) {\n        systemApi.triggerEvent('keydown', comp.element, simulatedEvent.event);\n      },\n      getByUid: function (uid) {\n        return getByUid(uid);\n      },\n      getByDom: function (elem) {\n        return getByDom(elem);\n      },\n      build: build$1,\n      addToGui: function (c) {\n        add(c);\n      },\n      removeFromGui: function (c) {\n        remove(c);\n      },\n      addToWorld: function (c) {\n        addToWorld(c);\n      },\n      removeFromWorld: function (c) {\n        removeFromWorld(c);\n      },\n      broadcast: function (message) {\n        broadcast$1(message);\n      },\n      broadcastOn: function (channels, message) {\n        broadcastOn(channels, message);\n      },\n      broadcastEvent: function (eventName, event) {\n        broadcastEvent(eventName, event);\n      },\n      isConnected: always\n    };\n\n    var addToWorld = function (component) {\n      component.connect(systemApi);\n\n      if (!isText$1(component.element)) {\n        registry.register(component);\n        each$1(component.components(), addToWorld);\n        systemApi.triggerEvent(systemInit(), component.element, {\n          target: component.element\n        });\n      }\n    };\n\n    var removeFromWorld = function (component) {\n      if (!isText$1(component.element)) {\n        each$1(component.components(), removeFromWorld);\n        registry.unregister(component);\n      }\n\n      component.disconnect();\n    };\n\n    var add = function (component) {\n      attach(root, component);\n    };\n\n    var remove = function (component) {\n      detach(component);\n    };\n\n    var destroy = function () {\n      domEvents.unbind();\n      remove$5(root.element);\n    };\n\n    var broadcastData = function (data) {\n      var receivers = registry.filter(receive());\n      each$1(receivers, function (receiver) {\n        var descHandler = receiver.descHandler;\n        var handler = getCurried(descHandler);\n        handler(data);\n      });\n    };\n\n    var broadcast$1 = function (message) {\n      broadcastData({\n        universal: true,\n        data: message\n      });\n    };\n\n    var broadcastOn = function (channels, message) {\n      broadcastData({\n        universal: false,\n        channels: channels,\n        data: message\n      });\n    };\n\n    var broadcastEvent = function (eventName, event) {\n      var listeners = registry.filter(eventName);\n      return broadcast(listeners, event);\n    };\n\n    var getByUid = function (uid) {\n      return registry.getById(uid).fold(function () {\n        return Result.error(new Error('Could not find component with uid: \"' + uid + '\" in system.'));\n      }, Result.value);\n    };\n\n    var getByDom = function (elem) {\n      var uid = read$1(elem).getOr('not found');\n      return getByUid(uid);\n    };\n\n    addToWorld(root);\n    return {\n      root: root,\n      element: root.element,\n      destroy: destroy,\n      add: add,\n      remove: remove,\n      getByUid: getByUid,\n      getByDom: getByDom,\n      addToWorld: addToWorld,\n      removeFromWorld: removeFromWorld,\n      broadcast: broadcast$1,\n      broadcastOn: broadcastOn,\n      broadcastEvent: broadcastEvent\n    };\n  };\n\n  var renderBar = function (spec, backstage) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-bar', 'tox-form__controls-h-stack']\n      },\n      components: map$2(spec.items, backstage.interpreter)\n    };\n  };\n\n  var schema$l = constant$1([defaulted('prefix', 'form-field'), field('fieldBehaviours', [Composing, Representing])]);\n  var parts$e = constant$1([optional({\n    schema: [required$1('dom')],\n    name: 'label'\n  }), optional({\n    factory: {\n      sketch: function (spec) {\n        return {\n          uid: spec.uid,\n          dom: {\n            tag: 'span',\n            styles: {\n              display: 'none'\n            },\n            attributes: {\n              'aria-hidden': 'true'\n            },\n            innerHtml: spec.text\n          }\n        };\n      }\n    },\n    schema: [required$1('text')],\n    name: 'aria-descriptor'\n  }), required({\n    factory: {\n      sketch: function (spec) {\n        var excludeFactory = exclude(spec, ['factory']);\n        return spec.factory.sketch(excludeFactory);\n      }\n    },\n    schema: [required$1('factory')],\n    name: 'field'\n  })]);\n\n  var factory$i = function (detail, components, _spec, _externals) {\n    var behaviours = augment(detail.fieldBehaviours, [Composing.config({\n      find: function (container) {\n        return getPart(container, detail, 'field');\n      }\n    }), Representing.config({\n      store: {\n        mode: 'manual',\n        getValue: function (field) {\n          return Composing.getCurrent(field).bind(Representing.getValue);\n        },\n        setValue: function (field, value) {\n          Composing.getCurrent(field).each(function (current) {\n            Representing.setValue(current, value);\n          });\n        }\n      }\n    })]);\n    var events = derive$2([runOnAttached(function (component, _simulatedEvent) {\n      var ps = getParts(component, detail, ['label', 'field', 'aria-descriptor']);\n      ps.field().each(function (field) {\n        var id = generate$6(detail.prefix);\n        ps.label().each(function (label) {\n          set$8(label.element, 'for', id);\n          set$8(field.element, 'id', id);\n        });\n        ps['aria-descriptor']().each(function (descriptor) {\n          var descriptorId = generate$6(detail.prefix);\n          set$8(descriptor.element, 'id', descriptorId);\n          set$8(field.element, 'aria-describedby', descriptorId);\n        });\n      });\n    })]);\n    var apis = {\n      getField: function (container) {\n        return getPart(container, detail, 'field');\n      },\n      getLabel: function (container) {\n        return getPart(container, detail, 'label');\n      }\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: behaviours,\n      events: events,\n      apis: apis\n    };\n  };\n\n  var FormField = composite({\n    name: 'FormField',\n    configFields: schema$l(),\n    partFields: parts$e(),\n    factory: factory$i,\n    apis: {\n      getField: function (apis, comp) {\n        return apis.getField(comp);\n      },\n      getLabel: function (apis, comp) {\n        return apis.getLabel(comp);\n      }\n    }\n  });\n\n  var exhibit$2 = function (base, tabConfig) {\n    return nu$7({\n      attributes: wrapAll([{\n        key: tabConfig.tabAttr,\n        value: 'true'\n      }])\n    });\n  };\n\n  var ActiveTabstopping = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$2\n  });\n  var TabstopSchema = [defaulted('tabAttr', 'data-alloy-tabstop')];\n  var Tabstopping = create$7({\n    fields: TabstopSchema,\n    name: 'tabstopping',\n    active: ActiveTabstopping\n  });\n  var global$7 = tinymce.util.Tools.resolve('tinymce.html.Entities');\n\n  var renderFormFieldWith = function (pLabel, pField, extraClasses, extraBehaviours) {\n    var spec = renderFormFieldSpecWith(pLabel, pField, extraClasses, extraBehaviours);\n    return FormField.sketch(spec);\n  };\n\n  var renderFormField = function (pLabel, pField) {\n    return renderFormFieldWith(pLabel, pField, [], []);\n  };\n\n  var renderFormFieldSpecWith = function (pLabel, pField, extraClasses, extraBehaviours) {\n    return {\n      dom: renderFormFieldDomWith(extraClasses),\n      components: pLabel.toArray().concat([pField]),\n      fieldBehaviours: derive$1(extraBehaviours)\n    };\n  };\n\n  var renderFormFieldDom = function () {\n    return renderFormFieldDomWith([]);\n  };\n\n  var renderFormFieldDomWith = function (extraClasses) {\n    return {\n      tag: 'div',\n      classes: ['tox-form__group'].concat(extraClasses)\n    };\n  };\n\n  var renderLabel$2 = function (label, providersBackstage) {\n    return FormField.parts.label({\n      dom: {\n        tag: 'label',\n        classes: ['tox-label'],\n        innerHtml: providersBackstage.translate(label)\n      }\n    });\n  };\n\n  var formChangeEvent = generate$6('form-component-change');\n  var formCloseEvent = generate$6('form-close');\n  var formCancelEvent = generate$6('form-cancel');\n  var formActionEvent = generate$6('form-action');\n  var formSubmitEvent = generate$6('form-submit');\n  var formBlockEvent = generate$6('form-block');\n  var formUnblockEvent = generate$6('form-unblock');\n  var formTabChangeEvent = generate$6('form-tabchange');\n  var formResizeEvent = generate$6('form-resize');\n\n  var renderCollection = function (spec, providersBackstage) {\n    var _a;\n\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel$2(label, providersBackstage);\n    });\n\n    var runOnItem = function (f) {\n      return function (comp, se) {\n        closest$1(se.event.target, '[data-collection-item-value]').each(function (target) {\n          f(comp, se, target, get$d(target, 'data-collection-item-value'));\n        });\n      };\n    };\n\n    var setContents = function (comp, items) {\n      var htmlLines = map$2(items, function (item) {\n        var itemText = global$e.translate(item.text);\n        var textContent = spec.columns === 1 ? '<div class=\"tox-collection__item-label\">' + itemText + '</div>' : '';\n        var iconContent = '<div class=\"tox-collection__item-icon\">' + item.icon + '</div>';\n        var mapItemName = {\n          '_': ' ',\n          ' - ': ' ',\n          '-': ' '\n        };\n        var ariaLabel = itemText.replace(/\\_| \\- |\\-/g, function (match) {\n          return mapItemName[match];\n        });\n        var disabledClass = providersBackstage.isDisabled() ? ' tox-collection__item--state-disabled' : '';\n        return '<div class=\"tox-collection__item' + disabledClass + '\" tabindex=\"-1\" data-collection-item-value=\"' + global$7.encodeAllRaw(item.value) + '\" title=\"' + ariaLabel + '\" aria-label=\"' + ariaLabel + '\">' + iconContent + textContent + '</div>';\n      });\n      var chunks = spec.columns !== 'auto' && spec.columns > 1 ? chunk$1(htmlLines, spec.columns) : [htmlLines];\n      var html = map$2(chunks, function (ch) {\n        return '<div class=\"tox-collection__group\">' + ch.join('') + '</div>';\n      });\n      set$5(comp.element, html.join(''));\n    };\n\n    var onClick = runOnItem(function (comp, se, tgt, itemValue) {\n      se.stop();\n\n      if (!providersBackstage.isDisabled()) {\n        emitWith(comp, formActionEvent, {\n          name: spec.name,\n          value: itemValue\n        });\n      }\n    });\n    var collectionEvents = [run$1(mouseover(), runOnItem(function (comp, se, tgt) {\n      focus$3(tgt);\n    })), run$1(click(), onClick), run$1(tap(), onClick), run$1(focusin(), runOnItem(function (comp, se, tgt) {\n      descendant(comp.element, '.' + activeClass).each(function (currentActive) {\n        remove$2(currentActive, activeClass);\n      });\n      add$2(tgt, activeClass);\n    })), run$1(focusout(), runOnItem(function (comp) {\n      descendant(comp.element, '.' + activeClass).each(function (currentActive) {\n        remove$2(currentActive, activeClass);\n      });\n    })), runOnExecute$1(runOnItem(function (comp, se, tgt, itemValue) {\n      emitWith(comp, formActionEvent, {\n        name: spec.name,\n        value: itemValue\n      });\n    }))];\n\n    var iterCollectionItems = function (comp, applyAttributes) {\n      return map$2(descendants(comp.element, '.tox-collection__item'), applyAttributes);\n    };\n\n    var pField = FormField.parts.field({\n      dom: {\n        tag: 'div',\n        classes: ['tox-collection'].concat(spec.columns !== 1 ? ['tox-collection--grid'] : ['tox-collection--list'])\n      },\n      components: [],\n      factory: {\n        sketch: identity$1\n      },\n      behaviours: derive$1([Disabling.config({\n        disabled: providersBackstage.isDisabled,\n        onDisabled: function (comp) {\n          iterCollectionItems(comp, function (childElm) {\n            add$2(childElm, 'tox-collection__item--state-disabled');\n            set$8(childElm, 'aria-disabled', true);\n          });\n        },\n        onEnabled: function (comp) {\n          iterCollectionItems(comp, function (childElm) {\n            remove$2(childElm, 'tox-collection__item--state-disabled');\n            remove$7(childElm, 'aria-disabled');\n          });\n        }\n      }), receivingConfig(), Replacing.config({}), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: []\n        },\n        onSetValue: function (comp, items) {\n          setContents(comp, items);\n\n          if (spec.columns === 'auto') {\n            detectSize(comp, 5, 'tox-collection__item').each(function (_a) {\n              var numRows = _a.numRows,\n                  numColumns = _a.numColumns;\n              Keying.setGridSize(comp, numRows, numColumns);\n            });\n          }\n\n          emit(comp, formResizeEvent);\n        }\n      }), Tabstopping.config({}), Keying.config(deriveCollectionMovement(spec.columns, 'normal')), config('collection-events', collectionEvents)]),\n      eventOrder: (_a = {}, _a[execute$5()] = ['disabling', 'alloy.base.behaviour', 'collection-events'], _a)\n    });\n    var extraClasses = ['tox-form__group--collection'];\n    return renderFormFieldWith(pLabel, pField, extraClasses, []);\n  };\n\n  var schema$k = constant$1([option('data'), defaulted('inputAttributes', {}), defaulted('inputStyles', {}), defaulted('tag', 'input'), defaulted('inputClasses', []), onHandler('onSetValue'), defaulted('styles', {}), defaulted('eventOrder', {}), field('inputBehaviours', [Representing, Focusing]), defaulted('selectOnFocus', true)]);\n\n  var focusBehaviours = function (detail) {\n    return derive$1([Focusing.config({\n      onFocus: !detail.selectOnFocus ? noop : function (component) {\n        var input = component.element;\n        var value = get$5(input);\n        input.dom.setSelectionRange(0, value.length);\n      }\n    })]);\n  };\n\n  var behaviours = function (detail) {\n    return __assign(__assign({}, focusBehaviours(detail)), augment(detail.inputBehaviours, [Representing.config({\n      store: __assign(__assign({\n        mode: 'manual'\n      }, detail.data.map(function (data) {\n        return {\n          initialValue: data\n        };\n      }).getOr({})), {\n        getValue: function (input) {\n          return get$5(input.element);\n        },\n        setValue: function (input, data) {\n          var current = get$5(input.element);\n\n          if (current !== data) {\n            set$4(input.element, data);\n          }\n        }\n      }),\n      onSetValue: detail.onSetValue\n    })]));\n  };\n\n  var dom = function (detail) {\n    return {\n      tag: detail.tag,\n      attributes: __assign({\n        type: 'text'\n      }, detail.inputAttributes),\n      styles: detail.inputStyles,\n      classes: detail.inputClasses\n    };\n  };\n\n  var factory$h = function (detail, _spec) {\n    return {\n      uid: detail.uid,\n      dom: dom(detail),\n      components: [],\n      behaviours: behaviours(detail),\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var Input = single({\n    name: 'Input',\n    configFields: schema$k(),\n    factory: factory$h\n  });\n  var exports$1 = {},\n      module = {\n    exports: exports$1\n  };\n\n  (function (define, exports, module, require) {\n    (function (global, factory) {\n      typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.EphoxContactWrapper = factory());\n    })(this, function () {\n      var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n      var promise = {\n        exports: {}\n      };\n\n      (function (module) {\n        (function (root) {\n          var setTimeoutFunc = setTimeout;\n\n          function noop() {}\n\n          function bind(fn, thisArg) {\n            return function () {\n              fn.apply(thisArg, arguments);\n            };\n          }\n\n          function Promise(fn) {\n            if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n            if (typeof fn !== 'function') throw new TypeError('not a function');\n            this._state = 0;\n            this._handled = false;\n            this._value = undefined;\n            this._deferreds = [];\n            doResolve(fn, this);\n          }\n\n          function handle(self, deferred) {\n            while (self._state === 3) {\n              self = self._value;\n            }\n\n            if (self._state === 0) {\n              self._deferreds.push(deferred);\n\n              return;\n            }\n\n            self._handled = true;\n\n            Promise._immediateFn(function () {\n              var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n\n              if (cb === null) {\n                (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                return;\n              }\n\n              var ret;\n\n              try {\n                ret = cb(self._value);\n              } catch (e) {\n                reject(deferred.promise, e);\n                return;\n              }\n\n              resolve(deferred.promise, ret);\n            });\n          }\n\n          function resolve(self, newValue) {\n            try {\n              if (newValue === self) throw new TypeError('A promise cannot be resolved with itself.');\n\n              if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                var then = newValue.then;\n\n                if (newValue instanceof Promise) {\n                  self._state = 3;\n                  self._value = newValue;\n                  finale(self);\n                  return;\n                } else if (typeof then === 'function') {\n                  doResolve(bind(then, newValue), self);\n                  return;\n                }\n              }\n\n              self._state = 1;\n              self._value = newValue;\n              finale(self);\n            } catch (e) {\n              reject(self, e);\n            }\n          }\n\n          function reject(self, newValue) {\n            self._state = 2;\n            self._value = newValue;\n            finale(self);\n          }\n\n          function finale(self) {\n            if (self._state === 2 && self._deferreds.length === 0) {\n              Promise._immediateFn(function () {\n                if (!self._handled) {\n                  Promise._unhandledRejectionFn(self._value);\n                }\n              });\n            }\n\n            for (var i = 0, len = self._deferreds.length; i < len; i++) {\n              handle(self, self._deferreds[i]);\n            }\n\n            self._deferreds = null;\n          }\n\n          function Handler(onFulfilled, onRejected, promise) {\n            this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n            this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n            this.promise = promise;\n          }\n\n          function doResolve(fn, self) {\n            var done = false;\n\n            try {\n              fn(function (value) {\n                if (done) return;\n                done = true;\n                resolve(self, value);\n              }, function (reason) {\n                if (done) return;\n                done = true;\n                reject(self, reason);\n              });\n            } catch (ex) {\n              if (done) return;\n              done = true;\n              reject(self, ex);\n            }\n          }\n\n          Promise.prototype['catch'] = function (onRejected) {\n            return this.then(null, onRejected);\n          };\n\n          Promise.prototype.then = function (onFulfilled, onRejected) {\n            var prom = new this.constructor(noop);\n            handle(this, new Handler(onFulfilled, onRejected, prom));\n            return prom;\n          };\n\n          Promise.all = function (arr) {\n            var args = Array.prototype.slice.call(arr);\n            return new Promise(function (resolve, reject) {\n              if (args.length === 0) return resolve([]);\n              var remaining = args.length;\n\n              function res(i, val) {\n                try {\n                  if (val && (typeof val === 'object' || typeof val === 'function')) {\n                    var then = val.then;\n\n                    if (typeof then === 'function') {\n                      then.call(val, function (val) {\n                        res(i, val);\n                      }, reject);\n                      return;\n                    }\n                  }\n\n                  args[i] = val;\n\n                  if (--remaining === 0) {\n                    resolve(args);\n                  }\n                } catch (ex) {\n                  reject(ex);\n                }\n              }\n\n              for (var i = 0; i < args.length; i++) {\n                res(i, args[i]);\n              }\n            });\n          };\n\n          Promise.resolve = function (value) {\n            if (value && typeof value === 'object' && value.constructor === Promise) {\n              return value;\n            }\n\n            return new Promise(function (resolve) {\n              resolve(value);\n            });\n          };\n\n          Promise.reject = function (value) {\n            return new Promise(function (resolve, reject) {\n              reject(value);\n            });\n          };\n\n          Promise.race = function (values) {\n            return new Promise(function (resolve, reject) {\n              for (var i = 0, len = values.length; i < len; i++) {\n                values[i].then(resolve, reject);\n              }\n            });\n          };\n\n          Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n            setImmediate(fn);\n          } : function (fn) {\n            setTimeoutFunc(fn, 0);\n          };\n\n          Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n            if (typeof console !== 'undefined' && console) {\n              console.warn('Possible Unhandled Promise Rejection:', err);\n            }\n          };\n\n          Promise._setImmediateFn = function _setImmediateFn(fn) {\n            Promise._immediateFn = fn;\n          };\n\n          Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n            Promise._unhandledRejectionFn = fn;\n          };\n\n          if (module.exports) {\n            module.exports = Promise;\n          } else if (!root.Promise) {\n            root.Promise = Promise;\n          }\n        })(commonjsGlobal);\n      })(promise);\n\n      var promisePolyfill = promise.exports;\n\n      var Global = function () {\n        if (typeof window !== 'undefined') {\n          return window;\n        } else {\n          return Function('return this;')();\n        }\n      }();\n\n      var promisePolyfill_1 = {\n        boltExport: Global.Promise || promisePolyfill\n      };\n      return promisePolyfill_1;\n    });\n  })(undefined, exports$1, module);\n\n  var Promise$1 = module.exports.boltExport;\n\n  var nu$3 = function (baseFn) {\n    var data = Optional.none();\n    var callbacks = [];\n\n    var map = function (f) {\n      return nu$3(function (nCallback) {\n        get(function (data) {\n          nCallback(f(data));\n        });\n      });\n    };\n\n    var get = function (nCallback) {\n      if (isReady()) {\n        call(nCallback);\n      } else {\n        callbacks.push(nCallback);\n      }\n    };\n\n    var set = function (x) {\n      if (!isReady()) {\n        data = Optional.some(x);\n        run(callbacks);\n        callbacks = [];\n      }\n    };\n\n    var isReady = function () {\n      return data.isSome();\n    };\n\n    var run = function (cbs) {\n      each$1(cbs, call);\n    };\n\n    var call = function (cb) {\n      data.each(function (x) {\n        setTimeout(function () {\n          cb(x);\n        }, 0);\n      });\n    };\n\n    baseFn(set);\n    return {\n      get: get,\n      map: map,\n      isReady: isReady\n    };\n  };\n\n  var pure$1 = function (a) {\n    return nu$3(function (callback) {\n      callback(a);\n    });\n  };\n\n  var LazyValue = {\n    nu: nu$3,\n    pure: pure$1\n  };\n\n  var errorReporter = function (err) {\n    setTimeout(function () {\n      throw err;\n    }, 0);\n  };\n\n  var make$5 = function (run) {\n    var get = function (callback) {\n      run().then(callback, errorReporter);\n    };\n\n    var map = function (fab) {\n      return make$5(function () {\n        return run().then(fab);\n      });\n    };\n\n    var bind = function (aFutureB) {\n      return make$5(function () {\n        return run().then(function (v) {\n          return aFutureB(v).toPromise();\n        });\n      });\n    };\n\n    var anonBind = function (futureB) {\n      return make$5(function () {\n        return run().then(function () {\n          return futureB.toPromise();\n        });\n      });\n    };\n\n    var toLazy = function () {\n      return LazyValue.nu(get);\n    };\n\n    var toCached = function () {\n      var cache = null;\n      return make$5(function () {\n        if (cache === null) {\n          cache = run();\n        }\n\n        return cache;\n      });\n    };\n\n    var toPromise = run;\n    return {\n      map: map,\n      bind: bind,\n      anonBind: anonBind,\n      toLazy: toLazy,\n      toCached: toCached,\n      toPromise: toPromise,\n      get: get\n    };\n  };\n\n  var nu$2 = function (baseFn) {\n    return make$5(function () {\n      return new Promise$1(baseFn);\n    });\n  };\n\n  var pure = function (a) {\n    return make$5(function () {\n      return Promise$1.resolve(a);\n    });\n  };\n\n  var Future = {\n    nu: nu$2,\n    pure: pure\n  };\n  var ariaElements = ['input', 'textarea'];\n\n  var isAriaElement = function (elem) {\n    var name = name$2(elem);\n    return contains$2(ariaElements, name);\n  };\n\n  var markValid = function (component, invalidConfig) {\n    var elem = invalidConfig.getRoot(component).getOr(component.element);\n    remove$2(elem, invalidConfig.invalidClass);\n    invalidConfig.notify.each(function (notifyInfo) {\n      if (isAriaElement(component.element)) {\n        set$8(component.element, 'aria-invalid', false);\n      }\n\n      notifyInfo.getContainer(component).each(function (container) {\n        set$5(container, notifyInfo.validHtml);\n      });\n      notifyInfo.onValid(component);\n    });\n  };\n\n  var markInvalid = function (component, invalidConfig, invalidState, text) {\n    var elem = invalidConfig.getRoot(component).getOr(component.element);\n    add$2(elem, invalidConfig.invalidClass);\n    invalidConfig.notify.each(function (notifyInfo) {\n      if (isAriaElement(component.element)) {\n        set$8(component.element, 'aria-invalid', true);\n      }\n\n      notifyInfo.getContainer(component).each(function (container) {\n        set$5(container, text);\n      });\n      notifyInfo.onInvalid(component, text);\n    });\n  };\n\n  var query = function (component, invalidConfig, _invalidState) {\n    return invalidConfig.validator.fold(function () {\n      return Future.pure(Result.value(true));\n    }, function (validatorInfo) {\n      return validatorInfo.validate(component);\n    });\n  };\n\n  var run = function (component, invalidConfig, invalidState) {\n    invalidConfig.notify.each(function (notifyInfo) {\n      notifyInfo.onValidate(component);\n    });\n    return query(component, invalidConfig).map(function (valid) {\n      if (component.getSystem().isConnected()) {\n        return valid.fold(function (err) {\n          markInvalid(component, invalidConfig, invalidState, err);\n          return Result.error(err);\n        }, function (v) {\n          markValid(component, invalidConfig);\n          return Result.value(v);\n        });\n      } else {\n        return Result.error('No longer in system');\n      }\n    });\n  };\n\n  var isInvalid = function (component, invalidConfig) {\n    var elem = invalidConfig.getRoot(component).getOr(component.element);\n    return has(elem, invalidConfig.invalidClass);\n  };\n\n  var InvalidateApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    markValid: markValid,\n    markInvalid: markInvalid,\n    query: query,\n    run: run,\n    isInvalid: isInvalid\n  });\n\n  var events$8 = function (invalidConfig, invalidState) {\n    return invalidConfig.validator.map(function (validatorInfo) {\n      return derive$2([run$1(validatorInfo.onEvent, function (component) {\n        run(component, invalidConfig, invalidState).get(identity$1);\n      })].concat(validatorInfo.validateOnLoad ? [runOnAttached(function (component) {\n        run(component, invalidConfig, invalidState).get(noop);\n      })] : []));\n    }).getOr({});\n  };\n\n  var ActiveInvalidate = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$8\n  });\n  var InvalidateSchema = [required$1('invalidClass'), defaulted('getRoot', Optional.none), optionObjOf('notify', [defaulted('aria', 'alert'), defaulted('getContainer', Optional.none), defaulted('validHtml', ''), onHandler('onValid'), onHandler('onInvalid'), onHandler('onValidate')]), optionObjOf('validator', [required$1('validate'), defaulted('onEvent', 'input'), defaulted('validateOnLoad', true)])];\n  var Invalidating = create$7({\n    fields: InvalidateSchema,\n    name: 'invalidating',\n    active: ActiveInvalidate,\n    apis: InvalidateApis,\n    extra: {\n      validation: function (validator) {\n        return function (component) {\n          var v = Representing.getValue(component);\n          return Future.pure(validator(v));\n        };\n      }\n    }\n  });\n\n  var getCoupled = function (component, coupleConfig, coupleState, name) {\n    return coupleState.getOrCreate(component, coupleConfig, name);\n  };\n\n  var CouplingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getCoupled: getCoupled\n  });\n  var CouplingSchema = [requiredOf('others', setOf(Result.value, anyValue()))];\n\n  var init$a = function () {\n    var coupled = {};\n\n    var getOrCreate = function (component, coupleConfig, name) {\n      var available = keys(coupleConfig.others);\n\n      if (!available) {\n        throw new Error('Cannot find coupled component: ' + name + '. Known coupled components: ' + JSON.stringify(available, null, 2));\n      } else {\n        return get$e(coupled, name).getOrThunk(function () {\n          var builder = get$e(coupleConfig.others, name).getOrDie('No information found for coupled component: ' + name);\n          var spec = builder(component);\n          var built = component.getSystem().build(spec);\n          coupled[name] = built;\n          return built;\n        });\n      }\n    };\n\n    var readState = constant$1({});\n    return nu$8({\n      readState: readState,\n      getOrCreate: getOrCreate\n    });\n  };\n\n  var CouplingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$a\n  });\n  var Coupling = create$7({\n    fields: CouplingSchema,\n    name: 'coupling',\n    apis: CouplingApis,\n    state: CouplingState\n  });\n  var suffix = constant$1('sink');\n  var partType$1 = constant$1(optional({\n    name: suffix(),\n    overrides: constant$1({\n      dom: {\n        tag: 'div'\n      },\n      behaviours: derive$1([Positioning.config({\n        useFixed: always\n      })]),\n      events: derive$2([cutter(keydown()), cutter(mousedown()), cutter(click())])\n    })\n  }));\n  var HighlightOnOpen;\n\n  (function (HighlightOnOpen) {\n    HighlightOnOpen[HighlightOnOpen['HighlightFirst'] = 0] = 'HighlightFirst';\n    HighlightOnOpen[HighlightOnOpen['HighlightNone'] = 1] = 'HighlightNone';\n  })(HighlightOnOpen || (HighlightOnOpen = {}));\n\n  var getAnchor = function (detail, component) {\n    var hotspot = detail.getHotspot(component).getOr(component);\n    var type = 'hotspot';\n    var overrides = detail.getAnchorOverrides();\n    return detail.layouts.fold(function () {\n      return {\n        type: type,\n        hotspot: hotspot,\n        overrides: overrides\n      };\n    }, function (layouts) {\n      return {\n        type: type,\n        hotspot: hotspot,\n        overrides: overrides,\n        layouts: layouts\n      };\n    });\n  };\n\n  var fetch = function (detail, mapFetch, component) {\n    var fetcher = detail.fetch;\n    return fetcher(component).map(mapFetch);\n  };\n\n  var openF = function (detail, mapFetch, anchor, component, sandbox, externals, highlightOnOpen) {\n    var futureData = fetch(detail, mapFetch, component);\n    var getLazySink = getSink(component, detail);\n    return futureData.map(function (tdata) {\n      return tdata.bind(function (data) {\n        return Optional.from(tieredMenu.sketch(__assign(__assign({}, externals.menu()), {\n          uid: generate$5(''),\n          data: data,\n          highlightImmediately: highlightOnOpen === HighlightOnOpen.HighlightFirst,\n          onOpenMenu: function (tmenu, menu) {\n            var sink = getLazySink().getOrDie();\n            Positioning.position(sink, menu, {\n              anchor: anchor\n            });\n            Sandboxing.decloak(sandbox);\n          },\n          onOpenSubmenu: function (tmenu, item, submenu) {\n            var sink = getLazySink().getOrDie();\n            Positioning.position(sink, submenu, {\n              anchor: {\n                type: 'submenu',\n                item: item\n              }\n            });\n            Sandboxing.decloak(sandbox);\n          },\n          onRepositionMenu: function (tmenu, primaryMenu, submenuTriggers) {\n            var sink = getLazySink().getOrDie();\n            Positioning.position(sink, primaryMenu, {\n              anchor: anchor\n            });\n            each$1(submenuTriggers, function (st) {\n              Positioning.position(sink, st.triggeredMenu, {\n                anchor: {\n                  type: 'submenu',\n                  item: st.triggeringItem\n                }\n              });\n            });\n          },\n          onEscape: function () {\n            Focusing.focus(component);\n            Sandboxing.close(sandbox);\n            return Optional.some(true);\n          }\n        })));\n      });\n    });\n  };\n\n  var open = function (detail, mapFetch, hotspot, sandbox, externals, onOpenSync, highlightOnOpen) {\n    var anchor = getAnchor(detail, hotspot);\n    var processed = openF(detail, mapFetch, anchor, hotspot, sandbox, externals, highlightOnOpen);\n    return processed.map(function (tdata) {\n      tdata.fold(function () {\n        if (Sandboxing.isOpen(sandbox)) {\n          Sandboxing.close(sandbox);\n        }\n      }, function (data) {\n        Sandboxing.cloak(sandbox);\n        Sandboxing.open(sandbox, data);\n        onOpenSync(sandbox);\n      });\n      return sandbox;\n    });\n  };\n\n  var close = function (detail, mapFetch, component, sandbox, _externals, _onOpenSync, _highlightOnOpen) {\n    Sandboxing.close(sandbox);\n    return Future.pure(sandbox);\n  };\n\n  var togglePopup = function (detail, mapFetch, hotspot, externals, onOpenSync, highlightOnOpen) {\n    var sandbox = Coupling.getCoupled(hotspot, 'sandbox');\n    var showing = Sandboxing.isOpen(sandbox);\n    var action = showing ? close : open;\n    return action(detail, mapFetch, hotspot, sandbox, externals, onOpenSync, highlightOnOpen);\n  };\n\n  var matchWidth = function (hotspot, container, useMinWidth) {\n    var menu = Composing.getCurrent(container).getOr(container);\n    var buttonWidth = get$a(hotspot.element);\n\n    if (useMinWidth) {\n      set$7(menu.element, 'min-width', buttonWidth + 'px');\n    } else {\n      set$6(menu.element, buttonWidth);\n    }\n  };\n\n  var getSink = function (anyInSystem, sinkDetail) {\n    return anyInSystem.getSystem().getByUid(sinkDetail.uid + '-' + suffix()).map(function (internalSink) {\n      return function () {\n        return Result.value(internalSink);\n      };\n    }).getOrThunk(function () {\n      return sinkDetail.lazySink.fold(function () {\n        return function () {\n          return Result.error(new Error('No internal sink is specified, nor could an external sink be found'));\n        };\n      }, function (lazySinkFn) {\n        return function () {\n          return lazySinkFn(anyInSystem);\n        };\n      });\n    });\n  };\n\n  var doRepositionMenus = function (sandbox) {\n    Sandboxing.getState(sandbox).each(function (tmenu) {\n      tieredMenu.repositionMenus(tmenu);\n    });\n  };\n\n  var makeSandbox$1 = function (detail, hotspot, extras) {\n    var ariaOwner = manager();\n\n    var onOpen = function (component, menu) {\n      var anchor = getAnchor(detail, hotspot);\n      ariaOwner.link(hotspot.element);\n\n      if (detail.matchWidth) {\n        matchWidth(anchor.hotspot, menu, detail.useMinWidth);\n      }\n\n      detail.onOpen(anchor, component, menu);\n\n      if (extras !== undefined && extras.onOpen !== undefined) {\n        extras.onOpen(component, menu);\n      }\n    };\n\n    var onClose = function (component, menu) {\n      ariaOwner.unlink(hotspot.element);\n\n      if (extras !== undefined && extras.onClose !== undefined) {\n        extras.onClose(component, menu);\n      }\n    };\n\n    var lazySink = getSink(hotspot, detail);\n    return {\n      dom: {\n        tag: 'div',\n        classes: detail.sandboxClasses,\n        attributes: {\n          id: ariaOwner.id,\n          role: 'listbox'\n        }\n      },\n      behaviours: SketchBehaviours.augment(detail.sandboxBehaviours, [Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: hotspot\n        }\n      }), Sandboxing.config({\n        onOpen: onOpen,\n        onClose: onClose,\n        isPartOf: function (container, data, queryElem) {\n          return isPartOf$1(data, queryElem) || isPartOf$1(hotspot, queryElem);\n        },\n        getAttachPoint: function () {\n          return lazySink().getOrDie();\n        }\n      }), Composing.config({\n        find: function (sandbox) {\n          return Sandboxing.getState(sandbox).bind(function (menu) {\n            return Composing.getCurrent(menu);\n          });\n        }\n      }), Receiving.config({\n        channels: __assign(__assign({}, receivingChannel$1({\n          isExtraPart: never\n        })), receivingChannel({\n          doReposition: doRepositionMenus\n        }))\n      })])\n    };\n  };\n\n  var repositionMenus = function (comp) {\n    var sandbox = Coupling.getCoupled(comp, 'sandbox');\n    doRepositionMenus(sandbox);\n  };\n\n  var sandboxFields = function () {\n    return [defaulted('sandboxClasses', []), SketchBehaviours.field('sandboxBehaviours', [Composing, Receiving, Sandboxing, Representing])];\n  };\n\n  var schema$j = constant$1([required$1('dom'), required$1('fetch'), onHandler('onOpen'), onKeyboardHandler('onExecute'), defaulted('getHotspot', Optional.some), defaulted('getAnchorOverrides', constant$1({})), schema$y(), field('dropdownBehaviours', [Toggling, Coupling, Keying, Focusing]), required$1('toggleClass'), defaulted('eventOrder', {}), option('lazySink'), defaulted('matchWidth', false), defaulted('useMinWidth', false), option('role')].concat(sandboxFields()));\n  var parts$d = constant$1([external$1({\n    schema: [tieredMenuMarkers()],\n    name: 'menu',\n    defaults: function (detail) {\n      return {\n        onExecute: detail.onExecute\n      };\n    }\n  }), partType$1()]);\n\n  var factory$g = function (detail, components, _spec, externals) {\n    var _a;\n\n    var lookupAttr = function (attr) {\n      return get$e(detail.dom, 'attributes').bind(function (attrs) {\n        return get$e(attrs, attr);\n      });\n    };\n\n    var switchToMenu = function (sandbox) {\n      Sandboxing.getState(sandbox).each(function (tmenu) {\n        tieredMenu.highlightPrimary(tmenu);\n      });\n    };\n\n    var action = function (component) {\n      var onOpenSync = switchToMenu;\n      togglePopup(detail, identity$1, component, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n    };\n\n    var apis = {\n      expand: function (comp) {\n        if (!Toggling.isOn(comp)) {\n          togglePopup(detail, identity$1, comp, externals, noop, HighlightOnOpen.HighlightNone).get(noop);\n        }\n      },\n      open: function (comp) {\n        if (!Toggling.isOn(comp)) {\n          togglePopup(detail, identity$1, comp, externals, noop, HighlightOnOpen.HighlightFirst).get(noop);\n        }\n      },\n      isOpen: Toggling.isOn,\n      close: function (comp) {\n        if (Toggling.isOn(comp)) {\n          togglePopup(detail, identity$1, comp, externals, noop, HighlightOnOpen.HighlightFirst).get(noop);\n        }\n      },\n      repositionMenus: function (comp) {\n        if (Toggling.isOn(comp)) {\n          repositionMenus(comp);\n        }\n      }\n    };\n\n    var triggerExecute = function (comp, _se) {\n      emitExecute(comp);\n      return Optional.some(true);\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.dropdownBehaviours, [Toggling.config({\n        toggleClass: detail.toggleClass,\n        aria: {\n          mode: 'expanded'\n        }\n      }), Coupling.config({\n        others: {\n          sandbox: function (hotspot) {\n            return makeSandbox$1(detail, hotspot, {\n              onOpen: function () {\n                return Toggling.on(hotspot);\n              },\n              onClose: function () {\n                return Toggling.off(hotspot);\n              }\n            });\n          }\n        }\n      }), Keying.config({\n        mode: 'special',\n        onSpace: triggerExecute,\n        onEnter: triggerExecute,\n        onDown: function (comp, _se) {\n          if (Dropdown.isOpen(comp)) {\n            var sandbox = Coupling.getCoupled(comp, 'sandbox');\n            switchToMenu(sandbox);\n          } else {\n            Dropdown.open(comp);\n          }\n\n          return Optional.some(true);\n        },\n        onEscape: function (comp, _se) {\n          if (Dropdown.isOpen(comp)) {\n            Dropdown.close(comp);\n            return Optional.some(true);\n          } else {\n            return Optional.none();\n          }\n        }\n      }), Focusing.config({})]),\n      events: events$a(Optional.some(action)),\n      eventOrder: __assign(__assign({}, detail.eventOrder), (_a = {}, _a[execute$5()] = ['disabling', 'toggling', 'alloy.base.behaviour'], _a)),\n      apis: apis,\n      domModification: {\n        attributes: __assign(__assign({\n          'aria-haspopup': 'true'\n        }, detail.role.fold(function () {\n          return {};\n        }, function (role) {\n          return {\n            role: role\n          };\n        })), detail.dom.tag === 'button' ? {\n          type: lookupAttr('type').getOr('button')\n        } : {})\n      }\n    };\n  };\n\n  var Dropdown = composite({\n    name: 'Dropdown',\n    configFields: schema$j(),\n    partFields: parts$d(),\n    factory: factory$g,\n    apis: {\n      open: function (apis, comp) {\n        return apis.open(comp);\n      },\n      expand: function (apis, comp) {\n        return apis.expand(comp);\n      },\n      close: function (apis, comp) {\n        return apis.close(comp);\n      },\n      isOpen: function (apis, comp) {\n        return apis.isOpen(comp);\n      },\n      repositionMenus: function (apis, comp) {\n        return apis.repositionMenus(comp);\n      }\n    }\n  });\n\n  var exhibit$1 = function () {\n    return nu$7({\n      styles: {\n        '-webkit-user-select': 'none',\n        'user-select': 'none',\n        '-ms-user-select': 'none',\n        '-moz-user-select': '-moz-none'\n      },\n      attributes: {\n        unselectable: 'on'\n      }\n    });\n  };\n\n  var events$7 = function () {\n    return derive$2([abort(selectstart(), always)]);\n  };\n\n  var ActiveUnselecting = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$7,\n    exhibit: exhibit$1\n  });\n  var Unselecting = create$7({\n    fields: [],\n    name: 'unselecting',\n    active: ActiveUnselecting\n  });\n\n  var renderPanelButton = function (spec, sharedBackstage) {\n    return Dropdown.sketch({\n      dom: spec.dom,\n      components: spec.components,\n      toggleClass: 'mce-active',\n      dropdownBehaviours: derive$1([DisablingConfigs.button(sharedBackstage.providers.isDisabled), receivingConfig(), Unselecting.config({}), Tabstopping.config({})]),\n      layouts: spec.layouts,\n      sandboxClasses: ['tox-dialog__popups'],\n      lazySink: sharedBackstage.getSink,\n      fetch: function (comp) {\n        return Future.nu(function (callback) {\n          return spec.fetch(callback);\n        }).map(function (items) {\n          return Optional.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$6('menu-value'), items, function (value) {\n            spec.onItemAction(comp, value);\n          }, spec.columns, spec.presets, ItemResponse$1.CLOSE_ON_EXECUTE, never, sharedBackstage.providers), {\n            movement: deriveMenuMovement(spec.columns, spec.presets)\n          })));\n        });\n      },\n      parts: {\n        menu: part(false, 1, spec.presets)\n      }\n    });\n  };\n\n  var colorInputChangeEvent = generate$6('color-input-change');\n  var colorSwatchChangeEvent = generate$6('color-swatch-change');\n  var colorPickerCancelEvent = generate$6('color-picker-cancel');\n\n  var renderColorInput = function (spec, sharedBackstage, colorInputBackstage) {\n    var pField = FormField.parts.field({\n      factory: Input,\n      inputClasses: ['tox-textfield'],\n      onSetValue: function (c) {\n        return Invalidating.run(c).get(noop);\n      },\n      inputBehaviours: derive$1([Disabling.config({\n        disabled: sharedBackstage.providers.isDisabled\n      }), receivingConfig(), Tabstopping.config({}), Invalidating.config({\n        invalidClass: 'tox-textbox-field-invalid',\n        getRoot: function (comp) {\n          return parent(comp.element);\n        },\n        notify: {\n          onValid: function (comp) {\n            var val = Representing.getValue(comp);\n            emitWith(comp, colorInputChangeEvent, {\n              color: val\n            });\n          }\n        },\n        validator: {\n          validateOnLoad: false,\n          validate: function (input) {\n            var inputValue = Representing.getValue(input);\n\n            if (inputValue.length === 0) {\n              return Future.pure(Result.value(true));\n            } else {\n              var span = SugarElement.fromTag('span');\n              set$7(span, 'background-color', inputValue);\n              var res = getRaw(span, 'background-color').fold(function () {\n                return Result.error('blah');\n              }, function (_) {\n                return Result.value(inputValue);\n              });\n              return Future.pure(res);\n            }\n          }\n        }\n      })]),\n      selectOnFocus: false\n    });\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel$2(label, sharedBackstage.providers);\n    });\n\n    var emitSwatchChange = function (colorBit, value) {\n      emitWith(colorBit, colorSwatchChangeEvent, {\n        value: value\n      });\n    };\n\n    var onItemAction = function (comp, value) {\n      memColorButton.getOpt(comp).each(function (colorBit) {\n        if (value === 'custom') {\n          colorInputBackstage.colorPicker(function (valueOpt) {\n            valueOpt.fold(function () {\n              return emit(colorBit, colorPickerCancelEvent);\n            }, function (value) {\n              emitSwatchChange(colorBit, value);\n              addColor(value);\n            });\n          }, '#ffffff');\n        } else if (value === 'remove') {\n          emitSwatchChange(colorBit, '');\n        } else {\n          emitSwatchChange(colorBit, value);\n        }\n      });\n    };\n\n    var memColorButton = record(renderPanelButton({\n      dom: {\n        tag: 'span',\n        attributes: {\n          'aria-label': sharedBackstage.providers.translate('Color swatch')\n        }\n      },\n      layouts: {\n        onRtl: function () {\n          return [southwest$2, southeast$2, south$2];\n        },\n        onLtr: function () {\n          return [southeast$2, southwest$2, south$2];\n        }\n      },\n      components: [],\n      fetch: getFetch$1(colorInputBackstage.getColors(), colorInputBackstage.hasCustomColors()),\n      columns: colorInputBackstage.getColorCols(),\n      presets: 'color',\n      onItemAction: onItemAction\n    }, sharedBackstage));\n    return FormField.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: pLabel.toArray().concat([{\n        dom: {\n          tag: 'div',\n          classes: ['tox-color-input']\n        },\n        components: [pField, memColorButton.asSpec()]\n      }]),\n      fieldBehaviours: derive$1([config('form-field-events', [run$1(colorInputChangeEvent, function (comp, se) {\n        memColorButton.getOpt(comp).each(function (colorButton) {\n          set$7(colorButton.element, 'background-color', se.event.color);\n        });\n        emitWith(comp, formChangeEvent, {\n          name: spec.name\n        });\n      }), run$1(colorSwatchChangeEvent, function (comp, se) {\n        FormField.getField(comp).each(function (field) {\n          Representing.setValue(field, se.event.value);\n          Composing.getCurrent(comp).each(Focusing.focus);\n        });\n      }), run$1(colorPickerCancelEvent, function (comp, _se) {\n        FormField.getField(comp).each(function (_field) {\n          Composing.getCurrent(comp).each(Focusing.focus);\n        });\n      })])])\n    });\n  };\n\n  var labelPart = optional({\n    schema: [required$1('dom')],\n    name: 'label'\n  });\n\n  var edgePart = function (name) {\n    return optional({\n      name: '' + name + '-edge',\n      overrides: function (detail) {\n        var action = detail.model.manager.edgeActions[name];\n        return action.fold(function () {\n          return {};\n        }, function (a) {\n          return {\n            events: derive$2([runActionExtra(touchstart(), function (comp, se, d) {\n              return a(comp, d);\n            }, [detail]), runActionExtra(mousedown(), function (comp, se, d) {\n              return a(comp, d);\n            }, [detail]), runActionExtra(mousemove(), function (comp, se, det) {\n              if (det.mouseIsDown.get()) {\n                a(comp, det);\n              }\n            }, [detail])])\n          };\n        });\n      }\n    });\n  };\n\n  var tlEdgePart = edgePart('top-left');\n  var tedgePart = edgePart('top');\n  var trEdgePart = edgePart('top-right');\n  var redgePart = edgePart('right');\n  var brEdgePart = edgePart('bottom-right');\n  var bedgePart = edgePart('bottom');\n  var blEdgePart = edgePart('bottom-left');\n  var ledgePart = edgePart('left');\n  var thumbPart = required({\n    name: 'thumb',\n    defaults: constant$1({\n      dom: {\n        styles: {\n          position: 'absolute'\n        }\n      }\n    }),\n    overrides: function (detail) {\n      return {\n        events: derive$2([redirectToPart(touchstart(), detail, 'spectrum'), redirectToPart(touchmove(), detail, 'spectrum'), redirectToPart(touchend(), detail, 'spectrum'), redirectToPart(mousedown(), detail, 'spectrum'), redirectToPart(mousemove(), detail, 'spectrum'), redirectToPart(mouseup(), detail, 'spectrum')])\n      };\n    }\n  });\n  var spectrumPart = required({\n    schema: [customField('mouseIsDown', function () {\n      return Cell(false);\n    })],\n    name: 'spectrum',\n    overrides: function (detail) {\n      var modelDetail = detail.model;\n      var model = modelDetail.manager;\n\n      var setValueFrom = function (component, simulatedEvent) {\n        return model.getValueFromEvent(simulatedEvent).map(function (value) {\n          return model.setValueFrom(component, detail, value);\n        });\n      };\n\n      return {\n        behaviours: derive$1([Keying.config({\n          mode: 'special',\n          onLeft: function (spectrum) {\n            return model.onLeft(spectrum, detail);\n          },\n          onRight: function (spectrum) {\n            return model.onRight(spectrum, detail);\n          },\n          onUp: function (spectrum) {\n            return model.onUp(spectrum, detail);\n          },\n          onDown: function (spectrum) {\n            return model.onDown(spectrum, detail);\n          }\n        }), Focusing.config({})]),\n        events: derive$2([run$1(touchstart(), setValueFrom), run$1(touchmove(), setValueFrom), run$1(mousedown(), setValueFrom), run$1(mousemove(), function (spectrum, se) {\n          if (detail.mouseIsDown.get()) {\n            setValueFrom(spectrum, se);\n          }\n        })])\n      };\n    }\n  });\n  var SliderParts = [labelPart, ledgePart, redgePart, tedgePart, bedgePart, tlEdgePart, trEdgePart, blEdgePart, brEdgePart, thumbPart, spectrumPart];\n  var _sliderChangeEvent = 'slider.change.value';\n  var sliderChangeEvent = constant$1(_sliderChangeEvent);\n\n  var isTouchEvent$2 = function (evt) {\n    return evt.type.indexOf('touch') !== -1;\n  };\n\n  var getEventSource = function (simulatedEvent) {\n    var evt = simulatedEvent.event.raw;\n\n    if (isTouchEvent$2(evt)) {\n      var touchEvent = evt;\n      return touchEvent.touches !== undefined && touchEvent.touches.length === 1 ? Optional.some(touchEvent.touches[0]).map(function (t) {\n        return SugarPosition(t.clientX, t.clientY);\n      }) : Optional.none();\n    } else {\n      var mouseEvent = evt;\n      return mouseEvent.clientX !== undefined ? Optional.some(mouseEvent).map(function (me) {\n        return SugarPosition(me.clientX, me.clientY);\n      }) : Optional.none();\n    }\n  };\n\n  var t = 'top',\n      r = 'right',\n      b = 'bottom',\n      l = 'left';\n\n  var minX = function (detail) {\n    return detail.model.minX;\n  };\n\n  var minY = function (detail) {\n    return detail.model.minY;\n  };\n\n  var min1X = function (detail) {\n    return detail.model.minX - 1;\n  };\n\n  var min1Y = function (detail) {\n    return detail.model.minY - 1;\n  };\n\n  var maxX = function (detail) {\n    return detail.model.maxX;\n  };\n\n  var maxY = function (detail) {\n    return detail.model.maxY;\n  };\n\n  var max1X = function (detail) {\n    return detail.model.maxX + 1;\n  };\n\n  var max1Y = function (detail) {\n    return detail.model.maxY + 1;\n  };\n\n  var range = function (detail, max, min) {\n    return max(detail) - min(detail);\n  };\n\n  var xRange = function (detail) {\n    return range(detail, maxX, minX);\n  };\n\n  var yRange = function (detail) {\n    return range(detail, maxY, minY);\n  };\n\n  var halfX = function (detail) {\n    return xRange(detail) / 2;\n  };\n\n  var halfY = function (detail) {\n    return yRange(detail) / 2;\n  };\n\n  var step = function (detail) {\n    return detail.stepSize;\n  };\n\n  var snap = function (detail) {\n    return detail.snapToGrid;\n  };\n\n  var snapStart = function (detail) {\n    return detail.snapStart;\n  };\n\n  var rounded = function (detail) {\n    return detail.rounded;\n  };\n\n  var hasEdge = function (detail, edgeName) {\n    return detail[edgeName + '-edge'] !== undefined;\n  };\n\n  var hasLEdge = function (detail) {\n    return hasEdge(detail, l);\n  };\n\n  var hasREdge = function (detail) {\n    return hasEdge(detail, r);\n  };\n\n  var hasTEdge = function (detail) {\n    return hasEdge(detail, t);\n  };\n\n  var hasBEdge = function (detail) {\n    return hasEdge(detail, b);\n  };\n\n  var currentValue = function (detail) {\n    return detail.model.value.get();\n  };\n\n  var xValue = function (x) {\n    return {\n      x: x\n    };\n  };\n\n  var yValue = function (y) {\n    return {\n      y: y\n    };\n  };\n\n  var xyValue = function (x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var fireSliderChange$3 = function (component, value) {\n    emitWith(component, sliderChangeEvent(), {\n      value: value\n    });\n  };\n\n  var setToTLEdgeXY = function (edge, detail) {\n    fireSliderChange$3(edge, xyValue(min1X(detail), min1Y(detail)));\n  };\n\n  var setToTEdge = function (edge, detail) {\n    fireSliderChange$3(edge, yValue(min1Y(detail)));\n  };\n\n  var setToTEdgeXY = function (edge, detail) {\n    fireSliderChange$3(edge, xyValue(halfX(detail), min1Y(detail)));\n  };\n\n  var setToTREdgeXY = function (edge, detail) {\n    fireSliderChange$3(edge, xyValue(max1X(detail), min1Y(detail)));\n  };\n\n  var setToREdge = function (edge, detail) {\n    fireSliderChange$3(edge, xValue(max1X(detail)));\n  };\n\n  var setToREdgeXY = function (edge, detail) {\n    fireSliderChange$3(edge, xyValue(max1X(detail), halfY(detail)));\n  };\n\n  var setToBREdgeXY = function (edge, detail) {\n    fireSliderChange$3(edge, xyValue(max1X(detail), max1Y(detail)));\n  };\n\n  var setToBEdge = function (edge, detail) {\n    fireSliderChange$3(edge, yValue(max1Y(detail)));\n  };\n\n  var setToBEdgeXY = function (edge, detail) {\n    fireSliderChange$3(edge, xyValue(halfX(detail), max1Y(detail)));\n  };\n\n  var setToBLEdgeXY = function (edge, detail) {\n    fireSliderChange$3(edge, xyValue(min1X(detail), max1Y(detail)));\n  };\n\n  var setToLEdge = function (edge, detail) {\n    fireSliderChange$3(edge, xValue(min1X(detail)));\n  };\n\n  var setToLEdgeXY = function (edge, detail) {\n    fireSliderChange$3(edge, xyValue(min1X(detail), halfY(detail)));\n  };\n\n  var reduceBy = function (value, min, max, step) {\n    if (value < min) {\n      return value;\n    } else if (value > max) {\n      return max;\n    } else if (value === min) {\n      return min - 1;\n    } else {\n      return Math.max(min, value - step);\n    }\n  };\n\n  var increaseBy = function (value, min, max, step) {\n    if (value > max) {\n      return value;\n    } else if (value < min) {\n      return min;\n    } else if (value === max) {\n      return max + 1;\n    } else {\n      return Math.min(max, value + step);\n    }\n  };\n\n  var capValue = function (value, min, max) {\n    return Math.max(min, Math.min(max, value));\n  };\n\n  var snapValueOf = function (value, min, max, step, snapStart) {\n    return snapStart.fold(function () {\n      var initValue = value - min;\n      var extraValue = Math.round(initValue / step) * step;\n      return capValue(min + extraValue, min - 1, max + 1);\n    }, function (start) {\n      var remainder = (value - start) % step;\n      var adjustment = Math.round(remainder / step);\n      var rawSteps = Math.floor((value - start) / step);\n      var maxSteps = Math.floor((max - start) / step);\n      var numSteps = Math.min(maxSteps, rawSteps + adjustment);\n      var r = start + numSteps * step;\n      return Math.max(start, r);\n    });\n  };\n\n  var findOffsetOf = function (value, min, max) {\n    return Math.min(max, Math.max(value, min)) - min;\n  };\n\n  var findValueOf = function (args) {\n    var min = args.min,\n        max = args.max,\n        range = args.range,\n        value = args.value,\n        step = args.step,\n        snap = args.snap,\n        snapStart = args.snapStart,\n        rounded = args.rounded,\n        hasMinEdge = args.hasMinEdge,\n        hasMaxEdge = args.hasMaxEdge,\n        minBound = args.minBound,\n        maxBound = args.maxBound,\n        screenRange = args.screenRange;\n    var capMin = hasMinEdge ? min - 1 : min;\n    var capMax = hasMaxEdge ? max + 1 : max;\n\n    if (value < minBound) {\n      return capMin;\n    } else if (value > maxBound) {\n      return capMax;\n    } else {\n      var offset = findOffsetOf(value, minBound, maxBound);\n      var newValue = capValue(offset / screenRange * range + min, capMin, capMax);\n\n      if (snap && newValue >= min && newValue <= max) {\n        return snapValueOf(newValue, min, max, step, snapStart);\n      } else if (rounded) {\n        return Math.round(newValue);\n      } else {\n        return newValue;\n      }\n    }\n  };\n\n  var findOffsetOfValue$2 = function (args) {\n    var min = args.min,\n        max = args.max,\n        range = args.range,\n        value = args.value,\n        hasMinEdge = args.hasMinEdge,\n        hasMaxEdge = args.hasMaxEdge,\n        maxBound = args.maxBound,\n        maxOffset = args.maxOffset,\n        centerMinEdge = args.centerMinEdge,\n        centerMaxEdge = args.centerMaxEdge;\n\n    if (value < min) {\n      return hasMinEdge ? 0 : centerMinEdge;\n    } else if (value > max) {\n      return hasMaxEdge ? maxBound : centerMaxEdge;\n    } else {\n      return (value - min) / range * maxOffset;\n    }\n  };\n\n  var top = 'top',\n      right = 'right',\n      bottom = 'bottom',\n      left = 'left',\n      width = 'width',\n      height = 'height';\n\n  var getBounds = function (component) {\n    return component.element.dom.getBoundingClientRect();\n  };\n\n  var getBoundsProperty = function (bounds, property) {\n    return bounds[property];\n  };\n\n  var getMinXBounds = function (component) {\n    var bounds = getBounds(component);\n    return getBoundsProperty(bounds, left);\n  };\n\n  var getMaxXBounds = function (component) {\n    var bounds = getBounds(component);\n    return getBoundsProperty(bounds, right);\n  };\n\n  var getMinYBounds = function (component) {\n    var bounds = getBounds(component);\n    return getBoundsProperty(bounds, top);\n  };\n\n  var getMaxYBounds = function (component) {\n    var bounds = getBounds(component);\n    return getBoundsProperty(bounds, bottom);\n  };\n\n  var getXScreenRange = function (component) {\n    var bounds = getBounds(component);\n    return getBoundsProperty(bounds, width);\n  };\n\n  var getYScreenRange = function (component) {\n    var bounds = getBounds(component);\n    return getBoundsProperty(bounds, height);\n  };\n\n  var getCenterOffsetOf = function (componentMinEdge, componentMaxEdge, spectrumMinEdge) {\n    return (componentMinEdge + componentMaxEdge) / 2 - spectrumMinEdge;\n  };\n\n  var getXCenterOffSetOf = function (component, spectrum) {\n    var componentBounds = getBounds(component);\n    var spectrumBounds = getBounds(spectrum);\n    var componentMinEdge = getBoundsProperty(componentBounds, left);\n    var componentMaxEdge = getBoundsProperty(componentBounds, right);\n    var spectrumMinEdge = getBoundsProperty(spectrumBounds, left);\n    return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n  };\n\n  var getYCenterOffSetOf = function (component, spectrum) {\n    var componentBounds = getBounds(component);\n    var spectrumBounds = getBounds(spectrum);\n    var componentMinEdge = getBoundsProperty(componentBounds, top);\n    var componentMaxEdge = getBoundsProperty(componentBounds, bottom);\n    var spectrumMinEdge = getBoundsProperty(spectrumBounds, top);\n    return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n  };\n\n  var fireSliderChange$2 = function (spectrum, value) {\n    emitWith(spectrum, sliderChangeEvent(), {\n      value: value\n    });\n  };\n\n  var sliderValue$2 = function (x) {\n    return {\n      x: x\n    };\n  };\n\n  var findValueOfOffset$1 = function (spectrum, detail, left) {\n    var args = {\n      min: minX(detail),\n      max: maxX(detail),\n      range: xRange(detail),\n      value: left,\n      step: step(detail),\n      snap: snap(detail),\n      snapStart: snapStart(detail),\n      rounded: rounded(detail),\n      hasMinEdge: hasLEdge(detail),\n      hasMaxEdge: hasREdge(detail),\n      minBound: getMinXBounds(spectrum),\n      maxBound: getMaxXBounds(spectrum),\n      screenRange: getXScreenRange(spectrum)\n    };\n    return findValueOf(args);\n  };\n\n  var setValueFrom$2 = function (spectrum, detail, value) {\n    var xValue = findValueOfOffset$1(spectrum, detail, value);\n    var sliderVal = sliderValue$2(xValue);\n    fireSliderChange$2(spectrum, sliderVal);\n    return xValue;\n  };\n\n  var setToMin$2 = function (spectrum, detail) {\n    var min = minX(detail);\n    fireSliderChange$2(spectrum, sliderValue$2(min));\n  };\n\n  var setToMax$2 = function (spectrum, detail) {\n    var max = maxX(detail);\n    fireSliderChange$2(spectrum, sliderValue$2(max));\n  };\n\n  var moveBy$2 = function (direction, spectrum, detail) {\n    var f = direction > 0 ? increaseBy : reduceBy;\n    var xValue = f(currentValue(detail).x, minX(detail), maxX(detail), step(detail));\n    fireSliderChange$2(spectrum, sliderValue$2(xValue));\n    return Optional.some(xValue);\n  };\n\n  var handleMovement$2 = function (direction) {\n    return function (spectrum, detail) {\n      return moveBy$2(direction, spectrum, detail).map(always);\n    };\n  };\n\n  var getValueFromEvent$2 = function (simulatedEvent) {\n    var pos = getEventSource(simulatedEvent);\n    return pos.map(function (p) {\n      return p.left;\n    });\n  };\n\n  var findOffsetOfValue$1 = function (spectrum, detail, value, minEdge, maxEdge) {\n    var minOffset = 0;\n    var maxOffset = getXScreenRange(spectrum);\n    var centerMinEdge = minEdge.bind(function (edge) {\n      return Optional.some(getXCenterOffSetOf(edge, spectrum));\n    }).getOr(minOffset);\n    var centerMaxEdge = maxEdge.bind(function (edge) {\n      return Optional.some(getXCenterOffSetOf(edge, spectrum));\n    }).getOr(maxOffset);\n    var args = {\n      min: minX(detail),\n      max: maxX(detail),\n      range: xRange(detail),\n      value: value,\n      hasMinEdge: hasLEdge(detail),\n      hasMaxEdge: hasREdge(detail),\n      minBound: getMinXBounds(spectrum),\n      minOffset: minOffset,\n      maxBound: getMaxXBounds(spectrum),\n      maxOffset: maxOffset,\n      centerMinEdge: centerMinEdge,\n      centerMaxEdge: centerMaxEdge\n    };\n    return findOffsetOfValue$2(args);\n  };\n\n  var findPositionOfValue$1 = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n    var offset = findOffsetOfValue$1(spectrum, detail, value, minEdge, maxEdge);\n    return getMinXBounds(spectrum) - getMinXBounds(slider) + offset;\n  };\n\n  var setPositionFromValue$2 = function (slider, thumb, detail, edges) {\n    var value = currentValue(detail);\n    var pos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.x, edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n    var thumbRadius = get$a(thumb.element) / 2;\n    set$7(thumb.element, 'left', pos - thumbRadius + 'px');\n  };\n\n  var onLeft$2 = handleMovement$2(-1);\n  var onRight$2 = handleMovement$2(1);\n  var onUp$2 = Optional.none;\n  var onDown$2 = Optional.none;\n  var edgeActions$2 = {\n    'top-left': Optional.none(),\n    'top': Optional.none(),\n    'top-right': Optional.none(),\n    'right': Optional.some(setToREdge),\n    'bottom-right': Optional.none(),\n    'bottom': Optional.none(),\n    'bottom-left': Optional.none(),\n    'left': Optional.some(setToLEdge)\n  };\n  var HorizontalModel = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setValueFrom: setValueFrom$2,\n    setToMin: setToMin$2,\n    setToMax: setToMax$2,\n    findValueOfOffset: findValueOfOffset$1,\n    getValueFromEvent: getValueFromEvent$2,\n    findPositionOfValue: findPositionOfValue$1,\n    setPositionFromValue: setPositionFromValue$2,\n    onLeft: onLeft$2,\n    onRight: onRight$2,\n    onUp: onUp$2,\n    onDown: onDown$2,\n    edgeActions: edgeActions$2\n  });\n\n  var fireSliderChange$1 = function (spectrum, value) {\n    emitWith(spectrum, sliderChangeEvent(), {\n      value: value\n    });\n  };\n\n  var sliderValue$1 = function (y) {\n    return {\n      y: y\n    };\n  };\n\n  var findValueOfOffset = function (spectrum, detail, top) {\n    var args = {\n      min: minY(detail),\n      max: maxY(detail),\n      range: yRange(detail),\n      value: top,\n      step: step(detail),\n      snap: snap(detail),\n      snapStart: snapStart(detail),\n      rounded: rounded(detail),\n      hasMinEdge: hasTEdge(detail),\n      hasMaxEdge: hasBEdge(detail),\n      minBound: getMinYBounds(spectrum),\n      maxBound: getMaxYBounds(spectrum),\n      screenRange: getYScreenRange(spectrum)\n    };\n    return findValueOf(args);\n  };\n\n  var setValueFrom$1 = function (spectrum, detail, value) {\n    var yValue = findValueOfOffset(spectrum, detail, value);\n    var sliderVal = sliderValue$1(yValue);\n    fireSliderChange$1(spectrum, sliderVal);\n    return yValue;\n  };\n\n  var setToMin$1 = function (spectrum, detail) {\n    var min = minY(detail);\n    fireSliderChange$1(spectrum, sliderValue$1(min));\n  };\n\n  var setToMax$1 = function (spectrum, detail) {\n    var max = maxY(detail);\n    fireSliderChange$1(spectrum, sliderValue$1(max));\n  };\n\n  var moveBy$1 = function (direction, spectrum, detail) {\n    var f = direction > 0 ? increaseBy : reduceBy;\n    var yValue = f(currentValue(detail).y, minY(detail), maxY(detail), step(detail));\n    fireSliderChange$1(spectrum, sliderValue$1(yValue));\n    return Optional.some(yValue);\n  };\n\n  var handleMovement$1 = function (direction) {\n    return function (spectrum, detail) {\n      return moveBy$1(direction, spectrum, detail).map(always);\n    };\n  };\n\n  var getValueFromEvent$1 = function (simulatedEvent) {\n    var pos = getEventSource(simulatedEvent);\n    return pos.map(function (p) {\n      return p.top;\n    });\n  };\n\n  var findOffsetOfValue = function (spectrum, detail, value, minEdge, maxEdge) {\n    var minOffset = 0;\n    var maxOffset = getYScreenRange(spectrum);\n    var centerMinEdge = minEdge.bind(function (edge) {\n      return Optional.some(getYCenterOffSetOf(edge, spectrum));\n    }).getOr(minOffset);\n    var centerMaxEdge = maxEdge.bind(function (edge) {\n      return Optional.some(getYCenterOffSetOf(edge, spectrum));\n    }).getOr(maxOffset);\n    var args = {\n      min: minY(detail),\n      max: maxY(detail),\n      range: yRange(detail),\n      value: value,\n      hasMinEdge: hasTEdge(detail),\n      hasMaxEdge: hasBEdge(detail),\n      minBound: getMinYBounds(spectrum),\n      minOffset: minOffset,\n      maxBound: getMaxYBounds(spectrum),\n      maxOffset: maxOffset,\n      centerMinEdge: centerMinEdge,\n      centerMaxEdge: centerMaxEdge\n    };\n    return findOffsetOfValue$2(args);\n  };\n\n  var findPositionOfValue = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n    var offset = findOffsetOfValue(spectrum, detail, value, minEdge, maxEdge);\n    return getMinYBounds(spectrum) - getMinYBounds(slider) + offset;\n  };\n\n  var setPositionFromValue$1 = function (slider, thumb, detail, edges) {\n    var value = currentValue(detail);\n    var pos = findPositionOfValue(slider, edges.getSpectrum(slider), value.y, edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n    var thumbRadius = get$b(thumb.element) / 2;\n    set$7(thumb.element, 'top', pos - thumbRadius + 'px');\n  };\n\n  var onLeft$1 = Optional.none;\n  var onRight$1 = Optional.none;\n  var onUp$1 = handleMovement$1(-1);\n  var onDown$1 = handleMovement$1(1);\n  var edgeActions$1 = {\n    'top-left': Optional.none(),\n    'top': Optional.some(setToTEdge),\n    'top-right': Optional.none(),\n    'right': Optional.none(),\n    'bottom-right': Optional.none(),\n    'bottom': Optional.some(setToBEdge),\n    'bottom-left': Optional.none(),\n    'left': Optional.none()\n  };\n  var VerticalModel = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setValueFrom: setValueFrom$1,\n    setToMin: setToMin$1,\n    setToMax: setToMax$1,\n    findValueOfOffset: findValueOfOffset,\n    getValueFromEvent: getValueFromEvent$1,\n    findPositionOfValue: findPositionOfValue,\n    setPositionFromValue: setPositionFromValue$1,\n    onLeft: onLeft$1,\n    onRight: onRight$1,\n    onUp: onUp$1,\n    onDown: onDown$1,\n    edgeActions: edgeActions$1\n  });\n\n  var fireSliderChange = function (spectrum, value) {\n    emitWith(spectrum, sliderChangeEvent(), {\n      value: value\n    });\n  };\n\n  var sliderValue = function (x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var setValueFrom = function (spectrum, detail, value) {\n    var xValue = findValueOfOffset$1(spectrum, detail, value.left);\n    var yValue = findValueOfOffset(spectrum, detail, value.top);\n    var val = sliderValue(xValue, yValue);\n    fireSliderChange(spectrum, val);\n    return val;\n  };\n\n  var moveBy = function (direction, isVerticalMovement, spectrum, detail) {\n    var f = direction > 0 ? increaseBy : reduceBy;\n    var xValue = isVerticalMovement ? currentValue(detail).x : f(currentValue(detail).x, minX(detail), maxX(detail), step(detail));\n    var yValue = !isVerticalMovement ? currentValue(detail).y : f(currentValue(detail).y, minY(detail), maxY(detail), step(detail));\n    fireSliderChange(spectrum, sliderValue(xValue, yValue));\n    return Optional.some(xValue);\n  };\n\n  var handleMovement = function (direction, isVerticalMovement) {\n    return function (spectrum, detail) {\n      return moveBy(direction, isVerticalMovement, spectrum, detail).map(always);\n    };\n  };\n\n  var setToMin = function (spectrum, detail) {\n    var mX = minX(detail);\n    var mY = minY(detail);\n    fireSliderChange(spectrum, sliderValue(mX, mY));\n  };\n\n  var setToMax = function (spectrum, detail) {\n    var mX = maxX(detail);\n    var mY = maxY(detail);\n    fireSliderChange(spectrum, sliderValue(mX, mY));\n  };\n\n  var getValueFromEvent = function (simulatedEvent) {\n    return getEventSource(simulatedEvent);\n  };\n\n  var setPositionFromValue = function (slider, thumb, detail, edges) {\n    var value = currentValue(detail);\n    var xPos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.x, edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n    var yPos = findPositionOfValue(slider, edges.getSpectrum(slider), value.y, edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n    var thumbXRadius = get$a(thumb.element) / 2;\n    var thumbYRadius = get$b(thumb.element) / 2;\n    set$7(thumb.element, 'left', xPos - thumbXRadius + 'px');\n    set$7(thumb.element, 'top', yPos - thumbYRadius + 'px');\n  };\n\n  var onLeft = handleMovement(-1, false);\n  var onRight = handleMovement(1, false);\n  var onUp = handleMovement(-1, true);\n  var onDown = handleMovement(1, true);\n  var edgeActions = {\n    'top-left': Optional.some(setToTLEdgeXY),\n    'top': Optional.some(setToTEdgeXY),\n    'top-right': Optional.some(setToTREdgeXY),\n    'right': Optional.some(setToREdgeXY),\n    'bottom-right': Optional.some(setToBREdgeXY),\n    'bottom': Optional.some(setToBEdgeXY),\n    'bottom-left': Optional.some(setToBLEdgeXY),\n    'left': Optional.some(setToLEdgeXY)\n  };\n  var TwoDModel = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setValueFrom: setValueFrom,\n    setToMin: setToMin,\n    setToMax: setToMax,\n    getValueFromEvent: getValueFromEvent,\n    setPositionFromValue: setPositionFromValue,\n    onLeft: onLeft,\n    onRight: onRight,\n    onUp: onUp,\n    onDown: onDown,\n    edgeActions: edgeActions\n  });\n  var SliderSchema = [defaulted('stepSize', 1), defaulted('onChange', noop), defaulted('onChoose', noop), defaulted('onInit', noop), defaulted('onDragStart', noop), defaulted('onDragEnd', noop), defaulted('snapToGrid', false), defaulted('rounded', true), option('snapStart'), requiredOf('model', choose$1('mode', {\n    x: [defaulted('minX', 0), defaulted('maxX', 100), customField('value', function (spec) {\n      return Cell(spec.mode.minX);\n    }), required$1('getInitialValue'), output$1('manager', HorizontalModel)],\n    y: [defaulted('minY', 0), defaulted('maxY', 100), customField('value', function (spec) {\n      return Cell(spec.mode.minY);\n    }), required$1('getInitialValue'), output$1('manager', VerticalModel)],\n    xy: [defaulted('minX', 0), defaulted('maxX', 100), defaulted('minY', 0), defaulted('maxY', 100), customField('value', function (spec) {\n      return Cell({\n        x: spec.mode.minX,\n        y: spec.mode.minY\n      });\n    }), required$1('getInitialValue'), output$1('manager', TwoDModel)]\n  })), field('sliderBehaviours', [Keying, Representing]), customField('mouseIsDown', function () {\n    return Cell(false);\n  })];\n\n  var sketch$2 = function (detail, components, _spec, _externals) {\n    var _a;\n\n    var getThumb = function (component) {\n      return getPartOrDie(component, detail, 'thumb');\n    };\n\n    var getSpectrum = function (component) {\n      return getPartOrDie(component, detail, 'spectrum');\n    };\n\n    var getLeftEdge = function (component) {\n      return getPart(component, detail, 'left-edge');\n    };\n\n    var getRightEdge = function (component) {\n      return getPart(component, detail, 'right-edge');\n    };\n\n    var getTopEdge = function (component) {\n      return getPart(component, detail, 'top-edge');\n    };\n\n    var getBottomEdge = function (component) {\n      return getPart(component, detail, 'bottom-edge');\n    };\n\n    var modelDetail = detail.model;\n    var model = modelDetail.manager;\n\n    var refresh = function (slider, thumb) {\n      model.setPositionFromValue(slider, thumb, detail, {\n        getLeftEdge: getLeftEdge,\n        getRightEdge: getRightEdge,\n        getTopEdge: getTopEdge,\n        getBottomEdge: getBottomEdge,\n        getSpectrum: getSpectrum\n      });\n    };\n\n    var setValue = function (slider, newValue) {\n      modelDetail.value.set(newValue);\n      var thumb = getThumb(slider);\n      refresh(slider, thumb);\n    };\n\n    var changeValue = function (slider, newValue) {\n      setValue(slider, newValue);\n      var thumb = getThumb(slider);\n      detail.onChange(slider, thumb, newValue);\n      return Optional.some(true);\n    };\n\n    var resetToMin = function (slider) {\n      model.setToMin(slider, detail);\n    };\n\n    var resetToMax = function (slider) {\n      model.setToMax(slider, detail);\n    };\n\n    var choose = function (slider) {\n      var fireOnChoose = function () {\n        getPart(slider, detail, 'thumb').each(function (thumb) {\n          var value = modelDetail.value.get();\n          detail.onChoose(slider, thumb, value);\n        });\n      };\n\n      var wasDown = detail.mouseIsDown.get();\n      detail.mouseIsDown.set(false);\n\n      if (wasDown) {\n        fireOnChoose();\n      }\n    };\n\n    var onDragStart = function (slider, simulatedEvent) {\n      simulatedEvent.stop();\n      detail.mouseIsDown.set(true);\n      detail.onDragStart(slider, getThumb(slider));\n    };\n\n    var onDragEnd = function (slider, simulatedEvent) {\n      simulatedEvent.stop();\n      detail.onDragEnd(slider, getThumb(slider));\n      choose(slider);\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.sliderBehaviours, [Keying.config({\n        mode: 'special',\n        focusIn: function (slider) {\n          return getPart(slider, detail, 'spectrum').map(Keying.focusIn).map(always);\n        }\n      }), Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (_) {\n            return modelDetail.value.get();\n          }\n        }\n      }), Receiving.config({\n        channels: (_a = {}, _a[mouseReleased()] = {\n          onReceive: choose\n        }, _a)\n      })]),\n      events: derive$2([run$1(sliderChangeEvent(), function (slider, simulatedEvent) {\n        changeValue(slider, simulatedEvent.event.value);\n      }), runOnAttached(function (slider, _simulatedEvent) {\n        var getInitial = modelDetail.getInitialValue();\n        modelDetail.value.set(getInitial);\n        var thumb = getThumb(slider);\n        refresh(slider, thumb);\n        var spectrum = getSpectrum(slider);\n        detail.onInit(slider, thumb, spectrum, modelDetail.value.get());\n      }), run$1(touchstart(), onDragStart), run$1(touchend(), onDragEnd), run$1(mousedown(), onDragStart), run$1(mouseup(), onDragEnd)]),\n      apis: {\n        resetToMin: resetToMin,\n        resetToMax: resetToMax,\n        setValue: setValue,\n        refresh: refresh\n      },\n      domModification: {\n        styles: {\n          position: 'relative'\n        }\n      }\n    };\n  };\n\n  var Slider = composite({\n    name: 'Slider',\n    configFields: SliderSchema,\n    partFields: SliderParts,\n    factory: sketch$2,\n    apis: {\n      setValue: function (apis, slider, value) {\n        apis.setValue(slider, value);\n      },\n      resetToMin: function (apis, slider) {\n        apis.resetToMin(slider);\n      },\n      resetToMax: function (apis, slider) {\n        apis.resetToMax(slider);\n      },\n      refresh: function (apis, slider) {\n        apis.refresh(slider);\n      }\n    }\n  });\n  var fieldsUpdate = generate$6('rgb-hex-update');\n  var sliderUpdate = generate$6('slider-update');\n  var paletteUpdate = generate$6('palette-update');\n\n  var sliderFactory = function (translate, getClass) {\n    var spectrum = Slider.parts.spectrum({\n      dom: {\n        tag: 'div',\n        classes: [getClass('hue-slider-spectrum')],\n        attributes: {\n          role: 'presentation'\n        }\n      }\n    });\n    var thumb = Slider.parts.thumb({\n      dom: {\n        tag: 'div',\n        classes: [getClass('hue-slider-thumb')],\n        attributes: {\n          role: 'presentation'\n        }\n      }\n    });\n    return Slider.sketch({\n      dom: {\n        tag: 'div',\n        classes: [getClass('hue-slider')],\n        attributes: {\n          role: 'presentation'\n        }\n      },\n      rounded: false,\n      model: {\n        mode: 'y',\n        getInitialValue: constant$1({\n          y: 0\n        })\n      },\n      components: [spectrum, thumb],\n      sliderBehaviours: derive$1([Focusing.config({})]),\n      onChange: function (slider, _thumb, value) {\n        emitWith(slider, sliderUpdate, {\n          value: value\n        });\n      }\n    });\n  };\n\n  var owner$1 = 'form';\n  var schema$i = [field('formBehaviours', [Representing])];\n\n  var getPartName$1 = function (name) {\n    return '<alloy.field.' + name + '>';\n  };\n\n  var sketch$1 = function (fSpec) {\n    var parts = function () {\n      var record = [];\n\n      var field = function (name, config) {\n        record.push(name);\n        return generateOne$1(owner$1, getPartName$1(name), config);\n      };\n\n      return {\n        field: field,\n        record: constant$1(record)\n      };\n    }();\n\n    var spec = fSpec(parts);\n    var partNames = parts.record();\n    var fieldParts = map$2(partNames, function (n) {\n      return required({\n        name: n,\n        pname: getPartName$1(n)\n      });\n    });\n    return composite$1(owner$1, schema$i, fieldParts, make$4, spec);\n  };\n\n  var toResult = function (o, e) {\n    return o.fold(function () {\n      return Result.error(e);\n    }, Result.value);\n  };\n\n  var make$4 = function (detail, components) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.formBehaviours, [Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (form) {\n            var resPs = getAllParts(form, detail);\n            return map$1(resPs, function (resPThunk, pName) {\n              return resPThunk().bind(function (v) {\n                var opt = Composing.getCurrent(v);\n                return toResult(opt, new Error('Cannot find a current component to extract the value from for form part \\'' + pName + '\\': ' + element(v.element)));\n              }).map(Representing.getValue);\n            });\n          },\n          setValue: function (form, values) {\n            each(values, function (newValue, key) {\n              getPart(form, detail, key).each(function (wrapper) {\n                Composing.getCurrent(wrapper).each(function (field) {\n                  Representing.setValue(field, newValue);\n                });\n              });\n            });\n          }\n        }\n      })]),\n      apis: {\n        getField: function (form, key) {\n          return getPart(form, detail, key).bind(Composing.getCurrent);\n        }\n      }\n    };\n  };\n\n  var Form = {\n    getField: makeApi(function (apis, component, key) {\n      return apis.getField(component, key);\n    }),\n    sketch: sketch$1\n  };\n  var validInput = generate$6('valid-input');\n  var invalidInput = generate$6('invalid-input');\n  var validatingInput = generate$6('validating-input');\n  var translatePrefix = 'colorcustom.rgb.';\n\n  var rgbFormFactory = function (translate, getClass, onValidHexx, onInvalidHexx) {\n    var invalidation = function (label, isValid) {\n      return Invalidating.config({\n        invalidClass: getClass('invalid'),\n        notify: {\n          onValidate: function (comp) {\n            emitWith(comp, validatingInput, {\n              type: label\n            });\n          },\n          onValid: function (comp) {\n            emitWith(comp, validInput, {\n              type: label,\n              value: Representing.getValue(comp)\n            });\n          },\n          onInvalid: function (comp) {\n            emitWith(comp, invalidInput, {\n              type: label,\n              value: Representing.getValue(comp)\n            });\n          }\n        },\n        validator: {\n          validate: function (comp) {\n            var value = Representing.getValue(comp);\n            var res = isValid(value) ? Result.value(true) : Result.error(translate('aria.input.invalid'));\n            return Future.pure(res);\n          },\n          validateOnLoad: false\n        }\n      });\n    };\n\n    var renderTextField = function (isValid, name, label, description, data) {\n      var helptext = translate(translatePrefix + 'range');\n      var pLabel = FormField.parts.label({\n        dom: {\n          tag: 'label',\n          innerHtml: label,\n          attributes: {\n            'aria-label': description\n          }\n        }\n      });\n      var pField = FormField.parts.field({\n        data: data,\n        factory: Input,\n        inputAttributes: __assign({\n          type: 'text'\n        }, name === 'hex' ? {\n          'aria-live': 'polite'\n        } : {}),\n        inputClasses: [getClass('textfield')],\n        inputBehaviours: derive$1([invalidation(name, isValid), Tabstopping.config({})]),\n        onSetValue: function (input) {\n          if (Invalidating.isInvalid(input)) {\n            var run = Invalidating.run(input);\n            run.get(noop);\n          }\n        }\n      });\n      var comps = [pLabel, pField];\n      var concats = name !== 'hex' ? [FormField.parts['aria-descriptor']({\n        text: helptext\n      })] : [];\n      var components = comps.concat(concats);\n      return {\n        dom: {\n          tag: 'div',\n          attributes: {\n            role: 'presentation'\n          }\n        },\n        components: components\n      };\n    };\n\n    var copyRgbToHex = function (form, rgba) {\n      var hex = fromRgba(rgba);\n      Form.getField(form, 'hex').each(function (hexField) {\n        if (!Focusing.isFocused(hexField)) {\n          Representing.setValue(form, {\n            hex: hex.value\n          });\n        }\n      });\n      return hex;\n    };\n\n    var copyRgbToForm = function (form, rgb) {\n      var red = rgb.red;\n      var green = rgb.green;\n      var blue = rgb.blue;\n      Representing.setValue(form, {\n        red: red,\n        green: green,\n        blue: blue\n      });\n    };\n\n    var memPreview = record({\n      dom: {\n        tag: 'div',\n        classes: [getClass('rgba-preview')],\n        styles: {\n          'background-color': 'white'\n        },\n        attributes: {\n          role: 'presentation'\n        }\n      }\n    });\n\n    var updatePreview = function (anyInSystem, hex) {\n      memPreview.getOpt(anyInSystem).each(function (preview) {\n        set$7(preview.element, 'background-color', '#' + hex.value);\n      });\n    };\n\n    var factory = function () {\n      var state = {\n        red: Cell(Optional.some(255)),\n        green: Cell(Optional.some(255)),\n        blue: Cell(Optional.some(255)),\n        hex: Cell(Optional.some('ffffff'))\n      };\n\n      var copyHexToRgb = function (form, hex) {\n        var rgb = fromHex(hex);\n        copyRgbToForm(form, rgb);\n        setValueRgb(rgb);\n      };\n\n      var get = function (prop) {\n        return state[prop].get();\n      };\n\n      var set = function (prop, value) {\n        state[prop].set(value);\n      };\n\n      var getValueRgb = function () {\n        return get('red').bind(function (red) {\n          return get('green').bind(function (green) {\n            return get('blue').map(function (blue) {\n              return rgbaColour(red, green, blue, 1);\n            });\n          });\n        });\n      };\n\n      var setValueRgb = function (rgb) {\n        var red = rgb.red;\n        var green = rgb.green;\n        var blue = rgb.blue;\n        set('red', Optional.some(red));\n        set('green', Optional.some(green));\n        set('blue', Optional.some(blue));\n      };\n\n      var onInvalidInput = function (form, simulatedEvent) {\n        var data = simulatedEvent.event;\n\n        if (data.type !== 'hex') {\n          set(data.type, Optional.none());\n        } else {\n          onInvalidHexx(form);\n        }\n      };\n\n      var onValidHex = function (form, value) {\n        onValidHexx(form);\n        var hex = hexColour(value);\n        set('hex', Optional.some(value));\n        var rgb = fromHex(hex);\n        copyRgbToForm(form, rgb);\n        setValueRgb(rgb);\n        emitWith(form, fieldsUpdate, {\n          hex: hex\n        });\n        updatePreview(form, hex);\n      };\n\n      var onValidRgb = function (form, prop, value) {\n        var val = parseInt(value, 10);\n        set(prop, Optional.some(val));\n        getValueRgb().each(function (rgb) {\n          var hex = copyRgbToHex(form, rgb);\n          emitWith(form, fieldsUpdate, {\n            hex: hex\n          });\n          updatePreview(form, hex);\n        });\n      };\n\n      var isHexInputEvent = function (data) {\n        return data.type === 'hex';\n      };\n\n      var onValidInput = function (form, simulatedEvent) {\n        var data = simulatedEvent.event;\n\n        if (isHexInputEvent(data)) {\n          onValidHex(form, data.value);\n        } else {\n          onValidRgb(form, data.type, data.value);\n        }\n      };\n\n      var formPartStrings = function (key) {\n        return {\n          label: translate(translatePrefix + key + '.label'),\n          description: translate(translatePrefix + key + '.description')\n        };\n      };\n\n      var redStrings = formPartStrings('red');\n      var greenStrings = formPartStrings('green');\n      var blueStrings = formPartStrings('blue');\n      var hexStrings = formPartStrings('hex');\n      return deepMerge(Form.sketch(function (parts) {\n        return {\n          dom: {\n            tag: 'form',\n            classes: [getClass('rgb-form')],\n            attributes: {\n              'aria-label': translate('aria.color.picker')\n            }\n          },\n          components: [parts.field('red', FormField.sketch(renderTextField(isRgbaComponent, 'red', redStrings.label, redStrings.description, 255))), parts.field('green', FormField.sketch(renderTextField(isRgbaComponent, 'green', greenStrings.label, greenStrings.description, 255))), parts.field('blue', FormField.sketch(renderTextField(isRgbaComponent, 'blue', blueStrings.label, blueStrings.description, 255))), parts.field('hex', FormField.sketch(renderTextField(isHexString, 'hex', hexStrings.label, hexStrings.description, 'ffffff'))), memPreview.asSpec()],\n          formBehaviours: derive$1([Invalidating.config({\n            invalidClass: getClass('form-invalid')\n          }), config('rgb-form-events', [run$1(validInput, onValidInput), run$1(invalidInput, onInvalidInput), run$1(validatingInput, onInvalidInput)])])\n        };\n      }), {\n        apis: {\n          updateHex: function (form, hex) {\n            Representing.setValue(form, {\n              hex: hex.value\n            });\n            copyHexToRgb(form, hex);\n            updatePreview(form, hex);\n          }\n        }\n      });\n    };\n\n    var rgbFormSketcher = single({\n      factory: factory,\n      name: 'RgbForm',\n      configFields: [],\n      apis: {\n        updateHex: function (apis, form, hex) {\n          apis.updateHex(form, hex);\n        }\n      },\n      extraApis: {}\n    });\n    return rgbFormSketcher;\n  };\n\n  var paletteFactory = function (_translate, getClass) {\n    var spectrumPart = Slider.parts.spectrum({\n      dom: {\n        tag: 'canvas',\n        attributes: {\n          role: 'presentation'\n        },\n        classes: [getClass('sv-palette-spectrum')]\n      }\n    });\n    var thumbPart = Slider.parts.thumb({\n      dom: {\n        tag: 'div',\n        attributes: {\n          role: 'presentation'\n        },\n        classes: [getClass('sv-palette-thumb')],\n        innerHtml: '<div class=' + getClass('sv-palette-inner-thumb') + ' role=\"presentation\"></div>'\n      }\n    });\n\n    var setColour = function (canvas, rgba) {\n      var width = canvas.width,\n          height = canvas.height;\n      var ctx = canvas.getContext('2d');\n\n      if (ctx === null) {\n        return;\n      }\n\n      ctx.fillStyle = rgba;\n      ctx.fillRect(0, 0, width, height);\n      var grdWhite = ctx.createLinearGradient(0, 0, width, 0);\n      grdWhite.addColorStop(0, 'rgba(255,255,255,1)');\n      grdWhite.addColorStop(1, 'rgba(255,255,255,0)');\n      ctx.fillStyle = grdWhite;\n      ctx.fillRect(0, 0, width, height);\n      var grdBlack = ctx.createLinearGradient(0, 0, 0, height);\n      grdBlack.addColorStop(0, 'rgba(0,0,0,0)');\n      grdBlack.addColorStop(1, 'rgba(0,0,0,1)');\n      ctx.fillStyle = grdBlack;\n      ctx.fillRect(0, 0, width, height);\n    };\n\n    var setPaletteHue = function (slider, hue) {\n      var canvas = slider.components()[0].element.dom;\n      var hsv = hsvColour(hue, 100, 100);\n      var rgba = fromHsv(hsv);\n      setColour(canvas, toString(rgba));\n    };\n\n    var setPaletteThumb = function (slider, hex) {\n      var hsv = fromRgb(fromHex(hex));\n      Slider.setValue(slider, {\n        x: hsv.saturation,\n        y: 100 - hsv.value\n      });\n    };\n\n    var factory = function (_detail) {\n      var getInitialValue = constant$1({\n        x: 0,\n        y: 0\n      });\n\n      var onChange = function (slider, _thumb, value) {\n        emitWith(slider, paletteUpdate, {\n          value: value\n        });\n      };\n\n      var onInit = function (_slider, _thumb, spectrum, _value) {\n        setColour(spectrum.element.dom, toString(red));\n      };\n\n      var sliderBehaviours = derive$1([Composing.config({\n        find: Optional.some\n      }), Focusing.config({})]);\n      return Slider.sketch({\n        dom: {\n          tag: 'div',\n          attributes: {\n            role: 'presentation'\n          },\n          classes: [getClass('sv-palette')]\n        },\n        model: {\n          mode: 'xy',\n          getInitialValue: getInitialValue\n        },\n        rounded: false,\n        components: [spectrumPart, thumbPart],\n        onChange: onChange,\n        onInit: onInit,\n        sliderBehaviours: sliderBehaviours\n      });\n    };\n\n    var saturationBrightnessPaletteSketcher = single({\n      factory: factory,\n      name: 'SaturationBrightnessPalette',\n      configFields: [],\n      apis: {\n        setHue: function (_apis, slider, hue) {\n          setPaletteHue(slider, hue);\n        },\n        setThumb: function (_apis, slider, hex) {\n          setPaletteThumb(slider, hex);\n        }\n      },\n      extraApis: {}\n    });\n    return saturationBrightnessPaletteSketcher;\n  };\n\n  var makeFactory = function (translate, getClass) {\n    var factory = function (detail) {\n      var rgbForm = rgbFormFactory(translate, getClass, detail.onValidHex, detail.onInvalidHex);\n      var sbPalette = paletteFactory(translate, getClass);\n\n      var hueSliderToDegrees = function (hue) {\n        return (100 - hue) / 100 * 360;\n      };\n\n      var hueDegreesToSlider = function (hue) {\n        return 100 - hue / 360 * 100;\n      };\n\n      var state = {\n        paletteRgba: Cell(red),\n        paletteHue: Cell(0)\n      };\n      var memSlider = record(sliderFactory(translate, getClass));\n      var memPalette = record(sbPalette.sketch({}));\n      var memRgb = record(rgbForm.sketch({}));\n\n      var updatePalette = function (anyInSystem, _hex, hue) {\n        memPalette.getOpt(anyInSystem).each(function (palette) {\n          sbPalette.setHue(palette, hue);\n        });\n      };\n\n      var updateFields = function (anyInSystem, hex) {\n        memRgb.getOpt(anyInSystem).each(function (form) {\n          rgbForm.updateHex(form, hex);\n        });\n      };\n\n      var updateSlider = function (anyInSystem, _hex, hue) {\n        memSlider.getOpt(anyInSystem).each(function (slider) {\n          Slider.setValue(slider, {\n            y: hueDegreesToSlider(hue)\n          });\n        });\n      };\n\n      var updatePaletteThumb = function (anyInSystem, hex) {\n        memPalette.getOpt(anyInSystem).each(function (palette) {\n          sbPalette.setThumb(palette, hex);\n        });\n      };\n\n      var updateState = function (hex, hue) {\n        var rgba = fromHex(hex);\n        state.paletteRgba.set(rgba);\n        state.paletteHue.set(hue);\n      };\n\n      var runUpdates = function (anyInSystem, hex, hue, updates) {\n        updateState(hex, hue);\n        each$1(updates, function (update) {\n          update(anyInSystem, hex, hue);\n        });\n      };\n\n      var onPaletteUpdate = function () {\n        var updates = [updateFields];\n        return function (form, simulatedEvent) {\n          var value = simulatedEvent.event.value;\n          var oldHue = state.paletteHue.get();\n          var newHsv = hsvColour(oldHue, value.x, 100 - value.y);\n          var newHex = hsvToHex(newHsv);\n          runUpdates(form, newHex, oldHue, updates);\n        };\n      };\n\n      var onSliderUpdate = function () {\n        var updates = [updatePalette, updateFields];\n        return function (form, simulatedEvent) {\n          var hue = hueSliderToDegrees(simulatedEvent.event.value.y);\n          var oldRgb = state.paletteRgba.get();\n          var oldHsv = fromRgb(oldRgb);\n          var newHsv = hsvColour(hue, oldHsv.saturation, oldHsv.value);\n          var newHex = hsvToHex(newHsv);\n          runUpdates(form, newHex, hue, updates);\n        };\n      };\n\n      var onFieldsUpdate = function () {\n        var updates = [updatePalette, updateSlider, updatePaletteThumb];\n        return function (form, simulatedEvent) {\n          var hex = simulatedEvent.event.hex;\n          var hsv = hexToHsv(hex);\n          runUpdates(form, hex, hsv.hue, updates);\n        };\n      };\n\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: [memPalette.asSpec(), memSlider.asSpec(), memRgb.asSpec()],\n        behaviours: derive$1([config('colour-picker-events', [run$1(fieldsUpdate, onFieldsUpdate()), run$1(paletteUpdate, onPaletteUpdate()), run$1(sliderUpdate, onSliderUpdate())]), Composing.config({\n          find: function (comp) {\n            return memRgb.getOpt(comp);\n          }\n        }), Keying.config({\n          mode: 'acyclic'\n        })])\n      };\n    };\n\n    var colourPickerSketcher = single({\n      name: 'ColourPicker',\n      configFields: [required$1('dom'), defaulted('onValidHex', noop), defaulted('onInvalidHex', noop)],\n      factory: factory\n    });\n    return colourPickerSketcher;\n  };\n\n  var self$1 = function () {\n    return Composing.config({\n      find: Optional.some\n    });\n  };\n\n  var memento$1 = function (mem) {\n    return Composing.config({\n      find: mem.getOpt\n    });\n  };\n\n  var childAt = function (index) {\n    return Composing.config({\n      find: function (comp) {\n        return child$2(comp.element, index).bind(function (element) {\n          return comp.getSystem().getByDom(element).toOptional();\n        });\n      }\n    });\n  };\n\n  var ComposingConfigs = {\n    self: self$1,\n    memento: memento$1,\n    childAt: childAt\n  };\n  var english = {\n    'colorcustom.rgb.red.label': 'R',\n    'colorcustom.rgb.red.description': 'Red component',\n    'colorcustom.rgb.green.label': 'G',\n    'colorcustom.rgb.green.description': 'Green component',\n    'colorcustom.rgb.blue.label': 'B',\n    'colorcustom.rgb.blue.description': 'Blue component',\n    'colorcustom.rgb.hex.label': '#',\n    'colorcustom.rgb.hex.description': 'Hex color code',\n    'colorcustom.rgb.range': 'Range 0 to 255',\n    'colorcustom.sb.saturation': 'Saturation',\n    'colorcustom.sb.brightness': 'Brightness',\n    'colorcustom.sb.picker': 'Saturation and Brightness Picker',\n    'colorcustom.sb.palette': 'Saturation and Brightness Palette',\n    'colorcustom.sb.instructions': 'Use arrow keys to select saturation and brightness, on x and y axes',\n    'colorcustom.hue.hue': 'Hue',\n    'colorcustom.hue.slider': 'Hue Slider',\n    'colorcustom.hue.palette': 'Hue Palette',\n    'colorcustom.hue.instructions': 'Use arrow keys to select a hue',\n    'aria.color.picker': 'Color Picker',\n    'aria.input.invalid': 'Invalid input'\n  };\n\n  var getEnglishText = function (key) {\n    return english[key];\n  };\n\n  var translate$1 = function (key) {\n    return getEnglishText(key);\n  };\n\n  var renderColorPicker = function (_spec) {\n    var getClass = function (key) {\n      return 'tox-' + key;\n    };\n\n    var colourPickerFactory = makeFactory(translate$1, getClass);\n\n    var onValidHex = function (form) {\n      emitWith(form, formActionEvent, {\n        name: 'hex-valid',\n        value: true\n      });\n    };\n\n    var onInvalidHex = function (form) {\n      emitWith(form, formActionEvent, {\n        name: 'hex-valid',\n        value: false\n      });\n    };\n\n    var memPicker = record(colourPickerFactory.sketch({\n      dom: {\n        tag: 'div',\n        classes: [getClass('color-picker-container')],\n        attributes: {\n          role: 'presentation'\n        }\n      },\n      onValidHex: onValidHex,\n      onInvalidHex: onInvalidHex\n    }));\n    return {\n      dom: {\n        tag: 'div'\n      },\n      components: [memPicker.asSpec()],\n      behaviours: derive$1([Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (comp) {\n            var picker = memPicker.get(comp);\n            var optRgbForm = Composing.getCurrent(picker);\n            var optHex = optRgbForm.bind(function (rgbForm) {\n              var formValues = Representing.getValue(rgbForm);\n              return formValues.hex;\n            });\n            return optHex.map(function (hex) {\n              return '#' + hex;\n            }).getOr('');\n          },\n          setValue: function (comp, newValue) {\n            var pattern = /^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/;\n            var m = pattern.exec(newValue);\n            var picker = memPicker.get(comp);\n            var optRgbForm = Composing.getCurrent(picker);\n            optRgbForm.fold(function () {\n              console.log('Can not find form');\n            }, function (rgbForm) {\n              Representing.setValue(rgbForm, {\n                hex: Optional.from(m[1]).getOr('')\n              });\n              Form.getField(rgbForm, 'hex').each(function (hexField) {\n                emit(hexField, input());\n              });\n            });\n          }\n        }\n      }), ComposingConfigs.self()])\n    };\n  };\n\n  var global$6 = tinymce.util.Tools.resolve('tinymce.Resource');\n\n  var isOldCustomEditor = function (spec) {\n    return has$2(spec, 'init');\n  };\n\n  var renderCustomEditor = function (spec) {\n    var editorApi = value$1();\n    var memReplaced = record({\n      dom: {\n        tag: spec.tag\n      }\n    });\n    var initialValue = value$1();\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-custom-editor']\n      },\n      behaviours: derive$1([config('custom-editor-events', [runOnAttached(function (component) {\n        memReplaced.getOpt(component).each(function (ta) {\n          (isOldCustomEditor(spec) ? spec.init(ta.element.dom) : global$6.load(spec.scriptId, spec.scriptUrl).then(function (init) {\n            return init(ta.element.dom, spec.settings);\n          })).then(function (ea) {\n            initialValue.on(function (cvalue) {\n              ea.setValue(cvalue);\n            });\n            initialValue.clear();\n            editorApi.set(ea);\n          });\n        });\n      })]), Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function () {\n            return editorApi.get().fold(function () {\n              return initialValue.get().getOr('');\n            }, function (ed) {\n              return ed.getValue();\n            });\n          },\n          setValue: function (component, value) {\n            editorApi.get().fold(function () {\n              initialValue.set(value);\n            }, function (ed) {\n              return ed.setValue(value);\n            });\n          }\n        }\n      }), ComposingConfigs.self()]),\n      components: [memReplaced.asSpec()]\n    };\n  };\n\n  var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n  var processors = objOf([defaulted('preprocess', identity$1), defaulted('postprocess', identity$1)]);\n\n  var memento = function (mem, rawProcessors) {\n    var ps = asRawOrDie$1('RepresentingConfigs.memento processors', processors, rawProcessors);\n    return Representing.config({\n      store: {\n        mode: 'manual',\n        getValue: function (comp) {\n          var other = mem.get(comp);\n          var rawValue = Representing.getValue(other);\n          return ps.postprocess(rawValue);\n        },\n        setValue: function (comp, rawValue) {\n          var newValue = ps.preprocess(rawValue);\n          var other = mem.get(comp);\n          Representing.setValue(other, newValue);\n        }\n      }\n    });\n  };\n\n  var withComp = function (optInitialValue, getter, setter) {\n    return Representing.config(deepMerge({\n      store: {\n        mode: 'manual',\n        getValue: getter,\n        setValue: setter\n      }\n    }, optInitialValue.map(function (initialValue) {\n      return {\n        store: {\n          initialValue: initialValue\n        }\n      };\n    }).getOr({})));\n  };\n\n  var withElement = function (initialValue, getter, setter) {\n    return withComp(initialValue, function (c) {\n      return getter(c.element);\n    }, function (c, v) {\n      return setter(c.element, v);\n    });\n  };\n\n  var domValue = function (optInitialValue) {\n    return withElement(optInitialValue, get$5, set$4);\n  };\n\n  var domHtml = function (optInitialValue) {\n    return withElement(optInitialValue, get$7, set$5);\n  };\n\n  var memory = function (initialValue) {\n    return Representing.config({\n      store: {\n        mode: 'memory',\n        initialValue: initialValue\n      }\n    });\n  };\n\n  var RepresentingConfigs = {\n    memento: memento,\n    withElement: withElement,\n    withComp: withComp,\n    domValue: domValue,\n    domHtml: domHtml,\n    memory: memory\n  };\n  var defaultImageFileTypes = 'jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp';\n\n  var filterByExtension = function (files, providersBackstage) {\n    var allowedImageFileTypes = global$5.explode(providersBackstage.getSetting('images_file_types', defaultImageFileTypes, 'string'));\n\n    var isFileInAllowedTypes = function (file) {\n      return exists(allowedImageFileTypes, function (type) {\n        return endsWith(file.name.toLowerCase(), '.' + type.toLowerCase());\n      });\n    };\n\n    return filter$2(from(files), isFileInAllowedTypes);\n  };\n\n  var renderDropZone = function (spec, providersBackstage) {\n    var stopper = function (_, se) {\n      se.stop();\n    };\n\n    var sequence = function (actions) {\n      return function (comp, se) {\n        each$1(actions, function (a) {\n          a(comp, se);\n        });\n      };\n    };\n\n    var onDrop = function (comp, se) {\n      if (!Disabling.isDisabled(comp)) {\n        var transferEvent = se.event.raw;\n        handleFiles(comp, transferEvent.dataTransfer.files);\n      }\n    };\n\n    var onSelect = function (component, simulatedEvent) {\n      var input = simulatedEvent.event.raw.target;\n      handleFiles(component, input.files);\n    };\n\n    var handleFiles = function (component, files) {\n      Representing.setValue(component, filterByExtension(files, providersBackstage));\n      emitWith(component, formChangeEvent, {\n        name: spec.name\n      });\n    };\n\n    var memInput = record({\n      dom: {\n        tag: 'input',\n        attributes: {\n          type: 'file',\n          accept: 'image/*'\n        },\n        styles: {\n          display: 'none'\n        }\n      },\n      behaviours: derive$1([config('input-file-events', [cutter(click()), cutter(tap())])])\n    });\n\n    var renderField = function (s) {\n      return {\n        uid: s.uid,\n        dom: {\n          tag: 'div',\n          classes: ['tox-dropzone-container']\n        },\n        behaviours: derive$1([RepresentingConfigs.memory([]), ComposingConfigs.self(), Disabling.config({}), Toggling.config({\n          toggleClass: 'dragenter',\n          toggleOnExecute: false\n        }), config('dropzone-events', [run$1('dragenter', sequence([stopper, Toggling.toggle])), run$1('dragleave', sequence([stopper, Toggling.toggle])), run$1('dragover', stopper), run$1('drop', sequence([stopper, onDrop])), run$1(change(), onSelect)])]),\n        components: [{\n          dom: {\n            tag: 'div',\n            classes: ['tox-dropzone'],\n            styles: {}\n          },\n          components: [{\n            dom: {\n              tag: 'p',\n              innerHtml: providersBackstage.translate('Drop an image here')\n            }\n          }, Button.sketch({\n            dom: {\n              tag: 'button',\n              innerHtml: providersBackstage.translate('Browse for an image'),\n              styles: {\n                position: 'relative'\n              },\n              classes: ['tox-button', 'tox-button--secondary']\n            },\n            components: [memInput.asSpec()],\n            action: function (comp) {\n              var inputComp = memInput.get(comp);\n              inputComp.element.dom.click();\n            },\n            buttonBehaviours: derive$1([Tabstopping.config({}), DisablingConfigs.button(providersBackstage.isDisabled), receivingConfig()])\n          })]\n        }]\n      };\n    };\n\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel$2(label, providersBackstage);\n    });\n    var pField = FormField.parts.field({\n      factory: {\n        sketch: renderField\n      }\n    });\n    return renderFormFieldWith(pLabel, pField, ['tox-form__group--stretched'], []);\n  };\n\n  var renderGrid = function (spec, backstage) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__grid', 'tox-form__grid--' + spec.columns + 'col']\n      },\n      components: map$2(spec.items, backstage.interpreter)\n    };\n  };\n\n  var beforeObject = generate$6('alloy-fake-before-tabstop');\n  var afterObject = generate$6('alloy-fake-after-tabstop');\n\n  var craftWithClasses = function (classes) {\n    return {\n      dom: {\n        tag: 'div',\n        styles: {\n          width: '1px',\n          height: '1px',\n          outline: 'none'\n        },\n        attributes: {\n          tabindex: '0'\n        },\n        classes: classes\n      },\n      behaviours: derive$1([Focusing.config({\n        ignore: true\n      }), Tabstopping.config({})])\n    };\n  };\n\n  var craft = function (spec) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-navobj']\n      },\n      components: [craftWithClasses([beforeObject]), spec, craftWithClasses([afterObject])],\n      behaviours: derive$1([ComposingConfigs.childAt(1)])\n    };\n  };\n\n  var triggerTab = function (placeholder, shiftKey) {\n    emitWith(placeholder, keydown(), {\n      raw: {\n        which: 9,\n        shiftKey: shiftKey\n      }\n    });\n  };\n\n  var onFocus = function (container, targetComp) {\n    var target = targetComp.element;\n\n    if (has(target, beforeObject)) {\n      triggerTab(container, true);\n    } else if (has(target, afterObject)) {\n      triggerTab(container, false);\n    }\n  };\n\n  var isPseudoStop = function (element) {\n    return closest(element, ['.' + beforeObject, '.' + afterObject].join(','), never);\n  };\n\n  var platformNeedsSandboxing = !(detect$1().browser.isIE() || detect$1().browser.isEdge());\n\n  var getDynamicSource = function (isSandbox) {\n    var cachedValue = Cell('');\n    return {\n      getValue: function (_frameComponent) {\n        return cachedValue.get();\n      },\n      setValue: function (frameComponent, html) {\n        if (!isSandbox) {\n          set$8(frameComponent.element, 'src', 'javascript:\\'\\'');\n          var doc = frameComponent.element.dom.contentWindow.document;\n          doc.open();\n          doc.write(html);\n          doc.close();\n        } else {\n          set$8(frameComponent.element, 'srcdoc', html);\n        }\n\n        cachedValue.set(html);\n      }\n    };\n  };\n\n  var renderIFrame = function (spec, providersBackstage) {\n    var isSandbox = platformNeedsSandboxing && spec.sandboxed;\n\n    var attributes = __assign(__assign({}, spec.label.map(function (title) {\n      return {\n        title: title\n      };\n    }).getOr({})), isSandbox ? {\n      sandbox: 'allow-scripts allow-same-origin'\n    } : {});\n\n    var sourcing = getDynamicSource(isSandbox);\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel$2(label, providersBackstage);\n    });\n\n    var factory = function (newSpec) {\n      return craft({\n        uid: newSpec.uid,\n        dom: {\n          tag: 'iframe',\n          attributes: attributes\n        },\n        behaviours: derive$1([Tabstopping.config({}), Focusing.config({}), RepresentingConfigs.withComp(Optional.none(), sourcing.getValue, sourcing.setValue)])\n      });\n    };\n\n    var pField = FormField.parts.field({\n      factory: {\n        sketch: factory\n      }\n    });\n    return renderFormFieldWith(pLabel, pField, ['tox-form__group--stretched'], []);\n  };\n\n  var create$3 = function (width, height) {\n    return resize$3(document.createElement('canvas'), width, height);\n  };\n\n  var clone = function (canvas) {\n    var tCanvas = create$3(canvas.width, canvas.height);\n    var ctx = get2dContext(tCanvas);\n    ctx.drawImage(canvas, 0, 0);\n    return tCanvas;\n  };\n\n  var get2dContext = function (canvas) {\n    return canvas.getContext('2d');\n  };\n\n  var resize$3 = function (canvas, width, height) {\n    canvas.width = width;\n    canvas.height = height;\n    return canvas;\n  };\n\n  var getWidth$1 = function (image) {\n    return image.naturalWidth || image.width;\n  };\n\n  var getHeight$1 = function (image) {\n    return image.naturalHeight || image.height;\n  };\n\n  var blobToImage = function (blob) {\n    return new Promise$1(function (resolve, reject) {\n      var blobUrl = URL.createObjectURL(blob);\n      var image = new Image();\n\n      var removeListeners = function () {\n        image.removeEventListener('load', loaded);\n        image.removeEventListener('error', error);\n      };\n\n      var loaded = function () {\n        removeListeners();\n        resolve(image);\n      };\n\n      var error = function () {\n        removeListeners();\n        reject('Unable to load data of type ' + blob.type + ': ' + blobUrl);\n      };\n\n      image.addEventListener('load', loaded);\n      image.addEventListener('error', error);\n      image.src = blobUrl;\n\n      if (image.complete) {\n        setTimeout(loaded, 0);\n      }\n    });\n  };\n\n  var dataUriToBlobSync = function (uri) {\n    var data = uri.split(',');\n    var matches = /data:([^;]+)/.exec(data[0]);\n\n    if (!matches) {\n      return Optional.none();\n    }\n\n    var mimetype = matches[1];\n    var base64 = data[1];\n    var sliceSize = 1024;\n    var byteCharacters = atob(base64);\n    var bytesLength = byteCharacters.length;\n    var slicesCount = Math.ceil(bytesLength / sliceSize);\n    var byteArrays = new Array(slicesCount);\n\n    for (var sliceIndex = 0; sliceIndex < slicesCount; ++sliceIndex) {\n      var begin = sliceIndex * sliceSize;\n      var end = Math.min(begin + sliceSize, bytesLength);\n      var bytes = new Array(end - begin);\n\n      for (var offset = begin, i = 0; offset < end; ++i, ++offset) {\n        bytes[i] = byteCharacters[offset].charCodeAt(0);\n      }\n\n      byteArrays[sliceIndex] = new Uint8Array(bytes);\n    }\n\n    return Optional.some(new Blob(byteArrays, {\n      type: mimetype\n    }));\n  };\n\n  var dataUriToBlob = function (uri) {\n    return new Promise$1(function (resolve, reject) {\n      dataUriToBlobSync(uri).fold(function () {\n        reject('uri is not base64: ' + uri);\n      }, resolve);\n    });\n  };\n\n  var canvasToBlob = function (canvas, type, quality) {\n    type = type || 'image/png';\n\n    if (isFunction(HTMLCanvasElement.prototype.toBlob)) {\n      return new Promise$1(function (resolve, reject) {\n        canvas.toBlob(function (blob) {\n          if (blob) {\n            resolve(blob);\n          } else {\n            reject();\n          }\n        }, type, quality);\n      });\n    } else {\n      return dataUriToBlob(canvas.toDataURL(type, quality));\n    }\n  };\n\n  var canvasToDataURL = function (canvas, type, quality) {\n    type = type || 'image/png';\n    return canvas.toDataURL(type, quality);\n  };\n\n  var blobToCanvas = function (blob) {\n    return blobToImage(blob).then(function (image) {\n      revokeImageUrl(image);\n      var canvas = create$3(getWidth$1(image), getHeight$1(image));\n      var context = get2dContext(canvas);\n      context.drawImage(image, 0, 0);\n      return canvas;\n    });\n  };\n\n  var blobToDataUri = function (blob) {\n    return new Promise$1(function (resolve) {\n      var reader = new FileReader();\n\n      reader.onloadend = function () {\n        resolve(reader.result);\n      };\n\n      reader.readAsDataURL(blob);\n    });\n  };\n\n  var revokeImageUrl = function (image) {\n    URL.revokeObjectURL(image.src);\n  };\n\n  var create$2 = function (getCanvas, blob, uri) {\n    var initialType = blob.type;\n    var getType = constant$1(initialType);\n\n    var toBlob = function () {\n      return Promise$1.resolve(blob);\n    };\n\n    var toDataURL = constant$1(uri);\n\n    var toBase64 = function () {\n      return uri.split(',')[1];\n    };\n\n    var toAdjustedBlob = function (type, quality) {\n      return getCanvas.then(function (canvas) {\n        return canvasToBlob(canvas, type, quality);\n      });\n    };\n\n    var toAdjustedDataURL = function (type, quality) {\n      return getCanvas.then(function (canvas) {\n        return canvasToDataURL(canvas, type, quality);\n      });\n    };\n\n    var toAdjustedBase64 = function (type, quality) {\n      return toAdjustedDataURL(type, quality).then(function (dataurl) {\n        return dataurl.split(',')[1];\n      });\n    };\n\n    var toCanvas = function () {\n      return getCanvas.then(clone);\n    };\n\n    return {\n      getType: getType,\n      toBlob: toBlob,\n      toDataURL: toDataURL,\n      toBase64: toBase64,\n      toAdjustedBlob: toAdjustedBlob,\n      toAdjustedDataURL: toAdjustedDataURL,\n      toAdjustedBase64: toAdjustedBase64,\n      toCanvas: toCanvas\n    };\n  };\n\n  var fromBlob = function (blob) {\n    return blobToDataUri(blob).then(function (uri) {\n      return create$2(blobToCanvas(blob), blob, uri);\n    });\n  };\n\n  var fromCanvas = function (canvas, type) {\n    return canvasToBlob(canvas, type).then(function (blob) {\n      return create$2(Promise$1.resolve(canvas), blob, canvas.toDataURL());\n    });\n  };\n\n  var blobToImageResult = function (blob) {\n    return fromBlob(blob);\n  };\n\n  var clamp = function (value, min, max) {\n    var parsedValue = typeof value === 'string' ? parseFloat(value) : value;\n\n    if (parsedValue > max) {\n      parsedValue = max;\n    } else if (parsedValue < min) {\n      parsedValue = min;\n    }\n\n    return parsedValue;\n  };\n\n  var identity = function () {\n    return [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];\n  };\n\n  var DELTA_INDEX = [0, 0.01, 0.02, 0.04, 0.05, 0.06, 0.07, 0.08, 0.1, 0.11, 0.12, 0.14, 0.15, 0.16, 0.17, 0.18, 0.2, 0.21, 0.22, 0.24, 0.25, 0.27, 0.28, 0.3, 0.32, 0.34, 0.36, 0.38, 0.4, 0.42, 0.44, 0.46, 0.48, 0.5, 0.53, 0.56, 0.59, 0.62, 0.65, 0.68, 0.71, 0.74, 0.77, 0.8, 0.83, 0.86, 0.89, 0.92, 0.95, 0.98, 1, 1.06, 1.12, 1.18, 1.24, 1.3, 1.36, 1.42, 1.48, 1.54, 1.6, 1.66, 1.72, 1.78, 1.84, 1.9, 1.96, 2, 2.12, 2.25, 2.37, 2.5, 2.62, 2.75, 2.87, 3, 3.2, 3.4, 3.6, 3.8, 4, 4.3, 4.7, 4.9, 5, 5.5, 6, 6.5, 6.8, 7, 7.3, 7.5, 7.8, 8, 8.4, 8.7, 9, 9.4, 9.6, 9.8, 10];\n\n  var multiply = function (matrix1, matrix2) {\n    var col = [];\n    var out = new Array(25);\n    var val;\n\n    for (var i = 0; i < 5; i++) {\n      for (var j = 0; j < 5; j++) {\n        col[j] = matrix2[j + i * 5];\n      }\n\n      for (var j = 0; j < 5; j++) {\n        val = 0;\n\n        for (var k = 0; k < 5; k++) {\n          val += matrix1[j + k * 5] * col[k];\n        }\n\n        out[j + i * 5] = val;\n      }\n    }\n\n    return out;\n  };\n\n  var adjustContrast = function (matrix, value) {\n    var x;\n    value = clamp(value, -1, 1);\n    value *= 100;\n\n    if (value < 0) {\n      x = 127 + value / 100 * 127;\n    } else {\n      x = value % 1;\n\n      if (x === 0) {\n        x = DELTA_INDEX[value];\n      } else {\n        x = DELTA_INDEX[Math.floor(value)] * (1 - x) + DELTA_INDEX[Math.floor(value) + 1] * x;\n      }\n\n      x = x * 127 + 127;\n    }\n\n    return multiply(matrix, [x / 127, 0, 0, 0, 0.5 * (127 - x), 0, x / 127, 0, 0, 0.5 * (127 - x), 0, 0, x / 127, 0, 0.5 * (127 - x), 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\n  };\n\n  var adjustBrightness = function (matrix, value) {\n    value = clamp(255 * value, -255, 255);\n    return multiply(matrix, [1, 0, 0, 0, value, 0, 1, 0, 0, value, 0, 0, 1, 0, value, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\n  };\n\n  var adjustColors = function (matrix, adjustR, adjustG, adjustB) {\n    adjustR = clamp(adjustR, 0, 2);\n    adjustG = clamp(adjustG, 0, 2);\n    adjustB = clamp(adjustB, 0, 2);\n    return multiply(matrix, [adjustR, 0, 0, 0, 0, 0, adjustG, 0, 0, 0, 0, 0, adjustB, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\n  };\n\n  var colorFilter = function (ir, matrix) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyColorFilter(canvas, ir.getType(), matrix);\n    });\n  };\n\n  var applyColorFilter = function (canvas, type, matrix) {\n    var context = get2dContext(canvas);\n\n    var applyMatrix = function (pixelsData, m) {\n      var r, g, b, a;\n      var data = pixelsData.data,\n          m0 = m[0],\n          m1 = m[1],\n          m2 = m[2],\n          m3 = m[3],\n          m4 = m[4],\n          m5 = m[5],\n          m6 = m[6],\n          m7 = m[7],\n          m8 = m[8],\n          m9 = m[9],\n          m10 = m[10],\n          m11 = m[11],\n          m12 = m[12],\n          m13 = m[13],\n          m14 = m[14],\n          m15 = m[15],\n          m16 = m[16],\n          m17 = m[17],\n          m18 = m[18],\n          m19 = m[19];\n\n      for (var i = 0; i < data.length; i += 4) {\n        r = data[i];\n        g = data[i + 1];\n        b = data[i + 2];\n        a = data[i + 3];\n        data[i] = r * m0 + g * m1 + b * m2 + a * m3 + m4;\n        data[i + 1] = r * m5 + g * m6 + b * m7 + a * m8 + m9;\n        data[i + 2] = r * m10 + g * m11 + b * m12 + a * m13 + m14;\n        data[i + 3] = r * m15 + g * m16 + b * m17 + a * m18 + m19;\n      }\n\n      return pixelsData;\n    };\n\n    var pixels = applyMatrix(context.getImageData(0, 0, canvas.width, canvas.height), matrix);\n    context.putImageData(pixels, 0, 0);\n    return fromCanvas(canvas, type);\n  };\n\n  var convoluteFilter = function (ir, matrix) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyConvoluteFilter(canvas, ir.getType(), matrix);\n    });\n  };\n\n  var applyConvoluteFilter = function (canvas, type, matrix) {\n    var context = get2dContext(canvas);\n\n    var applyMatrix = function (pIn, pOut, aMatrix) {\n      var clamp = function (value, min, max) {\n        if (value > max) {\n          value = max;\n        } else if (value < min) {\n          value = min;\n        }\n\n        return value;\n      };\n\n      var side = Math.round(Math.sqrt(aMatrix.length));\n      var halfSide = Math.floor(side / 2);\n      var rgba = pIn.data;\n      var drgba = pOut.data;\n      var w = pIn.width;\n      var h = pIn.height;\n\n      for (var y = 0; y < h; y++) {\n        for (var x = 0; x < w; x++) {\n          var r = 0;\n          var g = 0;\n          var b = 0;\n\n          for (var cy = 0; cy < side; cy++) {\n            for (var cx = 0; cx < side; cx++) {\n              var scx = clamp(x + cx - halfSide, 0, w - 1);\n              var scy = clamp(y + cy - halfSide, 0, h - 1);\n              var innerOffset = (scy * w + scx) * 4;\n              var wt = aMatrix[cy * side + cx];\n              r += rgba[innerOffset] * wt;\n              g += rgba[innerOffset + 1] * wt;\n              b += rgba[innerOffset + 2] * wt;\n            }\n          }\n\n          var offset = (y * w + x) * 4;\n          drgba[offset] = clamp(r, 0, 255);\n          drgba[offset + 1] = clamp(g, 0, 255);\n          drgba[offset + 2] = clamp(b, 0, 255);\n        }\n      }\n\n      return pOut;\n    };\n\n    var pixelsIn = context.getImageData(0, 0, canvas.width, canvas.height);\n    var pixelsOut = context.getImageData(0, 0, canvas.width, canvas.height);\n    pixelsOut = applyMatrix(pixelsIn, pixelsOut, matrix);\n    context.putImageData(pixelsOut, 0, 0);\n    return fromCanvas(canvas, type);\n  };\n\n  var functionColorFilter = function (colorFn) {\n    var filterImpl = function (canvas, type, value) {\n      var context = get2dContext(canvas);\n      var lookup = new Array(256);\n\n      var applyLookup = function (pixelsData, lookupData) {\n        var data = pixelsData.data;\n\n        for (var i = 0; i < data.length; i += 4) {\n          data[i] = lookupData[data[i]];\n          data[i + 1] = lookupData[data[i + 1]];\n          data[i + 2] = lookupData[data[i + 2]];\n        }\n\n        return pixelsData;\n      };\n\n      for (var i = 0; i < lookup.length; i++) {\n        lookup[i] = colorFn(i, value);\n      }\n\n      var pixels = applyLookup(context.getImageData(0, 0, canvas.width, canvas.height), lookup);\n      context.putImageData(pixels, 0, 0);\n      return fromCanvas(canvas, type);\n    };\n\n    return function (ir, value) {\n      return ir.toCanvas().then(function (canvas) {\n        return filterImpl(canvas, ir.getType(), value);\n      });\n    };\n  };\n\n  var complexAdjustableColorFilter = function (matrixAdjustFn) {\n    return function (ir, adjust) {\n      return colorFilter(ir, matrixAdjustFn(identity(), adjust));\n    };\n  };\n\n  var basicColorFilter = function (matrix) {\n    return function (ir) {\n      return colorFilter(ir, matrix);\n    };\n  };\n\n  var basicConvolutionFilter = function (kernel) {\n    return function (ir) {\n      return convoluteFilter(ir, kernel);\n    };\n  };\n\n  var invert$1 = basicColorFilter([-1, 0, 0, 0, 255, 0, -1, 0, 0, 255, 0, 0, -1, 0, 255, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\n  var brightness$1 = complexAdjustableColorFilter(adjustBrightness);\n  var contrast$1 = complexAdjustableColorFilter(adjustContrast);\n\n  var colorize$1 = function (ir, adjustR, adjustG, adjustB) {\n    return colorFilter(ir, adjustColors(identity(), adjustR, adjustG, adjustB));\n  };\n\n  var sharpen$1 = basicConvolutionFilter([0, -1, 0, -1, 5, -1, 0, -1, 0]);\n  var gamma$1 = functionColorFilter(function (color, value) {\n    return Math.pow(color / 255, 1 - value) * 255;\n  });\n\n  var scale = function (image, dW, dH) {\n    var sW = getWidth$1(image);\n    var sH = getHeight$1(image);\n    var wRatio = dW / sW;\n    var hRatio = dH / sH;\n    var scaleCapped = false;\n\n    if (wRatio < 0.5 || wRatio > 2) {\n      wRatio = wRatio < 0.5 ? 0.5 : 2;\n      scaleCapped = true;\n    }\n\n    if (hRatio < 0.5 || hRatio > 2) {\n      hRatio = hRatio < 0.5 ? 0.5 : 2;\n      scaleCapped = true;\n    }\n\n    var scaled = _scale(image, wRatio, hRatio);\n\n    return !scaleCapped ? scaled : scaled.then(function (tCanvas) {\n      return scale(tCanvas, dW, dH);\n    });\n  };\n\n  var _scale = function (image, wRatio, hRatio) {\n    return new Promise$1(function (resolve) {\n      var sW = getWidth$1(image);\n      var sH = getHeight$1(image);\n      var dW = Math.floor(sW * wRatio);\n      var dH = Math.floor(sH * hRatio);\n      var canvas = create$3(dW, dH);\n      var context = get2dContext(canvas);\n      context.drawImage(image, 0, 0, sW, sH, 0, 0, dW, dH);\n      resolve(canvas);\n    });\n  };\n\n  var ceilWithPrecision = function (num, precision) {\n    if (precision === void 0) {\n      precision = 2;\n    }\n\n    var mul = Math.pow(10, precision);\n    var upper = Math.round(num * mul);\n    return Math.ceil(upper / mul);\n  };\n\n  var rotate$1 = function (ir, angle) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyRotate(canvas, ir.getType(), angle);\n    });\n  };\n\n  var applyRotate = function (image, type, angle) {\n    var degrees = angle < 0 ? 360 + angle : angle;\n    var rad = degrees * Math.PI / 180;\n    var width = image.width;\n    var height = image.height;\n    var sin = Math.sin(rad);\n    var cos = Math.cos(rad);\n    var newWidth = ceilWithPrecision(Math.abs(width * cos) + Math.abs(height * sin));\n    var newHeight = ceilWithPrecision(Math.abs(width * sin) + Math.abs(height * cos));\n    var canvas = create$3(newWidth, newHeight);\n    var context = get2dContext(canvas);\n    context.translate(newWidth / 2, newHeight / 2);\n    context.rotate(rad);\n    context.drawImage(image, -width / 2, -height / 2);\n    return fromCanvas(canvas, type);\n  };\n\n  var flip$1 = function (ir, axis) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyFlip(canvas, ir.getType(), axis);\n    });\n  };\n\n  var applyFlip = function (image, type, axis) {\n    var canvas = create$3(image.width, image.height);\n    var context = get2dContext(canvas);\n\n    if (axis === 'v') {\n      context.scale(1, -1);\n      context.drawImage(image, 0, -canvas.height);\n    } else {\n      context.scale(-1, 1);\n      context.drawImage(image, -canvas.width, 0);\n    }\n\n    return fromCanvas(canvas, type);\n  };\n\n  var crop$1 = function (ir, x, y, w, h) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyCrop(canvas, ir.getType(), x, y, w, h);\n    });\n  };\n\n  var applyCrop = function (image, type, x, y, w, h) {\n    var canvas = create$3(w, h);\n    var context = get2dContext(canvas);\n    context.drawImage(image, -x, -y);\n    return fromCanvas(canvas, type);\n  };\n\n  var resize$2 = function (ir, w, h) {\n    return ir.toCanvas().then(function (canvas) {\n      return scale(canvas, w, h).then(function (newCanvas) {\n        return fromCanvas(newCanvas, ir.getType());\n      });\n    });\n  };\n\n  var invert = function (ir) {\n    return invert$1(ir);\n  };\n\n  var sharpen = function (ir) {\n    return sharpen$1(ir);\n  };\n\n  var gamma = function (ir, value) {\n    return gamma$1(ir, value);\n  };\n\n  var colorize = function (ir, adjustR, adjustG, adjustB) {\n    return colorize$1(ir, adjustR, adjustG, adjustB);\n  };\n\n  var brightness = function (ir, adjust) {\n    return brightness$1(ir, adjust);\n  };\n\n  var contrast = function (ir, adjust) {\n    return contrast$1(ir, adjust);\n  };\n\n  var flip = function (ir, axis) {\n    return flip$1(ir, axis);\n  };\n\n  var crop = function (ir, x, y, w, h) {\n    return crop$1(ir, x, y, w, h);\n  };\n\n  var resize$1 = function (ir, w, h) {\n    return resize$2(ir, w, h);\n  };\n\n  var rotate = function (ir, angle) {\n    return rotate$1(ir, angle);\n  };\n\n  var renderIcon = function (iconName, iconsProvider, behaviours) {\n    return render$3(iconName, {\n      tag: 'span',\n      classes: ['tox-icon', 'tox-tbtn__icon-wrap'],\n      behaviours: behaviours\n    }, iconsProvider);\n  };\n\n  var renderIconFromPack = function (iconName, iconsProvider) {\n    return renderIcon(iconName, iconsProvider, []);\n  };\n\n  var renderReplacableIconFromPack = function (iconName, iconsProvider) {\n    return renderIcon(iconName, iconsProvider, [Replacing.config({})]);\n  };\n\n  var renderLabel$1 = function (text, prefix, providersBackstage) {\n    return {\n      dom: {\n        tag: 'span',\n        innerHtml: providersBackstage.translate(text),\n        classes: [prefix + '__select-label']\n      },\n      behaviours: derive$1([Replacing.config({})])\n    };\n  };\n\n  var _a;\n\n  var internalToolbarButtonExecute = generate$6('toolbar.button.execute');\n\n  var onToolbarButtonExecute = function (info) {\n    return runOnExecute$1(function (comp, _simulatedEvent) {\n      runWithApi(info, comp)(function (itemApi) {\n        emitWith(comp, internalToolbarButtonExecute, {\n          buttonApi: itemApi\n        });\n        info.onAction(itemApi);\n      });\n    });\n  };\n\n  var toolbarButtonEventOrder = (_a = {}, _a[execute$5()] = ['disabling', 'alloy.base.behaviour', 'toggling', 'toolbar-button-events'], _a);\n  var updateMenuText = generate$6('update-menu-text');\n  var updateMenuIcon = generate$6('update-menu-icon');\n\n  var renderCommonDropdown = function (spec, prefix, sharedBackstage) {\n    var editorOffCell = Cell(noop);\n    var optMemDisplayText = spec.text.map(function (text) {\n      return record(renderLabel$1(text, prefix, sharedBackstage.providers));\n    });\n    var optMemDisplayIcon = spec.icon.map(function (iconName) {\n      return record(renderReplacableIconFromPack(iconName, sharedBackstage.providers.icons));\n    });\n\n    var onLeftOrRightInMenu = function (comp, se) {\n      var dropdown = Representing.getValue(comp);\n      Focusing.focus(dropdown);\n      emitWith(dropdown, 'keydown', {\n        raw: se.event.raw\n      });\n      Dropdown.close(dropdown);\n      return Optional.some(true);\n    };\n\n    var role = spec.role.fold(function () {\n      return {};\n    }, function (role) {\n      return {\n        role: role\n      };\n    });\n    var tooltipAttributes = spec.tooltip.fold(function () {\n      return {};\n    }, function (tooltip) {\n      var translatedTooltip = sharedBackstage.providers.translate(tooltip);\n      return {\n        'title': translatedTooltip,\n        'aria-label': translatedTooltip\n      };\n    });\n    var iconSpec = render$3('chevron-down', {\n      tag: 'div',\n      classes: [prefix + '__select-chevron']\n    }, sharedBackstage.providers.icons);\n    var memDropdown = record(Dropdown.sketch(__assign(__assign(__assign({}, spec.uid ? {\n      uid: spec.uid\n    } : {}), role), {\n      dom: {\n        tag: 'button',\n        classes: [prefix, prefix + '--select'].concat(map$2(spec.classes, function (c) {\n          return prefix + '--' + c;\n        })),\n        attributes: __assign({}, tooltipAttributes)\n      },\n      components: componentRenderPipeline([optMemDisplayIcon.map(function (mem) {\n        return mem.asSpec();\n      }), optMemDisplayText.map(function (mem) {\n        return mem.asSpec();\n      }), Optional.some(iconSpec)]),\n      matchWidth: true,\n      useMinWidth: true,\n      dropdownBehaviours: derive$1(__spreadArray(__spreadArray([], spec.dropdownBehaviours, true), [DisablingConfigs.button(function () {\n        return spec.disabled || sharedBackstage.providers.isDisabled();\n      }), receivingConfig(), Unselecting.config({}), Replacing.config({}), config('dropdown-events', [onControlAttached(spec, editorOffCell), onControlDetached(spec, editorOffCell)]), config('menubutton-update-display-text', [run$1(updateMenuText, function (comp, se) {\n        optMemDisplayText.bind(function (mem) {\n          return mem.getOpt(comp);\n        }).each(function (displayText) {\n          Replacing.set(displayText, [text(sharedBackstage.providers.translate(se.event.text))]);\n        });\n      }), run$1(updateMenuIcon, function (comp, se) {\n        optMemDisplayIcon.bind(function (mem) {\n          return mem.getOpt(comp);\n        }).each(function (displayIcon) {\n          Replacing.set(displayIcon, [renderReplacableIconFromPack(se.event.icon, sharedBackstage.providers.icons)]);\n        });\n      })])], false)),\n      eventOrder: deepMerge(toolbarButtonEventOrder, {\n        mousedown: ['focusing', 'alloy.base.behaviour', 'item-type-events', 'normal-dropdown-events']\n      }),\n      sandboxBehaviours: derive$1([Keying.config({\n        mode: 'special',\n        onLeft: onLeftOrRightInMenu,\n        onRight: onLeftOrRightInMenu\n      })]),\n      lazySink: sharedBackstage.getSink,\n      toggleClass: prefix + '--active',\n      parts: {\n        menu: part(false, spec.columns, spec.presets)\n      },\n      fetch: function (comp) {\n        return Future.nu(curry(spec.fetch, comp));\n      }\n    })));\n    return memDropdown.asSpec();\n  };\n\n  var isMenuItemReference = function (item) {\n    return isString(item);\n  };\n\n  var isSeparator$1 = function (item) {\n    return item.type === 'separator';\n  };\n\n  var isExpandingMenuItem = function (item) {\n    return has$2(item, 'getSubmenuItems');\n  };\n\n  var separator$2 = {\n    type: 'separator'\n  };\n\n  var unwrapReferences = function (items, menuItems) {\n    var realItems = foldl(items, function (acc, item) {\n      if (isMenuItemReference(item)) {\n        if (item === '') {\n          return acc;\n        } else if (item === '|') {\n          return acc.length > 0 && !isSeparator$1(acc[acc.length - 1]) ? acc.concat([separator$2]) : acc;\n        } else if (has$2(menuItems, item.toLowerCase())) {\n          return acc.concat([menuItems[item.toLowerCase()]]);\n        } else {\n          return acc;\n        }\n      } else {\n        return acc.concat([item]);\n      }\n    }, []);\n\n    if (realItems.length > 0 && isSeparator$1(realItems[realItems.length - 1])) {\n      realItems.pop();\n    }\n\n    return realItems;\n  };\n\n  var getFromExpandingItem = function (item, menuItems) {\n    var submenuItems = item.getSubmenuItems();\n    var rest = expand(submenuItems, menuItems);\n    var newMenus = deepMerge(rest.menus, wrap$1(item.value, rest.items));\n    var newExpansions = deepMerge(rest.expansions, wrap$1(item.value, item.value));\n    return {\n      item: item,\n      menus: newMenus,\n      expansions: newExpansions\n    };\n  };\n\n  var getFromItem = function (item, menuItems) {\n    return isExpandingMenuItem(item) ? getFromExpandingItem(item, menuItems) : {\n      item: item,\n      menus: {},\n      expansions: {}\n    };\n  };\n\n  var generateValueIfRequired = function (item) {\n    if (isSeparator$1(item)) {\n      return item;\n    } else {\n      var itemValue = get$e(item, 'value').getOrThunk(function () {\n        return generate$6('generated-menu-item');\n      });\n      return deepMerge({\n        value: itemValue\n      }, item);\n    }\n  };\n\n  var expand = function (items, menuItems) {\n    var realItems = unwrapReferences(isString(items) ? items.split(' ') : items, menuItems);\n    return foldr(realItems, function (acc, item) {\n      var itemWithValue = generateValueIfRequired(item);\n      var newData = getFromItem(itemWithValue, menuItems);\n      return {\n        menus: deepMerge(acc.menus, newData.menus),\n        items: [newData.item].concat(acc.items),\n        expansions: deepMerge(acc.expansions, newData.expansions)\n      };\n    }, {\n      menus: {},\n      expansions: {},\n      items: []\n    });\n  };\n\n  var build = function (items, itemResponse, backstage, isHorizontalMenu) {\n    var primary = generate$6('primary-menu');\n    var data = expand(items, backstage.shared.providers.menuItems());\n\n    if (data.items.length === 0) {\n      return Optional.none();\n    }\n\n    var mainMenu = createPartialMenu(primary, data.items, itemResponse, backstage, isHorizontalMenu);\n    var submenus = map$1(data.menus, function (menuItems, menuName) {\n      return createPartialMenu(menuName, menuItems, itemResponse, backstage, false);\n    });\n    var menus = deepMerge(submenus, wrap$1(primary, mainMenu));\n    return Optional.from(tieredMenu.tieredData(primary, menus, data.expansions));\n  };\n\n  var getMenuButtonApi = function (component) {\n    return {\n      isDisabled: function () {\n        return Disabling.isDisabled(component);\n      },\n      setDisabled: function (state) {\n        return Disabling.set(component, state);\n      },\n      setActive: function (state) {\n        var elm = component.element;\n\n        if (state) {\n          add$2(elm, 'tox-tbtn--enabled');\n          set$8(elm, 'aria-pressed', true);\n        } else {\n          remove$2(elm, 'tox-tbtn--enabled');\n          remove$7(elm, 'aria-pressed');\n        }\n      },\n      isActive: function () {\n        return has(component.element, 'tox-tbtn--enabled');\n      }\n    };\n  };\n\n  var renderMenuButton = function (spec, prefix, backstage, role) {\n    return renderCommonDropdown({\n      text: spec.text,\n      icon: spec.icon,\n      tooltip: spec.tooltip,\n      role: role,\n      fetch: function (_comp, callback) {\n        spec.fetch(function (items) {\n          callback(build(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false));\n        });\n      },\n      onSetup: spec.onSetup,\n      getApi: getMenuButtonApi,\n      columns: 1,\n      presets: 'normal',\n      classes: [],\n      dropdownBehaviours: [Tabstopping.config({})]\n    }, prefix, backstage.shared);\n  };\n\n  var getFetch = function (items, getButton, backstage) {\n    var getMenuItemAction = function (item) {\n      return function (api) {\n        var newValue = !api.isActive();\n        api.setActive(newValue);\n        item.storage.set(newValue);\n        backstage.shared.getSink().each(function (sink) {\n          getButton().getOpt(sink).each(function (orig) {\n            focus$3(orig.element);\n            emitWith(orig, formActionEvent, {\n              name: item.name,\n              value: item.storage.get()\n            });\n          });\n        });\n      };\n    };\n\n    var getMenuItemSetup = function (item) {\n      return function (api) {\n        api.setActive(item.storage.get());\n      };\n    };\n\n    return function (success) {\n      success(map$2(items, function (item) {\n        var text = item.text.fold(function () {\n          return {};\n        }, function (text) {\n          return {\n            text: text\n          };\n        });\n        return __assign(__assign({\n          type: item.type,\n          active: false\n        }, text), {\n          onAction: getMenuItemAction(item),\n          onSetup: getMenuItemSetup(item)\n        });\n      }));\n    };\n  };\n\n  var renderCommonSpec = function (spec, actionOpt, extraBehaviours, dom, components, providersBackstage) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    var action = actionOpt.fold(function () {\n      return {};\n    }, function (action) {\n      return {\n        action: action\n      };\n    });\n\n    var common = __assign({\n      buttonBehaviours: derive$1([DisablingConfigs.button(function () {\n        return spec.disabled || providersBackstage.isDisabled();\n      }), receivingConfig(), Tabstopping.config({}), config('button press', [preventDefault('click'), preventDefault('mousedown')])].concat(extraBehaviours)),\n      eventOrder: {\n        click: ['button press', 'alloy.base.behaviour'],\n        mousedown: ['button press', 'alloy.base.behaviour']\n      }\n    }, action);\n\n    var domFinal = deepMerge(common, {\n      dom: dom\n    });\n    return deepMerge(domFinal, {\n      components: components\n    });\n  };\n\n  var renderIconButtonSpec = function (spec, action, providersBackstage, extraBehaviours) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    var tooltipAttributes = spec.tooltip.map(function (tooltip) {\n      return {\n        'aria-label': providersBackstage.translate(tooltip),\n        'title': providersBackstage.translate(tooltip)\n      };\n    }).getOr({});\n    var dom = {\n      tag: 'button',\n      classes: ['tox-tbtn'],\n      attributes: tooltipAttributes\n    };\n    var icon = spec.icon.map(function (iconName) {\n      return renderIconFromPack(iconName, providersBackstage.icons);\n    });\n    var components = componentRenderPipeline([icon]);\n    return renderCommonSpec(spec, action, extraBehaviours, dom, components, providersBackstage);\n  };\n\n  var renderIconButton = function (spec, action, providersBackstage, extraBehaviours) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    var iconButtonSpec = renderIconButtonSpec(spec, Optional.some(action), providersBackstage, extraBehaviours);\n    return Button.sketch(iconButtonSpec);\n  };\n\n  var renderButtonSpec = function (spec, action, providersBackstage, extraBehaviours, extraClasses) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    if (extraClasses === void 0) {\n      extraClasses = [];\n    }\n\n    var translatedText = providersBackstage.translate(spec.text);\n    var icon = spec.icon ? spec.icon.map(function (iconName) {\n      return renderIconFromPack(iconName, providersBackstage.icons);\n    }) : Optional.none();\n    var components = icon.isSome() ? componentRenderPipeline([icon]) : [];\n    var innerHtml = icon.isSome() ? {} : {\n      innerHtml: translatedText\n    };\n\n    var classes = __spreadArray(__spreadArray(__spreadArray(__spreadArray([], !spec.primary && !spec.borderless ? ['tox-button', 'tox-button--secondary'] : ['tox-button'], true), icon.isSome() ? ['tox-button--icon'] : [], true), spec.borderless ? ['tox-button--naked'] : [], true), extraClasses, true);\n\n    var dom = __assign(__assign({\n      tag: 'button',\n      classes: classes\n    }, innerHtml), {\n      attributes: {\n        title: translatedText\n      }\n    });\n\n    return renderCommonSpec(spec, action, extraBehaviours, dom, components, providersBackstage);\n  };\n\n  var renderButton = function (spec, action, providersBackstage, extraBehaviours, extraClasses) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    if (extraClasses === void 0) {\n      extraClasses = [];\n    }\n\n    var buttonSpec = renderButtonSpec(spec, Optional.some(action), providersBackstage, extraBehaviours, extraClasses);\n    return Button.sketch(buttonSpec);\n  };\n\n  var getAction = function (name, buttonType) {\n    return function (comp) {\n      if (buttonType === 'custom') {\n        emitWith(comp, formActionEvent, {\n          name: name,\n          value: {}\n        });\n      } else if (buttonType === 'submit') {\n        emit(comp, formSubmitEvent);\n      } else if (buttonType === 'cancel') {\n        emit(comp, formCancelEvent);\n      } else {\n        console.error('Unknown button type: ', buttonType);\n      }\n    };\n  };\n\n  var isMenuFooterButtonSpec = function (spec, buttonType) {\n    return buttonType === 'menu';\n  };\n\n  var isNormalFooterButtonSpec = function (spec, buttonType) {\n    return buttonType === 'custom' || buttonType === 'cancel' || buttonType === 'submit';\n  };\n\n  var renderFooterButton = function (spec, buttonType, backstage) {\n    if (isMenuFooterButtonSpec(spec, buttonType)) {\n      var getButton = function () {\n        return memButton_1;\n      };\n\n      var menuButtonSpec = spec;\n\n      var fixedSpec = __assign(__assign({}, spec), {\n        onSetup: function (api) {\n          api.setDisabled(spec.disabled);\n          return noop;\n        },\n        fetch: getFetch(menuButtonSpec.items, getButton, backstage)\n      });\n\n      var memButton_1 = record(renderMenuButton(fixedSpec, 'tox-tbtn', backstage, Optional.none()));\n      return memButton_1.asSpec();\n    } else if (isNormalFooterButtonSpec(spec, buttonType)) {\n      var action = getAction(spec.name, buttonType);\n\n      var buttonSpec = __assign(__assign({}, spec), {\n        borderless: false\n      });\n\n      return renderButton(buttonSpec, action, backstage.shared.providers, []);\n    } else {\n      console.error('Unknown footer button type: ', buttonType);\n    }\n  };\n\n  var renderDialogButton = function (spec, providersBackstage) {\n    var action = getAction(spec.name, 'custom');\n    return renderFormField(Optional.none(), FormField.parts.field(__assign({\n      factory: Button\n    }, renderButtonSpec(spec, Optional.some(action), providersBackstage, [RepresentingConfigs.memory(''), ComposingConfigs.self()]))));\n  };\n\n  var schema$h = constant$1([defaulted('field1Name', 'field1'), defaulted('field2Name', 'field2'), onStrictHandler('onLockedChange'), markers$1(['lockClass']), defaulted('locked', false), SketchBehaviours.field('coupledFieldBehaviours', [Composing, Representing])]);\n\n  var getField = function (comp, detail, partName) {\n    return getPart(comp, detail, partName).bind(Composing.getCurrent);\n  };\n\n  var coupledPart = function (selfName, otherName) {\n    return required({\n      factory: FormField,\n      name: selfName,\n      overrides: function (detail) {\n        return {\n          fieldBehaviours: derive$1([config('coupled-input-behaviour', [run$1(input(), function (me) {\n            getField(me, detail, otherName).each(function (other) {\n              getPart(me, detail, 'lock').each(function (lock) {\n                if (Toggling.isOn(lock)) {\n                  detail.onLockedChange(me, other, lock);\n                }\n              });\n            });\n          })])])\n        };\n      }\n    });\n  };\n\n  var parts$c = constant$1([coupledPart('field1', 'field2'), coupledPart('field2', 'field1'), required({\n    factory: Button,\n    schema: [required$1('dom')],\n    name: 'lock',\n    overrides: function (detail) {\n      return {\n        buttonBehaviours: derive$1([Toggling.config({\n          selected: detail.locked,\n          toggleClass: detail.markers.lockClass,\n          aria: {\n            mode: 'pressed'\n          }\n        })])\n      };\n    }\n  })]);\n\n  var factory$f = function (detail, components, _spec, _externals) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: SketchBehaviours.augment(detail.coupledFieldBehaviours, [Composing.config({\n        find: Optional.some\n      }), Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (comp) {\n            var _a;\n\n            var parts = getPartsOrDie(comp, detail, ['field1', 'field2']);\n            return _a = {}, _a[detail.field1Name] = Representing.getValue(parts.field1()), _a[detail.field2Name] = Representing.getValue(parts.field2()), _a;\n          },\n          setValue: function (comp, value) {\n            var parts = getPartsOrDie(comp, detail, ['field1', 'field2']);\n\n            if (hasNonNullableKey(value, detail.field1Name)) {\n              Representing.setValue(parts.field1(), value[detail.field1Name]);\n            }\n\n            if (hasNonNullableKey(value, detail.field2Name)) {\n              Representing.setValue(parts.field2(), value[detail.field2Name]);\n            }\n          }\n        }\n      })]),\n      apis: {\n        getField1: function (component) {\n          return getPart(component, detail, 'field1');\n        },\n        getField2: function (component) {\n          return getPart(component, detail, 'field2');\n        },\n        getLock: function (component) {\n          return getPart(component, detail, 'lock');\n        }\n      }\n    };\n  };\n\n  var FormCoupledInputs = composite({\n    name: 'FormCoupledInputs',\n    configFields: schema$h(),\n    partFields: parts$c(),\n    factory: factory$f,\n    apis: {\n      getField1: function (apis, component) {\n        return apis.getField1(component);\n      },\n      getField2: function (apis, component) {\n        return apis.getField2(component);\n      },\n      getLock: function (apis, component) {\n        return apis.getLock(component);\n      }\n    }\n  });\n\n  var formatSize = function (size) {\n    var unitDec = {\n      '': 0,\n      'px': 0,\n      'pt': 1,\n      'mm': 1,\n      'pc': 2,\n      'ex': 2,\n      'em': 2,\n      'ch': 2,\n      'rem': 2,\n      'cm': 3,\n      'in': 4,\n      '%': 4\n    };\n\n    var maxDecimal = function (unit) {\n      return unit in unitDec ? unitDec[unit] : 1;\n    };\n\n    var numText = size.value.toFixed(maxDecimal(size.unit));\n\n    if (numText.indexOf('.') !== -1) {\n      numText = numText.replace(/\\.?0*$/, '');\n    }\n\n    return numText + size.unit;\n  };\n\n  var parseSize = function (sizeText) {\n    var numPattern = /^\\s*(\\d+(?:\\.\\d+)?)\\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\\s*$/;\n    var match = numPattern.exec(sizeText);\n\n    if (match !== null) {\n      var value = parseFloat(match[1]);\n      var unit = match[2];\n      return Result.value({\n        value: value,\n        unit: unit\n      });\n    } else {\n      return Result.error(sizeText);\n    }\n  };\n\n  var convertUnit = function (size, unit) {\n    var inInch = {\n      '': 96,\n      'px': 96,\n      'pt': 72,\n      'cm': 2.54,\n      'pc': 12,\n      'mm': 25.4,\n      'in': 1\n    };\n\n    var supported = function (u) {\n      return has$2(inInch, u);\n    };\n\n    if (size.unit === unit) {\n      return Optional.some(size.value);\n    } else if (supported(size.unit) && supported(unit)) {\n      if (inInch[size.unit] === inInch[unit]) {\n        return Optional.some(size.value);\n      } else {\n        return Optional.some(size.value / inInch[size.unit] * inInch[unit]);\n      }\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var noSizeConversion = function (_input) {\n    return Optional.none();\n  };\n\n  var ratioSizeConversion = function (scale, unit) {\n    return function (size) {\n      return convertUnit(size, unit).map(function (value) {\n        return {\n          value: value * scale,\n          unit: unit\n        };\n      });\n    };\n  };\n\n  var makeRatioConverter = function (currentFieldText, otherFieldText) {\n    var cValue = parseSize(currentFieldText).toOptional();\n    var oValue = parseSize(otherFieldText).toOptional();\n    return lift2(cValue, oValue, function (cSize, oSize) {\n      return convertUnit(cSize, oSize.unit).map(function (val) {\n        return oSize.value / val;\n      }).map(function (r) {\n        return ratioSizeConversion(r, oSize.unit);\n      }).getOr(noSizeConversion);\n    }).getOr(noSizeConversion);\n  };\n\n  var renderSizeInput = function (spec, providersBackstage) {\n    var converter = noSizeConversion;\n    var ratioEvent = generate$6('ratio-event');\n\n    var makeIcon = function (iconName) {\n      return render$3(iconName, {\n        tag: 'span',\n        classes: ['tox-icon', 'tox-lock-icon__' + iconName]\n      }, providersBackstage.icons);\n    };\n\n    var pLock = FormCoupledInputs.parts.lock({\n      dom: {\n        tag: 'button',\n        classes: ['tox-lock', 'tox-button', 'tox-button--naked', 'tox-button--icon'],\n        attributes: {\n          title: providersBackstage.translate(spec.label.getOr('Constrain proportions'))\n        }\n      },\n      components: [makeIcon('lock'), makeIcon('unlock')],\n      buttonBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        }\n      }), receivingConfig(), Tabstopping.config({})])\n    });\n\n    var formGroup = function (components) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: components\n      };\n    };\n\n    var getFieldPart = function (isField1) {\n      return FormField.parts.field({\n        factory: Input,\n        inputClasses: ['tox-textfield'],\n        inputBehaviours: derive$1([Disabling.config({\n          disabled: function () {\n            return spec.disabled || providersBackstage.isDisabled();\n          }\n        }), receivingConfig(), Tabstopping.config({}), config('size-input-events', [run$1(focusin(), function (component, _simulatedEvent) {\n          emitWith(component, ratioEvent, {\n            isField1: isField1\n          });\n        }), run$1(change(), function (component, _simulatedEvent) {\n          emitWith(component, formChangeEvent, {\n            name: spec.name\n          });\n        })])]),\n        selectOnFocus: false\n      });\n    };\n\n    var getLabel = function (label) {\n      return {\n        dom: {\n          tag: 'label',\n          classes: ['tox-label'],\n          innerHtml: providersBackstage.translate(label)\n        }\n      };\n    };\n\n    var widthField = FormCoupledInputs.parts.field1(formGroup([FormField.parts.label(getLabel('Width')), getFieldPart(true)]));\n    var heightField = FormCoupledInputs.parts.field2(formGroup([FormField.parts.label(getLabel('Height')), getFieldPart(false)]));\n    return FormCoupledInputs.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__controls-h-stack']\n        },\n        components: [widthField, heightField, formGroup([getLabel('&nbsp;'), pLock])]\n      }],\n      field1Name: 'width',\n      field2Name: 'height',\n      locked: true,\n      markers: {\n        lockClass: 'tox-locked'\n      },\n      onLockedChange: function (current, other, _lock) {\n        parseSize(Representing.getValue(current)).each(function (size) {\n          converter(size).each(function (newSize) {\n            Representing.setValue(other, formatSize(newSize));\n          });\n        });\n      },\n      coupledFieldBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        },\n        onDisabled: function (comp) {\n          FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.disable);\n          FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.disable);\n          FormCoupledInputs.getLock(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.enable);\n          FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.enable);\n          FormCoupledInputs.getLock(comp).each(Disabling.enable);\n        }\n      }), receivingConfig(), config('size-input-events2', [run$1(ratioEvent, function (component, simulatedEvent) {\n        var isField1 = simulatedEvent.event.isField1;\n        var optCurrent = isField1 ? FormCoupledInputs.getField1(component) : FormCoupledInputs.getField2(component);\n        var optOther = isField1 ? FormCoupledInputs.getField2(component) : FormCoupledInputs.getField1(component);\n        var value1 = optCurrent.map(Representing.getValue).getOr('');\n        var value2 = optOther.map(Representing.getValue).getOr('');\n        converter = makeRatioConverter(value1, value2);\n      })])])\n    });\n  };\n\n  var undo = constant$1(generate$6('undo'));\n  var redo = constant$1(generate$6('redo'));\n  var zoom = constant$1(generate$6('zoom'));\n  var back = constant$1(generate$6('back'));\n  var apply = constant$1(generate$6('apply'));\n  var swap = constant$1(generate$6('swap'));\n  var transform$1 = constant$1(generate$6('transform'));\n  var tempTransform = constant$1(generate$6('temp-transform'));\n  var transformApply = constant$1(generate$6('transform-apply'));\n  var internal = {\n    undo: undo,\n    redo: redo,\n    zoom: zoom,\n    back: back,\n    apply: apply,\n    swap: swap,\n    transform: transform$1,\n    tempTransform: tempTransform,\n    transformApply: transformApply\n  };\n  var saveState = constant$1('save-state');\n  var disable = constant$1('disable');\n  var enable = constant$1('enable');\n  var external = {\n    formActionEvent: formActionEvent,\n    saveState: saveState,\n    disable: disable,\n    enable: enable\n  };\n\n  var renderEditPanel = function (imagePanel, providersBackstage) {\n    var createButton = function (text, action, disabled, primary) {\n      return record(renderButton({\n        name: text,\n        text: text,\n        disabled: disabled,\n        primary: primary,\n        icon: Optional.none(),\n        borderless: false\n      }, action, providersBackstage));\n    };\n\n    var createIconButton = function (icon, tooltip, action, disabled) {\n      return record(renderIconButton({\n        name: icon,\n        icon: Optional.some(icon),\n        tooltip: Optional.some(tooltip),\n        disabled: disabled,\n        primary: false,\n        borderless: false\n      }, action, providersBackstage));\n    };\n\n    var disableAllComponents = function (comps, eventcomp) {\n      comps.map(function (mem) {\n        var component = mem.get(eventcomp);\n\n        if (component.hasConfigured(Disabling)) {\n          Disabling.disable(component);\n        }\n      });\n    };\n\n    var enableAllComponents = function (comps, eventcomp) {\n      comps.map(function (mem) {\n        var component = mem.get(eventcomp);\n\n        if (component.hasConfigured(Disabling)) {\n          Disabling.enable(component);\n        }\n      });\n    };\n\n    var panelDom = {\n      tag: 'div',\n      classes: ['tox-image-tools__toolbar', 'tox-image-tools-edit-panel']\n    };\n    var noop$1 = noop;\n\n    var emit$1 = function (comp, event, data) {\n      emitWith(comp, event, data);\n    };\n\n    var emitDisable = function (component) {\n      return emit(component, external.disable());\n    };\n\n    var emitEnable = function (component) {\n      return emit(component, external.enable());\n    };\n\n    var emitTransform = function (comp, transform) {\n      emitDisable(comp);\n      emit$1(comp, internal.transform(), {\n        transform: transform\n      });\n      emitEnable(comp);\n    };\n\n    var emitTempTransform = function (comp, transform) {\n      emitDisable(comp);\n      emit$1(comp, internal.tempTransform(), {\n        transform: transform\n      });\n      emitEnable(comp);\n    };\n\n    var getBackSwap = function (anyInSystem) {\n      return function () {\n        memContainer.getOpt(anyInSystem).each(function (container) {\n          Replacing.set(container, [ButtonPanel]);\n        });\n      };\n    };\n\n    var emitTransformApply = function (comp, transform) {\n      emitDisable(comp);\n      emit$1(comp, internal.transformApply(), {\n        transform: transform,\n        swap: getBackSwap(comp)\n      });\n      emitEnable(comp);\n    };\n\n    var createBackButton = function () {\n      return createButton('Back', function (button) {\n        return emit$1(button, internal.back(), {\n          swap: getBackSwap(button)\n        });\n      }, false, false);\n    };\n\n    var createSpacer = function () {\n      return record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-spacer']\n        },\n        behaviours: derive$1([Disabling.config({})])\n      });\n    };\n\n    var createApplyButton = function () {\n      return createButton('Apply', function (button) {\n        return emit$1(button, internal.apply(), {\n          swap: getBackSwap(button)\n        });\n      }, true, true);\n    };\n\n    var makeCropTransform = function () {\n      return function (ir) {\n        var rect = imagePanel.getRect();\n        return crop(ir, rect.x, rect.y, rect.w, rect.h);\n      };\n    };\n\n    var cropPanelComponents = [createBackButton(), createSpacer(), createButton('Apply', function (button) {\n      var transform = makeCropTransform();\n      emitTransformApply(button, transform);\n      imagePanel.hideCrop();\n    }, false, true)];\n    var CropPanel = Container.sketch({\n      dom: panelDom,\n      components: cropPanelComponents.map(function (mem) {\n        return mem.asSpec();\n      }),\n      containerBehaviours: derive$1([config('image-tools-crop-buttons-events', [run$1(external.disable(), function (comp, _se) {\n        disableAllComponents(cropPanelComponents, comp);\n      }), run$1(external.enable(), function (comp, _se) {\n        enableAllComponents(cropPanelComponents, comp);\n      })])])\n    });\n    var memSize = record(renderSizeInput({\n      name: 'size',\n      label: Optional.none(),\n      constrain: true,\n      disabled: false\n    }, providersBackstage));\n\n    var makeResizeTransform = function (width, height) {\n      return function (ir) {\n        return resize$1(ir, width, height);\n      };\n    };\n\n    var resizePanelComponents = [createBackButton(), createSpacer(), memSize, createSpacer(), createButton('Apply', function (button) {\n      memSize.getOpt(button).each(function (sizeInput) {\n        var value = Representing.getValue(sizeInput);\n        var width = parseInt(value.width, 10);\n        var height = parseInt(value.height, 10);\n        var transform = makeResizeTransform(width, height);\n        emitTransformApply(button, transform);\n      });\n    }, false, true)];\n    var ResizePanel = Container.sketch({\n      dom: panelDom,\n      components: resizePanelComponents.map(function (mem) {\n        return mem.asSpec();\n      }),\n      containerBehaviours: derive$1([config('image-tools-resize-buttons-events', [run$1(external.disable(), function (comp, _se) {\n        disableAllComponents(resizePanelComponents, comp);\n      }), run$1(external.enable(), function (comp, _se) {\n        enableAllComponents(resizePanelComponents, comp);\n      })])])\n    });\n\n    var makeValueTransform = function (transform, value) {\n      return function (ir) {\n        return transform(ir, value);\n      };\n    };\n\n    var horizontalFlip = makeValueTransform(flip, 'h');\n    var verticalFlip = makeValueTransform(flip, 'v');\n    var counterclockwiseRotate = makeValueTransform(rotate, -90);\n    var clockwiseRotate = makeValueTransform(rotate, 90);\n\n    var flipRotateOnAction = function (comp, operation) {\n      emitTempTransform(comp, operation);\n    };\n\n    var flipRotateComponents = [createBackButton(), createSpacer(), createIconButton('flip-horizontally', 'Flip horizontally', function (button) {\n      flipRotateOnAction(button, horizontalFlip);\n    }, false), createIconButton('flip-vertically', 'Flip vertically', function (button) {\n      flipRotateOnAction(button, verticalFlip);\n    }, false), createIconButton('rotate-left', 'Rotate counterclockwise', function (button) {\n      flipRotateOnAction(button, counterclockwiseRotate);\n    }, false), createIconButton('rotate-right', 'Rotate clockwise', function (button) {\n      flipRotateOnAction(button, clockwiseRotate);\n    }, false), createSpacer(), createApplyButton()];\n    var FlipRotatePanel = Container.sketch({\n      dom: panelDom,\n      components: flipRotateComponents.map(function (mem) {\n        return mem.asSpec();\n      }),\n      containerBehaviours: derive$1([config('image-tools-fliprotate-buttons-events', [run$1(external.disable(), function (comp, _se) {\n        disableAllComponents(flipRotateComponents, comp);\n      }), run$1(external.enable(), function (comp, _se) {\n        enableAllComponents(flipRotateComponents, comp);\n      })])])\n    });\n\n    var makeSlider = function (label, onChoose, min, value, max) {\n      var labelPart = Slider.parts.label({\n        dom: {\n          tag: 'label',\n          classes: ['tox-label'],\n          innerHtml: providersBackstage.translate(label)\n        }\n      });\n      var spectrum = Slider.parts.spectrum({\n        dom: {\n          tag: 'div',\n          classes: ['tox-slider__rail'],\n          attributes: {\n            role: 'presentation'\n          }\n        }\n      });\n      var thumb = Slider.parts.thumb({\n        dom: {\n          tag: 'div',\n          classes: ['tox-slider__handle'],\n          attributes: {\n            role: 'presentation'\n          }\n        }\n      });\n      return record(Slider.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-slider'],\n          attributes: {\n            role: 'presentation'\n          }\n        },\n        model: {\n          mode: 'x',\n          minX: min,\n          maxX: max,\n          getInitialValue: constant$1({\n            x: value\n          })\n        },\n        components: [labelPart, spectrum, thumb],\n        sliderBehaviours: derive$1([Focusing.config({})]),\n        onChoose: onChoose\n      }));\n    };\n\n    var makeVariableSlider = function (label, transform, min, value, max) {\n      var onChoose = function (slider, _thumb, value) {\n        var valTransform = makeValueTransform(transform, value.x / 100);\n        emitTransform(slider, valTransform);\n      };\n\n      return makeSlider(label, onChoose, min, value, max);\n    };\n\n    var variableFilterPanelComponents = function (label, transform, min, value, max) {\n      return [createBackButton(), makeVariableSlider(label, transform, min, value, max), createApplyButton()];\n    };\n\n    var createVariableFilterPanel = function (label, transform, min, value, max) {\n      var filterPanelComponents = variableFilterPanelComponents(label, transform, min, value, max);\n      return Container.sketch({\n        dom: panelDom,\n        components: filterPanelComponents.map(function (mem) {\n          return mem.asSpec();\n        }),\n        containerBehaviours: derive$1([config('image-tools-filter-panel-buttons-events', [run$1(external.disable(), function (comp, _se) {\n          disableAllComponents(filterPanelComponents, comp);\n        }), run$1(external.enable(), function (comp, _se) {\n          enableAllComponents(filterPanelComponents, comp);\n        })])])\n      });\n    };\n\n    var filterPanelComponents = [createBackButton(), createSpacer(), createApplyButton()];\n    var FilterPanel = Container.sketch({\n      dom: panelDom,\n      components: filterPanelComponents.map(function (mem) {\n        return mem.asSpec();\n      })\n    });\n    var BrightnessPanel = createVariableFilterPanel('Brightness', brightness, -100, 0, 100);\n    var ContrastPanel = createVariableFilterPanel('Contrast', contrast, -100, 0, 100);\n    var GammaPanel = createVariableFilterPanel('Gamma', gamma, -100, 0, 100);\n\n    var makeColorTransform = function (red, green, blue) {\n      return function (ir) {\n        return colorize(ir, red, green, blue);\n      };\n    };\n\n    var makeColorSlider = function (label) {\n      var onChoose = function (slider, _thumb, _value) {\n        var redOpt = memRed.getOpt(slider);\n        var blueOpt = memBlue.getOpt(slider);\n        var greenOpt = memGreen.getOpt(slider);\n        redOpt.each(function (red) {\n          blueOpt.each(function (blue) {\n            greenOpt.each(function (green) {\n              var r = Representing.getValue(red).x / 100;\n              var g = Representing.getValue(green).x / 100;\n              var b = Representing.getValue(blue).x / 100;\n              var transform = makeColorTransform(r, g, b);\n              emitTransform(slider, transform);\n            });\n          });\n        });\n      };\n\n      return makeSlider(label, onChoose, 0, 100, 200);\n    };\n\n    var memRed = makeColorSlider('R');\n    var memGreen = makeColorSlider('G');\n    var memBlue = makeColorSlider('B');\n    var colorizePanelComponents = [createBackButton(), memRed, memGreen, memBlue, createApplyButton()];\n    var ColorizePanel = Container.sketch({\n      dom: panelDom,\n      components: colorizePanelComponents.map(function (mem) {\n        return mem.asSpec();\n      })\n    });\n\n    var getTransformPanelEvent = function (panel, transform, update) {\n      return function (button) {\n        var swap = function () {\n          memContainer.getOpt(button).each(function (container) {\n            Replacing.set(container, [panel]);\n            update(container);\n          });\n        };\n\n        emit$1(button, internal.swap(), {\n          transform: transform,\n          swap: swap\n        });\n      };\n    };\n\n    var cropPanelUpdate = function (_anyInSystem) {\n      imagePanel.showCrop();\n    };\n\n    var resizePanelUpdate = function (anyInSystem) {\n      memSize.getOpt(anyInSystem).each(function (sizeInput) {\n        var measurements = imagePanel.getMeasurements();\n        var width = measurements.width;\n        var height = measurements.height;\n        Representing.setValue(sizeInput, {\n          width: width,\n          height: height\n        });\n      });\n    };\n\n    var sharpenTransform = Optional.some(sharpen);\n    var invertTransform = Optional.some(invert);\n    var buttonPanelComponents = [createIconButton('crop', 'Crop', getTransformPanelEvent(CropPanel, Optional.none(), cropPanelUpdate), false), createIconButton('resize', 'Resize', getTransformPanelEvent(ResizePanel, Optional.none(), resizePanelUpdate), false), createIconButton('orientation', 'Orientation', getTransformPanelEvent(FlipRotatePanel, Optional.none(), noop$1), false), createIconButton('brightness', 'Brightness', getTransformPanelEvent(BrightnessPanel, Optional.none(), noop$1), false), createIconButton('sharpen', 'Sharpen', getTransformPanelEvent(FilterPanel, sharpenTransform, noop$1), false), createIconButton('contrast', 'Contrast', getTransformPanelEvent(ContrastPanel, Optional.none(), noop$1), false), createIconButton('color-levels', 'Color levels', getTransformPanelEvent(ColorizePanel, Optional.none(), noop$1), false), createIconButton('gamma', 'Gamma', getTransformPanelEvent(GammaPanel, Optional.none(), noop$1), false), createIconButton('invert', 'Invert', getTransformPanelEvent(FilterPanel, invertTransform, noop$1), false)];\n    var ButtonPanel = Container.sketch({\n      dom: panelDom,\n      components: buttonPanelComponents.map(function (mem) {\n        return mem.asSpec();\n      })\n    });\n    var container = Container.sketch({\n      dom: {\n        tag: 'div'\n      },\n      components: [ButtonPanel],\n      containerBehaviours: derive$1([Replacing.config({})])\n    });\n    var memContainer = record(container);\n\n    var getApplyButton = function (anyInSystem) {\n      return memContainer.getOpt(anyInSystem).map(function (container) {\n        var panel = container.components()[0];\n        return panel.components()[panel.components().length - 1];\n      });\n    };\n\n    return {\n      memContainer: memContainer,\n      getApplyButton: getApplyButton\n    };\n  };\n\n  var global$4 = tinymce.util.Tools.resolve('tinymce.geom.Rect');\n  var global$3 = tinymce.util.Tools.resolve('tinymce.util.Observable');\n  var global$2 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n  var getDocumentSize = function (doc) {\n    var max = Math.max;\n    var documentElement = doc.documentElement;\n    var body = doc.body;\n    var scrollWidth = max(documentElement.scrollWidth, body.scrollWidth);\n    var clientWidth = max(documentElement.clientWidth, body.clientWidth);\n    var offsetWidth = max(documentElement.offsetWidth, body.offsetWidth);\n    var scrollHeight = max(documentElement.scrollHeight, body.scrollHeight);\n    var clientHeight = max(documentElement.clientHeight, body.clientHeight);\n    var offsetHeight = max(documentElement.offsetHeight, body.offsetHeight);\n    return {\n      width: scrollWidth < offsetWidth ? clientWidth : scrollWidth,\n      height: scrollHeight < offsetHeight ? clientHeight : scrollHeight\n    };\n  };\n\n  var isTouchEvent$1 = function (e) {\n    return isNonNullable(e.changedTouches);\n  };\n\n  var updateWithTouchData = function (e) {\n    if (isTouchEvent$1(e)) {\n      var keys = 'screenX screenY pageX pageY clientX clientY'.split(' ');\n\n      for (var i = 0; i < keys.length; i++) {\n        e[keys[i]] = e.changedTouches[0][keys[i]];\n      }\n    }\n  };\n\n  function DragHelper(id, settings) {\n    var _a, _b, _c;\n\n    var eventOverlay;\n    var handleEvents = [];\n    var overlayEvents = [];\n    var doc = (_a = settings.document) !== null && _a !== void 0 ? _a : document;\n    var root = (_b = settings.root) !== null && _b !== void 0 ? _b : doc;\n    var sugarDoc = SugarElement.fromDom(doc);\n    var downButton;\n    var startX;\n    var startY;\n    var handleElement = SugarElement.fromDom(root.getElementById((_c = settings.handle) !== null && _c !== void 0 ? _c : id));\n\n    var start = function (e) {\n      var rawEvent = e.raw;\n      var docSize = getDocumentSize(doc);\n      updateWithTouchData(rawEvent);\n      e.prevent();\n      downButton = rawEvent.button;\n      startX = rawEvent.screenX;\n      startY = rawEvent.screenY;\n      var cursor = get$c(handleElement, 'cursor');\n      eventOverlay = SugarElement.fromTag('div', doc);\n      setAll(eventOverlay, {\n        'position': 'absolute',\n        'top': '0',\n        'left': '0',\n        'width': docSize.width + 'px',\n        'height': docSize.height + 'px',\n        'z-index': 2147483647 + '',\n        'opacity': '0.0001',\n        cursor: cursor\n      });\n      append$2(getBody(sugarDoc), eventOverlay);\n      overlayEvents.push(bind(sugarDoc, 'mousemove', drag), bind(sugarDoc, 'touchmove', drag), bind(sugarDoc, 'mouseup', stop), bind(sugarDoc, 'touchend', stop));\n      settings.start(rawEvent);\n    };\n\n    var drag = function (e) {\n      var rawEvent = e.raw;\n      updateWithTouchData(rawEvent);\n\n      if (rawEvent.button !== downButton) {\n        return stop(e);\n      }\n\n      rawEvent.deltaX = rawEvent.screenX - startX;\n      rawEvent.deltaY = rawEvent.screenY - startY;\n      e.prevent();\n      settings.drag(rawEvent);\n    };\n\n    var stop = function (e) {\n      updateWithTouchData(e.raw);\n      each$1(overlayEvents, function (e) {\n        return e.unbind();\n      });\n      overlayEvents = [];\n      remove$5(eventOverlay);\n\n      if (settings.stop) {\n        settings.stop(e.raw);\n      }\n    };\n\n    var destroy = function () {\n      each$1(overlayEvents.concat(handleEvents), function (e) {\n        return e.unbind();\n      });\n      overlayEvents = [];\n      handleEvents = [];\n\n      if (isNonNullable(eventOverlay)) {\n        remove$5(eventOverlay);\n      }\n    };\n\n    handleEvents.push(bind(handleElement, 'mousedown', start), bind(handleElement, 'touchstart', start));\n    return {\n      destroy: destroy\n    };\n  }\n\n  var count = 0;\n\n  var create$1 = function (currentRect, viewPortRect, clampRect, containerElm, action) {\n    var dragHelpers;\n    var events = [];\n    var prefix = 'tox-';\n    var id = prefix + 'crid-' + count++;\n    var container = SugarElement.fromDom(containerElm);\n    var handles = [{\n      name: 'move',\n      xMul: 0,\n      yMul: 0,\n      deltaX: 1,\n      deltaY: 1,\n      deltaW: 0,\n      deltaH: 0,\n      label: 'Crop Mask'\n    }, {\n      name: 'nw',\n      xMul: 0,\n      yMul: 0,\n      deltaX: 1,\n      deltaY: 1,\n      deltaW: -1,\n      deltaH: -1,\n      label: 'Top Left Crop Handle'\n    }, {\n      name: 'ne',\n      xMul: 1,\n      yMul: 0,\n      deltaX: 0,\n      deltaY: 1,\n      deltaW: 1,\n      deltaH: -1,\n      label: 'Top Right Crop Handle'\n    }, {\n      name: 'sw',\n      xMul: 0,\n      yMul: 1,\n      deltaX: 1,\n      deltaY: 0,\n      deltaW: -1,\n      deltaH: 1,\n      label: 'Bottom Left Crop Handle'\n    }, {\n      name: 'se',\n      xMul: 1,\n      yMul: 1,\n      deltaX: 0,\n      deltaY: 0,\n      deltaW: 1,\n      deltaH: 1,\n      label: 'Bottom Right Crop Handle'\n    }];\n    var blockers = ['top', 'right', 'bottom', 'left'];\n\n    var getAbsoluteRect = function (outerRect, relativeRect) {\n      return {\n        x: relativeRect.x + outerRect.x,\n        y: relativeRect.y + outerRect.y,\n        w: relativeRect.w,\n        h: relativeRect.h\n      };\n    };\n\n    var getRelativeRect = function (outerRect, innerRect) {\n      return {\n        x: innerRect.x - outerRect.x,\n        y: innerRect.y - outerRect.y,\n        w: innerRect.w,\n        h: innerRect.h\n      };\n    };\n\n    var getInnerRect = function () {\n      return getRelativeRect(clampRect, currentRect);\n    };\n\n    var moveRect = function (handle, startRect, deltaX, deltaY) {\n      var x = startRect.x + deltaX * handle.deltaX;\n      var y = startRect.y + deltaY * handle.deltaY;\n      var w = Math.max(20, startRect.w + deltaX * handle.deltaW);\n      var h = Math.max(20, startRect.h + deltaY * handle.deltaH);\n      var rect = currentRect = global$4.clamp({\n        x: x,\n        y: y,\n        w: w,\n        h: h\n      }, clampRect, handle.name === 'move');\n      rect = getRelativeRect(clampRect, rect);\n      instance.fire('updateRect', {\n        rect: rect\n      });\n      setInnerRect(rect);\n    };\n\n    var render = function () {\n      var createDragHelper = function (handle) {\n        var startRect;\n        return DragHelper(id, {\n          document: containerElm.ownerDocument,\n          root: getRootNode(container).dom,\n          handle: id + '-' + handle.name,\n          start: function () {\n            startRect = currentRect;\n          },\n          drag: function (e) {\n            moveRect(handle, startRect, e.deltaX, e.deltaY);\n          }\n        });\n      };\n\n      var cropContainer = SugarElement.fromTag('div');\n      setAll$1(cropContainer, {\n        id: id,\n        'class': prefix + 'croprect-container',\n        'role': 'grid',\n        'aria-dropeffect': 'execute'\n      });\n      append$2(container, cropContainer);\n      each$1(blockers, function (blocker) {\n        descendant(container, '#' + id).each(function (blockerElm) {\n          var cropBlocker = SugarElement.fromTag('div');\n          setAll$1(cropBlocker, {\n            'id': id + '-' + blocker,\n            'class': prefix + 'croprect-block',\n            'data-mce-bogus': 'all'\n          });\n          set$7(cropBlocker, 'display', 'none');\n          append$2(blockerElm, cropBlocker);\n        });\n      });\n      each$1(handles, function (handle) {\n        descendant(container, '#' + id).each(function (handleElm) {\n          var cropHandle = SugarElement.fromTag('div');\n          setAll$1(cropHandle, {\n            'id': id + '-' + handle.name,\n            'aria-label': handle.label,\n            'aria-grabbed': 'false',\n            'data-mce-bogus': 'all',\n            'role': 'gridcell',\n            'tabindex': '-1',\n            'title': handle.label\n          });\n          add$1(cropHandle, [prefix + 'croprect-handle', prefix + 'croprect-handle-' + handle.name]);\n          set$7(cropHandle, 'display', 'none');\n          append$2(handleElm, cropHandle);\n        });\n      });\n      dragHelpers = map$2(handles, createDragHelper);\n      repaint(currentRect);\n\n      var handleFocus = function (e) {\n        set$8(e.target, 'aria-grabbed', e.raw.type === 'focus' ? 'true' : 'false');\n      };\n\n      var handleKeydown = function (e) {\n        var activeHandle;\n        each$1(handles, function (handle) {\n          if (get$d(e.target, 'id') === id + '-' + handle.name) {\n            activeHandle = handle;\n            return false;\n          }\n        });\n\n        var moveAndBlock = function (evt, handle, startRect, deltaX, deltaY) {\n          evt.stopPropagation();\n          evt.preventDefault();\n          moveRect(activeHandle, startRect, deltaX, deltaY);\n        };\n\n        switch (e.raw.keyCode) {\n          case global$2.LEFT:\n            moveAndBlock(e, activeHandle, currentRect, -10, 0);\n            break;\n\n          case global$2.RIGHT:\n            moveAndBlock(e, activeHandle, currentRect, 10, 0);\n            break;\n\n          case global$2.UP:\n            moveAndBlock(e, activeHandle, currentRect, 0, -10);\n            break;\n\n          case global$2.DOWN:\n            moveAndBlock(e, activeHandle, currentRect, 0, 10);\n            break;\n\n          case global$2.ENTER:\n          case global$2.SPACEBAR:\n            e.prevent();\n            action();\n            break;\n        }\n      };\n\n      events.push(bind(container, 'focusin', handleFocus), bind(container, 'focusout', handleFocus), bind(container, 'keydown', handleKeydown));\n    };\n\n    var toggleVisibility = function (state) {\n      var selectors = __spreadArray(__spreadArray([], map$2(handles, function (handle) {\n        return '#' + id + '-' + handle.name;\n      }), true), map$2(blockers, function (blocker) {\n        return '#' + id + '-' + blocker;\n      }), true).join(',');\n\n      var elems = descendants(container, selectors);\n\n      if (state) {\n        each$1(elems, function (elm) {\n          return remove$6(elm, 'display');\n        });\n      } else {\n        each$1(elems, function (elm) {\n          return set$7(elm, 'display', 'none');\n        });\n      }\n    };\n\n    var repaint = function (rect) {\n      var updateElementRect = function (name, newRect) {\n        descendant(container, '#' + id + '-' + name).each(function (elm) {\n          setAll(elm, {\n            left: newRect.x + 'px',\n            top: newRect.y + 'px',\n            width: Math.max(0, newRect.w) + 'px',\n            height: Math.max(0, newRect.h) + 'px'\n          });\n        });\n      };\n\n      each$1(handles, function (handle) {\n        descendant(container, '#' + id + '-' + handle.name).each(function (elm) {\n          setAll(elm, {\n            left: rect.w * handle.xMul + rect.x + 'px',\n            top: rect.h * handle.yMul + rect.y + 'px'\n          });\n        });\n      });\n      updateElementRect('top', {\n        x: viewPortRect.x,\n        y: viewPortRect.y,\n        w: viewPortRect.w,\n        h: rect.y - viewPortRect.y\n      });\n      updateElementRect('right', {\n        x: rect.x + rect.w,\n        y: rect.y,\n        w: viewPortRect.w - rect.x - rect.w + viewPortRect.x,\n        h: rect.h\n      });\n      updateElementRect('bottom', {\n        x: viewPortRect.x,\n        y: rect.y + rect.h,\n        w: viewPortRect.w,\n        h: viewPortRect.h - rect.y - rect.h + viewPortRect.y\n      });\n      updateElementRect('left', {\n        x: viewPortRect.x,\n        y: rect.y,\n        w: rect.x - viewPortRect.x,\n        h: rect.h\n      });\n      updateElementRect('move', rect);\n    };\n\n    var setRect = function (rect) {\n      currentRect = rect;\n      repaint(currentRect);\n    };\n\n    var setViewPortRect = function (rect) {\n      viewPortRect = rect;\n      repaint(currentRect);\n    };\n\n    var setInnerRect = function (rect) {\n      setRect(getAbsoluteRect(clampRect, rect));\n    };\n\n    var setClampRect = function (rect) {\n      clampRect = rect;\n      repaint(currentRect);\n    };\n\n    var destroy = function () {\n      each$1(dragHelpers, function (helper) {\n        return helper.destroy();\n      });\n      dragHelpers = [];\n      each$1(events, function (e) {\n        return e.unbind();\n      });\n      events = [];\n    };\n\n    render();\n\n    var instance = __assign(__assign({}, global$3), {\n      toggleVisibility: toggleVisibility,\n      setClampRect: setClampRect,\n      setRect: setRect,\n      getInnerRect: getInnerRect,\n      setInnerRect: setInnerRect,\n      setViewPortRect: setViewPortRect,\n      destroy: destroy\n    });\n\n    return instance;\n  };\n\n  var CropRect = {\n    create: create$1\n  };\n\n  var loadImage = function (image) {\n    return new global$c(function (resolve) {\n      var loaded = function () {\n        image.removeEventListener('load', loaded);\n        resolve(image);\n      };\n\n      if (image.complete) {\n        resolve(image);\n      } else {\n        image.addEventListener('load', loaded);\n      }\n    });\n  };\n\n  var renderImagePanel = function (initialUrl) {\n    var memBg = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-image-tools__image-bg'],\n        attributes: {\n          role: 'presentation'\n        }\n      }\n    });\n    var zoomState = Cell(1);\n    var cropRect = api$1();\n    var rectState = Cell({\n      x: 0,\n      y: 0,\n      w: 1,\n      h: 1\n    });\n    var viewRectState = Cell({\n      x: 0,\n      y: 0,\n      w: 1,\n      h: 1\n    });\n\n    var repaintImg = function (anyInSystem, img) {\n      memContainer.getOpt(anyInSystem).each(function (panel) {\n        var zoom = zoomState.get();\n        var panelW = get$a(panel.element);\n        var panelH = get$b(panel.element);\n        var width = img.dom.naturalWidth * zoom;\n        var height = img.dom.naturalHeight * zoom;\n        var left = Math.max(0, panelW / 2 - width / 2);\n        var top = Math.max(0, panelH / 2 - height / 2);\n        var css = {\n          left: left.toString() + 'px',\n          top: top.toString() + 'px',\n          width: width.toString() + 'px',\n          height: height.toString() + 'px',\n          position: 'absolute'\n        };\n        setAll(img, css);\n        memBg.getOpt(panel).each(function (bg) {\n          setAll(bg.element, css);\n        });\n        cropRect.run(function (cRect) {\n          var rect = rectState.get();\n          cRect.setRect({\n            x: rect.x * zoom + left,\n            y: rect.y * zoom + top,\n            w: rect.w * zoom,\n            h: rect.h * zoom\n          });\n          cRect.setClampRect({\n            x: left,\n            y: top,\n            w: width,\n            h: height\n          });\n          cRect.setViewPortRect({\n            x: 0,\n            y: 0,\n            w: panelW,\n            h: panelH\n          });\n        });\n      });\n    };\n\n    var zoomFit = function (anyInSystem, img) {\n      memContainer.getOpt(anyInSystem).each(function (panel) {\n        var panelW = get$a(panel.element);\n        var panelH = get$b(panel.element);\n        var width = img.dom.naturalWidth;\n        var height = img.dom.naturalHeight;\n        var zoom = Math.min(panelW / width, panelH / height);\n\n        if (zoom >= 1) {\n          zoomState.set(1);\n        } else {\n          zoomState.set(zoom);\n        }\n      });\n    };\n\n    var updateSrc = function (anyInSystem, url) {\n      var img = SugarElement.fromTag('img');\n      set$8(img, 'src', url);\n      return loadImage(img.dom).then(function () {\n        if (anyInSystem.getSystem().isConnected()) {\n          memContainer.getOpt(anyInSystem).map(function (panel) {\n            var aImg = external$2({\n              element: img\n            });\n            Replacing.replaceAt(panel, 1, Optional.some(aImg));\n            var lastViewRect = viewRectState.get();\n            var viewRect = {\n              x: 0,\n              y: 0,\n              w: img.dom.naturalWidth,\n              h: img.dom.naturalHeight\n            };\n            viewRectState.set(viewRect);\n            var rect = global$4.inflate(viewRect, -20, -20);\n            rectState.set(rect);\n\n            if (lastViewRect.w !== viewRect.w || lastViewRect.h !== viewRect.h) {\n              zoomFit(panel, img);\n            }\n\n            repaintImg(panel, img);\n          });\n        }\n      });\n    };\n\n    var zoom = function (anyInSystem, direction) {\n      var currentZoom = zoomState.get();\n      var newZoom = direction > 0 ? Math.min(2, currentZoom + 0.1) : Math.max(0.1, currentZoom - 0.1);\n      zoomState.set(newZoom);\n      memContainer.getOpt(anyInSystem).each(function (panel) {\n        var img = panel.components()[1].element;\n        repaintImg(panel, img);\n      });\n    };\n\n    var showCrop = function () {\n      cropRect.run(function (cRect) {\n        cRect.toggleVisibility(true);\n      });\n    };\n\n    var hideCrop = function () {\n      cropRect.run(function (cRect) {\n        cRect.toggleVisibility(false);\n      });\n    };\n\n    var getRect = function () {\n      return rectState.get();\n    };\n\n    var container = Container.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-image-tools__image']\n      },\n      components: [memBg.asSpec(), {\n        dom: {\n          tag: 'img',\n          attributes: {\n            src: initialUrl\n          }\n        }\n      }, {\n        dom: {\n          tag: 'div'\n        },\n        behaviours: derive$1([config('image-panel-crop-events', [runOnAttached(function (comp) {\n          memContainer.getOpt(comp).each(function (container) {\n            var el = container.element.dom;\n            var cRect = CropRect.create({\n              x: 10,\n              y: 10,\n              w: 100,\n              h: 100\n            }, {\n              x: 0,\n              y: 0,\n              w: 200,\n              h: 200\n            }, {\n              x: 0,\n              y: 0,\n              w: 200,\n              h: 200\n            }, el, noop);\n            cRect.toggleVisibility(false);\n            cRect.on('updateRect', function (e) {\n              var rect = e.rect;\n              var zoom = zoomState.get();\n              var newRect = {\n                x: Math.round(rect.x / zoom),\n                y: Math.round(rect.y / zoom),\n                w: Math.round(rect.w / zoom),\n                h: Math.round(rect.h / zoom)\n              };\n              rectState.set(newRect);\n            });\n            cropRect.set(cRect);\n          });\n        }), runOnDetached(function () {\n          cropRect.clear();\n        })])])\n      }],\n      containerBehaviours: derive$1([Replacing.config({}), config('image-panel-events', [runOnAttached(function (comp) {\n        updateSrc(comp, initialUrl);\n      })])])\n    });\n    var memContainer = record(container);\n\n    var getMeasurements = function () {\n      var viewRect = viewRectState.get();\n      return {\n        width: viewRect.w,\n        height: viewRect.h\n      };\n    };\n\n    return {\n      memContainer: memContainer,\n      updateSrc: updateSrc,\n      zoom: zoom,\n      showCrop: showCrop,\n      hideCrop: hideCrop,\n      getRect: getRect,\n      getMeasurements: getMeasurements\n    };\n  };\n\n  var createButton = function (innerHtml, icon, disabled, action, providersBackstage) {\n    return renderIconButton({\n      name: innerHtml,\n      icon: Optional.some(icon),\n      disabled: disabled,\n      tooltip: Optional.some(innerHtml),\n      primary: false,\n      borderless: false\n    }, action, providersBackstage);\n  };\n\n  var setButtonEnabled = function (button, enabled) {\n    if (enabled) {\n      Disabling.enable(button);\n    } else {\n      Disabling.disable(button);\n    }\n  };\n\n  var renderSideBar = function (providersBackstage) {\n    var updateButtonUndoStates = function (anyInSystem, undoEnabled, redoEnabled) {\n      memUndo.getOpt(anyInSystem).each(function (undo) {\n        setButtonEnabled(undo, undoEnabled);\n      });\n      memRedo.getOpt(anyInSystem).each(function (redo) {\n        setButtonEnabled(redo, redoEnabled);\n      });\n    };\n\n    var memUndo = record(createButton('Undo', 'undo', true, function (button) {\n      emitWith(button, internal.undo(), {\n        direction: 1\n      });\n    }, providersBackstage));\n    var memRedo = record(createButton('Redo', 'redo', true, function (button) {\n      emitWith(button, internal.redo(), {\n        direction: 1\n      });\n    }, providersBackstage));\n    var container = Container.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-image-tools__toolbar', 'tox-image-tools__sidebar']\n      },\n      components: [memUndo.asSpec(), memRedo.asSpec(), createButton('Zoom in', 'zoom-in', false, function (button) {\n        emitWith(button, internal.zoom(), {\n          direction: 1\n        });\n      }, providersBackstage), createButton('Zoom out', 'zoom-out', false, function (button) {\n        emitWith(button, internal.zoom(), {\n          direction: -1\n        });\n      }, providersBackstage)]\n    });\n    return {\n      container: container,\n      updateButtonUndoStates: updateButtonUndoStates\n    };\n  };\n\n  function UndoStack() {\n    var data = [];\n    var index = -1;\n\n    var add = function (state) {\n      var removed = data.splice(++index);\n      data.push(state);\n      return {\n        state: state,\n        removed: removed\n      };\n    };\n\n    var undo = function () {\n      if (canUndo()) {\n        return data[--index];\n      }\n    };\n\n    var redo = function () {\n      if (canRedo()) {\n        return data[++index];\n      }\n    };\n\n    var canUndo = function () {\n      return index > 0;\n    };\n\n    var canRedo = function () {\n      return index !== -1 && index < data.length - 1;\n    };\n\n    return {\n      data: data,\n      add: add,\n      undo: undo,\n      redo: redo,\n      canUndo: canUndo,\n      canRedo: canRedo\n    };\n  }\n\n  var makeState = function (initialState) {\n    var blobState = Cell(initialState);\n    var tempState = value$1();\n    var undoStack = UndoStack();\n    undoStack.add(initialState);\n\n    var getBlobState = function () {\n      return blobState.get();\n    };\n\n    var setBlobState = function (state) {\n      blobState.set(state);\n    };\n\n    var getTempState = function () {\n      return tempState.get().getOrThunk(blobState.get);\n    };\n\n    var updateTempState = function (blob) {\n      var newTempState = createState(blob);\n      destroyTempState();\n      tempState.set(newTempState);\n      return newTempState.url;\n    };\n\n    var createState = function (blob) {\n      return {\n        blob: blob,\n        url: URL.createObjectURL(blob)\n      };\n    };\n\n    var destroyState = function (state) {\n      URL.revokeObjectURL(state.url);\n    };\n\n    var destroyStates = function (states) {\n      global$5.each(states, destroyState);\n    };\n\n    var destroyTempState = function () {\n      tempState.on(destroyState);\n      tempState.clear();\n    };\n\n    var addBlobState = function (blob) {\n      var newState = createState(blob);\n      setBlobState(newState);\n      var removed = undoStack.add(newState).removed;\n      destroyStates(removed);\n      return newState.url;\n    };\n\n    var addTempState = function (blob) {\n      var newState = createState(blob);\n      tempState.set(newState);\n      return newState.url;\n    };\n\n    var applyTempState = function (postApply) {\n      return tempState.get().fold(noop, function (temp) {\n        addBlobState(temp.blob);\n        postApply();\n      });\n    };\n\n    var undo = function () {\n      var currentState = undoStack.undo();\n      setBlobState(currentState);\n      return currentState.url;\n    };\n\n    var redo = function () {\n      var currentState = undoStack.redo();\n      setBlobState(currentState);\n      return currentState.url;\n    };\n\n    var getHistoryStates = function () {\n      var undoEnabled = undoStack.canUndo();\n      var redoEnabled = undoStack.canRedo();\n      return {\n        undoEnabled: undoEnabled,\n        redoEnabled: redoEnabled\n      };\n    };\n\n    return {\n      getBlobState: getBlobState,\n      setBlobState: setBlobState,\n      addBlobState: addBlobState,\n      getTempState: getTempState,\n      updateTempState: updateTempState,\n      addTempState: addTempState,\n      applyTempState: applyTempState,\n      destroyTempState: destroyTempState,\n      undo: undo,\n      redo: redo,\n      getHistoryStates: getHistoryStates\n    };\n  };\n\n  var renderImageTools = function (detail, providersBackstage) {\n    var state = makeState(detail.currentState);\n\n    var zoom = function (anyInSystem, simulatedEvent) {\n      var direction = simulatedEvent.event.direction;\n      imagePanel.zoom(anyInSystem, direction);\n    };\n\n    var updateButtonUndoStates = function (anyInSystem) {\n      var historyStates = state.getHistoryStates();\n      sideBar.updateButtonUndoStates(anyInSystem, historyStates.undoEnabled, historyStates.redoEnabled);\n      emitWith(anyInSystem, external.formActionEvent, {\n        name: external.saveState(),\n        value: historyStates.undoEnabled\n      });\n    };\n\n    var disableUndoRedo = function (anyInSystem) {\n      sideBar.updateButtonUndoStates(anyInSystem, false, false);\n    };\n\n    var undo = function (anyInSystem, _simulatedEvent) {\n      var url = state.undo();\n      updateSrc(anyInSystem, url).then(function (_oImg) {\n        unblock(anyInSystem);\n        updateButtonUndoStates(anyInSystem);\n      });\n    };\n\n    var redo = function (anyInSystem, _simulatedEvent) {\n      var url = state.redo();\n      updateSrc(anyInSystem, url).then(function (_oImg) {\n        unblock(anyInSystem);\n        updateButtonUndoStates(anyInSystem);\n      });\n    };\n\n    var imageResultToBlob = function (ir) {\n      return ir.toBlob();\n    };\n\n    var block = function (anyInSystem) {\n      emitWith(anyInSystem, external.formActionEvent, {\n        name: external.disable(),\n        value: {}\n      });\n    };\n\n    var unblock = function (anyInSystem) {\n      editPanel.getApplyButton(anyInSystem).each(function (applyButton) {\n        Disabling.enable(applyButton);\n      });\n      emitWith(anyInSystem, external.formActionEvent, {\n        name: external.enable(),\n        value: {}\n      });\n    };\n\n    var updateSrc = function (anyInSystem, src) {\n      block(anyInSystem);\n      return imagePanel.updateSrc(anyInSystem, src);\n    };\n\n    var blobManipulate = function (anyInSystem, blob, filter, action, swap) {\n      block(anyInSystem);\n      blobToImageResult(blob).then(filter).then(imageResultToBlob).then(action).then(function (url) {\n        return updateSrc(anyInSystem, url);\n      }).then(function () {\n        updateButtonUndoStates(anyInSystem);\n        swap();\n        unblock(anyInSystem);\n      }).catch(function (err) {\n        console.log(err);\n\n        if (anyInSystem.getSystem().isConnected()) {\n          unblock(anyInSystem);\n        }\n      });\n    };\n\n    var manipulate = function (anyInSystem, filter, swap) {\n      var blob = state.getBlobState().blob;\n\n      var action = function (blob) {\n        return state.updateTempState(blob);\n      };\n\n      blobManipulate(anyInSystem, blob, filter, action, swap);\n    };\n\n    var tempManipulate = function (anyInSystem, filter) {\n      var blob = state.getTempState().blob;\n\n      var action = function (blob) {\n        return state.addTempState(blob);\n      };\n\n      blobManipulate(anyInSystem, blob, filter, action, noop);\n    };\n\n    var manipulateApply = function (anyInSystem, filter, swap) {\n      var blob = state.getBlobState().blob;\n\n      var action = function (blob) {\n        var url = state.addBlobState(blob);\n        destroyTempState(anyInSystem);\n        return url;\n      };\n\n      blobManipulate(anyInSystem, blob, filter, action, swap);\n    };\n\n    var apply = function (anyInSystem, simulatedEvent) {\n      var postApply = function () {\n        destroyTempState(anyInSystem);\n        var swap = simulatedEvent.event.swap;\n        swap();\n      };\n\n      state.applyTempState(postApply);\n    };\n\n    var destroyTempState = function (anyInSystem) {\n      var currentUrl = state.getBlobState().url;\n      state.destroyTempState();\n      updateButtonUndoStates(anyInSystem);\n      return currentUrl;\n    };\n\n    var cancel = function (anyInSystem) {\n      var currentUrl = destroyTempState(anyInSystem);\n      updateSrc(anyInSystem, currentUrl).then(function (_oImg) {\n        unblock(anyInSystem);\n      });\n    };\n\n    var back = function (anyInSystem, simulatedEvent) {\n      cancel(anyInSystem);\n      var swap = simulatedEvent.event.swap;\n      swap();\n      imagePanel.hideCrop();\n    };\n\n    var transform = function (anyInSystem, simulatedEvent) {\n      return manipulate(anyInSystem, simulatedEvent.event.transform, noop);\n    };\n\n    var tempTransform = function (anyInSystem, simulatedEvent) {\n      return tempManipulate(anyInSystem, simulatedEvent.event.transform);\n    };\n\n    var transformApply = function (anyInSystem, simulatedEvent) {\n      return manipulateApply(anyInSystem, simulatedEvent.event.transform, simulatedEvent.event.swap);\n    };\n\n    var imagePanel = renderImagePanel(detail.currentState.url);\n    var sideBar = renderSideBar(providersBackstage);\n    var editPanel = renderEditPanel(imagePanel, providersBackstage);\n\n    var swap = function (anyInSystem, simulatedEvent) {\n      disableUndoRedo(anyInSystem);\n      var transform = simulatedEvent.event.transform;\n      var swap = simulatedEvent.event.swap;\n      transform.fold(function () {\n        swap();\n      }, function (transform) {\n        manipulate(anyInSystem, transform, swap);\n      });\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        attributes: {\n          role: 'presentation'\n        }\n      },\n      components: [editPanel.memContainer.asSpec(), imagePanel.memContainer.asSpec(), sideBar.container],\n      behaviours: derive$1([Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function () {\n            return state.getBlobState();\n          }\n        }\n      }), config('image-tools-events', [run$1(internal.undo(), undo), run$1(internal.redo(), redo), run$1(internal.zoom(), zoom), run$1(internal.back(), back), run$1(internal.apply(), apply), run$1(internal.transform(), transform), run$1(internal.tempTransform(), tempTransform), run$1(internal.transformApply(), transformApply), run$1(internal.swap(), swap)]), ComposingConfigs.self()])\n    };\n  };\n\n  var renderLabel = function (spec, backstageShared) {\n    var label = {\n      dom: {\n        tag: 'label',\n        innerHtml: backstageShared.providers.translate(spec.label),\n        classes: ['tox-label']\n      }\n    };\n    var comps = map$2(spec.items, backstageShared.interpreter);\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: [label].concat(comps),\n      behaviours: derive$1([ComposingConfigs.self(), Replacing.config({}), RepresentingConfigs.domHtml(Optional.none()), Keying.config({\n        mode: 'acyclic'\n      })])\n    };\n  };\n\n  var isSingleListItem = function (item) {\n    return !has$2(item, 'items');\n  };\n\n  var dataAttribute = 'data-value';\n\n  var fetchItems = function (dropdownComp, name, items, selectedValue) {\n    return map$2(items, function (item) {\n      if (!isSingleListItem(item)) {\n        return {\n          type: 'nestedmenuitem',\n          text: item.text,\n          getSubmenuItems: function () {\n            return fetchItems(dropdownComp, name, item.items, selectedValue);\n          }\n        };\n      } else {\n        return {\n          type: 'togglemenuitem',\n          text: item.text,\n          value: item.value,\n          active: item.value === selectedValue,\n          onAction: function () {\n            Representing.setValue(dropdownComp, item.value);\n            emitWith(dropdownComp, formChangeEvent, {\n              name: name\n            });\n            Focusing.focus(dropdownComp);\n          }\n        };\n      }\n    });\n  };\n\n  var findItemByValue = function (items, value) {\n    return findMap(items, function (item) {\n      if (!isSingleListItem(item)) {\n        return findItemByValue(item.items, value);\n      } else {\n        return someIf(item.value === value, item);\n      }\n    });\n  };\n\n  var renderListBox = function (spec, backstage) {\n    var providersBackstage = backstage.shared.providers;\n    var initialItem = head(spec.items).filter(isSingleListItem);\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel$2(label, providersBackstage);\n    });\n    var pField = FormField.parts.field({\n      dom: {},\n      factory: {\n        sketch: function (sketchSpec) {\n          return renderCommonDropdown({\n            uid: sketchSpec.uid,\n            text: initialItem.map(function (item) {\n              return item.text;\n            }),\n            icon: Optional.none(),\n            tooltip: spec.label,\n            role: Optional.none(),\n            fetch: function (comp, callback) {\n              var items = fetchItems(comp, spec.name, spec.items, Representing.getValue(comp));\n              callback(build(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false));\n            },\n            onSetup: constant$1(noop),\n            getApi: constant$1({}),\n            columns: 1,\n            presets: 'normal',\n            classes: [],\n            dropdownBehaviours: [Tabstopping.config({}), Representing.config({\n              store: {\n                mode: 'manual',\n                initialValue: initialItem.map(function (item) {\n                  return item.value;\n                }).getOr(''),\n                getValue: function (comp) {\n                  return get$d(comp.element, dataAttribute);\n                },\n                setValue: function (comp, data) {\n                  findItemByValue(spec.items, data).each(function (item) {\n                    set$8(comp.element, dataAttribute, item.value);\n                    emitWith(comp, updateMenuText, {\n                      text: item.text\n                    });\n                  });\n                }\n              }\n            })]\n          }, 'tox-listbox', backstage.shared);\n        }\n      }\n    });\n    var listBoxWrap = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-listboxfield']\n      },\n      components: [pField]\n    };\n    return FormField.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: flatten([pLabel.toArray(), [listBoxWrap]]),\n      fieldBehaviours: derive$1([Disabling.config({\n        disabled: constant$1(spec.disabled),\n        onDisabled: function (comp) {\n          FormField.getField(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormField.getField(comp).each(Disabling.enable);\n        }\n      })])\n    });\n  };\n\n  var renderPanel = function (spec, backstage) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: spec.classes\n      },\n      components: map$2(spec.items, backstage.shared.interpreter)\n    };\n  };\n\n  var factory$e = function (detail, _spec) {\n    var options = map$2(detail.options, function (option) {\n      return {\n        dom: {\n          tag: 'option',\n          value: option.value,\n          innerHtml: option.text\n        }\n      };\n    });\n    var initialValues = detail.data.map(function (v) {\n      return wrap$1('initialValue', v);\n    }).getOr({});\n    return {\n      uid: detail.uid,\n      dom: {\n        tag: 'select',\n        classes: detail.selectClasses,\n        attributes: detail.selectAttributes\n      },\n      components: options,\n      behaviours: augment(detail.selectBehaviours, [Focusing.config({}), Representing.config({\n        store: __assign({\n          mode: 'manual',\n          getValue: function (select) {\n            return get$5(select.element);\n          },\n          setValue: function (select, newValue) {\n            var found = find$5(detail.options, function (opt) {\n              return opt.value === newValue;\n            });\n\n            if (found.isSome()) {\n              set$4(select.element, newValue);\n            }\n          }\n        }, initialValues)\n      })])\n    };\n  };\n\n  var HtmlSelect = single({\n    name: 'HtmlSelect',\n    configFields: [required$1('options'), field('selectBehaviours', [Focusing, Representing]), defaulted('selectClasses', []), defaulted('selectAttributes', {}), option('data')],\n    factory: factory$e\n  });\n\n  var renderSelectBox = function (spec, providersBackstage) {\n    var translatedOptions = map$2(spec.items, function (item) {\n      return {\n        text: providersBackstage.translate(item.text),\n        value: item.value\n      };\n    });\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel$2(label, providersBackstage);\n    });\n    var pField = FormField.parts.field({\n      dom: {},\n      selectAttributes: {\n        size: spec.size\n      },\n      options: translatedOptions,\n      factory: HtmlSelect,\n      selectBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        }\n      }), Tabstopping.config({}), config('selectbox-change', [run$1(change(), function (component, _) {\n        emitWith(component, formChangeEvent, {\n          name: spec.name\n        });\n      })])])\n    });\n    var chevron = spec.size > 1 ? Optional.none() : Optional.some(render$3('chevron-down', {\n      tag: 'div',\n      classes: ['tox-selectfield__icon-js']\n    }, providersBackstage.icons));\n    var selectWrap = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-selectfield']\n      },\n      components: flatten([[pField], chevron.toArray()])\n    };\n    return FormField.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: flatten([pLabel.toArray(), [selectWrap]]),\n      fieldBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        },\n        onDisabled: function (comp) {\n          FormField.getField(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormField.getField(comp).each(Disabling.enable);\n        }\n      }), receivingConfig()])\n    });\n  };\n\n  var renderTable = function (spec, providersBackstage) {\n    var renderTh = function (text) {\n      return {\n        dom: {\n          tag: 'th',\n          innerHtml: providersBackstage.translate(text)\n        }\n      };\n    };\n\n    var renderHeader = function (header) {\n      return {\n        dom: {\n          tag: 'thead'\n        },\n        components: [{\n          dom: {\n            tag: 'tr'\n          },\n          components: map$2(header, renderTh)\n        }]\n      };\n    };\n\n    var renderTd = function (text) {\n      return {\n        dom: {\n          tag: 'td',\n          innerHtml: providersBackstage.translate(text)\n        }\n      };\n    };\n\n    var renderTr = function (row) {\n      return {\n        dom: {\n          tag: 'tr'\n        },\n        components: map$2(row, renderTd)\n      };\n    };\n\n    var renderRows = function (rows) {\n      return {\n        dom: {\n          tag: 'tbody'\n        },\n        components: map$2(rows, renderTr)\n      };\n    };\n\n    return {\n      dom: {\n        tag: 'table',\n        classes: ['tox-dialog__table']\n      },\n      components: [renderHeader(spec.header), renderRows(spec.cells)],\n      behaviours: derive$1([Tabstopping.config({}), Focusing.config({})])\n    };\n  };\n\n  var renderTextField = function (spec, providersBackstage) {\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel$2(label, providersBackstage);\n    });\n    var baseInputBehaviours = [Disabling.config({\n      disabled: function () {\n        return spec.disabled || providersBackstage.isDisabled();\n      }\n    }), receivingConfig(), Keying.config({\n      mode: 'execution',\n      useEnter: spec.multiline !== true,\n      useControlEnter: spec.multiline === true,\n      execute: function (comp) {\n        emit(comp, formSubmitEvent);\n        return Optional.some(true);\n      }\n    }), config('textfield-change', [run$1(input(), function (component, _) {\n      emitWith(component, formChangeEvent, {\n        name: spec.name\n      });\n    }), run$1(postPaste(), function (component, _) {\n      emitWith(component, formChangeEvent, {\n        name: spec.name\n      });\n    })]), Tabstopping.config({})];\n    var validatingBehaviours = spec.validation.map(function (vl) {\n      return Invalidating.config({\n        getRoot: function (input) {\n          return parent(input.element);\n        },\n        invalidClass: 'tox-invalid',\n        validator: {\n          validate: function (input) {\n            var v = Representing.getValue(input);\n            var result = vl.validator(v);\n            return Future.pure(result === true ? Result.value(v) : Result.error(result));\n          },\n          validateOnLoad: vl.validateOnLoad\n        }\n      });\n    }).toArray();\n    var placeholder = spec.placeholder.fold(constant$1({}), function (p) {\n      return {\n        placeholder: providersBackstage.translate(p)\n      };\n    });\n    var inputMode = spec.inputMode.fold(constant$1({}), function (mode) {\n      return {\n        inputmode: mode\n      };\n    });\n\n    var inputAttributes = __assign(__assign({}, placeholder), inputMode);\n\n    var pField = FormField.parts.field({\n      tag: spec.multiline === true ? 'textarea' : 'input',\n      inputAttributes: inputAttributes,\n      inputClasses: [spec.classname],\n      inputBehaviours: derive$1(flatten([baseInputBehaviours, validatingBehaviours])),\n      selectOnFocus: false,\n      factory: Input\n    });\n    var extraClasses = spec.flex ? ['tox-form__group--stretched'] : [];\n    var extraClasses2 = extraClasses.concat(spec.maximized ? ['tox-form-group--maximize'] : []);\n    var extraBehaviours = [Disabling.config({\n      disabled: function () {\n        return spec.disabled || providersBackstage.isDisabled();\n      },\n      onDisabled: function (comp) {\n        FormField.getField(comp).each(Disabling.disable);\n      },\n      onEnabled: function (comp) {\n        FormField.getField(comp).each(Disabling.enable);\n      }\n    }), receivingConfig()];\n    return renderFormFieldWith(pLabel, pField, extraClasses2, extraBehaviours);\n  };\n\n  var renderInput = function (spec, providersBackstage) {\n    return renderTextField({\n      name: spec.name,\n      multiline: false,\n      label: spec.label,\n      inputMode: spec.inputMode,\n      placeholder: spec.placeholder,\n      flex: false,\n      disabled: spec.disabled,\n      classname: 'tox-textfield',\n      validation: Optional.none(),\n      maximized: spec.maximized\n    }, providersBackstage);\n  };\n\n  var renderTextarea = function (spec, providersBackstage) {\n    return renderTextField({\n      name: spec.name,\n      multiline: true,\n      label: spec.label,\n      inputMode: Optional.none(),\n      placeholder: spec.placeholder,\n      flex: true,\n      disabled: spec.disabled,\n      classname: 'tox-textarea',\n      validation: Optional.none(),\n      maximized: spec.maximized\n    }, providersBackstage);\n  };\n\n  var events$6 = function (streamConfig, streamState) {\n    var streams = streamConfig.stream.streams;\n    var processor = streams.setup(streamConfig, streamState);\n    return derive$2([run$1(streamConfig.event, processor), runOnDetached(function () {\n      return streamState.cancel();\n    })].concat(streamConfig.cancelEvent.map(function (e) {\n      return [run$1(e, function () {\n        return streamState.cancel();\n      })];\n    }).getOr([])));\n  };\n\n  var ActiveStreaming = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$6\n  });\n\n  var throttle = function (_config) {\n    var state = Cell(null);\n\n    var readState = function () {\n      return {\n        timer: state.get() !== null ? 'set' : 'unset'\n      };\n    };\n\n    var setTimer = function (t) {\n      state.set(t);\n    };\n\n    var cancel = function () {\n      var t = state.get();\n\n      if (t !== null) {\n        t.cancel();\n      }\n    };\n\n    return nu$8({\n      readState: readState,\n      setTimer: setTimer,\n      cancel: cancel\n    });\n  };\n\n  var init$9 = function (spec) {\n    return spec.stream.streams.state(spec);\n  };\n\n  var StreamingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    throttle: throttle,\n    init: init$9\n  });\n\n  var setup$c = function (streamInfo, streamState) {\n    var sInfo = streamInfo.stream;\n    var throttler = last(streamInfo.onStream, sInfo.delay);\n    streamState.setTimer(throttler);\n    return function (component, simulatedEvent) {\n      throttler.throttle(component, simulatedEvent);\n\n      if (sInfo.stopEvent) {\n        simulatedEvent.stop();\n      }\n    };\n  };\n\n  var StreamingSchema = [requiredOf('stream', choose$1('mode', {\n    throttle: [required$1('delay'), defaulted('stopEvent', true), output$1('streams', {\n      setup: setup$c,\n      state: throttle\n    })]\n  })), defaulted('event', 'input'), option('cancelEvent'), onStrictHandler('onStream')];\n  var Streaming = create$7({\n    fields: StreamingSchema,\n    name: 'streaming',\n    active: ActiveStreaming,\n    state: StreamingState\n  });\n\n  var setValueFromItem = function (model, input, item) {\n    var itemData = Representing.getValue(item);\n    Representing.setValue(input, itemData);\n    setCursorAtEnd(input);\n  };\n\n  var setSelectionOn = function (input, f) {\n    var el = input.element;\n    var value = get$5(el);\n    var node = el.dom;\n\n    if (get$d(el, 'type') !== 'number') {\n      f(node, value);\n    }\n  };\n\n  var setCursorAtEnd = function (input) {\n    setSelectionOn(input, function (node, value) {\n      return node.setSelectionRange(value.length, value.length);\n    });\n  };\n\n  var setSelectionToEnd = function (input, startOffset) {\n    setSelectionOn(input, function (node, value) {\n      return node.setSelectionRange(startOffset, value.length);\n    });\n  };\n\n  var attemptSelectOver = function (model, input, item) {\n    if (!model.selectsOver) {\n      return Optional.none();\n    } else {\n      var currentValue = Representing.getValue(input);\n      var inputDisplay_1 = model.getDisplayText(currentValue);\n      var itemValue = Representing.getValue(item);\n      var itemDisplay = model.getDisplayText(itemValue);\n      return itemDisplay.indexOf(inputDisplay_1) === 0 ? Optional.some(function () {\n        setValueFromItem(model, input, item);\n        setSelectionToEnd(input, inputDisplay_1.length);\n      }) : Optional.none();\n    }\n  };\n\n  var itemExecute = constant$1('alloy.typeahead.itemexecute');\n\n  var make$3 = function (detail, components, spec, externals) {\n    var navigateList = function (comp, simulatedEvent, highlighter) {\n      detail.previewing.set(false);\n      var sandbox = Coupling.getCoupled(comp, 'sandbox');\n\n      if (Sandboxing.isOpen(sandbox)) {\n        Composing.getCurrent(sandbox).each(function (menu) {\n          Highlighting.getHighlighted(menu).fold(function () {\n            highlighter(menu);\n          }, function () {\n            dispatchEvent(sandbox, menu.element, 'keydown', simulatedEvent);\n          });\n        });\n      } else {\n        var onOpenSync = function (sandbox) {\n          Composing.getCurrent(sandbox).each(highlighter);\n        };\n\n        open(detail, mapFetch(comp), comp, sandbox, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n      }\n    };\n\n    var focusBehaviours$1 = focusBehaviours(detail);\n\n    var mapFetch = function (comp) {\n      return function (tdata) {\n        return tdata.map(function (data) {\n          var menus = values(data.menus);\n          var items = bind$3(menus, function (menu) {\n            return filter$2(menu.items, function (item) {\n              return item.type === 'item';\n            });\n          });\n          var repState = Representing.getState(comp);\n          repState.update(map$2(items, function (item) {\n            return item.data;\n          }));\n          return data;\n        });\n      };\n    };\n\n    var behaviours = [Focusing.config({}), Representing.config({\n      onSetValue: detail.onSetValue,\n      store: __assign({\n        mode: 'dataset',\n        getDataKey: function (comp) {\n          return get$5(comp.element);\n        },\n        getFallbackEntry: function (itemString) {\n          return {\n            value: itemString,\n            meta: {}\n          };\n        },\n        setValue: function (comp, data) {\n          set$4(comp.element, detail.model.getDisplayText(data));\n        }\n      }, detail.initialData.map(function (d) {\n        return wrap$1('initialValue', d);\n      }).getOr({}))\n    }), Streaming.config({\n      stream: {\n        mode: 'throttle',\n        delay: detail.responseTime,\n        stopEvent: false\n      },\n      onStream: function (component, _simulatedEvent) {\n        var sandbox = Coupling.getCoupled(component, 'sandbox');\n        var focusInInput = Focusing.isFocused(component);\n\n        if (focusInInput) {\n          if (get$5(component.element).length >= detail.minChars) {\n            var previousValue_1 = Composing.getCurrent(sandbox).bind(function (menu) {\n              return Highlighting.getHighlighted(menu).map(Representing.getValue);\n            });\n            detail.previewing.set(true);\n\n            var onOpenSync = function (_sandbox) {\n              Composing.getCurrent(sandbox).each(function (menu) {\n                previousValue_1.fold(function () {\n                  if (detail.model.selectsOver) {\n                    Highlighting.highlightFirst(menu);\n                  }\n                }, function (pv) {\n                  Highlighting.highlightBy(menu, function (item) {\n                    var itemData = Representing.getValue(item);\n                    return itemData.value === pv.value;\n                  });\n                  Highlighting.getHighlighted(menu).orThunk(function () {\n                    Highlighting.highlightFirst(menu);\n                    return Optional.none();\n                  });\n                });\n              });\n            };\n\n            open(detail, mapFetch(component), component, sandbox, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n          }\n        }\n      },\n      cancelEvent: typeaheadCancel()\n    }), Keying.config({\n      mode: 'special',\n      onDown: function (comp, simulatedEvent) {\n        navigateList(comp, simulatedEvent, Highlighting.highlightFirst);\n        return Optional.some(true);\n      },\n      onEscape: function (comp) {\n        var sandbox = Coupling.getCoupled(comp, 'sandbox');\n\n        if (Sandboxing.isOpen(sandbox)) {\n          Sandboxing.close(sandbox);\n          return Optional.some(true);\n        }\n\n        return Optional.none();\n      },\n      onUp: function (comp, simulatedEvent) {\n        navigateList(comp, simulatedEvent, Highlighting.highlightLast);\n        return Optional.some(true);\n      },\n      onEnter: function (comp) {\n        var sandbox = Coupling.getCoupled(comp, 'sandbox');\n        var sandboxIsOpen = Sandboxing.isOpen(sandbox);\n\n        if (sandboxIsOpen && !detail.previewing.get()) {\n          return Composing.getCurrent(sandbox).bind(function (menu) {\n            return Highlighting.getHighlighted(menu);\n          }).map(function (item) {\n            emitWith(comp, itemExecute(), {\n              item: item\n            });\n            return true;\n          });\n        } else {\n          var currentValue = Representing.getValue(comp);\n          emit(comp, typeaheadCancel());\n          detail.onExecute(sandbox, comp, currentValue);\n\n          if (sandboxIsOpen) {\n            Sandboxing.close(sandbox);\n          }\n\n          return Optional.some(true);\n        }\n      }\n    }), Toggling.config({\n      toggleClass: detail.markers.openClass,\n      aria: {\n        mode: 'expanded'\n      }\n    }), Coupling.config({\n      others: {\n        sandbox: function (hotspot) {\n          return makeSandbox$1(detail, hotspot, {\n            onOpen: function () {\n              return Toggling.on(hotspot);\n            },\n            onClose: function () {\n              return Toggling.off(hotspot);\n            }\n          });\n        }\n      }\n    }), config('typeaheadevents', [runOnExecute$1(function (comp) {\n      var onOpenSync = noop;\n      togglePopup(detail, mapFetch(comp), comp, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n    }), run$1(itemExecute(), function (comp, se) {\n      var sandbox = Coupling.getCoupled(comp, 'sandbox');\n      setValueFromItem(detail.model, comp, se.event.item);\n      emit(comp, typeaheadCancel());\n      detail.onItemExecute(comp, sandbox, se.event.item, Representing.getValue(comp));\n      Sandboxing.close(sandbox);\n      setCursorAtEnd(comp);\n    })].concat(detail.dismissOnBlur ? [run$1(postBlur(), function (typeahead) {\n      var sandbox = Coupling.getCoupled(typeahead, 'sandbox');\n\n      if (search(sandbox.element).isNone()) {\n        Sandboxing.close(sandbox);\n      }\n    })] : []))];\n    return {\n      uid: detail.uid,\n      dom: dom(deepMerge(detail, {\n        inputAttributes: {\n          'role': 'combobox',\n          'aria-autocomplete': 'list',\n          'aria-haspopup': 'true'\n        }\n      })),\n      behaviours: __assign(__assign({}, focusBehaviours$1), augment(detail.typeaheadBehaviours, behaviours)),\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var schema$g = constant$1([option('lazySink'), required$1('fetch'), defaulted('minChars', 5), defaulted('responseTime', 1000), onHandler('onOpen'), defaulted('getHotspot', Optional.some), defaulted('getAnchorOverrides', constant$1({})), defaulted('layouts', Optional.none()), defaulted('eventOrder', {}), defaultedObjOf('model', {}, [defaulted('getDisplayText', function (itemData) {\n    return itemData.meta !== undefined && itemData.meta.text !== undefined ? itemData.meta.text : itemData.value;\n  }), defaulted('selectsOver', true), defaulted('populateFromBrowse', true)]), onHandler('onSetValue'), onKeyboardHandler('onExecute'), onHandler('onItemExecute'), defaulted('inputClasses', []), defaulted('inputAttributes', {}), defaulted('inputStyles', {}), defaulted('matchWidth', true), defaulted('useMinWidth', false), defaulted('dismissOnBlur', true), markers$1(['openClass']), option('initialData'), field('typeaheadBehaviours', [Focusing, Representing, Streaming, Keying, Toggling, Coupling]), customField('previewing', function () {\n    return Cell(true);\n  })].concat(schema$k()).concat(sandboxFields()));\n  var parts$b = constant$1([external$1({\n    schema: [tieredMenuMarkers()],\n    name: 'menu',\n    overrides: function (detail) {\n      return {\n        fakeFocus: true,\n        onHighlight: function (menu, item) {\n          if (!detail.previewing.get()) {\n            menu.getSystem().getByUid(detail.uid).each(function (input) {\n              if (detail.model.populateFromBrowse) {\n                setValueFromItem(detail.model, input, item);\n              }\n            });\n          } else {\n            menu.getSystem().getByUid(detail.uid).each(function (input) {\n              attemptSelectOver(detail.model, input, item).fold(function () {\n                return Highlighting.dehighlight(menu, item);\n              }, function (fn) {\n                return fn();\n              });\n            });\n          }\n\n          detail.previewing.set(false);\n        },\n        onExecute: function (menu, item) {\n          return menu.getSystem().getByUid(detail.uid).toOptional().map(function (typeahead) {\n            emitWith(typeahead, itemExecute(), {\n              item: item\n            });\n            return true;\n          });\n        },\n        onHover: function (menu, item) {\n          detail.previewing.set(false);\n          menu.getSystem().getByUid(detail.uid).each(function (input) {\n            if (detail.model.populateFromBrowse) {\n              setValueFromItem(detail.model, input, item);\n            }\n          });\n        }\n      };\n    }\n  })]);\n  var Typeahead = composite({\n    name: 'Typeahead',\n    configFields: schema$g(),\n    partFields: parts$b(),\n    factory: make$3\n  });\n\n  var wrap = function (delegate) {\n    var toCached = function () {\n      return wrap(delegate.toCached());\n    };\n\n    var bindFuture = function (f) {\n      return wrap(delegate.bind(function (resA) {\n        return resA.fold(function (err) {\n          return Future.pure(Result.error(err));\n        }, function (a) {\n          return f(a);\n        });\n      }));\n    };\n\n    var bindResult = function (f) {\n      return wrap(delegate.map(function (resA) {\n        return resA.bind(f);\n      }));\n    };\n\n    var mapResult = function (f) {\n      return wrap(delegate.map(function (resA) {\n        return resA.map(f);\n      }));\n    };\n\n    var mapError = function (f) {\n      return wrap(delegate.map(function (resA) {\n        return resA.mapError(f);\n      }));\n    };\n\n    var foldResult = function (whenError, whenValue) {\n      return delegate.map(function (res) {\n        return res.fold(whenError, whenValue);\n      });\n    };\n\n    var withTimeout = function (timeout, errorThunk) {\n      return wrap(Future.nu(function (callback) {\n        var timedOut = false;\n        var timer = setTimeout(function () {\n          timedOut = true;\n          callback(Result.error(errorThunk()));\n        }, timeout);\n        delegate.get(function (result) {\n          if (!timedOut) {\n            clearTimeout(timer);\n            callback(result);\n          }\n        });\n      }));\n    };\n\n    return __assign(__assign({}, delegate), {\n      toCached: toCached,\n      bindFuture: bindFuture,\n      bindResult: bindResult,\n      mapResult: mapResult,\n      mapError: mapError,\n      foldResult: foldResult,\n      withTimeout: withTimeout\n    });\n  };\n\n  var nu$1 = function (worker) {\n    return wrap(Future.nu(worker));\n  };\n\n  var value = function (value) {\n    return wrap(Future.pure(Result.value(value)));\n  };\n\n  var error = function (error) {\n    return wrap(Future.pure(Result.error(error)));\n  };\n\n  var fromResult = function (result) {\n    return wrap(Future.pure(result));\n  };\n\n  var fromFuture = function (future) {\n    return wrap(future.map(Result.value));\n  };\n\n  var fromPromise = function (promise) {\n    return nu$1(function (completer) {\n      promise.then(function (value) {\n        completer(Result.value(value));\n      }, function (error) {\n        completer(Result.error(error));\n      });\n    });\n  };\n\n  var FutureResult = {\n    nu: nu$1,\n    wrap: wrap,\n    pure: value,\n    value: value,\n    error: error,\n    fromResult: fromResult,\n    fromFuture: fromFuture,\n    fromPromise: fromPromise\n  };\n  var separator$1 = {\n    type: 'separator'\n  };\n\n  var toMenuItem = function (target) {\n    return {\n      type: 'menuitem',\n      value: target.url,\n      text: target.title,\n      meta: {\n        attach: target.attach\n      },\n      onAction: noop\n    };\n  };\n\n  var staticMenuItem = function (title, url) {\n    return {\n      type: 'menuitem',\n      value: url,\n      text: title,\n      meta: {\n        attach: undefined\n      },\n      onAction: noop\n    };\n  };\n\n  var toMenuItems = function (targets) {\n    return map$2(targets, toMenuItem);\n  };\n\n  var filterLinkTargets = function (type, targets) {\n    return filter$2(targets, function (target) {\n      return target.type === type;\n    });\n  };\n\n  var filteredTargets = function (type, targets) {\n    return toMenuItems(filterLinkTargets(type, targets));\n  };\n\n  var headerTargets = function (linkInfo) {\n    return filteredTargets('header', linkInfo.targets);\n  };\n\n  var anchorTargets = function (linkInfo) {\n    return filteredTargets('anchor', linkInfo.targets);\n  };\n\n  var anchorTargetTop = function (linkInfo) {\n    return Optional.from(linkInfo.anchorTop).map(function (url) {\n      return staticMenuItem('<top>', url);\n    }).toArray();\n  };\n\n  var anchorTargetBottom = function (linkInfo) {\n    return Optional.from(linkInfo.anchorBottom).map(function (url) {\n      return staticMenuItem('<bottom>', url);\n    }).toArray();\n  };\n\n  var historyTargets = function (history) {\n    return map$2(history, function (url) {\n      return staticMenuItem(url, url);\n    });\n  };\n\n  var joinMenuLists = function (items) {\n    return foldl(items, function (a, b) {\n      var bothEmpty = a.length === 0 || b.length === 0;\n      return bothEmpty ? a.concat(b) : a.concat(separator$1, b);\n    }, []);\n  };\n\n  var filterByQuery = function (term, menuItems) {\n    var lowerCaseTerm = term.toLowerCase();\n    return filter$2(menuItems, function (item) {\n      var text = item.meta !== undefined && item.meta.text !== undefined ? item.meta.text : item.text;\n      return contains$1(text.toLowerCase(), lowerCaseTerm) || contains$1(item.value.toLowerCase(), lowerCaseTerm);\n    });\n  };\n\n  var getItems = function (fileType, input, urlBackstage) {\n    var urlInputValue = Representing.getValue(input);\n    var term = urlInputValue.meta.text !== undefined ? urlInputValue.meta.text : urlInputValue.value;\n    var info = urlBackstage.getLinkInformation();\n    return info.fold(function () {\n      return [];\n    }, function (linkInfo) {\n      var history = filterByQuery(term, historyTargets(urlBackstage.getHistory(fileType)));\n      return fileType === 'file' ? joinMenuLists([history, filterByQuery(term, headerTargets(linkInfo)), filterByQuery(term, flatten([anchorTargetTop(linkInfo), anchorTargets(linkInfo), anchorTargetBottom(linkInfo)]))]) : history;\n    });\n  };\n\n  var errorId = generate$6('aria-invalid');\n\n  var renderUrlInput = function (spec, backstage, urlBackstage) {\n    var _a;\n\n    var providersBackstage = backstage.shared.providers;\n\n    var updateHistory = function (component) {\n      var urlEntry = Representing.getValue(component);\n      urlBackstage.addToHistory(urlEntry.value, spec.filetype);\n    };\n\n    var pField = FormField.parts.field({\n      factory: Typeahead,\n      dismissOnBlur: true,\n      inputClasses: ['tox-textfield'],\n      sandboxClasses: ['tox-dialog__popups'],\n      inputAttributes: {\n        'aria-errormessage': errorId,\n        'type': 'url'\n      },\n      minChars: 0,\n      responseTime: 0,\n      fetch: function (input) {\n        var items = getItems(spec.filetype, input, urlBackstage);\n        var tdata = build(items, ItemResponse$1.BUBBLE_TO_SANDBOX, backstage, false);\n        return Future.pure(tdata);\n      },\n      getHotspot: function (comp) {\n        return memUrlBox.getOpt(comp);\n      },\n      onSetValue: function (comp, _newValue) {\n        if (comp.hasConfigured(Invalidating)) {\n          Invalidating.run(comp).get(noop);\n        }\n      },\n      typeaheadBehaviours: derive$1(flatten([urlBackstage.getValidationHandler().map(function (handler) {\n        return Invalidating.config({\n          getRoot: function (comp) {\n            return parent(comp.element);\n          },\n          invalidClass: 'tox-control-wrap--status-invalid',\n          notify: {\n            onInvalid: function (comp, err) {\n              memInvalidIcon.getOpt(comp).each(function (invalidComp) {\n                set$8(invalidComp.element, 'title', providersBackstage.translate(err));\n              });\n            }\n          },\n          validator: {\n            validate: function (input) {\n              var urlEntry = Representing.getValue(input);\n              return FutureResult.nu(function (completer) {\n                handler({\n                  type: spec.filetype,\n                  url: urlEntry.value\n                }, function (validation) {\n                  if (validation.status === 'invalid') {\n                    var err = Result.error(validation.message);\n                    completer(err);\n                  } else {\n                    var val = Result.value(validation.message);\n                    completer(val);\n                  }\n                });\n              });\n            },\n            validateOnLoad: false\n          }\n        });\n      }).toArray(), [Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        }\n      }), Tabstopping.config({}), config('urlinput-events', flatten([spec.filetype === 'file' ? [run$1(input(), function (comp) {\n        emitWith(comp, formChangeEvent, {\n          name: spec.name\n        });\n      })] : [], [run$1(change(), function (comp) {\n        emitWith(comp, formChangeEvent, {\n          name: spec.name\n        });\n        updateHistory(comp);\n      }), run$1(postPaste(), function (comp) {\n        emitWith(comp, formChangeEvent, {\n          name: spec.name\n        });\n        updateHistory(comp);\n      })]]))]])),\n      eventOrder: (_a = {}, _a[input()] = ['streaming', 'urlinput-events', 'invalidating'], _a),\n      model: {\n        getDisplayText: function (itemData) {\n          return itemData.value;\n        },\n        selectsOver: false,\n        populateFromBrowse: false\n      },\n      markers: {\n        openClass: 'tox-textfield--popup-open'\n      },\n      lazySink: backstage.shared.getSink,\n      parts: {\n        menu: part(false, 1, 'normal')\n      },\n      onExecute: function (_menu, component, _entry) {\n        emitWith(component, formSubmitEvent, {});\n      },\n      onItemExecute: function (typeahead, _sandbox, _item, _value) {\n        updateHistory(typeahead);\n        emitWith(typeahead, formChangeEvent, {\n          name: spec.name\n        });\n      }\n    });\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel$2(label, providersBackstage);\n    });\n\n    var makeIcon = function (name, errId, icon, label) {\n      if (icon === void 0) {\n        icon = name;\n      }\n\n      if (label === void 0) {\n        label = name;\n      }\n\n      return render$3(icon, {\n        tag: 'div',\n        classes: ['tox-icon', 'tox-control-wrap__status-icon-' + name],\n        attributes: __assign({\n          'title': providersBackstage.translate(label),\n          'aria-live': 'polite'\n        }, errId.fold(function () {\n          return {};\n        }, function (id) {\n          return {\n            id: id\n          };\n        }))\n      }, providersBackstage.icons);\n    };\n\n    var memInvalidIcon = record(makeIcon('invalid', Optional.some(errorId), 'warning'));\n    var memStatus = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-control-wrap__status-icon-wrap']\n      },\n      components: [memInvalidIcon.asSpec()]\n    });\n    var optUrlPicker = urlBackstage.getUrlPicker(spec.filetype);\n    var browseUrlEvent = generate$6('browser.url.event');\n    var memUrlBox = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-control-wrap']\n      },\n      components: [pField, memStatus.asSpec()],\n      behaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        }\n      })])\n    });\n    var memUrlPickerButton = record(renderButton({\n      name: spec.name,\n      icon: Optional.some('browse'),\n      text: spec.label.getOr(''),\n      disabled: spec.disabled,\n      primary: false,\n      borderless: true\n    }, function (component) {\n      return emit(component, browseUrlEvent);\n    }, providersBackstage, [], ['tox-browse-url']));\n\n    var controlHWrapper = function () {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__controls-h-stack']\n        },\n        components: flatten([[memUrlBox.asSpec()], optUrlPicker.map(function () {\n          return memUrlPickerButton.asSpec();\n        }).toArray()])\n      };\n    };\n\n    var openUrlPicker = function (comp) {\n      Composing.getCurrent(comp).each(function (field) {\n        var componentData = Representing.getValue(field);\n\n        var urlData = __assign({\n          fieldname: spec.name\n        }, componentData);\n\n        optUrlPicker.each(function (picker) {\n          picker(urlData).get(function (chosenData) {\n            Representing.setValue(field, chosenData);\n            emitWith(comp, formChangeEvent, {\n              name: spec.name\n            });\n          });\n        });\n      });\n    };\n\n    return FormField.sketch({\n      dom: renderFormFieldDom(),\n      components: pLabel.toArray().concat([controlHWrapper()]),\n      fieldBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        },\n        onDisabled: function (comp) {\n          FormField.getField(comp).each(Disabling.disable);\n          memUrlPickerButton.getOpt(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormField.getField(comp).each(Disabling.enable);\n          memUrlPickerButton.getOpt(comp).each(Disabling.enable);\n        }\n      }), receivingConfig(), config('url-input-events', [run$1(browseUrlEvent, openUrlPicker)])])\n    });\n  };\n\n  var renderAlertBanner = function (spec, providersBackstage) {\n    return Container.sketch({\n      dom: {\n        tag: 'div',\n        attributes: {\n          role: 'alert'\n        },\n        classes: ['tox-notification', 'tox-notification--in', 'tox-notification--' + spec.level]\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-notification__icon']\n        },\n        components: [Button.sketch({\n          dom: {\n            tag: 'button',\n            classes: ['tox-button', 'tox-button--naked', 'tox-button--icon'],\n            innerHtml: get$1(spec.icon, providersBackstage.icons),\n            attributes: {\n              title: providersBackstage.translate(spec.iconTooltip)\n            }\n          },\n          action: function (comp) {\n            emitWith(comp, formActionEvent, {\n              name: 'alert-banner',\n              value: spec.url\n            });\n          },\n          buttonBehaviours: derive$1([addFocusableBehaviour()])\n        })]\n      }, {\n        dom: {\n          tag: 'div',\n          classes: ['tox-notification__body'],\n          innerHtml: providersBackstage.translate(spec.text)\n        }\n      }]\n    });\n  };\n\n  var renderCheckbox = function (spec, providerBackstage) {\n    var repBehaviour = Representing.config({\n      store: {\n        mode: 'manual',\n        getValue: function (comp) {\n          var el = comp.element.dom;\n          return el.checked;\n        },\n        setValue: function (comp, value) {\n          var el = comp.element.dom;\n          el.checked = value;\n        }\n      }\n    });\n\n    var toggleCheckboxHandler = function (comp) {\n      comp.element.dom.click();\n      return Optional.some(true);\n    };\n\n    var pField = FormField.parts.field({\n      factory: {\n        sketch: identity$1\n      },\n      dom: {\n        tag: 'input',\n        classes: ['tox-checkbox__input'],\n        attributes: {\n          type: 'checkbox'\n        }\n      },\n      behaviours: derive$1([ComposingConfigs.self(), Disabling.config({\n        disabled: function () {\n          return spec.disabled || providerBackstage.isDisabled();\n        }\n      }), Tabstopping.config({}), Focusing.config({}), repBehaviour, Keying.config({\n        mode: 'special',\n        onEnter: toggleCheckboxHandler,\n        onSpace: toggleCheckboxHandler,\n        stopSpaceKeyup: true\n      }), config('checkbox-events', [run$1(change(), function (component, _) {\n        emitWith(component, formChangeEvent, {\n          name: spec.name\n        });\n      })])])\n    });\n    var pLabel = FormField.parts.label({\n      dom: {\n        tag: 'span',\n        classes: ['tox-checkbox__label'],\n        innerHtml: providerBackstage.translate(spec.label)\n      },\n      behaviours: derive$1([Unselecting.config({})])\n    });\n\n    var makeIcon = function (className) {\n      var iconName = className === 'checked' ? 'selected' : 'unselected';\n      return render$3(iconName, {\n        tag: 'span',\n        classes: ['tox-icon', 'tox-checkbox-icon__' + className]\n      }, providerBackstage.icons);\n    };\n\n    var memIcons = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-checkbox__icons']\n      },\n      components: [makeIcon('checked'), makeIcon('unchecked')]\n    });\n    return FormField.sketch({\n      dom: {\n        tag: 'label',\n        classes: ['tox-checkbox']\n      },\n      components: [pField, memIcons.asSpec(), pLabel],\n      fieldBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providerBackstage.isDisabled();\n        },\n        disableClass: 'tox-checkbox--disabled',\n        onDisabled: function (comp) {\n          FormField.getField(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormField.getField(comp).each(Disabling.enable);\n        }\n      }), receivingConfig()])\n    });\n  };\n\n  var renderHtmlPanel = function (spec) {\n    if (spec.presets === 'presentation') {\n      return Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group'],\n          innerHtml: spec.html\n        }\n      });\n    } else {\n      return Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group'],\n          innerHtml: spec.html,\n          attributes: {\n            role: 'document'\n          }\n        },\n        containerBehaviours: derive$1([Tabstopping.config({}), Focusing.config({})])\n      });\n    }\n  };\n\n  var make$2 = function (render) {\n    return function (parts, spec, backstage) {\n      return get$e(spec, 'name').fold(function () {\n        return render(spec, backstage);\n      }, function (fieldName) {\n        return parts.field(fieldName, render(spec, backstage));\n      });\n    };\n  };\n\n  var makeIframe = function (render) {\n    return function (parts, spec, backstage) {\n      var iframeSpec = deepMerge(spec, {\n        source: 'dynamic'\n      });\n      return make$2(render)(parts, iframeSpec, backstage);\n    };\n  };\n\n  var factories = {\n    bar: make$2(function (spec, backstage) {\n      return renderBar(spec, backstage.shared);\n    }),\n    collection: make$2(function (spec, backstage) {\n      return renderCollection(spec, backstage.shared.providers);\n    }),\n    alertbanner: make$2(function (spec, backstage) {\n      return renderAlertBanner(spec, backstage.shared.providers);\n    }),\n    input: make$2(function (spec, backstage) {\n      return renderInput(spec, backstage.shared.providers);\n    }),\n    textarea: make$2(function (spec, backstage) {\n      return renderTextarea(spec, backstage.shared.providers);\n    }),\n    label: make$2(function (spec, backstage) {\n      return renderLabel(spec, backstage.shared);\n    }),\n    iframe: makeIframe(function (spec, backstage) {\n      return renderIFrame(spec, backstage.shared.providers);\n    }),\n    button: make$2(function (spec, backstage) {\n      return renderDialogButton(spec, backstage.shared.providers);\n    }),\n    checkbox: make$2(function (spec, backstage) {\n      return renderCheckbox(spec, backstage.shared.providers);\n    }),\n    colorinput: make$2(function (spec, backstage) {\n      return renderColorInput(spec, backstage.shared, backstage.colorinput);\n    }),\n    colorpicker: make$2(renderColorPicker),\n    dropzone: make$2(function (spec, backstage) {\n      return renderDropZone(spec, backstage.shared.providers);\n    }),\n    grid: make$2(function (spec, backstage) {\n      return renderGrid(spec, backstage.shared);\n    }),\n    listbox: make$2(function (spec, backstage) {\n      return renderListBox(spec, backstage);\n    }),\n    selectbox: make$2(function (spec, backstage) {\n      return renderSelectBox(spec, backstage.shared.providers);\n    }),\n    sizeinput: make$2(function (spec, backstage) {\n      return renderSizeInput(spec, backstage.shared.providers);\n    }),\n    urlinput: make$2(function (spec, backstage) {\n      return renderUrlInput(spec, backstage, backstage.urlinput);\n    }),\n    customeditor: make$2(renderCustomEditor),\n    htmlpanel: make$2(renderHtmlPanel),\n    imagetools: make$2(function (spec, backstage) {\n      return renderImageTools(spec, backstage.shared.providers);\n    }),\n    table: make$2(function (spec, backstage) {\n      return renderTable(spec, backstage.shared.providers);\n    }),\n    panel: make$2(function (spec, backstage) {\n      return renderPanel(spec, backstage);\n    })\n  };\n  var noFormParts = {\n    field: function (_name, spec) {\n      return spec;\n    }\n  };\n\n  var interpretInForm = function (parts, spec, oldBackstage) {\n    var newBackstage = deepMerge(oldBackstage, {\n      shared: {\n        interpreter: function (childSpec) {\n          return interpretParts(parts, childSpec, newBackstage);\n        }\n      }\n    });\n    return interpretParts(parts, spec, newBackstage);\n  };\n\n  var interpretParts = function (parts, spec, backstage) {\n    return get$e(factories, spec.type).fold(function () {\n      console.error('Unknown factory type \"' + spec.type + '\", defaulting to container: ', spec);\n      return spec;\n    }, function (factory) {\n      return factory(parts, spec, backstage);\n    });\n  };\n\n  var interpretWithoutForm = function (spec, backstage) {\n    var parts = noFormParts;\n    return interpretParts(parts, spec, backstage);\n  };\n\n  var bubbleAlignments$2 = {\n    valignCentre: [],\n    alignCentre: [],\n    alignLeft: [],\n    alignRight: [],\n    right: [],\n    left: [],\n    bottom: [],\n    top: []\n  };\n\n  var getInlineDialogAnchor = function (contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor) {\n    var bubbleSize = 12;\n    var overrides = {\n      maxHeightFunction: expandable$1()\n    };\n\n    var editableAreaAnchor = function () {\n      return {\n        type: 'node',\n        root: getContentContainer(contentAreaElement()),\n        node: Optional.from(contentAreaElement()),\n        bubble: nu$5(bubbleSize, bubbleSize, bubbleAlignments$2),\n        layouts: {\n          onRtl: function () {\n            return [northeast];\n          },\n          onLtr: function () {\n            return [northwest];\n          }\n        },\n        overrides: overrides\n      };\n    };\n\n    var standardAnchor = function () {\n      return {\n        type: 'hotspot',\n        hotspot: lazyAnchorbar(),\n        bubble: nu$5(-bubbleSize, bubbleSize, bubbleAlignments$2),\n        layouts: {\n          onRtl: function () {\n            return [southeast$2];\n          },\n          onLtr: function () {\n            return [southwest$2];\n          }\n        },\n        overrides: overrides\n      };\n    };\n\n    return function () {\n      return lazyUseEditableAreaAnchor() ? editableAreaAnchor() : standardAnchor();\n    };\n  };\n\n  var getBannerAnchor = function (contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor) {\n    var editableAreaAnchor = function () {\n      return {\n        type: 'node',\n        root: getContentContainer(contentAreaElement()),\n        node: Optional.from(contentAreaElement()),\n        layouts: {\n          onRtl: function () {\n            return [north];\n          },\n          onLtr: function () {\n            return [north];\n          }\n        }\n      };\n    };\n\n    var standardAnchor = function () {\n      return {\n        type: 'hotspot',\n        hotspot: lazyAnchorbar(),\n        layouts: {\n          onRtl: function () {\n            return [south$2];\n          },\n          onLtr: function () {\n            return [south$2];\n          }\n        }\n      };\n    };\n\n    return function () {\n      return lazyUseEditableAreaAnchor() ? editableAreaAnchor() : standardAnchor();\n    };\n  };\n\n  var getCursorAnchor = function (editor, bodyElement) {\n    return function () {\n      return {\n        type: 'selection',\n        root: bodyElement(),\n        getSelection: function () {\n          var rng = editor.selection.getRng();\n          return Optional.some(SimSelection.range(SugarElement.fromDom(rng.startContainer), rng.startOffset, SugarElement.fromDom(rng.endContainer), rng.endOffset));\n        }\n      };\n    };\n  };\n\n  var getNodeAnchor$1 = function (bodyElement) {\n    return function (element) {\n      return {\n        type: 'node',\n        root: bodyElement(),\n        node: element\n      };\n    };\n  };\n\n  var getAnchors = function (editor, lazyAnchorbar, isToolbarTop) {\n    var useFixedToolbarContainer = useFixedContainer(editor);\n\n    var bodyElement = function () {\n      return SugarElement.fromDom(editor.getBody());\n    };\n\n    var contentAreaElement = function () {\n      return SugarElement.fromDom(editor.getContentAreaContainer());\n    };\n\n    var lazyUseEditableAreaAnchor = function () {\n      return useFixedToolbarContainer || !isToolbarTop();\n    };\n\n    return {\n      inlineDialog: getInlineDialogAnchor(contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor),\n      banner: getBannerAnchor(contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor),\n      cursor: getCursorAnchor(editor, bodyElement),\n      node: getNodeAnchor$1(bodyElement)\n    };\n  };\n\n  var colorPicker = function (editor) {\n    return function (callback, value) {\n      var dialog = colorPickerDialog(editor);\n      dialog(callback, value);\n    };\n  };\n\n  var hasCustomColors = function (editor) {\n    return function () {\n      return hasCustomColors$1(editor);\n    };\n  };\n\n  var getColors = function (editor) {\n    return function () {\n      return getColors$2(editor);\n    };\n  };\n\n  var getColorCols = function (editor) {\n    return function () {\n      return getColorCols$1(editor);\n    };\n  };\n\n  var ColorInputBackstage = function (editor) {\n    return {\n      colorPicker: colorPicker(editor),\n      hasCustomColors: hasCustomColors(editor),\n      getColors: getColors(editor),\n      getColorCols: getColorCols(editor)\n    };\n  };\n\n  var isDraggableModal = function (editor) {\n    return function () {\n      return isDraggableModal$1(editor);\n    };\n  };\n\n  var DialogBackstage = function (editor) {\n    return {\n      isDraggableModal: isDraggableModal(editor)\n    };\n  };\n\n  var HeaderBackstage = function (editor) {\n    var mode = Cell(isToolbarLocationBottom(editor) ? 'bottom' : 'top');\n    return {\n      isPositionedAtTop: function () {\n        return mode.get() === 'top';\n      },\n      getDockingMode: mode.get,\n      setDockingMode: mode.set\n    };\n  };\n\n  var defaultStyleFormats = [{\n    title: 'Headings',\n    items: [{\n      title: 'Heading 1',\n      format: 'h1'\n    }, {\n      title: 'Heading 2',\n      format: 'h2'\n    }, {\n      title: 'Heading 3',\n      format: 'h3'\n    }, {\n      title: 'Heading 4',\n      format: 'h4'\n    }, {\n      title: 'Heading 5',\n      format: 'h5'\n    }, {\n      title: 'Heading 6',\n      format: 'h6'\n    }]\n  }, {\n    title: 'Inline',\n    items: [{\n      title: 'Bold',\n      format: 'bold'\n    }, {\n      title: 'Italic',\n      format: 'italic'\n    }, {\n      title: 'Underline',\n      format: 'underline'\n    }, {\n      title: 'Strikethrough',\n      format: 'strikethrough'\n    }, {\n      title: 'Superscript',\n      format: 'superscript'\n    }, {\n      title: 'Subscript',\n      format: 'subscript'\n    }, {\n      title: 'Code',\n      format: 'code'\n    }]\n  }, {\n    title: 'Blocks',\n    items: [{\n      title: 'Paragraph',\n      format: 'p'\n    }, {\n      title: 'Blockquote',\n      format: 'blockquote'\n    }, {\n      title: 'Div',\n      format: 'div'\n    }, {\n      title: 'Pre',\n      format: 'pre'\n    }]\n  }, {\n    title: 'Align',\n    items: [{\n      title: 'Left',\n      format: 'alignleft'\n    }, {\n      title: 'Center',\n      format: 'aligncenter'\n    }, {\n      title: 'Right',\n      format: 'alignright'\n    }, {\n      title: 'Justify',\n      format: 'alignjustify'\n    }]\n  }];\n\n  var isNestedFormat = function (format) {\n    return has$2(format, 'items');\n  };\n\n  var isBlockFormat = function (format) {\n    return has$2(format, 'block');\n  };\n\n  var isInlineFormat = function (format) {\n    return has$2(format, 'inline');\n  };\n\n  var isSelectorFormat = function (format) {\n    return has$2(format, 'selector');\n  };\n\n  var mapFormats = function (userFormats) {\n    return foldl(userFormats, function (acc, fmt) {\n      if (isNestedFormat(fmt)) {\n        var result = mapFormats(fmt.items);\n        return {\n          customFormats: acc.customFormats.concat(result.customFormats),\n          formats: acc.formats.concat([{\n            title: fmt.title,\n            items: result.formats\n          }])\n        };\n      } else if (isInlineFormat(fmt) || isBlockFormat(fmt) || isSelectorFormat(fmt)) {\n        var formatName = isString(fmt.name) ? fmt.name : fmt.title.toLowerCase();\n        var formatNameWithPrefix = 'custom-' + formatName;\n        return {\n          customFormats: acc.customFormats.concat([{\n            name: formatNameWithPrefix,\n            format: fmt\n          }]),\n          formats: acc.formats.concat([{\n            title: fmt.title,\n            format: formatNameWithPrefix,\n            icon: fmt.icon\n          }])\n        };\n      } else {\n        return __assign(__assign({}, acc), {\n          formats: acc.formats.concat(fmt)\n        });\n      }\n    }, {\n      customFormats: [],\n      formats: []\n    });\n  };\n\n  var registerCustomFormats = function (editor, userFormats) {\n    var result = mapFormats(userFormats);\n\n    var registerFormats = function (customFormats) {\n      each$1(customFormats, function (fmt) {\n        if (!editor.formatter.has(fmt.name)) {\n          editor.formatter.register(fmt.name, fmt.format);\n        }\n      });\n    };\n\n    if (editor.formatter) {\n      registerFormats(result.customFormats);\n    } else {\n      editor.on('init', function () {\n        registerFormats(result.customFormats);\n      });\n    }\n\n    return result.formats;\n  };\n\n  var getStyleFormats = function (editor) {\n    return getUserStyleFormats(editor).map(function (userFormats) {\n      var registeredUserFormats = registerCustomFormats(editor, userFormats);\n      return isMergeStyleFormats(editor) ? defaultStyleFormats.concat(registeredUserFormats) : registeredUserFormats;\n    }).getOr(defaultStyleFormats);\n  };\n\n  var processBasic = function (item, isSelectedFor, getPreviewFor) {\n    var formatterSpec = {\n      type: 'formatter',\n      isSelected: isSelectedFor(item.format),\n      getStylePreview: getPreviewFor(item.format)\n    };\n    return deepMerge(item, formatterSpec);\n  };\n\n  var register$8 = function (editor, formats, isSelectedFor, getPreviewFor) {\n    var enrichSupported = function (item) {\n      return processBasic(item, isSelectedFor, getPreviewFor);\n    };\n\n    var enrichMenu = function (item) {\n      var submenuSpec = {\n        type: 'submenu'\n      };\n      return deepMerge(item, submenuSpec);\n    };\n\n    var enrichCustom = function (item) {\n      var formatName = isString(item.name) ? item.name : generate$6(item.title);\n      var formatNameWithPrefix = 'custom-' + formatName;\n      var customSpec = {\n        type: 'formatter',\n        format: formatNameWithPrefix,\n        isSelected: isSelectedFor(formatNameWithPrefix),\n        getStylePreview: getPreviewFor(formatNameWithPrefix)\n      };\n      var newItem = deepMerge(item, customSpec);\n      editor.formatter.register(formatName, newItem);\n      return newItem;\n    };\n\n    var doEnrich = function (items) {\n      return map$2(items, function (item) {\n        var keys$1 = keys(item);\n\n        if (hasNonNullableKey(item, 'items')) {\n          var newItems = doEnrich(item.items);\n          return deepMerge(enrichMenu(item), {\n            getStyleItems: constant$1(newItems)\n          });\n        } else if (hasNonNullableKey(item, 'format')) {\n          return enrichSupported(item);\n        } else if (keys$1.length === 1 && contains$2(keys$1, 'title')) {\n          return deepMerge(item, {\n            type: 'separator'\n          });\n        } else {\n          return enrichCustom(item);\n        }\n      });\n    };\n\n    return doEnrich(formats);\n  };\n\n  var init$8 = function (editor) {\n    var isSelectedFor = function (format) {\n      return function () {\n        return editor.formatter.match(format);\n      };\n    };\n\n    var getPreviewFor = function (format) {\n      return function () {\n        var fmt = editor.formatter.get(format);\n        return fmt !== undefined ? Optional.some({\n          tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n          styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n        }) : Optional.none();\n      };\n    };\n\n    var flatten = function (fmt) {\n      var subs = fmt.items;\n      return subs !== undefined && subs.length > 0 ? bind$3(subs, flatten) : [fmt.format];\n    };\n\n    var settingsFormats = Cell([]);\n    var settingsFlattenedFormats = Cell([]);\n    var eventsFormats = Cell([]);\n    var eventsFlattenedFormats = Cell([]);\n    var replaceSettings = Cell(false);\n    editor.on('PreInit', function (_e) {\n      var formats = getStyleFormats(editor);\n      var enriched = register$8(editor, formats, isSelectedFor, getPreviewFor);\n      settingsFormats.set(enriched);\n      settingsFlattenedFormats.set(bind$3(enriched, flatten));\n    });\n    editor.on('addStyleModifications', function (e) {\n      var modifications = register$8(editor, e.items, isSelectedFor, getPreviewFor);\n      eventsFormats.set(modifications);\n      replaceSettings.set(e.replace);\n      eventsFlattenedFormats.set(bind$3(modifications, flatten));\n    });\n\n    var getData = function () {\n      var fromSettings = replaceSettings.get() ? [] : settingsFormats.get();\n      var fromEvents = eventsFormats.get();\n      return fromSettings.concat(fromEvents);\n    };\n\n    var getFlattenedKeys = function () {\n      var fromSettings = replaceSettings.get() ? [] : settingsFlattenedFormats.get();\n      var fromEvents = eventsFlattenedFormats.get();\n      return fromSettings.concat(fromEvents);\n    };\n\n    return {\n      getData: getData,\n      getFlattenedKeys: getFlattenedKeys\n    };\n  };\n\n  var isElement = function (node) {\n    return isNonNullable(node) && node.nodeType === 1;\n  };\n\n  var trim = global$5.trim;\n\n  var hasContentEditableState = function (value) {\n    return function (node) {\n      if (isElement(node)) {\n        if (node.contentEditable === value) {\n          return true;\n        }\n\n        if (node.getAttribute('data-mce-contenteditable') === value) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  };\n\n  var isContentEditableTrue = hasContentEditableState('true');\n  var isContentEditableFalse = hasContentEditableState('false');\n\n  var create = function (type, title, url, level, attach) {\n    return {\n      type: type,\n      title: title,\n      url: url,\n      level: level,\n      attach: attach\n    };\n  };\n\n  var isChildOfContentEditableTrue = function (node) {\n    while (node = node.parentNode) {\n      var value = node.contentEditable;\n\n      if (value && value !== 'inherit') {\n        return isContentEditableTrue(node);\n      }\n    }\n\n    return false;\n  };\n\n  var select = function (selector, root) {\n    return map$2(descendants(SugarElement.fromDom(root), selector), function (element) {\n      return element.dom;\n    });\n  };\n\n  var getElementText = function (elm) {\n    return elm.innerText || elm.textContent;\n  };\n\n  var getOrGenerateId = function (elm) {\n    return elm.id ? elm.id : generate$6('h');\n  };\n\n  var isAnchor = function (elm) {\n    return elm && elm.nodeName === 'A' && (elm.id || elm.name) !== undefined;\n  };\n\n  var isValidAnchor = function (elm) {\n    return isAnchor(elm) && isEditable(elm);\n  };\n\n  var isHeader = function (elm) {\n    return elm && /^(H[1-6])$/.test(elm.nodeName);\n  };\n\n  var isEditable = function (elm) {\n    return isChildOfContentEditableTrue(elm) && !isContentEditableFalse(elm);\n  };\n\n  var isValidHeader = function (elm) {\n    return isHeader(elm) && isEditable(elm);\n  };\n\n  var getLevel = function (elm) {\n    return isHeader(elm) ? parseInt(elm.nodeName.substr(1), 10) : 0;\n  };\n\n  var headerTarget = function (elm) {\n    var headerId = getOrGenerateId(elm);\n\n    var attach = function () {\n      elm.id = headerId;\n    };\n\n    return create('header', getElementText(elm), '#' + headerId, getLevel(elm), attach);\n  };\n\n  var anchorTarget = function (elm) {\n    var anchorId = elm.id || elm.name;\n    var anchorText = getElementText(elm);\n    return create('anchor', anchorText ? anchorText : '#' + anchorId, '#' + anchorId, 0, noop);\n  };\n\n  var getHeaderTargets = function (elms) {\n    return map$2(filter$2(elms, isValidHeader), headerTarget);\n  };\n\n  var getAnchorTargets = function (elms) {\n    return map$2(filter$2(elms, isValidAnchor), anchorTarget);\n  };\n\n  var getTargetElements = function (elm) {\n    var elms = select('h1,h2,h3,h4,h5,h6,a:not([href])', elm);\n    return elms;\n  };\n\n  var hasTitle = function (target) {\n    return trim(target.title).length > 0;\n  };\n\n  var find = function (elm) {\n    var elms = getTargetElements(elm);\n    return filter$2(getHeaderTargets(elms).concat(getAnchorTargets(elms)), hasTitle);\n  };\n\n  var LinkTargets = {\n    find: find\n  };\n  var STORAGE_KEY = 'tinymce-url-history';\n  var HISTORY_LENGTH = 5;\n\n  var isHttpUrl = function (url) {\n    return isString(url) && /^https?/.test(url);\n  };\n\n  var isArrayOfUrl = function (a) {\n    return isArray(a) && a.length <= HISTORY_LENGTH && forall(a, isHttpUrl);\n  };\n\n  var isRecordOfUrlArray = function (r) {\n    return isObject(r) && find$4(r, function (value) {\n      return !isArrayOfUrl(value);\n    }).isNone();\n  };\n\n  var getAllHistory = function () {\n    var unparsedHistory = global$8.getItem(STORAGE_KEY);\n\n    if (unparsedHistory === null) {\n      return {};\n    }\n\n    var history;\n\n    try {\n      history = JSON.parse(unparsedHistory);\n    } catch (e) {\n      if (e instanceof SyntaxError) {\n        console.log('Local storage ' + STORAGE_KEY + ' was not valid JSON', e);\n        return {};\n      }\n\n      throw e;\n    }\n\n    if (!isRecordOfUrlArray(history)) {\n      console.log('Local storage ' + STORAGE_KEY + ' was not valid format', history);\n      return {};\n    }\n\n    return history;\n  };\n\n  var setAllHistory = function (history) {\n    if (!isRecordOfUrlArray(history)) {\n      throw new Error('Bad format for history:\\n' + JSON.stringify(history));\n    }\n\n    global$8.setItem(STORAGE_KEY, JSON.stringify(history));\n  };\n\n  var getHistory = function (fileType) {\n    var history = getAllHistory();\n    return get$e(history, fileType).getOr([]);\n  };\n\n  var addToHistory = function (url, fileType) {\n    if (!isHttpUrl(url)) {\n      return;\n    }\n\n    var history = getAllHistory();\n    var items = get$e(history, fileType).getOr([]);\n    var itemsWithoutUrl = filter$2(items, function (item) {\n      return item !== url;\n    });\n    history[fileType] = [url].concat(itemsWithoutUrl).slice(0, HISTORY_LENGTH);\n    setAllHistory(history);\n  };\n\n  var isTruthy = function (value) {\n    return !!value;\n  };\n\n  var makeMap = function (value) {\n    return map$1(global$5.makeMap(value, /[, ]/), isTruthy);\n  };\n\n  var getPicker = function (editor) {\n    return Optional.from(getFilePickerCallback(editor)).filter(isFunction);\n  };\n\n  var getPickerTypes = function (editor) {\n    var optFileTypes = Optional.some(getFilePickerTypes(editor)).filter(isTruthy);\n    var optLegacyTypes = Optional.some(getFileBrowserCallbackTypes(editor)).filter(isTruthy);\n    var optTypes = optFileTypes.or(optLegacyTypes).map(makeMap);\n    return getPicker(editor).fold(never, function (_picker) {\n      return optTypes.fold(always, function (types) {\n        return keys(types).length > 0 ? types : false;\n      });\n    });\n  };\n\n  var getPickerSetting = function (editor, filetype) {\n    var pickerTypes = getPickerTypes(editor);\n\n    if (isBoolean(pickerTypes)) {\n      return pickerTypes ? getPicker(editor) : Optional.none();\n    } else {\n      return pickerTypes[filetype] ? getPicker(editor) : Optional.none();\n    }\n  };\n\n  var getUrlPicker = function (editor, filetype) {\n    return getPickerSetting(editor, filetype).map(function (picker) {\n      return function (entry) {\n        return Future.nu(function (completer) {\n          var handler = function (value, meta) {\n            if (!isString(value)) {\n              throw new Error('Expected value to be string');\n            }\n\n            if (meta !== undefined && !isObject(meta)) {\n              throw new Error('Expected meta to be a object');\n            }\n\n            var r = {\n              value: value,\n              meta: meta\n            };\n            completer(r);\n          };\n\n          var meta = __assign({\n            filetype: filetype,\n            fieldname: entry.fieldname\n          }, Optional.from(entry.meta).getOr({}));\n\n          picker.call(editor, handler, entry.value, meta);\n        });\n      };\n    });\n  };\n\n  var getTextSetting = function (value) {\n    return Optional.from(value).filter(isString).getOrUndefined();\n  };\n\n  var getLinkInformation = function (editor) {\n    if (noTypeaheadUrls(editor)) {\n      return Optional.none();\n    }\n\n    return Optional.some({\n      targets: LinkTargets.find(editor.getBody()),\n      anchorTop: getTextSetting(getAnchorTop(editor)),\n      anchorBottom: getTextSetting(getAnchorBottom(editor))\n    });\n  };\n\n  var getValidationHandler = function (editor) {\n    return Optional.from(getFilePickerValidatorHandler(editor));\n  };\n\n  var UrlInputBackstage = function (editor) {\n    return {\n      getHistory: getHistory,\n      addToHistory: addToHistory,\n      getLinkInformation: function () {\n        return getLinkInformation(editor);\n      },\n      getValidationHandler: function () {\n        return getValidationHandler(editor);\n      },\n      getUrlPicker: function (filetype) {\n        return getUrlPicker(editor, filetype);\n      }\n    };\n  };\n\n  var init$7 = function (sink, editor, lazyAnchorbar) {\n    var contextMenuState = Cell(false);\n    var toolbar = HeaderBackstage(editor);\n    var backstage = {\n      shared: {\n        providers: {\n          icons: function () {\n            return editor.ui.registry.getAll().icons;\n          },\n          menuItems: function () {\n            return editor.ui.registry.getAll().menuItems;\n          },\n          translate: global$e.translate,\n          isDisabled: function () {\n            return editor.mode.isReadOnly() || editor.ui.isDisabled();\n          },\n          getSetting: editor.getParam.bind(editor)\n        },\n        interpreter: function (s) {\n          return interpretWithoutForm(s, backstage);\n        },\n        anchors: getAnchors(editor, lazyAnchorbar, toolbar.isPositionedAtTop),\n        header: toolbar,\n        getSink: function () {\n          return Result.value(sink);\n        }\n      },\n      urlinput: UrlInputBackstage(editor),\n      styleselect: init$8(editor),\n      colorinput: ColorInputBackstage(editor),\n      dialog: DialogBackstage(editor),\n      isContextMenuOpen: function () {\n        return contextMenuState.get();\n      },\n      setContextMenuState: function (state) {\n        return contextMenuState.set(state);\n      }\n    };\n    return backstage;\n  };\n\n  var setup$b = function (editor, mothership, uiMothership) {\n    var broadcastEvent = function (name, evt) {\n      each$1([mothership, uiMothership], function (ship) {\n        ship.broadcastEvent(name, evt);\n      });\n    };\n\n    var broadcastOn = function (channel, message) {\n      each$1([mothership, uiMothership], function (ship) {\n        ship.broadcastOn([channel], message);\n      });\n    };\n\n    var fireDismissPopups = function (evt) {\n      return broadcastOn(dismissPopups(), {\n        target: evt.target\n      });\n    };\n\n    var doc = getDocument();\n    var onTouchstart = bind(doc, 'touchstart', fireDismissPopups);\n    var onTouchmove = bind(doc, 'touchmove', function (evt) {\n      return broadcastEvent(documentTouchmove(), evt);\n    });\n    var onTouchend = bind(doc, 'touchend', function (evt) {\n      return broadcastEvent(documentTouchend(), evt);\n    });\n    var onMousedown = bind(doc, 'mousedown', fireDismissPopups);\n    var onMouseup = bind(doc, 'mouseup', function (evt) {\n      if (evt.raw.button === 0) {\n        broadcastOn(mouseReleased(), {\n          target: evt.target\n        });\n      }\n    });\n\n    var onContentClick = function (raw) {\n      return broadcastOn(dismissPopups(), {\n        target: SugarElement.fromDom(raw.target)\n      });\n    };\n\n    var onContentMouseup = function (raw) {\n      if (raw.button === 0) {\n        broadcastOn(mouseReleased(), {\n          target: SugarElement.fromDom(raw.target)\n        });\n      }\n    };\n\n    var onContentMousedown = function () {\n      each$1(editor.editorManager.get(), function (loopEditor) {\n        if (editor !== loopEditor) {\n          loopEditor.fire('DismissPopups', {\n            relatedTarget: editor\n          });\n        }\n      });\n    };\n\n    var onWindowScroll = function (evt) {\n      return broadcastEvent(windowScroll(), fromRawEvent(evt));\n    };\n\n    var onWindowResize = function (evt) {\n      broadcastOn(repositionPopups(), {});\n      broadcastEvent(windowResize(), fromRawEvent(evt));\n    };\n\n    var onEditorResize = function () {\n      return broadcastOn(repositionPopups(), {});\n    };\n\n    var onEditorProgress = function (evt) {\n      if (evt.state) {\n        broadcastOn(dismissPopups(), {\n          target: SugarElement.fromDom(editor.getContainer())\n        });\n      }\n    };\n\n    var onDismissPopups = function (event) {\n      broadcastOn(dismissPopups(), {\n        target: SugarElement.fromDom(event.relatedTarget.getContainer())\n      });\n    };\n\n    editor.on('PostRender', function () {\n      editor.on('click', onContentClick);\n      editor.on('tap', onContentClick);\n      editor.on('mouseup', onContentMouseup);\n      editor.on('mousedown', onContentMousedown);\n      editor.on('ScrollWindow', onWindowScroll);\n      editor.on('ResizeWindow', onWindowResize);\n      editor.on('ResizeEditor', onEditorResize);\n      editor.on('AfterProgressState', onEditorProgress);\n      editor.on('DismissPopups', onDismissPopups);\n    });\n    editor.on('remove', function () {\n      editor.off('click', onContentClick);\n      editor.off('tap', onContentClick);\n      editor.off('mouseup', onContentMouseup);\n      editor.off('mousedown', onContentMousedown);\n      editor.off('ScrollWindow', onWindowScroll);\n      editor.off('ResizeWindow', onWindowResize);\n      editor.off('ResizeEditor', onEditorResize);\n      editor.off('AfterProgressState', onEditorProgress);\n      editor.off('DismissPopups', onDismissPopups);\n      onMousedown.unbind();\n      onTouchstart.unbind();\n      onTouchmove.unbind();\n      onTouchend.unbind();\n      onMouseup.unbind();\n    });\n    editor.on('detach', function () {\n      detachSystem(mothership);\n      detachSystem(uiMothership);\n      mothership.destroy();\n      uiMothership.destroy();\n    });\n  };\n\n  var parts$a = AlloyParts;\n  var partType = PartType;\n  var schema$f = constant$1([defaulted('shell', false), required$1('makeItem'), defaulted('setupItem', noop), SketchBehaviours.field('listBehaviours', [Replacing])]);\n\n  var customListDetail = function () {\n    return {\n      behaviours: derive$1([Replacing.config({})])\n    };\n  };\n\n  var itemsPart = optional({\n    name: 'items',\n    overrides: customListDetail\n  });\n  var parts$9 = constant$1([itemsPart]);\n  var name = constant$1('CustomList');\n\n  var factory$d = function (detail, components, _spec, _external) {\n    var setItems = function (list, items) {\n      getListContainer(list).fold(function () {\n        console.error('Custom List was defined to not be a shell, but no item container was specified in components');\n        throw new Error('Custom List was defined to not be a shell, but no item container was specified in components');\n      }, function (container) {\n        var itemComps = Replacing.contents(container);\n        var numListsRequired = items.length;\n        var numListsToAdd = numListsRequired - itemComps.length;\n        var itemsToAdd = numListsToAdd > 0 ? range$2(numListsToAdd, function () {\n          return detail.makeItem();\n        }) : [];\n        var itemsToRemove = itemComps.slice(numListsRequired);\n        each$1(itemsToRemove, function (item) {\n          return Replacing.remove(container, item);\n        });\n        each$1(itemsToAdd, function (item) {\n          return Replacing.append(container, item);\n        });\n        var builtLists = Replacing.contents(container);\n        each$1(builtLists, function (item, i) {\n          detail.setupItem(list, item, items[i], i);\n        });\n      });\n    };\n\n    var extra = detail.shell ? {\n      behaviours: [Replacing.config({})],\n      components: []\n    } : {\n      behaviours: [],\n      components: components\n    };\n\n    var getListContainer = function (component) {\n      return detail.shell ? Optional.some(component) : getPart(component, detail, 'items');\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: extra.components,\n      behaviours: augment(detail.listBehaviours, extra.behaviours),\n      apis: {\n        setItems: setItems\n      }\n    };\n  };\n\n  var CustomList = composite({\n    name: name(),\n    configFields: schema$f(),\n    partFields: parts$9(),\n    factory: factory$d,\n    apis: {\n      setItems: function (apis, list, items) {\n        apis.setItems(list, items);\n      }\n    }\n  });\n  var schema$e = constant$1([required$1('dom'), defaulted('shell', true), field('toolbarBehaviours', [Replacing])]);\n\n  var enhanceGroups = function () {\n    return {\n      behaviours: derive$1([Replacing.config({})])\n    };\n  };\n\n  var parts$8 = constant$1([optional({\n    name: 'groups',\n    overrides: enhanceGroups\n  })]);\n\n  var factory$c = function (detail, components, _spec, _externals) {\n    var setGroups = function (toolbar, groups) {\n      getGroupContainer(toolbar).fold(function () {\n        console.error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n        throw new Error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n      }, function (container) {\n        Replacing.set(container, groups);\n      });\n    };\n\n    var getGroupContainer = function (component) {\n      return detail.shell ? Optional.some(component) : getPart(component, detail, 'groups');\n    };\n\n    var extra = detail.shell ? {\n      behaviours: [Replacing.config({})],\n      components: []\n    } : {\n      behaviours: [],\n      components: components\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: extra.components,\n      behaviours: augment(detail.toolbarBehaviours, extra.behaviours),\n      apis: {\n        setGroups: setGroups\n      },\n      domModification: {\n        attributes: {\n          role: 'group'\n        }\n      }\n    };\n  };\n\n  var Toolbar = composite({\n    name: 'Toolbar',\n    configFields: schema$e(),\n    partFields: parts$8(),\n    factory: factory$c,\n    apis: {\n      setGroups: function (apis, toolbar, groups) {\n        apis.setGroups(toolbar, groups);\n      }\n    }\n  });\n  var setup$a = noop;\n  var isDocked$2 = never;\n  var getBehaviours$1 = constant$1([]);\n  var StaticHeader = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setup: setup$a,\n    isDocked: isDocked$2,\n    getBehaviours: getBehaviours$1\n  });\n\n  var getOffsetParent = function (element) {\n    var isFixed = is$1(getRaw(element, 'position'), 'fixed');\n    var offsetParent$1 = isFixed ? Optional.none() : offsetParent(element);\n    return offsetParent$1.orThunk(function () {\n      var marker = SugarElement.fromTag('span');\n      return parent(element).bind(function (parent) {\n        append$2(parent, marker);\n        var offsetParent$1 = offsetParent(marker);\n        remove$5(marker);\n        return offsetParent$1;\n      });\n    });\n  };\n\n  var getOrigin = function (element) {\n    return getOffsetParent(element).map(absolute$3).getOrThunk(function () {\n      return SugarPosition(0, 0);\n    });\n  };\n\n  var morphAdt = Adt.generate([{\n    static: []\n  }, {\n    absolute: ['positionCss']\n  }, {\n    fixed: ['positionCss']\n  }]);\n\n  var appear = function (component, contextualInfo) {\n    var elem = component.element;\n    add$2(elem, contextualInfo.transitionClass);\n    remove$2(elem, contextualInfo.fadeOutClass);\n    add$2(elem, contextualInfo.fadeInClass);\n    contextualInfo.onShow(component);\n  };\n\n  var disappear = function (component, contextualInfo) {\n    var elem = component.element;\n    add$2(elem, contextualInfo.transitionClass);\n    remove$2(elem, contextualInfo.fadeInClass);\n    add$2(elem, contextualInfo.fadeOutClass);\n    contextualInfo.onHide(component);\n  };\n\n  var isPartiallyVisible = function (box, viewport) {\n    return box.y < viewport.bottom && box.bottom > viewport.y;\n  };\n\n  var isTopCompletelyVisible = function (box, viewport) {\n    return box.y >= viewport.y;\n  };\n\n  var isBottomCompletelyVisible = function (box, viewport) {\n    return box.bottom <= viewport.bottom;\n  };\n\n  var isVisibleForModes = function (modes, box, viewport) {\n    return forall(modes, function (mode) {\n      switch (mode) {\n        case 'bottom':\n          return isBottomCompletelyVisible(box, viewport);\n\n        case 'top':\n          return isTopCompletelyVisible(box, viewport);\n      }\n    });\n  };\n\n  var getPrior = function (elem, state) {\n    return state.getInitialPos().map(function (pos) {\n      return bounds(pos.bounds.x, pos.bounds.y, get$a(elem), get$b(elem));\n    });\n  };\n\n  var storePrior = function (elem, box, state) {\n    state.setInitialPos({\n      style: getAllRaw(elem),\n      position: get$c(elem, 'position') || 'static',\n      bounds: box\n    });\n  };\n\n  var revertToOriginal = function (elem, box, state) {\n    return state.getInitialPos().bind(function (position) {\n      state.clearInitialPos();\n\n      switch (position.position) {\n        case 'static':\n          return Optional.some(morphAdt.static());\n\n        case 'absolute':\n          var offsetBox_1 = getOffsetParent(elem).map(box$1).getOrThunk(function () {\n            return box$1(body());\n          });\n          return Optional.some(morphAdt.absolute(NuPositionCss('absolute', get$e(position.style, 'left').map(function (_left) {\n            return box.x - offsetBox_1.x;\n          }), get$e(position.style, 'top').map(function (_top) {\n            return box.y - offsetBox_1.y;\n          }), get$e(position.style, 'right').map(function (_right) {\n            return offsetBox_1.right - box.right;\n          }), get$e(position.style, 'bottom').map(function (_bottom) {\n            return offsetBox_1.bottom - box.bottom;\n          }))));\n\n        default:\n          return Optional.none();\n      }\n    });\n  };\n\n  var morphToOriginal = function (elem, viewport, state) {\n    return getPrior(elem, state).filter(function (box) {\n      return isVisibleForModes(state.getModes(), box, viewport);\n    }).bind(function (box) {\n      return revertToOriginal(elem, box, state);\n    });\n  };\n\n  var morphToFixed = function (elem, viewport, state) {\n    var box = box$1(elem);\n\n    if (!isVisibleForModes(state.getModes(), box, viewport)) {\n      storePrior(elem, box, state);\n      var winBox = win();\n      var left = box.x - winBox.x;\n      var top_1 = viewport.y - winBox.y;\n      var bottom = winBox.bottom - viewport.bottom;\n      var isTop = box.y <= viewport.y;\n      return Optional.some(morphAdt.fixed(NuPositionCss('fixed', Optional.some(left), isTop ? Optional.some(top_1) : Optional.none(), Optional.none(), !isTop ? Optional.some(bottom) : Optional.none())));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var getMorph = function (component, viewport, state) {\n    var elem = component.element;\n    var isDocked = is$1(getRaw(elem, 'position'), 'fixed');\n    return isDocked ? morphToOriginal(elem, viewport, state) : morphToFixed(elem, viewport, state);\n  };\n\n  var getMorphToOriginal = function (component, state) {\n    var elem = component.element;\n    return getPrior(elem, state).bind(function (box) {\n      return revertToOriginal(elem, box, state);\n    });\n  };\n\n  var morphToStatic = function (component, config, state) {\n    state.setDocked(false);\n    each$1(['left', 'right', 'top', 'bottom', 'position'], function (prop) {\n      return remove$6(component.element, prop);\n    });\n    config.onUndocked(component);\n  };\n\n  var morphToCoord = function (component, config, state, position) {\n    var isDocked = position.position === 'fixed';\n    state.setDocked(isDocked);\n    applyPositionCss(component.element, position);\n    var method = isDocked ? config.onDocked : config.onUndocked;\n    method(component);\n  };\n\n  var updateVisibility = function (component, config, state, viewport, morphToDocked) {\n    if (morphToDocked === void 0) {\n      morphToDocked = false;\n    }\n\n    config.contextual.each(function (contextInfo) {\n      contextInfo.lazyContext(component).each(function (box) {\n        var isVisible = isPartiallyVisible(box, viewport);\n\n        if (isVisible !== state.isVisible()) {\n          state.setVisible(isVisible);\n\n          if (morphToDocked && !isVisible) {\n            add$1(component.element, [contextInfo.fadeOutClass]);\n            contextInfo.onHide(component);\n          } else {\n            var method = isVisible ? appear : disappear;\n            method(component, contextInfo);\n          }\n        }\n      });\n    });\n  };\n\n  var refreshInternal = function (component, config, state) {\n    var viewport = config.lazyViewport(component);\n    var isDocked = state.isDocked();\n\n    if (isDocked) {\n      updateVisibility(component, config, state, viewport);\n    }\n\n    getMorph(component, viewport, state).each(function (morph) {\n      morph.fold(function () {\n        return morphToStatic(component, config, state);\n      }, function (position) {\n        return morphToCoord(component, config, state, position);\n      }, function (position) {\n        updateVisibility(component, config, state, viewport, true);\n        morphToCoord(component, config, state, position);\n      });\n    });\n  };\n\n  var resetInternal = function (component, config, state) {\n    var elem = component.element;\n    state.setDocked(false);\n    getMorphToOriginal(component, state).each(function (morph) {\n      morph.fold(function () {\n        return morphToStatic(component, config, state);\n      }, function (position) {\n        return morphToCoord(component, config, state, position);\n      }, noop);\n    });\n    state.setVisible(true);\n    config.contextual.each(function (contextInfo) {\n      remove$1(elem, [contextInfo.fadeInClass, contextInfo.fadeOutClass, contextInfo.transitionClass]);\n      contextInfo.onShow(component);\n    });\n    refresh$4(component, config, state);\n  };\n\n  var refresh$4 = function (component, config, state) {\n    if (component.getSystem().isConnected()) {\n      refreshInternal(component, config, state);\n    }\n  };\n\n  var reset = function (component, config, state) {\n    if (state.isDocked()) {\n      resetInternal(component, config, state);\n    }\n  };\n\n  var isDocked$1 = function (component, config, state) {\n    return state.isDocked();\n  };\n\n  var setModes = function (component, config, state, modes) {\n    return state.setModes(modes);\n  };\n\n  var getModes = function (component, config, state) {\n    return state.getModes();\n  };\n\n  var DockingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    refresh: refresh$4,\n    reset: reset,\n    isDocked: isDocked$1,\n    getModes: getModes,\n    setModes: setModes\n  });\n\n  var events$5 = function (dockInfo, dockState) {\n    return derive$2([runOnSource(transitionend(), function (component, simulatedEvent) {\n      dockInfo.contextual.each(function (contextInfo) {\n        if (has(component.element, contextInfo.transitionClass)) {\n          remove$1(component.element, [contextInfo.transitionClass, contextInfo.fadeInClass]);\n          var notify = dockState.isVisible() ? contextInfo.onShown : contextInfo.onHidden;\n          notify(component);\n        }\n\n        simulatedEvent.stop();\n      });\n    }), run$1(windowScroll(), function (component, _) {\n      refresh$4(component, dockInfo, dockState);\n    }), run$1(windowResize(), function (component, _) {\n      reset(component, dockInfo, dockState);\n    })]);\n  };\n\n  var ActiveDocking = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$5\n  });\n  var DockingSchema = [optionObjOf('contextual', [requiredString('fadeInClass'), requiredString('fadeOutClass'), requiredString('transitionClass'), requiredFunction('lazyContext'), onHandler('onShow'), onHandler('onShown'), onHandler('onHide'), onHandler('onHidden')]), defaultedFunction('lazyViewport', win), defaultedArrayOf('modes', ['top', 'bottom'], string), onHandler('onDocked'), onHandler('onUndocked')];\n\n  var init$6 = function (spec) {\n    var docked = Cell(false);\n    var visible = Cell(true);\n    var initialBounds = value$1();\n    var modes = Cell(spec.modes);\n\n    var readState = function () {\n      return 'docked:  ' + docked.get() + ', visible: ' + visible.get() + ', modes: ' + modes.get().join(',');\n    };\n\n    return nu$8({\n      isDocked: docked.get,\n      setDocked: docked.set,\n      getInitialPos: initialBounds.get,\n      setInitialPos: initialBounds.set,\n      clearInitialPos: initialBounds.clear,\n      isVisible: visible.get,\n      setVisible: visible.set,\n      getModes: modes.get,\n      setModes: modes.set,\n      readState: readState\n    });\n  };\n\n  var DockingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$6\n  });\n  var Docking = create$7({\n    fields: DockingSchema,\n    name: 'docking',\n    active: ActiveDocking,\n    apis: DockingApis,\n    state: DockingState\n  });\n  var toolbarHeightChange = constant$1(generate$6('toolbar-height-change'));\n  var visibility = {\n    fadeInClass: 'tox-editor-dock-fadein',\n    fadeOutClass: 'tox-editor-dock-fadeout',\n    transitionClass: 'tox-editor-dock-transition'\n  };\n  var editorStickyOnClass = 'tox-tinymce--toolbar-sticky-on';\n  var editorStickyOffClass = 'tox-tinymce--toolbar-sticky-off';\n\n  var scrollFromBehindHeader = function (e, containerHeader) {\n    var doc = owner$4(containerHeader);\n    var viewHeight = doc.dom.defaultView.innerHeight;\n    var scrollPos = get$9(doc);\n    var markerElement = SugarElement.fromDom(e.elm);\n    var markerPos = absolute$2(markerElement);\n    var markerHeight = get$b(markerElement);\n    var markerTop = markerPos.y;\n    var markerBottom = markerTop + markerHeight;\n    var editorHeaderPos = absolute$3(containerHeader);\n    var editorHeaderHeight = get$b(containerHeader);\n    var editorHeaderTop = editorHeaderPos.top;\n    var editorHeaderBottom = editorHeaderTop + editorHeaderHeight;\n    var editorHeaderDockedAtTop = Math.abs(editorHeaderTop - scrollPos.top) < 2;\n    var editorHeaderDockedAtBottom = Math.abs(editorHeaderBottom - (scrollPos.top + viewHeight)) < 2;\n\n    if (editorHeaderDockedAtTop && markerTop < editorHeaderBottom) {\n      to(scrollPos.left, markerTop - editorHeaderHeight, doc);\n    } else if (editorHeaderDockedAtBottom && markerBottom > editorHeaderTop) {\n      var y = markerTop - viewHeight + markerHeight + editorHeaderHeight;\n      to(scrollPos.left, y, doc);\n    }\n  };\n\n  var isDockedMode = function (header, mode) {\n    return contains$2(Docking.getModes(header), mode);\n  };\n\n  var updateIframeContentFlow = function (header) {\n    var getOccupiedHeight = function (elm) {\n      return getOuter$2(elm) + (parseInt(get$c(elm, 'margin-top'), 10) || 0) + (parseInt(get$c(elm, 'margin-bottom'), 10) || 0);\n    };\n\n    var elm = header.element;\n    parent(elm).each(function (parentElem) {\n      var padding = 'padding-' + Docking.getModes(header)[0];\n\n      if (Docking.isDocked(header)) {\n        var parentWidth = get$a(parentElem);\n        set$7(elm, 'width', parentWidth + 'px');\n        set$7(parentElem, padding, getOccupiedHeight(elm) + 'px');\n      } else {\n        remove$6(elm, 'width');\n        remove$6(parentElem, padding);\n      }\n    });\n  };\n\n  var updateSinkVisibility = function (sinkElem, visible) {\n    if (visible) {\n      remove$2(sinkElem, visibility.fadeOutClass);\n      add$1(sinkElem, [visibility.transitionClass, visibility.fadeInClass]);\n    } else {\n      remove$2(sinkElem, visibility.fadeInClass);\n      add$1(sinkElem, [visibility.fadeOutClass, visibility.transitionClass]);\n    }\n  };\n\n  var updateEditorClasses = function (editor, docked) {\n    var editorContainer = SugarElement.fromDom(editor.getContainer());\n\n    if (docked) {\n      add$2(editorContainer, editorStickyOnClass);\n      remove$2(editorContainer, editorStickyOffClass);\n    } else {\n      add$2(editorContainer, editorStickyOffClass);\n      remove$2(editorContainer, editorStickyOnClass);\n    }\n  };\n\n  var restoreFocus = function (headerElem, focusedElem) {\n    var ownerDoc = owner$4(focusedElem);\n    active(ownerDoc).filter(function (activeElm) {\n      return !eq(focusedElem, activeElm);\n    }).filter(function (activeElm) {\n      return eq(activeElm, SugarElement.fromDom(ownerDoc.dom.body)) || contains(headerElem, activeElm);\n    }).each(function () {\n      return focus$3(focusedElem);\n    });\n  };\n\n  var findFocusedElem = function (rootElm, lazySink) {\n    return search(rootElm).orThunk(function () {\n      return lazySink().toOptional().bind(function (sink) {\n        return search(sink.element);\n      });\n    });\n  };\n\n  var setup$9 = function (editor, sharedBackstage, lazyHeader) {\n    if (!editor.inline) {\n      if (!sharedBackstage.header.isPositionedAtTop()) {\n        editor.on('ResizeEditor', function () {\n          lazyHeader().each(Docking.reset);\n        });\n      }\n\n      editor.on('ResizeWindow ResizeEditor', function () {\n        lazyHeader().each(updateIframeContentFlow);\n      });\n      editor.on('SkinLoaded', function () {\n        lazyHeader().each(function (comp) {\n          Docking.isDocked(comp) ? Docking.reset(comp) : Docking.refresh(comp);\n        });\n      });\n      editor.on('FullscreenStateChanged', function () {\n        lazyHeader().each(Docking.reset);\n      });\n    }\n\n    editor.on('AfterScrollIntoView', function (e) {\n      lazyHeader().each(function (header) {\n        Docking.refresh(header);\n        var headerElem = header.element;\n\n        if (isVisible(headerElem)) {\n          scrollFromBehindHeader(e, headerElem);\n        }\n      });\n    });\n    editor.on('PostRender', function () {\n      updateEditorClasses(editor, false);\n    });\n  };\n\n  var isDocked = function (lazyHeader) {\n    return lazyHeader().map(Docking.isDocked).getOr(false);\n  };\n\n  var getIframeBehaviours = function () {\n    var _a;\n\n    return [Receiving.config({\n      channels: (_a = {}, _a[toolbarHeightChange()] = {\n        onReceive: updateIframeContentFlow\n      }, _a)\n    })];\n  };\n\n  var getBehaviours = function (editor, sharedBackstage) {\n    var focusedElm = value$1();\n    var lazySink = sharedBackstage.getSink;\n\n    var runOnSinkElement = function (f) {\n      lazySink().each(function (sink) {\n        return f(sink.element);\n      });\n    };\n\n    var onDockingSwitch = function (comp) {\n      if (!editor.inline) {\n        updateIframeContentFlow(comp);\n      }\n\n      updateEditorClasses(editor, Docking.isDocked(comp));\n      comp.getSystem().broadcastOn([repositionPopups()], {});\n      lazySink().each(function (sink) {\n        return sink.getSystem().broadcastOn([repositionPopups()], {});\n      });\n    };\n\n    var additionalBehaviours = editor.inline ? [] : getIframeBehaviours();\n    return __spreadArray([Focusing.config({}), Docking.config({\n      contextual: __assign({\n        lazyContext: function (comp) {\n          var headerHeight = getOuter$2(comp.element);\n          var container = editor.inline ? editor.getContentAreaContainer() : editor.getContainer();\n          var box = box$1(SugarElement.fromDom(container));\n          var boxHeight = box.height - headerHeight;\n          var topBound = box.y + (isDockedMode(comp, 'top') ? 0 : headerHeight);\n          return Optional.some(bounds(box.x, topBound, box.width, boxHeight));\n        },\n        onShow: function () {\n          runOnSinkElement(function (elem) {\n            return updateSinkVisibility(elem, true);\n          });\n        },\n        onShown: function (comp) {\n          runOnSinkElement(function (elem) {\n            return remove$1(elem, [visibility.transitionClass, visibility.fadeInClass]);\n          });\n          focusedElm.get().each(function (elem) {\n            restoreFocus(comp.element, elem);\n            focusedElm.clear();\n          });\n        },\n        onHide: function (comp) {\n          findFocusedElem(comp.element, lazySink).fold(focusedElm.clear, focusedElm.set);\n          runOnSinkElement(function (elem) {\n            return updateSinkVisibility(elem, false);\n          });\n        },\n        onHidden: function () {\n          runOnSinkElement(function (elem) {\n            return remove$1(elem, [visibility.transitionClass]);\n          });\n        }\n      }, visibility),\n      lazyViewport: function (comp) {\n        var win$1 = win();\n        var offset = getStickyToolbarOffset(editor);\n        var top = win$1.y + (isDockedMode(comp, 'top') ? offset : 0);\n        var height = win$1.height - (isDockedMode(comp, 'bottom') ? offset : 0);\n        return bounds(win$1.x, top, win$1.width, height);\n      },\n      modes: [sharedBackstage.header.getDockingMode()],\n      onDocked: onDockingSwitch,\n      onUndocked: onDockingSwitch\n    })], additionalBehaviours, true);\n  };\n\n  var StickyHeader = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setup: setup$9,\n    isDocked: isDocked,\n    getBehaviours: getBehaviours\n  });\n\n  var renderHeader = function (spec) {\n    var editor = spec.editor;\n    var getBehaviours$2 = spec.sticky ? getBehaviours : getBehaviours$1;\n    return {\n      uid: spec.uid,\n      dom: spec.dom,\n      components: spec.components,\n      behaviours: derive$1(getBehaviours$2(editor, spec.sharedBackstage))\n    };\n  };\n\n  var groupToolbarButtonSchema = objOf([requiredString('type'), requiredOf('items', oneOf([arrOfObj([requiredString('name'), requiredArrayOf('items', string)]), string]))].concat(baseToolbarButtonFields));\n\n  var createGroupToolbarButton = function (spec) {\n    return asRaw('GroupToolbarButton', groupToolbarButtonSchema, spec);\n  };\n\n  var baseMenuButtonFields = [optionString('text'), optionString('tooltip'), optionString('icon'), requiredFunction('fetch'), defaultedFunction('onSetup', function () {\n    return noop;\n  })];\n  var MenuButtonSchema = objOf(__spreadArray([requiredString('type')], baseMenuButtonFields, true));\n\n  var createMenuButton = function (spec) {\n    return asRaw('menubutton', MenuButtonSchema, spec);\n  };\n\n  var splitButtonSchema = objOf([requiredString('type'), optionString('tooltip'), optionString('icon'), optionString('text'), optionFunction('select'), requiredFunction('fetch'), defaultedFunction('onSetup', function () {\n    return noop;\n  }), defaultedStringEnum('presets', 'normal', ['normal', 'color', 'listpreview']), defaulted('columns', 1), requiredFunction('onAction'), requiredFunction('onItemAction')]);\n\n  var createSplitButton = function (spec) {\n    return asRaw('SplitButton', splitButtonSchema, spec);\n  };\n\n  var factory$b = function (detail, spec) {\n    var setMenus = function (comp, menus) {\n      var newMenus = map$2(menus, function (m) {\n        var buttonSpec = {\n          type: 'menubutton',\n          text: m.text,\n          fetch: function (callback) {\n            callback(m.getItems());\n          }\n        };\n        var internal = createMenuButton(buttonSpec).mapError(function (errInfo) {\n          return formatError(errInfo);\n        }).getOrDie();\n        return renderMenuButton(internal, 'tox-mbtn', spec.backstage, Optional.some('menuitem'));\n      });\n      Replacing.set(comp, newMenus);\n    };\n\n    var apis = {\n      focus: Keying.focusIn,\n      setMenus: setMenus\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: [],\n      behaviours: derive$1([Replacing.config({}), config('menubar-events', [runOnAttached(function (component) {\n        detail.onSetup(component);\n      }), run$1(mouseover(), function (comp, se) {\n        descendant(comp.element, '.' + 'tox-mbtn--active').each(function (activeButton) {\n          closest$1(se.event.target, '.' + 'tox-mbtn').each(function (hoveredButton) {\n            if (!eq(activeButton, hoveredButton)) {\n              comp.getSystem().getByDom(activeButton).each(function (activeComp) {\n                comp.getSystem().getByDom(hoveredButton).each(function (hoveredComp) {\n                  Dropdown.expand(hoveredComp);\n                  Dropdown.close(activeComp);\n                  Focusing.focus(hoveredComp);\n                });\n              });\n            }\n          });\n        });\n      }), run$1(focusShifted(), function (comp, se) {\n        se.event.prevFocus.bind(function (prev) {\n          return comp.getSystem().getByDom(prev).toOptional();\n        }).each(function (prev) {\n          se.event.newFocus.bind(function (nu) {\n            return comp.getSystem().getByDom(nu).toOptional();\n          }).each(function (nu) {\n            if (Dropdown.isOpen(prev)) {\n              Dropdown.expand(nu);\n              Dropdown.close(prev);\n            }\n          });\n        });\n      })]), Keying.config({\n        mode: 'flow',\n        selector: '.' + 'tox-mbtn',\n        onEscape: function (comp) {\n          detail.onEscape(comp);\n          return Optional.some(true);\n        }\n      }), Tabstopping.config({})]),\n      apis: apis,\n      domModification: {\n        attributes: {\n          role: 'menubar'\n        }\n      }\n    };\n  };\n\n  var SilverMenubar = single({\n    factory: factory$b,\n    name: 'silver.Menubar',\n    configFields: [required$1('dom'), required$1('uid'), required$1('onEscape'), required$1('backstage'), defaulted('onSetup', noop)],\n    apis: {\n      focus: function (apis, comp) {\n        apis.focus(comp);\n      },\n      setMenus: function (apis, comp, menus) {\n        apis.setMenus(comp, menus);\n      }\n    }\n  });\n\n  var getAnimationRoot = function (component, slideConfig) {\n    return slideConfig.getAnimationRoot.fold(function () {\n      return component.element;\n    }, function (get) {\n      return get(component);\n    });\n  };\n\n  var getDimensionProperty = function (slideConfig) {\n    return slideConfig.dimension.property;\n  };\n\n  var getDimension = function (slideConfig, elem) {\n    return slideConfig.dimension.getDimension(elem);\n  };\n\n  var disableTransitions = function (component, slideConfig) {\n    var root = getAnimationRoot(component, slideConfig);\n    remove$1(root, [slideConfig.shrinkingClass, slideConfig.growingClass]);\n  };\n\n  var setShrunk = function (component, slideConfig) {\n    remove$2(component.element, slideConfig.openClass);\n    add$2(component.element, slideConfig.closedClass);\n    set$7(component.element, getDimensionProperty(slideConfig), '0px');\n    reflow(component.element);\n  };\n\n  var setGrown = function (component, slideConfig) {\n    remove$2(component.element, slideConfig.closedClass);\n    add$2(component.element, slideConfig.openClass);\n    remove$6(component.element, getDimensionProperty(slideConfig));\n  };\n\n  var doImmediateShrink = function (component, slideConfig, slideState, _calculatedSize) {\n    slideState.setCollapsed();\n    set$7(component.element, getDimensionProperty(slideConfig), getDimension(slideConfig, component.element));\n    reflow(component.element);\n    disableTransitions(component, slideConfig);\n    setShrunk(component, slideConfig);\n    slideConfig.onStartShrink(component);\n    slideConfig.onShrunk(component);\n  };\n\n  var doStartShrink = function (component, slideConfig, slideState, calculatedSize) {\n    var size = calculatedSize.getOrThunk(function () {\n      return getDimension(slideConfig, component.element);\n    });\n    slideState.setCollapsed();\n    set$7(component.element, getDimensionProperty(slideConfig), size);\n    reflow(component.element);\n    var root = getAnimationRoot(component, slideConfig);\n    remove$2(root, slideConfig.growingClass);\n    add$2(root, slideConfig.shrinkingClass);\n    setShrunk(component, slideConfig);\n    slideConfig.onStartShrink(component);\n  };\n\n  var doStartSmartShrink = function (component, slideConfig, slideState) {\n    var size = getDimension(slideConfig, component.element);\n    var shrinker = size === '0px' ? doImmediateShrink : doStartShrink;\n    shrinker(component, slideConfig, slideState, Optional.some(size));\n  };\n\n  var doStartGrow = function (component, slideConfig, slideState) {\n    var root = getAnimationRoot(component, slideConfig);\n    var wasShrinking = has(root, slideConfig.shrinkingClass);\n    var beforeSize = getDimension(slideConfig, component.element);\n    setGrown(component, slideConfig);\n    var fullSize = getDimension(slideConfig, component.element);\n\n    var startPartialGrow = function () {\n      set$7(component.element, getDimensionProperty(slideConfig), beforeSize);\n      reflow(component.element);\n    };\n\n    var startCompleteGrow = function () {\n      setShrunk(component, slideConfig);\n    };\n\n    var setStartSize = wasShrinking ? startPartialGrow : startCompleteGrow;\n    setStartSize();\n    remove$2(root, slideConfig.shrinkingClass);\n    add$2(root, slideConfig.growingClass);\n    setGrown(component, slideConfig);\n    set$7(component.element, getDimensionProperty(slideConfig), fullSize);\n    slideState.setExpanded();\n    slideConfig.onStartGrow(component);\n  };\n\n  var refresh$3 = function (component, slideConfig, slideState) {\n    if (slideState.isExpanded()) {\n      remove$6(component.element, getDimensionProperty(slideConfig));\n      var fullSize = getDimension(slideConfig, component.element);\n      set$7(component.element, getDimensionProperty(slideConfig), fullSize);\n    }\n  };\n\n  var grow = function (component, slideConfig, slideState) {\n    if (!slideState.isExpanded()) {\n      doStartGrow(component, slideConfig, slideState);\n    }\n  };\n\n  var shrink = function (component, slideConfig, slideState) {\n    if (slideState.isExpanded()) {\n      doStartSmartShrink(component, slideConfig, slideState);\n    }\n  };\n\n  var immediateShrink = function (component, slideConfig, slideState) {\n    if (slideState.isExpanded()) {\n      doImmediateShrink(component, slideConfig, slideState);\n    }\n  };\n\n  var hasGrown = function (component, slideConfig, slideState) {\n    return slideState.isExpanded();\n  };\n\n  var hasShrunk = function (component, slideConfig, slideState) {\n    return slideState.isCollapsed();\n  };\n\n  var isGrowing = function (component, slideConfig, _slideState) {\n    var root = getAnimationRoot(component, slideConfig);\n    return has(root, slideConfig.growingClass) === true;\n  };\n\n  var isShrinking = function (component, slideConfig, _slideState) {\n    var root = getAnimationRoot(component, slideConfig);\n    return has(root, slideConfig.shrinkingClass) === true;\n  };\n\n  var isTransitioning = function (component, slideConfig, slideState) {\n    return isGrowing(component, slideConfig) || isShrinking(component, slideConfig);\n  };\n\n  var toggleGrow = function (component, slideConfig, slideState) {\n    var f = slideState.isExpanded() ? doStartSmartShrink : doStartGrow;\n    f(component, slideConfig, slideState);\n  };\n\n  var SlidingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    refresh: refresh$3,\n    grow: grow,\n    shrink: shrink,\n    immediateShrink: immediateShrink,\n    hasGrown: hasGrown,\n    hasShrunk: hasShrunk,\n    isGrowing: isGrowing,\n    isShrinking: isShrinking,\n    isTransitioning: isTransitioning,\n    toggleGrow: toggleGrow,\n    disableTransitions: disableTransitions\n  });\n\n  var exhibit = function (base, slideConfig, _slideState) {\n    var expanded = slideConfig.expanded;\n    return expanded ? nu$7({\n      classes: [slideConfig.openClass],\n      styles: {}\n    }) : nu$7({\n      classes: [slideConfig.closedClass],\n      styles: wrap$1(slideConfig.dimension.property, '0px')\n    });\n  };\n\n  var events$4 = function (slideConfig, slideState) {\n    return derive$2([runOnSource(transitionend(), function (component, simulatedEvent) {\n      var raw = simulatedEvent.event.raw;\n\n      if (raw.propertyName === slideConfig.dimension.property) {\n        disableTransitions(component, slideConfig);\n\n        if (slideState.isExpanded()) {\n          remove$6(component.element, slideConfig.dimension.property);\n        }\n\n        var notify = slideState.isExpanded() ? slideConfig.onGrown : slideConfig.onShrunk;\n        notify(component);\n      }\n    })]);\n  };\n\n  var ActiveSliding = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit,\n    events: events$4\n  });\n  var SlidingSchema = [required$1('closedClass'), required$1('openClass'), required$1('shrinkingClass'), required$1('growingClass'), option('getAnimationRoot'), onHandler('onShrunk'), onHandler('onStartShrink'), onHandler('onGrown'), onHandler('onStartGrow'), defaulted('expanded', false), requiredOf('dimension', choose$1('property', {\n    width: [output$1('property', 'width'), output$1('getDimension', function (elem) {\n      return get$a(elem) + 'px';\n    })],\n    height: [output$1('property', 'height'), output$1('getDimension', function (elem) {\n      return get$b(elem) + 'px';\n    })]\n  }))];\n\n  var init$5 = function (spec) {\n    var state = Cell(spec.expanded);\n\n    var readState = function () {\n      return 'expanded: ' + state.get();\n    };\n\n    return nu$8({\n      isExpanded: function () {\n        return state.get() === true;\n      },\n      isCollapsed: function () {\n        return state.get() === false;\n      },\n      setCollapsed: curry(state.set, false),\n      setExpanded: curry(state.set, true),\n      readState: readState\n    });\n  };\n\n  var SlidingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$5\n  });\n  var Sliding = create$7({\n    fields: SlidingSchema,\n    name: 'sliding',\n    active: ActiveSliding,\n    apis: SlidingApis,\n    state: SlidingState\n  });\n  var owner = 'container';\n  var schema$d = [field('slotBehaviours', [])];\n\n  var getPartName = function (name) {\n    return '<alloy.field.' + name + '>';\n  };\n\n  var sketch = function (sSpec) {\n    var parts = function () {\n      var record = [];\n\n      var slot = function (name, config) {\n        record.push(name);\n        return generateOne$1(owner, getPartName(name), config);\n      };\n\n      return {\n        slot: slot,\n        record: constant$1(record)\n      };\n    }();\n\n    var spec = sSpec(parts);\n    var partNames = parts.record();\n    var fieldParts = map$2(partNames, function (n) {\n      return required({\n        name: n,\n        pname: getPartName(n)\n      });\n    });\n    return composite$1(owner, schema$d, fieldParts, make$1, spec);\n  };\n\n  var make$1 = function (detail, components) {\n    var getSlotNames = function (_) {\n      return getAllPartNames(detail);\n    };\n\n    var getSlot = function (container, key) {\n      return getPart(container, detail, key);\n    };\n\n    var onSlot = function (f, def) {\n      return function (container, key) {\n        return getPart(container, detail, key).map(function (slot) {\n          return f(slot, key);\n        }).getOr(def);\n      };\n    };\n\n    var onSlots = function (f) {\n      return function (container, keys) {\n        each$1(keys, function (key) {\n          return f(container, key);\n        });\n      };\n    };\n\n    var doShowing = function (comp, _key) {\n      return get$d(comp.element, 'aria-hidden') !== 'true';\n    };\n\n    var doShow = function (comp, key) {\n      if (!doShowing(comp)) {\n        var element = comp.element;\n        remove$6(element, 'display');\n        remove$7(element, 'aria-hidden');\n        emitWith(comp, slotVisibility(), {\n          name: key,\n          visible: true\n        });\n      }\n    };\n\n    var doHide = function (comp, key) {\n      if (doShowing(comp)) {\n        var element = comp.element;\n        set$7(element, 'display', 'none');\n        set$8(element, 'aria-hidden', 'true');\n        emitWith(comp, slotVisibility(), {\n          name: key,\n          visible: false\n        });\n      }\n    };\n\n    var isShowing = onSlot(doShowing, false);\n    var hideSlot = onSlot(doHide);\n    var hideSlots = onSlots(hideSlot);\n\n    var hideAllSlots = function (container) {\n      return hideSlots(container, getSlotNames());\n    };\n\n    var showSlot = onSlot(doShow);\n    var apis = {\n      getSlotNames: getSlotNames,\n      getSlot: getSlot,\n      isShowing: isShowing,\n      hideSlot: hideSlot,\n      hideAllSlots: hideAllSlots,\n      showSlot: showSlot\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: get$2(detail.slotBehaviours),\n      apis: apis\n    };\n  };\n\n  var slotApis = map$1({\n    getSlotNames: function (apis, c) {\n      return apis.getSlotNames(c);\n    },\n    getSlot: function (apis, c, key) {\n      return apis.getSlot(c, key);\n    },\n    isShowing: function (apis, c, key) {\n      return apis.isShowing(c, key);\n    },\n    hideSlot: function (apis, c, key) {\n      return apis.hideSlot(c, key);\n    },\n    hideAllSlots: function (apis, c) {\n      return apis.hideAllSlots(c);\n    },\n    showSlot: function (apis, c, key) {\n      return apis.showSlot(c, key);\n    }\n  }, function (value) {\n    return makeApi(value);\n  });\n\n  var SlotContainer = __assign(__assign({}, slotApis), {\n    sketch: sketch\n  });\n\n  var sidebarSchema = objOf([optionString('icon'), optionString('tooltip'), defaultedFunction('onShow', noop), defaultedFunction('onHide', noop), defaultedFunction('onSetup', function () {\n    return noop;\n  })]);\n\n  var createSidebar = function (spec) {\n    return asRaw('sidebar', sidebarSchema, spec);\n  };\n\n  var setup$8 = function (editor) {\n    var sidebars = editor.ui.registry.getAll().sidebars;\n    each$1(keys(sidebars), function (name) {\n      var spec = sidebars[name];\n\n      var isActive = function () {\n        return is$1(Optional.from(editor.queryCommandValue('ToggleSidebar')), name);\n      };\n\n      editor.ui.registry.addToggleButton(name, {\n        icon: spec.icon,\n        tooltip: spec.tooltip,\n        onAction: function (buttonApi) {\n          editor.execCommand('ToggleSidebar', false, name);\n          buttonApi.setActive(isActive());\n        },\n        onSetup: function (buttonApi) {\n          var handleToggle = function () {\n            return buttonApi.setActive(isActive());\n          };\n\n          editor.on('ToggleSidebar', handleToggle);\n          return function () {\n            editor.off('ToggleSidebar', handleToggle);\n          };\n        }\n      });\n    });\n  };\n\n  var getApi = function (comp) {\n    return {\n      element: function () {\n        return comp.element.dom;\n      }\n    };\n  };\n\n  var makePanels = function (parts, panelConfigs) {\n    var specs = map$2(keys(panelConfigs), function (name) {\n      var spec = panelConfigs[name];\n      var bridged = getOrDie(createSidebar(spec));\n      return {\n        name: name,\n        getApi: getApi,\n        onSetup: bridged.onSetup,\n        onShow: bridged.onShow,\n        onHide: bridged.onHide\n      };\n    });\n    return map$2(specs, function (spec) {\n      var editorOffCell = Cell(noop);\n      return parts.slot(spec.name, {\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar__pane']\n        },\n        behaviours: SimpleBehaviours.unnamedEvents([onControlAttached(spec, editorOffCell), onControlDetached(spec, editorOffCell), run$1(slotVisibility(), function (sidepanel, se) {\n          var data = se.event;\n          var optSidePanelSpec = find$5(specs, function (config) {\n            return config.name === data.name;\n          });\n          optSidePanelSpec.each(function (sidePanelSpec) {\n            var handler = data.visible ? sidePanelSpec.onShow : sidePanelSpec.onHide;\n            handler(sidePanelSpec.getApi(sidepanel));\n          });\n        })])\n      });\n    });\n  };\n\n  var makeSidebar = function (panelConfigs) {\n    return SlotContainer.sketch(function (parts) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar__pane-container']\n        },\n        components: makePanels(parts, panelConfigs),\n        slotBehaviours: SimpleBehaviours.unnamedEvents([runOnAttached(function (slotContainer) {\n          return SlotContainer.hideAllSlots(slotContainer);\n        })])\n      };\n    });\n  };\n\n  var setSidebar = function (sidebar, panelConfigs) {\n    var optSlider = Composing.getCurrent(sidebar);\n    optSlider.each(function (slider) {\n      return Replacing.set(slider, [makeSidebar(panelConfigs)]);\n    });\n  };\n\n  var toggleSidebar = function (sidebar, name) {\n    var optSlider = Composing.getCurrent(sidebar);\n    optSlider.each(function (slider) {\n      var optSlotContainer = Composing.getCurrent(slider);\n      optSlotContainer.each(function (slotContainer) {\n        if (Sliding.hasGrown(slider)) {\n          if (SlotContainer.isShowing(slotContainer, name)) {\n            Sliding.shrink(slider);\n          } else {\n            SlotContainer.hideAllSlots(slotContainer);\n            SlotContainer.showSlot(slotContainer, name);\n          }\n        } else {\n          SlotContainer.hideAllSlots(slotContainer);\n          SlotContainer.showSlot(slotContainer, name);\n          Sliding.grow(slider);\n        }\n      });\n    });\n  };\n\n  var whichSidebar = function (sidebar) {\n    var optSlider = Composing.getCurrent(sidebar);\n    return optSlider.bind(function (slider) {\n      var sidebarOpen = Sliding.isGrowing(slider) || Sliding.hasGrown(slider);\n\n      if (sidebarOpen) {\n        var optSlotContainer = Composing.getCurrent(slider);\n        return optSlotContainer.bind(function (slotContainer) {\n          return find$5(SlotContainer.getSlotNames(slotContainer), function (name) {\n            return SlotContainer.isShowing(slotContainer, name);\n          });\n        });\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var fixSize = generate$6('FixSizeEvent');\n  var autoSize = generate$6('AutoSizeEvent');\n\n  var renderSidebar = function (spec) {\n    return {\n      uid: spec.uid,\n      dom: {\n        tag: 'div',\n        classes: ['tox-sidebar'],\n        attributes: {\n          role: 'complementary'\n        }\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar__slider']\n        },\n        components: [],\n        behaviours: derive$1([Tabstopping.config({}), Focusing.config({}), Sliding.config({\n          dimension: {\n            property: 'width'\n          },\n          closedClass: 'tox-sidebar--sliding-closed',\n          openClass: 'tox-sidebar--sliding-open',\n          shrinkingClass: 'tox-sidebar--sliding-shrinking',\n          growingClass: 'tox-sidebar--sliding-growing',\n          onShrunk: function (slider) {\n            var optSlotContainer = Composing.getCurrent(slider);\n            optSlotContainer.each(SlotContainer.hideAllSlots);\n            emit(slider, autoSize);\n          },\n          onGrown: function (slider) {\n            emit(slider, autoSize);\n          },\n          onStartGrow: function (slider) {\n            emitWith(slider, fixSize, {\n              width: getRaw(slider.element, 'width').getOr('')\n            });\n          },\n          onStartShrink: function (slider) {\n            emitWith(slider, fixSize, {\n              width: get$a(slider.element) + 'px'\n            });\n          }\n        }), Replacing.config({}), Composing.config({\n          find: function (comp) {\n            var children = Replacing.contents(comp);\n            return head(children);\n          }\n        })])\n      }],\n      behaviours: derive$1([ComposingConfigs.childAt(0), config('sidebar-sliding-events', [run$1(fixSize, function (comp, se) {\n        set$7(comp.element, 'width', se.event.width);\n      }), run$1(autoSize, function (comp, _se) {\n        remove$6(comp.element, 'width');\n      })])])\n    };\n  };\n\n  var block = function (component, config, state, getBusySpec) {\n    set$8(component.element, 'aria-busy', true);\n    var root = config.getRoot(component).getOr(component);\n    var blockerBehaviours = derive$1([Keying.config({\n      mode: 'special',\n      onTab: function () {\n        return Optional.some(true);\n      },\n      onShiftTab: function () {\n        return Optional.some(true);\n      }\n    }), Focusing.config({})]);\n    var blockSpec = getBusySpec(root, blockerBehaviours);\n    var blocker = root.getSystem().build(blockSpec);\n    Replacing.append(root, premade(blocker));\n\n    if (blocker.hasConfigured(Keying) && config.focus) {\n      Keying.focusIn(blocker);\n    }\n\n    if (!state.isBlocked()) {\n      config.onBlock(component);\n    }\n\n    state.blockWith(function () {\n      return Replacing.remove(root, blocker);\n    });\n  };\n\n  var unblock = function (component, config, state) {\n    remove$7(component.element, 'aria-busy');\n\n    if (state.isBlocked()) {\n      config.onUnblock(component);\n    }\n\n    state.clear();\n  };\n\n  var BlockingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    block: block,\n    unblock: unblock\n  });\n  var BlockingSchema = [defaultedFunction('getRoot', Optional.none), defaultedBoolean('focus', true), onHandler('onBlock'), onHandler('onUnblock')];\n\n  var init$4 = function () {\n    var blocker = destroyable();\n\n    var blockWith = function (destroy) {\n      blocker.set({\n        destroy: destroy\n      });\n    };\n\n    return nu$8({\n      readState: blocker.isSet,\n      blockWith: blockWith,\n      clear: blocker.clear,\n      isBlocked: blocker.isSet\n    });\n  };\n\n  var BlockingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$4\n  });\n  var Blocking = create$7({\n    fields: BlockingSchema,\n    name: 'blocking',\n    apis: BlockingApis,\n    state: BlockingState\n  });\n\n  var getAttrs = function (elem) {\n    var attributes = elem.dom.attributes !== undefined ? elem.dom.attributes : [];\n    return foldl(attributes, function (b, attr) {\n      var _a;\n\n      if (attr.name === 'class') {\n        return b;\n      } else {\n        return __assign(__assign({}, b), (_a = {}, _a[attr.name] = attr.value, _a));\n      }\n    }, {});\n  };\n\n  var getClasses = function (elem) {\n    return Array.prototype.slice.call(elem.dom.classList, 0);\n  };\n\n  var fromHtml = function (html) {\n    var elem = SugarElement.fromHtml(html);\n    var children$1 = children(elem);\n    var attrs = getAttrs(elem);\n    var classes = getClasses(elem);\n    var contents = children$1.length === 0 ? {} : {\n      innerHtml: get$7(elem)\n    };\n    return __assign({\n      tag: name$2(elem),\n      classes: classes,\n      attributes: attrs\n    }, contents);\n  };\n\n  var getBusySpec$1 = function (providerBackstage) {\n    return function (_root, _behaviours) {\n      return {\n        dom: {\n          tag: 'div',\n          attributes: {\n            'aria-label': providerBackstage.translate('Loading...'),\n            'tabindex': '0'\n          },\n          classes: ['tox-throbber__busy-spinner']\n        },\n        components: [{\n          dom: fromHtml('<div class=\"tox-spinner\"><div></div><div></div><div></div></div>')\n        }]\n      };\n    };\n  };\n\n  var focusBusyComponent = function (throbber) {\n    return Composing.getCurrent(throbber).each(function (comp) {\n      return focus$3(comp.element);\n    });\n  };\n\n  var toggleEditorTabIndex = function (editor, state) {\n    var tabIndexAttr = 'tabindex';\n    var dataTabIndexAttr = 'data-mce-' + tabIndexAttr;\n    Optional.from(editor.iframeElement).map(SugarElement.fromDom).each(function (iframe) {\n      if (state) {\n        getOpt(iframe, tabIndexAttr).each(function (tabIndex) {\n          return set$8(iframe, dataTabIndexAttr, tabIndex);\n        });\n        set$8(iframe, tabIndexAttr, -1);\n      } else {\n        remove$7(iframe, tabIndexAttr);\n        getOpt(iframe, dataTabIndexAttr).each(function (tabIndex) {\n          set$8(iframe, tabIndexAttr, tabIndex);\n          remove$7(iframe, dataTabIndexAttr);\n        });\n      }\n    });\n  };\n\n  var toggleThrobber = function (editor, comp, state, providerBackstage) {\n    var element = comp.element;\n    toggleEditorTabIndex(editor, state);\n\n    if (state) {\n      Blocking.block(comp, getBusySpec$1(providerBackstage));\n      remove$6(element, 'display');\n      remove$7(element, 'aria-hidden');\n\n      if (editor.hasFocus()) {\n        focusBusyComponent(comp);\n      }\n    } else {\n      var throbberFocus = Composing.getCurrent(comp).exists(function (busyComp) {\n        return hasFocus(busyComp.element);\n      });\n      Blocking.unblock(comp);\n      set$7(element, 'display', 'none');\n      set$8(element, 'aria-hidden', 'true');\n\n      if (throbberFocus) {\n        editor.focus();\n      }\n    }\n  };\n\n  var renderThrobber = function (spec) {\n    return {\n      uid: spec.uid,\n      dom: {\n        tag: 'div',\n        attributes: {\n          'aria-hidden': 'true'\n        },\n        classes: ['tox-throbber'],\n        styles: {\n          display: 'none'\n        }\n      },\n      behaviours: derive$1([Replacing.config({}), Blocking.config({\n        focus: false\n      }), Composing.config({\n        find: function (comp) {\n          return head(comp.components());\n        }\n      })]),\n      components: []\n    };\n  };\n\n  var isFocusEvent = function (event) {\n    return event.type === 'focusin';\n  };\n\n  var isPasteBinTarget = function (event) {\n    if (isFocusEvent(event)) {\n      var node = event.composed ? head(event.composedPath()) : Optional.from(event.target);\n      return node.map(SugarElement.fromDom).filter(isElement$2).exists(function (targetElm) {\n        return has(targetElm, 'mce-pastebin');\n      });\n    } else {\n      return false;\n    }\n  };\n\n  var setup$7 = function (editor, lazyThrobber, sharedBackstage) {\n    var throbberState = Cell(false);\n    var timer = value$1();\n\n    var stealFocus = function (e) {\n      if (throbberState.get() && !isPasteBinTarget(e)) {\n        e.preventDefault();\n        focusBusyComponent(lazyThrobber());\n        editor.editorManager.setActive(editor);\n      }\n    };\n\n    if (!editor.inline) {\n      editor.on('PreInit', function () {\n        editor.dom.bind(editor.getWin(), 'focusin', stealFocus);\n        editor.on('BeforeExecCommand', function (e) {\n          if (e.command.toLowerCase() === 'mcefocus' && e.value !== true) {\n            stealFocus(e);\n          }\n        });\n      });\n    }\n\n    var toggle = function (state) {\n      if (state !== throbberState.get()) {\n        throbberState.set(state);\n        toggleThrobber(editor, lazyThrobber(), state, sharedBackstage.providers);\n        editor.fire('AfterProgressState', {\n          state: state\n        });\n      }\n    };\n\n    editor.on('ProgressState', function (e) {\n      timer.on(global$f.clearTimeout);\n\n      if (isNumber(e.time)) {\n        var timerId = global$f.setEditorTimeout(editor, function () {\n          return toggle(e.state);\n        }, e.time);\n        timer.set(timerId);\n      } else {\n        toggle(e.state);\n        timer.clear();\n      }\n    });\n  };\n\n  var generate$1 = function (xs, f) {\n    var init = {\n      len: 0,\n      list: []\n    };\n    var r = foldl(xs, function (b, a) {\n      var value = f(a, b.len);\n      return value.fold(constant$1(b), function (v) {\n        return {\n          len: v.finish,\n          list: b.list.concat([v])\n        };\n      });\n    }, init);\n    return r.list;\n  };\n\n  var output = function (within, extra, withinWidth) {\n    return {\n      within: within,\n      extra: extra,\n      withinWidth: withinWidth\n    };\n  };\n\n  var apportion = function (units, total, len) {\n    var parray = generate$1(units, function (unit, current) {\n      var width = len(unit);\n      return Optional.some({\n        element: unit,\n        start: current,\n        finish: current + width,\n        width: width\n      });\n    });\n    var within = filter$2(parray, function (unit) {\n      return unit.finish <= total;\n    });\n    var withinWidth = foldr(within, function (acc, el) {\n      return acc + el.width;\n    }, 0);\n    var extra = parray.slice(within.length);\n    return {\n      within: within,\n      extra: extra,\n      withinWidth: withinWidth\n    };\n  };\n\n  var toUnit = function (parray) {\n    return map$2(parray, function (unit) {\n      return unit.element;\n    });\n  };\n\n  var fitLast = function (within, extra, withinWidth) {\n    var fits = toUnit(within.concat(extra));\n    return output(fits, [], withinWidth);\n  };\n\n  var overflow = function (within, extra, overflower, withinWidth) {\n    var fits = toUnit(within).concat([overflower]);\n    return output(fits, toUnit(extra), withinWidth);\n  };\n\n  var fitAll = function (within, extra, withinWidth) {\n    return output(toUnit(within), [], withinWidth);\n  };\n\n  var tryFit = function (total, units, len) {\n    var divide = apportion(units, total, len);\n    return divide.extra.length === 0 ? Optional.some(divide) : Optional.none();\n  };\n\n  var partition = function (total, units, len, overflower) {\n    var divide = tryFit(total, units, len).getOrThunk(function () {\n      return apportion(units, total - len(overflower), len);\n    });\n    var within = divide.within;\n    var extra = divide.extra;\n    var withinWidth = divide.withinWidth;\n\n    if (extra.length === 1 && extra[0].width <= len(overflower)) {\n      return fitLast(within, extra, withinWidth);\n    } else if (extra.length >= 1) {\n      return overflow(within, extra, overflower, withinWidth);\n    } else {\n      return fitAll(within, extra, withinWidth);\n    }\n  };\n\n  var setGroups$1 = function (toolbar, storedGroups) {\n    var bGroups = map$2(storedGroups, function (g) {\n      return premade(g);\n    });\n    Toolbar.setGroups(toolbar, bGroups);\n  };\n\n  var findFocusedComp = function (comps) {\n    return findMap(comps, function (comp) {\n      return search(comp.element).bind(function (focusedElm) {\n        return comp.getSystem().getByDom(focusedElm).toOptional();\n      });\n    });\n  };\n\n  var refresh$2 = function (toolbar, detail, setOverflow) {\n    var builtGroups = detail.builtGroups.get();\n\n    if (builtGroups.length === 0) {\n      return;\n    }\n\n    var primary = getPartOrDie(toolbar, detail, 'primary');\n    var overflowGroup = Coupling.getCoupled(toolbar, 'overflowGroup');\n    set$7(primary.element, 'visibility', 'hidden');\n    var groups = builtGroups.concat([overflowGroup]);\n    var focusedComp = findFocusedComp(groups);\n    setOverflow([]);\n    setGroups$1(primary, groups);\n    var availableWidth = get$a(primary.element);\n    var overflows = partition(availableWidth, detail.builtGroups.get(), function (comp) {\n      return get$a(comp.element);\n    }, overflowGroup);\n\n    if (overflows.extra.length === 0) {\n      Replacing.remove(primary, overflowGroup);\n      setOverflow([]);\n    } else {\n      setGroups$1(primary, overflows.within);\n      setOverflow(overflows.extra);\n    }\n\n    remove$6(primary.element, 'visibility');\n    reflow(primary.element);\n    focusedComp.each(Focusing.focus);\n  };\n\n  var schema$c = constant$1([field('splitToolbarBehaviours', [Coupling]), customField('builtGroups', function () {\n    return Cell([]);\n  })]);\n  var schema$b = constant$1([markers$1(['overflowToggledClass']), optionFunction('getOverflowBounds'), required$1('lazySink'), customField('overflowGroups', function () {\n    return Cell([]);\n  })].concat(schema$c()));\n  var parts$7 = constant$1([required({\n    factory: Toolbar,\n    schema: schema$e(),\n    name: 'primary'\n  }), external$1({\n    schema: schema$e(),\n    name: 'overflow'\n  }), external$1({\n    name: 'overflow-button'\n  }), external$1({\n    name: 'overflow-group'\n  })]);\n  var expandable = constant$1(function (element, available) {\n    setMax(element, Math.floor(available));\n  });\n  var schema$a = constant$1([markers$1(['toggledClass']), required$1('lazySink'), requiredFunction('fetch'), optionFunction('getBounds'), optionObjOf('fireDismissalEventInstead', [defaulted('event', dismissRequested())]), schema$y()]);\n  var parts$6 = constant$1([external$1({\n    name: 'button',\n    overrides: function (detail) {\n      return {\n        dom: {\n          attributes: {\n            'aria-haspopup': 'true'\n          }\n        },\n        buttonBehaviours: derive$1([Toggling.config({\n          toggleClass: detail.markers.toggledClass,\n          aria: {\n            mode: 'expanded'\n          },\n          toggleOnExecute: false\n        })])\n      };\n    }\n  }), external$1({\n    factory: Toolbar,\n    schema: schema$e(),\n    name: 'toolbar',\n    overrides: function (detail) {\n      return {\n        toolbarBehaviours: derive$1([Keying.config({\n          mode: 'cyclic',\n          onEscape: function (comp) {\n            getPart(comp, detail, 'button').each(Focusing.focus);\n            return Optional.none();\n          }\n        })])\n      };\n    }\n  })]);\n\n  var toggle = function (button, externals) {\n    var toolbarSandbox = Coupling.getCoupled(button, 'toolbarSandbox');\n\n    if (Sandboxing.isOpen(toolbarSandbox)) {\n      Sandboxing.close(toolbarSandbox);\n    } else {\n      Sandboxing.open(toolbarSandbox, externals.toolbar());\n    }\n  };\n\n  var position = function (button, toolbar, detail, layouts) {\n    var bounds = detail.getBounds.map(function (bounder) {\n      return bounder();\n    });\n    var sink = detail.lazySink(button).getOrDie();\n    Positioning.positionWithinBounds(sink, toolbar, {\n      anchor: {\n        type: 'hotspot',\n        hotspot: button,\n        layouts: layouts,\n        overrides: {\n          maxWidthFunction: expandable()\n        }\n      }\n    }, bounds);\n  };\n\n  var setGroups = function (button, toolbar, detail, layouts, groups) {\n    Toolbar.setGroups(toolbar, groups);\n    position(button, toolbar, detail, layouts);\n    Toggling.on(button);\n  };\n\n  var makeSandbox = function (button, spec, detail) {\n    var ariaOwner = manager();\n\n    var onOpen = function (sandbox, toolbar) {\n      detail.fetch().get(function (groups) {\n        setGroups(button, toolbar, detail, spec.layouts, groups);\n        ariaOwner.link(button.element);\n        Keying.focusIn(toolbar);\n      });\n    };\n\n    var onClose = function () {\n      Toggling.off(button);\n      Focusing.focus(button);\n      ariaOwner.unlink(button.element);\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        attributes: {\n          id: ariaOwner.id\n        }\n      },\n      behaviours: derive$1([Keying.config({\n        mode: 'special',\n        onEscape: function (comp) {\n          Sandboxing.close(comp);\n          return Optional.some(true);\n        }\n      }), Sandboxing.config({\n        onOpen: onOpen,\n        onClose: onClose,\n        isPartOf: function (container, data, queryElem) {\n          return isPartOf$1(data, queryElem) || isPartOf$1(button, queryElem);\n        },\n        getAttachPoint: function () {\n          return detail.lazySink(button).getOrDie();\n        }\n      }), Receiving.config({\n        channels: __assign(__assign({}, receivingChannel$1(__assign({\n          isExtraPart: never\n        }, detail.fireDismissalEventInstead.map(function (fe) {\n          return {\n            fireEventInstead: {\n              event: fe.event\n            }\n          };\n        }).getOr({})))), receivingChannel({\n          doReposition: function () {\n            Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n              position(button, toolbar, detail, spec.layouts);\n            });\n          }\n        }))\n      })])\n    };\n  };\n\n  var factory$a = function (detail, components, spec, externals) {\n    return __assign(__assign({}, Button.sketch(__assign(__assign({}, externals.button()), {\n      action: function (button) {\n        toggle(button, externals);\n      },\n      buttonBehaviours: SketchBehaviours.augment({\n        dump: externals.button().buttonBehaviours\n      }, [Coupling.config({\n        others: {\n          toolbarSandbox: function (button) {\n            return makeSandbox(button, spec, detail);\n          }\n        }\n      })])\n    }))), {\n      apis: {\n        setGroups: function (button, groups) {\n          Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n            setGroups(button, toolbar, detail, spec.layouts, groups);\n          });\n        },\n        reposition: function (button) {\n          Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n            position(button, toolbar, detail, spec.layouts);\n          });\n        },\n        toggle: function (button) {\n          toggle(button, externals);\n        },\n        getToolbar: function (button) {\n          return Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox'));\n        },\n        isOpen: function (button) {\n          return Sandboxing.isOpen(Coupling.getCoupled(button, 'toolbarSandbox'));\n        }\n      }\n    });\n  };\n\n  var FloatingToolbarButton = composite({\n    name: 'FloatingToolbarButton',\n    factory: factory$a,\n    configFields: schema$a(),\n    partFields: parts$6(),\n    apis: {\n      setGroups: function (apis, button, groups) {\n        apis.setGroups(button, groups);\n      },\n      reposition: function (apis, button) {\n        apis.reposition(button);\n      },\n      toggle: function (apis, button) {\n        apis.toggle(button);\n      },\n      getToolbar: function (apis, button) {\n        return apis.getToolbar(button);\n      },\n      isOpen: function (apis, button) {\n        return apis.isOpen(button);\n      }\n    }\n  });\n  var schema$9 = constant$1([required$1('items'), markers$1(['itemSelector']), field('tgroupBehaviours', [Keying])]);\n  var parts$5 = constant$1([group({\n    name: 'items',\n    unit: 'item'\n  })]);\n\n  var factory$9 = function (detail, components, _spec, _externals) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.tgroupBehaviours, [Keying.config({\n        mode: 'flow',\n        selector: detail.markers.itemSelector\n      })]),\n      domModification: {\n        attributes: {\n          role: 'toolbar'\n        }\n      }\n    };\n  };\n\n  var ToolbarGroup = composite({\n    name: 'ToolbarGroup',\n    configFields: schema$9(),\n    partFields: parts$5(),\n    factory: factory$9\n  });\n\n  var buildGroups = function (comps) {\n    return map$2(comps, function (g) {\n      return premade(g);\n    });\n  };\n\n  var refresh$1 = function (toolbar, memFloatingToolbarButton, detail) {\n    refresh$2(toolbar, detail, function (overflowGroups) {\n      detail.overflowGroups.set(overflowGroups);\n      memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n        FloatingToolbarButton.setGroups(floatingToolbarButton, buildGroups(overflowGroups));\n      });\n    });\n  };\n\n  var factory$8 = function (detail, components, spec, externals) {\n    var memFloatingToolbarButton = record(FloatingToolbarButton.sketch({\n      fetch: function () {\n        return Future.nu(function (resolve) {\n          resolve(buildGroups(detail.overflowGroups.get()));\n        });\n      },\n      layouts: {\n        onLtr: function () {\n          return [southwest$2, southeast$2];\n        },\n        onRtl: function () {\n          return [southeast$2, southwest$2];\n        },\n        onBottomLtr: function () {\n          return [northwest$2, northeast$2];\n        },\n        onBottomRtl: function () {\n          return [northeast$2, northwest$2];\n        }\n      },\n      getBounds: spec.getOverflowBounds,\n      lazySink: detail.lazySink,\n      fireDismissalEventInstead: {},\n      markers: {\n        toggledClass: detail.markers.overflowToggledClass\n      },\n      parts: {\n        button: externals['overflow-button'](),\n        toolbar: externals.overflow()\n      }\n    }));\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.splitToolbarBehaviours, [Coupling.config({\n        others: {\n          overflowGroup: function () {\n            return ToolbarGroup.sketch(__assign(__assign({}, externals['overflow-group']()), {\n              items: [memFloatingToolbarButton.asSpec()]\n            }));\n          }\n        }\n      })]),\n      apis: {\n        setGroups: function (toolbar, groups) {\n          detail.builtGroups.set(map$2(groups, toolbar.getSystem().build));\n          refresh$1(toolbar, memFloatingToolbarButton, detail);\n        },\n        refresh: function (toolbar) {\n          return refresh$1(toolbar, memFloatingToolbarButton, detail);\n        },\n        toggle: function (toolbar) {\n          memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n            FloatingToolbarButton.toggle(floatingToolbarButton);\n          });\n        },\n        isOpen: function (toolbar) {\n          return memFloatingToolbarButton.getOpt(toolbar).map(FloatingToolbarButton.isOpen).getOr(false);\n        },\n        reposition: function (toolbar) {\n          memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n            FloatingToolbarButton.reposition(floatingToolbarButton);\n          });\n        },\n        getOverflow: function (toolbar) {\n          return memFloatingToolbarButton.getOpt(toolbar).bind(FloatingToolbarButton.getToolbar);\n        }\n      },\n      domModification: {\n        attributes: {\n          role: 'group'\n        }\n      }\n    };\n  };\n\n  var SplitFloatingToolbar = composite({\n    name: 'SplitFloatingToolbar',\n    configFields: schema$b(),\n    partFields: parts$7(),\n    factory: factory$8,\n    apis: {\n      setGroups: function (apis, toolbar, groups) {\n        apis.setGroups(toolbar, groups);\n      },\n      refresh: function (apis, toolbar) {\n        apis.refresh(toolbar);\n      },\n      reposition: function (apis, toolbar) {\n        apis.reposition(toolbar);\n      },\n      toggle: function (apis, toolbar) {\n        apis.toggle(toolbar);\n      },\n      isOpen: function (apis, toolbar) {\n        return apis.isOpen(toolbar);\n      },\n      getOverflow: function (apis, toolbar) {\n        return apis.getOverflow(toolbar);\n      }\n    }\n  });\n  var schema$8 = constant$1([markers$1(['closedClass', 'openClass', 'shrinkingClass', 'growingClass', 'overflowToggledClass']), onHandler('onOpened'), onHandler('onClosed')].concat(schema$c()));\n  var parts$4 = constant$1([required({\n    factory: Toolbar,\n    schema: schema$e(),\n    name: 'primary'\n  }), required({\n    factory: Toolbar,\n    schema: schema$e(),\n    name: 'overflow',\n    overrides: function (detail) {\n      return {\n        toolbarBehaviours: derive$1([Sliding.config({\n          dimension: {\n            property: 'height'\n          },\n          closedClass: detail.markers.closedClass,\n          openClass: detail.markers.openClass,\n          shrinkingClass: detail.markers.shrinkingClass,\n          growingClass: detail.markers.growingClass,\n          onShrunk: function (comp) {\n            getPart(comp, detail, 'overflow-button').each(function (button) {\n              Toggling.off(button);\n              Focusing.focus(button);\n            });\n            detail.onClosed(comp);\n          },\n          onGrown: function (comp) {\n            Keying.focusIn(comp);\n            detail.onOpened(comp);\n          },\n          onStartGrow: function (comp) {\n            getPart(comp, detail, 'overflow-button').each(Toggling.on);\n          }\n        }), Keying.config({\n          mode: 'acyclic',\n          onEscape: function (comp) {\n            getPart(comp, detail, 'overflow-button').each(Focusing.focus);\n            return Optional.some(true);\n          }\n        })])\n      };\n    }\n  }), external$1({\n    name: 'overflow-button',\n    overrides: function (detail) {\n      return {\n        buttonBehaviours: derive$1([Toggling.config({\n          toggleClass: detail.markers.overflowToggledClass,\n          aria: {\n            mode: 'pressed'\n          },\n          toggleOnExecute: false\n        })])\n      };\n    }\n  }), external$1({\n    name: 'overflow-group'\n  })]);\n\n  var isOpen = function (toolbar, detail) {\n    return getPart(toolbar, detail, 'overflow').map(Sliding.hasGrown).getOr(false);\n  };\n\n  var toggleToolbar = function (toolbar, detail) {\n    getPart(toolbar, detail, 'overflow-button').bind(function () {\n      return getPart(toolbar, detail, 'overflow');\n    }).each(function (overf) {\n      refresh(toolbar, detail);\n      Sliding.toggleGrow(overf);\n    });\n  };\n\n  var refresh = function (toolbar, detail) {\n    getPart(toolbar, detail, 'overflow').each(function (overflow) {\n      refresh$2(toolbar, detail, function (groups) {\n        var builtGroups = map$2(groups, function (g) {\n          return premade(g);\n        });\n        Toolbar.setGroups(overflow, builtGroups);\n      });\n      getPart(toolbar, detail, 'overflow-button').each(function (button) {\n        if (Sliding.hasGrown(overflow)) {\n          Toggling.on(button);\n        }\n      });\n      Sliding.refresh(overflow);\n    });\n  };\n\n  var factory$7 = function (detail, components, spec, externals) {\n    var toolbarToggleEvent = 'alloy.toolbar.toggle';\n\n    var doSetGroups = function (toolbar, groups) {\n      var built = map$2(groups, toolbar.getSystem().build);\n      detail.builtGroups.set(built);\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.splitToolbarBehaviours, [Coupling.config({\n        others: {\n          overflowGroup: function (toolbar) {\n            return ToolbarGroup.sketch(__assign(__assign({}, externals['overflow-group']()), {\n              items: [Button.sketch(__assign(__assign({}, externals['overflow-button']()), {\n                action: function (_button) {\n                  emit(toolbar, toolbarToggleEvent);\n                }\n              }))]\n            }));\n          }\n        }\n      }), config('toolbar-toggle-events', [run$1(toolbarToggleEvent, function (toolbar) {\n        toggleToolbar(toolbar, detail);\n      })])]),\n      apis: {\n        setGroups: function (toolbar, groups) {\n          doSetGroups(toolbar, groups);\n          refresh(toolbar, detail);\n        },\n        refresh: function (toolbar) {\n          return refresh(toolbar, detail);\n        },\n        toggle: function (toolbar) {\n          return toggleToolbar(toolbar, detail);\n        },\n        isOpen: function (toolbar) {\n          return isOpen(toolbar, detail);\n        }\n      },\n      domModification: {\n        attributes: {\n          role: 'group'\n        }\n      }\n    };\n  };\n\n  var SplitSlidingToolbar = composite({\n    name: 'SplitSlidingToolbar',\n    configFields: schema$8(),\n    partFields: parts$4(),\n    factory: factory$7,\n    apis: {\n      setGroups: function (apis, toolbar, groups) {\n        apis.setGroups(toolbar, groups);\n      },\n      refresh: function (apis, toolbar) {\n        apis.refresh(toolbar);\n      },\n      toggle: function (apis, toolbar) {\n        apis.toggle(toolbar);\n      },\n      isOpen: function (apis, toolbar) {\n        return apis.isOpen(toolbar);\n      }\n    }\n  });\n\n  var renderToolbarGroupCommon = function (toolbarGroup) {\n    var attributes = toolbarGroup.title.fold(function () {\n      return {};\n    }, function (title) {\n      return {\n        attributes: {\n          title: title\n        }\n      };\n    });\n    return {\n      dom: __assign({\n        tag: 'div',\n        classes: ['tox-toolbar__group']\n      }, attributes),\n      components: [ToolbarGroup.parts.items({})],\n      items: toolbarGroup.items,\n      markers: {\n        itemSelector: '*:not(.tox-split-button) > .tox-tbtn:not([disabled]), ' + '.tox-split-button:not([disabled]), ' + '.tox-toolbar-nav-js:not([disabled])'\n      },\n      tgroupBehaviours: derive$1([Tabstopping.config({}), Focusing.config({})])\n    };\n  };\n\n  var renderToolbarGroup = function (toolbarGroup) {\n    return ToolbarGroup.sketch(renderToolbarGroupCommon(toolbarGroup));\n  };\n\n  var getToolbarbehaviours = function (toolbarSpec, modeName) {\n    var onAttached = runOnAttached(function (component) {\n      var groups = map$2(toolbarSpec.initGroups, renderToolbarGroup);\n      Toolbar.setGroups(component, groups);\n    });\n    return derive$1([DisablingConfigs.toolbarButton(toolbarSpec.providers.isDisabled), receivingConfig(), Keying.config({\n      mode: modeName,\n      onEscape: toolbarSpec.onEscape,\n      selector: '.tox-toolbar__group'\n    }), config('toolbar-events', [onAttached])]);\n  };\n\n  var renderMoreToolbarCommon = function (toolbarSpec) {\n    var modeName = toolbarSpec.cyclicKeying ? 'cyclic' : 'acyclic';\n    return {\n      uid: toolbarSpec.uid,\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar-overlord']\n      },\n      parts: {\n        'overflow-group': renderToolbarGroupCommon({\n          title: Optional.none(),\n          items: []\n        }),\n        'overflow-button': renderIconButtonSpec({\n          name: 'more',\n          icon: Optional.some('more-drawer'),\n          disabled: false,\n          tooltip: Optional.some('More...'),\n          primary: false,\n          borderless: false\n        }, Optional.none(), toolbarSpec.providers)\n      },\n      splitToolbarBehaviours: getToolbarbehaviours(toolbarSpec, modeName)\n    };\n  };\n\n  var renderFloatingMoreToolbar = function (toolbarSpec) {\n    var baseSpec = renderMoreToolbarCommon(toolbarSpec);\n    var overflowXOffset = 4;\n    var primary = SplitFloatingToolbar.parts.primary({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar__primary']\n      }\n    });\n    return SplitFloatingToolbar.sketch(__assign(__assign({}, baseSpec), {\n      lazySink: toolbarSpec.getSink,\n      getOverflowBounds: function () {\n        var headerElem = toolbarSpec.moreDrawerData.lazyHeader().element;\n        var headerBounds = absolute$2(headerElem);\n        var docElem = documentElement(headerElem);\n        var docBounds = absolute$2(docElem);\n        var height = Math.max(docElem.dom.scrollHeight, docBounds.height);\n        return bounds(headerBounds.x + overflowXOffset, docBounds.y, headerBounds.width - overflowXOffset * 2, height);\n      },\n      parts: __assign(__assign({}, baseSpec.parts), {\n        overflow: {\n          dom: {\n            tag: 'div',\n            classes: ['tox-toolbar__overflow'],\n            attributes: toolbarSpec.attributes\n          }\n        }\n      }),\n      components: [primary],\n      markers: {\n        overflowToggledClass: 'tox-tbtn--enabled'\n      }\n    }));\n  };\n\n  var renderSlidingMoreToolbar = function (toolbarSpec) {\n    var primary = SplitSlidingToolbar.parts.primary({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar__primary']\n      }\n    });\n    var overflow = SplitSlidingToolbar.parts.overflow({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar__overflow']\n      }\n    });\n    var baseSpec = renderMoreToolbarCommon(toolbarSpec);\n    return SplitSlidingToolbar.sketch(__assign(__assign({}, baseSpec), {\n      components: [primary, overflow],\n      markers: {\n        openClass: 'tox-toolbar__overflow--open',\n        closedClass: 'tox-toolbar__overflow--closed',\n        growingClass: 'tox-toolbar__overflow--growing',\n        shrinkingClass: 'tox-toolbar__overflow--shrinking',\n        overflowToggledClass: 'tox-tbtn--enabled'\n      },\n      onOpened: function (comp) {\n        comp.getSystem().broadcastOn([toolbarHeightChange()], {\n          type: 'opened'\n        });\n      },\n      onClosed: function (comp) {\n        comp.getSystem().broadcastOn([toolbarHeightChange()], {\n          type: 'closed'\n        });\n      }\n    }));\n  };\n\n  var renderToolbar = function (toolbarSpec) {\n    var modeName = toolbarSpec.cyclicKeying ? 'cyclic' : 'acyclic';\n    return Toolbar.sketch({\n      uid: toolbarSpec.uid,\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar'].concat(toolbarSpec.type === ToolbarMode.scrolling ? ['tox-toolbar--scrolling'] : [])\n      },\n      components: [Toolbar.parts.groups({})],\n      toolbarBehaviours: getToolbarbehaviours(toolbarSpec, modeName)\n    });\n  };\n\n  var factory$6 = function (detail, components, _spec) {\n    var apis = {\n      getSocket: function (comp) {\n        return parts$a.getPart(comp, detail, 'socket');\n      },\n      setSidebar: function (comp, panelConfigs) {\n        parts$a.getPart(comp, detail, 'sidebar').each(function (sidebar) {\n          return setSidebar(sidebar, panelConfigs);\n        });\n      },\n      toggleSidebar: function (comp, name) {\n        parts$a.getPart(comp, detail, 'sidebar').each(function (sidebar) {\n          return toggleSidebar(sidebar, name);\n        });\n      },\n      whichSidebar: function (comp) {\n        return parts$a.getPart(comp, detail, 'sidebar').bind(whichSidebar).getOrNull();\n      },\n      getHeader: function (comp) {\n        return parts$a.getPart(comp, detail, 'header');\n      },\n      getToolbar: function (comp) {\n        return parts$a.getPart(comp, detail, 'toolbar');\n      },\n      setToolbar: function (comp, groups) {\n        parts$a.getPart(comp, detail, 'toolbar').each(function (toolbar) {\n          toolbar.getApis().setGroups(toolbar, groups);\n        });\n      },\n      setToolbars: function (comp, toolbars) {\n        parts$a.getPart(comp, detail, 'multiple-toolbar').each(function (mToolbar) {\n          CustomList.setItems(mToolbar, toolbars);\n        });\n      },\n      refreshToolbar: function (comp) {\n        var toolbar = parts$a.getPart(comp, detail, 'toolbar');\n        toolbar.each(function (toolbar) {\n          return toolbar.getApis().refresh(toolbar);\n        });\n      },\n      toggleToolbarDrawer: function (comp) {\n        parts$a.getPart(comp, detail, 'toolbar').each(function (toolbar) {\n          mapFrom(toolbar.getApis().toggle, function (toggle) {\n            return toggle(toolbar);\n          });\n        });\n      },\n      isToolbarDrawerToggled: function (comp) {\n        return parts$a.getPart(comp, detail, 'toolbar').bind(function (toolbar) {\n          return Optional.from(toolbar.getApis().isOpen).map(function (isOpen) {\n            return isOpen(toolbar);\n          });\n        }).getOr(false);\n      },\n      getThrobber: function (comp) {\n        return parts$a.getPart(comp, detail, 'throbber');\n      },\n      focusToolbar: function (comp) {\n        var optToolbar = parts$a.getPart(comp, detail, 'toolbar').orThunk(function () {\n          return parts$a.getPart(comp, detail, 'multiple-toolbar');\n        });\n        optToolbar.each(function (toolbar) {\n          Keying.focusIn(toolbar);\n        });\n      },\n      setMenubar: function (comp, menus) {\n        parts$a.getPart(comp, detail, 'menubar').each(function (menubar) {\n          SilverMenubar.setMenus(menubar, menus);\n        });\n      },\n      focusMenubar: function (comp) {\n        parts$a.getPart(comp, detail, 'menubar').each(function (menubar) {\n          SilverMenubar.focus(menubar);\n        });\n      }\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      apis: apis,\n      behaviours: detail.behaviours\n    };\n  };\n\n  var partMenubar = partType.optional({\n    factory: SilverMenubar,\n    name: 'menubar',\n    schema: [required$1('backstage')]\n  });\n\n  var toolbarFactory = function (spec) {\n    if (spec.type === ToolbarMode.sliding) {\n      return renderSlidingMoreToolbar;\n    } else if (spec.type === ToolbarMode.floating) {\n      return renderFloatingMoreToolbar;\n    } else {\n      return renderToolbar;\n    }\n  };\n\n  var partMultipleToolbar = partType.optional({\n    factory: {\n      sketch: function (spec) {\n        return CustomList.sketch({\n          uid: spec.uid,\n          dom: spec.dom,\n          listBehaviours: derive$1([Keying.config({\n            mode: 'acyclic',\n            selector: '.tox-toolbar'\n          })]),\n          makeItem: function () {\n            return renderToolbar({\n              type: spec.type,\n              uid: generate$6('multiple-toolbar-item'),\n              cyclicKeying: false,\n              initGroups: [],\n              providers: spec.providers,\n              onEscape: function () {\n                spec.onEscape();\n                return Optional.some(true);\n              }\n            });\n          },\n          setupItem: function (_mToolbar, tc, data, _index) {\n            Toolbar.setGroups(tc, data);\n          },\n          shell: true\n        });\n      }\n    },\n    name: 'multiple-toolbar',\n    schema: [required$1('dom'), required$1('onEscape')]\n  });\n  var partToolbar = partType.optional({\n    factory: {\n      sketch: function (spec) {\n        var renderer = toolbarFactory(spec);\n        var toolbarSpec = {\n          type: spec.type,\n          uid: spec.uid,\n          onEscape: function () {\n            spec.onEscape();\n            return Optional.some(true);\n          },\n          cyclicKeying: false,\n          initGroups: [],\n          getSink: spec.getSink,\n          providers: spec.providers,\n          moreDrawerData: {\n            lazyToolbar: spec.lazyToolbar,\n            lazyMoreButton: spec.lazyMoreButton,\n            lazyHeader: spec.lazyHeader\n          },\n          attributes: spec.attributes\n        };\n        return renderer(toolbarSpec);\n      }\n    },\n    name: 'toolbar',\n    schema: [required$1('dom'), required$1('onEscape'), required$1('getSink')]\n  });\n  var partHeader = partType.optional({\n    factory: {\n      sketch: renderHeader\n    },\n    name: 'header',\n    schema: [required$1('dom')]\n  });\n  var partSocket = partType.optional({\n    name: 'socket',\n    schema: [required$1('dom')]\n  });\n  var partSidebar = partType.optional({\n    factory: {\n      sketch: renderSidebar\n    },\n    name: 'sidebar',\n    schema: [required$1('dom')]\n  });\n  var partThrobber = partType.optional({\n    factory: {\n      sketch: renderThrobber\n    },\n    name: 'throbber',\n    schema: [required$1('dom')]\n  });\n  var OuterContainer = composite({\n    name: 'OuterContainer',\n    factory: factory$6,\n    configFields: [required$1('dom'), required$1('behaviours')],\n    partFields: [partHeader, partMenubar, partToolbar, partMultipleToolbar, partSocket, partSidebar, partThrobber],\n    apis: {\n      getSocket: function (apis, comp) {\n        return apis.getSocket(comp);\n      },\n      setSidebar: function (apis, comp, panelConfigs) {\n        apis.setSidebar(comp, panelConfigs);\n      },\n      toggleSidebar: function (apis, comp, name) {\n        apis.toggleSidebar(comp, name);\n      },\n      whichSidebar: function (apis, comp) {\n        return apis.whichSidebar(comp);\n      },\n      getHeader: function (apis, comp) {\n        return apis.getHeader(comp);\n      },\n      getToolbar: function (apis, comp) {\n        return apis.getToolbar(comp);\n      },\n      setToolbar: function (apis, comp, grps) {\n        var groups = map$2(grps, function (grp) {\n          return renderToolbarGroup(grp);\n        });\n        apis.setToolbar(comp, groups);\n      },\n      setToolbars: function (apis, comp, ts) {\n        var renderedToolbars = map$2(ts, function (g) {\n          return map$2(g, renderToolbarGroup);\n        });\n        apis.setToolbars(comp, renderedToolbars);\n      },\n      refreshToolbar: function (apis, comp) {\n        return apis.refreshToolbar(comp);\n      },\n      toggleToolbarDrawer: function (apis, comp) {\n        apis.toggleToolbarDrawer(comp);\n      },\n      isToolbarDrawerToggled: function (apis, comp) {\n        return apis.isToolbarDrawerToggled(comp);\n      },\n      getThrobber: function (apis, comp) {\n        return apis.getThrobber(comp);\n      },\n      setMenubar: function (apis, comp, menus) {\n        apis.setMenubar(comp, menus);\n      },\n      focusMenubar: function (apis, comp) {\n        apis.focusMenubar(comp);\n      },\n      focusToolbar: function (apis, comp) {\n        apis.focusToolbar(comp);\n      }\n    }\n  });\n  var defaultMenubar = 'file edit view insert format tools table help';\n  var defaultMenus = {\n    file: {\n      title: 'File',\n      items: 'newdocument restoredraft | preview | export print | deleteallconversations'\n    },\n    edit: {\n      title: 'Edit',\n      items: 'undo redo | cut copy paste pastetext | selectall | searchreplace'\n    },\n    view: {\n      title: 'View',\n      items: 'code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments'\n    },\n    insert: {\n      title: 'Insert',\n      items: 'image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime'\n    },\n    format: {\n      title: 'Format',\n      items: 'bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | language | removeformat'\n    },\n    tools: {\n      title: 'Tools',\n      items: 'spellchecker spellcheckerlanguage | a11ycheck code wordcount'\n    },\n    table: {\n      title: 'Table',\n      items: 'inserttable | cell row column | advtablesort | tableprops deletetable'\n    },\n    help: {\n      title: 'Help',\n      items: 'help'\n    }\n  };\n\n  var make = function (menu, registry, editor) {\n    var removedMenuItems = getRemovedMenuItems(editor).split(/[ ,]/);\n    return {\n      text: menu.title,\n      getItems: function () {\n        return bind$3(menu.items, function (i) {\n          var itemName = i.toLowerCase();\n\n          if (itemName.trim().length === 0) {\n            return [];\n          } else if (exists(removedMenuItems, function (removedMenuItem) {\n            return removedMenuItem === itemName;\n          })) {\n            return [];\n          } else if (itemName === 'separator' || itemName === '|') {\n            return [{\n              type: 'separator'\n            }];\n          } else if (registry.menuItems[itemName]) {\n            return [registry.menuItems[itemName]];\n          } else {\n            return [];\n          }\n        });\n      }\n    };\n  };\n\n  var parseItemsString = function (items) {\n    if (typeof items === 'string') {\n      return items.split(' ');\n    }\n\n    return items;\n  };\n\n  var identifyMenus = function (editor, registry) {\n    var rawMenuData = __assign(__assign({}, defaultMenus), registry.menus);\n\n    var userDefinedMenus = keys(registry.menus).length > 0;\n    var menubar = registry.menubar === undefined || registry.menubar === true ? parseItemsString(defaultMenubar) : parseItemsString(registry.menubar === false ? '' : registry.menubar);\n    var validMenus = filter$2(menubar, function (menuName) {\n      var isDefaultMenu = has$2(defaultMenus, menuName);\n\n      if (userDefinedMenus) {\n        return isDefaultMenu || get$e(registry.menus, menuName).exists(function (menu) {\n          return has$2(menu, 'items');\n        });\n      } else {\n        return isDefaultMenu;\n      }\n    });\n    var menus = map$2(validMenus, function (menuName) {\n      var menuData = rawMenuData[menuName];\n      return make({\n        title: menuData.title,\n        items: parseItemsString(menuData.items)\n      }, registry, editor);\n    });\n    return filter$2(menus, function (menu) {\n      var isNotSeparator = function (item) {\n        return item.type !== 'separator';\n      };\n\n      return menu.getItems().length > 0 && exists(menu.getItems(), isNotSeparator);\n    });\n  };\n\n  var fireSkinLoaded = function (editor) {\n    var done = function () {\n      editor._skinLoaded = true;\n      fireSkinLoaded$1(editor);\n    };\n\n    return function () {\n      if (editor.initialized) {\n        done();\n      } else {\n        editor.on('init', done);\n      }\n    };\n  };\n\n  var fireSkinLoadError = function (editor, err) {\n    return function () {\n      return fireSkinLoadError$1(editor, {\n        message: err\n      });\n    };\n  };\n\n  var loadStylesheet = function (editor, stylesheetUrl, styleSheetLoader) {\n    return new global$c(function (resolve, reject) {\n      styleSheetLoader.load(stylesheetUrl, resolve, reject);\n      editor.on('remove', function () {\n        return styleSheetLoader.unload(stylesheetUrl);\n      });\n    });\n  };\n\n  var loadUiSkins = function (editor, skinUrl) {\n    var skinUiCss = skinUrl + '/skin.min.css';\n    return loadStylesheet(editor, skinUiCss, editor.ui.styleSheetLoader);\n  };\n\n  var loadShadowDomUiSkins = function (editor, skinUrl) {\n    var isInShadowRoot$1 = isInShadowRoot(SugarElement.fromDom(editor.getElement()));\n\n    if (isInShadowRoot$1) {\n      var shadowDomSkinCss = skinUrl + '/skin.shadowdom.min.css';\n      return loadStylesheet(editor, shadowDomSkinCss, global$b.DOM.styleSheetLoader);\n    } else {\n      return global$c.resolve();\n    }\n  };\n\n  var loadSkin = function (isInline, editor) {\n    var skinUrl = getSkinUrl(editor);\n\n    if (skinUrl) {\n      editor.contentCSS.push(skinUrl + (isInline ? '/content.inline' : '/content') + '.min.css');\n    }\n\n    if (isSkinDisabled(editor) === false && isString(skinUrl)) {\n      global$c.all([loadUiSkins(editor, skinUrl), loadShadowDomUiSkins(editor, skinUrl)]).then(fireSkinLoaded(editor), fireSkinLoadError(editor, 'Skin could not be loaded'));\n    } else {\n      fireSkinLoaded(editor)();\n    }\n  };\n\n  var iframe = curry(loadSkin, false);\n  var inline = curry(loadSkin, true);\n\n  var onSetupFormatToggle = function (editor, name) {\n    return function (api) {\n      var boundCallback = unbindable();\n\n      var init = function () {\n        api.setActive(editor.formatter.match(name));\n        var binding = editor.formatter.formatChanged(name, api.setActive);\n        boundCallback.set(binding);\n      };\n\n      editor.initialized ? init() : editor.once('init', init);\n      return function () {\n        editor.off('init', init);\n        boundCallback.clear();\n      };\n    };\n  };\n\n  var onSetupEvent = function (editor, event, f) {\n    return function (api) {\n      var handleEvent = function () {\n        return f(api);\n      };\n\n      var init = function () {\n        f(api);\n        editor.on(event, handleEvent);\n      };\n\n      editor.initialized ? init() : editor.once('init', init);\n      return function () {\n        editor.off('init', init);\n        editor.off(event, handleEvent);\n      };\n    };\n  };\n\n  var onActionToggleFormat$1 = function (editor) {\n    return function (rawItem) {\n      return function () {\n        editor.undoManager.transact(function () {\n          editor.focus();\n          editor.execCommand('mceToggleFormat', false, rawItem.format);\n        });\n      };\n    };\n  };\n\n  var onActionExecCommand = function (editor, command) {\n    return function () {\n      return editor.execCommand(command);\n    };\n  };\n\n  var generateSelectItems = function (_editor, backstage, spec) {\n    var generateItem = function (rawItem, response, disabled, value) {\n      var translatedText = backstage.shared.providers.translate(rawItem.title);\n\n      if (rawItem.type === 'separator') {\n        return Optional.some({\n          type: 'separator',\n          text: translatedText\n        });\n      } else if (rawItem.type === 'submenu') {\n        var items = bind$3(rawItem.getStyleItems(), function (si) {\n          return validate(si, response, value);\n        });\n\n        if (response === 0 && items.length <= 0) {\n          return Optional.none();\n        } else {\n          return Optional.some({\n            type: 'nestedmenuitem',\n            text: translatedText,\n            disabled: items.length <= 0,\n            getSubmenuItems: function () {\n              return bind$3(rawItem.getStyleItems(), function (si) {\n                return validate(si, response, value);\n              });\n            }\n          });\n        }\n      } else {\n        return Optional.some(__assign({\n          type: 'togglemenuitem',\n          text: translatedText,\n          icon: rawItem.icon,\n          active: rawItem.isSelected(value),\n          disabled: disabled,\n          onAction: spec.onAction(rawItem)\n        }, rawItem.getStylePreview().fold(function () {\n          return {};\n        }, function (preview) {\n          return {\n            meta: {\n              style: preview\n            }\n          };\n        })));\n      }\n    };\n\n    var validate = function (item, response, value) {\n      var invalid = item.type === 'formatter' && spec.isInvalid(item);\n\n      if (response === 0) {\n        return invalid ? [] : generateItem(item, response, false, value).toArray();\n      } else {\n        return generateItem(item, response, invalid, value).toArray();\n      }\n    };\n\n    var validateItems = function (preItems) {\n      var value = spec.getCurrentValue();\n      var response = spec.shouldHide ? 0 : 1;\n      return bind$3(preItems, function (item) {\n        return validate(item, response, value);\n      });\n    };\n\n    var getFetch = function (backstage, getStyleItems) {\n      return function (comp, callback) {\n        var preItems = getStyleItems();\n        var items = validateItems(preItems);\n        var menu = build(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false);\n        callback(menu);\n      };\n    };\n\n    return {\n      validateItems: validateItems,\n      getFetch: getFetch\n    };\n  };\n\n  var createMenuItems = function (editor, backstage, spec) {\n    var dataset = spec.dataset;\n    var getStyleItems = dataset.type === 'basic' ? function () {\n      return map$2(dataset.data, function (d) {\n        return processBasic(d, spec.isSelectedFor, spec.getPreviewFor);\n      });\n    } : dataset.getData;\n    return {\n      items: generateSelectItems(editor, backstage, spec),\n      getStyleItems: getStyleItems\n    };\n  };\n\n  var createSelectButton = function (editor, backstage, spec) {\n    var _a = createMenuItems(editor, backstage, spec),\n        items = _a.items,\n        getStyleItems = _a.getStyleItems;\n\n    var getApi = function (comp) {\n      return {\n        getComponent: constant$1(comp)\n      };\n    };\n\n    var onSetup = onSetupEvent(editor, 'NodeChange', function (api) {\n      var comp = api.getComponent();\n      spec.updateText(comp);\n    });\n    return renderCommonDropdown({\n      text: spec.icon.isSome() ? Optional.none() : spec.text,\n      icon: spec.icon,\n      tooltip: Optional.from(spec.tooltip),\n      role: Optional.none(),\n      fetch: items.getFetch(backstage, getStyleItems),\n      onSetup: onSetup,\n      getApi: getApi,\n      columns: 1,\n      presets: 'normal',\n      classes: spec.icon.isSome() ? [] : ['bespoke'],\n      dropdownBehaviours: []\n    }, 'tox-tbtn', backstage.shared);\n  };\n\n  var process = function (rawFormats) {\n    return map$2(rawFormats, function (item) {\n      var title = item,\n          format = item;\n      var values = item.split('=');\n\n      if (values.length > 1) {\n        title = values[0];\n        format = values[1];\n      }\n\n      return {\n        title: title,\n        format: format\n      };\n    });\n  };\n\n  var buildBasicStaticDataset = function (data) {\n    return {\n      type: 'basic',\n      data: data\n    };\n  };\n\n  var Delimiter;\n\n  (function (Delimiter) {\n    Delimiter[Delimiter['SemiColon'] = 0] = 'SemiColon';\n    Delimiter[Delimiter['Space'] = 1] = 'Space';\n  })(Delimiter || (Delimiter = {}));\n\n  var split = function (rawFormats, delimiter) {\n    if (delimiter === Delimiter.SemiColon) {\n      return rawFormats.replace(/;$/, '').split(';');\n    } else {\n      return rawFormats.split(' ');\n    }\n  };\n\n  var buildBasicSettingsDataset = function (editor, settingName, defaults, delimiter) {\n    var rawFormats = editor.getParam(settingName, defaults, 'string');\n    var data = process(split(rawFormats, delimiter));\n    return {\n      type: 'basic',\n      data: data\n    };\n  };\n\n  var alignMenuItems = [{\n    title: 'Left',\n    icon: 'align-left',\n    format: 'alignleft',\n    command: 'JustifyLeft'\n  }, {\n    title: 'Center',\n    icon: 'align-center',\n    format: 'aligncenter',\n    command: 'JustifyCenter'\n  }, {\n    title: 'Right',\n    icon: 'align-right',\n    format: 'alignright',\n    command: 'JustifyRight'\n  }, {\n    title: 'Justify',\n    icon: 'align-justify',\n    format: 'alignjustify',\n    command: 'JustifyFull'\n  }];\n\n  var getSpec$4 = function (editor) {\n    var getMatchingValue = function () {\n      return find$5(alignMenuItems, function (item) {\n        return editor.formatter.match(item.format);\n      });\n    };\n\n    var isSelectedFor = function (format) {\n      return function () {\n        return editor.formatter.match(format);\n      };\n    };\n\n    var getPreviewFor = function (_format) {\n      return Optional.none;\n    };\n\n    var updateSelectMenuIcon = function (comp) {\n      var match = getMatchingValue();\n      var alignment = match.fold(constant$1('left'), function (item) {\n        return item.title.toLowerCase();\n      });\n      emitWith(comp, updateMenuIcon, {\n        icon: 'align-' + alignment\n      });\n    };\n\n    var dataset = buildBasicStaticDataset(alignMenuItems);\n\n    var onAction = function (rawItem) {\n      return function () {\n        return find$5(alignMenuItems, function (item) {\n          return item.format === rawItem.format;\n        }).each(function (item) {\n          return editor.execCommand(item.command);\n        });\n      };\n    };\n\n    return {\n      tooltip: 'Align',\n      text: Optional.none(),\n      icon: Optional.some('align-left'),\n      isSelectedFor: isSelectedFor,\n      getCurrentValue: Optional.none,\n      getPreviewFor: getPreviewFor,\n      onAction: onAction,\n      updateText: updateSelectMenuIcon,\n      dataset: dataset,\n      shouldHide: false,\n      isInvalid: function (item) {\n        return !editor.formatter.canApply(item.format);\n      }\n    };\n  };\n\n  var createAlignSelect = function (editor, backstage) {\n    return createSelectButton(editor, backstage, getSpec$4(editor));\n  };\n\n  var alignSelectMenu = function (editor, backstage) {\n    var menuItems = createMenuItems(editor, backstage, getSpec$4(editor));\n    editor.ui.registry.addNestedMenuItem('align', {\n      text: backstage.shared.providers.translate('Align'),\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var defaultFontsFormats = 'Andale Mono=andale mono,monospace;' + 'Arial=arial,helvetica,sans-serif;' + 'Arial Black=arial black,sans-serif;' + 'Book Antiqua=book antiqua,palatino,serif;' + 'Comic Sans MS=comic sans ms,sans-serif;' + 'Courier New=courier new,courier,monospace;' + 'Georgia=georgia,palatino,serif;' + 'Helvetica=helvetica,arial,sans-serif;' + 'Impact=impact,sans-serif;' + 'Symbol=symbol;' + 'Tahoma=tahoma,arial,helvetica,sans-serif;' + 'Terminal=terminal,monaco,monospace;' + 'Times New Roman=times new roman,times,serif;' + 'Trebuchet MS=trebuchet ms,geneva,sans-serif;' + 'Verdana=verdana,geneva,sans-serif;' + 'Webdings=webdings;' + 'Wingdings=wingdings,zapf dingbats';\n  var systemStackFonts = ['-apple-system', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'sans-serif'];\n\n  var splitFonts = function (fontFamily) {\n    var fonts = fontFamily.split(/\\s*,\\s*/);\n    return map$2(fonts, function (font) {\n      return font.replace(/^['\"]+|['\"]+$/g, '');\n    });\n  };\n\n  var isSystemFontStack = function (fontFamily) {\n    var matchesSystemStack = function () {\n      var fonts = splitFonts(fontFamily.toLowerCase());\n      return forall(systemStackFonts, function (font) {\n        return fonts.indexOf(font.toLowerCase()) > -1;\n      });\n    };\n\n    return fontFamily.indexOf('-apple-system') === 0 && matchesSystemStack();\n  };\n\n  var getSpec$3 = function (editor) {\n    var systemFont = 'System Font';\n\n    var getMatchingValue = function () {\n      var getFirstFont = function (fontFamily) {\n        return fontFamily ? splitFonts(fontFamily)[0] : '';\n      };\n\n      var fontFamily = editor.queryCommandValue('FontName');\n      var items = dataset.data;\n      var font = fontFamily ? fontFamily.toLowerCase() : '';\n      var matchOpt = find$5(items, function (item) {\n        var format = item.format;\n        return format.toLowerCase() === font || getFirstFont(format).toLowerCase() === getFirstFont(font).toLowerCase();\n      }).orThunk(function () {\n        return someIf(isSystemFontStack(font), {\n          title: systemFont,\n          format: font\n        });\n      });\n      return {\n        matchOpt: matchOpt,\n        font: fontFamily\n      };\n    };\n\n    var isSelectedFor = function (item) {\n      return function (valueOpt) {\n        return valueOpt.exists(function (value) {\n          return value.format === item;\n        });\n      };\n    };\n\n    var getCurrentValue = function () {\n      var matchOpt = getMatchingValue().matchOpt;\n      return matchOpt;\n    };\n\n    var getPreviewFor = function (item) {\n      return function () {\n        return Optional.some({\n          tag: 'div',\n          styles: item.indexOf('dings') === -1 ? {\n            'font-family': item\n          } : {}\n        });\n      };\n    };\n\n    var onAction = function (rawItem) {\n      return function () {\n        editor.undoManager.transact(function () {\n          editor.focus();\n          editor.execCommand('FontName', false, rawItem.format);\n        });\n      };\n    };\n\n    var updateSelectMenuText = function (comp) {\n      var _a = getMatchingValue(),\n          matchOpt = _a.matchOpt,\n          font = _a.font;\n\n      var text = matchOpt.fold(constant$1(font), function (item) {\n        return item.title;\n      });\n      emitWith(comp, updateMenuText, {\n        text: text\n      });\n    };\n\n    var dataset = buildBasicSettingsDataset(editor, 'font_formats', defaultFontsFormats, Delimiter.SemiColon);\n    return {\n      tooltip: 'Fonts',\n      text: Optional.some(systemFont),\n      icon: Optional.none(),\n      isSelectedFor: isSelectedFor,\n      getCurrentValue: getCurrentValue,\n      getPreviewFor: getPreviewFor,\n      onAction: onAction,\n      updateText: updateSelectMenuText,\n      dataset: dataset,\n      shouldHide: false,\n      isInvalid: never\n    };\n  };\n\n  var createFontSelect = function (editor, backstage) {\n    return createSelectButton(editor, backstage, getSpec$3(editor));\n  };\n\n  var fontSelectMenu = function (editor, backstage) {\n    var menuItems = createMenuItems(editor, backstage, getSpec$3(editor));\n    editor.ui.registry.addNestedMenuItem('fontformats', {\n      text: backstage.shared.providers.translate('Fonts'),\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var defaultFontsizeFormats = '8pt 10pt 12pt 14pt 18pt 24pt 36pt';\n  var legacyFontSizes = {\n    '8pt': '1',\n    '10pt': '2',\n    '12pt': '3',\n    '14pt': '4',\n    '18pt': '5',\n    '24pt': '6',\n    '36pt': '7'\n  };\n  var keywordFontSizes = {\n    'xx-small': '7pt',\n    'x-small': '8pt',\n    'small': '10pt',\n    'medium': '12pt',\n    'large': '14pt',\n    'x-large': '18pt',\n    'xx-large': '24pt'\n  };\n\n  var round = function (number, precision) {\n    var factor = Math.pow(10, precision);\n    return Math.round(number * factor) / factor;\n  };\n\n  var toPt = function (fontSize, precision) {\n    if (/[0-9.]+px$/.test(fontSize)) {\n      return round(parseInt(fontSize, 10) * 72 / 96, precision || 0) + 'pt';\n    } else {\n      return get$e(keywordFontSizes, fontSize).getOr(fontSize);\n    }\n  };\n\n  var toLegacy = function (fontSize) {\n    return get$e(legacyFontSizes, fontSize).getOr('');\n  };\n\n  var getSpec$2 = function (editor) {\n    var getMatchingValue = function () {\n      var matchOpt = Optional.none();\n      var items = dataset.data;\n      var fontSize = editor.queryCommandValue('FontSize');\n\n      if (fontSize) {\n        var _loop_1 = function (precision) {\n          var pt = toPt(fontSize, precision);\n          var legacy = toLegacy(pt);\n          matchOpt = find$5(items, function (item) {\n            return item.format === fontSize || item.format === pt || item.format === legacy;\n          });\n        };\n\n        for (var precision = 3; matchOpt.isNone() && precision >= 0; precision--) {\n          _loop_1(precision);\n        }\n      }\n\n      return {\n        matchOpt: matchOpt,\n        size: fontSize\n      };\n    };\n\n    var isSelectedFor = function (item) {\n      return function (valueOpt) {\n        return valueOpt.exists(function (value) {\n          return value.format === item;\n        });\n      };\n    };\n\n    var getCurrentValue = function () {\n      var matchOpt = getMatchingValue().matchOpt;\n      return matchOpt;\n    };\n\n    var getPreviewFor = constant$1(Optional.none);\n\n    var onAction = function (rawItem) {\n      return function () {\n        editor.undoManager.transact(function () {\n          editor.focus();\n          editor.execCommand('FontSize', false, rawItem.format);\n        });\n      };\n    };\n\n    var updateSelectMenuText = function (comp) {\n      var _a = getMatchingValue(),\n          matchOpt = _a.matchOpt,\n          size = _a.size;\n\n      var text = matchOpt.fold(constant$1(size), function (match) {\n        return match.title;\n      });\n      emitWith(comp, updateMenuText, {\n        text: text\n      });\n    };\n\n    var dataset = buildBasicSettingsDataset(editor, 'fontsize_formats', defaultFontsizeFormats, Delimiter.Space);\n    return {\n      tooltip: 'Font sizes',\n      text: Optional.some('12pt'),\n      icon: Optional.none(),\n      isSelectedFor: isSelectedFor,\n      getPreviewFor: getPreviewFor,\n      getCurrentValue: getCurrentValue,\n      onAction: onAction,\n      updateText: updateSelectMenuText,\n      dataset: dataset,\n      shouldHide: false,\n      isInvalid: never\n    };\n  };\n\n  var createFontsizeSelect = function (editor, backstage) {\n    return createSelectButton(editor, backstage, getSpec$2(editor));\n  };\n\n  var fontsizeSelectMenu = function (editor, backstage) {\n    var menuItems = createMenuItems(editor, backstage, getSpec$2(editor));\n    editor.ui.registry.addNestedMenuItem('fontsizes', {\n      text: 'Font sizes',\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var findNearest = function (editor, getStyles) {\n    var styles = getStyles();\n    var formats = map$2(styles, function (style) {\n      return style.format;\n    });\n    return Optional.from(editor.formatter.closest(formats)).bind(function (fmt) {\n      return find$5(styles, function (data) {\n        return data.format === fmt;\n      });\n    }).orThunk(function () {\n      return someIf(editor.formatter.match('p'), {\n        title: 'Paragraph',\n        format: 'p'\n      });\n    });\n  };\n\n  var defaultBlocks = 'Paragraph=p;' + 'Heading 1=h1;' + 'Heading 2=h2;' + 'Heading 3=h3;' + 'Heading 4=h4;' + 'Heading 5=h5;' + 'Heading 6=h6;' + 'Preformatted=pre';\n\n  var getSpec$1 = function (editor) {\n    var fallbackFormat = 'Paragraph';\n\n    var isSelectedFor = function (format) {\n      return function () {\n        return editor.formatter.match(format);\n      };\n    };\n\n    var getPreviewFor = function (format) {\n      return function () {\n        var fmt = editor.formatter.get(format);\n        return Optional.some({\n          tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n          styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n        });\n      };\n    };\n\n    var updateSelectMenuText = function (comp) {\n      var detectedFormat = findNearest(editor, function () {\n        return dataset.data;\n      });\n      var text = detectedFormat.fold(constant$1(fallbackFormat), function (fmt) {\n        return fmt.title;\n      });\n      emitWith(comp, updateMenuText, {\n        text: text\n      });\n    };\n\n    var dataset = buildBasicSettingsDataset(editor, 'block_formats', defaultBlocks, Delimiter.SemiColon);\n    return {\n      tooltip: 'Blocks',\n      text: Optional.some(fallbackFormat),\n      icon: Optional.none(),\n      isSelectedFor: isSelectedFor,\n      getCurrentValue: Optional.none,\n      getPreviewFor: getPreviewFor,\n      onAction: onActionToggleFormat$1(editor),\n      updateText: updateSelectMenuText,\n      dataset: dataset,\n      shouldHide: false,\n      isInvalid: function (item) {\n        return !editor.formatter.canApply(item.format);\n      }\n    };\n  };\n\n  var createFormatSelect = function (editor, backstage) {\n    return createSelectButton(editor, backstage, getSpec$1(editor));\n  };\n\n  var formatSelectMenu = function (editor, backstage) {\n    var menuItems = createMenuItems(editor, backstage, getSpec$1(editor));\n    editor.ui.registry.addNestedMenuItem('blockformats', {\n      text: 'Blocks',\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var getSpec = function (editor, dataset) {\n    var fallbackFormat = 'Paragraph';\n\n    var isSelectedFor = function (format) {\n      return function () {\n        return editor.formatter.match(format);\n      };\n    };\n\n    var getPreviewFor = function (format) {\n      return function () {\n        var fmt = editor.formatter.get(format);\n        return fmt !== undefined ? Optional.some({\n          tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n          styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n        }) : Optional.none();\n      };\n    };\n\n    var updateSelectMenuText = function (comp) {\n      var getFormatItems = function (fmt) {\n        var subs = fmt.items;\n        return subs !== undefined && subs.length > 0 ? bind$3(subs, getFormatItems) : [{\n          title: fmt.title,\n          format: fmt.format\n        }];\n      };\n\n      var flattenedItems = bind$3(getStyleFormats(editor), getFormatItems);\n      var detectedFormat = findNearest(editor, constant$1(flattenedItems));\n      var text = detectedFormat.fold(constant$1(fallbackFormat), function (fmt) {\n        return fmt.title;\n      });\n      emitWith(comp, updateMenuText, {\n        text: text\n      });\n    };\n\n    return {\n      tooltip: 'Formats',\n      text: Optional.some(fallbackFormat),\n      icon: Optional.none(),\n      isSelectedFor: isSelectedFor,\n      getCurrentValue: Optional.none,\n      getPreviewFor: getPreviewFor,\n      onAction: onActionToggleFormat$1(editor),\n      updateText: updateSelectMenuText,\n      shouldHide: editor.getParam('style_formats_autohide', false, 'boolean'),\n      isInvalid: function (item) {\n        return !editor.formatter.canApply(item.format);\n      },\n      dataset: dataset\n    };\n  };\n\n  var createStyleSelect = function (editor, backstage) {\n    var dataset = __assign({\n      type: 'advanced'\n    }, backstage.styleselect);\n\n    return createSelectButton(editor, backstage, getSpec(editor, dataset));\n  };\n\n  var styleSelectMenu = function (editor, backstage) {\n    var dataset = __assign({\n      type: 'advanced'\n    }, backstage.styleselect);\n\n    var menuItems = createMenuItems(editor, backstage, getSpec(editor, dataset));\n    editor.ui.registry.addNestedMenuItem('formats', {\n      text: 'Formats',\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var events$3 = function (reflectingConfig, reflectingState) {\n    var update = function (component, data) {\n      reflectingConfig.updateState.each(function (updateState) {\n        var newState = updateState(component, data);\n        reflectingState.set(newState);\n      });\n      reflectingConfig.renderComponents.each(function (renderComponents) {\n        var newComponents = renderComponents(data, reflectingState.get());\n        var newChildren = map$2(newComponents, component.getSystem().build);\n        replaceChildren(component, newChildren);\n      });\n    };\n\n    return derive$2([run$1(receive(), function (component, message) {\n      var receivingData = message;\n\n      if (!receivingData.universal) {\n        var channel = reflectingConfig.channel;\n\n        if (contains$2(receivingData.channels, channel)) {\n          update(component, receivingData.data);\n        }\n      }\n    }), runOnAttached(function (comp, _se) {\n      reflectingConfig.initialData.each(function (rawData) {\n        update(comp, rawData);\n      });\n    })]);\n  };\n\n  var ActiveReflecting = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$3\n  });\n\n  var getState = function (component, replaceConfig, reflectState) {\n    return reflectState;\n  };\n\n  var ReflectingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getState: getState\n  });\n  var ReflectingSchema = [required$1('channel'), option('renderComponents'), option('updateState'), option('initialData')];\n\n  var init$3 = function () {\n    var cell = Cell(Optional.none());\n\n    var clear = function () {\n      return cell.set(Optional.none());\n    };\n\n    var readState = function () {\n      return cell.get().getOr('none');\n    };\n\n    return {\n      readState: readState,\n      get: cell.get,\n      set: cell.set,\n      clear: clear\n    };\n  };\n\n  var ReflectingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$3\n  });\n  var Reflecting = create$7({\n    fields: ReflectingSchema,\n    name: 'reflecting',\n    active: ActiveReflecting,\n    apis: ReflectingApis,\n    state: ReflectingState\n  });\n  var schema$7 = constant$1([required$1('toggleClass'), required$1('fetch'), onStrictHandler('onExecute'), defaulted('getHotspot', Optional.some), defaulted('getAnchorOverrides', constant$1({})), schema$y(), onStrictHandler('onItemExecute'), option('lazySink'), required$1('dom'), onHandler('onOpen'), field('splitDropdownBehaviours', [Coupling, Keying, Focusing]), defaulted('matchWidth', false), defaulted('useMinWidth', false), defaulted('eventOrder', {}), option('role')].concat(sandboxFields()));\n  var arrowPart = required({\n    factory: Button,\n    schema: [required$1('dom')],\n    name: 'arrow',\n    defaults: function () {\n      return {\n        buttonBehaviours: derive$1([Focusing.revoke()])\n      };\n    },\n    overrides: function (detail) {\n      return {\n        dom: {\n          tag: 'span',\n          attributes: {\n            role: 'presentation'\n          }\n        },\n        action: function (arrow) {\n          arrow.getSystem().getByUid(detail.uid).each(emitExecute);\n        },\n        buttonBehaviours: derive$1([Toggling.config({\n          toggleOnExecute: false,\n          toggleClass: detail.toggleClass\n        })])\n      };\n    }\n  });\n  var buttonPart = required({\n    factory: Button,\n    schema: [required$1('dom')],\n    name: 'button',\n    defaults: function () {\n      return {\n        buttonBehaviours: derive$1([Focusing.revoke()])\n      };\n    },\n    overrides: function (detail) {\n      return {\n        dom: {\n          tag: 'span',\n          attributes: {\n            role: 'presentation'\n          }\n        },\n        action: function (btn) {\n          btn.getSystem().getByUid(detail.uid).each(function (splitDropdown) {\n            detail.onExecute(splitDropdown, btn);\n          });\n        }\n      };\n    }\n  });\n  var parts$3 = constant$1([arrowPart, buttonPart, optional({\n    factory: {\n      sketch: function (spec) {\n        return {\n          uid: spec.uid,\n          dom: {\n            tag: 'span',\n            styles: {\n              display: 'none'\n            },\n            attributes: {\n              'aria-hidden': 'true'\n            },\n            innerHtml: spec.text\n          }\n        };\n      }\n    },\n    schema: [required$1('text')],\n    name: 'aria-descriptor'\n  }), external$1({\n    schema: [tieredMenuMarkers()],\n    name: 'menu',\n    defaults: function (detail) {\n      return {\n        onExecute: function (tmenu, item) {\n          tmenu.getSystem().getByUid(detail.uid).each(function (splitDropdown) {\n            detail.onItemExecute(splitDropdown, tmenu, item);\n          });\n        }\n      };\n    }\n  }), partType$1()]);\n\n  var factory$5 = function (detail, components, spec, externals) {\n    var _a;\n\n    var switchToMenu = function (sandbox) {\n      Composing.getCurrent(sandbox).each(function (current) {\n        Highlighting.highlightFirst(current);\n        Keying.focusIn(current);\n      });\n    };\n\n    var action = function (component) {\n      var onOpenSync = switchToMenu;\n      togglePopup(detail, identity$1, component, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n    };\n\n    var openMenu = function (comp) {\n      action(comp);\n      return Optional.some(true);\n    };\n\n    var executeOnButton = function (comp) {\n      var button = getPartOrDie(comp, detail, 'button');\n      emitExecute(button);\n      return Optional.some(true);\n    };\n\n    var buttonEvents = __assign(__assign({}, derive$2([runOnAttached(function (component, _simulatedEvent) {\n      var ariaDescriptor = getPart(component, detail, 'aria-descriptor');\n      ariaDescriptor.each(function (descriptor) {\n        var descriptorId = generate$6('aria');\n        set$8(descriptor.element, 'id', descriptorId);\n        set$8(component.element, 'aria-describedby', descriptorId);\n      });\n    })])), events$a(Optional.some(action)));\n\n    var apis = {\n      repositionMenus: function (comp) {\n        if (Toggling.isOn(comp)) {\n          repositionMenus(comp);\n        }\n      }\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      apis: apis,\n      eventOrder: __assign(__assign({}, detail.eventOrder), (_a = {}, _a[execute$5()] = ['disabling', 'toggling', 'alloy.base.behaviour'], _a)),\n      events: buttonEvents,\n      behaviours: augment(detail.splitDropdownBehaviours, [Coupling.config({\n        others: {\n          sandbox: function (hotspot) {\n            var arrow = getPartOrDie(hotspot, detail, 'arrow');\n            var extras = {\n              onOpen: function () {\n                Toggling.on(arrow);\n                Toggling.on(hotspot);\n              },\n              onClose: function () {\n                Toggling.off(arrow);\n                Toggling.off(hotspot);\n              }\n            };\n            return makeSandbox$1(detail, hotspot, extras);\n          }\n        }\n      }), Keying.config({\n        mode: 'special',\n        onSpace: executeOnButton,\n        onEnter: executeOnButton,\n        onDown: openMenu\n      }), Focusing.config({}), Toggling.config({\n        toggleOnExecute: false,\n        aria: {\n          mode: 'expanded'\n        }\n      })]),\n      domModification: {\n        attributes: {\n          'role': detail.role.getOr('button'),\n          'aria-haspopup': true\n        }\n      }\n    };\n  };\n\n  var SplitDropdown = composite({\n    name: 'SplitDropdown',\n    configFields: schema$7(),\n    partFields: parts$3(),\n    factory: factory$5,\n    apis: {\n      repositionMenus: function (apis, comp) {\n        return apis.repositionMenus(comp);\n      }\n    }\n  });\n\n  var getButtonApi = function (component) {\n    return {\n      isDisabled: function () {\n        return Disabling.isDisabled(component);\n      },\n      setDisabled: function (state) {\n        return Disabling.set(component, state);\n      }\n    };\n  };\n\n  var getToggleApi = function (component) {\n    return {\n      setActive: function (state) {\n        Toggling.set(component, state);\n      },\n      isActive: function () {\n        return Toggling.isOn(component);\n      },\n      isDisabled: function () {\n        return Disabling.isDisabled(component);\n      },\n      setDisabled: function (state) {\n        return Disabling.set(component, state);\n      }\n    };\n  };\n\n  var getTooltipAttributes = function (tooltip, providersBackstage) {\n    return tooltip.map(function (tooltip) {\n      return {\n        'aria-label': providersBackstage.translate(tooltip),\n        'title': providersBackstage.translate(tooltip)\n      };\n    }).getOr({});\n  };\n\n  var focusButtonEvent = generate$6('focus-button');\n\n  var renderCommonStructure = function (icon, text, tooltip, receiver, behaviours, providersBackstage) {\n    var _d;\n\n    return {\n      dom: {\n        tag: 'button',\n        classes: ['tox-tbtn'].concat(text.isSome() ? ['tox-tbtn--select'] : []),\n        attributes: getTooltipAttributes(tooltip, providersBackstage)\n      },\n      components: componentRenderPipeline([icon.map(function (iconName) {\n        return renderIconFromPack(iconName, providersBackstage.icons);\n      }), text.map(function (text) {\n        return renderLabel$1(text, 'tox-tbtn', providersBackstage);\n      })]),\n      eventOrder: (_d = {}, _d[mousedown()] = ['focusing', 'alloy.base.behaviour', 'common-button-display-events'], _d),\n      buttonBehaviours: derive$1([DisablingConfigs.toolbarButton(providersBackstage.isDisabled), receivingConfig(), config('common-button-display-events', [run$1(mousedown(), function (button, se) {\n        se.event.prevent();\n        emit(button, focusButtonEvent);\n      })])].concat(receiver.map(function (r) {\n        return Reflecting.config({\n          channel: r,\n          initialData: {\n            icon: icon,\n            text: text\n          },\n          renderComponents: function (data, _state) {\n            return componentRenderPipeline([data.icon.map(function (iconName) {\n              return renderIconFromPack(iconName, providersBackstage.icons);\n            }), data.text.map(function (text) {\n              return renderLabel$1(text, 'tox-tbtn', providersBackstage);\n            })]);\n          }\n        });\n      }).toArray()).concat(behaviours.getOr([])))\n    };\n  };\n\n  var renderFloatingToolbarButton = function (spec, backstage, identifyButtons, attributes) {\n    var sharedBackstage = backstage.shared;\n    return FloatingToolbarButton.sketch({\n      lazySink: sharedBackstage.getSink,\n      fetch: function () {\n        return Future.nu(function (resolve) {\n          resolve(map$2(identifyButtons(spec.items), renderToolbarGroup));\n        });\n      },\n      markers: {\n        toggledClass: 'tox-tbtn--enabled'\n      },\n      parts: {\n        button: renderCommonStructure(spec.icon, spec.text, spec.tooltip, Optional.none(), Optional.none(), sharedBackstage.providers),\n        toolbar: {\n          dom: {\n            tag: 'div',\n            classes: ['tox-toolbar__overflow'],\n            attributes: attributes\n          }\n        }\n      }\n    });\n  };\n\n  var renderCommonToolbarButton = function (spec, specialisation, providersBackstage) {\n    var editorOffCell = Cell(noop);\n    var structure = renderCommonStructure(spec.icon, spec.text, spec.tooltip, Optional.none(), Optional.none(), providersBackstage);\n    return Button.sketch({\n      dom: structure.dom,\n      components: structure.components,\n      eventOrder: toolbarButtonEventOrder,\n      buttonBehaviours: derive$1([config('toolbar-button-events', [onToolbarButtonExecute({\n        onAction: spec.onAction,\n        getApi: specialisation.getApi\n      }), onControlAttached(specialisation, editorOffCell), onControlDetached(specialisation, editorOffCell)]), DisablingConfigs.toolbarButton(function () {\n        return spec.disabled || providersBackstage.isDisabled();\n      }), receivingConfig()].concat(specialisation.toolbarButtonBehaviours))\n    });\n  };\n\n  var renderToolbarButton = function (spec, providersBackstage) {\n    return renderToolbarButtonWith(spec, providersBackstage, []);\n  };\n\n  var renderToolbarButtonWith = function (spec, providersBackstage, bonusEvents) {\n    return renderCommonToolbarButton(spec, {\n      toolbarButtonBehaviours: [].concat(bonusEvents.length > 0 ? [config('toolbarButtonWith', bonusEvents)] : []),\n      getApi: getButtonApi,\n      onSetup: spec.onSetup\n    }, providersBackstage);\n  };\n\n  var renderToolbarToggleButton = function (spec, providersBackstage) {\n    return renderToolbarToggleButtonWith(spec, providersBackstage, []);\n  };\n\n  var renderToolbarToggleButtonWith = function (spec, providersBackstage, bonusEvents) {\n    return deepMerge(renderCommonToolbarButton(spec, {\n      toolbarButtonBehaviours: [Replacing.config({}), Toggling.config({\n        toggleClass: 'tox-tbtn--enabled',\n        aria: {\n          mode: 'pressed'\n        },\n        toggleOnExecute: false\n      })].concat(bonusEvents.length > 0 ? [config('toolbarToggleButtonWith', bonusEvents)] : []),\n      getApi: getToggleApi,\n      onSetup: spec.onSetup\n    }, providersBackstage));\n  };\n\n  var fetchChoices = function (getApi, spec, providersBackstage) {\n    return function (comp) {\n      return Future.nu(function (callback) {\n        return spec.fetch(callback);\n      }).map(function (items) {\n        return Optional.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$6('menu-value'), items, function (value) {\n          spec.onItemAction(getApi(comp), value);\n        }, spec.columns, spec.presets, ItemResponse$1.CLOSE_ON_EXECUTE, spec.select.getOr(never), providersBackstage), {\n          movement: deriveMenuMovement(spec.columns, spec.presets),\n          menuBehaviours: SimpleBehaviours.unnamedEvents(spec.columns !== 'auto' ? [] : [runOnAttached(function (comp, _se) {\n            detectSize(comp, 4, classForPreset(spec.presets)).each(function (_d) {\n              var numRows = _d.numRows,\n                  numColumns = _d.numColumns;\n              Keying.setGridSize(comp, numRows, numColumns);\n            });\n          })])\n        })));\n      });\n    };\n  };\n\n  var renderSplitButton = function (spec, sharedBackstage) {\n    var _d;\n\n    var displayChannel = generate$6('channel-update-split-dropdown-display');\n\n    var getApi = function (comp) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(comp);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(comp, state);\n        },\n        setIconFill: function (id, value) {\n          descendant(comp.element, 'svg path[id=\"' + id + '\"], rect[id=\"' + id + '\"]').each(function (underlinePath) {\n            set$8(underlinePath, 'fill', value);\n          });\n        },\n        setIconStroke: function (id, value) {\n          descendant(comp.element, 'svg path[id=\"' + id + '\"], rect[id=\"' + id + '\"]').each(function (underlinePath) {\n            set$8(underlinePath, 'stroke', value);\n          });\n        },\n        setActive: function (state) {\n          set$8(comp.element, 'aria-pressed', state);\n          descendant(comp.element, 'span').each(function (button) {\n            comp.getSystem().getByDom(button).each(function (buttonComp) {\n              return Toggling.set(buttonComp, state);\n            });\n          });\n        },\n        isActive: function () {\n          return descendant(comp.element, 'span').exists(function (button) {\n            return comp.getSystem().getByDom(button).exists(Toggling.isOn);\n          });\n        }\n      };\n    };\n\n    var editorOffCell = Cell(noop);\n    var specialisation = {\n      getApi: getApi,\n      onSetup: spec.onSetup\n    };\n    return SplitDropdown.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-split-button'],\n        attributes: __assign({\n          'aria-pressed': false\n        }, getTooltipAttributes(spec.tooltip, sharedBackstage.providers))\n      },\n      onExecute: function (button) {\n        spec.onAction(getApi(button));\n      },\n      onItemExecute: function (_a, _b, _c) {},\n      splitDropdownBehaviours: derive$1([DisablingConfigs.splitButton(sharedBackstage.providers.isDisabled), receivingConfig(), config('split-dropdown-events', [run$1(focusButtonEvent, Focusing.focus), onControlAttached(specialisation, editorOffCell), onControlDetached(specialisation, editorOffCell)]), Unselecting.config({})]),\n      eventOrder: (_d = {}, _d[attachedToDom()] = ['alloy.base.behaviour', 'split-dropdown-events'], _d),\n      toggleClass: 'tox-tbtn--enabled',\n      lazySink: sharedBackstage.getSink,\n      fetch: fetchChoices(getApi, spec, sharedBackstage.providers),\n      parts: {\n        menu: part(false, spec.columns, spec.presets)\n      },\n      components: [SplitDropdown.parts.button(renderCommonStructure(spec.icon, spec.text, Optional.none(), Optional.some(displayChannel), Optional.some([Toggling.config({\n        toggleClass: 'tox-tbtn--enabled',\n        toggleOnExecute: false\n      })]), sharedBackstage.providers)), SplitDropdown.parts.arrow({\n        dom: {\n          tag: 'button',\n          classes: ['tox-tbtn', 'tox-split-button__chevron'],\n          innerHtml: get$1('chevron-down', sharedBackstage.providers.icons)\n        },\n        buttonBehaviours: derive$1([DisablingConfigs.splitButton(sharedBackstage.providers.isDisabled), receivingConfig(), addFocusableBehaviour()])\n      }), SplitDropdown.parts['aria-descriptor']({\n        text: sharedBackstage.providers.translate('To open the popup, press Shift+Enter')\n      })]\n    });\n  };\n\n  var defaultToolbar = [{\n    name: 'history',\n    items: ['undo', 'redo']\n  }, {\n    name: 'styles',\n    items: ['styleselect']\n  }, {\n    name: 'formatting',\n    items: ['bold', 'italic']\n  }, {\n    name: 'alignment',\n    items: ['alignleft', 'aligncenter', 'alignright', 'alignjustify']\n  }, {\n    name: 'indentation',\n    items: ['outdent', 'indent']\n  }, {\n    name: 'permanent pen',\n    items: ['permanentpen']\n  }, {\n    name: 'comments',\n    items: ['addcomment']\n  }];\n\n  var renderFromBridge = function (bridgeBuilder, render) {\n    return function (spec, extras, editor) {\n      var internal = bridgeBuilder(spec).mapError(function (errInfo) {\n        return formatError(errInfo);\n      }).getOrDie();\n      return render(internal, extras, editor);\n    };\n  };\n\n  var types = {\n    button: renderFromBridge(createToolbarButton, function (s, extras) {\n      return renderToolbarButton(s, extras.backstage.shared.providers);\n    }),\n    togglebutton: renderFromBridge(createToggleButton, function (s, extras) {\n      return renderToolbarToggleButton(s, extras.backstage.shared.providers);\n    }),\n    menubutton: renderFromBridge(createMenuButton, function (s, extras) {\n      return renderMenuButton(s, 'tox-tbtn', extras.backstage, Optional.none());\n    }),\n    splitbutton: renderFromBridge(createSplitButton, function (s, extras) {\n      return renderSplitButton(s, extras.backstage.shared);\n    }),\n    grouptoolbarbutton: renderFromBridge(createGroupToolbarButton, function (s, extras, editor) {\n      var _a;\n\n      var buttons = editor.ui.registry.getAll().buttons;\n\n      var identify = function (toolbar) {\n        return identifyButtons(editor, {\n          buttons: buttons,\n          toolbar: toolbar,\n          allowToolbarGroups: false\n        }, extras, Optional.none());\n      };\n\n      var attributes = (_a = {}, _a[Attribute] = extras.backstage.shared.header.isPositionedAtTop() ? AttributeValue.TopToBottom : AttributeValue.BottomToTop, _a);\n\n      switch (getToolbarMode(editor)) {\n        case ToolbarMode.floating:\n          return renderFloatingToolbarButton(s, extras.backstage, identify, attributes);\n\n        default:\n          throw new Error('Toolbar groups are only supported when using floating toolbar mode');\n      }\n    }),\n    styleSelectButton: function (editor, extras) {\n      return createStyleSelect(editor, extras.backstage);\n    },\n    fontsizeSelectButton: function (editor, extras) {\n      return createFontsizeSelect(editor, extras.backstage);\n    },\n    fontSelectButton: function (editor, extras) {\n      return createFontSelect(editor, extras.backstage);\n    },\n    formatButton: function (editor, extras) {\n      return createFormatSelect(editor, extras.backstage);\n    },\n    alignMenuButton: function (editor, extras) {\n      return createAlignSelect(editor, extras.backstage);\n    }\n  };\n\n  var extractFrom = function (spec, extras, editor) {\n    return get$e(types, spec.type).fold(function () {\n      console.error('skipping button defined by', spec);\n      return Optional.none();\n    }, function (render) {\n      return Optional.some(render(spec, extras, editor));\n    });\n  };\n\n  var bespokeButtons = {\n    styleselect: types.styleSelectButton,\n    fontsizeselect: types.fontsizeSelectButton,\n    fontselect: types.fontSelectButton,\n    formatselect: types.formatButton,\n    align: types.alignMenuButton\n  };\n\n  var removeUnusedDefaults = function (buttons) {\n    var filteredItemGroups = map$2(defaultToolbar, function (group) {\n      var items = filter$2(group.items, function (subItem) {\n        return has$2(buttons, subItem) || has$2(bespokeButtons, subItem);\n      });\n      return {\n        name: group.name,\n        items: items\n      };\n    });\n    return filter$2(filteredItemGroups, function (group) {\n      return group.items.length > 0;\n    });\n  };\n\n  var convertStringToolbar = function (strToolbar) {\n    var groupsStrings = strToolbar.split('|');\n    return map$2(groupsStrings, function (g) {\n      return {\n        items: g.trim().split(' ')\n      };\n    });\n  };\n\n  var isToolbarGroupSettingArray = function (toolbar) {\n    return isArrayOf(toolbar, function (t) {\n      return has$2(t, 'name') && has$2(t, 'items');\n    });\n  };\n\n  var createToolbar = function (toolbarConfig) {\n    var toolbar = toolbarConfig.toolbar;\n    var buttons = toolbarConfig.buttons;\n\n    if (toolbar === false) {\n      return [];\n    } else if (toolbar === undefined || toolbar === true) {\n      return removeUnusedDefaults(buttons);\n    } else if (isString(toolbar)) {\n      return convertStringToolbar(toolbar);\n    } else if (isToolbarGroupSettingArray(toolbar)) {\n      return toolbar;\n    } else {\n      console.error('Toolbar type should be string, string[], boolean or ToolbarGroup[]');\n      return [];\n    }\n  };\n\n  var lookupButton = function (editor, buttons, toolbarItem, allowToolbarGroups, extras, prefixes) {\n    return get$e(buttons, toolbarItem.toLowerCase()).orThunk(function () {\n      return prefixes.bind(function (ps) {\n        return findMap(ps, function (prefix) {\n          return get$e(buttons, prefix + toolbarItem.toLowerCase());\n        });\n      });\n    }).fold(function () {\n      return get$e(bespokeButtons, toolbarItem.toLowerCase()).map(function (r) {\n        return r(editor, extras);\n      }).orThunk(function () {\n        return Optional.none();\n      });\n    }, function (spec) {\n      if (spec.type === 'grouptoolbarbutton' && !allowToolbarGroups) {\n        console.warn('Ignoring the \\'' + toolbarItem + '\\' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.');\n        return Optional.none();\n      } else {\n        return extractFrom(spec, extras, editor);\n      }\n    });\n  };\n\n  var identifyButtons = function (editor, toolbarConfig, extras, prefixes) {\n    var toolbarGroups = createToolbar(toolbarConfig);\n    var groups = map$2(toolbarGroups, function (group) {\n      var items = bind$3(group.items, function (toolbarItem) {\n        return toolbarItem.trim().length === 0 ? [] : lookupButton(editor, toolbarConfig.buttons, toolbarItem, toolbarConfig.allowToolbarGroups, extras, prefixes).toArray();\n      });\n      return {\n        title: Optional.from(editor.translate(group.name)),\n        items: items\n      };\n    });\n    return filter$2(groups, function (group) {\n      return group.items.length > 0;\n    });\n  };\n\n  var setToolbar = function (editor, uiComponents, rawUiConfig, backstage) {\n    var comp = uiComponents.outerContainer;\n    var toolbarConfig = rawUiConfig.toolbar;\n    var toolbarButtonsConfig = rawUiConfig.buttons;\n\n    if (isArrayOf(toolbarConfig, isString)) {\n      var toolbars = toolbarConfig.map(function (t) {\n        var config = {\n          toolbar: t,\n          buttons: toolbarButtonsConfig,\n          allowToolbarGroups: rawUiConfig.allowToolbarGroups\n        };\n        return identifyButtons(editor, config, {\n          backstage: backstage\n        }, Optional.none());\n      });\n      OuterContainer.setToolbars(comp, toolbars);\n    } else {\n      OuterContainer.setToolbar(comp, identifyButtons(editor, rawUiConfig, {\n        backstage: backstage\n      }, Optional.none()));\n    }\n  };\n\n  var detection = detect$1();\n  var isiOS12 = detection.os.isiOS() && detection.os.version.major <= 12;\n\n  var setupEvents$1 = function (editor, uiComponents) {\n    var dom = editor.dom;\n    var contentWindow = editor.getWin();\n    var initialDocEle = editor.getDoc().documentElement;\n    var lastWindowDimensions = Cell(SugarPosition(contentWindow.innerWidth, contentWindow.innerHeight));\n    var lastDocumentDimensions = Cell(SugarPosition(initialDocEle.offsetWidth, initialDocEle.offsetHeight));\n\n    var resizeWindow = function () {\n      var outer = lastWindowDimensions.get();\n\n      if (outer.left !== contentWindow.innerWidth || outer.top !== contentWindow.innerHeight) {\n        lastWindowDimensions.set(SugarPosition(contentWindow.innerWidth, contentWindow.innerHeight));\n        fireResizeContent(editor);\n      }\n    };\n\n    var resizeDocument = function () {\n      var docEle = editor.getDoc().documentElement;\n      var inner = lastDocumentDimensions.get();\n\n      if (inner.left !== docEle.offsetWidth || inner.top !== docEle.offsetHeight) {\n        lastDocumentDimensions.set(SugarPosition(docEle.offsetWidth, docEle.offsetHeight));\n        fireResizeContent(editor);\n      }\n    };\n\n    var scroll = function (e) {\n      return fireScrollContent(editor, e);\n    };\n\n    dom.bind(contentWindow, 'resize', resizeWindow);\n    dom.bind(contentWindow, 'scroll', scroll);\n    var elementLoad = capture(SugarElement.fromDom(editor.getBody()), 'load', resizeDocument);\n    var mothership = uiComponents.uiMothership.element;\n    editor.on('hide', function () {\n      set$7(mothership, 'display', 'none');\n    });\n    editor.on('show', function () {\n      remove$6(mothership, 'display');\n    });\n    editor.on('NodeChange', resizeDocument);\n    editor.on('remove', function () {\n      elementLoad.unbind();\n      dom.unbind(contentWindow, 'resize', resizeWindow);\n      dom.unbind(contentWindow, 'scroll', scroll);\n      contentWindow = null;\n    });\n  };\n\n  var render$1 = function (editor, uiComponents, rawUiConfig, backstage, args) {\n    var lastToolbarWidth = Cell(0);\n    var outerContainer = uiComponents.outerContainer;\n    iframe(editor);\n    var eTargetNode = SugarElement.fromDom(args.targetNode);\n    var uiRoot = getContentContainer(getRootNode(eTargetNode));\n    attachSystemAfter(eTargetNode, uiComponents.mothership);\n    attachSystem(uiRoot, uiComponents.uiMothership);\n    editor.on('PostRender', function () {\n      setToolbar(editor, uiComponents, rawUiConfig, backstage);\n      lastToolbarWidth.set(editor.getWin().innerWidth);\n      OuterContainer.setMenubar(outerContainer, identifyMenus(editor, rawUiConfig));\n      OuterContainer.setSidebar(outerContainer, rawUiConfig.sidebar);\n      setupEvents$1(editor, uiComponents);\n    });\n    var socket = OuterContainer.getSocket(outerContainer).getOrDie('Could not find expected socket element');\n\n    if (isiOS12) {\n      setAll(socket.element, {\n        'overflow': 'scroll',\n        '-webkit-overflow-scrolling': 'touch'\n      });\n      var limit = first(function () {\n        editor.fire('ScrollContent');\n      }, 20);\n      var unbinder = bind(socket.element, 'scroll', limit.throttle);\n      editor.on('remove', unbinder.unbind);\n    }\n\n    setupReadonlyModeSwitch(editor, uiComponents);\n    editor.addCommand('ToggleSidebar', function (_ui, value) {\n      OuterContainer.toggleSidebar(outerContainer, value);\n      editor.fire('ToggleSidebar');\n    });\n    editor.addQueryValueHandler('ToggleSidebar', function () {\n      return OuterContainer.whichSidebar(outerContainer);\n    });\n    var toolbarMode = getToolbarMode(editor);\n\n    var refreshDrawer = function () {\n      OuterContainer.refreshToolbar(uiComponents.outerContainer);\n    };\n\n    if (toolbarMode === ToolbarMode.sliding || toolbarMode === ToolbarMode.floating) {\n      editor.on('ResizeWindow ResizeEditor ResizeContent', function () {\n        var width = editor.getWin().innerWidth;\n\n        if (width !== lastToolbarWidth.get()) {\n          refreshDrawer();\n          lastToolbarWidth.set(width);\n        }\n      });\n    }\n\n    var api = {\n      enable: function () {\n        broadcastReadonly(uiComponents, false);\n      },\n      disable: function () {\n        broadcastReadonly(uiComponents, true);\n      },\n      isDisabled: function () {\n        return Disabling.isDisabled(outerContainer);\n      }\n    };\n    return {\n      iframeContainer: socket.element.dom,\n      editorContainer: outerContainer.element.dom,\n      api: api\n    };\n  };\n\n  var Iframe = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    render: render$1\n  });\n\n  var parseToInt = function (val) {\n    var re = /^[0-9\\.]+(|px)$/i;\n\n    if (re.test('' + val)) {\n      return Optional.some(parseInt('' + val, 10));\n    }\n\n    return Optional.none();\n  };\n\n  var numToPx = function (val) {\n    return isNumber(val) ? val + 'px' : val;\n  };\n\n  var calcCappedSize = function (size, minSize, maxSize) {\n    var minOverride = minSize.filter(function (min) {\n      return size < min;\n    });\n    var maxOverride = maxSize.filter(function (max) {\n      return size > max;\n    });\n    return minOverride.or(maxOverride).getOr(size);\n  };\n\n  var getHeight = function (editor) {\n    var baseHeight = getHeightSetting(editor);\n    var minHeight = getMinHeightSetting(editor);\n    var maxHeight = getMaxHeightSetting(editor);\n    return parseToInt(baseHeight).map(function (height) {\n      return calcCappedSize(height, minHeight, maxHeight);\n    });\n  };\n\n  var getHeightWithFallback = function (editor) {\n    var height = getHeight(editor);\n    return height.getOr(getHeightSetting(editor));\n  };\n\n  var getWidth = function (editor) {\n    var baseWidth = getWidthSetting(editor);\n    var minWidth = getMinWidthSetting(editor);\n    var maxWidth = getMaxWidthSetting(editor);\n    return parseToInt(baseWidth).map(function (width) {\n      return calcCappedSize(width, minWidth, maxWidth);\n    });\n  };\n\n  var getWidthWithFallback = function (editor) {\n    var width = getWidth(editor);\n    return width.getOr(getWidthSetting(editor));\n  };\n\n  var InlineHeader = function (editor, targetElm, uiComponents, backstage, floatContainer) {\n    var uiMothership = uiComponents.uiMothership,\n        outerContainer = uiComponents.outerContainer;\n    var DOM = global$b.DOM;\n    var useFixedToolbarContainer = useFixedContainer(editor);\n    var isSticky = isStickyToolbar(editor);\n    var editorMaxWidthOpt = getMaxWidthSetting(editor).or(getWidth(editor));\n    var headerBackstage = backstage.shared.header;\n    var isPositionedAtTop = headerBackstage.isPositionedAtTop;\n    var toolbarMode = getToolbarMode(editor);\n    var isSplitToolbar = toolbarMode === ToolbarMode.sliding || toolbarMode === ToolbarMode.floating;\n    var visible = Cell(false);\n\n    var isVisible = function () {\n      return visible.get() && !editor.removed;\n    };\n\n    var calcToolbarOffset = function (toolbar) {\n      return isSplitToolbar ? toolbar.fold(constant$1(0), function (tbar) {\n        return tbar.components().length > 1 ? get$b(tbar.components()[1].element) : 0;\n      }) : 0;\n    };\n\n    var calcMode = function (container) {\n      switch (getToolbarLocation(editor)) {\n        case ToolbarLocation.auto:\n          var toolbar_1 = OuterContainer.getToolbar(outerContainer);\n          var offset = calcToolbarOffset(toolbar_1);\n          var toolbarHeight = get$b(container.element) - offset;\n          var targetBounds = box$1(targetElm);\n          var roomAtTop = targetBounds.y > toolbarHeight;\n\n          if (roomAtTop) {\n            return 'top';\n          } else {\n            var doc = documentElement(targetElm);\n            var docHeight = Math.max(doc.dom.scrollHeight, get$b(doc));\n            var roomAtBottom = targetBounds.bottom < docHeight - toolbarHeight;\n\n            if (roomAtBottom) {\n              return 'bottom';\n            } else {\n              var winBounds = win();\n              var isRoomAtBottomViewport = winBounds.bottom < targetBounds.bottom - toolbarHeight;\n              return isRoomAtBottomViewport ? 'bottom' : 'top';\n            }\n          }\n\n        case ToolbarLocation.bottom:\n          return 'bottom';\n\n        case ToolbarLocation.top:\n        default:\n          return 'top';\n      }\n    };\n\n    var setupMode = function (mode) {\n      var container = floatContainer.get();\n      Docking.setModes(container, [mode]);\n      headerBackstage.setDockingMode(mode);\n      var verticalDir = isPositionedAtTop() ? AttributeValue.TopToBottom : AttributeValue.BottomToTop;\n      set$8(container.element, Attribute, verticalDir);\n    };\n\n    var updateChromeWidth = function () {\n      var maxWidth = editorMaxWidthOpt.getOrThunk(function () {\n        var bodyMargin = parseToInt(get$c(body(), 'margin-left')).getOr(0);\n        return get$a(body()) - absolute$3(targetElm).left + bodyMargin;\n      });\n      set$7(floatContainer.get().element, 'max-width', maxWidth + 'px');\n    };\n\n    var updateChromePosition = function () {\n      var toolbar = OuterContainer.getToolbar(outerContainer);\n      var offset = calcToolbarOffset(toolbar);\n      var targetBounds = box$1(targetElm);\n      var top = isPositionedAtTop() ? Math.max(targetBounds.y - get$b(floatContainer.get().element) + offset, 0) : targetBounds.bottom;\n      setAll(outerContainer.element, {\n        position: 'absolute',\n        top: Math.round(top) + 'px',\n        left: Math.round(targetBounds.x) + 'px'\n      });\n    };\n\n    var repositionPopups$1 = function () {\n      uiMothership.broadcastOn([repositionPopups()], {});\n    };\n\n    var updateChromeUi = function (resetDocking) {\n      if (resetDocking === void 0) {\n        resetDocking = false;\n      }\n\n      if (!isVisible()) {\n        return;\n      }\n\n      if (!useFixedToolbarContainer) {\n        updateChromeWidth();\n      }\n\n      if (isSplitToolbar) {\n        OuterContainer.refreshToolbar(outerContainer);\n      }\n\n      if (!useFixedToolbarContainer) {\n        updateChromePosition();\n      }\n\n      if (isSticky) {\n        var floatContainerComp = floatContainer.get();\n        resetDocking ? Docking.reset(floatContainerComp) : Docking.refresh(floatContainerComp);\n      }\n\n      repositionPopups$1();\n    };\n\n    var updateMode = function (updateUi) {\n      if (updateUi === void 0) {\n        updateUi = true;\n      }\n\n      if (useFixedToolbarContainer || !isSticky || !isVisible()) {\n        return;\n      }\n\n      var currentMode = headerBackstage.getDockingMode();\n      var newMode = calcMode(floatContainer.get());\n\n      if (newMode !== currentMode) {\n        setupMode(newMode);\n\n        if (updateUi) {\n          updateChromeUi(true);\n        }\n      }\n    };\n\n    var show = function () {\n      visible.set(true);\n      set$7(outerContainer.element, 'display', 'flex');\n      DOM.addClass(editor.getBody(), 'mce-edit-focus');\n      remove$6(uiMothership.element, 'display');\n      updateMode(false);\n      updateChromeUi();\n    };\n\n    var hide = function () {\n      visible.set(false);\n\n      if (uiComponents.outerContainer) {\n        set$7(outerContainer.element, 'display', 'none');\n        DOM.removeClass(editor.getBody(), 'mce-edit-focus');\n      }\n\n      set$7(uiMothership.element, 'display', 'none');\n    };\n\n    return {\n      isVisible: isVisible,\n      isPositionedAtTop: isPositionedAtTop,\n      show: show,\n      hide: hide,\n      update: updateChromeUi,\n      updateMode: updateMode,\n      repositionPopups: repositionPopups$1\n    };\n  };\n\n  var getTargetPosAndBounds = function (targetElm, isToolbarTop) {\n    var bounds = box$1(targetElm);\n    return {\n      pos: isToolbarTop ? bounds.y : bounds.bottom,\n      bounds: bounds\n    };\n  };\n\n  var setupEvents = function (editor, targetElm, ui, toolbarPersist) {\n    var prevPosAndBounds = Cell(getTargetPosAndBounds(targetElm, ui.isPositionedAtTop()));\n\n    var resizeContent = function (e) {\n      var _a = getTargetPosAndBounds(targetElm, ui.isPositionedAtTop()),\n          pos = _a.pos,\n          bounds = _a.bounds;\n\n      var _b = prevPosAndBounds.get(),\n          prevPos = _b.pos,\n          prevBounds = _b.bounds;\n\n      var hasResized = bounds.height !== prevBounds.height || bounds.width !== prevBounds.width;\n      prevPosAndBounds.set({\n        pos: pos,\n        bounds: bounds\n      });\n\n      if (hasResized) {\n        fireResizeContent(editor, e);\n      }\n\n      if (ui.isVisible()) {\n        if (prevPos !== pos) {\n          ui.update(true);\n        } else if (hasResized) {\n          ui.updateMode();\n          ui.repositionPopups();\n        }\n      }\n    };\n\n    if (!toolbarPersist) {\n      editor.on('activate', ui.show);\n      editor.on('deactivate', ui.hide);\n    }\n\n    editor.on('SkinLoaded ResizeWindow', function () {\n      return ui.update(true);\n    });\n    editor.on('NodeChange keydown', function (e) {\n      global$f.requestAnimationFrame(function () {\n        return resizeContent(e);\n      });\n    });\n    editor.on('ScrollWindow', function () {\n      return ui.updateMode();\n    });\n    var elementLoad = unbindable();\n    elementLoad.set(capture(SugarElement.fromDom(editor.getBody()), 'load', resizeContent));\n    editor.on('remove', function () {\n      elementLoad.clear();\n    });\n  };\n\n  var render = function (editor, uiComponents, rawUiConfig, backstage, args) {\n    var mothership = uiComponents.mothership,\n        uiMothership = uiComponents.uiMothership,\n        outerContainer = uiComponents.outerContainer;\n    var floatContainer = Cell(null);\n    var targetElm = SugarElement.fromDom(args.targetNode);\n    var ui = InlineHeader(editor, targetElm, uiComponents, backstage, floatContainer);\n    var toolbarPersist = isToolbarPersist(editor);\n    inline(editor);\n\n    var render = function () {\n      if (floatContainer.get()) {\n        ui.show();\n        return;\n      }\n\n      floatContainer.set(OuterContainer.getHeader(outerContainer).getOrDie());\n      var uiContainer = getUiContainer(editor);\n      attachSystem(uiContainer, mothership);\n      attachSystem(uiContainer, uiMothership);\n      setToolbar(editor, uiComponents, rawUiConfig, backstage);\n      OuterContainer.setMenubar(outerContainer, identifyMenus(editor, rawUiConfig));\n      ui.show();\n      setupEvents(editor, targetElm, ui, toolbarPersist);\n      editor.nodeChanged();\n    };\n\n    var delayedRender = function () {\n      return global$f.setEditorTimeout(editor, render, 0);\n    };\n\n    editor.on('show', render);\n    editor.on('hide', ui.hide);\n\n    if (!toolbarPersist) {\n      editor.on('focus', delayedRender);\n      editor.on('blur', ui.hide);\n    }\n\n    editor.on('init', function () {\n      if (editor.hasFocus() || toolbarPersist) {\n        delayedRender();\n      }\n    });\n    setupReadonlyModeSwitch(editor, uiComponents);\n    var api = {\n      show: function () {\n        ui.show();\n      },\n      hide: function () {\n        ui.hide();\n      },\n      enable: function () {\n        broadcastReadonly(uiComponents, false);\n      },\n      disable: function () {\n        broadcastReadonly(uiComponents, true);\n      },\n      isDisabled: function () {\n        return Disabling.isDisabled(outerContainer);\n      }\n    };\n    return {\n      editorContainer: outerContainer.element.dom,\n      api: api\n    };\n  };\n\n  var Inline = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    render: render\n  });\n  var showContextToolbarEvent = 'contexttoolbar-show';\n  var hideContextToolbarEvent = 'contexttoolbar-hide';\n\n  var getFormApi = function (input) {\n    return {\n      hide: function () {\n        return emit(input, sandboxClose());\n      },\n      getValue: function () {\n        return Representing.getValue(input);\n      }\n    };\n  };\n\n  var runOnExecute = function (memInput, original) {\n    return run$1(internalToolbarButtonExecute, function (comp, se) {\n      var input = memInput.get(comp);\n      var formApi = getFormApi(input);\n      original.onAction(formApi, se.event.buttonApi);\n    });\n  };\n\n  var renderContextButton = function (memInput, button, extras) {\n    var _a = button.original;\n    _a.primary;\n\n    var rest = __rest(_a, ['primary']);\n\n    var bridged = getOrDie(createToolbarButton(__assign(__assign({}, rest), {\n      type: 'button',\n      onAction: noop\n    })));\n    return renderToolbarButtonWith(bridged, extras.backstage.shared.providers, [runOnExecute(memInput, button)]);\n  };\n\n  var renderContextToggleButton = function (memInput, button, extras) {\n    var _a = button.original;\n    _a.primary;\n\n    var rest = __rest(_a, ['primary']);\n\n    var bridged = getOrDie(createToggleButton(__assign(__assign({}, rest), {\n      type: 'togglebutton',\n      onAction: noop\n    })));\n    return renderToolbarToggleButtonWith(bridged, extras.backstage.shared.providers, [runOnExecute(memInput, button)]);\n  };\n\n  var generateOne = function (memInput, button, providersBackstage) {\n    var extras = {\n      backstage: {\n        shared: {\n          providers: providersBackstage\n        }\n      }\n    };\n\n    if (button.type === 'contextformtogglebutton') {\n      return renderContextToggleButton(memInput, button, extras);\n    } else {\n      return renderContextButton(memInput, button, extras);\n    }\n  };\n\n  var generate = function (memInput, buttons, providersBackstage) {\n    var mementos = map$2(buttons, function (button) {\n      return record(generateOne(memInput, button, providersBackstage));\n    });\n\n    var asSpecs = function () {\n      return map$2(mementos, function (mem) {\n        return mem.asSpec();\n      });\n    };\n\n    var findPrimary = function (compInSystem) {\n      return findMap(buttons, function (button, i) {\n        if (button.primary) {\n          return Optional.from(mementos[i]).bind(function (mem) {\n            return mem.getOpt(compInSystem);\n          }).filter(not(Disabling.isDisabled));\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n\n    return {\n      asSpecs: asSpecs,\n      findPrimary: findPrimary\n    };\n  };\n\n  var buildInitGroups = function (ctx, providers) {\n    var inputAttributes = ctx.label.fold(function () {\n      return {};\n    }, function (label) {\n      return {\n        'aria-label': label\n      };\n    });\n    var memInput = record(Input.sketch({\n      inputClasses: ['tox-toolbar-textfield', 'tox-toolbar-nav-js'],\n      data: ctx.initValue(),\n      inputAttributes: inputAttributes,\n      selectOnFocus: true,\n      inputBehaviours: derive$1([Keying.config({\n        mode: 'special',\n        onEnter: function (input) {\n          return commands.findPrimary(input).map(function (primary) {\n            emitExecute(primary);\n            return true;\n          });\n        },\n        onLeft: function (comp, se) {\n          se.cut();\n          return Optional.none();\n        },\n        onRight: function (comp, se) {\n          se.cut();\n          return Optional.none();\n        }\n      })])\n    }));\n    var commands = generate(memInput, ctx.commands, providers);\n    return [{\n      title: Optional.none(),\n      items: [memInput.asSpec()]\n    }, {\n      title: Optional.none(),\n      items: commands.asSpecs()\n    }];\n  };\n\n  var renderContextForm = function (toolbarType, ctx, providers) {\n    return renderToolbar({\n      type: toolbarType,\n      uid: generate$6('context-toolbar'),\n      initGroups: buildInitGroups(ctx, providers),\n      onEscape: Optional.none,\n      cyclicKeying: true,\n      providers: providers\n    });\n  };\n\n  var ContextForm = {\n    renderContextForm: renderContextForm,\n    buildInitGroups: buildInitGroups\n  };\n\n  var isVerticalOverlap = function (a, b, threshold) {\n    if (threshold === void 0) {\n      threshold = 0.01;\n    }\n\n    return b.bottom - a.y >= threshold && a.bottom - b.y >= threshold;\n  };\n\n  var getRangeRect = function (rng) {\n    var rect = rng.getBoundingClientRect();\n\n    if (rect.height <= 0 && rect.width <= 0) {\n      var leaf$1 = leaf(SugarElement.fromDom(rng.startContainer), rng.startOffset).element;\n      var elm = isText$1(leaf$1) ? parent(leaf$1) : Optional.some(leaf$1);\n      return elm.filter(isElement$2).map(function (e) {\n        return e.dom.getBoundingClientRect();\n      }).getOr(rect);\n    } else {\n      return rect;\n    }\n  };\n\n  var getSelectionBounds = function (editor) {\n    var rng = editor.selection.getRng();\n    var rect = getRangeRect(rng);\n\n    if (editor.inline) {\n      var scroll_1 = get$9();\n      return bounds(scroll_1.left + rect.left, scroll_1.top + rect.top, rect.width, rect.height);\n    } else {\n      var bodyPos = absolute$2(SugarElement.fromDom(editor.getBody()));\n      return bounds(bodyPos.x + rect.left, bodyPos.y + rect.top, rect.width, rect.height);\n    }\n  };\n\n  var getAnchorElementBounds = function (editor, lastElement) {\n    return lastElement.filter(inBody).map(absolute$2).getOrThunk(function () {\n      return getSelectionBounds(editor);\n    });\n  };\n\n  var getHorizontalBounds = function (contentAreaBox, viewportBounds, margin) {\n    var x = Math.max(contentAreaBox.x + margin, viewportBounds.x);\n    var right = Math.min(contentAreaBox.right - margin, viewportBounds.right);\n    return {\n      x: x,\n      width: right - x\n    };\n  };\n\n  var getVerticalBounds = function (editor, contentAreaBox, viewportBounds, isToolbarLocationTop, toolbarType, margin) {\n    var container = SugarElement.fromDom(editor.getContainer());\n    var header = descendant(container, '.tox-editor-header').getOr(container);\n    var headerBox = box$1(header);\n    var isToolbarBelowContentArea = headerBox.y >= contentAreaBox.bottom;\n    var isToolbarAbove = isToolbarLocationTop && !isToolbarBelowContentArea;\n\n    if (editor.inline && isToolbarAbove) {\n      return {\n        y: Math.max(headerBox.bottom + margin, viewportBounds.y),\n        bottom: viewportBounds.bottom\n      };\n    }\n\n    if (editor.inline && !isToolbarAbove) {\n      return {\n        y: viewportBounds.y,\n        bottom: Math.min(headerBox.y - margin, viewportBounds.bottom)\n      };\n    }\n\n    var containerBounds = toolbarType === 'line' ? box$1(container) : contentAreaBox;\n\n    if (isToolbarAbove) {\n      return {\n        y: Math.max(headerBox.bottom + margin, viewportBounds.y),\n        bottom: Math.min(containerBounds.bottom - margin, viewportBounds.bottom)\n      };\n    }\n\n    return {\n      y: Math.max(containerBounds.y + margin, viewportBounds.y),\n      bottom: Math.min(headerBox.y - margin, viewportBounds.bottom)\n    };\n  };\n\n  var getContextToolbarBounds = function (editor, sharedBackstage, toolbarType, margin) {\n    if (margin === void 0) {\n      margin = 0;\n    }\n\n    var viewportBounds = getBounds$3(window);\n    var contentAreaBox = box$1(SugarElement.fromDom(editor.getContentAreaContainer()));\n    var toolbarOrMenubarEnabled = isMenubarEnabled(editor) || isToolbarEnabled(editor) || isMultipleToolbars(editor);\n\n    var _a = getHorizontalBounds(contentAreaBox, viewportBounds, margin),\n        x = _a.x,\n        width = _a.width;\n\n    if (editor.inline && !toolbarOrMenubarEnabled) {\n      return bounds(x, viewportBounds.y, width, viewportBounds.height);\n    } else {\n      var isToolbarTop = sharedBackstage.header.isPositionedAtTop();\n\n      var _b = getVerticalBounds(editor, contentAreaBox, viewportBounds, isToolbarTop, toolbarType, margin),\n          y = _b.y,\n          bottom = _b.bottom;\n\n      return bounds(x, y, width, bottom - y);\n    }\n  };\n\n  var bubbleSize$1 = 12;\n  var bubbleAlignments$1 = {\n    valignCentre: [],\n    alignCentre: [],\n    alignLeft: ['tox-pop--align-left'],\n    alignRight: ['tox-pop--align-right'],\n    right: ['tox-pop--right'],\n    left: ['tox-pop--left'],\n    bottom: ['tox-pop--bottom'],\n    top: ['tox-pop--top'],\n    inset: ['tox-pop--inset']\n  };\n  var anchorOverrides = {\n    maxHeightFunction: expandable$1(),\n    maxWidthFunction: expandable()\n  };\n\n  var isEntireElementSelected = function (editor, elem) {\n    var rng = editor.selection.getRng();\n    var leaf$1 = leaf(SugarElement.fromDom(rng.startContainer), rng.startOffset);\n    return rng.startContainer === rng.endContainer && rng.startOffset === rng.endOffset - 1 && eq(leaf$1.element, elem);\n  };\n\n  var preservePosition = function (elem, position, f) {\n    var currentPosition = getRaw(elem, 'position');\n    set$7(elem, 'position', position);\n    var result = f(elem);\n    currentPosition.each(function (pos) {\n      return set$7(elem, 'position', pos);\n    });\n    return result;\n  };\n\n  var shouldUseInsetLayouts = function (position) {\n    return position === 'node';\n  };\n\n  var determineInsetLayout = function (editor, contextbar, elem, data, bounds) {\n    var selectionBounds = getSelectionBounds(editor);\n    var isSameAnchorElement = data.lastElement().exists(function (prev) {\n      return eq(elem, prev);\n    });\n\n    if (isEntireElementSelected(editor, elem)) {\n      return isSameAnchorElement ? preserve : north;\n    } else if (isSameAnchorElement) {\n      return preservePosition(contextbar, data.getMode(), function () {\n        var isOverlapping = isVerticalOverlap(selectionBounds, box$1(contextbar));\n        return isOverlapping && !data.isReposition() ? flip$2 : preserve;\n      });\n    } else {\n      var yBounds = data.getMode() === 'fixed' ? bounds.y + get$9().top : bounds.y;\n      var contextbarHeight = get$b(contextbar) + bubbleSize$1;\n      return yBounds + contextbarHeight <= selectionBounds.y ? north : south;\n    }\n  };\n\n  var getAnchorSpec$2 = function (editor, mobile, data, position) {\n    var smartInsetLayout = function (elem) {\n      return function (anchor, element, bubbles, placee, bounds) {\n        var layout = determineInsetLayout(editor, placee, elem, data, bounds);\n\n        var newAnchor = __assign(__assign({}, anchor), {\n          y: bounds.y,\n          height: bounds.height\n        });\n\n        return __assign(__assign({}, layout(newAnchor, element, bubbles, placee, bounds)), {\n          alwaysFit: true\n        });\n      };\n    };\n\n    var getInsetLayouts = function (elem) {\n      return shouldUseInsetLayouts(position) ? [smartInsetLayout(elem)] : [];\n    };\n\n    var desktopAnchorSpecLayouts = {\n      onLtr: function (elem) {\n        return [north$2, south$2, northeast$2, southeast$2, northwest$2, southwest$2].concat(getInsetLayouts(elem));\n      },\n      onRtl: function (elem) {\n        return [north$2, south$2, northwest$2, southwest$2, northeast$2, southeast$2].concat(getInsetLayouts(elem));\n      }\n    };\n    var mobileAnchorSpecLayouts = {\n      onLtr: function (elem) {\n        return [south$2, southeast$2, southwest$2, northeast$2, northwest$2, north$2].concat(getInsetLayouts(elem));\n      },\n      onRtl: function (elem) {\n        return [south$2, southwest$2, southeast$2, northwest$2, northeast$2, north$2].concat(getInsetLayouts(elem));\n      }\n    };\n    return mobile ? mobileAnchorSpecLayouts : desktopAnchorSpecLayouts;\n  };\n\n  var getAnchorLayout = function (editor, position, isTouch, data) {\n    if (position === 'line') {\n      return {\n        bubble: nu$5(bubbleSize$1, 0, bubbleAlignments$1),\n        layouts: {\n          onLtr: function () {\n            return [east$2];\n          },\n          onRtl: function () {\n            return [west$2];\n          }\n        },\n        overrides: anchorOverrides\n      };\n    } else {\n      return {\n        bubble: nu$5(0, bubbleSize$1, bubbleAlignments$1, 1 / bubbleSize$1),\n        layouts: getAnchorSpec$2(editor, isTouch, data, position),\n        overrides: anchorOverrides\n      };\n    }\n  };\n\n  var matchTargetWith = function (elem, candidates) {\n    var ctxs = filter$2(candidates, function (toolbarApi) {\n      return toolbarApi.predicate(elem.dom);\n    });\n\n    var _a = partition$3(ctxs, function (t) {\n      return t.type === 'contexttoolbar';\n    }),\n        pass = _a.pass,\n        fail = _a.fail;\n\n    return {\n      contextToolbars: pass,\n      contextForms: fail\n    };\n  };\n\n  var filterByPositionForStartNode = function (toolbars) {\n    if (toolbars.length <= 1) {\n      return toolbars;\n    } else {\n      var doesPositionExist = function (value) {\n        return exists(toolbars, function (t) {\n          return t.position === value;\n        });\n      };\n\n      var filterToolbarsByPosition = function (value) {\n        return filter$2(toolbars, function (t) {\n          return t.position === value;\n        });\n      };\n\n      var hasSelectionToolbars = doesPositionExist('selection');\n      var hasNodeToolbars = doesPositionExist('node');\n\n      if (hasSelectionToolbars || hasNodeToolbars) {\n        if (hasNodeToolbars && hasSelectionToolbars) {\n          var nodeToolbars = filterToolbarsByPosition('node');\n          var selectionToolbars = map$2(filterToolbarsByPosition('selection'), function (t) {\n            return __assign(__assign({}, t), {\n              position: 'node'\n            });\n          });\n          return nodeToolbars.concat(selectionToolbars);\n        } else {\n          return hasSelectionToolbars ? filterToolbarsByPosition('selection') : filterToolbarsByPosition('node');\n        }\n      } else {\n        return filterToolbarsByPosition('line');\n      }\n    }\n  };\n\n  var filterByPositionForAncestorNode = function (toolbars) {\n    if (toolbars.length <= 1) {\n      return toolbars;\n    } else {\n      var findPosition_1 = function (value) {\n        return find$5(toolbars, function (t) {\n          return t.position === value;\n        });\n      };\n\n      var basePosition = findPosition_1('selection').orThunk(function () {\n        return findPosition_1('node');\n      }).orThunk(function () {\n        return findPosition_1('line');\n      }).map(function (t) {\n        return t.position;\n      });\n      return basePosition.fold(function () {\n        return [];\n      }, function (pos) {\n        return filter$2(toolbars, function (t) {\n          return t.position === pos;\n        });\n      });\n    }\n  };\n\n  var matchStartNode = function (elem, nodeCandidates, editorCandidates) {\n    var nodeMatches = matchTargetWith(elem, nodeCandidates);\n\n    if (nodeMatches.contextForms.length > 0) {\n      return Optional.some({\n        elem: elem,\n        toolbars: [nodeMatches.contextForms[0]]\n      });\n    } else {\n      var editorMatches = matchTargetWith(elem, editorCandidates);\n\n      if (editorMatches.contextForms.length > 0) {\n        return Optional.some({\n          elem: elem,\n          toolbars: [editorMatches.contextForms[0]]\n        });\n      } else if (nodeMatches.contextToolbars.length > 0 || editorMatches.contextToolbars.length > 0) {\n        var toolbars = filterByPositionForStartNode(nodeMatches.contextToolbars.concat(editorMatches.contextToolbars));\n        return Optional.some({\n          elem: elem,\n          toolbars: toolbars\n        });\n      } else {\n        return Optional.none();\n      }\n    }\n  };\n\n  var matchAncestor = function (isRoot, startNode, scopes) {\n    if (isRoot(startNode)) {\n      return Optional.none();\n    } else {\n      return ancestor$2(startNode, function (ancestorElem) {\n        if (isElement$2(ancestorElem)) {\n          var _a = matchTargetWith(ancestorElem, scopes.inNodeScope),\n              contextToolbars = _a.contextToolbars,\n              contextForms = _a.contextForms;\n\n          var toolbars = contextForms.length > 0 ? contextForms : filterByPositionForAncestorNode(contextToolbars);\n          return toolbars.length > 0 ? Optional.some({\n            elem: ancestorElem,\n            toolbars: toolbars\n          }) : Optional.none();\n        } else {\n          return Optional.none();\n        }\n      }, isRoot);\n    }\n  };\n\n  var lookup$1 = function (scopes, editor) {\n    var rootElem = SugarElement.fromDom(editor.getBody());\n\n    var isRoot = function (elem) {\n      return eq(elem, rootElem);\n    };\n\n    var isOutsideRoot = function (startNode) {\n      return !isRoot(startNode) && !contains(rootElem, startNode);\n    };\n\n    var startNode = SugarElement.fromDom(editor.selection.getNode());\n\n    if (isOutsideRoot(startNode)) {\n      return Optional.none();\n    }\n\n    return matchStartNode(startNode, scopes.inNodeScope, scopes.inEditorScope).orThunk(function () {\n      return matchAncestor(isRoot, startNode, scopes);\n    });\n  };\n\n  var categorise = function (contextToolbars, navigate) {\n    var forms = {};\n    var inNodeScope = [];\n    var inEditorScope = [];\n    var formNavigators = {};\n    var lookupTable = {};\n\n    var registerForm = function (key, toolbarSpec) {\n      var contextForm = getOrDie(createContextForm(toolbarSpec));\n      forms[key] = contextForm;\n      contextForm.launch.map(function (launch) {\n        formNavigators['form:' + key + ''] = __assign(__assign({}, toolbarSpec.launch), {\n          type: launch.type === 'contextformtogglebutton' ? 'togglebutton' : 'button',\n          onAction: function () {\n            navigate(contextForm);\n          }\n        });\n      });\n\n      if (contextForm.scope === 'editor') {\n        inEditorScope.push(contextForm);\n      } else {\n        inNodeScope.push(contextForm);\n      }\n\n      lookupTable[key] = contextForm;\n    };\n\n    var registerToolbar = function (key, toolbarSpec) {\n      createContextToolbar(toolbarSpec).each(function (contextToolbar) {\n        if (toolbarSpec.scope === 'editor') {\n          inEditorScope.push(contextToolbar);\n        } else {\n          inNodeScope.push(contextToolbar);\n        }\n\n        lookupTable[key] = contextToolbar;\n      });\n    };\n\n    var keys$1 = keys(contextToolbars);\n    each$1(keys$1, function (key) {\n      var toolbarApi = contextToolbars[key];\n\n      if (toolbarApi.type === 'contextform') {\n        registerForm(key, toolbarApi);\n      } else if (toolbarApi.type === 'contexttoolbar') {\n        registerToolbar(key, toolbarApi);\n      }\n    });\n    return {\n      forms: forms,\n      inNodeScope: inNodeScope,\n      inEditorScope: inEditorScope,\n      lookupTable: lookupTable,\n      formNavigators: formNavigators\n    };\n  };\n\n  var forwardSlideEvent = generate$6('forward-slide');\n  var backSlideEvent = generate$6('backward-slide');\n  var changeSlideEvent = generate$6('change-slide-event');\n  var resizingClass = 'tox-pop--resizing';\n\n  var renderContextToolbar = function (spec) {\n    var stack = Cell([]);\n    return InlineView.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-pop']\n      },\n      fireDismissalEventInstead: {\n        event: 'doNotDismissYet'\n      },\n      onShow: function (comp) {\n        stack.set([]);\n        InlineView.getContent(comp).each(function (c) {\n          remove$6(c.element, 'visibility');\n        });\n        remove$2(comp.element, resizingClass);\n        remove$6(comp.element, 'width');\n      },\n      inlineBehaviours: derive$1([config('context-toolbar-events', [runOnSource(transitionend(), function (comp, se) {\n        if (se.event.raw.propertyName === 'width') {\n          remove$2(comp.element, resizingClass);\n          remove$6(comp.element, 'width');\n        }\n      }), run$1(changeSlideEvent, function (comp, se) {\n        var elem = comp.element;\n        remove$6(elem, 'width');\n        var currentWidth = get$a(elem);\n        InlineView.setContent(comp, se.event.contents);\n        add$2(elem, resizingClass);\n        var newWidth = get$a(elem);\n        set$7(elem, 'width', currentWidth + 'px');\n        InlineView.getContent(comp).each(function (newContents) {\n          se.event.focus.bind(function (f) {\n            focus$3(f);\n            return search(elem);\n          }).orThunk(function () {\n            Keying.focusIn(newContents);\n            return active(getRootNode(elem));\n          });\n        });\n        global$f.setTimeout(function () {\n          set$7(comp.element, 'width', newWidth + 'px');\n        }, 0);\n      }), run$1(forwardSlideEvent, function (comp, se) {\n        InlineView.getContent(comp).each(function (oldContents) {\n          stack.set(stack.get().concat([{\n            bar: oldContents,\n            focus: active(getRootNode(comp.element))\n          }]));\n        });\n        emitWith(comp, changeSlideEvent, {\n          contents: se.event.forwardContents,\n          focus: Optional.none()\n        });\n      }), run$1(backSlideEvent, function (comp, _se) {\n        last$2(stack.get()).each(function (last) {\n          stack.set(stack.get().slice(0, stack.get().length - 1));\n          emitWith(comp, changeSlideEvent, {\n            contents: premade(last.bar),\n            focus: last.focus\n          });\n        });\n      })]), Keying.config({\n        mode: 'special',\n        onEscape: function (comp) {\n          return last$2(stack.get()).fold(function () {\n            return spec.onEscape();\n          }, function (_) {\n            emit(comp, backSlideEvent);\n            return Optional.some(true);\n          });\n        }\n      })]),\n      lazySink: function () {\n        return Result.value(spec.sink);\n      }\n    });\n  };\n\n  var transitionClass = 'tox-pop--transition';\n\n  var register$7 = function (editor, registryContextToolbars, sink, extras) {\n    var backstage = extras.backstage;\n    var sharedBackstage = backstage.shared;\n    var isTouch = detect$1().deviceType.isTouch;\n    var lastElement = value$1();\n    var lastTrigger = value$1();\n    var lastContextPosition = value$1();\n    var contextbar = build$1(renderContextToolbar({\n      sink: sink,\n      onEscape: function () {\n        editor.focus();\n        return Optional.some(true);\n      }\n    }));\n\n    var getBounds = function () {\n      var position = lastContextPosition.get().getOr('node');\n      var margin = shouldUseInsetLayouts(position) ? 1 : 0;\n      return getContextToolbarBounds(editor, sharedBackstage, position, margin);\n    };\n\n    var canLaunchToolbar = function () {\n      return !editor.removed && !(isTouch() && backstage.isContextMenuOpen());\n    };\n\n    var isSameLaunchElement = function (elem) {\n      return is$1(lift2(elem, lastElement.get(), eq), true);\n    };\n\n    var shouldContextToolbarHide = function () {\n      if (!canLaunchToolbar()) {\n        return true;\n      } else {\n        var contextToolbarBounds = getBounds();\n        var anchorBounds = is$1(lastContextPosition.get(), 'node') ? getAnchorElementBounds(editor, lastElement.get()) : getSelectionBounds(editor);\n        return contextToolbarBounds.height <= 0 || !isVerticalOverlap(anchorBounds, contextToolbarBounds);\n      }\n    };\n\n    var close = function () {\n      lastElement.clear();\n      lastTrigger.clear();\n      lastContextPosition.clear();\n      InlineView.hide(contextbar);\n    };\n\n    var hideOrRepositionIfNecessary = function () {\n      if (InlineView.isOpen(contextbar)) {\n        var contextBarEle = contextbar.element;\n        remove$6(contextBarEle, 'display');\n\n        if (shouldContextToolbarHide()) {\n          set$7(contextBarEle, 'display', 'none');\n        } else {\n          lastTrigger.set(0);\n          InlineView.reposition(contextbar);\n        }\n      }\n    };\n\n    var wrapInPopDialog = function (toolbarSpec) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-pop__dialog']\n        },\n        components: [toolbarSpec],\n        behaviours: derive$1([Keying.config({\n          mode: 'acyclic'\n        }), config('pop-dialog-wrap-events', [runOnAttached(function (comp) {\n          editor.shortcuts.add('ctrl+F9', 'focus statusbar', function () {\n            return Keying.focusIn(comp);\n          });\n        }), runOnDetached(function (_comp) {\n          editor.shortcuts.remove('ctrl+F9');\n        })])])\n      };\n    };\n\n    var getScopes = cached(function () {\n      return categorise(registryContextToolbars, function (toolbarApi) {\n        var alloySpec = buildToolbar([toolbarApi]);\n        emitWith(contextbar, forwardSlideEvent, {\n          forwardContents: wrapInPopDialog(alloySpec)\n        });\n      });\n    });\n\n    var buildContextToolbarGroups = function (allButtons, ctx) {\n      return identifyButtons(editor, {\n        buttons: allButtons,\n        toolbar: ctx.items,\n        allowToolbarGroups: false\n      }, extras, Optional.some(['form:']));\n    };\n\n    var buildContextFormGroups = function (ctx, providers) {\n      return ContextForm.buildInitGroups(ctx, providers);\n    };\n\n    var buildToolbar = function (toolbars) {\n      var buttons = editor.ui.registry.getAll().buttons;\n      var scopes = getScopes();\n\n      var allButtons = __assign(__assign({}, buttons), scopes.formNavigators);\n\n      var toolbarType = getToolbarMode(editor) === ToolbarMode.scrolling ? ToolbarMode.scrolling : ToolbarMode.default;\n      var initGroups = flatten(map$2(toolbars, function (ctx) {\n        return ctx.type === 'contexttoolbar' ? buildContextToolbarGroups(allButtons, ctx) : buildContextFormGroups(ctx, sharedBackstage.providers);\n      }));\n      return renderToolbar({\n        type: toolbarType,\n        uid: generate$6('context-toolbar'),\n        initGroups: initGroups,\n        onEscape: Optional.none,\n        cyclicKeying: true,\n        providers: sharedBackstage.providers\n      });\n    };\n\n    var getAnchor = function (position, element) {\n      var anchorage = position === 'node' ? sharedBackstage.anchors.node(element) : sharedBackstage.anchors.cursor();\n      var anchorLayout = getAnchorLayout(editor, position, isTouch(), {\n        lastElement: lastElement.get,\n        isReposition: function () {\n          return is$1(lastTrigger.get(), 0);\n        },\n        getMode: function () {\n          return Positioning.getMode(sink);\n        }\n      });\n      return deepMerge(anchorage, anchorLayout);\n    };\n\n    var launchContext = function (toolbarApi, elem) {\n      launchContextToolbar.cancel();\n\n      if (!canLaunchToolbar()) {\n        return;\n      }\n\n      var toolbarSpec = buildToolbar(toolbarApi);\n      var position = toolbarApi[0].position;\n      var anchor = getAnchor(position, elem);\n      lastContextPosition.set(position);\n      lastTrigger.set(1);\n      var contextBarEle = contextbar.element;\n      remove$6(contextBarEle, 'display');\n\n      if (!isSameLaunchElement(elem)) {\n        remove$2(contextBarEle, transitionClass);\n        Positioning.reset(sink, contextbar);\n      }\n\n      InlineView.showWithinBounds(contextbar, wrapInPopDialog(toolbarSpec), {\n        anchor: anchor,\n        transition: {\n          classes: [transitionClass],\n          mode: 'placement'\n        }\n      }, function () {\n        return Optional.some(getBounds());\n      });\n      elem.fold(lastElement.clear, lastElement.set);\n\n      if (shouldContextToolbarHide()) {\n        set$7(contextBarEle, 'display', 'none');\n      }\n    };\n\n    var launchContextToolbar = last(function () {\n      if (!editor.hasFocus() || editor.removed) {\n        return;\n      }\n\n      if (has(contextbar.element, transitionClass)) {\n        launchContextToolbar.throttle();\n      } else {\n        var scopes = getScopes();\n        lookup$1(scopes, editor).fold(close, function (info) {\n          launchContext(info.toolbars, Optional.some(info.elem));\n        });\n      }\n    }, 17);\n    editor.on('init', function () {\n      editor.on('remove', close);\n      editor.on('ScrollContent ScrollWindow ObjectResized ResizeEditor longpress', hideOrRepositionIfNecessary);\n      editor.on('click keyup focus SetContent', launchContextToolbar.throttle);\n      editor.on(hideContextToolbarEvent, close);\n      editor.on(showContextToolbarEvent, function (e) {\n        var scopes = getScopes();\n        get$e(scopes.lookupTable, e.toolbarKey).each(function (ctx) {\n          launchContext([ctx], someIf(e.target !== editor, e.target));\n          InlineView.getContent(contextbar).each(Keying.focusIn);\n        });\n      });\n      editor.on('focusout', function (_e) {\n        global$f.setEditorTimeout(editor, function () {\n          if (search(sink.element).isNone() && search(contextbar.element).isNone()) {\n            close();\n          }\n        }, 0);\n      });\n      editor.on('SwitchMode', function () {\n        if (editor.mode.isReadOnly()) {\n          close();\n        }\n      });\n      editor.on('AfterProgressState', function (event) {\n        if (event.state) {\n          close();\n        } else if (editor.hasFocus()) {\n          launchContextToolbar.throttle();\n        }\n      });\n      editor.on('NodeChange', function (_e) {\n        search(contextbar.element).fold(launchContextToolbar.throttle, noop);\n      });\n    });\n  };\n\n  var register$6 = function (editor) {\n    var alignToolbarButtons = [{\n      name: 'alignleft',\n      text: 'Align left',\n      cmd: 'JustifyLeft',\n      icon: 'align-left'\n    }, {\n      name: 'aligncenter',\n      text: 'Align center',\n      cmd: 'JustifyCenter',\n      icon: 'align-center'\n    }, {\n      name: 'alignright',\n      text: 'Align right',\n      cmd: 'JustifyRight',\n      icon: 'align-right'\n    }, {\n      name: 'alignjustify',\n      text: 'Justify',\n      cmd: 'JustifyFull',\n      icon: 'align-justify'\n    }];\n    each$1(alignToolbarButtons, function (item) {\n      editor.ui.registry.addToggleButton(item.name, {\n        tooltip: item.text,\n        icon: item.icon,\n        onAction: onActionExecCommand(editor, item.cmd),\n        onSetup: onSetupFormatToggle(editor, item.name)\n      });\n    });\n    editor.ui.registry.addButton('alignnone', {\n      tooltip: 'No alignment',\n      icon: 'align-none',\n      onAction: onActionExecCommand(editor, 'JustifyNone')\n    });\n  };\n\n  var units = {\n    unsupportedLength: ['em', 'ex', 'cap', 'ch', 'ic', 'rem', 'lh', 'rlh', 'vw', 'vh', 'vi', 'vb', 'vmin', 'vmax', 'cm', 'mm', 'Q', 'in', 'pc', 'pt', 'px'],\n    fixed: ['px', 'pt'],\n    relative: ['%'],\n    empty: ['']\n  };\n\n  var pattern = function () {\n    var decimalDigits = '[0-9]+';\n    var signedInteger = '[+-]?' + decimalDigits;\n    var exponentPart = '[eE]' + signedInteger;\n    var dot = '\\\\.';\n\n    var opt = function (input) {\n      return '(?:' + input + ')?';\n    };\n\n    var unsignedDecimalLiteral = ['Infinity', decimalDigits + dot + opt(decimalDigits) + opt(exponentPart), dot + decimalDigits + opt(exponentPart), decimalDigits + opt(exponentPart)].join('|');\n    var float = '[+-]?(?:' + unsignedDecimalLiteral + ')';\n    return new RegExp('^(' + float + ')(.*)$');\n  }();\n\n  var isUnit = function (unit, accepted) {\n    return exists(accepted, function (acc) {\n      return exists(units[acc], function (check) {\n        return unit === check;\n      });\n    });\n  };\n\n  var parse = function (input, accepted) {\n    var match = Optional.from(pattern.exec(input));\n    return match.bind(function (array) {\n      var value = Number(array[1]);\n      var unitRaw = array[2];\n\n      if (isUnit(unitRaw, accepted)) {\n        return Optional.some({\n          value: value,\n          unit: unitRaw\n        });\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var normalise = function (input, accepted) {\n    return parse(input, accepted).map(function (_a) {\n      var value = _a.value,\n          unit = _a.unit;\n      return value + unit;\n    });\n  };\n\n  var registerController = function (editor, spec) {\n    var getMenuItems = function () {\n      var options = spec.getOptions(editor);\n      var initial = spec.getCurrent(editor).map(spec.hash);\n      var current = value$1();\n      return map$2(options, function (value) {\n        return {\n          type: 'togglemenuitem',\n          text: spec.display(value),\n          onSetup: function (api) {\n            var setActive = function (active) {\n              if (active) {\n                current.on(function (oldApi) {\n                  return oldApi.setActive(false);\n                });\n                current.set(api);\n              }\n\n              api.setActive(active);\n            };\n\n            setActive(is$1(initial, spec.hash(value)));\n            var unbindWatcher = spec.watcher(editor, value, setActive);\n            return function () {\n              current.clear();\n              unbindWatcher();\n            };\n          },\n          onAction: function () {\n            return spec.setCurrent(editor, value);\n          }\n        };\n      });\n    };\n\n    editor.ui.registry.addMenuButton(spec.name, {\n      tooltip: spec.text,\n      icon: spec.icon,\n      fetch: function (callback) {\n        return callback(getMenuItems());\n      },\n      onSetup: spec.onToolbarSetup\n    });\n    editor.ui.registry.addNestedMenuItem(spec.name, {\n      type: 'nestedmenuitem',\n      text: spec.text,\n      getSubmenuItems: getMenuItems,\n      onSetup: spec.onMenuSetup\n    });\n  };\n\n  var lineHeightSpec = {\n    name: 'lineheight',\n    text: 'Line height',\n    icon: 'line-height',\n    getOptions: getLineHeightFormats,\n    hash: function (input) {\n      return normalise(input, ['fixed', 'relative', 'empty']).getOr(input);\n    },\n    display: identity$1,\n    watcher: function (editor, value, callback) {\n      return editor.formatter.formatChanged('lineheight', callback, false, {\n        value: value\n      }).unbind;\n    },\n    getCurrent: function (editor) {\n      return Optional.from(editor.queryCommandValue('LineHeight'));\n    },\n    setCurrent: function (editor, value) {\n      return editor.execCommand('LineHeight', false, value);\n    }\n  };\n\n  var languageSpec = function (editor) {\n    var settingsOpt = Optional.from(getContentLanguages(editor));\n    return settingsOpt.map(function (settings) {\n      return {\n        name: 'language',\n        text: 'Language',\n        icon: 'language',\n        getOptions: constant$1(settings),\n        hash: function (input) {\n          return isUndefined(input.customCode) ? input.code : input.code + '/' + input.customCode;\n        },\n        display: function (input) {\n          return input.title;\n        },\n        watcher: function (editor, value, callback) {\n          return editor.formatter.formatChanged('lang', callback, false, {\n            value: value.code,\n            customValue: value.customCode\n          }).unbind;\n        },\n        getCurrent: function (editor) {\n          var node = SugarElement.fromDom(editor.selection.getNode());\n          return closest$4(node, function (n) {\n            return Optional.some(n).filter(isElement$2).bind(function (ele) {\n              var codeOpt = getOpt(ele, 'lang');\n              return codeOpt.map(function (code) {\n                var customCode = getOpt(ele, 'data-mce-lang').getOrUndefined();\n                return {\n                  code: code,\n                  customCode: customCode,\n                  title: ''\n                };\n              });\n            });\n          });\n        },\n        setCurrent: function (editor, lang) {\n          return editor.execCommand('Lang', false, lang);\n        },\n        onToolbarSetup: function (api) {\n          var unbinder = unbindable();\n          api.setActive(editor.formatter.match('lang', {}, undefined, true));\n          unbinder.set(editor.formatter.formatChanged('lang', api.setActive, true));\n          return unbinder.clear;\n        }\n      };\n    });\n  };\n\n  var register$5 = function (editor) {\n    registerController(editor, lineHeightSpec);\n    languageSpec(editor).each(function (spec) {\n      return registerController(editor, spec);\n    });\n  };\n\n  var register$4 = function (editor, backstage) {\n    alignSelectMenu(editor, backstage);\n    fontSelectMenu(editor, backstage);\n    styleSelectMenu(editor, backstage);\n    formatSelectMenu(editor, backstage);\n    fontsizeSelectMenu(editor, backstage);\n  };\n\n  var onSetupOutdentState = function (editor) {\n    return onSetupEvent(editor, 'NodeChange', function (api) {\n      api.setDisabled(!editor.queryCommandState('outdent'));\n    });\n  };\n\n  var registerButtons$2 = function (editor) {\n    editor.ui.registry.addButton('outdent', {\n      tooltip: 'Decrease indent',\n      icon: 'outdent',\n      onSetup: onSetupOutdentState(editor),\n      onAction: onActionExecCommand(editor, 'outdent')\n    });\n    editor.ui.registry.addButton('indent', {\n      tooltip: 'Increase indent',\n      icon: 'indent',\n      onAction: onActionExecCommand(editor, 'indent')\n    });\n  };\n\n  var register$3 = function (editor) {\n    registerButtons$2(editor);\n  };\n\n  var onActionToggleFormat = function (editor, fmt) {\n    return function () {\n      editor.execCommand('mceToggleFormat', false, fmt);\n    };\n  };\n\n  var registerFormatButtons = function (editor) {\n    global$5.each([{\n      name: 'bold',\n      text: 'Bold',\n      icon: 'bold'\n    }, {\n      name: 'italic',\n      text: 'Italic',\n      icon: 'italic'\n    }, {\n      name: 'underline',\n      text: 'Underline',\n      icon: 'underline'\n    }, {\n      name: 'strikethrough',\n      text: 'Strikethrough',\n      icon: 'strike-through'\n    }, {\n      name: 'subscript',\n      text: 'Subscript',\n      icon: 'subscript'\n    }, {\n      name: 'superscript',\n      text: 'Superscript',\n      icon: 'superscript'\n    }], function (btn, _idx) {\n      editor.ui.registry.addToggleButton(btn.name, {\n        tooltip: btn.text,\n        icon: btn.icon,\n        onSetup: onSetupFormatToggle(editor, btn.name),\n        onAction: onActionToggleFormat(editor, btn.name)\n      });\n    });\n\n    for (var i = 1; i <= 6; i++) {\n      var name_1 = 'h' + i;\n      editor.ui.registry.addToggleButton(name_1, {\n        text: name_1.toUpperCase(),\n        tooltip: 'Heading ' + i,\n        onSetup: onSetupFormatToggle(editor, name_1),\n        onAction: onActionToggleFormat(editor, name_1)\n      });\n    }\n  };\n\n  var registerCommandButtons = function (editor) {\n    global$5.each([{\n      name: 'cut',\n      text: 'Cut',\n      action: 'Cut',\n      icon: 'cut'\n    }, {\n      name: 'copy',\n      text: 'Copy',\n      action: 'Copy',\n      icon: 'copy'\n    }, {\n      name: 'paste',\n      text: 'Paste',\n      action: 'Paste',\n      icon: 'paste'\n    }, {\n      name: 'help',\n      text: 'Help',\n      action: 'mceHelp',\n      icon: 'help'\n    }, {\n      name: 'selectall',\n      text: 'Select all',\n      action: 'SelectAll',\n      icon: 'select-all'\n    }, {\n      name: 'newdocument',\n      text: 'New document',\n      action: 'mceNewDocument',\n      icon: 'new-document'\n    }, {\n      name: 'removeformat',\n      text: 'Clear formatting',\n      action: 'RemoveFormat',\n      icon: 'remove-formatting'\n    }, {\n      name: 'remove',\n      text: 'Remove',\n      action: 'Delete',\n      icon: 'remove'\n    }], function (btn) {\n      editor.ui.registry.addButton(btn.name, {\n        tooltip: btn.text,\n        icon: btn.icon,\n        onAction: onActionExecCommand(editor, btn.action)\n      });\n    });\n  };\n\n  var registerCommandToggleButtons = function (editor) {\n    global$5.each([{\n      name: 'blockquote',\n      text: 'Blockquote',\n      action: 'mceBlockQuote',\n      icon: 'quote'\n    }], function (btn) {\n      editor.ui.registry.addToggleButton(btn.name, {\n        tooltip: btn.text,\n        icon: btn.icon,\n        onAction: onActionExecCommand(editor, btn.action),\n        onSetup: onSetupFormatToggle(editor, btn.name)\n      });\n    });\n  };\n\n  var registerButtons$1 = function (editor) {\n    registerFormatButtons(editor);\n    registerCommandButtons(editor);\n    registerCommandToggleButtons(editor);\n  };\n\n  var registerMenuItems$2 = function (editor) {\n    global$5.each([{\n      name: 'bold',\n      text: 'Bold',\n      action: 'Bold',\n      icon: 'bold',\n      shortcut: 'Meta+B'\n    }, {\n      name: 'italic',\n      text: 'Italic',\n      action: 'Italic',\n      icon: 'italic',\n      shortcut: 'Meta+I'\n    }, {\n      name: 'underline',\n      text: 'Underline',\n      action: 'Underline',\n      icon: 'underline',\n      shortcut: 'Meta+U'\n    }, {\n      name: 'strikethrough',\n      text: 'Strikethrough',\n      action: 'Strikethrough',\n      icon: 'strike-through',\n      shortcut: ''\n    }, {\n      name: 'subscript',\n      text: 'Subscript',\n      action: 'Subscript',\n      icon: 'subscript',\n      shortcut: ''\n    }, {\n      name: 'superscript',\n      text: 'Superscript',\n      action: 'Superscript',\n      icon: 'superscript',\n      shortcut: ''\n    }, {\n      name: 'removeformat',\n      text: 'Clear formatting',\n      action: 'RemoveFormat',\n      icon: 'remove-formatting',\n      shortcut: ''\n    }, {\n      name: 'newdocument',\n      text: 'New document',\n      action: 'mceNewDocument',\n      icon: 'new-document',\n      shortcut: ''\n    }, {\n      name: 'cut',\n      text: 'Cut',\n      action: 'Cut',\n      icon: 'cut',\n      shortcut: 'Meta+X'\n    }, {\n      name: 'copy',\n      text: 'Copy',\n      action: 'Copy',\n      icon: 'copy',\n      shortcut: 'Meta+C'\n    }, {\n      name: 'paste',\n      text: 'Paste',\n      action: 'Paste',\n      icon: 'paste',\n      shortcut: 'Meta+V'\n    }, {\n      name: 'selectall',\n      text: 'Select all',\n      action: 'SelectAll',\n      icon: 'select-all',\n      shortcut: 'Meta+A'\n    }], function (btn) {\n      editor.ui.registry.addMenuItem(btn.name, {\n        text: btn.text,\n        icon: btn.icon,\n        shortcut: btn.shortcut,\n        onAction: onActionExecCommand(editor, btn.action)\n      });\n    });\n    editor.ui.registry.addMenuItem('codeformat', {\n      text: 'Code',\n      icon: 'sourcecode',\n      onAction: onActionToggleFormat(editor, 'code')\n    });\n  };\n\n  var register$2 = function (editor) {\n    registerButtons$1(editor);\n    registerMenuItems$2(editor);\n  };\n\n  var onSetupUndoRedoState = function (editor, type) {\n    return onSetupEvent(editor, 'Undo Redo AddUndo TypingUndo ClearUndos SwitchMode', function (api) {\n      api.setDisabled(editor.mode.isReadOnly() || !editor.undoManager[type]());\n    });\n  };\n\n  var registerMenuItems$1 = function (editor) {\n    editor.ui.registry.addMenuItem('undo', {\n      text: 'Undo',\n      icon: 'undo',\n      shortcut: 'Meta+Z',\n      onSetup: onSetupUndoRedoState(editor, 'hasUndo'),\n      onAction: onActionExecCommand(editor, 'undo')\n    });\n    editor.ui.registry.addMenuItem('redo', {\n      text: 'Redo',\n      icon: 'redo',\n      shortcut: 'Meta+Y',\n      onSetup: onSetupUndoRedoState(editor, 'hasRedo'),\n      onAction: onActionExecCommand(editor, 'redo')\n    });\n  };\n\n  var registerButtons = function (editor) {\n    editor.ui.registry.addButton('undo', {\n      tooltip: 'Undo',\n      icon: 'undo',\n      disabled: true,\n      onSetup: onSetupUndoRedoState(editor, 'hasUndo'),\n      onAction: onActionExecCommand(editor, 'undo')\n    });\n    editor.ui.registry.addButton('redo', {\n      tooltip: 'Redo',\n      icon: 'redo',\n      disabled: true,\n      onSetup: onSetupUndoRedoState(editor, 'hasRedo'),\n      onAction: onActionExecCommand(editor, 'redo')\n    });\n  };\n\n  var register$1 = function (editor) {\n    registerMenuItems$1(editor);\n    registerButtons(editor);\n  };\n\n  var onSetupVisualAidState = function (editor) {\n    return onSetupEvent(editor, 'VisualAid', function (api) {\n      api.setActive(editor.hasVisual);\n    });\n  };\n\n  var registerMenuItems = function (editor) {\n    editor.ui.registry.addToggleMenuItem('visualaid', {\n      text: 'Visual aids',\n      onSetup: onSetupVisualAidState(editor),\n      onAction: onActionExecCommand(editor, 'mceToggleVisualAid')\n    });\n  };\n\n  var registerToolbarButton = function (editor) {\n    editor.ui.registry.addButton('visualaid', {\n      tooltip: 'Visual aids',\n      text: 'Visual aids',\n      onAction: onActionExecCommand(editor, 'mceToggleVisualAid')\n    });\n  };\n\n  var register = function (editor) {\n    registerToolbarButton(editor);\n    registerMenuItems(editor);\n  };\n\n  var setup$6 = function (editor, backstage) {\n    register$6(editor);\n    register$2(editor);\n    register$4(editor, backstage);\n    register$1(editor);\n    register$a(editor);\n    register(editor);\n    register$3(editor);\n    register$5(editor);\n  };\n\n  var nu = function (x, y) {\n    return {\n      type: 'makeshift',\n      x: x,\n      y: y\n    };\n  };\n\n  var transpose = function (pos, dx, dy) {\n    return nu(pos.x + dx, pos.y + dy);\n  };\n\n  var isTouchEvent = function (e) {\n    return e.type === 'longpress' || e.type.indexOf('touch') === 0;\n  };\n\n  var fromPageXY = function (e) {\n    if (isTouchEvent(e)) {\n      var touch = e.touches[0];\n      return nu(touch.pageX, touch.pageY);\n    } else {\n      return nu(e.pageX, e.pageY);\n    }\n  };\n\n  var fromClientXY = function (e) {\n    if (isTouchEvent(e)) {\n      var touch = e.touches[0];\n      return nu(touch.clientX, touch.clientY);\n    } else {\n      return nu(e.clientX, e.clientY);\n    }\n  };\n\n  var transposeContentAreaContainer = function (element, pos) {\n    var containerPos = global$b.DOM.getPos(element);\n    return transpose(pos, containerPos.x, containerPos.y);\n  };\n\n  var getPointAnchor = function (editor, e) {\n    if (e.type === 'contextmenu' || e.type === 'longpress') {\n      if (editor.inline) {\n        return fromPageXY(e);\n      } else {\n        return transposeContentAreaContainer(editor.getContentAreaContainer(), fromClientXY(e));\n      }\n    } else {\n      return getSelectionAnchor(editor);\n    }\n  };\n\n  var getSelectionAnchor = function (editor) {\n    return {\n      type: 'selection',\n      root: SugarElement.fromDom(editor.selection.getNode())\n    };\n  };\n\n  var getNodeAnchor = function (editor) {\n    return {\n      type: 'node',\n      node: Optional.some(SugarElement.fromDom(editor.selection.getNode())),\n      root: SugarElement.fromDom(editor.getBody())\n    };\n  };\n\n  var getAnchorSpec$1 = function (editor, e, anchorType) {\n    switch (anchorType) {\n      case 'node':\n        return getNodeAnchor(editor);\n\n      case 'point':\n        return getPointAnchor(editor, e);\n\n      case 'selection':\n        return getSelectionAnchor(editor);\n    }\n  };\n\n  var initAndShow$1 = function (editor, e, buildMenu, backstage, contextmenu, anchorType) {\n    var items = buildMenu();\n    var anchorSpec = getAnchorSpec$1(editor, e, anchorType);\n    build(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false).map(function (menuData) {\n      e.preventDefault();\n      InlineView.showMenuAt(contextmenu, {\n        anchor: anchorSpec\n      }, {\n        menu: {\n          markers: markers('normal')\n        },\n        data: menuData\n      });\n    });\n  };\n\n  var layouts = {\n    onLtr: function () {\n      return [south$2, southeast$2, southwest$2, northeast$2, northwest$2, north$2, north, south, northeast, southeast, northwest, southwest];\n    },\n    onRtl: function () {\n      return [south$2, southwest$2, southeast$2, northwest$2, northeast$2, north$2, north, south, northwest, southwest, northeast, southeast];\n    }\n  };\n  var bubbleSize = 12;\n  var bubbleAlignments = {\n    valignCentre: [],\n    alignCentre: [],\n    alignLeft: ['tox-pop--align-left'],\n    alignRight: ['tox-pop--align-right'],\n    right: ['tox-pop--right'],\n    left: ['tox-pop--left'],\n    bottom: ['tox-pop--bottom'],\n    top: ['tox-pop--top']\n  };\n\n  var isTouchWithinSelection = function (editor, e) {\n    var selection = editor.selection;\n\n    if (selection.isCollapsed() || e.touches.length < 1) {\n      return false;\n    } else {\n      var touch_1 = e.touches[0];\n      var rng = selection.getRng();\n      var rngRectOpt = getFirstRect(editor.getWin(), SimSelection.domRange(rng));\n      return rngRectOpt.exists(function (rngRect) {\n        return rngRect.left <= touch_1.clientX && rngRect.right >= touch_1.clientX && rngRect.top <= touch_1.clientY && rngRect.bottom >= touch_1.clientY;\n      });\n    }\n  };\n\n  var setupiOSOverrides = function (editor) {\n    var originalSelection = editor.selection.getRng();\n\n    var selectionReset = function () {\n      global$f.setEditorTimeout(editor, function () {\n        editor.selection.setRng(originalSelection);\n      }, 10);\n      unbindEventListeners();\n    };\n\n    editor.once('touchend', selectionReset);\n\n    var preventMousedown = function (e) {\n      e.preventDefault();\n      e.stopImmediatePropagation();\n    };\n\n    editor.on('mousedown', preventMousedown, true);\n\n    var clearSelectionReset = function () {\n      return unbindEventListeners();\n    };\n\n    editor.once('longpresscancel', clearSelectionReset);\n\n    var unbindEventListeners = function () {\n      editor.off('touchend', selectionReset);\n      editor.off('longpresscancel', clearSelectionReset);\n      editor.off('mousedown', preventMousedown);\n    };\n  };\n\n  var getAnchorSpec = function (editor, e, anchorType) {\n    var anchorSpec = getAnchorSpec$1(editor, e, anchorType);\n    var bubbleYOffset = anchorType === 'point' ? bubbleSize : 0;\n    return __assign({\n      bubble: nu$5(0, bubbleYOffset, bubbleAlignments),\n      layouts: layouts,\n      overrides: {\n        maxWidthFunction: expandable(),\n        maxHeightFunction: expandable$1()\n      }\n    }, anchorSpec);\n  };\n\n  var show = function (editor, e, items, backstage, contextmenu, anchorType, highlightImmediately) {\n    var anchorSpec = getAnchorSpec(editor, e, anchorType);\n    build(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, true).map(function (menuData) {\n      e.preventDefault();\n      InlineView.showMenuWithinBounds(contextmenu, {\n        anchor: anchorSpec\n      }, {\n        menu: {\n          markers: markers('normal'),\n          highlightImmediately: highlightImmediately\n        },\n        data: menuData,\n        type: 'horizontal'\n      }, function () {\n        return Optional.some(getContextToolbarBounds(editor, backstage.shared, anchorType === 'node' ? 'node' : 'selection'));\n      });\n      editor.fire(hideContextToolbarEvent);\n    });\n  };\n\n  var initAndShow = function (editor, e, buildMenu, backstage, contextmenu, anchorType) {\n    var detection = detect$1();\n    var isiOS = detection.os.isiOS();\n    var isOSX = detection.os.isOSX();\n    var isAndroid = detection.os.isAndroid();\n    var isTouch = detection.deviceType.isTouch();\n\n    var shouldHighlightImmediately = function () {\n      return !(isAndroid || isiOS || isOSX && isTouch);\n    };\n\n    var open = function () {\n      var items = buildMenu();\n      show(editor, e, items, backstage, contextmenu, anchorType, shouldHighlightImmediately());\n    };\n\n    if ((isOSX || isiOS) && anchorType !== 'node') {\n      var openiOS_1 = function () {\n        setupiOSOverrides(editor);\n        open();\n      };\n\n      if (isTouchWithinSelection(editor, e)) {\n        openiOS_1();\n      } else {\n        editor.once('selectionchange', openiOS_1);\n        editor.once('touchend', function () {\n          return editor.off('selectionchange', openiOS_1);\n        });\n      }\n    } else {\n      open();\n    }\n  };\n\n  var patchPipeConfig = function (config) {\n    return typeof config === 'string' ? config.split(/[ ,]/) : config;\n  };\n\n  var shouldNeverUseNative = function (editor) {\n    return editor.getParam('contextmenu_never_use_native', false, 'boolean');\n  };\n\n  var getMenuItems = function (editor, name, defaultItems) {\n    var contextMenus = editor.ui.registry.getAll().contextMenus;\n    return Optional.from(editor.getParam(name)).map(patchPipeConfig).getOrThunk(function () {\n      return filter$2(patchPipeConfig(defaultItems), function (item) {\n        return has$2(contextMenus, item);\n      });\n    });\n  };\n\n  var isContextMenuDisabled = function (editor) {\n    return editor.getParam('contextmenu') === false;\n  };\n\n  var getContextMenu = function (editor) {\n    return getMenuItems(editor, 'contextmenu', 'link linkchecker image imagetools table spellchecker configurepermanentpen');\n  };\n\n  var getAvoidOverlapSelector = function (editor) {\n    return editor.getParam('contextmenu_avoid_overlap', '', 'string');\n  };\n\n  var isSeparator = function (item) {\n    return isString(item) ? item === '|' : item.type === 'separator';\n  };\n\n  var separator = {\n    type: 'separator'\n  };\n\n  var makeContextItem = function (item) {\n    var commonMenuItem = function (item) {\n      return {\n        text: item.text,\n        icon: item.icon,\n        disabled: item.disabled,\n        shortcut: item.shortcut\n      };\n    };\n\n    if (isString(item)) {\n      return item;\n    } else {\n      switch (item.type) {\n        case 'separator':\n          return separator;\n\n        case 'submenu':\n          return __assign(__assign({\n            type: 'nestedmenuitem'\n          }, commonMenuItem(item)), {\n            getSubmenuItems: function () {\n              var items = item.getSubmenuItems();\n\n              if (isString(items)) {\n                return items;\n              } else {\n                return map$2(items, makeContextItem);\n              }\n            }\n          });\n\n        default:\n          return __assign(__assign({\n            type: 'menuitem'\n          }, commonMenuItem(item)), {\n            onAction: noarg(item.onAction)\n          });\n      }\n    }\n  };\n\n  var addContextMenuGroup = function (xs, groupItems) {\n    if (groupItems.length === 0) {\n      return xs;\n    }\n\n    var lastMenuItem = last$2(xs).filter(function (item) {\n      return !isSeparator(item);\n    });\n    var before = lastMenuItem.fold(function () {\n      return [];\n    }, function (_) {\n      return [separator];\n    });\n    return xs.concat(before).concat(groupItems).concat([separator]);\n  };\n\n  var generateContextMenu = function (contextMenus, menuConfig, selectedElement) {\n    var sections = foldl(menuConfig, function (acc, name) {\n      return get$e(contextMenus, name.toLowerCase()).map(function (menu) {\n        var items = menu.update(selectedElement);\n\n        if (isString(items)) {\n          return addContextMenuGroup(acc, items.split(' '));\n        } else if (items.length > 0) {\n          var allItems = map$2(items, makeContextItem);\n          return addContextMenuGroup(acc, allItems);\n        } else {\n          return acc;\n        }\n      }).getOrThunk(function () {\n        return acc.concat([name]);\n      });\n    }, []);\n\n    if (sections.length > 0 && isSeparator(sections[sections.length - 1])) {\n      sections.pop();\n    }\n\n    return sections;\n  };\n\n  var isNativeOverrideKeyEvent = function (editor, e) {\n    return e.ctrlKey && !shouldNeverUseNative(editor);\n  };\n\n  var isTriggeredByKeyboard = function (editor, e) {\n    return e.type !== 'longpress' && (e.button !== 2 || e.target === editor.getBody() && e.pointerType === '');\n  };\n\n  var getSelectedElement = function (editor, e) {\n    return isTriggeredByKeyboard(editor, e) ? editor.selection.getStart(true) : e.target;\n  };\n\n  var getAnchorType = function (editor, e) {\n    var selector = getAvoidOverlapSelector(editor);\n    var anchorType = isTriggeredByKeyboard(editor, e) ? 'selection' : 'point';\n\n    if (isNotEmpty(selector)) {\n      var target = getSelectedElement(editor, e);\n      var selectorExists = closest(SugarElement.fromDom(target), selector);\n      return selectorExists ? 'node' : anchorType;\n    } else {\n      return anchorType;\n    }\n  };\n\n  var setup$5 = function (editor, lazySink, backstage) {\n    var detection = detect$1();\n    var isTouch = detection.deviceType.isTouch;\n    var contextmenu = build$1(InlineView.sketch({\n      dom: {\n        tag: 'div'\n      },\n      lazySink: lazySink,\n      onEscape: function () {\n        return editor.focus();\n      },\n      onShow: function () {\n        return backstage.setContextMenuState(true);\n      },\n      onHide: function () {\n        return backstage.setContextMenuState(false);\n      },\n      fireDismissalEventInstead: {},\n      inlineBehaviours: derive$1([config('dismissContextMenu', [run$1(dismissRequested(), function (comp, _se) {\n        Sandboxing.close(comp);\n        editor.focus();\n      })])])\n    }));\n\n    var hideContextMenu = function (_e) {\n      return InlineView.hide(contextmenu);\n    };\n\n    var showContextMenu = function (e) {\n      if (shouldNeverUseNative(editor)) {\n        e.preventDefault();\n      }\n\n      if (isNativeOverrideKeyEvent(editor, e) || isContextMenuDisabled(editor)) {\n        return;\n      }\n\n      var anchorType = getAnchorType(editor, e);\n\n      var buildMenu = function () {\n        var selectedElement = getSelectedElement(editor, e);\n        var registry = editor.ui.registry.getAll();\n        var menuConfig = getContextMenu(editor);\n        return generateContextMenu(registry.contextMenus, menuConfig, selectedElement);\n      };\n\n      var initAndShow$2 = isTouch() ? initAndShow : initAndShow$1;\n      initAndShow$2(editor, e, buildMenu, backstage, contextmenu, anchorType);\n    };\n\n    editor.on('init', function () {\n      var hideEvents = 'ResizeEditor ScrollContent ScrollWindow longpresscancel' + (isTouch() ? '' : ' ResizeWindow');\n      editor.on(hideEvents, hideContextMenu);\n      editor.on('longpress contextmenu', showContextMenu);\n    });\n  };\n\n  var adt = Adt.generate([{\n    offset: ['x', 'y']\n  }, {\n    absolute: ['x', 'y']\n  }, {\n    fixed: ['x', 'y']\n  }]);\n\n  var subtract = function (change) {\n    return function (point) {\n      return point.translate(-change.left, -change.top);\n    };\n  };\n\n  var add = function (change) {\n    return function (point) {\n      return point.translate(change.left, change.top);\n    };\n  };\n\n  var transform = function (changes) {\n    return function (x, y) {\n      return foldl(changes, function (rest, f) {\n        return f(rest);\n      }, SugarPosition(x, y));\n    };\n  };\n\n  var asFixed = function (coord, scroll, origin) {\n    return coord.fold(transform([add(origin), subtract(scroll)]), transform([subtract(scroll)]), transform([]));\n  };\n\n  var asAbsolute = function (coord, scroll, origin) {\n    return coord.fold(transform([add(origin)]), transform([]), transform([add(scroll)]));\n  };\n\n  var asOffset = function (coord, scroll, origin) {\n    return coord.fold(transform([]), transform([subtract(origin)]), transform([add(scroll), subtract(origin)]));\n  };\n\n  var withinRange = function (coord1, coord2, xRange, yRange, scroll, origin) {\n    var a1 = asAbsolute(coord1, scroll, origin);\n    var a2 = asAbsolute(coord2, scroll, origin);\n    return Math.abs(a1.left - a2.left) <= xRange && Math.abs(a1.top - a2.top) <= yRange;\n  };\n\n  var getDeltas = function (coord1, coord2, xRange, yRange, scroll, origin) {\n    var a1 = asAbsolute(coord1, scroll, origin);\n    var a2 = asAbsolute(coord2, scroll, origin);\n    var left = Math.abs(a1.left - a2.left);\n    var top = Math.abs(a1.top - a2.top);\n    return SugarPosition(left, top);\n  };\n\n  var toStyles = function (coord, scroll, origin) {\n    var stylesOpt = coord.fold(function (x, y) {\n      return {\n        position: Optional.some('absolute'),\n        left: Optional.some(x + 'px'),\n        top: Optional.some(y + 'px')\n      };\n    }, function (x, y) {\n      return {\n        position: Optional.some('absolute'),\n        left: Optional.some(x - origin.left + 'px'),\n        top: Optional.some(y - origin.top + 'px')\n      };\n    }, function (x, y) {\n      return {\n        position: Optional.some('fixed'),\n        left: Optional.some(x + 'px'),\n        top: Optional.some(y + 'px')\n      };\n    });\n    return __assign({\n      right: Optional.none(),\n      bottom: Optional.none()\n    }, stylesOpt);\n  };\n\n  var translate = function (coord, deltaX, deltaY) {\n    return coord.fold(function (x, y) {\n      return offset(x + deltaX, y + deltaY);\n    }, function (x, y) {\n      return absolute(x + deltaX, y + deltaY);\n    }, function (x, y) {\n      return fixed(x + deltaX, y + deltaY);\n    });\n  };\n\n  var absorb = function (partialCoord, originalCoord, scroll, origin) {\n    var absorbOne = function (stencil, nu) {\n      return function (optX, optY) {\n        var original = stencil(originalCoord, scroll, origin);\n        return nu(optX.getOr(original.left), optY.getOr(original.top));\n      };\n    };\n\n    return partialCoord.fold(absorbOne(asOffset, offset), absorbOne(asAbsolute, absolute), absorbOne(asFixed, fixed));\n  };\n\n  var offset = adt.offset;\n  var absolute = adt.absolute;\n  var fixed = adt.fixed;\n\n  var parseAttrToInt = function (element, name) {\n    var value = get$d(element, name);\n    return isUndefined(value) ? NaN : parseInt(value, 10);\n  };\n\n  var get = function (component, snapsInfo) {\n    var element = component.element;\n    var x = parseAttrToInt(element, snapsInfo.leftAttr);\n    var y = parseAttrToInt(element, snapsInfo.topAttr);\n    return isNaN(x) || isNaN(y) ? Optional.none() : Optional.some(SugarPosition(x, y));\n  };\n\n  var set = function (component, snapsInfo, pt) {\n    var element = component.element;\n    set$8(element, snapsInfo.leftAttr, pt.left + 'px');\n    set$8(element, snapsInfo.topAttr, pt.top + 'px');\n  };\n\n  var clear = function (component, snapsInfo) {\n    var element = component.element;\n    remove$7(element, snapsInfo.leftAttr);\n    remove$7(element, snapsInfo.topAttr);\n  };\n\n  var getCoords = function (component, snapInfo, coord, delta) {\n    return get(component, snapInfo).fold(function () {\n      return coord;\n    }, function (fixed$1) {\n      return fixed(fixed$1.left + delta.left, fixed$1.top + delta.top);\n    });\n  };\n\n  var moveOrSnap = function (component, snapInfo, coord, delta, scroll, origin) {\n    var newCoord = getCoords(component, snapInfo, coord, delta);\n    var snap = snapInfo.mustSnap ? findClosestSnap(component, snapInfo, newCoord, scroll, origin) : findSnap(component, snapInfo, newCoord, scroll, origin);\n    var fixedCoord = asFixed(newCoord, scroll, origin);\n    set(component, snapInfo, fixedCoord);\n    return snap.fold(function () {\n      return {\n        coord: fixed(fixedCoord.left, fixedCoord.top),\n        extra: Optional.none()\n      };\n    }, function (spanned) {\n      return {\n        coord: spanned.output,\n        extra: spanned.extra\n      };\n    });\n  };\n\n  var stopDrag = function (component, snapInfo) {\n    clear(component, snapInfo);\n  };\n\n  var findMatchingSnap = function (snaps, newCoord, scroll, origin) {\n    return findMap(snaps, function (snap) {\n      var sensor = snap.sensor;\n      var inRange = withinRange(newCoord, sensor, snap.range.left, snap.range.top, scroll, origin);\n      return inRange ? Optional.some({\n        output: absorb(snap.output, newCoord, scroll, origin),\n        extra: snap.extra\n      }) : Optional.none();\n    });\n  };\n\n  var findClosestSnap = function (component, snapInfo, newCoord, scroll, origin) {\n    var snaps = snapInfo.getSnapPoints(component);\n    var matchSnap = findMatchingSnap(snaps, newCoord, scroll, origin);\n    return matchSnap.orThunk(function () {\n      var bestSnap = foldl(snaps, function (acc, snap) {\n        var sensor = snap.sensor;\n        var deltas = getDeltas(newCoord, sensor, snap.range.left, snap.range.top, scroll, origin);\n        return acc.deltas.fold(function () {\n          return {\n            deltas: Optional.some(deltas),\n            snap: Optional.some(snap)\n          };\n        }, function (bestDeltas) {\n          var currAvg = (deltas.left + deltas.top) / 2;\n          var bestAvg = (bestDeltas.left + bestDeltas.top) / 2;\n\n          if (currAvg <= bestAvg) {\n            return {\n              deltas: Optional.some(deltas),\n              snap: Optional.some(snap)\n            };\n          } else {\n            return acc;\n          }\n        });\n      }, {\n        deltas: Optional.none(),\n        snap: Optional.none()\n      });\n      return bestSnap.snap.map(function (snap) {\n        return {\n          output: absorb(snap.output, newCoord, scroll, origin),\n          extra: snap.extra\n        };\n      });\n    });\n  };\n\n  var findSnap = function (component, snapInfo, newCoord, scroll, origin) {\n    var snaps = snapInfo.getSnapPoints(component);\n    return findMatchingSnap(snaps, newCoord, scroll, origin);\n  };\n\n  var snapTo$1 = function (snap, scroll, origin) {\n    return {\n      coord: absorb(snap.output, snap.output, scroll, origin),\n      extra: snap.extra\n    };\n  };\n\n  var snapTo = function (component, dragConfig, _state, snap) {\n    var target = dragConfig.getTarget(component.element);\n\n    if (dragConfig.repositionTarget) {\n      var doc = owner$4(component.element);\n      var scroll_1 = get$9(doc);\n      var origin_1 = getOrigin(target);\n      var snapPin = snapTo$1(snap, scroll_1, origin_1);\n      var styles = toStyles(snapPin.coord, scroll_1, origin_1);\n      setOptions(target, styles);\n    }\n  };\n\n  var DraggingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    snapTo: snapTo\n  });\n  var initialAttribute = 'data-initial-z-index';\n\n  var resetZIndex = function (blocker) {\n    parent(blocker.element).filter(isElement$2).each(function (root) {\n      getOpt(root, initialAttribute).fold(function () {\n        return remove$6(root, 'z-index');\n      }, function (zIndex) {\n        return set$7(root, 'z-index', zIndex);\n      });\n      remove$7(root, initialAttribute);\n    });\n  };\n\n  var changeZIndex = function (blocker) {\n    parent(blocker.element).filter(isElement$2).each(function (root) {\n      getRaw(root, 'z-index').each(function (zindex) {\n        set$8(root, initialAttribute, zindex);\n      });\n      set$7(root, 'z-index', get$c(blocker.element, 'z-index'));\n    });\n  };\n\n  var instigate = function (anyComponent, blocker) {\n    anyComponent.getSystem().addToGui(blocker);\n    changeZIndex(blocker);\n  };\n\n  var discard = function (blocker) {\n    resetZIndex(blocker);\n    blocker.getSystem().removeFromGui(blocker);\n  };\n\n  var createComponent = function (component, blockerClass, blockerEvents) {\n    return component.getSystem().build(Container.sketch({\n      dom: {\n        styles: {\n          'left': '0px',\n          'top': '0px',\n          'width': '100%',\n          'height': '100%',\n          'position': 'fixed',\n          'z-index': '1000000000000000'\n        },\n        classes: [blockerClass]\n      },\n      events: blockerEvents\n    }));\n  };\n\n  var SnapSchema = optionObjOf('snaps', [required$1('getSnapPoints'), onHandler('onSensor'), required$1('leftAttr'), required$1('topAttr'), defaulted('lazyViewport', win), defaulted('mustSnap', false)]);\n  var schema$6 = [defaulted('useFixed', never), required$1('blockerClass'), defaulted('getTarget', identity$1), defaulted('onDrag', noop), defaulted('repositionTarget', true), defaulted('onDrop', noop), defaultedFunction('getBounds', win), SnapSchema];\n\n  var getCurrentCoord = function (target) {\n    return lift3(getRaw(target, 'left'), getRaw(target, 'top'), getRaw(target, 'position'), function (left, top, position) {\n      var nu = position === 'fixed' ? fixed : offset;\n      return nu(parseInt(left, 10), parseInt(top, 10));\n    }).getOrThunk(function () {\n      var location = absolute$3(target);\n      return absolute(location.left, location.top);\n    });\n  };\n\n  var clampCoords = function (component, coords, scroll, origin, startData) {\n    var bounds = startData.bounds;\n    var absoluteCoord = asAbsolute(coords, scroll, origin);\n    var newX = clamp$1(absoluteCoord.left, bounds.x, bounds.x + bounds.width - startData.width);\n    var newY = clamp$1(absoluteCoord.top, bounds.y, bounds.y + bounds.height - startData.height);\n    var newCoords = absolute(newX, newY);\n    return coords.fold(function () {\n      var offset$1 = asOffset(newCoords, scroll, origin);\n      return offset(offset$1.left, offset$1.top);\n    }, constant$1(newCoords), function () {\n      var fixed$1 = asFixed(newCoords, scroll, origin);\n      return fixed(fixed$1.left, fixed$1.top);\n    });\n  };\n\n  var calcNewCoord = function (component, optSnaps, currentCoord, scroll, origin, delta, startData) {\n    var newCoord = optSnaps.fold(function () {\n      var translated = translate(currentCoord, delta.left, delta.top);\n      var fixedCoord = asFixed(translated, scroll, origin);\n      return fixed(fixedCoord.left, fixedCoord.top);\n    }, function (snapInfo) {\n      var snapping = moveOrSnap(component, snapInfo, currentCoord, delta, scroll, origin);\n      snapping.extra.each(function (extra) {\n        snapInfo.onSensor(component, extra);\n      });\n      return snapping.coord;\n    });\n    return clampCoords(component, newCoord, scroll, origin, startData);\n  };\n\n  var dragBy = function (component, dragConfig, startData, delta) {\n    var target = dragConfig.getTarget(component.element);\n\n    if (dragConfig.repositionTarget) {\n      var doc = owner$4(component.element);\n      var scroll_1 = get$9(doc);\n      var origin_1 = getOrigin(target);\n      var currentCoord = getCurrentCoord(target);\n      var newCoord = calcNewCoord(component, dragConfig.snaps, currentCoord, scroll_1, origin_1, delta, startData);\n      var styles = toStyles(newCoord, scroll_1, origin_1);\n      setOptions(target, styles);\n    }\n\n    dragConfig.onDrag(component, target, delta);\n  };\n\n  var calcStartData = function (dragConfig, comp) {\n    return {\n      bounds: dragConfig.getBounds(),\n      height: getOuter$2(comp.element),\n      width: getOuter$1(comp.element)\n    };\n  };\n\n  var move = function (component, dragConfig, dragState, dragMode, event) {\n    var delta = dragState.update(dragMode, event);\n    var dragStartData = dragState.getStartData().getOrThunk(function () {\n      return calcStartData(dragConfig, component);\n    });\n    delta.each(function (dlt) {\n      dragBy(component, dragConfig, dragStartData, dlt);\n    });\n  };\n\n  var stop = function (component, blocker, dragConfig, dragState) {\n    blocker.each(discard);\n    dragConfig.snaps.each(function (snapInfo) {\n      stopDrag(component, snapInfo);\n    });\n    var target = dragConfig.getTarget(component.element);\n    dragState.reset();\n    dragConfig.onDrop(component, target);\n  };\n\n  var handlers = function (events) {\n    return function (dragConfig, dragState) {\n      var updateStartState = function (comp) {\n        dragState.setStartData(calcStartData(dragConfig, comp));\n      };\n\n      return derive$2(__spreadArray([run$1(windowScroll(), function (comp) {\n        dragState.getStartData().each(function () {\n          return updateStartState(comp);\n        });\n      })], events(dragConfig, dragState, updateStartState), true));\n    };\n  };\n\n  var init$2 = function (dragApi) {\n    return derive$2([run$1(mousedown(), dragApi.forceDrop), run$1(mouseup(), dragApi.drop), run$1(mousemove(), function (comp, simulatedEvent) {\n      dragApi.move(simulatedEvent.event);\n    }), run$1(mouseout(), dragApi.delayDrop)]);\n  };\n\n  var getData$1 = function (event) {\n    return Optional.from(SugarPosition(event.x, event.y));\n  };\n\n  var getDelta$1 = function (old, nu) {\n    return SugarPosition(nu.left - old.left, nu.top - old.top);\n  };\n\n  var MouseData = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getData: getData$1,\n    getDelta: getDelta$1\n  });\n\n  var events$2 = function (dragConfig, dragState, updateStartState) {\n    return [run$1(mousedown(), function (component, simulatedEvent) {\n      var raw = simulatedEvent.event.raw;\n\n      if (raw.button !== 0) {\n        return;\n      }\n\n      simulatedEvent.stop();\n\n      var stop$1 = function () {\n        return stop(component, Optional.some(blocker), dragConfig, dragState);\n      };\n\n      var delayDrop = DelayedFunction(stop$1, 200);\n      var dragApi = {\n        drop: stop$1,\n        delayDrop: delayDrop.schedule,\n        forceDrop: stop$1,\n        move: function (event) {\n          delayDrop.cancel();\n          move(component, dragConfig, dragState, MouseData, event);\n        }\n      };\n      var blocker = createComponent(component, dragConfig.blockerClass, init$2(dragApi));\n\n      var start = function () {\n        updateStartState(component);\n        instigate(component, blocker);\n      };\n\n      start();\n    })];\n  };\n\n  var schema$5 = __spreadArray(__spreadArray([], schema$6, true), [output$1('dragger', {\n    handlers: handlers(events$2)\n  })], false);\n\n  var init$1 = function (dragApi) {\n    return derive$2([run$1(touchstart(), dragApi.forceDrop), run$1(touchend(), dragApi.drop), run$1(touchcancel(), dragApi.drop), run$1(touchmove(), function (comp, simulatedEvent) {\n      dragApi.move(simulatedEvent.event);\n    })]);\n  };\n\n  var getDataFrom = function (touches) {\n    var touch = touches[0];\n    return Optional.some(SugarPosition(touch.clientX, touch.clientY));\n  };\n\n  var getData = function (event) {\n    var raw = event.raw;\n    var touches = raw.touches;\n    return touches.length === 1 ? getDataFrom(touches) : Optional.none();\n  };\n\n  var getDelta = function (old, nu) {\n    return SugarPosition(nu.left - old.left, nu.top - old.top);\n  };\n\n  var TouchData = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getData: getData,\n    getDelta: getDelta\n  });\n\n  var events$1 = function (dragConfig, dragState, updateStartState) {\n    var blockerSingleton = value$1();\n\n    var stopBlocking = function (component) {\n      stop(component, blockerSingleton.get(), dragConfig, dragState);\n      blockerSingleton.clear();\n    };\n\n    return [run$1(touchstart(), function (component, simulatedEvent) {\n      simulatedEvent.stop();\n\n      var stop = function () {\n        return stopBlocking(component);\n      };\n\n      var dragApi = {\n        drop: stop,\n        delayDrop: noop,\n        forceDrop: stop,\n        move: function (event) {\n          move(component, dragConfig, dragState, TouchData, event);\n        }\n      };\n      var blocker = createComponent(component, dragConfig.blockerClass, init$1(dragApi));\n      blockerSingleton.set(blocker);\n\n      var start = function () {\n        updateStartState(component);\n        instigate(component, blocker);\n      };\n\n      start();\n    }), run$1(touchmove(), function (component, simulatedEvent) {\n      simulatedEvent.stop();\n      move(component, dragConfig, dragState, TouchData, simulatedEvent.event);\n    }), run$1(touchend(), function (component, simulatedEvent) {\n      simulatedEvent.stop();\n      stopBlocking(component);\n    }), run$1(touchcancel(), stopBlocking)];\n  };\n\n  var schema$4 = __spreadArray(__spreadArray([], schema$6, true), [output$1('dragger', {\n    handlers: handlers(events$1)\n  })], false);\n\n  var events = function (dragConfig, dragState, updateStartState) {\n    return __spreadArray(__spreadArray([], events$2(dragConfig, dragState, updateStartState), true), events$1(dragConfig, dragState, updateStartState), true);\n  };\n\n  var schema$3 = __spreadArray(__spreadArray([], schema$6, true), [output$1('dragger', {\n    handlers: handlers(events)\n  })], false);\n\n  var mouse = schema$5;\n  var touch = schema$4;\n  var mouseOrTouch = schema$3;\n  var DraggingBranches = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    mouse: mouse,\n    touch: touch,\n    mouseOrTouch: mouseOrTouch\n  });\n\n  var init = function () {\n    var previous = Optional.none();\n    var startData = Optional.none();\n\n    var reset = function () {\n      previous = Optional.none();\n      startData = Optional.none();\n    };\n\n    var calculateDelta = function (mode, nu) {\n      var result = previous.map(function (old) {\n        return mode.getDelta(old, nu);\n      });\n      previous = Optional.some(nu);\n      return result;\n    };\n\n    var update = function (mode, dragEvent) {\n      return mode.getData(dragEvent).bind(function (nuData) {\n        return calculateDelta(mode, nuData);\n      });\n    };\n\n    var setStartData = function (data) {\n      startData = Optional.some(data);\n    };\n\n    var getStartData = function () {\n      return startData;\n    };\n\n    var readState = constant$1({});\n    return nu$8({\n      readState: readState,\n      reset: reset,\n      update: update,\n      getStartData: getStartData,\n      setStartData: setStartData\n    });\n  };\n\n  var DragState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init\n  });\n  var Dragging = createModes({\n    branchKey: 'mode',\n    branches: DraggingBranches,\n    name: 'dragging',\n    active: {\n      events: function (dragConfig, dragState) {\n        var dragger = dragConfig.dragger;\n        return dragger.handlers(dragConfig, dragState);\n      }\n    },\n    extra: {\n      snap: function (sConfig) {\n        return {\n          sensor: sConfig.sensor,\n          range: sConfig.range,\n          output: sConfig.output,\n          extra: Optional.from(sConfig.extra)\n        };\n      }\n    },\n    state: DragState,\n    apis: DraggingApis\n  });\n  var snapWidth = 40;\n  var snapOffset = snapWidth / 2;\n\n  var calcSnap = function (selectorOpt, td, x, y, width, height) {\n    return selectorOpt.fold(function () {\n      return Dragging.snap({\n        sensor: absolute(x - snapOffset, y - snapOffset),\n        range: SugarPosition(width, height),\n        output: absolute(Optional.some(x), Optional.some(y)),\n        extra: {\n          td: td\n        }\n      });\n    }, function (selectorHandle) {\n      var sensorLeft = x - snapOffset;\n      var sensorTop = y - snapOffset;\n      var sensorWidth = snapWidth;\n      var sensorHeight = snapWidth;\n      var rect = selectorHandle.element.dom.getBoundingClientRect();\n      return Dragging.snap({\n        sensor: absolute(sensorLeft, sensorTop),\n        range: SugarPosition(sensorWidth, sensorHeight),\n        output: absolute(Optional.some(x - rect.width / 2), Optional.some(y - rect.height / 2)),\n        extra: {\n          td: td\n        }\n      });\n    });\n  };\n\n  var getSnapsConfig = function (getSnapPoints, cell, onChange) {\n    var isSameCell = function (cellOpt, td) {\n      return cellOpt.exists(function (currentTd) {\n        return eq(currentTd, td);\n      });\n    };\n\n    return {\n      getSnapPoints: getSnapPoints,\n      leftAttr: 'data-drag-left',\n      topAttr: 'data-drag-top',\n      onSensor: function (component, extra) {\n        var td = extra.td;\n\n        if (!isSameCell(cell.get(), td)) {\n          cell.set(td);\n          onChange(td);\n        }\n      },\n      mustSnap: true\n    };\n  };\n\n  var createSelector = function (snaps) {\n    return record(Button.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-selector']\n      },\n      buttonBehaviours: derive$1([Dragging.config({\n        mode: 'mouseOrTouch',\n        blockerClass: 'blocker',\n        snaps: snaps\n      }), Unselecting.config({})]),\n      eventOrder: {\n        mousedown: ['dragging', 'alloy.base.behaviour'],\n        touchstart: ['dragging', 'alloy.base.behaviour']\n      }\n    }));\n  };\n\n  var setup$4 = function (editor, sink) {\n    var tlTds = Cell([]);\n    var brTds = Cell([]);\n    var isVisible = Cell(false);\n    var startCell = value$1();\n    var finishCell = value$1();\n\n    var getTopLeftSnap = function (td) {\n      var box = absolute$2(td);\n      return calcSnap(memTopLeft.getOpt(sink), td, box.x, box.y, box.width, box.height);\n    };\n\n    var getTopLeftSnaps = function () {\n      return map$2(tlTds.get(), function (td) {\n        return getTopLeftSnap(td);\n      });\n    };\n\n    var getBottomRightSnap = function (td) {\n      var box = absolute$2(td);\n      return calcSnap(memBottomRight.getOpt(sink), td, box.right, box.bottom, box.width, box.height);\n    };\n\n    var getBottomRightSnaps = function () {\n      return map$2(brTds.get(), function (td) {\n        return getBottomRightSnap(td);\n      });\n    };\n\n    var topLeftSnaps = getSnapsConfig(getTopLeftSnaps, startCell, function (start) {\n      finishCell.get().each(function (finish) {\n        editor.fire('TableSelectorChange', {\n          start: start,\n          finish: finish\n        });\n      });\n    });\n    var bottomRightSnaps = getSnapsConfig(getBottomRightSnaps, finishCell, function (finish) {\n      startCell.get().each(function (start) {\n        editor.fire('TableSelectorChange', {\n          start: start,\n          finish: finish\n        });\n      });\n    });\n    var memTopLeft = createSelector(topLeftSnaps);\n    var memBottomRight = createSelector(bottomRightSnaps);\n    var topLeft = build$1(memTopLeft.asSpec());\n    var bottomRight = build$1(memBottomRight.asSpec());\n\n    var showOrHideHandle = function (selector, cell, isAbove, isBelow) {\n      var cellRect = cell.dom.getBoundingClientRect();\n      remove$6(selector.element, 'display');\n      var viewportHeight = defaultView(SugarElement.fromDom(editor.getBody())).dom.innerHeight;\n      var aboveViewport = isAbove(cellRect);\n      var belowViewport = isBelow(cellRect, viewportHeight);\n\n      if (aboveViewport || belowViewport) {\n        set$7(selector.element, 'display', 'none');\n      }\n    };\n\n    var snapTo = function (selector, cell, getSnapConfig, pos) {\n      var snap = getSnapConfig(cell);\n      Dragging.snapTo(selector, snap);\n\n      var isAbove = function (rect) {\n        return rect[pos] < 0;\n      };\n\n      var isBelow = function (rect, viewportHeight) {\n        return rect[pos] > viewportHeight;\n      };\n\n      showOrHideHandle(selector, cell, isAbove, isBelow);\n    };\n\n    var snapTopLeft = function (cell) {\n      return snapTo(topLeft, cell, getTopLeftSnap, 'top');\n    };\n\n    var snapLastTopLeft = function () {\n      return startCell.get().each(snapTopLeft);\n    };\n\n    var snapBottomRight = function (cell) {\n      return snapTo(bottomRight, cell, getBottomRightSnap, 'bottom');\n    };\n\n    var snapLastBottomRight = function () {\n      return finishCell.get().each(snapBottomRight);\n    };\n\n    if (detect$1().deviceType.isTouch()) {\n      editor.on('TableSelectionChange', function (e) {\n        if (!isVisible.get()) {\n          attach(sink, topLeft);\n          attach(sink, bottomRight);\n          isVisible.set(true);\n        }\n\n        startCell.set(e.start);\n        finishCell.set(e.finish);\n        e.otherCells.each(function (otherCells) {\n          tlTds.set(otherCells.upOrLeftCells);\n          brTds.set(otherCells.downOrRightCells);\n          snapTopLeft(e.start);\n          snapBottomRight(e.finish);\n        });\n      });\n      editor.on('ResizeEditor ResizeWindow ScrollContent', function () {\n        snapLastTopLeft();\n        snapLastBottomRight();\n      });\n      editor.on('TableSelectionClear', function () {\n        if (isVisible.get()) {\n          detach(topLeft);\n          detach(bottomRight);\n          isVisible.set(false);\n        }\n\n        startCell.clear();\n        finishCell.clear();\n      });\n    }\n  };\n\n  var isHidden = function (elm) {\n    if (elm.nodeType === 1) {\n      if (elm.nodeName === 'BR' || !!elm.getAttribute('data-mce-bogus')) {\n        return true;\n      }\n\n      if (elm.getAttribute('data-mce-type') === 'bookmark') {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var renderElementPath = function (editor, settings, providersBackstage) {\n    if (!settings.delimiter) {\n      settings.delimiter = '\\xBB';\n    }\n\n    var getDataPath = function (data) {\n      var parts = data || [];\n      var newPathElements = map$2(parts, function (part, index) {\n        return Button.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-statusbar__path-item'],\n            attributes: {\n              'role': 'button',\n              'data-index': index,\n              'tab-index': -1,\n              'aria-level': index + 1\n            },\n            innerHtml: part.name\n          },\n          action: function (_btn) {\n            editor.focus();\n            editor.selection.select(part.element);\n            editor.nodeChanged();\n          },\n          buttonBehaviours: derive$1([DisablingConfigs.button(providersBackstage.isDisabled), receivingConfig()])\n        });\n      });\n      var divider = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-statusbar__path-divider'],\n          attributes: {\n            'aria-hidden': true\n          },\n          innerHtml: ' ' + settings.delimiter + ' '\n        }\n      };\n      return foldl(newPathElements.slice(1), function (acc, element) {\n        var newAcc = acc;\n        newAcc.push(divider);\n        newAcc.push(element);\n        return newAcc;\n      }, [newPathElements[0]]);\n    };\n\n    var updatePath = function (parents) {\n      var newPath = [];\n      var i = parents.length;\n\n      while (i-- > 0) {\n        var parent_1 = parents[i];\n\n        if (parent_1.nodeType === 1 && !isHidden(parent_1)) {\n          var args = editor.fire('ResolveName', {\n            name: parent_1.nodeName.toLowerCase(),\n            target: parent_1\n          });\n\n          if (!args.isDefaultPrevented()) {\n            newPath.push({\n              name: args.name,\n              element: parent_1\n            });\n          }\n\n          if (args.isPropagationStopped()) {\n            break;\n          }\n        }\n      }\n\n      return newPath;\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-statusbar__path'],\n        attributes: {\n          role: 'navigation'\n        }\n      },\n      behaviours: derive$1([Keying.config({\n        mode: 'flow',\n        selector: 'div[role=button]'\n      }), Disabling.config({\n        disabled: providersBackstage.isDisabled\n      }), receivingConfig(), Tabstopping.config({}), Replacing.config({}), config('elementPathEvents', [runOnAttached(function (comp, _e) {\n        editor.shortcuts.add('alt+F11', 'focus statusbar elementpath', function () {\n          return Keying.focusIn(comp);\n        });\n        editor.on('NodeChange', function (e) {\n          var newPath = updatePath(e.parents);\n\n          if (newPath.length > 0) {\n            Replacing.set(comp, getDataPath(newPath));\n          } else {\n            Replacing.set(comp, []);\n          }\n        });\n      })])]),\n      components: []\n    };\n  };\n\n  var ResizeTypes;\n\n  (function (ResizeTypes) {\n    ResizeTypes[ResizeTypes['None'] = 0] = 'None';\n    ResizeTypes[ResizeTypes['Both'] = 1] = 'Both';\n    ResizeTypes[ResizeTypes['Vertical'] = 2] = 'Vertical';\n  })(ResizeTypes || (ResizeTypes = {}));\n\n  var getDimensions = function (editor, deltas, resizeType, originalHeight, originalWidth) {\n    var dimensions = {};\n    dimensions.height = calcCappedSize(originalHeight + deltas.top, getMinHeightSetting(editor), getMaxHeightSetting(editor));\n\n    if (resizeType === ResizeTypes.Both) {\n      dimensions.width = calcCappedSize(originalWidth + deltas.left, getMinWidthSetting(editor), getMaxWidthSetting(editor));\n    }\n\n    return dimensions;\n  };\n\n  var resize = function (editor, deltas, resizeType) {\n    var container = SugarElement.fromDom(editor.getContainer());\n    var dimensions = getDimensions(editor, deltas, resizeType, get$b(container), get$a(container));\n    each(dimensions, function (val, dim) {\n      return set$7(container, dim, numToPx(val));\n    });\n    fireResizeEditor(editor);\n  };\n\n  var getResizeType = function (editor) {\n    var fallback = !editor.hasPlugin('autoresize');\n    var resize = editor.getParam('resize', fallback);\n\n    if (resize === false) {\n      return ResizeTypes.None;\n    } else if (resize === 'both') {\n      return ResizeTypes.Both;\n    } else {\n      return ResizeTypes.Vertical;\n    }\n  };\n\n  var keyboardHandler = function (editor, resizeType, x, y) {\n    var scale = 20;\n    var delta = SugarPosition(x * scale, y * scale);\n    resize(editor, delta, resizeType);\n    return Optional.some(true);\n  };\n\n  var renderResizeHandler = function (editor, providersBackstage) {\n    var resizeType = getResizeType(editor);\n\n    if (resizeType === ResizeTypes.None) {\n      return Optional.none();\n    }\n\n    return Optional.some(render$3('resize-handle', {\n      tag: 'div',\n      classes: ['tox-statusbar__resize-handle'],\n      attributes: {\n        title: providersBackstage.translate('Resize')\n      },\n      behaviours: [Dragging.config({\n        mode: 'mouse',\n        repositionTarget: false,\n        onDrag: function (_comp, _target, delta) {\n          return resize(editor, delta, resizeType);\n        },\n        blockerClass: 'tox-blocker'\n      }), Keying.config({\n        mode: 'special',\n        onLeft: function () {\n          return keyboardHandler(editor, resizeType, -1, 0);\n        },\n        onRight: function () {\n          return keyboardHandler(editor, resizeType, 1, 0);\n        },\n        onUp: function () {\n          return keyboardHandler(editor, resizeType, 0, -1);\n        },\n        onDown: function () {\n          return keyboardHandler(editor, resizeType, 0, 1);\n        }\n      }), Tabstopping.config({}), Focusing.config({})]\n    }, providersBackstage.icons));\n  };\n\n  var renderWordCount = function (editor, providersBackstage) {\n    var _a;\n\n    var replaceCountText = function (comp, count, mode) {\n      return Replacing.set(comp, [text(providersBackstage.translate(['{0} ' + mode, count[mode]]))]);\n    };\n\n    return Button.sketch({\n      dom: {\n        tag: 'button',\n        classes: ['tox-statusbar__wordcount']\n      },\n      components: [],\n      buttonBehaviours: derive$1([DisablingConfigs.button(providersBackstage.isDisabled), receivingConfig(), Tabstopping.config({}), Replacing.config({}), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: {\n            mode: 'words',\n            count: {\n              words: 0,\n              characters: 0\n            }\n          }\n        }\n      }), config('wordcount-events', [runOnExecute$1(function (comp) {\n        var currentVal = Representing.getValue(comp);\n        var newMode = currentVal.mode === 'words' ? 'characters' : 'words';\n        Representing.setValue(comp, {\n          mode: newMode,\n          count: currentVal.count\n        });\n        replaceCountText(comp, currentVal.count, newMode);\n      }), runOnAttached(function (comp) {\n        editor.on('wordCountUpdate', function (e) {\n          var mode = Representing.getValue(comp).mode;\n          Representing.setValue(comp, {\n            mode: mode,\n            count: e.wordCount\n          });\n          replaceCountText(comp, e.wordCount, mode);\n        });\n      })])]),\n      eventOrder: (_a = {}, _a[execute$5()] = ['disabling', 'alloy.base.behaviour', 'wordcount-events'], _a)\n    });\n  };\n\n  var renderStatusbar = function (editor, providersBackstage) {\n    var renderBranding = function () {\n      var label = global$e.translate(['Powered by {0}', 'Tiny']);\n      var linkHtml = '<a href=\"https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5\" rel=\"noopener\" target=\"_blank\" tabindex=\"-1\" aria-label=\"' + label + '\">' + label + '</a>';\n      return {\n        dom: {\n          tag: 'span',\n          classes: ['tox-statusbar__branding'],\n          innerHtml: linkHtml\n        }\n      };\n    };\n\n    var getTextComponents = function () {\n      var components = [];\n\n      if (editor.getParam('elementpath', true, 'boolean')) {\n        components.push(renderElementPath(editor, {}, providersBackstage));\n      }\n\n      if (editor.hasPlugin('wordcount')) {\n        components.push(renderWordCount(editor, providersBackstage));\n      }\n\n      if (editor.getParam('branding', true, 'boolean')) {\n        components.push(renderBranding());\n      }\n\n      if (components.length > 0) {\n        return [{\n          dom: {\n            tag: 'div',\n            classes: ['tox-statusbar__text-container']\n          },\n          components: components\n        }];\n      }\n\n      return [];\n    };\n\n    var getComponents = function () {\n      var components = getTextComponents();\n      var resizeHandler = renderResizeHandler(editor, providersBackstage);\n      return components.concat(resizeHandler.toArray());\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-statusbar']\n      },\n      components: getComponents()\n    };\n  };\n\n  var setup$3 = function (editor) {\n    var _a;\n\n    var isInline = editor.inline;\n    var mode = isInline ? Inline : Iframe;\n    var header = isStickyToolbar(editor) ? StickyHeader : StaticHeader;\n    var lazyOuterContainer = Optional.none();\n    var platform = detect$1();\n    var isIE = platform.browser.isIE();\n    var platformClasses = isIE ? ['tox-platform-ie'] : [];\n    var isTouch = platform.deviceType.isTouch();\n    var touchPlatformClass = 'tox-platform-touch';\n    var deviceClasses = isTouch ? [touchPlatformClass] : [];\n    var isToolbarBottom = isToolbarLocationBottom(editor);\n    var uiContainer = getUiContainer(editor);\n    var dirAttributes = global$e.isRtl() ? {\n      attributes: {\n        dir: 'rtl'\n      }\n    } : {};\n    var verticalDirAttributes = {\n      attributes: (_a = {}, _a[Attribute] = isToolbarBottom ? AttributeValue.BottomToTop : AttributeValue.TopToBottom, _a)\n    };\n\n    var lazyHeader = function () {\n      return lazyOuterContainer.bind(OuterContainer.getHeader);\n    };\n\n    var isHeaderDocked = function () {\n      return header.isDocked(lazyHeader);\n    };\n\n    var resizeUiMothership = function () {\n      set$7(uiMothership.element, 'width', document.body.clientWidth + 'px');\n    };\n\n    var makeSinkDefinition = function () {\n      var isGridUiContainer = eq(body(), uiContainer) && get$c(uiContainer, 'display') === 'grid';\n      var sinkSpec = {\n        dom: __assign({\n          tag: 'div',\n          classes: ['tox', 'tox-silver-sink', 'tox-tinymce-aux'].concat(platformClasses).concat(deviceClasses)\n        }, dirAttributes),\n        behaviours: derive$1([Positioning.config({\n          useFixed: function () {\n            return isHeaderDocked();\n          }\n        })])\n      };\n      var reactiveWidthSpec = {\n        dom: {\n          styles: {\n            width: document.body.clientWidth + 'px'\n          }\n        },\n        events: derive$2([run$1(windowResize(), resizeUiMothership)])\n      };\n      return deepMerge(sinkSpec, isGridUiContainer ? reactiveWidthSpec : {});\n    };\n\n    var sink = build$1(makeSinkDefinition());\n\n    var lazySink = function () {\n      return Result.value(sink);\n    };\n\n    var memAnchorBar = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-anchorbar']\n      }\n    });\n\n    var lazyAnchorBar = function () {\n      return lazyOuterContainer.bind(function (container) {\n        return memAnchorBar.getOpt(container);\n      }).getOrDie('Could not find a anchor bar element');\n    };\n\n    var lazyToolbar = function () {\n      return lazyOuterContainer.bind(function (container) {\n        return OuterContainer.getToolbar(container);\n      }).getOrDie('Could not find more toolbar element');\n    };\n\n    var lazyThrobber = function () {\n      return lazyOuterContainer.bind(function (container) {\n        return OuterContainer.getThrobber(container);\n      }).getOrDie('Could not find throbber element');\n    };\n\n    var backstage = init$7(sink, editor, lazyAnchorBar);\n    var partMenubar = OuterContainer.parts.menubar({\n      dom: {\n        tag: 'div',\n        classes: ['tox-menubar']\n      },\n      backstage: backstage,\n      onEscape: function () {\n        editor.focus();\n      }\n    });\n    var toolbarMode = getToolbarMode(editor);\n    var partToolbar = OuterContainer.parts.toolbar(__assign({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar']\n      },\n      getSink: lazySink,\n      providers: backstage.shared.providers,\n      onEscape: function () {\n        editor.focus();\n      },\n      type: toolbarMode,\n      lazyToolbar: lazyToolbar,\n      lazyHeader: function () {\n        return lazyHeader().getOrDie('Could not find header element');\n      }\n    }, verticalDirAttributes));\n    var partMultipleToolbar = OuterContainer.parts['multiple-toolbar']({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar-overlord']\n      },\n      providers: backstage.shared.providers,\n      onEscape: function () {\n        editor.focus();\n      },\n      type: toolbarMode\n    });\n    var partSocket = OuterContainer.parts.socket({\n      dom: {\n        tag: 'div',\n        classes: ['tox-edit-area']\n      }\n    });\n    var partSidebar = OuterContainer.parts.sidebar({\n      dom: {\n        tag: 'div',\n        classes: ['tox-sidebar']\n      }\n    });\n    var partThrobber = OuterContainer.parts.throbber({\n      dom: {\n        tag: 'div',\n        classes: ['tox-throbber']\n      },\n      backstage: backstage\n    });\n    var sb = editor.getParam('statusbar', true, 'boolean');\n    var statusbar = sb && !isInline ? Optional.some(renderStatusbar(editor, backstage.shared.providers)) : Optional.none();\n    var socketSidebarContainer = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-sidebar-wrap']\n      },\n      components: [partSocket, partSidebar]\n    };\n    var hasMultipleToolbar = isMultipleToolbars(editor);\n    var hasToolbar = isToolbarEnabled(editor);\n    var hasMenubar = isMenubarEnabled(editor);\n\n    var getPartToolbar = function () {\n      if (hasMultipleToolbar) {\n        return [partMultipleToolbar];\n      } else if (hasToolbar) {\n        return [partToolbar];\n      } else {\n        return [];\n      }\n    };\n\n    var partHeader = OuterContainer.parts.header({\n      dom: __assign({\n        tag: 'div',\n        classes: ['tox-editor-header']\n      }, verticalDirAttributes),\n      components: flatten([hasMenubar ? [partMenubar] : [], getPartToolbar(), useFixedContainer(editor) ? [] : [memAnchorBar.asSpec()]]),\n      sticky: isStickyToolbar(editor),\n      editor: editor,\n      sharedBackstage: backstage.shared\n    });\n    var editorComponents = flatten([isToolbarBottom ? [] : [partHeader], isInline ? [] : [socketSidebarContainer], isToolbarBottom ? [partHeader] : []]);\n    var editorContainer = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-editor-container']\n      },\n      components: editorComponents\n    };\n    var containerComponents = flatten([[editorContainer], isInline ? [] : statusbar.toArray(), [partThrobber]]);\n    var isHidden = isDistractionFree(editor);\n\n    var attributes = __assign(__assign({\n      role: 'application'\n    }, global$e.isRtl() ? {\n      dir: 'rtl'\n    } : {}), isHidden ? {\n      'aria-hidden': 'true'\n    } : {});\n\n    var outerContainer = build$1(OuterContainer.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox', 'tox-tinymce'].concat(isInline ? ['tox-tinymce-inline'] : []).concat(isToolbarBottom ? ['tox-tinymce--toolbar-bottom'] : []).concat(deviceClasses).concat(platformClasses),\n        styles: __assign({\n          visibility: 'hidden'\n        }, isHidden ? {\n          opacity: '0',\n          border: '0'\n        } : {}),\n        attributes: attributes\n      },\n      components: containerComponents,\n      behaviours: derive$1([receivingConfig(), Disabling.config({\n        disableClass: 'tox-tinymce--disabled'\n      }), Keying.config({\n        mode: 'cyclic',\n        selector: '.tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle'\n      })])\n    }));\n    lazyOuterContainer = Optional.some(outerContainer);\n    editor.shortcuts.add('alt+F9', 'focus menubar', function () {\n      OuterContainer.focusMenubar(outerContainer);\n    });\n    editor.shortcuts.add('alt+F10', 'focus toolbar', function () {\n      OuterContainer.focusToolbar(outerContainer);\n    });\n    editor.addCommand('ToggleToolbarDrawer', function () {\n      OuterContainer.toggleToolbarDrawer(outerContainer);\n    });\n    editor.addQueryStateHandler('ToggleToolbarDrawer', function () {\n      return OuterContainer.isToolbarDrawerToggled(outerContainer);\n    });\n    var mothership = takeover(outerContainer);\n    var uiMothership = takeover(sink);\n    setup$b(editor, mothership, uiMothership);\n\n    var getUi = function () {\n      var channels = {\n        broadcastAll: uiMothership.broadcast,\n        broadcastOn: uiMothership.broadcastOn,\n        register: noop\n      };\n      return {\n        channels: channels\n      };\n    };\n\n    var setEditorSize = function () {\n      var parsedHeight = numToPx(getHeightWithFallback(editor));\n      var parsedWidth = numToPx(getWidthWithFallback(editor));\n\n      if (!editor.inline) {\n        if (isValidValue('div', 'width', parsedWidth)) {\n          set$7(outerContainer.element, 'width', parsedWidth);\n        }\n\n        if (isValidValue('div', 'height', parsedHeight)) {\n          set$7(outerContainer.element, 'height', parsedHeight);\n        } else {\n          set$7(outerContainer.element, 'height', '200px');\n        }\n      }\n\n      return parsedHeight;\n    };\n\n    var renderUI = function () {\n      header.setup(editor, backstage.shared, lazyHeader);\n      setup$6(editor, backstage);\n      setup$5(editor, lazySink, backstage);\n      setup$8(editor);\n      setup$7(editor, lazyThrobber, backstage.shared);\n      map$1(getToolbarGroups(editor), function (toolbarGroupButtonConfig, name) {\n        editor.ui.registry.addGroupToolbarButton(name, toolbarGroupButtonConfig);\n      });\n\n      var _a = editor.ui.registry.getAll(),\n          buttons = _a.buttons,\n          menuItems = _a.menuItems,\n          contextToolbars = _a.contextToolbars,\n          sidebars = _a.sidebars;\n\n      var toolbarOpt = getMultipleToolbarsSetting(editor);\n      var rawUiConfig = {\n        menuItems: menuItems,\n        menus: getMenus(editor),\n        menubar: getMenubar(editor),\n        toolbar: toolbarOpt.getOrThunk(function () {\n          return getToolbar(editor);\n        }),\n        allowToolbarGroups: toolbarMode === ToolbarMode.floating,\n        buttons: buttons,\n        sidebar: sidebars\n      };\n      register$7(editor, contextToolbars, sink, {\n        backstage: backstage\n      });\n      setup$4(editor, sink);\n      var elm = editor.getElement();\n      var height = setEditorSize();\n      var uiComponents = {\n        mothership: mothership,\n        uiMothership: uiMothership,\n        outerContainer: outerContainer\n      };\n      var args = {\n        targetNode: elm,\n        height: height\n      };\n      return mode.render(editor, uiComponents, rawUiConfig, backstage, args);\n    };\n\n    return {\n      mothership: mothership,\n      uiMothership: uiMothership,\n      backstage: backstage,\n      renderUI: renderUI,\n      getUi: getUi\n    };\n  };\n\n  var describedBy = function (describedElement, describeElement) {\n    var describeId = Optional.from(get$d(describedElement, 'id')).fold(function () {\n      var id = generate$6('dialog-describe');\n      set$8(describeElement, 'id', id);\n      return id;\n    }, identity$1);\n    set$8(describedElement, 'aria-describedby', describeId);\n  };\n\n  var labelledBy = function (labelledElement, labelElement) {\n    var labelId = getOpt(labelledElement, 'id').fold(function () {\n      var id = generate$6('dialog-label');\n      set$8(labelElement, 'id', id);\n      return id;\n    }, identity$1);\n    set$8(labelledElement, 'aria-labelledby', labelId);\n  };\n\n  var schema$2 = constant$1([required$1('lazySink'), option('dragBlockClass'), defaultedFunction('getBounds', win), defaulted('useTabstopAt', always), defaulted('eventOrder', {}), field('modalBehaviours', [Keying]), onKeyboardHandler('onExecute'), onStrictKeyboardHandler('onEscape')]);\n  var basic = {\n    sketch: identity$1\n  };\n  var parts$2 = constant$1([optional({\n    name: 'draghandle',\n    overrides: function (detail, spec) {\n      return {\n        behaviours: derive$1([Dragging.config({\n          mode: 'mouse',\n          getTarget: function (handle) {\n            return ancestor(handle, '[role=\"dialog\"]').getOr(handle);\n          },\n          blockerClass: detail.dragBlockClass.getOrDie(new Error('The drag blocker class was not specified for a dialog with a drag handle: \\n' + JSON.stringify(spec, null, 2)).message),\n          getBounds: detail.getDragBounds\n        })])\n      };\n    }\n  }), required({\n    schema: [required$1('dom')],\n    name: 'title'\n  }), required({\n    factory: basic,\n    schema: [required$1('dom')],\n    name: 'close'\n  }), required({\n    factory: basic,\n    schema: [required$1('dom')],\n    name: 'body'\n  }), optional({\n    factory: basic,\n    schema: [required$1('dom')],\n    name: 'footer'\n  }), external$1({\n    factory: {\n      sketch: function (spec, detail) {\n        return __assign(__assign({}, spec), {\n          dom: detail.dom,\n          components: detail.components\n        });\n      }\n    },\n    schema: [defaulted('dom', {\n      tag: 'div',\n      styles: {\n        position: 'fixed',\n        left: '0px',\n        top: '0px',\n        right: '0px',\n        bottom: '0px'\n      }\n    }), defaulted('components', [])],\n    name: 'blocker'\n  })]);\n\n  var factory$4 = function (detail, components, spec, externals) {\n    var _a;\n\n    var dialogComp = value$1();\n\n    var showDialog = function (dialog) {\n      dialogComp.set(dialog);\n      var sink = detail.lazySink(dialog).getOrDie();\n      var externalBlocker = externals.blocker();\n      var blocker = sink.getSystem().build(__assign(__assign({}, externalBlocker), {\n        components: externalBlocker.components.concat([premade(dialog)]),\n        behaviours: derive$1([Focusing.config({}), config('dialog-blocker-events', [runOnSource(focusin(), function () {\n          Keying.focusIn(dialog);\n        })])])\n      }));\n      attach(sink, blocker);\n      Keying.focusIn(dialog);\n    };\n\n    var hideDialog = function (dialog) {\n      dialogComp.clear();\n      parent(dialog.element).each(function (blockerDom) {\n        dialog.getSystem().getByDom(blockerDom).each(function (blocker) {\n          detach(blocker);\n        });\n      });\n    };\n\n    var getDialogBody = function (dialog) {\n      return getPartOrDie(dialog, detail, 'body');\n    };\n\n    var getDialogFooter = function (dialog) {\n      return getPartOrDie(dialog, detail, 'footer');\n    };\n\n    var setBusy = function (dialog, getBusySpec) {\n      Blocking.block(dialog, getBusySpec);\n    };\n\n    var setIdle = function (dialog) {\n      Blocking.unblock(dialog);\n    };\n\n    var modalEventsId = generate$6('modal-events');\n\n    var eventOrder = __assign(__assign({}, detail.eventOrder), (_a = {}, _a[attachedToDom()] = [modalEventsId].concat(detail.eventOrder['alloy.system.attached'] || []), _a));\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      apis: {\n        show: showDialog,\n        hide: hideDialog,\n        getBody: getDialogBody,\n        getFooter: getDialogFooter,\n        setIdle: setIdle,\n        setBusy: setBusy\n      },\n      eventOrder: eventOrder,\n      domModification: {\n        attributes: {\n          'role': 'dialog',\n          'aria-modal': 'true'\n        }\n      },\n      behaviours: augment(detail.modalBehaviours, [Replacing.config({}), Keying.config({\n        mode: 'cyclic',\n        onEnter: detail.onExecute,\n        onEscape: detail.onEscape,\n        useTabstopAt: detail.useTabstopAt\n      }), Blocking.config({\n        getRoot: dialogComp.get\n      }), config(modalEventsId, [runOnAttached(function (c) {\n        labelledBy(c.element, getPartOrDie(c, detail, 'title').element);\n        describedBy(c.element, getPartOrDie(c, detail, 'body').element);\n      })])])\n    };\n  };\n\n  var ModalDialog = composite({\n    name: 'ModalDialog',\n    configFields: schema$2(),\n    partFields: parts$2(),\n    factory: factory$4,\n    apis: {\n      show: function (apis, dialog) {\n        apis.show(dialog);\n      },\n      hide: function (apis, dialog) {\n        apis.hide(dialog);\n      },\n      getBody: function (apis, dialog) {\n        return apis.getBody(dialog);\n      },\n      getFooter: function (apis, dialog) {\n        return apis.getFooter(dialog);\n      },\n      setBusy: function (apis, dialog, getBusySpec) {\n        apis.setBusy(dialog, getBusySpec);\n      },\n      setIdle: function (apis, dialog) {\n        apis.setIdle(dialog);\n      }\n    }\n  });\n  var dialogToggleMenuItemSchema = objOf([requiredString('type'), requiredString('name')].concat(commonMenuItemFields));\n  var dialogToggleMenuItemDataProcessor = boolean;\n  var baseFooterButtonFields = [field$1('name', 'name', defaultedThunk(function () {\n    return generate$6('button-name');\n  }), string), optionString('icon'), defaultedStringEnum('align', 'end', ['start', 'end']), defaultedBoolean('primary', false), defaultedBoolean('disabled', false)];\n\n  var dialogFooterButtonFields = __spreadArray(__spreadArray([], baseFooterButtonFields, true), [requiredString('text')], false);\n\n  var normalFooterButtonFields = __spreadArray([requiredStringEnum('type', ['submit', 'cancel', 'custom'])], dialogFooterButtonFields, true);\n\n  var menuFooterButtonFields = __spreadArray([requiredStringEnum('type', ['menu']), optionString('text'), optionString('tooltip'), optionString('icon'), requiredArrayOf('items', dialogToggleMenuItemSchema)], baseFooterButtonFields, true);\n\n  var dialogFooterButtonSchema = choose$1('type', {\n    submit: normalFooterButtonFields,\n    cancel: normalFooterButtonFields,\n    custom: normalFooterButtonFields,\n    menu: menuFooterButtonFields\n  });\n  var alertBannerFields = [requiredString('type'), requiredString('text'), requiredStringEnum('level', ['info', 'warn', 'error', 'success']), requiredString('icon'), defaulted('url', '')];\n  var alertBannerSchema = objOf(alertBannerFields);\n\n  var createBarFields = function (itemsField) {\n    return [requiredString('type'), itemsField];\n  };\n\n  var buttonFields = [requiredString('type'), requiredString('text'), defaultedBoolean('disabled', false), defaultedBoolean('primary', false), field$1('name', 'name', defaultedThunk(function () {\n    return generate$6('button-name');\n  }), string), optionString('icon'), defaultedBoolean('borderless', false)];\n  var buttonSchema = objOf(buttonFields);\n  var checkboxFields = [requiredString('type'), requiredString('name'), requiredString('label'), defaultedBoolean('disabled', false)];\n  var checkboxSchema = objOf(checkboxFields);\n  var checkboxDataProcessor = boolean;\n  var formComponentFields = [requiredString('type'), requiredString('name')];\n  var formComponentWithLabelFields = formComponentFields.concat([optionString('label')]);\n  var collectionFields = formComponentWithLabelFields.concat([defaulted('columns', 'auto')]);\n  var collectionSchema = objOf(collectionFields);\n  var collectionDataProcessor = arrOfObj([requiredString('value'), requiredString('text'), requiredString('icon')]);\n  var colorInputFields = formComponentWithLabelFields;\n  var colorInputSchema = objOf(colorInputFields);\n  var colorInputDataProcessor = string;\n  var colorPickerFields = formComponentWithLabelFields;\n  var colorPickerSchema = objOf(colorPickerFields);\n  var colorPickerDataProcessor = string;\n  var customEditorFields = formComponentFields.concat([defaultedString('tag', 'textarea'), requiredString('scriptId'), requiredString('scriptUrl'), defaultedPostMsg('settings', undefined)]);\n  var customEditorFieldsOld = formComponentFields.concat([defaultedString('tag', 'textarea'), requiredFunction('init')]);\n  var customEditorSchema = valueOf(function (v) {\n    return asRaw('customeditor.old', objOfOnly(customEditorFieldsOld), v).orThunk(function () {\n      return asRaw('customeditor.new', objOfOnly(customEditorFields), v);\n    });\n  });\n  var customEditorDataProcessor = string;\n  var dropZoneFields = formComponentWithLabelFields;\n  var dropZoneSchema = objOf(dropZoneFields);\n  var dropZoneDataProcessor = arrOfVal();\n\n  var createGridFields = function (itemsField) {\n    return [requiredString('type'), requiredNumber('columns'), itemsField];\n  };\n\n  var htmlPanelFields = [requiredString('type'), requiredString('html'), defaultedStringEnum('presets', 'presentation', ['presentation', 'document'])];\n  var htmlPanelSchema = objOf(htmlPanelFields);\n  var iframeFields = formComponentWithLabelFields.concat([defaultedBoolean('sandboxed', true)]);\n  var iframeSchema = objOf(iframeFields);\n  var iframeDataProcessor = string;\n  var imageToolsFields = formComponentWithLabelFields.concat([requiredOf('currentState', objOf([required$1('blob'), requiredString('url')]))]);\n  var imageToolsSchema = objOf(imageToolsFields);\n  var inputFields = formComponentWithLabelFields.concat([optionString('inputMode'), optionString('placeholder'), defaultedBoolean('maximized', false), defaultedBoolean('disabled', false)]);\n  var inputSchema = objOf(inputFields);\n  var inputDataProcessor = string;\n\n  var createLabelFields = function (itemsField) {\n    return [requiredString('type'), requiredString('label'), itemsField];\n  };\n\n  var listBoxSingleItemFields = [requiredString('text'), requiredString('value')];\n  var listBoxNestedItemFields = [requiredString('text'), requiredArrayOf('items', thunkOf('items', function () {\n    return listBoxItemSchema;\n  }))];\n  var listBoxItemSchema = oneOf([objOf(listBoxSingleItemFields), objOf(listBoxNestedItemFields)]);\n  var listBoxFields = formComponentWithLabelFields.concat([requiredArrayOf('items', listBoxItemSchema), defaultedBoolean('disabled', false)]);\n  var listBoxSchema = objOf(listBoxFields);\n  var listBoxDataProcessor = string;\n  var selectBoxFields = formComponentWithLabelFields.concat([requiredArrayOfObj('items', [requiredString('text'), requiredString('value')]), defaultedNumber('size', 1), defaultedBoolean('disabled', false)]);\n  var selectBoxSchema = objOf(selectBoxFields);\n  var selectBoxDataProcessor = string;\n  var sizeInputFields = formComponentWithLabelFields.concat([defaultedBoolean('constrain', true), defaultedBoolean('disabled', false)]);\n  var sizeInputSchema = objOf(sizeInputFields);\n  var sizeInputDataProcessor = objOf([requiredString('width'), requiredString('height')]);\n  var tableFields = [requiredString('type'), requiredArrayOf('header', string), requiredArrayOf('cells', arrOf(string))];\n  var tableSchema = objOf(tableFields);\n  var textAreaFields = formComponentWithLabelFields.concat([optionString('placeholder'), defaultedBoolean('maximized', false), defaultedBoolean('disabled', false)]);\n  var textAreaSchema = objOf(textAreaFields);\n  var textAreaDataProcessor = string;\n  var urlInputFields = formComponentWithLabelFields.concat([defaultedStringEnum('filetype', 'file', ['image', 'media', 'file']), defaulted('disabled', false)]);\n  var urlInputSchema = objOf(urlInputFields);\n  var urlInputDataProcessor = objOf([requiredString('value'), defaulted('meta', {})]);\n\n  var createItemsField = function (name) {\n    return field$1('items', 'items', required$2(), arrOf(valueOf(function (v) {\n      return asRaw('Checking item of ' + name, itemSchema, v).fold(function (sErr) {\n        return Result.error(formatError(sErr));\n      }, function (passValue) {\n        return Result.value(passValue);\n      });\n    })));\n  };\n\n  var itemSchema = valueThunk(function () {\n    return choose$2('type', {\n      alertbanner: alertBannerSchema,\n      bar: objOf(createBarFields(createItemsField('bar'))),\n      button: buttonSchema,\n      checkbox: checkboxSchema,\n      colorinput: colorInputSchema,\n      colorpicker: colorPickerSchema,\n      dropzone: dropZoneSchema,\n      grid: objOf(createGridFields(createItemsField('grid'))),\n      iframe: iframeSchema,\n      input: inputSchema,\n      listbox: listBoxSchema,\n      selectbox: selectBoxSchema,\n      sizeinput: sizeInputSchema,\n      textarea: textAreaSchema,\n      urlinput: urlInputSchema,\n      customeditor: customEditorSchema,\n      htmlpanel: htmlPanelSchema,\n      imagetools: imageToolsSchema,\n      collection: collectionSchema,\n      label: objOf(createLabelFields(createItemsField('label'))),\n      table: tableSchema,\n      panel: panelSchema\n    });\n  });\n  var panelFields = [requiredString('type'), defaulted('classes', []), requiredArrayOf('items', itemSchema)];\n  var panelSchema = objOf(panelFields);\n  var tabFields = [field$1('name', 'name', defaultedThunk(function () {\n    return generate$6('tab-name');\n  }), string), requiredString('title'), requiredArrayOf('items', itemSchema)];\n  var tabPanelFields = [requiredString('type'), requiredArrayOfObj('tabs', tabFields)];\n  var tabPanelSchema = objOf(tabPanelFields);\n  var dialogButtonFields = dialogFooterButtonFields;\n  var dialogButtonSchema = dialogFooterButtonSchema;\n  var dialogSchema = objOf([requiredString('title'), requiredOf('body', choose$2('type', {\n    panel: panelSchema,\n    tabpanel: tabPanelSchema\n  })), defaultedString('size', 'normal'), requiredArrayOf('buttons', dialogButtonSchema), defaulted('initialData', {}), defaultedFunction('onAction', noop), defaultedFunction('onChange', noop), defaultedFunction('onSubmit', noop), defaultedFunction('onClose', noop), defaultedFunction('onCancel', noop), defaulted('onTabChange', noop)]);\n\n  var createDialog = function (spec) {\n    return asRaw('dialog', dialogSchema, spec);\n  };\n\n  var urlDialogButtonSchema = objOf(__spreadArray([requiredStringEnum('type', ['cancel', 'custom'])], dialogButtonFields, true));\n  var urlDialogSchema = objOf([requiredString('title'), requiredString('url'), optionNumber('height'), optionNumber('width'), optionArrayOf('buttons', urlDialogButtonSchema), defaultedFunction('onAction', noop), defaultedFunction('onCancel', noop), defaultedFunction('onClose', noop), defaultedFunction('onMessage', noop)]);\n\n  var createUrlDialog = function (spec) {\n    return asRaw('dialog', urlDialogSchema, spec);\n  };\n\n  var getAllObjects = function (obj) {\n    if (isObject(obj)) {\n      return [obj].concat(bind$3(values(obj), getAllObjects));\n    } else if (isArray(obj)) {\n      return bind$3(obj, getAllObjects);\n    } else {\n      return [];\n    }\n  };\n\n  var isNamedItem = function (obj) {\n    return isString(obj.type) && isString(obj.name);\n  };\n\n  var dataProcessors = {\n    checkbox: checkboxDataProcessor,\n    colorinput: colorInputDataProcessor,\n    colorpicker: colorPickerDataProcessor,\n    dropzone: dropZoneDataProcessor,\n    input: inputDataProcessor,\n    iframe: iframeDataProcessor,\n    sizeinput: sizeInputDataProcessor,\n    selectbox: selectBoxDataProcessor,\n    listbox: listBoxDataProcessor,\n    size: sizeInputDataProcessor,\n    textarea: textAreaDataProcessor,\n    urlinput: urlInputDataProcessor,\n    customeditor: customEditorDataProcessor,\n    collection: collectionDataProcessor,\n    togglemenuitem: dialogToggleMenuItemDataProcessor\n  };\n\n  var getDataProcessor = function (item) {\n    return Optional.from(dataProcessors[item.type]);\n  };\n\n  var getNamedItems = function (structure) {\n    return filter$2(getAllObjects(structure), isNamedItem);\n  };\n\n  var createDataValidator = function (structure) {\n    var namedItems = getNamedItems(structure);\n    var fields = bind$3(namedItems, function (item) {\n      return getDataProcessor(item).fold(function () {\n        return [];\n      }, function (schema) {\n        return [requiredOf(item.name, schema)];\n      });\n    });\n    return objOf(fields);\n  };\n\n  var extract = function (structure) {\n    var internalDialog = getOrDie(createDialog(structure));\n    var dataValidator = createDataValidator(structure);\n    var initialData = structure.initialData;\n    return {\n      internalDialog: internalDialog,\n      dataValidator: dataValidator,\n      initialData: initialData\n    };\n  };\n\n  var DialogManager = {\n    open: function (factory, structure) {\n      var extraction = extract(structure);\n      return factory(extraction.internalDialog, extraction.initialData, extraction.dataValidator);\n    },\n    openUrl: function (factory, structure) {\n      var internalDialog = getOrDie(createUrlDialog(structure));\n      return factory(internalDialog);\n    },\n    redial: function (structure) {\n      return extract(structure);\n    }\n  };\n\n  var toValidValues = function (values) {\n    var errors = [];\n    var result = {};\n    each(values, function (value, name) {\n      value.fold(function () {\n        errors.push(name);\n      }, function (v) {\n        result[name] = v;\n      });\n    });\n    return errors.length > 0 ? Result.error(errors) : Result.value(result);\n  };\n\n  var renderBodyPanel = function (spec, backstage) {\n    var memForm = record(Form.sketch(function (parts) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-form'].concat(spec.classes)\n        },\n        components: map$2(spec.items, function (item) {\n          return interpretInForm(parts, item, backstage);\n        })\n      };\n    }));\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__body']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-content']\n        },\n        components: [memForm.asSpec()]\n      }],\n      behaviours: derive$1([Keying.config({\n        mode: 'acyclic',\n        useTabstopAt: not(isPseudoStop)\n      }), ComposingConfigs.memento(memForm), RepresentingConfigs.memento(memForm, {\n        postprocess: function (formValue) {\n          return toValidValues(formValue).fold(function (err) {\n            console.error(err);\n            return {};\n          }, identity$1);\n        }\n      })])\n    };\n  };\n\n  var factory$3 = function (detail, _spec) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: detail.components,\n      events: events$a(detail.action),\n      behaviours: augment(detail.tabButtonBehaviours, [Focusing.config({}), Keying.config({\n        mode: 'execution',\n        useSpace: true,\n        useEnter: true\n      }), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: detail.value\n        }\n      })]),\n      domModification: detail.domModification\n    };\n  };\n\n  var TabButton = single({\n    name: 'TabButton',\n    configFields: [defaulted('uid', undefined), required$1('value'), field$1('dom', 'dom', mergeWithThunk(function () {\n      return {\n        attributes: {\n          'role': 'tab',\n          'id': generate$6('aria'),\n          'aria-selected': 'false'\n        }\n      };\n    }), anyValue()), option('action'), defaulted('domModification', {}), field('tabButtonBehaviours', [Focusing, Keying, Representing]), required$1('view')],\n    factory: factory$3\n  });\n  var schema$1 = constant$1([required$1('tabs'), required$1('dom'), defaulted('clickToDismiss', false), field('tabbarBehaviours', [Highlighting, Keying]), markers$1(['tabClass', 'selectedClass'])]);\n  var tabsPart = group({\n    factory: TabButton,\n    name: 'tabs',\n    unit: 'tab',\n    overrides: function (barDetail) {\n      var dismissTab$1 = function (tabbar, button) {\n        Highlighting.dehighlight(tabbar, button);\n        emitWith(tabbar, dismissTab(), {\n          tabbar: tabbar,\n          button: button\n        });\n      };\n\n      var changeTab$1 = function (tabbar, button) {\n        Highlighting.highlight(tabbar, button);\n        emitWith(tabbar, changeTab(), {\n          tabbar: tabbar,\n          button: button\n        });\n      };\n\n      return {\n        action: function (button) {\n          var tabbar = button.getSystem().getByUid(barDetail.uid).getOrDie();\n          var activeButton = Highlighting.isHighlighted(tabbar, button);\n\n          var response = function () {\n            if (activeButton && barDetail.clickToDismiss) {\n              return dismissTab$1;\n            } else if (!activeButton) {\n              return changeTab$1;\n            } else {\n              return noop;\n            }\n          }();\n\n          response(tabbar, button);\n        },\n        domModification: {\n          classes: [barDetail.markers.tabClass]\n        }\n      };\n    }\n  });\n  var parts$1 = constant$1([tabsPart]);\n\n  var factory$2 = function (detail, components, _spec, _externals) {\n    return {\n      'uid': detail.uid,\n      'dom': detail.dom,\n      components: components,\n      'debug.sketcher': 'Tabbar',\n      'domModification': {\n        attributes: {\n          role: 'tablist'\n        }\n      },\n      'behaviours': augment(detail.tabbarBehaviours, [Highlighting.config({\n        highlightClass: detail.markers.selectedClass,\n        itemClass: detail.markers.tabClass,\n        onHighlight: function (tabbar, tab) {\n          set$8(tab.element, 'aria-selected', 'true');\n        },\n        onDehighlight: function (tabbar, tab) {\n          set$8(tab.element, 'aria-selected', 'false');\n        }\n      }), Keying.config({\n        mode: 'flow',\n        getInitial: function (tabbar) {\n          return Highlighting.getHighlighted(tabbar).map(function (tab) {\n            return tab.element;\n          });\n        },\n        selector: '.' + detail.markers.tabClass,\n        executeOnMove: true\n      })])\n    };\n  };\n\n  var Tabbar = composite({\n    name: 'Tabbar',\n    configFields: schema$1(),\n    partFields: parts$1(),\n    factory: factory$2\n  });\n\n  var factory$1 = function (detail, _spec) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      behaviours: augment(detail.tabviewBehaviours, [Replacing.config({})]),\n      domModification: {\n        attributes: {\n          role: 'tabpanel'\n        }\n      }\n    };\n  };\n\n  var Tabview = single({\n    name: 'Tabview',\n    configFields: [field('tabviewBehaviours', [Replacing])],\n    factory: factory$1\n  });\n  var schema = constant$1([defaulted('selectFirst', true), onHandler('onChangeTab'), onHandler('onDismissTab'), defaulted('tabs', []), field('tabSectionBehaviours', [])]);\n  var barPart = required({\n    factory: Tabbar,\n    schema: [required$1('dom'), requiredObjOf('markers', [required$1('tabClass'), required$1('selectedClass')])],\n    name: 'tabbar',\n    defaults: function (detail) {\n      return {\n        tabs: detail.tabs\n      };\n    }\n  });\n  var viewPart = required({\n    factory: Tabview,\n    name: 'tabview'\n  });\n  var parts = constant$1([barPart, viewPart]);\n\n  var factory = function (detail, components, _spec, _externals) {\n    var changeTab$1 = function (button) {\n      var tabValue = Representing.getValue(button);\n      getPart(button, detail, 'tabview').each(function (tabview) {\n        var tabWithValue = find$5(detail.tabs, function (t) {\n          return t.value === tabValue;\n        });\n        tabWithValue.each(function (tabData) {\n          var panel = tabData.view();\n          getOpt(button.element, 'id').each(function (id) {\n            set$8(tabview.element, 'aria-labelledby', id);\n          });\n          Replacing.set(tabview, panel);\n          detail.onChangeTab(tabview, button, panel);\n        });\n      });\n    };\n\n    var changeTabBy = function (section, byPred) {\n      getPart(section, detail, 'tabbar').each(function (tabbar) {\n        byPred(tabbar).each(emitExecute);\n      });\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: get$2(detail.tabSectionBehaviours),\n      events: derive$2(flatten([detail.selectFirst ? [runOnAttached(function (section, _simulatedEvent) {\n        changeTabBy(section, Highlighting.getFirst);\n      })] : [], [run$1(changeTab(), function (section, simulatedEvent) {\n        var button = simulatedEvent.event.button;\n        changeTab$1(button);\n      }), run$1(dismissTab(), function (section, simulatedEvent) {\n        var button = simulatedEvent.event.button;\n        detail.onDismissTab(section, button);\n      })]])),\n      apis: {\n        getViewItems: function (section) {\n          return getPart(section, detail, 'tabview').map(function (tabview) {\n            return Replacing.contents(tabview);\n          }).getOr([]);\n        },\n        showTab: function (section, tabKey) {\n          var getTabIfNotActive = function (tabbar) {\n            var candidates = Highlighting.getCandidates(tabbar);\n            var optTab = find$5(candidates, function (c) {\n              return Representing.getValue(c) === tabKey;\n            });\n            return optTab.filter(function (tab) {\n              return !Highlighting.isHighlighted(tabbar, tab);\n            });\n          };\n\n          changeTabBy(section, getTabIfNotActive);\n        }\n      }\n    };\n  };\n\n  var TabSection = composite({\n    name: 'TabSection',\n    configFields: schema(),\n    partFields: parts(),\n    factory: factory,\n    apis: {\n      getViewItems: function (apis, component) {\n        return apis.getViewItems(component);\n      },\n      showTab: function (apis, component, tabKey) {\n        apis.showTab(component, tabKey);\n      }\n    }\n  });\n\n  var measureHeights = function (allTabs, tabview, tabviewComp) {\n    return map$2(allTabs, function (_tab, i) {\n      Replacing.set(tabviewComp, allTabs[i].view());\n      var rect = tabview.dom.getBoundingClientRect();\n      Replacing.set(tabviewComp, []);\n      return rect.height;\n    });\n  };\n\n  var getMaxHeight = function (heights) {\n    return head(sort(heights, function (a, b) {\n      if (a > b) {\n        return -1;\n      } else if (a < b) {\n        return +1;\n      } else {\n        return 0;\n      }\n    }));\n  };\n\n  var getMaxTabviewHeight = function (dialog, tabview, tablist) {\n    var documentElement$1 = documentElement(dialog).dom;\n    var rootElm = ancestor(dialog, '.tox-dialog-wrap').getOr(dialog);\n    var isFixed = get$c(rootElm, 'position') === 'fixed';\n    var maxHeight;\n\n    if (isFixed) {\n      maxHeight = Math.max(documentElement$1.clientHeight, window.innerHeight);\n    } else {\n      maxHeight = Math.max(documentElement$1.offsetHeight, documentElement$1.scrollHeight);\n    }\n\n    var tabviewHeight = get$b(tabview);\n    var isTabListBeside = tabview.dom.offsetLeft >= tablist.dom.offsetLeft + get$a(tablist);\n    var currentTabHeight = isTabListBeside ? Math.max(get$b(tablist), tabviewHeight) : tabviewHeight;\n    var dialogTopMargin = parseInt(get$c(dialog, 'margin-top'), 10) || 0;\n    var dialogBottomMargin = parseInt(get$c(dialog, 'margin-bottom'), 10) || 0;\n    var dialogHeight = get$b(dialog) + dialogTopMargin + dialogBottomMargin;\n    var chromeHeight = dialogHeight - currentTabHeight;\n    return maxHeight - chromeHeight;\n  };\n\n  var showTab = function (allTabs, comp) {\n    head(allTabs).each(function (tab) {\n      return TabSection.showTab(comp, tab.value);\n    });\n  };\n\n  var setTabviewHeight = function (tabview, height) {\n    set$7(tabview, 'height', height + 'px');\n\n    if (!detect$1().browser.isIE()) {\n      set$7(tabview, 'flex-basis', height + 'px');\n    } else {\n      remove$6(tabview, 'flex-basis');\n    }\n  };\n\n  var updateTabviewHeight = function (dialogBody, tabview, maxTabHeight) {\n    ancestor(dialogBody, '[role=\"dialog\"]').each(function (dialog) {\n      descendant(dialog, '[role=\"tablist\"]').each(function (tablist) {\n        maxTabHeight.get().map(function (height) {\n          set$7(tabview, 'height', '0');\n          set$7(tabview, 'flex-basis', '0');\n          return Math.min(height, getMaxTabviewHeight(dialog, tabview, tablist));\n        }).each(function (height) {\n          setTabviewHeight(tabview, height);\n        });\n      });\n    });\n  };\n\n  var getTabview = function (dialog) {\n    return descendant(dialog, '[role=\"tabpanel\"]');\n  };\n\n  var setMode = function (allTabs) {\n    var smartTabHeight = function () {\n      var maxTabHeight = value$1();\n      var extraEvents = [runOnAttached(function (comp) {\n        var dialog = comp.element;\n        getTabview(dialog).each(function (tabview) {\n          set$7(tabview, 'visibility', 'hidden');\n          comp.getSystem().getByDom(tabview).toOptional().each(function (tabviewComp) {\n            var heights = measureHeights(allTabs, tabview, tabviewComp);\n            var maxTabHeightOpt = getMaxHeight(heights);\n            maxTabHeightOpt.fold(maxTabHeight.clear, maxTabHeight.set);\n          });\n          updateTabviewHeight(dialog, tabview, maxTabHeight);\n          remove$6(tabview, 'visibility');\n          showTab(allTabs, comp);\n          global$f.requestAnimationFrame(function () {\n            updateTabviewHeight(dialog, tabview, maxTabHeight);\n          });\n        });\n      }), run$1(windowResize(), function (comp) {\n        var dialog = comp.element;\n        getTabview(dialog).each(function (tabview) {\n          updateTabviewHeight(dialog, tabview, maxTabHeight);\n        });\n      }), run$1(formResizeEvent, function (comp, _se) {\n        var dialog = comp.element;\n        getTabview(dialog).each(function (tabview) {\n          var oldFocus = active(getRootNode(tabview));\n          set$7(tabview, 'visibility', 'hidden');\n          var oldHeight = getRaw(tabview, 'height').map(function (h) {\n            return parseInt(h, 10);\n          });\n          remove$6(tabview, 'height');\n          remove$6(tabview, 'flex-basis');\n          var newHeight = tabview.dom.getBoundingClientRect().height;\n          var hasGrown = oldHeight.forall(function (h) {\n            return newHeight > h;\n          });\n\n          if (hasGrown) {\n            maxTabHeight.set(newHeight);\n            updateTabviewHeight(dialog, tabview, maxTabHeight);\n          } else {\n            oldHeight.each(function (h) {\n              setTabviewHeight(tabview, h);\n            });\n          }\n\n          remove$6(tabview, 'visibility');\n          oldFocus.each(focus$3);\n        });\n      })];\n      var selectFirst = false;\n      return {\n        extraEvents: extraEvents,\n        selectFirst: selectFirst\n      };\n    }();\n\n    var naiveTabHeight = function () {\n      var extraEvents = [];\n      var selectFirst = true;\n      return {\n        extraEvents: extraEvents,\n        selectFirst: selectFirst\n      };\n    }();\n\n    return {\n      smartTabHeight: smartTabHeight,\n      naiveTabHeight: naiveTabHeight\n    };\n  };\n\n  var SendDataToSectionChannel = 'send-data-to-section';\n  var SendDataToViewChannel = 'send-data-to-view';\n\n  var renderTabPanel = function (spec, backstage) {\n    var storedValue = Cell({});\n\n    var updateDataWithForm = function (form) {\n      var formData = Representing.getValue(form);\n      var validData = toValidValues(formData).getOr({});\n      var currentData = storedValue.get();\n      var newData = deepMerge(currentData, validData);\n      storedValue.set(newData);\n    };\n\n    var setDataOnForm = function (form) {\n      var tabData = storedValue.get();\n      Representing.setValue(form, tabData);\n    };\n\n    var oldTab = Cell(null);\n    var allTabs = map$2(spec.tabs, function (tab) {\n      return {\n        value: tab.name,\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-nav-item'],\n          innerHtml: backstage.shared.providers.translate(tab.title)\n        },\n        view: function () {\n          return [Form.sketch(function (parts) {\n            return {\n              dom: {\n                tag: 'div',\n                classes: ['tox-form']\n              },\n              components: map$2(tab.items, function (item) {\n                return interpretInForm(parts, item, backstage);\n              }),\n              formBehaviours: derive$1([Keying.config({\n                mode: 'acyclic',\n                useTabstopAt: not(isPseudoStop)\n              }), config('TabView.form.events', [runOnAttached(setDataOnForm), runOnDetached(updateDataWithForm)]), Receiving.config({\n                channels: wrapAll([{\n                  key: SendDataToSectionChannel,\n                  value: {\n                    onReceive: updateDataWithForm\n                  }\n                }, {\n                  key: SendDataToViewChannel,\n                  value: {\n                    onReceive: setDataOnForm\n                  }\n                }])\n              })])\n            };\n          })];\n        }\n      };\n    });\n    var tabMode = setMode(allTabs).smartTabHeight;\n    return TabSection.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__body']\n      },\n      onChangeTab: function (section, button, _viewItems) {\n        var name = Representing.getValue(button);\n        emitWith(section, formTabChangeEvent, {\n          name: name,\n          oldName: oldTab.get()\n        });\n        oldTab.set(name);\n      },\n      tabs: allTabs,\n      components: [TabSection.parts.tabbar({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-nav']\n        },\n        components: [Tabbar.parts.tabs({})],\n        markers: {\n          tabClass: 'tox-tab',\n          selectedClass: 'tox-dialog__body-nav-item--active'\n        },\n        tabbarBehaviours: derive$1([Tabstopping.config({})])\n      }), TabSection.parts.tabview({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-content']\n        }\n      })],\n      selectFirst: tabMode.selectFirst,\n      tabSectionBehaviours: derive$1([config('tabpanel', tabMode.extraEvents), Keying.config({\n        mode: 'acyclic'\n      }), Composing.config({\n        find: function (comp) {\n          return head(TabSection.getViewItems(comp));\n        }\n      }), Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (tsection) {\n            tsection.getSystem().broadcastOn([SendDataToSectionChannel], {});\n            return storedValue.get();\n          },\n          setValue: function (tsection, value) {\n            storedValue.set(value);\n            tsection.getSystem().broadcastOn([SendDataToViewChannel], {});\n          }\n        }\n      })])\n    });\n  };\n\n  var dialogChannel = generate$6('update-dialog');\n  var titleChannel = generate$6('update-title');\n  var bodyChannel = generate$6('update-body');\n  var footerChannel = generate$6('update-footer');\n  var bodySendMessageChannel = generate$6('body-send-message');\n\n  var renderBody = function (spec, id, backstage, ariaAttrs) {\n    var renderComponents = function (incoming) {\n      switch (incoming.body.type) {\n        case 'tabpanel':\n          {\n            return [renderTabPanel(incoming.body, backstage)];\n          }\n\n        default:\n          {\n            return [renderBodyPanel(incoming.body, backstage)];\n          }\n      }\n    };\n\n    var updateState = function (_comp, incoming) {\n      return Optional.some({\n        isTabPanel: function () {\n          return incoming.body.type === 'tabpanel';\n        }\n      });\n    };\n\n    var ariaAttributes = {\n      'aria-live': 'polite'\n    };\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__content-js'],\n        attributes: __assign(__assign({}, id.map(function (x) {\n          return {\n            id: x\n          };\n        }).getOr({})), ariaAttrs ? ariaAttributes : {})\n      },\n      components: [],\n      behaviours: derive$1([ComposingConfigs.childAt(0), Reflecting.config({\n        channel: bodyChannel,\n        updateState: updateState,\n        renderComponents: renderComponents,\n        initialData: spec\n      })])\n    };\n  };\n\n  var renderInlineBody = function (spec, contentId, backstage, ariaAttrs) {\n    return renderBody(spec, Optional.some(contentId), backstage, ariaAttrs);\n  };\n\n  var renderModalBody = function (spec, backstage) {\n    var bodySpec = renderBody(spec, Optional.none(), backstage, false);\n    return ModalDialog.parts.body(bodySpec);\n  };\n\n  var renderIframeBody = function (spec) {\n    var bodySpec = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__content-js']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-iframe']\n        },\n        components: [craft({\n          dom: {\n            tag: 'iframe',\n            attributes: {\n              src: spec.url\n            }\n          },\n          behaviours: derive$1([Tabstopping.config({}), Focusing.config({})])\n        })]\n      }],\n      behaviours: derive$1([Keying.config({\n        mode: 'acyclic',\n        useTabstopAt: not(isPseudoStop)\n      })])\n    };\n    return ModalDialog.parts.body(bodySpec);\n  };\n\n  var isTouch = global$9.deviceType.isTouch();\n\n  var hiddenHeader = function (title, close) {\n    return {\n      dom: {\n        tag: 'div',\n        styles: {\n          display: 'none'\n        },\n        classes: ['tox-dialog__header']\n      },\n      components: [title, close]\n    };\n  };\n\n  var pClose = function (onClose, providersBackstage) {\n    return ModalDialog.parts.close(Button.sketch({\n      dom: {\n        tag: 'button',\n        classes: ['tox-button', 'tox-button--icon', 'tox-button--naked'],\n        attributes: {\n          'type': 'button',\n          'aria-label': providersBackstage.translate('Close')\n        }\n      },\n      action: onClose,\n      buttonBehaviours: derive$1([Tabstopping.config({})])\n    }));\n  };\n\n  var pUntitled = function () {\n    return ModalDialog.parts.title({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__title'],\n        innerHtml: '',\n        styles: {\n          display: 'none'\n        }\n      }\n    });\n  };\n\n  var pBodyMessage = function (message, providersBackstage) {\n    return ModalDialog.parts.body({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__body']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-content']\n        },\n        components: [{\n          dom: fromHtml('<p>' + providersBackstage.translate(message) + '</p>')\n        }]\n      }]\n    });\n  };\n\n  var pFooter = function (buttons) {\n    return ModalDialog.parts.footer({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__footer']\n      },\n      components: buttons\n    });\n  };\n\n  var pFooterGroup = function (startButtons, endButtons) {\n    return [Container.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__footer-start']\n      },\n      components: startButtons\n    }), Container.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__footer-end']\n      },\n      components: endButtons\n    })];\n  };\n\n  var renderDialog$1 = function (spec) {\n    var _a;\n\n    var dialogClass = 'tox-dialog';\n    var blockerClass = dialogClass + '-wrap';\n    var blockerBackdropClass = blockerClass + '__backdrop';\n    var scrollLockClass = dialogClass + '__disable-scroll';\n    return ModalDialog.sketch({\n      lazySink: spec.lazySink,\n      onEscape: function (comp) {\n        spec.onEscape(comp);\n        return Optional.some(true);\n      },\n      useTabstopAt: function (elem) {\n        return !isPseudoStop(elem);\n      },\n      dom: {\n        tag: 'div',\n        classes: [dialogClass].concat(spec.extraClasses),\n        styles: __assign({\n          position: 'relative'\n        }, spec.extraStyles)\n      },\n      components: __spreadArray([spec.header, spec.body], spec.footer.toArray(), true),\n      parts: {\n        blocker: {\n          dom: fromHtml('<div class=\"' + blockerClass + '\"></div>'),\n          components: [{\n            dom: {\n              tag: 'div',\n              classes: isTouch ? [blockerBackdropClass, blockerBackdropClass + '--opaque'] : [blockerBackdropClass]\n            }\n          }]\n        }\n      },\n      dragBlockClass: blockerClass,\n      modalBehaviours: derive$1(__spreadArray([Focusing.config({}), config('dialog-events', spec.dialogEvents.concat([runOnSource(focusin(), function (comp, _se) {\n        Keying.focusIn(comp);\n      })])), config('scroll-lock', [runOnAttached(function () {\n        add$2(body(), scrollLockClass);\n      }), runOnDetached(function () {\n        remove$2(body(), scrollLockClass);\n      })])], spec.extraBehaviours, true)),\n      eventOrder: __assign((_a = {}, _a[execute$5()] = ['dialog-events'], _a[attachedToDom()] = ['scroll-lock', 'dialog-events', 'alloy.base.behaviour'], _a[detachedFromDom()] = ['alloy.base.behaviour', 'dialog-events', 'scroll-lock'], _a), spec.eventOrder)\n    });\n  };\n\n  var renderClose = function (providersBackstage) {\n    return Button.sketch({\n      dom: {\n        tag: 'button',\n        classes: ['tox-button', 'tox-button--icon', 'tox-button--naked'],\n        attributes: {\n          'type': 'button',\n          'aria-label': providersBackstage.translate('Close'),\n          'title': providersBackstage.translate('Close')\n        }\n      },\n      components: [render$3('close', {\n        tag: 'div',\n        classes: ['tox-icon']\n      }, providersBackstage.icons)],\n      action: function (comp) {\n        emit(comp, formCancelEvent);\n      }\n    });\n  };\n\n  var renderTitle = function (spec, id, providersBackstage) {\n    var renderComponents = function (data) {\n      return [text(providersBackstage.translate(data.title))];\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__title'],\n        attributes: __assign({}, id.map(function (x) {\n          return {\n            id: x\n          };\n        }).getOr({}))\n      },\n      components: renderComponents(spec),\n      behaviours: derive$1([Reflecting.config({\n        channel: titleChannel,\n        renderComponents: renderComponents\n      })])\n    };\n  };\n\n  var renderDragHandle = function () {\n    return {\n      dom: fromHtml('<div class=\"tox-dialog__draghandle\"></div>')\n    };\n  };\n\n  var renderInlineHeader = function (spec, titleId, providersBackstage) {\n    return Container.sketch({\n      dom: fromHtml('<div class=\"tox-dialog__header\"></div>'),\n      components: [renderTitle(spec, Optional.some(titleId), providersBackstage), renderDragHandle(), renderClose(providersBackstage)],\n      containerBehaviours: derive$1([Dragging.config({\n        mode: 'mouse',\n        blockerClass: 'blocker',\n        getTarget: function (handle) {\n          return closest$1(handle, '[role=\"dialog\"]').getOrDie();\n        },\n        snaps: {\n          getSnapPoints: function () {\n            return [];\n          },\n          leftAttr: 'data-drag-left',\n          topAttr: 'data-drag-top'\n        }\n      })])\n    });\n  };\n\n  var renderModalHeader = function (spec, providersBackstage) {\n    var pTitle = ModalDialog.parts.title(renderTitle(spec, Optional.none(), providersBackstage));\n    var pHandle = ModalDialog.parts.draghandle(renderDragHandle());\n    var pClose = ModalDialog.parts.close(renderClose(providersBackstage));\n    var components = [pTitle].concat(spec.draggable ? [pHandle] : []).concat([pClose]);\n    return Container.sketch({\n      dom: fromHtml('<div class=\"tox-dialog__header\"></div>'),\n      components: components\n    });\n  };\n\n  var getHeader = function (title, backstage) {\n    return renderModalHeader({\n      title: backstage.shared.providers.translate(title),\n      draggable: backstage.dialog.isDraggableModal()\n    }, backstage.shared.providers);\n  };\n\n  var getBusySpec = function (message, bs, providers) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__busy-spinner'],\n        attributes: {\n          'aria-label': providers.translate(message)\n        },\n        styles: {\n          left: '0px',\n          right: '0px',\n          bottom: '0px',\n          top: '0px',\n          position: 'absolute'\n        }\n      },\n      behaviours: bs,\n      components: [{\n        dom: fromHtml('<div class=\"tox-spinner\"><div></div><div></div><div></div></div>')\n      }]\n    };\n  };\n\n  var getEventExtras = function (lazyDialog, providers, extra) {\n    return {\n      onClose: function () {\n        return extra.closeWindow();\n      },\n      onBlock: function (blockEvent) {\n        ModalDialog.setBusy(lazyDialog(), function (_comp, bs) {\n          return getBusySpec(blockEvent.message, bs, providers);\n        });\n      },\n      onUnblock: function () {\n        ModalDialog.setIdle(lazyDialog());\n      }\n    };\n  };\n\n  var renderModalDialog = function (spec, initialData, dialogEvents, backstage) {\n    var _a;\n\n    var updateState = function (_comp, incoming) {\n      return Optional.some(incoming);\n    };\n\n    return build$1(renderDialog$1(__assign(__assign({}, spec), {\n      lazySink: backstage.shared.getSink,\n      extraBehaviours: __spreadArray([Reflecting.config({\n        channel: dialogChannel,\n        updateState: updateState,\n        initialData: initialData\n      }), RepresentingConfigs.memory({})], spec.extraBehaviours, true),\n      onEscape: function (comp) {\n        emit(comp, formCancelEvent);\n      },\n      dialogEvents: dialogEvents,\n      eventOrder: (_a = {}, _a[receive()] = [Reflecting.name(), Receiving.name()], _a[attachedToDom()] = ['scroll-lock', Reflecting.name(), 'messages', 'dialog-events', 'alloy.base.behaviour'], _a[detachedFromDom()] = ['alloy.base.behaviour', 'dialog-events', 'messages', Reflecting.name(), 'scroll-lock'], _a)\n    })));\n  };\n\n  var mapMenuButtons = function (buttons) {\n    var mapItems = function (button) {\n      var items = map$2(button.items, function (item) {\n        var cell = Cell(false);\n        return __assign(__assign({}, item), {\n          storage: cell\n        });\n      });\n      return __assign(__assign({}, button), {\n        items: items\n      });\n    };\n\n    return map$2(buttons, function (button) {\n      if (button.type === 'menu') {\n        return mapItems(button);\n      }\n\n      return button;\n    });\n  };\n\n  var extractCellsToObject = function (buttons) {\n    return foldl(buttons, function (acc, button) {\n      if (button.type === 'menu') {\n        var menuButton = button;\n        return foldl(menuButton.items, function (innerAcc, item) {\n          innerAcc[item.name] = item.storage;\n          return innerAcc;\n        }, acc);\n      }\n\n      return acc;\n    }, {});\n  };\n\n  var initCommonEvents = function (fireApiEvent, extras) {\n    return [runWithTarget(focusin(), onFocus), fireApiEvent(formCloseEvent, function (_api, spec) {\n      extras.onClose();\n      spec.onClose();\n    }), fireApiEvent(formCancelEvent, function (api, spec, _event, self) {\n      spec.onCancel(api);\n      emit(self, formCloseEvent);\n    }), run$1(formUnblockEvent, function (_c, _se) {\n      return extras.onUnblock();\n    }), run$1(formBlockEvent, function (_c, se) {\n      return extras.onBlock(se.event);\n    })];\n  };\n\n  var initUrlDialog = function (getInstanceApi, extras) {\n    var fireApiEvent = function (eventName, f) {\n      return run$1(eventName, function (c, se) {\n        withSpec(c, function (spec, _c) {\n          f(getInstanceApi(), spec, se.event, c);\n        });\n      });\n    };\n\n    var withSpec = function (c, f) {\n      Reflecting.getState(c).get().each(function (currentDialog) {\n        f(currentDialog, c);\n      });\n    };\n\n    return __spreadArray(__spreadArray([], initCommonEvents(fireApiEvent, extras), true), [fireApiEvent(formActionEvent, function (api, spec, event) {\n      spec.onAction(api, {\n        name: event.name\n      });\n    })], false);\n  };\n\n  var initDialog = function (getInstanceApi, extras, getSink) {\n    var fireApiEvent = function (eventName, f) {\n      return run$1(eventName, function (c, se) {\n        withSpec(c, function (spec, _c) {\n          f(getInstanceApi(), spec, se.event, c);\n        });\n      });\n    };\n\n    var withSpec = function (c, f) {\n      Reflecting.getState(c).get().each(function (currentDialogInit) {\n        f(currentDialogInit.internalDialog, c);\n      });\n    };\n\n    return __spreadArray(__spreadArray([], initCommonEvents(fireApiEvent, extras), true), [fireApiEvent(formSubmitEvent, function (api, spec) {\n      return spec.onSubmit(api);\n    }), fireApiEvent(formChangeEvent, function (api, spec, event) {\n      spec.onChange(api, {\n        name: event.name\n      });\n    }), fireApiEvent(formActionEvent, function (api, spec, event, component) {\n      var focusIn = function () {\n        return Keying.focusIn(component);\n      };\n\n      var isDisabled = function (focused) {\n        return has$1(focused, 'disabled') || getOpt(focused, 'aria-disabled').exists(function (val) {\n          return val === 'true';\n        });\n      };\n\n      var rootNode = getRootNode(component.element);\n      var current = active(rootNode);\n      spec.onAction(api, {\n        name: event.name,\n        value: event.value\n      });\n      active(rootNode).fold(focusIn, function (focused) {\n        if (isDisabled(focused)) {\n          focusIn();\n        } else if (current.exists(function (cur) {\n          return contains(focused, cur) && isDisabled(cur);\n        })) {\n          focusIn();\n        } else {\n          getSink().toOptional().filter(function (sink) {\n            return !contains(sink.element, focused);\n          }).each(focusIn);\n        }\n      });\n    }), fireApiEvent(formTabChangeEvent, function (api, spec, event) {\n      spec.onTabChange(api, {\n        newTabName: event.name,\n        oldTabName: event.oldName\n      });\n    }), runOnDetached(function (component) {\n      var api = getInstanceApi();\n      Representing.setValue(component, api.getData());\n    })], false);\n  };\n\n  var SilverDialogEvents = {\n    initUrlDialog: initUrlDialog,\n    initDialog: initDialog\n  };\n\n  var makeButton = function (button, backstage) {\n    return renderFooterButton(button, button.type, backstage);\n  };\n\n  var lookup = function (compInSystem, footerButtons, buttonName) {\n    return find$5(footerButtons, function (button) {\n      return button.name === buttonName;\n    }).bind(function (memButton) {\n      return memButton.memento.getOpt(compInSystem);\n    });\n  };\n\n  var renderComponents = function (_data, state) {\n    var footerButtons = state.map(function (s) {\n      return s.footerButtons;\n    }).getOr([]);\n    var buttonGroups = partition$3(footerButtons, function (button) {\n      return button.align === 'start';\n    });\n\n    var makeGroup = function (edge, buttons) {\n      return Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__footer-' + edge]\n        },\n        components: map$2(buttons, function (button) {\n          return button.memento.asSpec();\n        })\n      });\n    };\n\n    var startButtons = makeGroup('start', buttonGroups.pass);\n    var endButtons = makeGroup('end', buttonGroups.fail);\n    return [startButtons, endButtons];\n  };\n\n  var renderFooter = function (initSpec, backstage) {\n    var updateState = function (_comp, data) {\n      var footerButtons = map$2(data.buttons, function (button) {\n        var memButton = record(makeButton(button, backstage));\n        return {\n          name: button.name,\n          align: button.align,\n          memento: memButton\n        };\n      });\n\n      var lookupByName = function (compInSystem, buttonName) {\n        return lookup(compInSystem, footerButtons, buttonName);\n      };\n\n      return Optional.some({\n        lookupByName: lookupByName,\n        footerButtons: footerButtons\n      });\n    };\n\n    return {\n      dom: fromHtml('<div class=\"tox-dialog__footer\"></div>'),\n      components: [],\n      behaviours: derive$1([Reflecting.config({\n        channel: footerChannel,\n        initialData: initSpec,\n        updateState: updateState,\n        renderComponents: renderComponents\n      })])\n    };\n  };\n\n  var renderInlineFooter = function (initSpec, backstage) {\n    return renderFooter(initSpec, backstage);\n  };\n\n  var renderModalFooter = function (initSpec, backstage) {\n    return ModalDialog.parts.footer(renderFooter(initSpec, backstage));\n  };\n\n  var getCompByName = function (access, name) {\n    var root = access.getRoot();\n\n    if (root.getSystem().isConnected()) {\n      var form_1 = Composing.getCurrent(access.getFormWrapper()).getOr(access.getFormWrapper());\n      return Form.getField(form_1, name).fold(function () {\n        var footer = access.getFooter();\n        var footerState = Reflecting.getState(footer);\n        return footerState.get().bind(function (f) {\n          return f.lookupByName(form_1, name);\n        });\n      }, function (comp) {\n        return Optional.some(comp);\n      });\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var validateData$1 = function (access, data) {\n    var root = access.getRoot();\n    return Reflecting.getState(root).get().map(function (dialogState) {\n      return getOrDie(asRaw('data', dialogState.dataValidator, data));\n    }).getOr(data);\n  };\n\n  var getDialogApi = function (access, doRedial, menuItemStates) {\n    var withRoot = function (f) {\n      var root = access.getRoot();\n\n      if (root.getSystem().isConnected()) {\n        f(root);\n      }\n    };\n\n    var getData = function () {\n      var root = access.getRoot();\n      var valueComp = root.getSystem().isConnected() ? access.getFormWrapper() : root;\n      var representedValues = Representing.getValue(valueComp);\n      var menuItemCurrentState = map$1(menuItemStates, function (cell) {\n        return cell.get();\n      });\n      return __assign(__assign({}, representedValues), menuItemCurrentState);\n    };\n\n    var setData = function (newData) {\n      withRoot(function (_) {\n        var prevData = instanceApi.getData();\n\n        var mergedData = __assign(__assign({}, prevData), newData);\n\n        var newInternalData = validateData$1(access, mergedData);\n        var form = access.getFormWrapper();\n        Representing.setValue(form, newInternalData);\n        each(menuItemStates, function (v, k) {\n          if (has$2(mergedData, k)) {\n            v.set(mergedData[k]);\n          }\n        });\n      });\n    };\n\n    var disable = function (name) {\n      getCompByName(access, name).each(Disabling.disable);\n    };\n\n    var enable = function (name) {\n      getCompByName(access, name).each(Disabling.enable);\n    };\n\n    var focus = function (name) {\n      getCompByName(access, name).each(Focusing.focus);\n    };\n\n    var block = function (message) {\n      if (!isString(message)) {\n        throw new Error('The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument');\n      }\n\n      withRoot(function (root) {\n        emitWith(root, formBlockEvent, {\n          message: message\n        });\n      });\n    };\n\n    var unblock = function () {\n      withRoot(function (root) {\n        emit(root, formUnblockEvent);\n      });\n    };\n\n    var showTab = function (name) {\n      withRoot(function (_) {\n        var body = access.getBody();\n        var bodyState = Reflecting.getState(body);\n\n        if (bodyState.get().exists(function (b) {\n          return b.isTabPanel();\n        })) {\n          Composing.getCurrent(body).each(function (tabSection) {\n            TabSection.showTab(tabSection, name);\n          });\n        }\n      });\n    };\n\n    var redial = function (d) {\n      withRoot(function (root) {\n        var dialogInit = doRedial(d);\n        root.getSystem().broadcastOn([dialogChannel], dialogInit);\n        root.getSystem().broadcastOn([titleChannel], dialogInit.internalDialog);\n        root.getSystem().broadcastOn([bodyChannel], dialogInit.internalDialog);\n        root.getSystem().broadcastOn([footerChannel], dialogInit.internalDialog);\n        instanceApi.setData(dialogInit.initialData);\n      });\n    };\n\n    var close = function () {\n      withRoot(function (root) {\n        emit(root, formCloseEvent);\n      });\n    };\n\n    var instanceApi = {\n      getData: getData,\n      setData: setData,\n      disable: disable,\n      enable: enable,\n      focus: focus,\n      block: block,\n      unblock: unblock,\n      showTab: showTab,\n      redial: redial,\n      close: close\n    };\n    return instanceApi;\n  };\n\n  var getDialogSizeClasses = function (size) {\n    switch (size) {\n      case 'large':\n        return ['tox-dialog--width-lg'];\n\n      case 'medium':\n        return ['tox-dialog--width-md'];\n\n      default:\n        return [];\n    }\n  };\n\n  var renderDialog = function (dialogInit, extra, backstage) {\n    var header = getHeader(dialogInit.internalDialog.title, backstage);\n    var body = renderModalBody({\n      body: dialogInit.internalDialog.body\n    }, backstage);\n    var storagedMenuButtons = mapMenuButtons(dialogInit.internalDialog.buttons);\n    var objOfCells = extractCellsToObject(storagedMenuButtons);\n    var footer = renderModalFooter({\n      buttons: storagedMenuButtons\n    }, backstage);\n    var dialogEvents = SilverDialogEvents.initDialog(function () {\n      return instanceApi;\n    }, getEventExtras(function () {\n      return dialog;\n    }, backstage.shared.providers, extra), backstage.shared.getSink);\n    var dialogSize = getDialogSizeClasses(dialogInit.internalDialog.size);\n    var spec = {\n      header: header,\n      body: body,\n      footer: Optional.some(footer),\n      extraClasses: dialogSize,\n      extraBehaviours: [],\n      extraStyles: {}\n    };\n    var dialog = renderModalDialog(spec, dialogInit, dialogEvents, backstage);\n\n    var modalAccess = function () {\n      var getForm = function () {\n        var outerForm = ModalDialog.getBody(dialog);\n        return Composing.getCurrent(outerForm).getOr(outerForm);\n      };\n\n      return {\n        getRoot: constant$1(dialog),\n        getBody: function () {\n          return ModalDialog.getBody(dialog);\n        },\n        getFooter: function () {\n          return ModalDialog.getFooter(dialog);\n        },\n        getFormWrapper: getForm\n      };\n    }();\n\n    var instanceApi = getDialogApi(modalAccess, extra.redial, objOfCells);\n    return {\n      dialog: dialog,\n      instanceApi: instanceApi\n    };\n  };\n\n  var renderInlineDialog = function (dialogInit, extra, backstage, ariaAttrs) {\n    var _a, _b;\n\n    var dialogLabelId = generate$6('dialog-label');\n    var dialogContentId = generate$6('dialog-content');\n\n    var updateState = function (_comp, incoming) {\n      return Optional.some(incoming);\n    };\n\n    var memHeader = record(renderInlineHeader({\n      title: dialogInit.internalDialog.title,\n      draggable: true\n    }, dialogLabelId, backstage.shared.providers));\n    var memBody = record(renderInlineBody({\n      body: dialogInit.internalDialog.body\n    }, dialogContentId, backstage, ariaAttrs));\n    var storagedMenuButtons = mapMenuButtons(dialogInit.internalDialog.buttons);\n    var objOfCells = extractCellsToObject(storagedMenuButtons);\n    var memFooter = record(renderInlineFooter({\n      buttons: storagedMenuButtons\n    }, backstage));\n    var dialogEvents = SilverDialogEvents.initDialog(function () {\n      return instanceApi;\n    }, {\n      onBlock: function (event) {\n        Blocking.block(dialog, function (_comp, bs) {\n          return getBusySpec(event.message, bs, backstage.shared.providers);\n        });\n      },\n      onUnblock: function () {\n        Blocking.unblock(dialog);\n      },\n      onClose: function () {\n        return extra.closeWindow();\n      }\n    }, backstage.shared.getSink);\n    var dialog = build$1({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog', 'tox-dialog-inline'],\n        attributes: (_a = {\n          role: 'dialog'\n        }, _a['aria-labelledby'] = dialogLabelId, _a['aria-describedby'] = dialogContentId, _a)\n      },\n      eventOrder: (_b = {}, _b[receive()] = [Reflecting.name(), Receiving.name()], _b[execute$5()] = ['execute-on-form'], _b[attachedToDom()] = ['reflecting', 'execute-on-form'], _b),\n      behaviours: derive$1([Keying.config({\n        mode: 'cyclic',\n        onEscape: function (c) {\n          emit(c, formCloseEvent);\n          return Optional.some(true);\n        },\n        useTabstopAt: function (elem) {\n          return !isPseudoStop(elem) && (name$2(elem) !== 'button' || get$d(elem, 'disabled') !== 'disabled');\n        }\n      }), Reflecting.config({\n        channel: dialogChannel,\n        updateState: updateState,\n        initialData: dialogInit\n      }), Focusing.config({}), config('execute-on-form', dialogEvents.concat([runOnSource(focusin(), function (comp, _se) {\n        Keying.focusIn(comp);\n      })])), Blocking.config({\n        getRoot: function () {\n          return Optional.some(dialog);\n        }\n      }), Replacing.config({}), RepresentingConfigs.memory({})]),\n      components: [memHeader.asSpec(), memBody.asSpec(), memFooter.asSpec()]\n    });\n    var instanceApi = getDialogApi({\n      getRoot: constant$1(dialog),\n      getFooter: function () {\n        return memFooter.get(dialog);\n      },\n      getBody: function () {\n        return memBody.get(dialog);\n      },\n      getFormWrapper: function () {\n        var body = memBody.get(dialog);\n        return Composing.getCurrent(body).getOr(body);\n      }\n    }, extra.redial, objOfCells);\n    return {\n      dialog: dialog,\n      instanceApi: instanceApi\n    };\n  };\n\n  var global$1 = tinymce.util.Tools.resolve('tinymce.util.URI');\n\n  var getUrlDialogApi = function (root) {\n    var withRoot = function (f) {\n      if (root.getSystem().isConnected()) {\n        f(root);\n      }\n    };\n\n    var block = function (message) {\n      if (!isString(message)) {\n        throw new Error('The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument');\n      }\n\n      withRoot(function (root) {\n        emitWith(root, formBlockEvent, {\n          message: message\n        });\n      });\n    };\n\n    var unblock = function () {\n      withRoot(function (root) {\n        emit(root, formUnblockEvent);\n      });\n    };\n\n    var close = function () {\n      withRoot(function (root) {\n        emit(root, formCloseEvent);\n      });\n    };\n\n    var sendMessage = function (data) {\n      withRoot(function (root) {\n        root.getSystem().broadcastOn([bodySendMessageChannel], data);\n      });\n    };\n\n    return {\n      block: block,\n      unblock: unblock,\n      close: close,\n      sendMessage: sendMessage\n    };\n  };\n\n  var SUPPORTED_MESSAGE_ACTIONS = ['insertContent', 'setContent', 'execCommand', 'close', 'block', 'unblock'];\n\n  var isSupportedMessage = function (data) {\n    return isObject(data) && SUPPORTED_MESSAGE_ACTIONS.indexOf(data.mceAction) !== -1;\n  };\n\n  var isCustomMessage = function (data) {\n    return !isSupportedMessage(data) && isObject(data) && has$2(data, 'mceAction');\n  };\n\n  var handleMessage = function (editor, api, data) {\n    switch (data.mceAction) {\n      case 'insertContent':\n        editor.insertContent(data.content);\n        break;\n\n      case 'setContent':\n        editor.setContent(data.content);\n        break;\n\n      case 'execCommand':\n        var ui = isBoolean(data.ui) ? data.ui : false;\n        editor.execCommand(data.cmd, ui, data.value);\n        break;\n\n      case 'close':\n        api.close();\n        break;\n\n      case 'block':\n        api.block(data.message);\n        break;\n\n      case 'unblock':\n        api.unblock();\n        break;\n    }\n  };\n\n  var renderUrlDialog = function (internalDialog, extra, editor, backstage) {\n    var _a;\n\n    var header = getHeader(internalDialog.title, backstage);\n    var body = renderIframeBody(internalDialog);\n    var footer = internalDialog.buttons.bind(function (buttons) {\n      if (buttons.length === 0) {\n        return Optional.none();\n      } else {\n        return Optional.some(renderModalFooter({\n          buttons: buttons\n        }, backstage));\n      }\n    });\n    var dialogEvents = SilverDialogEvents.initUrlDialog(function () {\n      return instanceApi;\n    }, getEventExtras(function () {\n      return dialog;\n    }, backstage.shared.providers, extra));\n\n    var styles = __assign(__assign({}, internalDialog.height.fold(function () {\n      return {};\n    }, function (height) {\n      return {\n        'height': height + 'px',\n        'max-height': height + 'px'\n      };\n    })), internalDialog.width.fold(function () {\n      return {};\n    }, function (width) {\n      return {\n        'width': width + 'px',\n        'max-width': width + 'px'\n      };\n    }));\n\n    var classes = internalDialog.width.isNone() && internalDialog.height.isNone() ? ['tox-dialog--width-lg'] : [];\n    var iframeUri = new global$1(internalDialog.url, {\n      base_uri: new global$1(window.location.href)\n    });\n    var iframeDomain = iframeUri.protocol + '://' + iframeUri.host + (iframeUri.port ? ':' + iframeUri.port : '');\n    var messageHandlerUnbinder = unbindable();\n    var extraBehaviours = [config('messages', [runOnAttached(function () {\n      var unbind = bind(SugarElement.fromDom(window), 'message', function (e) {\n        if (iframeUri.isSameOrigin(new global$1(e.raw.origin))) {\n          var data = e.raw.data;\n\n          if (isSupportedMessage(data)) {\n            handleMessage(editor, instanceApi, data);\n          } else if (isCustomMessage(data)) {\n            internalDialog.onMessage(instanceApi, data);\n          }\n        }\n      });\n      messageHandlerUnbinder.set(unbind);\n    }), runOnDetached(messageHandlerUnbinder.clear)]), Receiving.config({\n      channels: (_a = {}, _a[bodySendMessageChannel] = {\n        onReceive: function (comp, data) {\n          descendant(comp.element, 'iframe').each(function (iframeEle) {\n            var iframeWin = iframeEle.dom.contentWindow;\n            iframeWin.postMessage(data, iframeDomain);\n          });\n        }\n      }, _a)\n    })];\n    var spec = {\n      header: header,\n      body: body,\n      footer: footer,\n      extraClasses: classes,\n      extraBehaviours: extraBehaviours,\n      extraStyles: styles\n    };\n    var dialog = renderModalDialog(spec, internalDialog, dialogEvents, backstage);\n    var instanceApi = getUrlDialogApi(dialog);\n    return {\n      dialog: dialog,\n      instanceApi: instanceApi\n    };\n  };\n\n  var setup$2 = function (extras) {\n    var sharedBackstage = extras.backstage.shared;\n\n    var open = function (message, callback) {\n      var closeDialog = function () {\n        ModalDialog.hide(alertDialog);\n        callback();\n      };\n\n      var memFooterClose = record(renderFooterButton({\n        name: 'close-alert',\n        text: 'OK',\n        primary: true,\n        align: 'end',\n        disabled: false,\n        icon: Optional.none()\n      }, 'cancel', extras.backstage));\n      var titleSpec = pUntitled();\n      var closeSpec = pClose(closeDialog, sharedBackstage.providers);\n      var alertDialog = build$1(renderDialog$1({\n        lazySink: function () {\n          return sharedBackstage.getSink();\n        },\n        header: hiddenHeader(titleSpec, closeSpec),\n        body: pBodyMessage(message, sharedBackstage.providers),\n        footer: Optional.some(pFooter(pFooterGroup([], [memFooterClose.asSpec()]))),\n        onEscape: closeDialog,\n        extraClasses: ['tox-alert-dialog'],\n        extraBehaviours: [],\n        extraStyles: {},\n        dialogEvents: [run$1(formCancelEvent, closeDialog)],\n        eventOrder: {}\n      }));\n      ModalDialog.show(alertDialog);\n      var footerCloseButton = memFooterClose.get(alertDialog);\n      Focusing.focus(footerCloseButton);\n    };\n\n    return {\n      open: open\n    };\n  };\n\n  var setup$1 = function (extras) {\n    var sharedBackstage = extras.backstage.shared;\n\n    var open = function (message, callback) {\n      var closeDialog = function (state) {\n        ModalDialog.hide(confirmDialog);\n        callback(state);\n      };\n\n      var memFooterYes = record(renderFooterButton({\n        name: 'yes',\n        text: 'Yes',\n        primary: true,\n        align: 'end',\n        disabled: false,\n        icon: Optional.none()\n      }, 'submit', extras.backstage));\n      var footerNo = renderFooterButton({\n        name: 'no',\n        text: 'No',\n        primary: false,\n        align: 'end',\n        disabled: false,\n        icon: Optional.none()\n      }, 'cancel', extras.backstage);\n      var titleSpec = pUntitled();\n      var closeSpec = pClose(function () {\n        return closeDialog(false);\n      }, sharedBackstage.providers);\n      var confirmDialog = build$1(renderDialog$1({\n        lazySink: function () {\n          return sharedBackstage.getSink();\n        },\n        header: hiddenHeader(titleSpec, closeSpec),\n        body: pBodyMessage(message, sharedBackstage.providers),\n        footer: Optional.some(pFooter(pFooterGroup([], [footerNo, memFooterYes.asSpec()]))),\n        onEscape: function () {\n          return closeDialog(false);\n        },\n        extraClasses: ['tox-confirm-dialog'],\n        extraBehaviours: [],\n        extraStyles: {},\n        dialogEvents: [run$1(formCancelEvent, function () {\n          return closeDialog(false);\n        }), run$1(formSubmitEvent, function () {\n          return closeDialog(true);\n        })],\n        eventOrder: {}\n      }));\n      ModalDialog.show(confirmDialog);\n      var footerYesButton = memFooterYes.get(confirmDialog);\n      Focusing.focus(footerYesButton);\n    };\n\n    return {\n      open: open\n    };\n  };\n\n  var validateData = function (data, validator) {\n    return getOrDie(asRaw('data', validator, data));\n  };\n\n  var isAlertOrConfirmDialog = function (target) {\n    return closest(target, '.tox-alert-dialog') || closest(target, '.tox-confirm-dialog');\n  };\n\n  var inlineAdditionalBehaviours = function (editor, isStickyToolbar, isToolbarLocationTop) {\n    if (isStickyToolbar && isToolbarLocationTop) {\n      return [];\n    } else {\n      return [Docking.config({\n        contextual: {\n          lazyContext: function () {\n            return Optional.some(box$1(SugarElement.fromDom(editor.getContentAreaContainer())));\n          },\n          fadeInClass: 'tox-dialog-dock-fadein',\n          fadeOutClass: 'tox-dialog-dock-fadeout',\n          transitionClass: 'tox-dialog-dock-transition'\n        },\n        modes: ['top']\n      })];\n    }\n  };\n\n  var setup = function (extras) {\n    var backstage = extras.backstage;\n    var editor = extras.editor;\n    var isStickyToolbar$1 = isStickyToolbar(editor);\n    var alertDialog = setup$2(extras);\n    var confirmDialog = setup$1(extras);\n\n    var open = function (config, params, closeWindow) {\n      if (params !== undefined && params.inline === 'toolbar') {\n        return openInlineDialog(config, backstage.shared.anchors.inlineDialog(), closeWindow, params.ariaAttrs);\n      } else if (params !== undefined && params.inline === 'cursor') {\n        return openInlineDialog(config, backstage.shared.anchors.cursor(), closeWindow, params.ariaAttrs);\n      } else {\n        return openModalDialog(config, closeWindow);\n      }\n    };\n\n    var openUrl = function (config, closeWindow) {\n      return openModalUrlDialog(config, closeWindow);\n    };\n\n    var openModalUrlDialog = function (config, closeWindow) {\n      var factory = function (contents) {\n        var dialog = renderUrlDialog(contents, {\n          closeWindow: function () {\n            ModalDialog.hide(dialog.dialog);\n            closeWindow(dialog.instanceApi);\n          }\n        }, editor, backstage);\n        ModalDialog.show(dialog.dialog);\n        return dialog.instanceApi;\n      };\n\n      return DialogManager.openUrl(factory, config);\n    };\n\n    var openModalDialog = function (config, closeWindow) {\n      var factory = function (contents, internalInitialData, dataValidator) {\n        var initialData = internalInitialData;\n        var dialogInit = {\n          dataValidator: dataValidator,\n          initialData: initialData,\n          internalDialog: contents\n        };\n        var dialog = renderDialog(dialogInit, {\n          redial: DialogManager.redial,\n          closeWindow: function () {\n            ModalDialog.hide(dialog.dialog);\n            closeWindow(dialog.instanceApi);\n          }\n        }, backstage);\n        ModalDialog.show(dialog.dialog);\n        dialog.instanceApi.setData(initialData);\n        return dialog.instanceApi;\n      };\n\n      return DialogManager.open(factory, config);\n    };\n\n    var openInlineDialog = function (config$1, anchor, closeWindow, ariaAttrs) {\n      var factory = function (contents, internalInitialData, dataValidator) {\n        var initialData = validateData(internalInitialData, dataValidator);\n        var inlineDialog = value$1();\n        var isToolbarLocationTop = backstage.shared.header.isPositionedAtTop();\n        var dialogInit = {\n          dataValidator: dataValidator,\n          initialData: initialData,\n          internalDialog: contents\n        };\n\n        var refreshDocking = function () {\n          return inlineDialog.on(function (dialog) {\n            InlineView.reposition(dialog);\n            Docking.refresh(dialog);\n          });\n        };\n\n        var dialogUi = renderInlineDialog(dialogInit, {\n          redial: DialogManager.redial,\n          closeWindow: function () {\n            inlineDialog.on(InlineView.hide);\n            editor.off('ResizeEditor', refreshDocking);\n            inlineDialog.clear();\n            closeWindow(dialogUi.instanceApi);\n          }\n        }, backstage, ariaAttrs);\n        var inlineDialogComp = build$1(InlineView.sketch(__assign(__assign({\n          lazySink: backstage.shared.getSink,\n          dom: {\n            tag: 'div',\n            classes: []\n          },\n          fireDismissalEventInstead: {}\n        }, isToolbarLocationTop ? {} : {\n          fireRepositionEventInstead: {}\n        }), {\n          inlineBehaviours: derive$1(__spreadArray([config('window-manager-inline-events', [run$1(dismissRequested(), function (_comp, _se) {\n            emit(dialogUi.dialog, formCancelEvent);\n          })])], inlineAdditionalBehaviours(editor, isStickyToolbar$1, isToolbarLocationTop), true)),\n          isExtraPart: function (_comp, target) {\n            return isAlertOrConfirmDialog(target);\n          }\n        })));\n        inlineDialog.set(inlineDialogComp);\n        InlineView.showWithin(inlineDialogComp, premade(dialogUi.dialog), {\n          anchor: anchor\n        }, Optional.some(body()));\n\n        if (!isStickyToolbar$1 || !isToolbarLocationTop) {\n          Docking.refresh(inlineDialogComp);\n          editor.on('ResizeEditor', refreshDocking);\n        }\n\n        dialogUi.instanceApi.setData(initialData);\n        Keying.focusIn(dialogUi.dialog);\n        return dialogUi.instanceApi;\n      };\n\n      return DialogManager.open(factory, config$1);\n    };\n\n    var confirm = function (message, callback) {\n      confirmDialog.open(message, function (state) {\n        callback(state);\n      });\n    };\n\n    var alert = function (message, callback) {\n      alertDialog.open(message, function () {\n        callback();\n      });\n    };\n\n    var close = function (instanceApi) {\n      instanceApi.close();\n    };\n\n    return {\n      open: open,\n      openUrl: openUrl,\n      alert: alert,\n      close: close,\n      confirm: confirm\n    };\n  };\n\n  function Theme() {\n    global$g.add('silver', function (editor) {\n      var _a = setup$3(editor),\n          uiMothership = _a.uiMothership,\n          backstage = _a.backstage,\n          renderUI = _a.renderUI,\n          getUi = _a.getUi;\n\n      Autocompleter.register(editor, backstage.shared);\n      var windowMgr = setup({\n        editor: editor,\n        backstage: backstage\n      });\n      return {\n        renderUI: renderUI,\n        getWindowManagerImpl: constant$1(windowMgr),\n        getNotificationManagerImpl: function () {\n          return NotificationManagerImpl(editor, {\n            backstage: backstage\n          }, uiMothership);\n        },\n        ui: getUi()\n      };\n    });\n  }\n\n  Theme();\n})();","map":{"version":3,"sources":["/opt/bitnami/apache/htdocs/converzee-frontend/node_modules/tinymce/themes/silver/theme.js"],"names":["typeOf","x","t","Array","prototype","isPrototypeOf","constructor","name","String","isType$1","type","value","isSimpleType","eq$1","a","isString","isObject","isArray","isNull","isBoolean","isUndefined","undefined","isNullable","isNonNullable","isFunction","isNumber","isArrayOf","pred","i","len","length","noop","noarg","f","compose","fa","fb","args","_i","arguments","apply","compose1","fbc","fab","constant$1","identity$1","tripleEquals","b","curry","fn","initialArgs","restArgs","all","concat","not","die","msg","Error","never","always","global$g","tinymce","util","Tools","resolve","__assign","Object","assign","s","n","p","hasOwnProperty","call","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__spreadArray","to","from","pack","l","ar","slice","none","NONE","thunk","id","me","fold","_s","isSome","isNone","getOr","getOrThunk","getOrDie","getOrNull","getOrUndefined","or","orThunk","map","each","bind","exists","forall","filter","toArray","toString","some","constant_a","self","from$1","Optional","nativeSlice","nativeIndexOf","nativePush","push","rawIndexOf","ts","xs","r","contains$2","range$2","num","chunk$1","array","size","map$2","each$1","eachr","partition$3","pass","fail","arr","filter$2","foldr","acc","foldl","findUntil","until","find$5","findIndex$1","flatten","bind$3","reverse","difference","a1","a2","mapToObject","pure$2","sort","comparator","copy","get$f","head","last$2","findMap","keys","obj","props","k","map$1","tupleMap","v","tuple","objAcc","internalFilter","onTrue","onFalse","filter$1","mapToArray","find$4","values","get$e","key","has$2","hasNonNullableKey","is$1","lhs","rhs","left","equals","lift2","cat","sequence","oa","ob","lift3","oc","mapFrom","someIf","addToEnd","str","suffix","removeFromStart","numChars","substring","checkRange","substr","start","removeLeading","prefix","startsWith","ensureTrailing","endsWith","contains$1","blank","replace","trim$1","isNotEmpty","isEmpty","isSupported$1","dom","style","getPropertyValue","fromHtml$2","html","scope","doc","document","div","createElement","innerHTML","hasChildNodes","childNodes","console","error","fromDom","fromTag","tag","node","fromText","text","createTextNode","fromPoint","docElm","y","elementFromPoint","SugarElement","fromHtml","window","Function","DOCUMENT","DOCUMENT_FRAGMENT","ELEMENT","TEXT","name$2","element","nodeName","toLowerCase","nodeType","isType","isElement$2","isText$1","isDocument","isDocumentFragment","cached","called","DeviceType","os","browser","userAgent","mediaMatch","isiPad","isiOS","test","isiPhone","isMobile","isAndroid","isTouch","isTablet","isPhone","iOSwebview","isSafari","isDesktop","isWebView","firstMatch","regexes","find$3","agent","major","minor","group","Number","nu$d","detect$4","versionRegexes","cleanedAgent","unknown$3","Version","nu","detect","unknown","detectBrowser$1","browsers","userAgentData","brands","uaBrand","lcBrand","brand","_a","info","current","version","parseInt","detect$3","candidates","candidate","search","detectBrowser","detectOs","oses","normalVersionRegex","checkContains","target","uastring","PlatformInfo","edge","chrome","ie","opera","firefox","safari","unknown$2","nu$c","isBrowser","isEdge","isChrome","isIE","isOpera","isFirefox","Browser","windows","ios","android","linux","osx","solaris","freebsd","chromeos","unknown$1","nu$b","isOS","isWindows","isOSX","isLinux","isSolaris","isFreeBSD","isChromeOS","OperatingSystem","detect$2","userAgentDataOpt","deviceType","PlatformDetection","query","matchMedia","matches","platform","navigator","detect$1","compareDocumentPosition","match","documentPositionContainedBy","Node","DOCUMENT_POSITION_CONTAINED_BY","is","selector","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","all$3","base","querySelectorAll","one","querySelector","eq","e1","e2","regularContains","d1","d2","contains","ieContains","owner$4","ownerDocument","documentOrOwner","dos","documentElement","defaultView","parent","parentNode","offsetParent","nextSibling","children","child$2","index","cs","firstChild","spot","offset","leaf","isShadowRoot","host","supported","Element","attachShadow","getRootNode","isSupported","getContentContainer","body","isInShadowRoot","getShadowRoot","getShadowHost","getOriginalEventTarget","event","el","isOpenShadowHost","composed","composedPath","shadowRoot","inBody","getBody","rawSet","setAttribute","set$8","setAll$1","attrs","get$d","getAttribute","getOpt","has$1","hasAttribute","remove$7","removeAttribute","internalSet","property","setProperty","internalRemove","removeProperty","set$7","setAll","css","setOptions","get$c","styles","getComputedStyle","getUnsafeProperty","getRaw","raw","getAllRaw","ruleName","item","isValidValue","remove$6","reflow","offsetWidth","Dimension","getOffset","set","h","get","parseFloat","getOuter","aggregate","properties","val","isNaN","max","cumulativeInclusions","absoluteMax","api$3","getBoundingClientRect","height","offsetHeight","get$b","getOuter$2","setMax$1","inclusions","absMax","r$1","top","translate","SugarPosition","boxPosition","box","firstDefinedOrZero","absolute$3","win","offsetLeft","offsetTop","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","viewport$1","api$2","set$6","get$a","getOuter$1","setMax","mkEvent","stop","prevent","kill","fromRawEvent$1","rawEvent","stopPropagation","preventDefault","clientX","clientY","handle","handler","binder","useCapture","wrapped","addEventListener","unbind","bind$2","capture$1","removeEventListener","before$2","marker","parent$1","insertBefore","after$2","sibling","append$2","prepend$1","firstChild$1","appendChild","appendAt","before$1","elements","append$1","empty","textContent","rogue","remove$5","removeChild","unwrap","wrapper","children$1","get$9","_DOC","scrollTo","get$8","_win","bounds$1","width","right","bottom","getBounds$3","scroll","clientWidth","clientHeight","visualViewport","Math","pageLeft","pageTop","walkUp","navigation","frame","view","owner","rest","pathTo","d","paths","frameElement","owner$3","Navigation","freeze","__proto__","find$2","path","frames","loc","pointed","point","rect","bounds","box$1","xy","w","absolute$2","position","value$3","o","_opt","_f","mapError","_","onValue","toOptional","isValue","isError","error$1","message","onError","fromOption","opt","err","Result","SimpleResultType","fold$1","res","stype","serror","svalue","partition$2","results","errors","Value","bind$1","bindError","toResult$1","fromResult$1","SimpleResult","fromResult","toResult","partition","field$2","newKey","presence","prop","customField$1","instantiator","ifField","ifCustom","shallow$1","old","deep","bothObjects","deepMerge","baseMerge","merger","objects","ret","j","curObject","merge$1","required$2","process","defaultedThunk","fallbackThunk","defaulted$1","fallback","asOption","mergeWithThunk","baseThunk","mergeWith","mergeValues$1","mergeErrors$1","consolidateObj","consolidateArr","partitions","ResultCombine","formatObj","input","JSON","stringify","formatErrors","es","getErrorInfo","join","nu$a","missingRequired","missingKey","missingBranch","branches","branch","unsupportedFields","unsupported","custom","value$2","validator","extract","anyValue$1","requiredAccess","bundle","fallbackAccess","optionAccess","optionDefaultedAccess","extractField","field","av","bundleAsOption","optValue","ov","result","extractFields","fields","success","fields_1","valueThunk","getDelegate","getSetKeys","objOfOnly","delegate","objOf","fieldNames","extra","fieldStrings","_okey","_presence","_instantiator","arrOf","oneOf","props_1","setOf$1","validateKeys","keys$1","validatedKeys","validKeys","schema","vk","_desc","processor","getP","arrOfObj","anyValue","typedValue","expectedType","actualType","number","string","boolean","functionProcessor","isPostMessageable","every","postMessageable","chooseFrom","ch","vp","choose$2","choice","chosen","arrOfVal","valueOf","setOf","extractValue","label","errs","asRaw","extraction","errInfo","formatError","asRawOrDie$1","choose$1","thunkOf","desc","field$1","customField","validateEnum","required$1","requiredOf","requiredNumber","requiredString","requiredStringEnum","requiredBoolean","requiredFunction","forbid","_v","requiredObjOf","objSchema","requiredArrayOfObj","objFields","requiredArrayOf","option","optionOf","optionNumber","optionString","optionFunction","optionArrayOf","optionObjOf","optionObjOfOnly","defaulted","defaultedOf","defaultedNumber","defaultedString","defaultedStringEnum","defaultedBoolean","defaultedFunction","defaultedPostMsg","defaultedArrayOf","defaultedObjOf","Cell","initial","generate$7","cases","constructors","adt","acase","count","argLength","branchKeys","allReqd","reqKey","foldArgs","log","params","Adt","generate","bothErrors","firstError","secondError","bothValues","partition$1","exclude$1","wrap$2","wrapAll$1","keyvalues","kv","exclude","wrap$1","wrapAll","mergeValues","mergeErrors","consolidate","objs","ensureIsRoot","isRoot","ancestor$2","transform","transformed","closest$4","isSource","component","simulatedEvent","defaultEventHandler","can","abort","run","nu$9","parts","all$2","handlers","any","read$2","fuse$1","constant","touchstart","touchmove","touchend","touchcancel","mousedown","mousemove","mouseout","mouseup","mouseover","focusin","focusout","keydown","keyup","change","click","transitioncancel","transitionend","transitionstart","selectstart","prefixName","alloy","tap","focus$4","postBlur","postPaste","receive","execute$5","focusItem","longpress","sandboxClose","typeaheadCancel","systemInit","documentTouchmove","documentTouchend","windowScroll","windowResize","attachedToDom","detachedFromDom","dismissRequested","repositionRequested","focusShifted","slotVisibility","changeTab","dismissTab","highlight$1","dehighlight$1","emit","dispatchWith","emitWith","emitExecute","dispatch","data","getSystem","triggerEvent","dispatchEvent","derive$2","configs","predicate","run$1","runActionExtra","action","runOnName","runOnSourceName","redirectToUid","uid","getByUid","redirectee","redirectToPart","detail","partName","partUids","runWithTarget","ev","getByDom","closest","cutter","cut","stopper","runOnSource","runOnAttached","runOnDetached","runOnInit","runOnExecute$1","fromHtml$1","get$7","set$5","content","docDom","fragment","createDocumentFragment","contentElements","container","clone","cloneNode","clone$1","original","isDeep","shallow","getHtml","isRecursive","originator","events$i","warn","DefaultEvents","events","unique","generate$6","date","Date","time","getTime","random","floor","prefix$1","idAttr$1","idAttr","write","writeOnly","defineProperty","writable","read$1","generate$5","make$8","NoContextApi","getComp","getMessage","debugInfo","triggerFocus","triggerEscape","broadcast","broadcastOn","broadcastEvent","build","addToWorld","removeFromWorld","addToGui","removeFromGui","isConnected","singleton$1","markAsBehaviourApi","apiName","apiFunction","endIndex","openBracketIndex","parameters","split","toFunctionAnnotation","cleanParameters","markAsExtraApi","extraName","markAsSketchApi","premadeTag","premade$1","comp","getPremade","spec","makeApi","getApis","NoState","init","nu$8","readState","generateFrom$1","validated","behaviours","list","optBlobThunk","output","blob","config","state","getBehaviours$3","bData","getData$2","byInnerKey","indexKey","chain","nu$7","classes","attributes","merge","defnA","mod","combine$2","baseMod","modsByBehaviour","behaviour","exhibit","byAspect","modification","combineObjects","combinedClasses","combinedAttributes","combinedStyles","sortKeys","keyName","order","sorted","aKey","bKey","aIndex","bIndex","uncurried","purpose","curried","cHandler","curryArgs","descHandler","extraArgs","getCurried","behaviourTuple","nameToHandlers","groupByEvents","behaviourEvents","combine$1","eventOrder","byEventName","combineGroups","assemble","rawHandler","missingOrderError","eventName","tuples","c","fuse","sortedTuples","combined","assembled","_a$2","baseBehaviour","schema$z","toInfo","toDefinition","domChildren","components","toModification","domModification","toEvents","read","attr","add$4","remove$4","supports","classList","get$6","add$3","clazz","remove$3","add$2","add","cleanClass","remove$2","remove","has","add$1","remove$1","hasAll","get$5","set$4","renderToDom","definition","subject","innerHtml","getBehaviours$2","generateFrom","generate$4","getDomDefinition","bList","infoModification","baseModification","getEvents","baseEvents","build$2","getMe","systemApi","bBlob","modDefinition","subcomponents","connect","newApi","disconnect","syncComponents","subs","child","hasConfigured","apis","behaviourName","buildSubcomponents","build$1","buildFromSpec","userSpec","specEvents","completeSpec","external$2","extSpec","uids","isSketchSpec$1","userSpecWithUid","premade","ClosestOrAncestor","ancestor","ancestor$1","closest$3","child$1","descendant$1","descend","child_1","closest$2","descendant","closest$1","find$1","queryElem","dependent","dep","manager","ariaId","link","unlink","isAriaPartOf","isPartOf$1","EventConfiguration","eventConfig","makeEventLogger","initialTarget","startTime","logEventCut","_name","outcome","logEventStopped","logNoParent","logEventNoHandlers","logEventResponse","finishTime","processEvent","status","patterns","NORMAL","noLogger","LOGGING","logger","STOP","getTrace","stack","lines","line","ignoreEvent","monitorEvent","menuFields","itemFields","itemSchema$3","_initSize","itemMarkers","tieredMenuMarkers","markers$1","required","onPresenceHandler","fieldName","onHandler","onKeyboardHandler","onStrictHandler","onStrictKeyboardHandler","output$1","snapshot","initSize","nu$6","bubble","direction","placement","boundsRestriction","labelPrefix","alwaysFit","restriction","adt$a","southeast","southwest","northeast","northwest","south","north","east","west","cata$2","cataVertical","middle","cataHorizontal","southeast$3","southwest$3","northeast$3","northwest$3","south$3","north$3","east$3","west$3","cycleBy","delta","min","clamp$1","getRestriction","anchor","restrictions","dir","adjustBounds","bubbleOffset","applyRestriction","pos","isVerticalAxis","newPos","adjustedLeft","adjustedTop","adjustedRight","adjustedBottom","labelPrefix$2","eastX$1","middleX$1","westX$1","northY$2","southY$2","centreY$1","eastEdgeX$1","westEdgeX$1","southeast$2","bubbles","southwest$2","northeast$2","northwest$2","north$2","south$2","east$2","west$2","all$1","allRtl$1","aboveOrBelow","aboveOrBelowRtl","belowOrAbove","belowOrAboveRtl","chooseChannels","channels","universal","events$h","receiveConfig","channelMap","receivingData","targetChannels","channelInfo","channelSchema","onReceive","ActiveReceiving","ReceivingSchema","executeEvent","bConfig","bState","executor","loadEvent","_simulatedEvent","create$8","active","configSchema","schemaSchema","doCreate","createModes$1","modes","wrapApi","bName","revokeBehaviour","getConfig","wrappedApis","apiF","wrappedExtra","extraF","revoke","prepared","configAsRaw","initialConfig","behaviourInfo","exhibitor","derive$1","capabilities","simpleSchema","create$7","modeSchema","createModes","branchKey","Receiving","exhibit$6","posConfig","useFixed","ActivePosition","getDocument","focus$3","focus","blur$1","blur","hasFocus","root","activeElement","preserve$1","refocus","focused","oldFocus","newFocus","NuPositionCss","toPx","toOptions","applyPositionCss","adt$9","relative","fixed","positionWithDirection","posName","decision","decisionRect","decisionX","decisionY","decisionWidth","decisionHeight","decisionRight","decisionBottom","reposition","origin","toBox","rel","viewport","getBounds","translate$2","removeScroll","outerScroll","cata$1","onNone","onRelative","onFixed","relative$1","fixed$1","anchorBox","placementAttribute","setPlacement$1","getPlacement","reset$2","adt$8","fit","nofit","determinePosition","boundsX","boundsY","boundsRight","boundsBottom","xInBounds","yInBounds","originInBounds","rightInBounds","bottomInBounds","sizeInBounds","visibleW","visibleH","calcReposition","maxX","maxY","restrictedX","restrictedY","restrictedWidth","restrictedHeight","calcMaxSizes","upAvailable","downAvailable","maxHeight","westAvailable","eastAvailable","maxWidth","attempt","adjustedBounds","newX","newY","fits","fittedBox","isPartlyVisible","_b","on","classesOn","off","classesOff","layout","testY","attempts","elementBox","panelWidth","panelHeight","attemptBestFit","isVisible","next","attemptLayout","newReposition","newVisibleW","newVisibleH","newIsVisible","improved","abc","bestNext","singleton","doRevoke","clear","isSet","destroyable","destroy","unbindable","api$1","value$1","capture","fromRawEvent","timerAttr","isTransitioning$1","transition","shouldApplyTransitionCss","lastPlacement","placer","mode","hasChanges","intermediate","round","toFixed","newValue","getTransitionDuration","times","parse","delay","duration","dur","setupTransitionListeners","transitionEnd","transitionCancel","timer","isSourceTransition","pseudoElement","propertyName","transitionDone","clearTimeout","transitionStarted","transitionStart_1","requestAnimationFrame","setTimeout","startTransitioning","timerId","applyTransitionCss","shouldTransition","intermediatePosition_1","intermediateCssOptions","elementSize","options","preference","setClasses","classInfo","setHeight","maxHeightFunction","setWidth","maxWidthFunction","position$2","positionCss","setPlacement","setMaxHeight","anchored","available","expandable$1","defaultOr","dephault","simple","layouts","overrideOptions","go","allAlignments","nu$5","xOffset","yOffset","insetModifier","insetXOffset","insetYOffset","getClasses","make","xDelta","yDelta","alignmentsOn","alignmentsOff","insetNortheast","insetNorthwest","insetNorth","insetSoutheast","insetSouthwest","insetSouth","insetEast","insetWest","nu$4","onDirection","isLtr","isRtl","getDirection","AttributeValue","Attribute","isBottomToTopDir","BottomToTop","schema$y","get$4","defaultLtr","defaultRtl","defaultBottomLtr","defaultBottomRtl","dirElement","isBottomToTop","customLtr","ls","onLtr","customRtl","onRtl","ltr","onBottomLtr","rtl","onBottomRtl","placement$4","anchorInfo","hotspot","overrides","HotspotAnchor","placement$3","MakeshiftAnchor","adt$7","screen","absolute","toAbsolute","sum","points","sumAsFixed","positions","sumAsAbsolute","absolute$1","hasSameOwner","frameOwner","compOwner","getRootPoint","getBox","calcNewAnchor","optBox","rootPoint","topLeft","layoutsLtr","showAbove","layoutsRtl","placement$2","nodeBox","NodeAnchor","zeroWidth","nbsp","create$6","soffset","finish","foffset","SimRange","create","adt$6","before","after","cata","onBefore","onOn","onAfter","getStart$1","situ","on$1","after$1","Situ","getStart","adt$5","domRange","exact","exactFromRange","simRange","selection","rng","startContainer","startSitu","_finishSitu","_soffset","_finish","_foffset","getWin","range$1","SimSelection","range","setStart","setStartBefore","setStartAfter","setFinish","setEndBefore","setEnd","setEndAfter","relativeToNative","finishSitu","createRange","exactToNative","toRect","getFirstRect$1","rects","getClientRects","getBounds$2","adt$4","fromRange","startOffset","endContainer","endOffset","getRanges","doDiagnose","ranges","collapsed","reversed","rev","diagnose","asLtrRange","diagnosis","NodeValue","getOption","nodeValue","api","get$3","getEnd","isTextNodeWithCursorPosition","trim","elementsWithCursorPosition","isCursorPosition","hasCursorPosition","last$1","descendantRtl","descendants","makeRange","same","getNativeSelection","getSelection","readRange","rangeCount","firstRng","getRangeAt","lastRng","doGetExact","anchorNode","focusNode","focus_1","anchorOffset","focusOffset","getExact","sel","getFirstRect","getBounds$1","point$1","descendOnce$1","last","descendOnce","getAnchorSelection","modStart","modFinish","placement$1","selectionBox","optRect","rawRect","targetElement","SelectionAnchor","labelPrefix$1","eastX","westX","northY$1","southY$1","southeast$1","southwest$1","northeast$1","northwest$1","allRtl","submenuInfo","SubmenuAnchor","AnchorSchema","submenu","makeshift","TransitionSchema","PositionSchema","PlacementSchema","getFixedOrigin","getRelativeOrigin","place","anchoring","placee","lastPlace","position$1","posState","placementSpec","positionWithin","boxElement","boundsBox","positionWithinBounds","placeeDetail","anchorage","placeeState","oldVisibility","doPlace","newState","vis","getMode","pConfig","_pState","reset$1","PositionApis","reset","init$g","PositioningState","Positioning","fireDetaching","fireAttaching","attach$1","detachChildren$1","childComp","replaceChildren","newChildren","deleted","attach","attachWith","insertion","doDetach","detach","detachChildren","attachSystem","guiSystem","attachSystemWith","attachSystemAfter","inserter","detachSystem","rebuild","sandbox","sConfig","sState","_data","getAttachPoint","built","open$1","onOpen","setContent","openWhileCloaked","transaction","cloak","decloak","close$1","onClose","isOpen$1","_sandbox","_sConfig","isOpen","isPartOf","getState$2","store","cssKey","restore","oldValue","_sState","sink","cloakVisibilityAttr","hasPosition","SandboxApis","open","close","getState","events$g","sandboxConfig","sandboxState","ActiveSandbox","SandboxSchema","init$f","contents","SandboxState","Sandboxing","dismissPopups","repositionPopups","mouseReleased","schema$x","receivingChannel$1","rawSpec","isPart","isExtraPart","fireEventInstead","fe","schema$w","receivingChannel","doReposition","onLoad$5","repConfig","repState","onLoad","onUnload$2","onUnload","setValue$3","setValue","getValue$3","getValue","getState$1","RepresentApis","events$f","resetOnDom","_se","ActiveRepresenting","memory$1","isNotSet","manual","dataset","dataByValue","dataByText","lookup","itemString","update","items","currentDataByValue","currentDataByText","newDataByValue","newDataByText","meta","init$e","RepresentState","memory","setValue$2","onSetValue","getValue$2","getDataKey","getFallbackEntry","onLoad$4","initialValue","onUnload$1","DatasetStore","getValue$1","_repState","setValue$1","onLoad$3","ManualStore","onLoad$2","initVal","MemoryStore","RepresentSchema","Representing","setValueFrom","source","forbidden","get$2","dump","augment","SketchBehaviours","_placeholder","adt$3","single","multiple","isSubstituted","subPlaceholder","compSpec","placeholders","newSpec","scan","uiType","substitute","req","childSpecs","substituted","valuesThunk","preprocessor","preprocess","substituteAll","oneReplace","replacements","used","substitutePlaces","ps","ph","single$2","placeholder","adt$2","external","optional","fFactory","sketch","fSchema","fName","fPname","typeSpec","fGroupSchema","fDefaults","fOverrides","requiredSpec","externalSpec","optionalSpec","groupSpec","asNamedPart","part","name$1","asCommon","convert","adtConstructor","partSchema","external$1","PartType","combine","partSpec","partValidated","defaults","internals","externals","pname","factory","_partSpec","_partValidated","units","u","generate$3","np","g","doGenerateOne","generateOne$1","schemas","names","substitutes","components$1","getPart","partKey","getPartOrDie","getParts","partKeys","system","pk","getAllParts","pUid","_k","getAllPartNames","getPartsOrDie","defaultUids","baseUid","partTypes","partNames","pn","defaultUidsSchema","AlloyParts","generateOne","partSchemas","partUidsSchemas","asRawOrDie","baseS","single$1","specWithUid","supplyUid","composite$1","partUidsSchema","hasUid","isSketchSpec","singleSchema","compositeSchema","rawConfig","configFields","extraApis","composite","partFields","inside","getCurrent","composeConfig","_composeState","find","ComposeApis","ComposeSchema","Composing","nativeDisabled","onLoad$1","disableConfig","disableState","disabled","disable$1","enable$1","hasNative","useNative","nativeIsDisabled","nativeDisable","nativeEnable","ariaIsDisabled","ariaDisable","ariaEnable","_disableState","disableClass","onDisabled","onEnabled","isDisabled","set$3","DisableApis","enable","disable","exhibit$5","events$e","ActiveDisable","DisableSchema","Disabling","dehighlightAllExcept","hConfig","hState","skip","highlighted","highlightClass","skipComp","onDehighlight","dehighlightAll","dehighlight","isHighlighted","highlight","onHighlight","highlightFirst","getFirst","firstComp","highlightLast","getLast","lastComp","highlightAt","getByIndex","highlightBy","getCandidates","targetComp","queryTarget","getHighlighted","_hState","itemClass","getDelta$2","selected","dest","getPrevious","getNext","HighlightApis","HighlightSchema","Highlighting","BACKSPACE","TAB","ENTER","ESCAPE","SPACE","LEFT","UP","RIGHT","DOWN","cyclePrev","tryPrev","cycleNext","tryNext","inSet","which","and","preds","isShift","shiftKey","isControl","ctrlKey","isNotShift","rule","classification","choose","transitions","reportFocusShifting","prevFocus","noChange","dom$2","focusee","highlights","FocusInsideModes","typical","infoSchema","stateInit","getKeydownRules","getKeyupRules","optFocusIn","processKey","getRules","keyingConfig","keyingState","rules","onFocusHandler","focusInside","OnFocusMode","focusIn","tryGoInsideComponent","isEnterOrSpace","OnEnterOrSpaceMode","keyboardEvents","create$5","cyclicField","tabbingConfig","visibilitySelector","findInitial","tabstops","visibles","firstTabstop","findCurrent","focusManager","isTabstop","useTabstopAt","_tabbingState","goFromTabstop","stopIndex","cycle","cyclic","tabstop","optStopIndex","goBackwards","navigate","goForwards","execute","onEnter","exit","onEscape","AcyclicType","CyclicType","doDefaultExecute","defaultExecute","isComplex","stopEventForFirefox","_component","schema$v","execute$4","executeConfig","getKeydownRules$5","_executeState","spaceExec","useSpace","enterExec","useEnter","downExec","useDown","execKeys","useControlEnter","getKeyupRules$5","ExecutionType","flatgrid$1","dimensions","setGridSize","numRows","numColumns","getNumRows","getNumColumns","init$d","KeyingState","flatgrid","useH","movement","move","use","west$1","moveLeft","moveRight","east$1","useV","north$1","south$1","move$1","isHidden$1","locate","locateVisible","visible","findIndex","withGrid","numCols","oldRow","oldColumn","address","newIndex","row","column","cycleHorizontal$1","onLastRow","colsInRow","newColumn","cycleVertical$1","newRow","newCol","cycleRight$1","cycleLeft$1","cycleUp$1","cycleDown$1","schema$u","focusIn$3","gridConfig","_gridState","first","findCurrent$1","execute$3","doMove$2","gridState","identified","handleTab","captureTab","doEscape$1","moveLeft$3","moveRight$3","moveNorth$1","moveSouth$1","getKeydownRules$4","getKeyupRules$4","FlatgridType","horizontal","isDisabledButton","tryCycle","schema$t","flowConfig","execute$2","focusIn$2","_state","getInitial","moveLeft$2","moveRight$2","doMove$1","flowState","executeOnMove","doEscape","getKeydownRules$3","_flowState","westMovers","allowVertical","eastMovers","getKeyupRules$3","FlowType","toCell","matrix","rowIndex","columnIndex","cell","cycleHorizontal","startCol","deltaCol","newColIndex","cycleVertical","colIndex","startRow","deltaRow","nextRowIndex","colsInNextRow","nextColIndex","moveHorizontal","moveVertical","cycleRight","cycleLeft","cycleUp","cycleDown","moveLeft$1","moveRight$1","moveUp$1","moveDown$1","schema$s","focusIn$1","matrixConfig","previousSelector","selectors","execute$1","toMatrix","rows","doMove","ifCycle","ifMove","cycles","inRow","cellsInRow","allRows","moveNorth","moveSouth","getKeydownRules$2","getKeyupRules$2","MatrixType","schema$r","menuConfig","moveUp","moveDown","fireShiftTab","menuState","moveOnTab","fireTab","getKeydownRules$1","getKeyupRules$1","MenuType","schema$q","specialInfo","onSpace","onShiftEnter","onShiftTab","onTab","onUp","onDown","onLeft","onRight","stopSpaceKeyup","SpecialType","acyclic","flow","execution","menu","special","KeyboardBranches","isFlatgridState","keyState","Keying","keyConfig","sendFocusIn","set$2","replaceConfig","replaceState","insert","childSpec","append","appendee","prepend","prependee","removee","foundChild","_replaceConfig","replaceAt","replaceeIndex","replacer","replacee","replaceBy","replaceePred","ReplaceApis","Replacing","events$d","eventHandlers","focus$2","focusConfig","ignore","onFocus","isFocused","FocusApis","exhibit$4","tabindex","events$c","stopMousedown","ActiveFocus","FocusSchema","Focusing","SetupBehaviourCellState","initialState","updateAriaState","toggleConfig","toggleState","ariaInfo","aria","updateClass","toggleClass","toggle$2","set$1","isOn","ToggleApis","toggle","exhibit$3","events$b","load","toggleOnExecute","ActiveToggle","updatePressed","syncWithExpanded","updateExpanded","updateSelected","updateChecked","ToggleSchema","pressed","checked","expanded","Toggling","pointerEvents","onClick","events$a","optAction","executeHandler","hoverEvent","focusEvent","onHover","onFocus$1","hover","focus$1","builder$2","toggling","hasSubmenu","itemBehaviours","tConfig","ignoreFocus","schema$p","builder$1","schema$o","owner$2","parts$h","builder","focusWidget","widget","onHorizontalArrow","autofocus","setSource","_widget","widgetBehaviours","schema$n","itemSchema$2","separator","configureGrid","movementInfo","markers","configureMatrix","rowSelector","configureMenu","parts$g","itemInfo","unit","fakeFocus","schema$m","grid","make$7","_spec","_externals","menuBehaviours","selectedItem","role","Menu","transpose$1","trace","byItem","byMenu","triggerItem","triggerMenu","generate$2","menus","expansions","menuItems","menuPaths","_triggerItem","init$c","primary","directory","isClear","setMenuBuilt","menuName","setContents","sPrimary","sMenus","sExpansions","sPaths","getTriggeringItem","menuValue","getTriggerData","getItemByValue","getPreparedMenu","triggeringItemValue","triggeredItem","triggeredMenu","triggeringItem","triggeringPath","getTriggeringPath","itemValue","extraPath","lookupItem","revPath","triggers","menuIndex","expand","collapse","refresh","lookupMenu","extractPreparedMenu","otherMenus","menuValues","getPrimary","getMenus","prep","LayeredState","make$6","_rawUiSpec","submenuParentItems","buildMenus","primaryName","makeSketch","nbMenu","layeredState","setup","componentMap","toDirectory","getItemValue","_container","_menuName","setActiveMenu","mv","closeOthers","others","backgroundMenu","stayInDom","getSubmenuParents","parentItems","itemComp","updateAriaExpansions","updateMenuPath","latestMenuName","menuPrep","activeMenu","ExpandHighlightDecision","buildIfRequired","expandRight","HighlightSubmenu","activeMenuPrep","onOpenSubmenu","collapseLeft","onCollapseMenu","updateView","keyOnItem","getSource","onExecute","onOpenMenu","highlightImmediately","navigateOnHover","HighlightParent","getActiveItem","collapseMenuApi","currentItem","highlightPrimary","extractMenuFromContainer","repositionMenus","maybeActivePrimary","allMenus","preparedMenus","primaryMenu","onRepositionMenu","collapseMenu","tmenuBehaviours","_keyInfo","selectedMenu","collapseItem$1","tieredData","singleData","collapseItem","tieredMenu","tmenu","makeMenu","menuSandbox","menuSpec","lazySink","isFirstTierSubmenu","triggeringPaths","getSubmenuLayouts","submenuTriggers","st","submenuLayouts","factory$m","isPartOfRelated","related","getRelated","thing","showAt","showWithin","showWithinBounds","showMenuAt","showMenuWithinBounds","hide","getContent","inlineBehaviours","onShow","onHide","fireDismissalEventInstead","fireRepositionEventInstead","InlineView","westEdgeX","middleX","eastEdgeX","northY","southY","centreY","lookupPreserveLayout","preserve","lookupFlippedLayout","flip$2","global$f","factory$l","lookupAttr","getModAttributes","roleAttrs","buttonBehaviours","Button","record","anyInSystem","asSpec","global$e","rtlTransform","defaultIconName","defaultIcon","icons","getIconName","lcName","rtlName","lookupIcon","get$1","iconProvider","fallbackIcon","needsRtlTransform","iconName","addFocusableBehaviour","svg","renderIcon$2","rtlIconClasses","iconHtml","render$3","renderFirst","iconNames","notificationIconMap","warning","factory$k","memBannerText","translationProvider","renderPercentBar","percent","renderPercentText","memBannerProgress","progress","updateProgress","updateText","text$1","banner","iconChoices","icon","level","memButton","onAction","notificationIconSpec","notificationBodySpec","closeButton","Notification","NotificationManagerImpl","editor","extras","uiMothership","sharedBackstage","backstage","shared","getLayoutDirection","notifications","notification","moveRel","getEl","settings","closeCallback","hideCloseButton","timeout","notificationWrapper","progressBar","providers","getSink","header","isPositionedAtTop","contentArea","getContentAreaContainer","win$1","moveTo","notificationSpec","anchorOverrides","layoutDirection_1","nodeAnchor","anchors","nuText","getArgs","rate","cancel","throttle","global$d","isBoundary","isBlock","getContentEditable","repeatLeft","rootNode","backwards","autocompleteSelector","create$4","getNode","getDoc","extractContents","insertNode","elm","normalize","setCursorLocation","isValidTextRange","getText","isWhitespace","chr","stripTriggerChar","triggerCh","findChar","char","charAt","findStart","initRange","minChars","findTriggerChIndex","getParent","getRoot","cloneRange","triggerCharIndex","lastIndexOf","triggerChar","getContext","createRng","selectNode","setup$e","onKeypress","redirectKeyToItem","getItem","getView","isActive","cancelIfNecessary","isMenuOpen","stopImmediatePropagation","isProcessingAction","AutocompleterEditorEvents","global$c","isText","isElement$1","toLast","toLeaf","isPreviousCharContent","isStartOfWord","getTriggerContext","database","triggerChars","lookup$2","getDatabase","getRng","context","lookupWithContext","fetchOptions","startText","autocompleters","lookupByChar","autocompleter","lookupData","ac","fetchResult","fetch","maxResults","then","matchText","columns","highlightOn","separatorMenuItemSchema","createSeparatorMenuItem","autocompleterItemSchema","autocompleterSchema","createSeparatorItem","createAutocompleterItem","createAutocompleter","baseToolbarButtonFields","toolbarButtonSchema","createToolbarButton","baseToolbarToggleButtonFields","toggleButtonSchema","createToggleButton","contextBarFields","contextButtonFields","contextToggleButtonFields","launchButtonFields","launchToggleButtonFields","toggleOrNormal","contextformbutton","contextformtogglebutton","contextFormSchema","createContextForm","contextToolbarSchema","createContextToolbar","stringArray","register$b","popups","ui","registry","getAll","popup","datasetValues","dv","ItemResponse","ItemResponse$1","navClass","selectableClass","colorClass","presetClasses","normal","color","tickedClass","groupHeadingClass","iconClass","textClass","accessoryClass","caretClass","checkmarkClass","activeClass","containerClass","containerColumnClass","containerRowClass","containerAlignRightClass","containerAlignLeftClass","containerValignTopClass","containerValignMiddleClass","containerValignBottomClass","classForPreset","presets","forMenu","hasIcons","menuClasses","dom$1","chunk","rowDom","chunks","forSwatch","forToolbar","preprocessCollection","isSeparator","allSplits","currentSplit","forCollection","initItems","_hasIcons","_item","forHorizontalCollection","menuHasIcons","handleError","createHorizontalPartialMenuWithAlloyItems","_columns","_presets","structure","createPartialMenuWithAlloyItems","cardImageFields","cardImageSchema","cardTextFields","cardTextSchema","itemSchema$1","cardimage","cardtext","cardcontainer","cardContainerSchema","commonMenuItemFields","cardMenuItemSchema","createCardMenuItem","choiceMenuItemSchema","createChoiceMenuItem","baseFields","insertTableFields","colorSwatchFields","fancyMenuItemSchema","inserttable","colorswatch","createFancyMenuItem","menuItemSchema","createMenuItem","nestedMenuItemSchema","createNestedMenuItem","toggleMenuItemSchema","createToggleMenuItem","detectSize","margin","selectorClass","descendants$1","columnLength","thisTop","cTop","abs","ceil","namedEvents","unnamedEvents","SimpleBehaviours","ExclusivityChannel","ShowTooltipEvent","HideTooltipEvent","hideAllExclusive","_tConfig","_tState","setComponents","tState","specs","getTooltip","tooltip","TooltippingApis","events$9","tooltipConfig","clearTooltip","clearTimer","show","isShowing","tooltipDom","tooltipComponents","setTooltip","resetTimer","ActiveTooltipping","TooltippingSchema","init$b","TooltippingState","Tooltipping","escape","global$b","global$a","getSkinUrl","skin","getParam","skinUrl","skinName","documentBaseURI","baseURL","isReadOnly","isSkinDisabled","getHeightSetting","getElement","getWidthSetting","DOM","getStyle","getMinWidthSetting","getMinHeightSetting","getMaxWidthSetting","getMaxHeightSetting","getUserStyleFormats","isMergeStyleFormats","getLineHeightFormats","getContentLanguages","getRemovedMenuItems","isMenubarEnabled","isToolbarEnabled","toolbar","isToolbarTrue","isToolbarString","isToolbarObjectArray","isMultipleToolbars","getMultipleToolbarsSetting","toolbars","toolbarArray","ToolbarMode","getToolbarMode","ToolbarLocation","getToolbarGroups","getToolbarLocation","auto","isToolbarLocationBottom","fixedContainerSelector","fixedToolbarContainerTarget","isToolbarPersist","fixedContainerTarget","inline","useFixedContainer","getUiContainer","fixedContainer","isDistractionFree","isStickyToolbar","getStickyToolbarOffset","isDraggableModal$1","getMenubar","getToolbar","getFilePickerCallback","getFilePickerTypes","getFileBrowserCallbackTypes","noTypeaheadUrls","getAnchorTop","getAnchorBottom","getFilePickerValidatorHandler","ReadOnlyChannel","ReadOnlyDataSchema","broadcastReadonly","uiComponents","readonly","outerContainer","mothership","setupReadonlyModeSwitch","setMode","receivingConfig","button","splitButton","toolbarButton","DisablingConfigs","runWithApi","getApi","onControlAttached","editorOffCell","onDestroy","onSetup","onControlDetached","_a$1","onMenuItemExecute","itemResponse","triggersSubmenu","CLOSE_ON_EXECUTE","menuItemEventOrder","componentRenderPipeline","renderCommonItem","providersbackstage","optComponents","buildData","global$9","convertText","mac","alt","ctrl","shift","access","other","shortcut","updated","segment","renderIcon$1","renderText","renderHtml","renderStyledText","renderShortcut","renderCheckmark","renderSubmenuCaret","renderDownwardsCaret","renderContainer","directionClass","alignClass","align","getValignClass","valign","renderImage","src","renderColorStructure","providerBackstage","colorPickerCommand","removeColorCommand","itemText","ariaLabel","iconSvg","iconContent","getDom","common","title","baseDom","renderItemDomStructure","domTitle","renderNormalItemStructure","providersBackstage","renderIcons","iconSpec","renderIcon","renderEmptyIcon","leftIcon","checkmark","checkMark","textRender","htmlContent","menuItem","shortcutContent","caret","renderItemStructure","tooltipBehaviour","tooltipWorker","_tooltip","encodeText","encode","replaceText","translated","encoded","escapedMatchRegex","RegExp","renderAutocompleteItem","useText","onItemValueHandler","_api","render$2","shouldHighlight","cardText","renderCardMenuItem","setDisabled","renderChoiceItem","isSelected","setActive","parts$f","hexColour","shorthandRegex","longformRegex","isHexString","hex","normalizeHex","toUpperCase","fromString$1","getLongForm","hexString","m","extractValues","longForm","splitForm","exec","toHex","fromRgba","rgbaColour","red","green","blue","round$1","rgbRegex","rgbaRegex","alpha","isRgbaComponent","fromHsv","hsv","hue","saturation","brightness","side","chroma","fromHex","fromStringValues","fromString","rgbaString","rgbMatch","rgbaMatch","rgba","fireSkinLoaded$1","fire","fireSkinLoadError$1","fireResizeEditor","fireResizeContent","fireScrollContent","fireTextColorChange","hsvColour","fromRgb","minRGB","maxRGB","hexToHsv","hsvToHex","anyToHex","canvas","canvasContext","clearRect","fillStyle","fillRect","getImageData","global$8","storageName","ColorCache","storageString","localstorage","prune","diff","cache","unshift","pop","setItem","idx","splice","choiceItem","defaultColors","colorCache","mapColors","colorMap","colors","getColorCols$2","defaultCols","hasCustomColors$1","getColorMap","getColors$2","unmapped","getCurrentColors","addColor","fallbackColor","getCurrentColor","format","getParents","applyFormat","undoManager","transact","formatter","nodeChanged","removeFormat","registerCommands","addCommand","calcCols","sqrt","getColorCols$1","getAdditionalColors","hasCustom","applyColor","onChoice","dialog","colorPickerDialog","colorOpt","execCommand","getColors$1","getFetch$1","callback","setIconColor","splitButtonApi","newColor","setIconFill","registerTextColorButton","lastColor","addSplitButton","select","optCurrentRgb","currentRgb","currentHex","_splitButtonApi","onItemAction","registerTextColorMenuItem","addNestedMenuItem","getSubmenuItems","fancytype","isValid","onSubmit","getData","colorpicker","windowManager","alert","details","initialData","buttons","onCancel","register$a","lastForeColor","lastBackColor","createPartialChoiceMenu","presetItemTypes","alloyItems","createChoiceItems","itemPresets","deriveMenuMovement","menuMarkers","rowClass","deriveCollectionMovement","renderColorSwatchItem","getColorItems","colorinput","getColorCols","widgetSpec","useCustomColors","initData","allowCustomColors","hasCustomColors","getColors","cellOverEvent","cellExecuteEvent","makeCell","col","labelId","emitCellOver","se","makeCells","cells","selectCells","selectedRow","selectedColumn","makeComponents","cellRow","makeLabelText","renderInsertTableMenuItem","sizeLabelId","emptyLabelText","memLabel","fancyMenuItems","renderFancyMenuItem","render","renderNestedItem","downwardsCaret","renderNormalItem","renderSeparatorItem","renderToggleMenuItem","autocomplete","separator$3","nested","toggle$1","fancy","card","FocusMode","createMenuItemFromBridge","isHorizontalMenu","parseForHorizontalMenu","menuitem","createAutocompleteItems","createPartialMenu","itemHasIcon","createItem","createPartial","createTieredDataFrom","partialMenu","createMenuFrom","focusMode","ContentFocus","register$9","activeAutocompleter","processingAction","hideIfNecessary","lastElement","getAutocompleters","getCombinedItems","choices","itemMeta","nr","autocompleterApi","reload","BUBBLE_TO_SANDBOX","commenceIfNecessary","matchLength","display","ld","doLookup","newContext","lookupInfo","combinedItems","autocompleterUiApi","hasPlugin","Autocompleter","register","DelayedFunction","fun","ref","schedule","SIGNIFICANT_MOVE","LONGPRESS_DELAY","getTouch","touches","isFarEnough","touch","distX","distY","monitor","startData","longpressFired","longpress$1","handleTouchstart","handleTouchmove","handleTouchend","isSame","fireIfReady","isDangerous","keyEv","bindFocus","bindBlur","setup$d","rawSettings","stopBackspace","tapEvent","simpleEvents","tapStopped","stopped","pasteTimeout","onPaste","onKeydown","onFocusIn","focusoutTimeout","onFocusOut","derive","rawTarget","fromSource","isStopped","isCut","fromExternal","adt$1","resume","complete","doTriggerHandler","eventType","handlerInfo","eventHandler","doTriggerOnUntilStopped","triggerHandler","listeners","_logger","listener","triggerUntilStopped","triggerOnUntilStopped","broadcastHandler","EventRegistry","registerId","findHandler","filterByType","isAboveRoot","unregisterId","handlersById","_eventName","Registry","readOrTag","failOnDuplicate","tagId","conflict","unregister","getById","factory$j","domWithoutAttributes","containerBehaviours","Container","takeover","domEvents","_alloyId","broadcast$1","broadcastData","receivers","receiver","renderBar","interpreter","schema$l","parts$e","excludeFactory","factory$i","fieldBehaviours","descriptor","descriptorId","getField","getLabel","FormField","exhibit$2","tabConfig","tabAttr","ActiveTabstopping","TabstopSchema","Tabstopping","global$7","renderFormFieldWith","pLabel","pField","extraClasses","extraBehaviours","renderFormFieldSpecWith","renderFormField","renderFormFieldDomWith","renderFormFieldDom","renderLabel$2","formChangeEvent","formCloseEvent","formCancelEvent","formActionEvent","formSubmitEvent","formBlockEvent","formUnblockEvent","formTabChangeEvent","formResizeEvent","renderCollection","runOnItem","htmlLines","mapItemName","disabledClass","encodeAllRaw","tgt","collectionEvents","currentActive","iterCollectionItems","applyAttributes","childElm","schema$k","focusBehaviours","selectOnFocus","setSelectionRange","inputBehaviours","inputAttributes","inputStyles","inputClasses","factory$h","Input","exports$1","module","exports","define","require","global","amd","globalThis","EphoxContactWrapper","commonjsGlobal","promise","setTimeoutFunc","thisArg","Promise","TypeError","_handled","_value","_deferreds","doResolve","deferred","_immediateFn","cb","onFulfilled","onRejected","reject","finale","_unhandledRejectionFn","Handler","done","reason","ex","prom","remaining","race","setImmediate","_setImmediateFn","_setUnhandledRejectionFn","promisePolyfill","Global","promisePolyfill_1","boltExport","Promise$1","nu$3","baseFn","callbacks","nCallback","isReady","cbs","pure$1","LazyValue","pure","errorReporter","make$5","aFutureB","toPromise","anonBind","futureB","toLazy","toCached","nu$2","Future","ariaElements","isAriaElement","markValid","invalidConfig","invalidClass","notify","notifyInfo","getContainer","validHtml","onValid","markInvalid","invalidState","onInvalid","_invalidState","validatorInfo","validate","onValidate","valid","isInvalid","InvalidateApis","events$8","onEvent","validateOnLoad","ActiveInvalidate","InvalidateSchema","Invalidating","validation","getCoupled","coupleConfig","coupleState","getOrCreate","CouplingApis","CouplingSchema","init$a","coupled","CouplingState","Coupling","partType$1","HighlightOnOpen","getAnchor","getHotspot","getAnchorOverrides","mapFetch","fetcher","openF","highlightOnOpen","futureData","getLazySink","tdata","HighlightFirst","onOpenSync","processed","_onOpenSync","_highlightOnOpen","togglePopup","showing","matchWidth","useMinWidth","buttonWidth","sinkDetail","internalSink","lazySinkFn","doRepositionMenus","makeSandbox$1","ariaOwner","sandboxClasses","sandboxBehaviours","sandboxFields","schema$j","parts$d","factory$g","switchToMenu","HighlightNone","triggerExecute","dropdownBehaviours","Dropdown","exhibit$1","unselectable","events$7","ActiveUnselecting","Unselecting","renderPanelButton","colorInputChangeEvent","colorSwatchChangeEvent","colorPickerCancelEvent","renderColorInput","colorInputBackstage","inputValue","span","emitSwatchChange","colorBit","memColorButton","colorPicker","valueOpt","colorButton","_field","labelPart","edgePart","model","edgeActions","det","mouseIsDown","tlEdgePart","tedgePart","trEdgePart","redgePart","brEdgePart","bedgePart","blEdgePart","ledgePart","thumbPart","spectrumPart","modelDetail","getValueFromEvent","spectrum","SliderParts","_sliderChangeEvent","sliderChangeEvent","isTouchEvent$2","evt","getEventSource","touchEvent","mouseEvent","minX","minY","min1X","min1Y","max1X","max1Y","xRange","yRange","halfX","halfY","step","stepSize","snap","snapToGrid","snapStart","rounded","hasEdge","edgeName","hasLEdge","hasREdge","hasTEdge","hasBEdge","currentValue","xValue","yValue","xyValue","fireSliderChange$3","setToTLEdgeXY","setToTEdge","setToTEdgeXY","setToTREdgeXY","setToREdge","setToREdgeXY","setToBREdgeXY","setToBEdge","setToBEdgeXY","setToBLEdgeXY","setToLEdge","setToLEdgeXY","reduceBy","increaseBy","capValue","snapValueOf","initValue","extraValue","remainder","adjustment","rawSteps","maxSteps","numSteps","findOffsetOf","findValueOf","hasMinEdge","hasMaxEdge","minBound","maxBound","screenRange","capMin","capMax","findOffsetOfValue$2","maxOffset","centerMinEdge","centerMaxEdge","getBoundsProperty","getMinXBounds","getMaxXBounds","getMinYBounds","getMaxYBounds","getXScreenRange","getYScreenRange","getCenterOffsetOf","componentMinEdge","componentMaxEdge","spectrumMinEdge","getXCenterOffSetOf","componentBounds","spectrumBounds","getYCenterOffSetOf","fireSliderChange$2","sliderValue$2","findValueOfOffset$1","setValueFrom$2","sliderVal","setToMin$2","setToMax$2","moveBy$2","handleMovement$2","getValueFromEvent$2","findOffsetOfValue$1","minEdge","maxEdge","minOffset","findPositionOfValue$1","slider","setPositionFromValue$2","thumb","edges","getSpectrum","getLeftEdge","getRightEdge","thumbRadius","onLeft$2","onRight$2","onUp$2","onDown$2","edgeActions$2","HorizontalModel","setToMin","setToMax","findValueOfOffset","findPositionOfValue","setPositionFromValue","fireSliderChange$1","sliderValue$1","setValueFrom$1","setToMin$1","setToMax$1","moveBy$1","handleMovement$1","getValueFromEvent$1","findOffsetOfValue","setPositionFromValue$1","getTopEdge","getBottomEdge","onLeft$1","onRight$1","onUp$1","onDown$1","edgeActions$1","VerticalModel","fireSliderChange","sliderValue","moveBy","isVerticalMovement","handleMovement","mX","mY","xPos","yPos","thumbXRadius","thumbYRadius","TwoDModel","SliderSchema","sketch$2","getThumb","changeValue","onChange","resetToMin","resetToMax","fireOnChoose","onChoose","wasDown","onDragStart","onDragEnd","sliderBehaviours","getInitialValue","onInit","Slider","fieldsUpdate","sliderUpdate","paletteUpdate","sliderFactory","getClass","_thumb","owner$1","schema$i","getPartName$1","sketch$1","fSpec","fieldParts","make$4","formBehaviours","form","resPs","resPThunk","pName","Form","validInput","invalidInput","validatingInput","translatePrefix","rgbFormFactory","onValidHexx","onInvalidHexx","invalidation","renderTextField","description","helptext","comps","concats","copyRgbToHex","hexField","copyRgbToForm","rgb","memPreview","updatePreview","preview","copyHexToRgb","setValueRgb","getValueRgb","onInvalidInput","onValidHex","onValidRgb","isHexInputEvent","onValidInput","formPartStrings","redStrings","greenStrings","blueStrings","hexStrings","updateHex","rgbFormSketcher","paletteFactory","_translate","setColour","ctx","grdWhite","createLinearGradient","addColorStop","grdBlack","setPaletteHue","setPaletteThumb","_detail","_slider","saturationBrightnessPaletteSketcher","setHue","_apis","setThumb","makeFactory","rgbForm","onInvalidHex","sbPalette","hueSliderToDegrees","hueDegreesToSlider","paletteRgba","paletteHue","memSlider","memPalette","memRgb","updatePalette","_hex","palette","updateFields","updateSlider","updatePaletteThumb","updateState","runUpdates","updates","onPaletteUpdate","oldHue","newHsv","newHex","onSliderUpdate","oldRgb","oldHsv","onFieldsUpdate","colourPickerSketcher","self$1","memento$1","mem","childAt","ComposingConfigs","memento","english","getEnglishText","translate$1","renderColorPicker","colourPickerFactory","memPicker","picker","optRgbForm","optHex","formValues","pattern","global$6","isOldCustomEditor","renderCustomEditor","editorApi","memReplaced","ta","scriptId","scriptUrl","ea","cvalue","ed","global$5","processors","rawProcessors","rawValue","postprocess","withComp","optInitialValue","getter","setter","withElement","domValue","domHtml","RepresentingConfigs","defaultImageFileTypes","filterByExtension","files","allowedImageFileTypes","explode","getSetting","isFileInAllowedTypes","file","renderDropZone","actions","onDrop","transferEvent","handleFiles","dataTransfer","onSelect","memInput","accept","renderField","inputComp","renderGrid","beforeObject","afterObject","craftWithClasses","outline","craft","triggerTab","isPseudoStop","platformNeedsSandboxing","getDynamicSource","isSandbox","cachedValue","_frameComponent","frameComponent","contentWindow","renderIFrame","sandboxed","sourcing","create$3","resize$3","tCanvas","get2dContext","drawImage","getWidth$1","image","naturalWidth","getHeight$1","naturalHeight","blobToImage","blobUrl","URL","createObjectURL","Image","removeListeners","loaded","dataUriToBlobSync","uri","mimetype","base64","sliceSize","byteCharacters","atob","bytesLength","slicesCount","byteArrays","sliceIndex","begin","end","bytes","charCodeAt","Uint8Array","Blob","dataUriToBlob","canvasToBlob","quality","HTMLCanvasElement","toBlob","toDataURL","canvasToDataURL","blobToCanvas","revokeImageUrl","blobToDataUri","reader","FileReader","onloadend","readAsDataURL","revokeObjectURL","create$2","getCanvas","initialType","getType","toBase64","toAdjustedBlob","toAdjustedDataURL","toAdjustedBase64","dataurl","toCanvas","fromBlob","fromCanvas","blobToImageResult","clamp","parsedValue","identity","DELTA_INDEX","multiply","matrix1","matrix2","out","adjustContrast","adjustBrightness","adjustColors","adjustR","adjustG","adjustB","colorFilter","ir","applyColorFilter","applyMatrix","pixelsData","m0","m1","m2","m3","m4","m5","m6","m7","m8","m9","m10","m11","m12","m13","m14","m15","m16","m17","m18","m19","pixels","putImageData","convoluteFilter","applyConvoluteFilter","pIn","pOut","aMatrix","halfSide","drgba","cy","cx","scx","scy","innerOffset","wt","pixelsIn","pixelsOut","functionColorFilter","colorFn","filterImpl","applyLookup","complexAdjustableColorFilter","matrixAdjustFn","adjust","basicColorFilter","basicConvolutionFilter","kernel","invert$1","brightness$1","contrast$1","colorize$1","sharpen$1","gamma$1","pow","scale","dW","dH","sW","sH","wRatio","hRatio","scaleCapped","scaled","_scale","ceilWithPrecision","precision","mul","upper","rotate$1","angle","applyRotate","degrees","rad","PI","sin","cos","newWidth","newHeight","rotate","flip$1","axis","applyFlip","crop$1","applyCrop","resize$2","newCanvas","invert","sharpen","gamma","colorize","contrast","flip","crop","resize$1","iconsProvider","renderIconFromPack","renderReplacableIconFromPack","renderLabel$1","internalToolbarButtonExecute","onToolbarButtonExecute","itemApi","buttonApi","toolbarButtonEventOrder","updateMenuText","updateMenuIcon","renderCommonDropdown","optMemDisplayText","optMemDisplayIcon","onLeftOrRightInMenu","dropdown","tooltipAttributes","translatedTooltip","memDropdown","displayText","displayIcon","isMenuItemReference","isSeparator$1","isExpandingMenuItem","separator$2","unwrapReferences","realItems","getFromExpandingItem","submenuItems","newMenus","newExpansions","getFromItem","generateValueIfRequired","itemWithValue","newData","mainMenu","submenus","getMenuButtonApi","renderMenuButton","_comp","getFetch","getButton","getMenuItemAction","storage","orig","getMenuItemSetup","renderCommonSpec","actionOpt","domFinal","renderIconButtonSpec","renderIconButton","iconButtonSpec","renderButtonSpec","translatedText","borderless","renderButton","buttonSpec","getAction","buttonType","isMenuFooterButtonSpec","isNormalFooterButtonSpec","renderFooterButton","memButton_1","menuButtonSpec","fixedSpec","renderDialogButton","schema$h","coupledPart","selfName","otherName","lock","onLockedChange","parts$c","locked","lockClass","factory$f","coupledFieldBehaviours","field1Name","field1","field2Name","field2","getField1","getField2","getLock","FormCoupledInputs","formatSize","unitDec","maxDecimal","numText","parseSize","sizeText","numPattern","convertUnit","inInch","noSizeConversion","_input","ratioSizeConversion","makeRatioConverter","currentFieldText","otherFieldText","cValue","oValue","cSize","oSize","renderSizeInput","converter","ratioEvent","makeIcon","pLock","formGroup","getFieldPart","isField1","widthField","heightField","_lock","newSize","optCurrent","optOther","value1","value2","undo","redo","zoom","back","swap","transform$1","tempTransform","transformApply","internal","saveState","renderEditPanel","imagePanel","createButton","createIconButton","disableAllComponents","eventcomp","enableAllComponents","panelDom","noop$1","emit$1","emitDisable","emitEnable","emitTransform","emitTempTransform","getBackSwap","memContainer","ButtonPanel","emitTransformApply","createBackButton","createSpacer","createApplyButton","makeCropTransform","getRect","cropPanelComponents","hideCrop","CropPanel","memSize","constrain","makeResizeTransform","resizePanelComponents","sizeInput","ResizePanel","makeValueTransform","horizontalFlip","verticalFlip","counterclockwiseRotate","clockwiseRotate","flipRotateOnAction","operation","flipRotateComponents","FlipRotatePanel","makeSlider","makeVariableSlider","valTransform","variableFilterPanelComponents","createVariableFilterPanel","filterPanelComponents","FilterPanel","BrightnessPanel","ContrastPanel","GammaPanel","makeColorTransform","makeColorSlider","redOpt","memRed","blueOpt","memBlue","greenOpt","memGreen","colorizePanelComponents","ColorizePanel","getTransformPanelEvent","panel","cropPanelUpdate","_anyInSystem","showCrop","resizePanelUpdate","measurements","getMeasurements","sharpenTransform","invertTransform","buttonPanelComponents","getApplyButton","global$4","global$3","global$2","getDocumentSize","scrollWidth","scrollHeight","isTouchEvent$1","changedTouches","updateWithTouchData","DragHelper","_c","eventOverlay","handleEvents","overlayEvents","sugarDoc","downButton","startX","startY","handleElement","getElementById","docSize","screenX","screenY","cursor","drag","deltaX","deltaY","create$1","currentRect","viewPortRect","clampRect","containerElm","dragHelpers","handles","xMul","yMul","deltaW","deltaH","blockers","getAbsoluteRect","outerRect","relativeRect","getRelativeRect","innerRect","getInnerRect","moveRect","startRect","instance","setInnerRect","createDragHelper","cropContainer","blocker","blockerElm","cropBlocker","handleElm","cropHandle","repaint","handleFocus","handleKeydown","activeHandle","moveAndBlock","keyCode","SPACEBAR","toggleVisibility","elems","updateElementRect","newRect","setRect","setViewPortRect","setClampRect","helper","CropRect","loadImage","renderImagePanel","initialUrl","memBg","zoomState","cropRect","rectState","viewRectState","repaintImg","img","panelW","panelH","bg","cRect","zoomFit","updateSrc","url","aImg","lastViewRect","viewRect","inflate","currentZoom","newZoom","setButtonEnabled","enabled","renderSideBar","updateButtonUndoStates","undoEnabled","redoEnabled","memUndo","memRedo","UndoStack","removed","canUndo","canRedo","makeState","blobState","tempState","undoStack","getBlobState","setBlobState","getTempState","updateTempState","newTempState","createState","destroyTempState","destroyState","destroyStates","states","addBlobState","addTempState","applyTempState","postApply","temp","currentState","getHistoryStates","renderImageTools","historyStates","sideBar","disableUndoRedo","_oImg","unblock","imageResultToBlob","block","editPanel","applyButton","blobManipulate","catch","manipulate","tempManipulate","manipulateApply","currentUrl","renderLabel","backstageShared","isSingleListItem","dataAttribute","fetchItems","dropdownComp","selectedValue","findItemByValue","renderListBox","initialItem","sketchSpec","listBoxWrap","renderPanel","factory$e","initialValues","selectClasses","selectAttributes","selectBehaviours","found","HtmlSelect","renderSelectBox","translatedOptions","chevron","selectWrap","renderTable","renderTh","renderHeader","renderTd","renderTr","renderRows","baseInputBehaviours","multiline","validatingBehaviours","vl","inputMode","inputmode","classname","flex","extraClasses2","maximized","renderInput","renderTextarea","events$6","streamConfig","streamState","streams","stream","cancelEvent","ActiveStreaming","_config","setTimer","init$9","StreamingState","setup$c","streamInfo","sInfo","throttler","onStream","stopEvent","StreamingSchema","Streaming","setValueFromItem","itemData","setCursorAtEnd","setSelectionOn","setSelectionToEnd","attemptSelectOver","selectsOver","inputDisplay_1","getDisplayText","itemDisplay","itemExecute","make$3","navigateList","highlighter","previewing","focusBehaviours$1","responseTime","focusInInput","previousValue_1","pv","sandboxIsOpen","openClass","onItemExecute","dismissOnBlur","typeahead","typeaheadBehaviours","schema$g","parts$b","populateFromBrowse","Typeahead","wrap","bindFuture","resA","bindResult","mapResult","foldResult","whenError","whenValue","withTimeout","errorThunk","timedOut","nu$1","worker","fromFuture","future","fromPromise","completer","FutureResult","separator$1","toMenuItem","staticMenuItem","toMenuItems","targets","filterLinkTargets","filteredTargets","headerTargets","linkInfo","anchorTargets","anchorTargetTop","anchorTop","anchorTargetBottom","anchorBottom","historyTargets","history","joinMenuLists","bothEmpty","filterByQuery","term","lowerCaseTerm","getItems","fileType","urlBackstage","urlInputValue","getLinkInformation","getHistory","errorId","renderUrlInput","updateHistory","urlEntry","addToHistory","filetype","memUrlBox","_newValue","getValidationHandler","memInvalidIcon","invalidComp","_menu","_entry","errId","memStatus","optUrlPicker","getUrlPicker","browseUrlEvent","memUrlPickerButton","controlHWrapper","openUrlPicker","componentData","urlData","fieldname","chosenData","renderAlertBanner","iconTooltip","renderCheckbox","repBehaviour","toggleCheckboxHandler","className","memIcons","renderHtmlPanel","make$2","makeIframe","iframeSpec","factories","bar","collection","alertbanner","textarea","iframe","checkbox","dropzone","listbox","selectbox","sizeinput","urlinput","customeditor","htmlpanel","imagetools","table","noFormParts","interpretInForm","oldBackstage","newBackstage","interpretParts","interpretWithoutForm","bubbleAlignments$2","valignCentre","alignCentre","alignLeft","alignRight","getInlineDialogAnchor","contentAreaElement","lazyAnchorbar","lazyUseEditableAreaAnchor","bubbleSize","editableAreaAnchor","standardAnchor","getBannerAnchor","getCursorAnchor","bodyElement","getNodeAnchor$1","getAnchors","isToolbarTop","useFixedToolbarContainer","inlineDialog","ColorInputBackstage","isDraggableModal","DialogBackstage","HeaderBackstage","getDockingMode","setDockingMode","defaultStyleFormats","isNestedFormat","isBlockFormat","isInlineFormat","isSelectorFormat","mapFormats","userFormats","fmt","customFormats","formats","formatName","formatNameWithPrefix","registerCustomFormats","registerFormats","getStyleFormats","registeredUserFormats","processBasic","isSelectedFor","getPreviewFor","formatterSpec","getStylePreview","register$8","enrichSupported","enrichMenu","submenuSpec","enrichCustom","customSpec","newItem","doEnrich","newItems","getStyleItems","init$8","parseStyle","getCssText","settingsFormats","settingsFlattenedFormats","eventsFormats","eventsFlattenedFormats","replaceSettings","_e","enriched","modifications","fromSettings","fromEvents","getFlattenedKeys","isElement","hasContentEditableState","contentEditable","isContentEditableTrue","isContentEditableFalse","isChildOfContentEditableTrue","getElementText","innerText","getOrGenerateId","isAnchor","isValidAnchor","isEditable","isHeader","isValidHeader","getLevel","headerTarget","headerId","anchorTarget","anchorId","anchorText","getHeaderTargets","elms","getAnchorTargets","getTargetElements","hasTitle","LinkTargets","STORAGE_KEY","HISTORY_LENGTH","isHttpUrl","isArrayOfUrl","isRecordOfUrlArray","getAllHistory","unparsedHistory","SyntaxError","setAllHistory","itemsWithoutUrl","isTruthy","makeMap","getPicker","getPickerTypes","optFileTypes","optLegacyTypes","optTypes","_picker","types","getPickerSetting","pickerTypes","entry","getTextSetting","UrlInputBackstage","init$7","contextMenuState","styleselect","isContextMenuOpen","setContextMenuState","setup$b","ship","channel","fireDismissPopups","onTouchstart","onTouchmove","onTouchend","onMousedown","onMouseup","onContentClick","onContentMouseup","onContentMousedown","editorManager","loopEditor","relatedTarget","onWindowScroll","onWindowResize","onEditorResize","onEditorProgress","onDismissPopups","parts$a","partType","schema$f","customListDetail","itemsPart","parts$9","factory$d","_external","setItems","getListContainer","itemComps","numListsRequired","numListsToAdd","itemsToAdd","makeItem","itemsToRemove","builtLists","setupItem","shell","listBehaviours","CustomList","schema$e","enhanceGroups","parts$8","factory$c","setGroups","groups","getGroupContainer","toolbarBehaviours","Toolbar","setup$a","isDocked$2","getBehaviours$1","StaticHeader","isDocked","getBehaviours","getOffsetParent","isFixed","offsetParent$1","getOrigin","morphAdt","static","appear","contextualInfo","transitionClass","fadeOutClass","fadeInClass","disappear","isPartiallyVisible","isTopCompletelyVisible","isBottomCompletelyVisible","isVisibleForModes","getPrior","getInitialPos","storePrior","setInitialPos","revertToOriginal","clearInitialPos","offsetBox_1","_left","_top","_right","_bottom","morphToOriginal","getModes","morphToFixed","winBox","top_1","isTop","getMorph","getMorphToOriginal","morphToStatic","setDocked","onUndocked","morphToCoord","method","onDocked","updateVisibility","morphToDocked","contextual","contextInfo","lazyContext","setVisible","refreshInternal","lazyViewport","morph","resetInternal","refresh$4","isDocked$1","setModes","DockingApis","events$5","dockInfo","dockState","onShown","onHidden","ActiveDocking","DockingSchema","init$6","docked","initialBounds","DockingState","Docking","toolbarHeightChange","visibility","editorStickyOnClass","editorStickyOffClass","scrollFromBehindHeader","containerHeader","viewHeight","innerHeight","scrollPos","markerElement","markerPos","markerHeight","markerTop","markerBottom","editorHeaderPos","editorHeaderHeight","editorHeaderTop","editorHeaderBottom","editorHeaderDockedAtTop","editorHeaderDockedAtBottom","isDockedMode","updateIframeContentFlow","getOccupiedHeight","parentElem","padding","parentWidth","updateSinkVisibility","sinkElem","updateEditorClasses","editorContainer","restoreFocus","headerElem","focusedElem","ownerDoc","activeElm","findFocusedElem","rootElm","setup$9","lazyHeader","getIframeBehaviours","focusedElm","runOnSinkElement","onDockingSwitch","additionalBehaviours","headerHeight","boxHeight","topBound","StickyHeader","sticky","groupToolbarButtonSchema","createGroupToolbarButton","baseMenuButtonFields","MenuButtonSchema","createMenuButton","splitButtonSchema","createSplitButton","factory$b","setMenus","activeButton","hoveredButton","activeComp","hoveredComp","prev","SilverMenubar","getAnimationRoot","slideConfig","getDimensionProperty","dimension","getDimension","disableTransitions","shrinkingClass","growingClass","setShrunk","closedClass","setGrown","doImmediateShrink","slideState","_calculatedSize","setCollapsed","onStartShrink","onShrunk","doStartShrink","calculatedSize","doStartSmartShrink","shrinker","doStartGrow","wasShrinking","beforeSize","fullSize","startPartialGrow","startCompleteGrow","setStartSize","setExpanded","onStartGrow","refresh$3","isExpanded","grow","shrink","immediateShrink","hasGrown","hasShrunk","isCollapsed","isGrowing","_slideState","isShrinking","isTransitioning","toggleGrow","SlidingApis","events$4","onGrown","ActiveSliding","SlidingSchema","init$5","SlidingState","Sliding","schema$d","getPartName","sSpec","slot","make$1","getSlotNames","getSlot","onSlot","def","onSlots","doShowing","_key","doShow","doHide","hideSlot","hideSlots","hideAllSlots","showSlot","slotBehaviours","slotApis","SlotContainer","sidebarSchema","createSidebar","setup$8","sidebars","queryCommandValue","addToggleButton","handleToggle","makePanels","panelConfigs","bridged","sidepanel","optSidePanelSpec","sidePanelSpec","makeSidebar","slotContainer","setSidebar","sidebar","optSlider","toggleSidebar","optSlotContainer","whichSidebar","sidebarOpen","fixSize","autoSize","renderSidebar","getBusySpec","blockerBehaviours","blockSpec","isBlocked","onBlock","blockWith","onUnblock","BlockingApis","BlockingSchema","init$4","BlockingState","Blocking","getAttrs","getBusySpec$1","_root","_behaviours","focusBusyComponent","throbber","toggleEditorTabIndex","tabIndexAttr","dataTabIndexAttr","iframeElement","tabIndex","toggleThrobber","throbberFocus","busyComp","renderThrobber","isFocusEvent","isPasteBinTarget","targetElm","setup$7","lazyThrobber","throbberState","stealFocus","command","setEditorTimeout","generate$1","within","withinWidth","apportion","total","parray","toUnit","fitLast","overflow","overflower","fitAll","tryFit","divide","setGroups$1","storedGroups","bGroups","findFocusedComp","refresh$2","setOverflow","builtGroups","overflowGroup","focusedComp","availableWidth","overflows","schema$c","schema$b","parts$7","expandable","schema$a","parts$6","toggledClass","toolbarSandbox","bounder","makeSandbox","factory$a","FloatingToolbarButton","schema$9","parts$5","factory$9","tgroupBehaviours","itemSelector","ToolbarGroup","buildGroups","refresh$1","memFloatingToolbarButton","overflowGroups","floatingToolbarButton","factory$8","getOverflowBounds","overflowToggledClass","splitToolbarBehaviours","getOverflow","SplitFloatingToolbar","schema$8","parts$4","onClosed","onOpened","toggleToolbar","overf","factory$7","toolbarToggleEvent","doSetGroups","_button","SplitSlidingToolbar","renderToolbarGroupCommon","toolbarGroup","renderToolbarGroup","getToolbarbehaviours","toolbarSpec","modeName","onAttached","initGroups","renderMoreToolbarCommon","cyclicKeying","renderFloatingMoreToolbar","baseSpec","overflowXOffset","moreDrawerData","headerBounds","docElem","docBounds","renderSlidingMoreToolbar","renderToolbar","scrolling","factory$6","getSocket","getHeader","setToolbar","setToolbars","mToolbar","refreshToolbar","toggleToolbarDrawer","isToolbarDrawerToggled","getThrobber","focusToolbar","optToolbar","setMenubar","menubar","focusMenubar","partMenubar","toolbarFactory","sliding","floating","partMultipleToolbar","_mToolbar","tc","_index","partToolbar","renderer","lazyToolbar","lazyMoreButton","partHeader","partSocket","partSidebar","partThrobber","OuterContainer","grps","grp","renderedToolbars","defaultMenubar","defaultMenus","edit","tools","help","removedMenuItems","itemName","removedMenuItem","parseItemsString","identifyMenus","rawMenuData","userDefinedMenus","validMenus","isDefaultMenu","menuData","isNotSeparator","fireSkinLoaded","_skinLoaded","initialized","fireSkinLoadError","loadStylesheet","stylesheetUrl","styleSheetLoader","unload","loadUiSkins","skinUiCss","loadShadowDomUiSkins","isInShadowRoot$1","shadowDomSkinCss","loadSkin","isInline","contentCSS","onSetupFormatToggle","boundCallback","binding","formatChanged","once","onSetupEvent","handleEvent","onActionToggleFormat$1","rawItem","onActionExecCommand","generateSelectItems","_editor","generateItem","response","si","invalid","validateItems","preItems","getCurrentValue","shouldHide","createMenuItems","createSelectButton","getComponent","rawFormats","buildBasicStaticDataset","Delimiter","delimiter","SemiColon","buildBasicSettingsDataset","settingName","alignMenuItems","getSpec$4","getMatchingValue","_format","updateSelectMenuIcon","alignment","canApply","createAlignSelect","alignSelectMenu","defaultFontsFormats","systemStackFonts","splitFonts","fontFamily","fonts","font","isSystemFontStack","matchesSystemStack","getSpec$3","systemFont","getFirstFont","matchOpt","updateSelectMenuText","createFontSelect","fontSelectMenu","defaultFontsizeFormats","legacyFontSizes","keywordFontSizes","factor","toPt","fontSize","toLegacy","getSpec$2","_loop_1","pt","legacy","Space","createFontsizeSelect","fontsizeSelectMenu","findNearest","getStyles","defaultBlocks","getSpec$1","fallbackFormat","detectedFormat","createFormatSelect","formatSelectMenu","getSpec","getFormatItems","flattenedItems","createStyleSelect","styleSelectMenu","events$3","reflectingConfig","reflectingState","renderComponents","newComponents","rawData","ActiveReflecting","reflectState","ReflectingApis","ReflectingSchema","init$3","ReflectingState","Reflecting","schema$7","arrowPart","arrow","buttonPart","btn","splitDropdown","parts$3","factory$5","openMenu","executeOnButton","buttonEvents","ariaDescriptor","splitDropdownBehaviours","SplitDropdown","getButtonApi","getToggleApi","getTooltipAttributes","focusButtonEvent","renderCommonStructure","_d","renderFloatingToolbarButton","identifyButtons","renderCommonToolbarButton","specialisation","toolbarButtonBehaviours","renderToolbarButton","renderToolbarButtonWith","bonusEvents","renderToolbarToggleButton","renderToolbarToggleButtonWith","fetchChoices","renderSplitButton","displayChannel","underlinePath","setIconStroke","buttonComp","defaultToolbar","renderFromBridge","bridgeBuilder","togglebutton","menubutton","splitbutton","grouptoolbarbutton","identify","allowToolbarGroups","TopToBottom","styleSelectButton","fontsizeSelectButton","fontSelectButton","formatButton","alignMenuButton","extractFrom","bespokeButtons","fontsizeselect","fontselect","formatselect","removeUnusedDefaults","filteredItemGroups","subItem","convertStringToolbar","strToolbar","groupsStrings","isToolbarGroupSettingArray","createToolbar","toolbarConfig","lookupButton","toolbarItem","prefixes","toolbarGroups","rawUiConfig","toolbarButtonsConfig","detection","isiOS12","setupEvents$1","initialDocEle","lastWindowDimensions","innerWidth","lastDocumentDimensions","resizeWindow","outer","resizeDocument","docEle","inner","elementLoad","render$1","lastToolbarWidth","eTargetNode","targetNode","uiRoot","socket","limit","unbinder","_ui","addQueryValueHandler","toolbarMode","refreshDrawer","iframeContainer","Iframe","parseToInt","re","numToPx","calcCappedSize","minSize","maxSize","minOverride","maxOverride","getHeight","baseHeight","minHeight","getHeightWithFallback","getWidth","baseWidth","minWidth","getWidthWithFallback","InlineHeader","floatContainer","isSticky","editorMaxWidthOpt","headerBackstage","isSplitToolbar","calcToolbarOffset","tbar","calcMode","toolbar_1","toolbarHeight","targetBounds","roomAtTop","docHeight","roomAtBottom","winBounds","isRoomAtBottomViewport","setupMode","verticalDir","updateChromeWidth","bodyMargin","updateChromePosition","repositionPopups$1","updateChromeUi","resetDocking","floatContainerComp","updateMode","updateUi","currentMode","newMode","addClass","removeClass","getTargetPosAndBounds","setupEvents","toolbarPersist","prevPosAndBounds","resizeContent","prevPos","prevBounds","hasResized","uiContainer","delayedRender","Inline","showContextToolbarEvent","hideContextToolbarEvent","getFormApi","runOnExecute","formApi","renderContextButton","renderContextToggleButton","mementos","asSpecs","findPrimary","compInSystem","buildInitGroups","commands","renderContextForm","toolbarType","ContextForm","isVerticalOverlap","threshold","getRangeRect","leaf$1","getSelectionBounds","scroll_1","bodyPos","getAnchorElementBounds","getHorizontalBounds","contentAreaBox","viewportBounds","getVerticalBounds","isToolbarLocationTop","headerBox","isToolbarBelowContentArea","isToolbarAbove","containerBounds","getContextToolbarBounds","toolbarOrMenubarEnabled","bubbleSize$1","bubbleAlignments$1","inset","isEntireElementSelected","preservePosition","currentPosition","shouldUseInsetLayouts","determineInsetLayout","contextbar","selectionBounds","isSameAnchorElement","isOverlapping","isReposition","yBounds","contextbarHeight","getAnchorSpec$2","mobile","smartInsetLayout","newAnchor","getInsetLayouts","desktopAnchorSpecLayouts","mobileAnchorSpecLayouts","getAnchorLayout","matchTargetWith","ctxs","toolbarApi","contextToolbars","contextForms","filterByPositionForStartNode","doesPositionExist","filterToolbarsByPosition","hasSelectionToolbars","hasNodeToolbars","nodeToolbars","selectionToolbars","filterByPositionForAncestorNode","findPosition_1","basePosition","matchStartNode","nodeCandidates","editorCandidates","nodeMatches","editorMatches","matchAncestor","startNode","scopes","ancestorElem","inNodeScope","lookup$1","rootElem","isOutsideRoot","inEditorScope","categorise","forms","formNavigators","lookupTable","registerForm","contextForm","launch","registerToolbar","contextToolbar","forwardSlideEvent","backSlideEvent","changeSlideEvent","resizingClass","renderContextToolbar","currentWidth","newContents","oldContents","forwardContents","register$7","registryContextToolbars","lastTrigger","lastContextPosition","canLaunchToolbar","isSameLaunchElement","shouldContextToolbarHide","contextToolbarBounds","anchorBounds","hideOrRepositionIfNecessary","contextBarEle","wrapInPopDialog","shortcuts","getScopes","alloySpec","buildToolbar","buildContextToolbarGroups","allButtons","buildContextFormGroups","default","anchorLayout","launchContext","launchContextToolbar","toolbarKey","register$6","alignToolbarButtons","cmd","addButton","unsupportedLength","decimalDigits","signedInteger","exponentPart","dot","unsignedDecimalLiteral","float","isUnit","accepted","check","unitRaw","normalise","registerController","getMenuItems","getOptions","hash","oldApi","unbindWatcher","watcher","setCurrent","addMenuButton","onToolbarSetup","onMenuSetup","lineHeightSpec","languageSpec","settingsOpt","customCode","code","customValue","ele","codeOpt","lang","register$5","register$4","onSetupOutdentState","queryCommandState","registerButtons$2","register$3","onActionToggleFormat","registerFormatButtons","_idx","name_1","registerCommandButtons","registerCommandToggleButtons","registerButtons$1","registerMenuItems$2","addMenuItem","register$2","onSetupUndoRedoState","registerMenuItems$1","registerButtons","register$1","onSetupVisualAidState","hasVisual","registerMenuItems","addToggleMenuItem","registerToolbarButton","setup$6","transpose","dx","dy","isTouchEvent","fromPageXY","pageX","pageY","fromClientXY","transposeContentAreaContainer","containerPos","getPos","getPointAnchor","getSelectionAnchor","getNodeAnchor","getAnchorSpec$1","anchorType","initAndShow$1","buildMenu","contextmenu","anchorSpec","bubbleAlignments","isTouchWithinSelection","touch_1","rngRectOpt","rngRect","setupiOSOverrides","originalSelection","selectionReset","setRng","unbindEventListeners","preventMousedown","clearSelectionReset","getAnchorSpec","bubbleYOffset","initAndShow","shouldHighlightImmediately","openiOS_1","patchPipeConfig","shouldNeverUseNative","defaultItems","contextMenus","isContextMenuDisabled","getContextMenu","getAvoidOverlapSelector","makeContextItem","commonMenuItem","addContextMenuGroup","groupItems","lastMenuItem","generateContextMenu","selectedElement","sections","allItems","isNativeOverrideKeyEvent","isTriggeredByKeyboard","pointerType","getSelectedElement","getAnchorType","selectorExists","setup$5","hideContextMenu","showContextMenu","initAndShow$2","hideEvents","subtract","changes","asFixed","coord","asAbsolute","asOffset","withinRange","coord1","coord2","getDeltas","toStyles","stylesOpt","absorb","partialCoord","originalCoord","absorbOne","stencil","optX","optY","parseAttrToInt","NaN","snapsInfo","leftAttr","topAttr","getCoords","snapInfo","moveOrSnap","newCoord","mustSnap","findClosestSnap","findSnap","fixedCoord","spanned","stopDrag","findMatchingSnap","snaps","sensor","inRange","getSnapPoints","matchSnap","bestSnap","deltas","bestDeltas","currAvg","bestAvg","snapTo$1","snapTo","dragConfig","getTarget","repositionTarget","origin_1","snapPin","DraggingApis","initialAttribute","resetZIndex","zIndex","changeZIndex","zindex","instigate","anyComponent","discard","createComponent","blockerClass","blockerEvents","SnapSchema","schema$6","getCurrentCoord","location","clampCoords","coords","absoluteCoord","newCoords","offset$1","calcNewCoord","optSnaps","currentCoord","snapping","onSensor","dragBy","onDrag","calcStartData","dragState","dragMode","dragStartData","getStartData","dlt","updateStartState","setStartData","init$2","dragApi","forceDrop","drop","delayDrop","getData$1","getDelta$1","MouseData","getDelta","events$2","stop$1","schema$5","init$1","getDataFrom","TouchData","events$1","blockerSingleton","stopBlocking","schema$4","schema$3","mouse","mouseOrTouch","DraggingBranches","previous","calculateDelta","dragEvent","nuData","DragState","Dragging","dragger","snapWidth","snapOffset","calcSnap","selectorOpt","td","selectorHandle","sensorLeft","sensorTop","sensorWidth","sensorHeight","getSnapsConfig","isSameCell","cellOpt","currentTd","createSelector","setup$4","tlTds","brTds","startCell","finishCell","getTopLeftSnap","memTopLeft","getTopLeftSnaps","getBottomRightSnap","memBottomRight","getBottomRightSnaps","topLeftSnaps","bottomRightSnaps","bottomRight","showOrHideHandle","isAbove","isBelow","cellRect","viewportHeight","aboveViewport","belowViewport","getSnapConfig","snapTopLeft","snapLastTopLeft","snapBottomRight","snapLastBottomRight","otherCells","upOrLeftCells","downOrRightCells","isHidden","renderElementPath","getDataPath","newPathElements","_btn","divider","newAcc","updatePath","parents","newPath","parent_1","isDefaultPrevented","isPropagationStopped","ResizeTypes","getDimensions","resizeType","originalHeight","originalWidth","Both","resize","dim","getResizeType","None","Vertical","keyboardHandler","renderResizeHandler","_target","renderWordCount","replaceCountText","words","characters","currentVal","wordCount","renderStatusbar","renderBranding","linkHtml","getTextComponents","getComponents","resizeHandler","setup$3","lazyOuterContainer","platformClasses","touchPlatformClass","deviceClasses","isToolbarBottom","dirAttributes","verticalDirAttributes","isHeaderDocked","resizeUiMothership","makeSinkDefinition","isGridUiContainer","sinkSpec","reactiveWidthSpec","memAnchorBar","lazyAnchorBar","sb","statusbar","socketSidebarContainer","hasMultipleToolbar","hasToolbar","hasMenubar","getPartToolbar","editorComponents","containerComponents","opacity","border","addQueryStateHandler","getUi","broadcastAll","setEditorSize","parsedHeight","parsedWidth","renderUI","toolbarGroupButtonConfig","addGroupToolbarButton","toolbarOpt","describedBy","describedElement","describeElement","describeId","labelledBy","labelledElement","labelElement","schema$2","basic","parts$2","dragBlockClass","getDragBounds","factory$4","dialogComp","showDialog","externalBlocker","hideDialog","blockerDom","getDialogBody","getDialogFooter","setBusy","setIdle","modalEventsId","getFooter","modalBehaviours","ModalDialog","dialogToggleMenuItemSchema","dialogToggleMenuItemDataProcessor","baseFooterButtonFields","dialogFooterButtonFields","normalFooterButtonFields","menuFooterButtonFields","dialogFooterButtonSchema","submit","alertBannerFields","alertBannerSchema","createBarFields","itemsField","buttonFields","buttonSchema","checkboxFields","checkboxSchema","checkboxDataProcessor","formComponentFields","formComponentWithLabelFields","collectionFields","collectionSchema","collectionDataProcessor","colorInputFields","colorInputSchema","colorInputDataProcessor","colorPickerFields","colorPickerSchema","colorPickerDataProcessor","customEditorFields","customEditorFieldsOld","customEditorSchema","customEditorDataProcessor","dropZoneFields","dropZoneSchema","dropZoneDataProcessor","createGridFields","htmlPanelFields","htmlPanelSchema","iframeFields","iframeSchema","iframeDataProcessor","imageToolsFields","imageToolsSchema","inputFields","inputSchema","inputDataProcessor","createLabelFields","listBoxSingleItemFields","listBoxNestedItemFields","listBoxItemSchema","listBoxFields","listBoxSchema","listBoxDataProcessor","selectBoxFields","selectBoxSchema","selectBoxDataProcessor","sizeInputFields","sizeInputSchema","sizeInputDataProcessor","tableFields","tableSchema","textAreaFields","textAreaSchema","textAreaDataProcessor","urlInputFields","urlInputSchema","urlInputDataProcessor","createItemsField","itemSchema","sErr","passValue","panelSchema","panelFields","tabFields","tabPanelFields","tabPanelSchema","dialogButtonFields","dialogButtonSchema","dialogSchema","tabpanel","createDialog","urlDialogButtonSchema","urlDialogSchema","createUrlDialog","getAllObjects","isNamedItem","dataProcessors","togglemenuitem","getDataProcessor","getNamedItems","createDataValidator","namedItems","internalDialog","dataValidator","DialogManager","openUrl","redial","toValidValues","renderBodyPanel","memForm","formValue","factory$3","tabButtonBehaviours","TabButton","schema$1","tabsPart","barDetail","dismissTab$1","tabbar","changeTab$1","clickToDismiss","tabClass","parts$1","factory$2","tabbarBehaviours","selectedClass","tab","Tabbar","factory$1","tabviewBehaviours","Tabview","barPart","tabs","viewPart","tabValue","tabview","tabWithValue","tabData","onChangeTab","changeTabBy","section","byPred","tabSectionBehaviours","selectFirst","onDismissTab","getViewItems","showTab","tabKey","getTabIfNotActive","optTab","TabSection","measureHeights","allTabs","tabviewComp","_tab","getMaxHeight","heights","getMaxTabviewHeight","tablist","documentElement$1","tabviewHeight","isTabListBeside","currentTabHeight","dialogTopMargin","dialogBottomMargin","dialogHeight","chromeHeight","setTabviewHeight","updateTabviewHeight","dialogBody","maxTabHeight","getTabview","smartTabHeight","extraEvents","maxTabHeightOpt","oldHeight","naiveTabHeight","SendDataToSectionChannel","SendDataToViewChannel","renderTabPanel","storedValue","updateDataWithForm","formData","validData","currentData","setDataOnForm","oldTab","tabMode","_viewItems","oldName","tsection","dialogChannel","titleChannel","bodyChannel","footerChannel","bodySendMessageChannel","renderBody","ariaAttrs","incoming","isTabPanel","ariaAttributes","renderInlineBody","contentId","renderModalBody","bodySpec","renderIframeBody","hiddenHeader","pClose","pUntitled","pBodyMessage","pFooter","footer","pFooterGroup","startButtons","endButtons","renderDialog$1","dialogClass","blockerBackdropClass","scrollLockClass","extraStyles","dialogEvents","renderClose","renderTitle","renderDragHandle","renderInlineHeader","titleId","renderModalHeader","pTitle","pHandle","draghandle","draggable","bs","getEventExtras","lazyDialog","closeWindow","blockEvent","renderModalDialog","mapMenuButtons","mapItems","extractCellsToObject","menuButton","innerAcc","initCommonEvents","fireApiEvent","_event","initUrlDialog","getInstanceApi","withSpec","currentDialog","initDialog","currentDialogInit","cur","onTabChange","newTabName","oldTabName","SilverDialogEvents","makeButton","footerButtons","buttonName","buttonGroups","makeGroup","renderFooter","initSpec","lookupByName","renderInlineFooter","renderModalFooter","getCompByName","form_1","getFormWrapper","footerState","validateData$1","dialogState","getDialogApi","doRedial","menuItemStates","withRoot","valueComp","representedValues","menuItemCurrentState","setData","prevData","instanceApi","mergedData","newInternalData","bodyState","tabSection","dialogInit","getDialogSizeClasses","renderDialog","storagedMenuButtons","objOfCells","dialogSize","modalAccess","getForm","outerForm","renderInlineDialog","dialogLabelId","dialogContentId","memHeader","memBody","memFooter","global$1","getUrlDialogApi","sendMessage","SUPPORTED_MESSAGE_ACTIONS","isSupportedMessage","mceAction","isCustomMessage","handleMessage","insertContent","renderUrlDialog","iframeUri","base_uri","href","iframeDomain","protocol","port","messageHandlerUnbinder","isSameOrigin","onMessage","iframeEle","iframeWin","postMessage","setup$2","closeDialog","alertDialog","memFooterClose","titleSpec","closeSpec","footerCloseButton","setup$1","confirmDialog","memFooterYes","footerNo","footerYesButton","validateData","isAlertOrConfirmDialog","inlineAdditionalBehaviours","isStickyToolbar$1","openInlineDialog","openModalDialog","openModalUrlDialog","internalInitialData","config$1","refreshDocking","dialogUi","inlineDialogComp","confirm","Theme","windowMgr","getWindowManagerImpl","getNotificationManagerImpl"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.10.2 (2021-11-17)\n */\n(function () {\n    'use strict';\n\n    var typeOf = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType$1 = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var eq$1 = function (t) {\n      return function (a) {\n        return t === a;\n      };\n    };\n    var isString = isType$1('string');\n    var isObject = isType$1('object');\n    var isArray = isType$1('array');\n    var isNull = eq$1(null);\n    var isBoolean = isSimpleType('boolean');\n    var isUndefined = eq$1(undefined);\n    var isNullable = function (a) {\n      return a === null || a === undefined;\n    };\n    var isNonNullable = function (a) {\n      return !isNullable(a);\n    };\n    var isFunction = isSimpleType('function');\n    var isNumber = isSimpleType('number');\n    var isArrayOf = function (value, pred) {\n      if (isArray(value)) {\n        for (var i = 0, len = value.length; i < len; ++i) {\n          if (!pred(value[i])) {\n            return false;\n          }\n        }\n        return true;\n      }\n      return false;\n    };\n\n    var noop = function () {\n    };\n    var noarg = function (f) {\n      return function () {\n        return f();\n      };\n    };\n    var compose = function (fa, fb) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return fa(fb.apply(null, args));\n      };\n    };\n    var compose1 = function (fbc, fab) {\n      return function (a) {\n        return fbc(fab(a));\n      };\n    };\n    var constant$1 = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity$1 = function (x) {\n      return x;\n    };\n    var tripleEquals = function (a, b) {\n      return a === b;\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var not = function (f) {\n      return function (t) {\n        return !f(t);\n      };\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var never = constant$1(false);\n    var always = constant$1(true);\n\n    var global$g = tinymce.util.Tools.resolve('tinymce.ThemeManager');\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n    function __rest(s, e) {\n      var t = {};\n      for (var p in s)\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n          t[p] = s[p];\n      if (s != null && typeof Object.getOwnPropertySymbols === 'function')\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n            t[p[i]] = s[p[i]];\n        }\n      return t;\n    }\n    function __spreadArray(to, from, pack) {\n      if (pack || arguments.length === 2)\n        for (var i = 0, l = from.length, ar; i < l; i++) {\n          if (ar || !(i in from)) {\n            if (!ar)\n              ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n          }\n        }\n      return to.concat(ar || Array.prototype.slice.call(from));\n    }\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = identity$1;\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant$1(null),\n        getOrUndefined: constant$1(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: function () {\n          return none();\n        },\n        toArray: function () {\n          return [];\n        },\n        toString: constant$1('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant$1(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        }\n      };\n      return me;\n    };\n    var from$1 = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from$1\n    };\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var indexOf = function (xs, x) {\n      var r = rawIndexOf(xs, x);\n      return r === -1 ? Optional.none() : Optional.some(r);\n    };\n    var contains$2 = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var range$2 = function (num, f) {\n      var r = [];\n      for (var i = 0; i < num; i++) {\n        r.push(f(i));\n      }\n      return r;\n    };\n    var chunk$1 = function (array, size) {\n      var r = [];\n      for (var i = 0; i < array.length; i += size) {\n        var s = nativeSlice.call(array, i, i + size);\n        r.push(s);\n      }\n      return r;\n    };\n    var map$2 = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each$1 = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var partition$3 = function (xs, pred) {\n      var pass = [];\n      var fail = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        var arr = pred(x, i) ? pass : fail;\n        arr.push(x);\n      }\n      return {\n        pass: pass,\n        fail: fail\n      };\n    };\n    var filter$2 = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x, i) {\n        acc = f(acc, x, i);\n      });\n      return acc;\n    };\n    var foldl = function (xs, f, acc) {\n      each$1(xs, function (x, i) {\n        acc = f(acc, x, i);\n      });\n      return acc;\n    };\n    var findUntil = function (xs, pred, until) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(x);\n        } else if (until(x, i)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var find$5 = function (xs, pred) {\n      return findUntil(xs, pred, never);\n    };\n    var findIndex$1 = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(i);\n        }\n      }\n      return Optional.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind$3 = function (xs, f) {\n      return flatten(map$2(xs, f));\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var difference = function (a1, a2) {\n      return filter$2(a1, function (x) {\n        return !contains$2(a2, x);\n      });\n    };\n    var mapToObject = function (xs, f) {\n      var r = {};\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        r[String(x)] = f(x, i);\n      }\n      return r;\n    };\n    var pure$2 = function (x) {\n      return [x];\n    };\n    var sort = function (xs, comparator) {\n      var copy = nativeSlice.call(xs, 0);\n      copy.sort(comparator);\n      return copy;\n    };\n    var get$f = function (xs, i) {\n      return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n    };\n    var head = function (xs) {\n      return get$f(xs, 0);\n    };\n    var last$2 = function (xs) {\n      return get$f(xs, xs.length - 1);\n    };\n    var from = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Optional.none();\n    };\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map$1 = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var objAcc = function (r) {\n      return function (x, i) {\n        r[i] = x;\n      };\n    };\n    var internalFilter = function (obj, pred, onTrue, onFalse) {\n      var r = {};\n      each(obj, function (x, i) {\n        (pred(x, i) ? onTrue : onFalse)(x, i);\n      });\n      return r;\n    };\n    var filter$1 = function (obj, pred) {\n      var t = {};\n      internalFilter(obj, pred, objAcc(t), noop);\n      return t;\n    };\n    var mapToArray = function (obj, f) {\n      var r = [];\n      each(obj, function (value, name) {\n        r.push(f(value, name));\n      });\n      return r;\n    };\n    var find$4 = function (obj, pred) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        if (pred(x, i, obj)) {\n          return Optional.some(x);\n        }\n      }\n      return Optional.none();\n    };\n    var values = function (obj) {\n      return mapToArray(obj, identity$1);\n    };\n    var get$e = function (obj, key) {\n      return has$2(obj, key) ? Optional.from(obj[key]) : Optional.none();\n    };\n    var has$2 = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n    var hasNonNullableKey = function (obj, key) {\n      return has$2(obj, key) && obj[key] !== undefined && obj[key] !== null;\n    };\n\n    var is$1 = function (lhs, rhs, comparator) {\n      if (comparator === void 0) {\n        comparator = tripleEquals;\n      }\n      return lhs.exists(function (left) {\n        return comparator(left, rhs);\n      });\n    };\n    var equals = function (lhs, rhs, comparator) {\n      if (comparator === void 0) {\n        comparator = tripleEquals;\n      }\n      return lift2(lhs, rhs, comparator).getOr(lhs.isNone() && rhs.isNone());\n    };\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var sequence = function (arr) {\n      var r = [];\n      for (var i = 0; i < arr.length; i++) {\n        var x = arr[i];\n        if (x.isSome()) {\n          r.push(x.getOrDie());\n        } else {\n          return Optional.none();\n        }\n      }\n      return Optional.some(r);\n    };\n    var lift2 = function (oa, ob, f) {\n      return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n    };\n    var lift3 = function (oa, ob, oc, f) {\n      return oa.isSome() && ob.isSome() && oc.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Optional.none();\n    };\n    var mapFrom = function (a, f) {\n      return a !== undefined && a !== null ? Optional.some(f(a)) : Optional.none();\n    };\n    var someIf = function (b, a) {\n      return b ? Optional.some(a) : Optional.none();\n    };\n\n    var addToEnd = function (str, suffix) {\n      return str + suffix;\n    };\n    var removeFromStart = function (str, numChars) {\n      return str.substring(numChars);\n    };\n\n    var checkRange = function (str, substr, start) {\n      return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n    };\n    var removeLeading = function (str, prefix) {\n      return startsWith(str, prefix) ? removeFromStart(str, prefix.length) : str;\n    };\n    var ensureTrailing = function (str, suffix) {\n      return endsWith(str, suffix) ? str : addToEnd(str, suffix);\n    };\n    var contains$1 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var startsWith = function (str, prefix) {\n      return checkRange(str, prefix, 0);\n    };\n    var endsWith = function (str, suffix) {\n      return checkRange(str, suffix, str.length - suffix.length);\n    };\n    var blank = function (r) {\n      return function (s) {\n        return s.replace(r, '');\n      };\n    };\n    var trim$1 = blank(/^\\s+|\\s+$/g);\n    var isNotEmpty = function (s) {\n      return s.length > 0;\n    };\n    var isEmpty = function (s) {\n      return !isNotEmpty(s);\n    };\n\n    var isSupported$1 = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var fromHtml$2 = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml$2,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var DOCUMENT = 9;\n    var DOCUMENT_FRAGMENT = 11;\n    var ELEMENT = 1;\n    var TEXT = 3;\n\n    var name$2 = function (element) {\n      var r = element.dom.nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom.nodeType;\n    };\n    var isType = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isElement$2 = isType(ELEMENT);\n    var isText$1 = isType(TEXT);\n    var isDocument = isType(DOCUMENT);\n    var isDocumentFragment = isType(DOCUMENT_FRAGMENT);\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n        return r;\n      };\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant$1(isiPad),\n        isiPhone: constant$1(isiPhone),\n        isTablet: constant$1(isTablet),\n        isPhone: constant$1(isPhone),\n        isTouch: constant$1(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant$1(iOSwebview),\n        isDesktop: constant$1(isDesktop)\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$3 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu$d(group(1), group(2));\n    };\n    var detect$4 = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown$3();\n      }\n      return find$3(versionRegexes, cleanedAgent);\n    };\n    var unknown$3 = function () {\n      return nu$d(0, 0);\n    };\n    var nu$d = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu$d,\n      detect: detect$4,\n      unknown: unknown$3\n    };\n\n    var detectBrowser$1 = function (browsers, userAgentData) {\n      return findMap(userAgentData.brands, function (uaBrand) {\n        var lcBrand = uaBrand.brand.toLowerCase();\n        return find$5(browsers, function (browser) {\n          var _a;\n          return lcBrand === ((_a = browser.brand) === null || _a === void 0 ? void 0 : _a.toLowerCase());\n        }).map(function (info) {\n          return {\n            current: info.name,\n            version: Version.nu(parseInt(uaBrand.version, 10), 0)\n          };\n        });\n      });\n    };\n\n    var detect$3 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find$5(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$3(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$3(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains$1(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        brand: 'Chromium',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('mac os x'),\n        versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      },\n      {\n        name: 'ChromeOS',\n        search: checkContains('cros'),\n        versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant$1(browsers),\n      oses: constant$1(oses)\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var unknown$2 = function () {\n      return nu$c({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$c = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isBrowser = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge),\n        isChrome: isBrowser(chrome),\n        isIE: isBrowser(ie),\n        isOpera: isBrowser(opera),\n        isFirefox: isBrowser(firefox),\n        isSafari: isBrowser(safari)\n      };\n    };\n    var Browser = {\n      unknown: unknown$2,\n      nu: nu$c,\n      edge: constant$1(edge),\n      chrome: constant$1(chrome),\n      ie: constant$1(ie),\n      opera: constant$1(opera),\n      firefox: constant$1(firefox),\n      safari: constant$1(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var chromeos = 'ChromeOS';\n    var unknown$1 = function () {\n      return nu$b({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$b = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isOS = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows),\n        isiOS: isOS(ios),\n        isAndroid: isOS(android),\n        isOSX: isOS(osx),\n        isLinux: isOS(linux),\n        isSolaris: isOS(solaris),\n        isFreeBSD: isOS(freebsd),\n        isChromeOS: isOS(chromeos)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$1,\n      nu: nu$b,\n      windows: constant$1(windows),\n      ios: constant$1(ios),\n      android: constant$1(android),\n      linux: constant$1(linux),\n      osx: constant$1(osx),\n      solaris: constant$1(solaris),\n      freebsd: constant$1(freebsd),\n      chromeos: constant$1(chromeos)\n    };\n\n    var detect$2 = function (userAgent, userAgentDataOpt, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = userAgentDataOpt.bind(function (userAgentData) {\n        return detectBrowser$1(browsers, userAgentData);\n      }).orThunk(function () {\n        return detectBrowser(browsers, userAgent);\n      }).fold(Browser.unknown, Browser.nu);\n      var os = detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return window.matchMedia(query).matches;\n    };\n    var platform = cached(function () {\n      return PlatformDetection.detect(navigator.userAgent, Optional.from(navigator.userAgentData), mediaMatch);\n    });\n    var detect$1 = function () {\n      return platform();\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n\n    var is = function (element, selector) {\n      var dom = element.dom;\n      if (dom.nodeType !== ELEMENT) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n    };\n    var all$3 = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? [] : map$2(base.querySelectorAll(selector), SugarElement.fromDom);\n    };\n    var one = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n    };\n\n    var eq = function (e1, e2) {\n      return e1.dom === e2.dom;\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom;\n      var d2 = e2.dom;\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return documentPositionContainedBy(e1.dom, e2.dom);\n    };\n    var contains = function (e1, e2) {\n      return detect$1().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n    };\n\n    var owner$4 = function (element) {\n      return SugarElement.fromDom(element.dom.ownerDocument);\n    };\n    var documentOrOwner = function (dos) {\n      return isDocument(dos) ? dos : owner$4(dos);\n    };\n    var documentElement = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.documentElement);\n    };\n    var defaultView = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n    };\n    var parent = function (element) {\n      return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n    };\n    var parentNode = function (element) {\n      return parent(element);\n    };\n    var offsetParent = function (element) {\n      return Optional.from(element.dom.offsetParent).map(SugarElement.fromDom);\n    };\n    var nextSibling = function (element) {\n      return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n    };\n    var children = function (element) {\n      return map$2(element.dom.childNodes, SugarElement.fromDom);\n    };\n    var child$2 = function (element, index) {\n      var cs = element.dom.childNodes;\n      return Optional.from(cs[index]).map(SugarElement.fromDom);\n    };\n    var firstChild = function (element) {\n      return child$2(element, 0);\n    };\n    var spot = function (element, offset) {\n      return {\n        element: element,\n        offset: offset\n      };\n    };\n    var leaf = function (element, offset) {\n      var cs = children(element);\n      return cs.length > 0 && offset < cs.length ? spot(cs[offset], 0) : spot(element, offset);\n    };\n\n    var isShadowRoot = function (dos) {\n      return isDocumentFragment(dos) && isNonNullable(dos.dom.host);\n    };\n    var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n    var isSupported = constant$1(supported);\n    var getRootNode = supported ? function (e) {\n      return SugarElement.fromDom(e.dom.getRootNode());\n    } : documentOrOwner;\n    var getContentContainer = function (dos) {\n      return isShadowRoot(dos) ? dos : SugarElement.fromDom(documentOrOwner(dos).dom.body);\n    };\n    var isInShadowRoot = function (e) {\n      return getShadowRoot(e).isSome();\n    };\n    var getShadowRoot = function (e) {\n      var r = getRootNode(e);\n      return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n    };\n    var getShadowHost = function (e) {\n      return SugarElement.fromDom(e.dom.host);\n    };\n    var getOriginalEventTarget = function (event) {\n      if (isSupported() && isNonNullable(event.target)) {\n        var el = SugarElement.fromDom(event.target);\n        if (isElement$2(el) && isOpenShadowHost(el)) {\n          if (event.composed && event.composedPath) {\n            var composedPath = event.composedPath();\n            if (composedPath) {\n              return head(composedPath);\n            }\n          }\n        }\n      }\n      return Optional.from(event.target);\n    };\n    var isOpenShadowHost = function (element) {\n      return isNonNullable(element.dom.shadowRoot);\n    };\n\n    var inBody = function (element) {\n      var dom = isText$1(element) ? element.dom.parentNode : element.dom;\n      if (dom === undefined || dom === null || dom.ownerDocument === null) {\n        return false;\n      }\n      var doc = dom.ownerDocument;\n      return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n        return doc.body.contains(dom);\n      }, compose1(inBody, getShadowHost));\n    };\n    var body = function () {\n      return getBody(SugarElement.fromDom(document));\n    };\n    var getBody = function (doc) {\n      var b = doc.dom.body;\n      if (b === null || b === undefined) {\n        throw new Error('Body is not available yet');\n      }\n      return SugarElement.fromDom(b);\n    };\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set$8 = function (element, key, value) {\n      rawSet(element.dom, key, value);\n    };\n    var setAll$1 = function (element, attrs) {\n      var dom = element.dom;\n      each(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var get$d = function (element, key) {\n      var v = element.dom.getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var getOpt = function (element, key) {\n      return Optional.from(get$d(element, key));\n    };\n    var has$1 = function (element, key) {\n      var dom = element.dom;\n      return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n    };\n    var remove$7 = function (element, key) {\n      element.dom.removeAttribute(key);\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported$1(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var internalRemove = function (dom, property) {\n      if (isSupported$1(dom)) {\n        dom.style.removeProperty(property);\n      }\n    };\n    var set$7 = function (element, property, value) {\n      var dom = element.dom;\n      internalSet(dom, property, value);\n    };\n    var setAll = function (element, css) {\n      var dom = element.dom;\n      each(css, function (v, k) {\n        internalSet(dom, k, v);\n      });\n    };\n    var setOptions = function (element, css) {\n      var dom = element.dom;\n      each(css, function (v, k) {\n        v.fold(function () {\n          internalRemove(dom, k);\n        }, function (value) {\n          internalSet(dom, k, value);\n        });\n      });\n    };\n    var get$c = function (element, property) {\n      var dom = element.dom;\n      var styles = window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported$1(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n    var getRaw = function (element, property) {\n      var dom = element.dom;\n      var raw = getUnsafeProperty(dom, property);\n      return Optional.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n    var getAllRaw = function (element) {\n      var css = {};\n      var dom = element.dom;\n      if (isSupported$1(dom)) {\n        for (var i = 0; i < dom.style.length; i++) {\n          var ruleName = dom.style.item(i);\n          css[ruleName] = dom.style[ruleName];\n        }\n      }\n      return css;\n    };\n    var isValidValue = function (tag, property, value) {\n      var element = SugarElement.fromTag(tag);\n      set$7(element, property, value);\n      var style = getRaw(element, property);\n      return style.isSome();\n    };\n    var remove$6 = function (element, property) {\n      var dom = element.dom;\n      internalRemove(dom, property);\n      if (is$1(getOpt(element, 'style').map(trim$1), '')) {\n        remove$7(element, 'style');\n      }\n    };\n    var reflow = function (e) {\n      return e.dom.offsetWidth;\n    };\n\n    var Dimension = function (name, getOffset) {\n      var set = function (element, h) {\n        if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n          throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n        }\n        var dom = element.dom;\n        if (isSupported$1(dom)) {\n          dom.style[name] = h + 'px';\n        }\n      };\n      var get = function (element) {\n        var r = getOffset(element);\n        if (r <= 0 || r === null) {\n          var css = get$c(element, name);\n          return parseFloat(css) || 0;\n        }\n        return r;\n      };\n      var getOuter = get;\n      var aggregate = function (element, properties) {\n        return foldl(properties, function (acc, property) {\n          var val = get$c(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    };\n\n    var api$3 = Dimension('height', function (element) {\n      var dom = element.dom;\n      return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n    });\n    var get$b = function (element) {\n      return api$3.get(element);\n    };\n    var getOuter$2 = function (element) {\n      return api$3.getOuter(element);\n    };\n    var setMax$1 = function (element, value) {\n      var inclusions = [\n        'margin-top',\n        'border-top-width',\n        'padding-top',\n        'padding-bottom',\n        'border-bottom-width',\n        'margin-bottom'\n      ];\n      var absMax = api$3.max(element, value, inclusions);\n      set$7(element, 'max-height', absMax + 'px');\n    };\n\n    var r$1 = function (left, top) {\n      var translate = function (x, y) {\n        return r$1(left + x, top + y);\n      };\n      return {\n        left: left,\n        top: top,\n        translate: translate\n      };\n    };\n    var SugarPosition = r$1;\n\n    var boxPosition = function (dom) {\n      var box = dom.getBoundingClientRect();\n      return SugarPosition(box.left, box.top);\n    };\n    var firstDefinedOrZero = function (a, b) {\n      if (a !== undefined) {\n        return a;\n      } else {\n        return b !== undefined ? b : 0;\n      }\n    };\n    var absolute$3 = function (element) {\n      var doc = element.dom.ownerDocument;\n      var body = doc.body;\n      var win = doc.defaultView;\n      var html = doc.documentElement;\n      if (body === element.dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n      var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n      var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n      var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n      return viewport$1(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n    };\n    var viewport$1 = function (element) {\n      var dom = element.dom;\n      var doc = dom.ownerDocument;\n      var body = doc.body;\n      if (body === dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      if (!inBody(element)) {\n        return SugarPosition(0, 0);\n      }\n      return boxPosition(dom);\n    };\n\n    var api$2 = Dimension('width', function (element) {\n      return element.dom.offsetWidth;\n    });\n    var set$6 = function (element, h) {\n      return api$2.set(element, h);\n    };\n    var get$a = function (element) {\n      return api$2.get(element);\n    };\n    var getOuter$1 = function (element) {\n      return api$2.getOuter(element);\n    };\n    var setMax = function (element, value) {\n      var inclusions = [\n        'margin-left',\n        'border-left-width',\n        'padding-left',\n        'padding-right',\n        'border-right-width',\n        'margin-right'\n      ];\n      var absMax = api$2.max(element, value, inclusions);\n      set$7(element, 'max-width', absMax + 'px');\n    };\n\n    var mkEvent = function (target, x, y, stop, prevent, kill, raw) {\n      return {\n        target: target,\n        x: x,\n        y: y,\n        stop: stop,\n        prevent: prevent,\n        kill: kill,\n        raw: raw\n      };\n    };\n    var fromRawEvent$1 = function (rawEvent) {\n      var target = SugarElement.fromDom(getOriginalEventTarget(rawEvent).getOr(rawEvent.target));\n      var stop = function () {\n        return rawEvent.stopPropagation();\n      };\n      var prevent = function () {\n        return rawEvent.preventDefault();\n      };\n      var kill = compose(prevent, stop);\n      return mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n    };\n    var handle = function (filter, handler) {\n      return function (rawEvent) {\n        if (filter(rawEvent)) {\n          handler(fromRawEvent$1(rawEvent));\n        }\n      };\n    };\n    var binder = function (element, event, filter, handler, useCapture) {\n      var wrapped = handle(filter, handler);\n      element.dom.addEventListener(event, wrapped, useCapture);\n      return { unbind: curry(unbind, element, event, wrapped, useCapture) };\n    };\n    var bind$2 = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, false);\n    };\n    var capture$1 = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, true);\n    };\n    var unbind = function (element, event, handler, useCapture) {\n      element.dom.removeEventListener(event, handler, useCapture);\n    };\n\n    var before$2 = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom.insertBefore(element.dom, marker.dom);\n      });\n    };\n    var after$2 = function (marker, element) {\n      var sibling = nextSibling(marker);\n      sibling.fold(function () {\n        var parent$1 = parent(marker);\n        parent$1.each(function (v) {\n          append$2(v, element);\n        });\n      }, function (v) {\n        before$2(v, element);\n      });\n    };\n    var prepend$1 = function (parent, element) {\n      var firstChild$1 = firstChild(parent);\n      firstChild$1.fold(function () {\n        append$2(parent, element);\n      }, function (v) {\n        parent.dom.insertBefore(element.dom, v.dom);\n      });\n    };\n    var append$2 = function (parent, element) {\n      parent.dom.appendChild(element.dom);\n    };\n    var appendAt = function (parent, element, index) {\n      child$2(parent, index).fold(function () {\n        append$2(parent, element);\n      }, function (v) {\n        before$2(v, element);\n      });\n    };\n\n    var before$1 = function (marker, elements) {\n      each$1(elements, function (x) {\n        before$2(marker, x);\n      });\n    };\n    var append$1 = function (parent, elements) {\n      each$1(elements, function (x) {\n        append$2(parent, x);\n      });\n    };\n\n    var empty = function (element) {\n      element.dom.textContent = '';\n      each$1(children(element), function (rogue) {\n        remove$5(rogue);\n      });\n    };\n    var remove$5 = function (element) {\n      var dom = element.dom;\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n    var unwrap = function (wrapper) {\n      var children$1 = children(wrapper);\n      if (children$1.length > 0) {\n        before$1(wrapper, children$1);\n      }\n      remove$5(wrapper);\n    };\n\n    var get$9 = function (_DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return SugarPosition(x, y);\n    };\n    var to = function (x, y, _DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var win = doc.defaultView;\n      if (win) {\n        win.scrollTo(x, y);\n      }\n    };\n\n    var get$8 = function (_win) {\n      var win = _win === undefined ? window : _win;\n      if (detect$1().browser.isFirefox()) {\n        return Optional.none();\n      } else {\n        return Optional.from(win['visualViewport']);\n      }\n    };\n    var bounds$1 = function (x, y, width, height) {\n      return {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        right: x + width,\n        bottom: y + height\n      };\n    };\n    var getBounds$3 = function (_win) {\n      var win = _win === undefined ? window : _win;\n      var doc = win.document;\n      var scroll = get$9(SugarElement.fromDom(doc));\n      return get$8(win).fold(function () {\n        var html = win.document.documentElement;\n        var width = html.clientWidth;\n        var height = html.clientHeight;\n        return bounds$1(scroll.left, scroll.top, width, height);\n      }, function (visualViewport) {\n        return bounds$1(Math.max(visualViewport.pageLeft, scroll.left), Math.max(visualViewport.pageTop, scroll.top), visualViewport.width, visualViewport.height);\n      });\n    };\n\n    var walkUp = function (navigation, doc) {\n      var frame = navigation.view(doc);\n      return frame.fold(constant$1([]), function (f) {\n        var parent = navigation.owner(f);\n        var rest = walkUp(navigation, parent);\n        return [f].concat(rest);\n      });\n    };\n    var pathTo = function (element, navigation) {\n      var d = navigation.owner(element);\n      var paths = walkUp(navigation, d);\n      return Optional.some(paths);\n    };\n\n    var view = function (doc) {\n      var _a;\n      var element = doc.dom === document ? Optional.none() : Optional.from((_a = doc.dom.defaultView) === null || _a === void 0 ? void 0 : _a.frameElement);\n      return element.map(SugarElement.fromDom);\n    };\n    var owner$3 = function (element) {\n      return owner$4(element);\n    };\n\n    var Navigation = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        view: view,\n        owner: owner$3\n    });\n\n    var find$2 = function (element) {\n      var doc = SugarElement.fromDom(document);\n      var scroll = get$9(doc);\n      var path = pathTo(element, Navigation);\n      return path.fold(curry(absolute$3, element), function (frames) {\n        var offset = viewport$1(element);\n        var r = foldr(frames, function (b, a) {\n          var loc = viewport$1(a);\n          return {\n            left: b.left + loc.left,\n            top: b.top + loc.top\n          };\n        }, {\n          left: 0,\n          top: 0\n        });\n        return SugarPosition(r.left + offset.left + scroll.left, r.top + offset.top + scroll.top);\n      });\n    };\n\n    var pointed = function (point, width, height) {\n      return {\n        point: point,\n        width: width,\n        height: height\n      };\n    };\n    var rect = function (x, y, width, height) {\n      return {\n        x: x,\n        y: y,\n        width: width,\n        height: height\n      };\n    };\n    var bounds = function (x, y, width, height) {\n      return {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        right: x + width,\n        bottom: y + height\n      };\n    };\n    var box$1 = function (element) {\n      var xy = absolute$3(element);\n      var w = getOuter$1(element);\n      var h = getOuter$2(element);\n      return bounds(xy.left, xy.top, w, h);\n    };\n    var absolute$2 = function (element) {\n      var position = find$2(element);\n      var width = getOuter$1(element);\n      var height = getOuter$2(element);\n      return bounds(position.left, position.top, width, height);\n    };\n    var win = function () {\n      return getBounds$3(window);\n    };\n\n    var value$3 = function (o) {\n      var or = function (_opt) {\n        return value$3(o);\n      };\n      var orThunk = function (_f) {\n        return value$3(o);\n      };\n      var map = function (f) {\n        return value$3(f(o));\n      };\n      var mapError = function (_f) {\n        return value$3(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOptional = function () {\n        return Optional.some(o);\n      };\n      return {\n        isValue: always,\n        isError: never,\n        getOr: constant$1(o),\n        getOrThunk: constant$1(o),\n        getOrDie: constant$1(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOptional: toOptional\n      };\n    };\n    var error$1 = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = identity$1;\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (_f) {\n        return error$1(message);\n      };\n      var mapError = function (f) {\n        return error$1(f(message));\n      };\n      var bind = function (_f) {\n        return error$1(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        isValue: never,\n        isError: always,\n        getOr: identity$1,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOptional: Optional.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error$1(err);\n      }, value$3);\n    };\n    var Result = {\n      value: value$3,\n      error: error$1,\n      fromOption: fromOption\n    };\n\n    var SimpleResultType;\n    (function (SimpleResultType) {\n      SimpleResultType[SimpleResultType['Error'] = 0] = 'Error';\n      SimpleResultType[SimpleResultType['Value'] = 1] = 'Value';\n    }(SimpleResultType || (SimpleResultType = {})));\n    var fold$1 = function (res, onError, onValue) {\n      return res.stype === SimpleResultType.Error ? onError(res.serror) : onValue(res.svalue);\n    };\n    var partition$2 = function (results) {\n      var values = [];\n      var errors = [];\n      each$1(results, function (obj) {\n        fold$1(obj, function (err) {\n          return errors.push(err);\n        }, function (val) {\n          return values.push(val);\n        });\n      });\n      return {\n        values: values,\n        errors: errors\n      };\n    };\n    var mapError = function (res, f) {\n      if (res.stype === SimpleResultType.Error) {\n        return {\n          stype: SimpleResultType.Error,\n          serror: f(res.serror)\n        };\n      } else {\n        return res;\n      }\n    };\n    var map = function (res, f) {\n      if (res.stype === SimpleResultType.Value) {\n        return {\n          stype: SimpleResultType.Value,\n          svalue: f(res.svalue)\n        };\n      } else {\n        return res;\n      }\n    };\n    var bind$1 = function (res, f) {\n      if (res.stype === SimpleResultType.Value) {\n        return f(res.svalue);\n      } else {\n        return res;\n      }\n    };\n    var bindError = function (res, f) {\n      if (res.stype === SimpleResultType.Error) {\n        return f(res.serror);\n      } else {\n        return res;\n      }\n    };\n    var svalue = function (v) {\n      return {\n        stype: SimpleResultType.Value,\n        svalue: v\n      };\n    };\n    var serror = function (e) {\n      return {\n        stype: SimpleResultType.Error,\n        serror: e\n      };\n    };\n    var toResult$1 = function (res) {\n      return fold$1(res, Result.error, Result.value);\n    };\n    var fromResult$1 = function (res) {\n      return res.fold(serror, svalue);\n    };\n    var SimpleResult = {\n      fromResult: fromResult$1,\n      toResult: toResult$1,\n      svalue: svalue,\n      partition: partition$2,\n      serror: serror,\n      bind: bind$1,\n      bindError: bindError,\n      map: map,\n      mapError: mapError,\n      fold: fold$1\n    };\n\n    var field$2 = function (key, newKey, presence, prop) {\n      return {\n        tag: 'field',\n        key: key,\n        newKey: newKey,\n        presence: presence,\n        prop: prop\n      };\n    };\n    var customField$1 = function (newKey, instantiator) {\n      return {\n        tag: 'custom',\n        newKey: newKey,\n        instantiator: instantiator\n      };\n    };\n    var fold = function (value, ifField, ifCustom) {\n      switch (value.tag) {\n      case 'field':\n        return ifField(value.key, value.newKey, value.presence, value.prop);\n      case 'custom':\n        return ifCustom(value.newKey, value.instantiator);\n      }\n    };\n\n    var shallow$1 = function (old, nu) {\n      return nu;\n    };\n    var deep = function (old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          objects[_i] = arguments[_i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (has$2(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var deepMerge = baseMerge(deep);\n    var merge$1 = baseMerge(shallow$1);\n\n    var required$2 = function () {\n      return {\n        tag: 'required',\n        process: {}\n      };\n    };\n    var defaultedThunk = function (fallbackThunk) {\n      return {\n        tag: 'defaultedThunk',\n        process: fallbackThunk\n      };\n    };\n    var defaulted$1 = function (fallback) {\n      return defaultedThunk(constant$1(fallback));\n    };\n    var asOption = function () {\n      return {\n        tag: 'option',\n        process: {}\n      };\n    };\n    var mergeWithThunk = function (baseThunk) {\n      return {\n        tag: 'mergeWithThunk',\n        process: baseThunk\n      };\n    };\n    var mergeWith = function (base) {\n      return mergeWithThunk(constant$1(base));\n    };\n\n    var mergeValues$1 = function (values, base) {\n      return values.length > 0 ? SimpleResult.svalue(deepMerge(base, merge$1.apply(undefined, values))) : SimpleResult.svalue(base);\n    };\n    var mergeErrors$1 = function (errors) {\n      return compose(SimpleResult.serror, flatten)(errors);\n    };\n    var consolidateObj = function (objects, base) {\n      var partition = SimpleResult.partition(objects);\n      return partition.errors.length > 0 ? mergeErrors$1(partition.errors) : mergeValues$1(partition.values, base);\n    };\n    var consolidateArr = function (objects) {\n      var partitions = SimpleResult.partition(objects);\n      return partitions.errors.length > 0 ? mergeErrors$1(partitions.errors) : SimpleResult.svalue(partitions.values);\n    };\n    var ResultCombine = {\n      consolidateObj: consolidateObj,\n      consolidateArr: consolidateArr\n    };\n\n    var formatObj = function (input) {\n      return isObject(input) && keys(input).length > 100 ? ' removed due to size' : JSON.stringify(input, null, 2);\n    };\n    var formatErrors = function (errors) {\n      var es = errors.length > 10 ? errors.slice(0, 10).concat([{\n          path: [],\n          getErrorInfo: constant$1('... (only showing first ten failures)')\n        }]) : errors;\n      return map$2(es, function (e) {\n        return 'Failed path: (' + e.path.join(' > ') + ')\\n' + e.getErrorInfo();\n      });\n    };\n\n    var nu$a = function (path, getErrorInfo) {\n      return SimpleResult.serror([{\n          path: path,\n          getErrorInfo: getErrorInfo\n        }]);\n    };\n    var missingRequired = function (path, key, obj) {\n      return nu$a(path, function () {\n        return 'Could not find valid *required* value for \"' + key + '\" in ' + formatObj(obj);\n      });\n    };\n    var missingKey = function (path, key) {\n      return nu$a(path, function () {\n        return 'Choice schema did not contain choice key: \"' + key + '\"';\n      });\n    };\n    var missingBranch = function (path, branches, branch) {\n      return nu$a(path, function () {\n        return 'The chosen schema: \"' + branch + '\" did not exist in branches: ' + formatObj(branches);\n      });\n    };\n    var unsupportedFields = function (path, unsupported) {\n      return nu$a(path, function () {\n        return 'There are unsupported fields: [' + unsupported.join(', ') + '] specified';\n      });\n    };\n    var custom = function (path, err) {\n      return nu$a(path, constant$1(err));\n    };\n\n    var value$2 = function (validator) {\n      var extract = function (path, val) {\n        return SimpleResult.bindError(validator(val), function (err) {\n          return custom(path, err);\n        });\n      };\n      var toString = constant$1('val');\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var anyValue$1 = value$2(SimpleResult.svalue);\n\n    var requiredAccess = function (path, obj, key, bundle) {\n      return get$e(obj, key).fold(function () {\n        return missingRequired(path, key, obj);\n      }, bundle);\n    };\n    var fallbackAccess = function (obj, key, fallback, bundle) {\n      var v = get$e(obj, key).getOrThunk(function () {\n        return fallback(obj);\n      });\n      return bundle(v);\n    };\n    var optionAccess = function (obj, key, bundle) {\n      return bundle(get$e(obj, key));\n    };\n    var optionDefaultedAccess = function (obj, key, fallback, bundle) {\n      var opt = get$e(obj, key).map(function (val) {\n        return val === true ? fallback(obj) : val;\n      });\n      return bundle(opt);\n    };\n    var extractField = function (field, path, obj, key, prop) {\n      var bundle = function (av) {\n        return prop.extract(path.concat([key]), av);\n      };\n      var bundleAsOption = function (optValue) {\n        return optValue.fold(function () {\n          return SimpleResult.svalue(Optional.none());\n        }, function (ov) {\n          var result = prop.extract(path.concat([key]), ov);\n          return SimpleResult.map(result, Optional.some);\n        });\n      };\n      switch (field.tag) {\n      case 'required':\n        return requiredAccess(path, obj, key, bundle);\n      case 'defaultedThunk':\n        return fallbackAccess(obj, key, field.process, bundle);\n      case 'option':\n        return optionAccess(obj, key, bundleAsOption);\n      case 'defaultedOptionThunk':\n        return optionDefaultedAccess(obj, key, field.process, bundleAsOption);\n      case 'mergeWithThunk': {\n          return fallbackAccess(obj, key, constant$1({}), function (v) {\n            var result = deepMerge(field.process(obj), v);\n            return bundle(result);\n          });\n        }\n      }\n    };\n    var extractFields = function (path, obj, fields) {\n      var success = {};\n      var errors = [];\n      for (var _i = 0, fields_1 = fields; _i < fields_1.length; _i++) {\n        var field = fields_1[_i];\n        fold(field, function (key, newKey, presence, prop) {\n          var result = extractField(presence, path, obj, key, prop);\n          SimpleResult.fold(result, function (err) {\n            errors.push.apply(errors, err);\n          }, function (res) {\n            success[newKey] = res;\n          });\n        }, function (newKey, instantiator) {\n          success[newKey] = instantiator(obj);\n        });\n      }\n      return errors.length > 0 ? SimpleResult.serror(errors) : SimpleResult.svalue(success);\n    };\n    var valueThunk = function (getDelegate) {\n      var extract = function (path, val) {\n        return getDelegate().extract(path, val);\n      };\n      var toString = function () {\n        return getDelegate().toString();\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var getSetKeys = function (obj) {\n      return keys(filter$1(obj, isNonNullable));\n    };\n    var objOfOnly = function (fields) {\n      var delegate = objOf(fields);\n      var fieldNames = foldr(fields, function (acc, value) {\n        return fold(value, function (key) {\n          var _a;\n          return deepMerge(acc, (_a = {}, _a[key] = true, _a));\n        }, constant$1(acc));\n      }, {});\n      var extract = function (path, o) {\n        var keys = isBoolean(o) ? [] : getSetKeys(o);\n        var extra = filter$2(keys, function (k) {\n          return !hasNonNullableKey(fieldNames, k);\n        });\n        return extra.length === 0 ? delegate.extract(path, o) : unsupportedFields(path, extra);\n      };\n      return {\n        extract: extract,\n        toString: delegate.toString\n      };\n    };\n    var objOf = function (values) {\n      var extract = function (path, o) {\n        return extractFields(path, o, values);\n      };\n      var toString = function () {\n        var fieldStrings = map$2(values, function (value) {\n          return fold(value, function (key, _okey, _presence, prop) {\n            return key + ' -> ' + prop.toString();\n          }, function (newKey, _instantiator) {\n            return 'state(' + newKey + ')';\n          });\n        });\n        return 'obj{\\n' + fieldStrings.join('\\n') + '}';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var arrOf = function (prop) {\n      var extract = function (path, array) {\n        var results = map$2(array, function (a, i) {\n          return prop.extract(path.concat(['[' + i + ']']), a);\n        });\n        return ResultCombine.consolidateArr(results);\n      };\n      var toString = function () {\n        return 'array(' + prop.toString() + ')';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var oneOf = function (props) {\n      var extract = function (path, val) {\n        var errors = [];\n        for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {\n          var prop = props_1[_i];\n          var res = prop.extract(path, val);\n          if (res.stype === SimpleResultType.Value) {\n            return res;\n          }\n          errors.push(res);\n        }\n        return ResultCombine.consolidateArr(errors);\n      };\n      var toString = function () {\n        return 'oneOf(' + map$2(props, function (prop) {\n          return prop.toString();\n        }).join(', ') + ')';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var setOf$1 = function (validator, prop) {\n      var validateKeys = function (path, keys) {\n        return arrOf(value$2(validator)).extract(path, keys);\n      };\n      var extract = function (path, o) {\n        var keys$1 = keys(o);\n        var validatedKeys = validateKeys(path, keys$1);\n        return SimpleResult.bind(validatedKeys, function (validKeys) {\n          var schema = map$2(validKeys, function (vk) {\n            return field$2(vk, vk, required$2(), prop);\n          });\n          return objOf(schema).extract(path, o);\n        });\n      };\n      var toString = function () {\n        return 'setOf(' + prop.toString() + ')';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var thunk = function (_desc, processor) {\n      var getP = cached(processor);\n      var extract = function (path, val) {\n        return getP().extract(path, val);\n      };\n      var toString = function () {\n        return getP().toString();\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var arrOfObj = compose(arrOf, objOf);\n\n    var anyValue = constant$1(anyValue$1);\n    var typedValue = function (validator, expectedType) {\n      return value$2(function (a) {\n        var actualType = typeof a;\n        return validator(a) ? SimpleResult.svalue(a) : SimpleResult.serror('Expected type: ' + expectedType + ' but got: ' + actualType);\n      });\n    };\n    var number = typedValue(isNumber, 'number');\n    var string = typedValue(isString, 'string');\n    var boolean = typedValue(isBoolean, 'boolean');\n    var functionProcessor = typedValue(isFunction, 'function');\n    var isPostMessageable = function (val) {\n      if (Object(val) !== val) {\n        return true;\n      }\n      switch ({}.toString.call(val).slice(8, -1)) {\n      case 'Boolean':\n      case 'Number':\n      case 'String':\n      case 'Date':\n      case 'RegExp':\n      case 'Blob':\n      case 'FileList':\n      case 'ImageData':\n      case 'ImageBitmap':\n      case 'ArrayBuffer':\n        return true;\n      case 'Array':\n      case 'Object':\n        return Object.keys(val).every(function (prop) {\n          return isPostMessageable(val[prop]);\n        });\n      default:\n        return false;\n      }\n    };\n    var postMessageable = value$2(function (a) {\n      if (isPostMessageable(a)) {\n        return SimpleResult.svalue(a);\n      } else {\n        return SimpleResult.serror('Expected value to be acceptable for sending via postMessage');\n      }\n    });\n\n    var chooseFrom = function (path, input, branches, ch) {\n      var fields = get$e(branches, ch);\n      return fields.fold(function () {\n        return missingBranch(path, branches, ch);\n      }, function (vp) {\n        return vp.extract(path.concat(['branch: ' + ch]), input);\n      });\n    };\n    var choose$2 = function (key, branches) {\n      var extract = function (path, input) {\n        var choice = get$e(input, key);\n        return choice.fold(function () {\n          return missingKey(path, key);\n        }, function (chosen) {\n          return chooseFrom(path, input, branches, chosen);\n        });\n      };\n      var toString = function () {\n        return 'chooseOn(' + key + '). Possible values: ' + keys(branches);\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n\n    var arrOfVal = function () {\n      return arrOf(anyValue$1);\n    };\n    var valueOf = function (validator) {\n      return value$2(function (v) {\n        return validator(v).fold(SimpleResult.serror, SimpleResult.svalue);\n      });\n    };\n    var setOf = function (validator, prop) {\n      return setOf$1(function (v) {\n        return SimpleResult.fromResult(validator(v));\n      }, prop);\n    };\n    var extractValue = function (label, prop, obj) {\n      var res = prop.extract([label], obj);\n      return SimpleResult.mapError(res, function (errs) {\n        return {\n          input: obj,\n          errors: errs\n        };\n      });\n    };\n    var asRaw = function (label, prop, obj) {\n      return SimpleResult.toResult(extractValue(label, prop, obj));\n    };\n    var getOrDie = function (extraction) {\n      return extraction.fold(function (errInfo) {\n        throw new Error(formatError(errInfo));\n      }, identity$1);\n    };\n    var asRawOrDie$1 = function (label, prop, obj) {\n      return getOrDie(asRaw(label, prop, obj));\n    };\n    var formatError = function (errInfo) {\n      return 'Errors: \\n' + formatErrors(errInfo.errors).join('\\n') + '\\n\\nInput object: ' + formatObj(errInfo.input);\n    };\n    var choose$1 = function (key, branches) {\n      return choose$2(key, map$1(branches, objOf));\n    };\n    var thunkOf = function (desc, schema) {\n      return thunk(desc, schema);\n    };\n\n    var field$1 = field$2;\n    var customField = customField$1;\n    var validateEnum = function (values) {\n      return valueOf(function (value) {\n        return contains$2(values, value) ? Result.value(value) : Result.error('Unsupported value: \"' + value + '\", choose one of \"' + values.join(', ') + '\".');\n      });\n    };\n    var required$1 = function (key) {\n      return field$1(key, key, required$2(), anyValue());\n    };\n    var requiredOf = function (key, schema) {\n      return field$1(key, key, required$2(), schema);\n    };\n    var requiredNumber = function (key) {\n      return requiredOf(key, number);\n    };\n    var requiredString = function (key) {\n      return requiredOf(key, string);\n    };\n    var requiredStringEnum = function (key, values) {\n      return field$1(key, key, required$2(), validateEnum(values));\n    };\n    var requiredBoolean = function (key) {\n      return requiredOf(key, boolean);\n    };\n    var requiredFunction = function (key) {\n      return requiredOf(key, functionProcessor);\n    };\n    var forbid = function (key, message) {\n      return field$1(key, key, asOption(), value$2(function (_v) {\n        return SimpleResult.serror('The field: ' + key + ' is forbidden. ' + message);\n      }));\n    };\n    var requiredObjOf = function (key, objSchema) {\n      return field$1(key, key, required$2(), objOf(objSchema));\n    };\n    var requiredArrayOfObj = function (key, objFields) {\n      return field$1(key, key, required$2(), arrOfObj(objFields));\n    };\n    var requiredArrayOf = function (key, schema) {\n      return field$1(key, key, required$2(), arrOf(schema));\n    };\n    var option = function (key) {\n      return field$1(key, key, asOption(), anyValue());\n    };\n    var optionOf = function (key, schema) {\n      return field$1(key, key, asOption(), schema);\n    };\n    var optionNumber = function (key) {\n      return optionOf(key, number);\n    };\n    var optionString = function (key) {\n      return optionOf(key, string);\n    };\n    var optionFunction = function (key) {\n      return optionOf(key, functionProcessor);\n    };\n    var optionArrayOf = function (key, schema) {\n      return optionOf(key, arrOf(schema));\n    };\n    var optionObjOf = function (key, objSchema) {\n      return optionOf(key, objOf(objSchema));\n    };\n    var optionObjOfOnly = function (key, objSchema) {\n      return optionOf(key, objOfOnly(objSchema));\n    };\n    var defaulted = function (key, fallback) {\n      return field$1(key, key, defaulted$1(fallback), anyValue());\n    };\n    var defaultedOf = function (key, fallback, schema) {\n      return field$1(key, key, defaulted$1(fallback), schema);\n    };\n    var defaultedNumber = function (key, fallback) {\n      return defaultedOf(key, fallback, number);\n    };\n    var defaultedString = function (key, fallback) {\n      return defaultedOf(key, fallback, string);\n    };\n    var defaultedStringEnum = function (key, fallback, values) {\n      return defaultedOf(key, fallback, validateEnum(values));\n    };\n    var defaultedBoolean = function (key, fallback) {\n      return defaultedOf(key, fallback, boolean);\n    };\n    var defaultedFunction = function (key, fallback) {\n      return defaultedOf(key, fallback, functionProcessor);\n    };\n    var defaultedPostMsg = function (key, fallback) {\n      return defaultedOf(key, fallback, postMessageable);\n    };\n    var defaultedArrayOf = function (key, fallback, schema) {\n      return defaultedOf(key, fallback, arrOf(schema));\n    };\n    var defaultedObjOf = function (key, fallback, objSchema) {\n      return defaultedOf(key, fallback, objOf(objSchema));\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var generate$7 = function (cases) {\n      if (!isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each$1(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          var argLength = args.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains$2(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              var foldArgs = [];\n              for (var _i = 0; _i < arguments.length; _i++) {\n                foldArgs[_i] = arguments[_i];\n              }\n              if (foldArgs.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n              }\n              var target = foldArgs[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate$7 };\n\n    Adt.generate([\n      {\n        bothErrors: [\n          'error1',\n          'error2'\n        ]\n      },\n      {\n        firstError: [\n          'error1',\n          'value2'\n        ]\n      },\n      {\n        secondError: [\n          'value1',\n          'error2'\n        ]\n      },\n      {\n        bothValues: [\n          'value1',\n          'value2'\n        ]\n      }\n    ]);\n    var partition$1 = function (results) {\n      var errors = [];\n      var values = [];\n      each$1(results, function (result) {\n        result.fold(function (err) {\n          errors.push(err);\n        }, function (value) {\n          values.push(value);\n        });\n      });\n      return {\n        errors: errors,\n        values: values\n      };\n    };\n\n    var exclude$1 = function (obj, fields) {\n      var r = {};\n      each(obj, function (v, k) {\n        if (!contains$2(fields, k)) {\n          r[k] = v;\n        }\n      });\n      return r;\n    };\n\n    var wrap$2 = function (key, value) {\n      var _a;\n      return _a = {}, _a[key] = value, _a;\n    };\n    var wrapAll$1 = function (keyvalues) {\n      var r = {};\n      each$1(keyvalues, function (kv) {\n        r[kv.key] = kv.value;\n      });\n      return r;\n    };\n\n    var exclude = function (obj, fields) {\n      return exclude$1(obj, fields);\n    };\n    var wrap$1 = function (key, value) {\n      return wrap$2(key, value);\n    };\n    var wrapAll = function (keyvalues) {\n      return wrapAll$1(keyvalues);\n    };\n    var mergeValues = function (values, base) {\n      return values.length === 0 ? Result.value(base) : Result.value(deepMerge(base, merge$1.apply(undefined, values)));\n    };\n    var mergeErrors = function (errors) {\n      return Result.error(flatten(errors));\n    };\n    var consolidate = function (objs, base) {\n      var partitions = partition$1(objs);\n      return partitions.errors.length > 0 ? mergeErrors(partitions.errors) : mergeValues(partitions.values, base);\n    };\n\n    var ensureIsRoot = function (isRoot) {\n      return isFunction(isRoot) ? isRoot : never;\n    };\n    var ancestor$2 = function (scope, transform, isRoot) {\n      var element = scope.dom;\n      var stop = ensureIsRoot(isRoot);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        var transformed = transform(el);\n        if (transformed.isSome()) {\n          return transformed;\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest$4 = function (scope, transform, isRoot) {\n      var current = transform(scope);\n      var stop = ensureIsRoot(isRoot);\n      return current.orThunk(function () {\n        return stop(scope) ? Optional.none() : ancestor$2(scope, transform, stop);\n      });\n    };\n\n    var isSource = function (component, simulatedEvent) {\n      return eq(component.element, simulatedEvent.event.target);\n    };\n\n    var defaultEventHandler = {\n      can: always,\n      abort: never,\n      run: noop\n    };\n    var nu$9 = function (parts) {\n      if (!hasNonNullableKey(parts, 'can') && !hasNonNullableKey(parts, 'abort') && !hasNonNullableKey(parts, 'run')) {\n        throw new Error('EventHandler defined by: ' + JSON.stringify(parts, null, 2) + ' does not have can, abort, or run!');\n      }\n      return __assign(__assign({}, defaultEventHandler), parts);\n    };\n    var all$2 = function (handlers, f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return foldl(handlers, function (acc, handler) {\n          return acc && f(handler).apply(undefined, args);\n        }, true);\n      };\n    };\n    var any = function (handlers, f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return foldl(handlers, function (acc, handler) {\n          return acc || f(handler).apply(undefined, args);\n        }, false);\n      };\n    };\n    var read$2 = function (handler) {\n      return isFunction(handler) ? {\n        can: always,\n        abort: never,\n        run: handler\n      } : handler;\n    };\n    var fuse$1 = function (handlers) {\n      var can = all$2(handlers, function (handler) {\n        return handler.can;\n      });\n      var abort = any(handlers, function (handler) {\n        return handler.abort;\n      });\n      var run = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        each$1(handlers, function (handler) {\n          handler.run.apply(undefined, args);\n        });\n      };\n      return {\n        can: can,\n        abort: abort,\n        run: run\n      };\n    };\n\n    var constant = constant$1;\n    var touchstart = constant('touchstart');\n    var touchmove = constant('touchmove');\n    var touchend = constant('touchend');\n    var touchcancel = constant('touchcancel');\n    var mousedown = constant('mousedown');\n    var mousemove = constant('mousemove');\n    var mouseout = constant('mouseout');\n    var mouseup = constant('mouseup');\n    var mouseover = constant('mouseover');\n    var focusin = constant('focusin');\n    var focusout = constant('focusout');\n    var keydown = constant('keydown');\n    var keyup = constant('keyup');\n    var input = constant('input');\n    var change = constant('change');\n    var click = constant('click');\n    var transitioncancel = constant('transitioncancel');\n    var transitionend = constant('transitionend');\n    var transitionstart = constant('transitionstart');\n    var selectstart = constant('selectstart');\n\n    var prefixName = function (name) {\n      return constant$1('alloy.' + name);\n    };\n    var alloy = { tap: prefixName('tap') };\n    var focus$4 = prefixName('focus');\n    var postBlur = prefixName('blur.post');\n    var postPaste = prefixName('paste.post');\n    var receive = prefixName('receive');\n    var execute$5 = prefixName('execute');\n    var focusItem = prefixName('focus.item');\n    var tap = alloy.tap;\n    var longpress = prefixName('longpress');\n    var sandboxClose = prefixName('sandbox.close');\n    var typeaheadCancel = prefixName('typeahead.cancel');\n    var systemInit = prefixName('system.init');\n    var documentTouchmove = prefixName('system.touchmove');\n    var documentTouchend = prefixName('system.touchend');\n    var windowScroll = prefixName('system.scroll');\n    var windowResize = prefixName('system.resize');\n    var attachedToDom = prefixName('system.attached');\n    var detachedFromDom = prefixName('system.detached');\n    var dismissRequested = prefixName('system.dismissRequested');\n    var repositionRequested = prefixName('system.repositionRequested');\n    var focusShifted = prefixName('focusmanager.shifted');\n    var slotVisibility = prefixName('slotcontainer.visibility');\n    var changeTab = prefixName('change.tab');\n    var dismissTab = prefixName('dismiss.tab');\n    var highlight$1 = prefixName('highlight');\n    var dehighlight$1 = prefixName('dehighlight');\n\n    var emit = function (component, event) {\n      dispatchWith(component, component.element, event, {});\n    };\n    var emitWith = function (component, event, properties) {\n      dispatchWith(component, component.element, event, properties);\n    };\n    var emitExecute = function (component) {\n      emit(component, execute$5());\n    };\n    var dispatch = function (component, target, event) {\n      dispatchWith(component, target, event, {});\n    };\n    var dispatchWith = function (component, target, event, properties) {\n      var data = __assign({ target: target }, properties);\n      component.getSystem().triggerEvent(event, target, data);\n    };\n    var dispatchEvent = function (component, target, event, simulatedEvent) {\n      component.getSystem().triggerEvent(event, target, simulatedEvent.event);\n    };\n\n    var derive$2 = function (configs) {\n      return wrapAll(configs);\n    };\n    var abort = function (name, predicate) {\n      return {\n        key: name,\n        value: nu$9({ abort: predicate })\n      };\n    };\n    var can = function (name, predicate) {\n      return {\n        key: name,\n        value: nu$9({ can: predicate })\n      };\n    };\n    var preventDefault = function (name) {\n      return {\n        key: name,\n        value: nu$9({\n          run: function (component, simulatedEvent) {\n            simulatedEvent.event.prevent();\n          }\n        })\n      };\n    };\n    var run$1 = function (name, handler) {\n      return {\n        key: name,\n        value: nu$9({ run: handler })\n      };\n    };\n    var runActionExtra = function (name, action, extra) {\n      return {\n        key: name,\n        value: nu$9({\n          run: function (component, simulatedEvent) {\n            action.apply(undefined, [\n              component,\n              simulatedEvent\n            ].concat(extra));\n          }\n        })\n      };\n    };\n    var runOnName = function (name) {\n      return function (handler) {\n        return run$1(name, handler);\n      };\n    };\n    var runOnSourceName = function (name) {\n      return function (handler) {\n        return {\n          key: name,\n          value: nu$9({\n            run: function (component, simulatedEvent) {\n              if (isSource(component, simulatedEvent)) {\n                handler(component, simulatedEvent);\n              }\n            }\n          })\n        };\n      };\n    };\n    var redirectToUid = function (name, uid) {\n      return run$1(name, function (component, simulatedEvent) {\n        component.getSystem().getByUid(uid).each(function (redirectee) {\n          dispatchEvent(redirectee, redirectee.element, name, simulatedEvent);\n        });\n      });\n    };\n    var redirectToPart = function (name, detail, partName) {\n      var uid = detail.partUids[partName];\n      return redirectToUid(name, uid);\n    };\n    var runWithTarget = function (name, f) {\n      return run$1(name, function (component, simulatedEvent) {\n        var ev = simulatedEvent.event;\n        var target = component.getSystem().getByDom(ev.target).getOrThunk(function () {\n          var closest = closest$4(ev.target, function (el) {\n            return component.getSystem().getByDom(el).toOptional();\n          }, never);\n          return closest.getOr(component);\n        });\n        f(component, target, simulatedEvent);\n      });\n    };\n    var cutter = function (name) {\n      return run$1(name, function (component, simulatedEvent) {\n        simulatedEvent.cut();\n      });\n    };\n    var stopper = function (name) {\n      return run$1(name, function (component, simulatedEvent) {\n        simulatedEvent.stop();\n      });\n    };\n    var runOnSource = function (name, f) {\n      return runOnSourceName(name)(f);\n    };\n    var runOnAttached = runOnSourceName(attachedToDom());\n    var runOnDetached = runOnSourceName(detachedFromDom());\n    var runOnInit = runOnSourceName(systemInit());\n    var runOnExecute$1 = runOnName(execute$5());\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return children(SugarElement.fromDom(div));\n    };\n\n    var get$7 = function (element) {\n      return element.dom.innerHTML;\n    };\n    var set$5 = function (element, content) {\n      var owner = owner$4(element);\n      var docDom = owner.dom;\n      var fragment = SugarElement.fromDom(docDom.createDocumentFragment());\n      var contentElements = fromHtml$1(content, docDom);\n      append$1(fragment, contentElements);\n      empty(element);\n      append$2(element, fragment);\n    };\n    var getOuter = function (element) {\n      var container = SugarElement.fromTag('div');\n      var clone = SugarElement.fromDom(element.dom.cloneNode(true));\n      append$2(container, clone);\n      return get$7(container);\n    };\n\n    var clone$1 = function (original, isDeep) {\n      return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n    };\n    var shallow = function (original) {\n      return clone$1(original, false);\n    };\n\n    var getHtml = function (element) {\n      if (isShadowRoot(element)) {\n        return '#shadow-root';\n      } else {\n        var clone = shallow(element);\n        return getOuter(clone);\n      }\n    };\n\n    var element = function (elem) {\n      return getHtml(elem);\n    };\n\n    var isRecursive = function (component, originator, target) {\n      return eq(originator, component.element) && !eq(originator, target);\n    };\n    var events$i = derive$2([can(focus$4(), function (component, simulatedEvent) {\n        var event = simulatedEvent.event;\n        var originator = event.originator;\n        var target = event.target;\n        if (isRecursive(component, originator, target)) {\n          console.warn(focus$4() + ' did not get interpreted by the desired target. ' + '\\nOriginator: ' + element(originator) + '\\nTarget: ' + element(target) + '\\nCheck the ' + focus$4() + ' event handlers');\n          return false;\n        } else {\n          return true;\n        }\n      })]);\n\n    var DefaultEvents = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$i\n    });\n\n    var unique = 0;\n    var generate$6 = function (prefix) {\n      var date = new Date();\n      var time = date.getTime();\n      var random = Math.floor(Math.random() * 1000000000);\n      unique++;\n      return prefix + '_' + random + unique + String(time);\n    };\n\n    var prefix$1 = constant$1('alloy-id-');\n    var idAttr$1 = constant$1('data-alloy-id');\n\n    var prefix = prefix$1();\n    var idAttr = idAttr$1();\n    var write = function (label, elem) {\n      var id = generate$6(prefix + label);\n      writeOnly(elem, id);\n      return id;\n    };\n    var writeOnly = function (elem, uid) {\n      Object.defineProperty(elem.dom, idAttr, {\n        value: uid,\n        writable: true\n      });\n    };\n    var read$1 = function (elem) {\n      var id = isElement$2(elem) ? elem.dom[idAttr] : null;\n      return Optional.from(id);\n    };\n    var generate$5 = function (prefix) {\n      return generate$6(prefix);\n    };\n\n    var make$8 = identity$1;\n\n    var NoContextApi = function (getComp) {\n      var getMessage = function (event) {\n        return 'The component must be in a context to execute: ' + event + (getComp ? '\\n' + element(getComp().element) + ' is not in context.' : '');\n      };\n      var fail = function (event) {\n        return function () {\n          throw new Error(getMessage(event));\n        };\n      };\n      var warn = function (event) {\n        return function () {\n          console.warn(getMessage(event));\n        };\n      };\n      return {\n        debugInfo: constant$1('fake'),\n        triggerEvent: warn('triggerEvent'),\n        triggerFocus: warn('triggerFocus'),\n        triggerEscape: warn('triggerEscape'),\n        broadcast: warn('broadcast'),\n        broadcastOn: warn('broadcastOn'),\n        broadcastEvent: warn('broadcastEvent'),\n        build: fail('build'),\n        addToWorld: fail('addToWorld'),\n        removeFromWorld: fail('removeFromWorld'),\n        addToGui: fail('addToGui'),\n        removeFromGui: fail('removeFromGui'),\n        getByUid: fail('getByUid'),\n        getByDom: fail('getByDom'),\n        isConnected: never\n      };\n    };\n    var singleton$1 = NoContextApi();\n\n    var markAsBehaviourApi = function (f, apiName, apiFunction) {\n      var delegate = apiFunction.toString();\n      var endIndex = delegate.indexOf(')') + 1;\n      var openBracketIndex = delegate.indexOf('(');\n      var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n      f.toFunctionAnnotation = function () {\n        return {\n          name: apiName,\n          parameters: cleanParameters(parameters.slice(0, 1).concat(parameters.slice(3)))\n        };\n      };\n      return f;\n    };\n    var cleanParameters = function (parameters) {\n      return map$2(parameters, function (p) {\n        return endsWith(p, '/*') ? p.substring(0, p.length - '/*'.length) : p;\n      });\n    };\n    var markAsExtraApi = function (f, extraName) {\n      var delegate = f.toString();\n      var endIndex = delegate.indexOf(')') + 1;\n      var openBracketIndex = delegate.indexOf('(');\n      var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n      f.toFunctionAnnotation = function () {\n        return {\n          name: extraName,\n          parameters: cleanParameters(parameters)\n        };\n      };\n      return f;\n    };\n    var markAsSketchApi = function (f, apiFunction) {\n      var delegate = apiFunction.toString();\n      var endIndex = delegate.indexOf(')') + 1;\n      var openBracketIndex = delegate.indexOf('(');\n      var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n      f.toFunctionAnnotation = function () {\n        return {\n          name: 'OVERRIDE',\n          parameters: cleanParameters(parameters.slice(1))\n        };\n      };\n      return f;\n    };\n\n    var premadeTag = generate$6('alloy-premade');\n    var premade$1 = function (comp) {\n      return wrap$1(premadeTag, comp);\n    };\n    var getPremade = function (spec) {\n      return get$e(spec, premadeTag);\n    };\n    var makeApi = function (f) {\n      return markAsSketchApi(function (component) {\n        var rest = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n          rest[_i - 1] = arguments[_i];\n        }\n        return f.apply(void 0, __spreadArray([\n          component.getApis(),\n          component\n        ], rest, false));\n      }, f);\n    };\n\n    var NoState = {\n      init: function () {\n        return nu$8({ readState: constant$1('No State required') });\n      }\n    };\n    var nu$8 = function (spec) {\n      return spec;\n    };\n\n    var generateFrom$1 = function (spec, all) {\n      var schema = map$2(all, function (a) {\n        return optionObjOf(a.name(), [\n          required$1('config'),\n          defaulted('state', NoState)\n        ]);\n      });\n      var validated = asRaw('component.behaviours', objOf(schema), spec.behaviours).fold(function (errInfo) {\n        throw new Error(formatError(errInfo) + '\\nComplete spec:\\n' + JSON.stringify(spec, null, 2));\n      }, identity$1);\n      return {\n        list: all,\n        data: map$1(validated, function (optBlobThunk) {\n          var output = optBlobThunk.map(function (blob) {\n            return {\n              config: blob.config,\n              state: blob.state.init(blob.config)\n            };\n          });\n          return constant$1(output);\n        })\n      };\n    };\n    var getBehaviours$3 = function (bData) {\n      return bData.list;\n    };\n    var getData$2 = function (bData) {\n      return bData.data;\n    };\n\n    var byInnerKey = function (data, tuple) {\n      var r = {};\n      each(data, function (detail, key) {\n        each(detail, function (value, indexKey) {\n          var chain = get$e(r, indexKey).getOr([]);\n          r[indexKey] = chain.concat([tuple(key, value)]);\n        });\n      });\n      return r;\n    };\n\n    var nu$7 = function (s) {\n      return {\n        classes: isUndefined(s.classes) ? [] : s.classes,\n        attributes: isUndefined(s.attributes) ? {} : s.attributes,\n        styles: isUndefined(s.styles) ? {} : s.styles\n      };\n    };\n    var merge = function (defnA, mod) {\n      return __assign(__assign({}, defnA), {\n        attributes: __assign(__assign({}, defnA.attributes), mod.attributes),\n        styles: __assign(__assign({}, defnA.styles), mod.styles),\n        classes: defnA.classes.concat(mod.classes)\n      });\n    };\n\n    var combine$2 = function (info, baseMod, behaviours, base) {\n      var modsByBehaviour = __assign({}, baseMod);\n      each$1(behaviours, function (behaviour) {\n        modsByBehaviour[behaviour.name()] = behaviour.exhibit(info, base);\n      });\n      var byAspect = byInnerKey(modsByBehaviour, function (name, modification) {\n        return {\n          name: name,\n          modification: modification\n        };\n      });\n      var combineObjects = function (objects) {\n        return foldr(objects, function (b, a) {\n          return __assign(__assign({}, a.modification), b);\n        }, {});\n      };\n      var combinedClasses = foldr(byAspect.classes, function (b, a) {\n        return a.modification.concat(b);\n      }, []);\n      var combinedAttributes = combineObjects(byAspect.attributes);\n      var combinedStyles = combineObjects(byAspect.styles);\n      return nu$7({\n        classes: combinedClasses,\n        attributes: combinedAttributes,\n        styles: combinedStyles\n      });\n    };\n\n    var sortKeys = function (label, keyName, array, order) {\n      try {\n        var sorted = sort(array, function (a, b) {\n          var aKey = a[keyName];\n          var bKey = b[keyName];\n          var aIndex = order.indexOf(aKey);\n          var bIndex = order.indexOf(bKey);\n          if (aIndex === -1) {\n            throw new Error('The ordering for ' + label + ' does not have an entry for ' + aKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n          }\n          if (bIndex === -1) {\n            throw new Error('The ordering for ' + label + ' does not have an entry for ' + bKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n          }\n          if (aIndex < bIndex) {\n            return -1;\n          } else if (bIndex < aIndex) {\n            return 1;\n          } else {\n            return 0;\n          }\n        });\n        return Result.value(sorted);\n      } catch (err) {\n        return Result.error([err]);\n      }\n    };\n\n    var uncurried = function (handler, purpose) {\n      return {\n        handler: handler,\n        purpose: purpose\n      };\n    };\n    var curried = function (handler, purpose) {\n      return {\n        cHandler: handler,\n        purpose: purpose\n      };\n    };\n    var curryArgs = function (descHandler, extraArgs) {\n      return curried(curry.apply(undefined, [descHandler.handler].concat(extraArgs)), descHandler.purpose);\n    };\n    var getCurried = function (descHandler) {\n      return descHandler.cHandler;\n    };\n\n    var behaviourTuple = function (name, handler) {\n      return {\n        name: name,\n        handler: handler\n      };\n    };\n    var nameToHandlers = function (behaviours, info) {\n      var r = {};\n      each$1(behaviours, function (behaviour) {\n        r[behaviour.name()] = behaviour.handlers(info);\n      });\n      return r;\n    };\n    var groupByEvents = function (info, behaviours, base) {\n      var behaviourEvents = __assign(__assign({}, base), nameToHandlers(behaviours, info));\n      return byInnerKey(behaviourEvents, behaviourTuple);\n    };\n    var combine$1 = function (info, eventOrder, behaviours, base) {\n      var byEventName = groupByEvents(info, behaviours, base);\n      return combineGroups(byEventName, eventOrder);\n    };\n    var assemble = function (rawHandler) {\n      var handler = read$2(rawHandler);\n      return function (component, simulatedEvent) {\n        var rest = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n          rest[_i - 2] = arguments[_i];\n        }\n        var args = [\n          component,\n          simulatedEvent\n        ].concat(rest);\n        if (handler.abort.apply(undefined, args)) {\n          simulatedEvent.stop();\n        } else if (handler.can.apply(undefined, args)) {\n          handler.run.apply(undefined, args);\n        }\n      };\n    };\n    var missingOrderError = function (eventName, tuples) {\n      return Result.error(['The event (' + eventName + ') has more than one behaviour that listens to it.\\nWhen this occurs, you must ' + 'specify an event ordering for the behaviours in your spec (e.g. [ \"listing\", \"toggling\" ]).\\nThe behaviours that ' + 'can trigger it are: ' + JSON.stringify(map$2(tuples, function (c) {\n          return c.name;\n        }), null, 2)]);\n    };\n    var fuse = function (tuples, eventOrder, eventName) {\n      var order = eventOrder[eventName];\n      if (!order) {\n        return missingOrderError(eventName, tuples);\n      } else {\n        return sortKeys('Event: ' + eventName, 'name', tuples, order).map(function (sortedTuples) {\n          var handlers = map$2(sortedTuples, function (tuple) {\n            return tuple.handler;\n          });\n          return fuse$1(handlers);\n        });\n      }\n    };\n    var combineGroups = function (byEventName, eventOrder) {\n      var r = mapToArray(byEventName, function (tuples, eventName) {\n        var combined = tuples.length === 1 ? Result.value(tuples[0].handler) : fuse(tuples, eventOrder, eventName);\n        return combined.map(function (handler) {\n          var assembled = assemble(handler);\n          var purpose = tuples.length > 1 ? filter$2(eventOrder[eventName], function (o) {\n            return exists(tuples, function (t) {\n              return t.name === o;\n            });\n          }).join(' > ') : tuples[0].name;\n          return wrap$1(eventName, uncurried(assembled, purpose));\n        });\n      });\n      return consolidate(r, {});\n    };\n\n    var _a$2;\n    var baseBehaviour = 'alloy.base.behaviour';\n    var schema$z = objOf([\n      field$1('dom', 'dom', required$2(), objOf([\n        required$1('tag'),\n        defaulted('styles', {}),\n        defaulted('classes', []),\n        defaulted('attributes', {}),\n        option('value'),\n        option('innerHtml')\n      ])),\n      required$1('components'),\n      required$1('uid'),\n      defaulted('events', {}),\n      defaulted('apis', {}),\n      field$1('eventOrder', 'eventOrder', mergeWith((_a$2 = {}, _a$2[execute$5()] = [\n        'disabling',\n        baseBehaviour,\n        'toggling',\n        'typeaheadevents'\n      ], _a$2[focus$4()] = [\n        baseBehaviour,\n        'focusing',\n        'keying'\n      ], _a$2[systemInit()] = [\n        baseBehaviour,\n        'disabling',\n        'toggling',\n        'representing'\n      ], _a$2[input()] = [\n        baseBehaviour,\n        'representing',\n        'streaming',\n        'invalidating'\n      ], _a$2[detachedFromDom()] = [\n        baseBehaviour,\n        'representing',\n        'item-events',\n        'tooltipping'\n      ], _a$2[mousedown()] = [\n        'focusing',\n        baseBehaviour,\n        'item-type-events'\n      ], _a$2[touchstart()] = [\n        'focusing',\n        baseBehaviour,\n        'item-type-events'\n      ], _a$2[mouseover()] = [\n        'item-type-events',\n        'tooltipping'\n      ], _a$2[receive()] = [\n        'receiving',\n        'reflecting',\n        'tooltipping'\n      ], _a$2)), anyValue()),\n      option('domModification')\n    ]);\n    var toInfo = function (spec) {\n      return asRaw('custom.definition', schema$z, spec);\n    };\n    var toDefinition = function (detail) {\n      return __assign(__assign({}, detail.dom), {\n        uid: detail.uid,\n        domChildren: map$2(detail.components, function (comp) {\n          return comp.element;\n        })\n      });\n    };\n    var toModification = function (detail) {\n      return detail.domModification.fold(function () {\n        return nu$7({});\n      }, nu$7);\n    };\n    var toEvents = function (info) {\n      return info.events;\n    };\n\n    var read = function (element, attr) {\n      var value = get$d(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add$4 = function (element, attr, id) {\n      var old = read(element, attr);\n      var nu = old.concat([id]);\n      set$8(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$4 = function (element, attr, id) {\n      var nu = filter$2(read(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set$8(element, attr, nu.join(' '));\n      } else {\n        remove$7(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom.classList !== undefined;\n    };\n    var get$6 = function (element) {\n      return read(element, 'class');\n    };\n    var add$3 = function (element, clazz) {\n      return add$4(element, 'class', clazz);\n    };\n    var remove$3 = function (element, clazz) {\n      return remove$4(element, 'class', clazz);\n    };\n\n    var add$2 = function (element, clazz) {\n      if (supports(element)) {\n        element.dom.classList.add(clazz);\n      } else {\n        add$3(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom.classList : get$6(element);\n      if (classList.length === 0) {\n        remove$7(element, 'class');\n      }\n    };\n    var remove$2 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom.classList;\n        classList.remove(clazz);\n      } else {\n        remove$3(element, clazz);\n      }\n      cleanClass(element);\n    };\n    var has = function (element, clazz) {\n      return supports(element) && element.dom.classList.contains(clazz);\n    };\n\n    var add$1 = function (element, classes) {\n      each$1(classes, function (x) {\n        add$2(element, x);\n      });\n    };\n    var remove$1 = function (element, classes) {\n      each$1(classes, function (x) {\n        remove$2(element, x);\n      });\n    };\n    var hasAll = function (element, classes) {\n      return forall(classes, function (clazz) {\n        return has(element, clazz);\n      });\n    };\n\n    var get$5 = function (element) {\n      return element.dom.value;\n    };\n    var set$4 = function (element, value) {\n      if (value === undefined) {\n        throw new Error('Value.set was undefined');\n      }\n      element.dom.value = value;\n    };\n\n    var renderToDom = function (definition) {\n      var subject = SugarElement.fromTag(definition.tag);\n      setAll$1(subject, definition.attributes);\n      add$1(subject, definition.classes);\n      setAll(subject, definition.styles);\n      definition.innerHtml.each(function (html) {\n        return set$5(subject, html);\n      });\n      var children = definition.domChildren;\n      append$1(subject, children);\n      definition.value.each(function (value) {\n        set$4(subject, value);\n      });\n      if (!definition.uid) {\n        debugger;\n      }\n      writeOnly(subject, definition.uid);\n      return subject;\n    };\n\n    var getBehaviours$2 = function (spec) {\n      var behaviours = get$e(spec, 'behaviours').getOr({});\n      return bind$3(keys(behaviours), function (name) {\n        var behaviour = behaviours[name];\n        return isNonNullable(behaviour) ? [behaviour.me] : [];\n      });\n    };\n    var generateFrom = function (spec, all) {\n      return generateFrom$1(spec, all);\n    };\n    var generate$4 = function (spec) {\n      var all = getBehaviours$2(spec);\n      return generateFrom(spec, all);\n    };\n\n    var getDomDefinition = function (info, bList, bData) {\n      var definition = toDefinition(info);\n      var infoModification = toModification(info);\n      var baseModification = { 'alloy.base.modification': infoModification };\n      var modification = bList.length > 0 ? combine$2(bData, baseModification, bList, definition) : infoModification;\n      return merge(definition, modification);\n    };\n    var getEvents = function (info, bList, bData) {\n      var baseEvents = { 'alloy.base.behaviour': toEvents(info) };\n      return combine$1(bData, info.eventOrder, bList, baseEvents).getOrDie();\n    };\n    var build$2 = function (spec) {\n      var getMe = function () {\n        return me;\n      };\n      var systemApi = Cell(singleton$1);\n      var info = getOrDie(toInfo(spec));\n      var bBlob = generate$4(spec);\n      var bList = getBehaviours$3(bBlob);\n      var bData = getData$2(bBlob);\n      var modDefinition = getDomDefinition(info, bList, bData);\n      var item = renderToDom(modDefinition);\n      var events = getEvents(info, bList, bData);\n      var subcomponents = Cell(info.components);\n      var connect = function (newApi) {\n        systemApi.set(newApi);\n      };\n      var disconnect = function () {\n        systemApi.set(NoContextApi(getMe));\n      };\n      var syncComponents = function () {\n        var children$1 = children(item);\n        var subs = bind$3(children$1, function (child) {\n          return systemApi.get().getByDom(child).fold(function () {\n            return [];\n          }, pure$2);\n        });\n        subcomponents.set(subs);\n      };\n      var config = function (behaviour) {\n        var b = bData;\n        var f = isFunction(b[behaviour.name()]) ? b[behaviour.name()] : function () {\n          throw new Error('Could not find ' + behaviour.name() + ' in ' + JSON.stringify(spec, null, 2));\n        };\n        return f();\n      };\n      var hasConfigured = function (behaviour) {\n        return isFunction(bData[behaviour.name()]);\n      };\n      var getApis = function () {\n        return info.apis;\n      };\n      var readState = function (behaviourName) {\n        return bData[behaviourName]().map(function (b) {\n          return b.state.readState();\n        }).getOr('not enabled');\n      };\n      var me = {\n        uid: spec.uid,\n        getSystem: systemApi.get,\n        config: config,\n        hasConfigured: hasConfigured,\n        spec: spec,\n        readState: readState,\n        getApis: getApis,\n        connect: connect,\n        disconnect: disconnect,\n        element: item,\n        syncComponents: syncComponents,\n        components: subcomponents.get,\n        events: events\n      };\n      return me;\n    };\n\n    var buildSubcomponents = function (spec) {\n      var components = get$e(spec, 'components').getOr([]);\n      return map$2(components, build$1);\n    };\n    var buildFromSpec = function (userSpec) {\n      var _a = make$8(userSpec), specEvents = _a.events, spec = __rest(_a, ['events']);\n      var components = buildSubcomponents(spec);\n      var completeSpec = __assign(__assign({}, spec), {\n        events: __assign(__assign({}, DefaultEvents), specEvents),\n        components: components\n      });\n      return Result.value(build$2(completeSpec));\n    };\n    var text = function (textContent) {\n      var element = SugarElement.fromText(textContent);\n      return external$2({ element: element });\n    };\n    var external$2 = function (spec) {\n      var extSpec = asRawOrDie$1('external.component', objOfOnly([\n        required$1('element'),\n        option('uid')\n      ]), spec);\n      var systemApi = Cell(NoContextApi());\n      var connect = function (newApi) {\n        systemApi.set(newApi);\n      };\n      var disconnect = function () {\n        systemApi.set(NoContextApi(function () {\n          return me;\n        }));\n      };\n      var uid = extSpec.uid.getOrThunk(function () {\n        return generate$5('external');\n      });\n      writeOnly(extSpec.element, uid);\n      var me = {\n        uid: uid,\n        getSystem: systemApi.get,\n        config: Optional.none,\n        hasConfigured: never,\n        connect: connect,\n        disconnect: disconnect,\n        getApis: function () {\n          return {};\n        },\n        element: extSpec.element,\n        spec: spec,\n        readState: constant$1('No state'),\n        syncComponents: noop,\n        components: constant$1([]),\n        events: {}\n      };\n      return premade$1(me);\n    };\n    var uids = generate$5;\n    var isSketchSpec$1 = function (spec) {\n      return has$2(spec, 'uid');\n    };\n    var build$1 = function (spec) {\n      return getPremade(spec).getOrThunk(function () {\n        var userSpecWithUid = isSketchSpec$1(spec) ? spec : __assign({ uid: uids('') }, spec);\n        return buildFromSpec(userSpecWithUid).getOrDie();\n      });\n    };\n    var premade = premade$1;\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      if (is(scope, a)) {\n        return Optional.some(scope);\n      } else if (isFunction(isRoot) && isRoot(scope)) {\n        return Optional.none();\n      } else {\n        return ancestor(scope, a, isRoot);\n      }\n    }\n\n    var ancestor$1 = function (scope, predicate, isRoot) {\n      var element = scope.dom;\n      var stop = isFunction(isRoot) ? isRoot : never;\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        if (predicate(el)) {\n          return Optional.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest$3 = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor$1, scope, predicate, isRoot);\n    };\n    var child$1 = function (scope, predicate) {\n      var pred = function (node) {\n        return predicate(SugarElement.fromDom(node));\n      };\n      var result = find$5(scope.dom.childNodes, pred);\n      return result.map(SugarElement.fromDom);\n    };\n    var descendant$1 = function (scope, predicate) {\n      var descend = function (node) {\n        for (var i = 0; i < node.childNodes.length; i++) {\n          var child_1 = SugarElement.fromDom(node.childNodes[i]);\n          if (predicate(child_1)) {\n            return Optional.some(child_1);\n          }\n          var res = descend(node.childNodes[i]);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Optional.none();\n      };\n      return descend(scope.dom);\n    };\n\n    var closest$2 = function (scope, predicate, isRoot) {\n      return closest$3(scope, predicate, isRoot).isSome();\n    };\n\n    var ancestor = function (scope, selector, isRoot) {\n      return ancestor$1(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var child = function (scope, selector) {\n      return child$1(scope, function (e) {\n        return is(e, selector);\n      });\n    };\n    var descendant = function (scope, selector) {\n      return one(selector, scope);\n    };\n    var closest$1 = function (scope, selector, isRoot) {\n      var is$1 = function (element, selector) {\n        return is(element, selector);\n      };\n      return ClosestOrAncestor(is$1, ancestor, scope, selector, isRoot);\n    };\n\n    var find$1 = function (queryElem) {\n      var dependent = closest$3(queryElem, function (elem) {\n        if (!isElement$2(elem)) {\n          return false;\n        }\n        var id = get$d(elem, 'id');\n        return id !== undefined && id.indexOf('aria-owns') > -1;\n      });\n      return dependent.bind(function (dep) {\n        var id = get$d(dep, 'id');\n        var dos = getRootNode(dep);\n        return descendant(dos, '[aria-owns=\"' + id + '\"]');\n      });\n    };\n    var manager = function () {\n      var ariaId = generate$6('aria-owns');\n      var link = function (elem) {\n        set$8(elem, 'aria-owns', ariaId);\n      };\n      var unlink = function (elem) {\n        remove$7(elem, 'aria-owns');\n      };\n      return {\n        id: ariaId,\n        link: link,\n        unlink: unlink\n      };\n    };\n\n    var isAriaPartOf = function (component, queryElem) {\n      return find$1(queryElem).exists(function (owner) {\n        return isPartOf$1(component, owner);\n      });\n    };\n    var isPartOf$1 = function (component, queryElem) {\n      return closest$2(queryElem, function (el) {\n        return eq(el, component.element);\n      }, never) || isAriaPartOf(component, queryElem);\n    };\n\n    var unknown = 'unknown';\n    var EventConfiguration;\n    (function (EventConfiguration) {\n      EventConfiguration[EventConfiguration['STOP'] = 0] = 'STOP';\n      EventConfiguration[EventConfiguration['NORMAL'] = 1] = 'NORMAL';\n      EventConfiguration[EventConfiguration['LOGGING'] = 2] = 'LOGGING';\n    }(EventConfiguration || (EventConfiguration = {})));\n    var eventConfig = Cell({});\n    var makeEventLogger = function (eventName, initialTarget) {\n      var sequence = [];\n      var startTime = new Date().getTime();\n      return {\n        logEventCut: function (_name, target, purpose) {\n          sequence.push({\n            outcome: 'cut',\n            target: target,\n            purpose: purpose\n          });\n        },\n        logEventStopped: function (_name, target, purpose) {\n          sequence.push({\n            outcome: 'stopped',\n            target: target,\n            purpose: purpose\n          });\n        },\n        logNoParent: function (_name, target, purpose) {\n          sequence.push({\n            outcome: 'no-parent',\n            target: target,\n            purpose: purpose\n          });\n        },\n        logEventNoHandlers: function (_name, target) {\n          sequence.push({\n            outcome: 'no-handlers-left',\n            target: target\n          });\n        },\n        logEventResponse: function (_name, target, purpose) {\n          sequence.push({\n            outcome: 'response',\n            purpose: purpose,\n            target: target\n          });\n        },\n        write: function () {\n          var finishTime = new Date().getTime();\n          if (contains$2([\n              'mousemove',\n              'mouseover',\n              'mouseout',\n              systemInit()\n            ], eventName)) {\n            return;\n          }\n          console.log(eventName, {\n            event: eventName,\n            time: finishTime - startTime,\n            target: initialTarget.dom,\n            sequence: map$2(sequence, function (s) {\n              if (!contains$2([\n                  'cut',\n                  'stopped',\n                  'response'\n                ], s.outcome)) {\n                return s.outcome;\n              } else {\n                return '{' + s.purpose + '} ' + s.outcome + ' at (' + element(s.target) + ')';\n              }\n            })\n          });\n        }\n      };\n    };\n    var processEvent = function (eventName, initialTarget, f) {\n      var status = get$e(eventConfig.get(), eventName).orThunk(function () {\n        var patterns = keys(eventConfig.get());\n        return findMap(patterns, function (p) {\n          return eventName.indexOf(p) > -1 ? Optional.some(eventConfig.get()[p]) : Optional.none();\n        });\n      }).getOr(EventConfiguration.NORMAL);\n      switch (status) {\n      case EventConfiguration.NORMAL:\n        return f(noLogger());\n      case EventConfiguration.LOGGING: {\n          var logger = makeEventLogger(eventName, initialTarget);\n          var output = f(logger);\n          logger.write();\n          return output;\n        }\n      case EventConfiguration.STOP:\n        return true;\n      }\n    };\n    var path = [\n      'alloy/data/Fields',\n      'alloy/debugging/Debugging'\n    ];\n    var getTrace = function () {\n      var err = new Error();\n      if (err.stack !== undefined) {\n        var lines = err.stack.split('\\n');\n        return find$5(lines, function (line) {\n          return line.indexOf('alloy') > 0 && !exists(path, function (p) {\n            return line.indexOf(p) > -1;\n          });\n        }).getOr(unknown);\n      } else {\n        return unknown;\n      }\n    };\n    var ignoreEvent = {\n      logEventCut: noop,\n      logEventStopped: noop,\n      logNoParent: noop,\n      logEventNoHandlers: noop,\n      logEventResponse: noop,\n      write: noop\n    };\n    var monitorEvent = function (eventName, initialTarget, f) {\n      return processEvent(eventName, initialTarget, f);\n    };\n    var noLogger = constant$1(ignoreEvent);\n\n    var menuFields = constant$1([\n      required$1('menu'),\n      required$1('selectedMenu')\n    ]);\n    var itemFields = constant$1([\n      required$1('item'),\n      required$1('selectedItem')\n    ]);\n    constant$1(objOf(itemFields().concat(menuFields())));\n    var itemSchema$3 = constant$1(objOf(itemFields()));\n\n    var _initSize = requiredObjOf('initSize', [\n      required$1('numColumns'),\n      required$1('numRows')\n    ]);\n    var itemMarkers = function () {\n      return requiredOf('markers', itemSchema$3());\n    };\n    var tieredMenuMarkers = function () {\n      return requiredObjOf('markers', [required$1('backgroundMenu')].concat(menuFields()).concat(itemFields()));\n    };\n    var markers$1 = function (required) {\n      return requiredObjOf('markers', map$2(required, required$1));\n    };\n    var onPresenceHandler = function (label, fieldName, presence) {\n      getTrace();\n      return field$1(fieldName, fieldName, presence, valueOf(function (f) {\n        return Result.value(function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          return f.apply(undefined, args);\n        });\n      }));\n    };\n    var onHandler = function (fieldName) {\n      return onPresenceHandler('onHandler', fieldName, defaulted$1(noop));\n    };\n    var onKeyboardHandler = function (fieldName) {\n      return onPresenceHandler('onKeyboardHandler', fieldName, defaulted$1(Optional.none));\n    };\n    var onStrictHandler = function (fieldName) {\n      return onPresenceHandler('onHandler', fieldName, required$2());\n    };\n    var onStrictKeyboardHandler = function (fieldName) {\n      return onPresenceHandler('onKeyboardHandler', fieldName, required$2());\n    };\n    var output$1 = function (name, value) {\n      return customField(name, constant$1(value));\n    };\n    var snapshot = function (name) {\n      return customField(name, identity$1);\n    };\n    var initSize = constant$1(_initSize);\n\n    var nu$6 = function (x, y, bubble, direction, placement, boundsRestriction, labelPrefix, alwaysFit) {\n      if (alwaysFit === void 0) {\n        alwaysFit = false;\n      }\n      return {\n        x: x,\n        y: y,\n        bubble: bubble,\n        direction: direction,\n        placement: placement,\n        restriction: boundsRestriction,\n        label: labelPrefix + '-' + placement,\n        alwaysFit: alwaysFit\n      };\n    };\n\n    var adt$a = Adt.generate([\n      { southeast: [] },\n      { southwest: [] },\n      { northeast: [] },\n      { northwest: [] },\n      { south: [] },\n      { north: [] },\n      { east: [] },\n      { west: [] }\n    ]);\n    var cata$2 = function (subject, southeast, southwest, northeast, northwest, south, north, east, west) {\n      return subject.fold(southeast, southwest, northeast, northwest, south, north, east, west);\n    };\n    var cataVertical = function (subject, south, middle, north) {\n      return subject.fold(south, south, north, north, south, north, middle, middle);\n    };\n    var cataHorizontal = function (subject, east, middle, west) {\n      return subject.fold(east, west, east, west, middle, middle, east, west);\n    };\n    var southeast$3 = adt$a.southeast;\n    var southwest$3 = adt$a.southwest;\n    var northeast$3 = adt$a.northeast;\n    var northwest$3 = adt$a.northwest;\n    var south$3 = adt$a.south;\n    var north$3 = adt$a.north;\n    var east$3 = adt$a.east;\n    var west$3 = adt$a.west;\n\n    var cycleBy = function (value, delta, min, max) {\n      var r = value + delta;\n      if (r > max) {\n        return min;\n      } else if (r < min) {\n        return max;\n      } else {\n        return r;\n      }\n    };\n    var clamp$1 = function (value, min, max) {\n      return Math.min(Math.max(value, min), max);\n    };\n\n    var getRestriction = function (anchor, restriction) {\n      switch (restriction) {\n      case 1:\n        return anchor.x;\n      case 0:\n        return anchor.x + anchor.width;\n      case 2:\n        return anchor.y;\n      case 3:\n        return anchor.y + anchor.height;\n      }\n    };\n    var boundsRestriction = function (anchor, restrictions) {\n      return mapToObject([\n        'left',\n        'right',\n        'top',\n        'bottom'\n      ], function (dir) {\n        return get$e(restrictions, dir).map(function (restriction) {\n          return getRestriction(anchor, restriction);\n        });\n      });\n    };\n    var adjustBounds = function (bounds$1, restriction, bubbleOffset) {\n      var applyRestriction = function (dir, current) {\n        return restriction[dir].map(function (pos) {\n          var isVerticalAxis = dir === 'top' || dir === 'bottom';\n          var offset = isVerticalAxis ? bubbleOffset.top : bubbleOffset.left;\n          var comparator = dir === 'left' || dir === 'top' ? Math.max : Math.min;\n          var newPos = comparator(pos, current) + offset;\n          return isVerticalAxis ? clamp$1(newPos, bounds$1.y, bounds$1.bottom) : clamp$1(newPos, bounds$1.x, bounds$1.right);\n        }).getOr(current);\n      };\n      var adjustedLeft = applyRestriction('left', bounds$1.x);\n      var adjustedTop = applyRestriction('top', bounds$1.y);\n      var adjustedRight = applyRestriction('right', bounds$1.right);\n      var adjustedBottom = applyRestriction('bottom', bounds$1.bottom);\n      return bounds(adjustedLeft, adjustedTop, adjustedRight - adjustedLeft, adjustedBottom - adjustedTop);\n    };\n\n    var labelPrefix$2 = 'layout';\n    var eastX$1 = function (anchor) {\n      return anchor.x;\n    };\n    var middleX$1 = function (anchor, element) {\n      return anchor.x + anchor.width / 2 - element.width / 2;\n    };\n    var westX$1 = function (anchor, element) {\n      return anchor.x + anchor.width - element.width;\n    };\n    var northY$2 = function (anchor, element) {\n      return anchor.y - element.height;\n    };\n    var southY$2 = function (anchor) {\n      return anchor.y + anchor.height;\n    };\n    var centreY$1 = function (anchor, element) {\n      return anchor.y + anchor.height / 2 - element.height / 2;\n    };\n    var eastEdgeX$1 = function (anchor) {\n      return anchor.x + anchor.width;\n    };\n    var westEdgeX$1 = function (anchor, element) {\n      return anchor.x - element.width;\n    };\n    var southeast$2 = function (anchor, element, bubbles) {\n      return nu$6(eastX$1(anchor), southY$2(anchor), bubbles.southeast(), southeast$3(), 'southeast', boundsRestriction(anchor, {\n        left: 1,\n        top: 3\n      }), labelPrefix$2);\n    };\n    var southwest$2 = function (anchor, element, bubbles) {\n      return nu$6(westX$1(anchor, element), southY$2(anchor), bubbles.southwest(), southwest$3(), 'southwest', boundsRestriction(anchor, {\n        right: 0,\n        top: 3\n      }), labelPrefix$2);\n    };\n    var northeast$2 = function (anchor, element, bubbles) {\n      return nu$6(eastX$1(anchor), northY$2(anchor, element), bubbles.northeast(), northeast$3(), 'northeast', boundsRestriction(anchor, {\n        left: 1,\n        bottom: 2\n      }), labelPrefix$2);\n    };\n    var northwest$2 = function (anchor, element, bubbles) {\n      return nu$6(westX$1(anchor, element), northY$2(anchor, element), bubbles.northwest(), northwest$3(), 'northwest', boundsRestriction(anchor, {\n        right: 0,\n        bottom: 2\n      }), labelPrefix$2);\n    };\n    var north$2 = function (anchor, element, bubbles) {\n      return nu$6(middleX$1(anchor, element), northY$2(anchor, element), bubbles.north(), north$3(), 'north', boundsRestriction(anchor, { bottom: 2 }), labelPrefix$2);\n    };\n    var south$2 = function (anchor, element, bubbles) {\n      return nu$6(middleX$1(anchor, element), southY$2(anchor), bubbles.south(), south$3(), 'south', boundsRestriction(anchor, { top: 3 }), labelPrefix$2);\n    };\n    var east$2 = function (anchor, element, bubbles) {\n      return nu$6(eastEdgeX$1(anchor), centreY$1(anchor, element), bubbles.east(), east$3(), 'east', boundsRestriction(anchor, { left: 0 }), labelPrefix$2);\n    };\n    var west$2 = function (anchor, element, bubbles) {\n      return nu$6(westEdgeX$1(anchor, element), centreY$1(anchor, element), bubbles.west(), west$3(), 'west', boundsRestriction(anchor, { right: 1 }), labelPrefix$2);\n    };\n    var all$1 = function () {\n      return [\n        southeast$2,\n        southwest$2,\n        northeast$2,\n        northwest$2,\n        south$2,\n        north$2,\n        east$2,\n        west$2\n      ];\n    };\n    var allRtl$1 = function () {\n      return [\n        southwest$2,\n        southeast$2,\n        northwest$2,\n        northeast$2,\n        south$2,\n        north$2,\n        east$2,\n        west$2\n      ];\n    };\n    var aboveOrBelow = function () {\n      return [\n        northeast$2,\n        northwest$2,\n        southeast$2,\n        southwest$2,\n        north$2,\n        south$2\n      ];\n    };\n    var aboveOrBelowRtl = function () {\n      return [\n        northwest$2,\n        northeast$2,\n        southwest$2,\n        southeast$2,\n        north$2,\n        south$2\n      ];\n    };\n    var belowOrAbove = function () {\n      return [\n        southeast$2,\n        southwest$2,\n        northeast$2,\n        northwest$2,\n        south$2,\n        north$2\n      ];\n    };\n    var belowOrAboveRtl = function () {\n      return [\n        southwest$2,\n        southeast$2,\n        northwest$2,\n        northeast$2,\n        south$2,\n        north$2\n      ];\n    };\n\n    var chooseChannels = function (channels, message) {\n      return message.universal ? channels : filter$2(channels, function (ch) {\n        return contains$2(message.channels, ch);\n      });\n    };\n    var events$h = function (receiveConfig) {\n      return derive$2([run$1(receive(), function (component, message) {\n          var channelMap = receiveConfig.channels;\n          var channels = keys(channelMap);\n          var receivingData = message;\n          var targetChannels = chooseChannels(channels, receivingData);\n          each$1(targetChannels, function (ch) {\n            var channelInfo = channelMap[ch];\n            var channelSchema = channelInfo.schema;\n            var data = asRawOrDie$1('channel[' + ch + '] data\\nReceiver: ' + element(component.element), channelSchema, receivingData.data);\n            channelInfo.onReceive(component, data);\n          });\n        })]);\n    };\n\n    var ActiveReceiving = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$h\n    });\n\n    var ReceivingSchema = [requiredOf('channels', setOf(Result.value, objOfOnly([\n        onStrictHandler('onReceive'),\n        defaulted('schema', anyValue())\n      ])))];\n\n    var executeEvent = function (bConfig, bState, executor) {\n      return runOnExecute$1(function (component) {\n        executor(component, bConfig, bState);\n      });\n    };\n    var loadEvent = function (bConfig, bState, f) {\n      return runOnInit(function (component, _simulatedEvent) {\n        f(component, bConfig, bState);\n      });\n    };\n    var create$8 = function (schema, name, active, apis, extra, state) {\n      var configSchema = objOfOnly(schema);\n      var schemaSchema = optionObjOf(name, [optionObjOfOnly('config', schema)]);\n      return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n    };\n    var createModes$1 = function (modes, name, active, apis, extra, state) {\n      var configSchema = modes;\n      var schemaSchema = optionObjOf(name, [optionOf('config', modes)]);\n      return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n    };\n    var wrapApi = function (bName, apiFunction, apiName) {\n      var f = function (component) {\n        var rest = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n          rest[_i - 1] = arguments[_i];\n        }\n        var args = [component].concat(rest);\n        return component.config({ name: constant$1(bName) }).fold(function () {\n          throw new Error('We could not find any behaviour configuration for: ' + bName + '. Using API: ' + apiName);\n        }, function (info) {\n          var rest = Array.prototype.slice.call(args, 1);\n          return apiFunction.apply(undefined, [\n            component,\n            info.config,\n            info.state\n          ].concat(rest));\n        });\n      };\n      return markAsBehaviourApi(f, apiName, apiFunction);\n    };\n    var revokeBehaviour = function (name) {\n      return {\n        key: name,\n        value: undefined\n      };\n    };\n    var doCreate = function (configSchema, schemaSchema, name, active, apis, extra, state) {\n      var getConfig = function (info) {\n        return hasNonNullableKey(info, name) ? info[name]() : Optional.none();\n      };\n      var wrappedApis = map$1(apis, function (apiF, apiName) {\n        return wrapApi(name, apiF, apiName);\n      });\n      var wrappedExtra = map$1(extra, function (extraF, extraName) {\n        return markAsExtraApi(extraF, extraName);\n      });\n      var me = __assign(__assign(__assign({}, wrappedExtra), wrappedApis), {\n        revoke: curry(revokeBehaviour, name),\n        config: function (spec) {\n          var prepared = asRawOrDie$1(name + '-config', configSchema, spec);\n          return {\n            key: name,\n            value: {\n              config: prepared,\n              me: me,\n              configAsRaw: cached(function () {\n                return asRawOrDie$1(name + '-config', configSchema, spec);\n              }),\n              initialConfig: spec,\n              state: state\n            }\n          };\n        },\n        schema: constant$1(schemaSchema),\n        exhibit: function (info, base) {\n          return lift2(getConfig(info), get$e(active, 'exhibit'), function (behaviourInfo, exhibitor) {\n            return exhibitor(base, behaviourInfo.config, behaviourInfo.state);\n          }).getOrThunk(function () {\n            return nu$7({});\n          });\n        },\n        name: constant$1(name),\n        handlers: function (info) {\n          return getConfig(info).map(function (behaviourInfo) {\n            var getEvents = get$e(active, 'events').getOr(function () {\n              return {};\n            });\n            return getEvents(behaviourInfo.config, behaviourInfo.state);\n          }).getOr({});\n        }\n      });\n      return me;\n    };\n\n    var derive$1 = function (capabilities) {\n      return wrapAll(capabilities);\n    };\n    var simpleSchema = objOfOnly([\n      required$1('fields'),\n      required$1('name'),\n      defaulted('active', {}),\n      defaulted('apis', {}),\n      defaulted('state', NoState),\n      defaulted('extra', {})\n    ]);\n    var create$7 = function (data) {\n      var value = asRawOrDie$1('Creating behaviour: ' + data.name, simpleSchema, data);\n      return create$8(value.fields, value.name, value.active, value.apis, value.extra, value.state);\n    };\n    var modeSchema = objOfOnly([\n      required$1('branchKey'),\n      required$1('branches'),\n      required$1('name'),\n      defaulted('active', {}),\n      defaulted('apis', {}),\n      defaulted('state', NoState),\n      defaulted('extra', {})\n    ]);\n    var createModes = function (data) {\n      var value = asRawOrDie$1('Creating behaviour: ' + data.name, modeSchema, data);\n      return createModes$1(choose$1(value.branchKey, value.branches), value.name, value.active, value.apis, value.extra, value.state);\n    };\n    var revoke = constant$1(undefined);\n\n    var Receiving = create$7({\n      fields: ReceivingSchema,\n      name: 'receiving',\n      active: ActiveReceiving\n    });\n\n    var exhibit$6 = function (base, posConfig) {\n      return nu$7({\n        classes: [],\n        styles: posConfig.useFixed() ? {} : { position: 'relative' }\n      });\n    };\n\n    var ActivePosition = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$6\n    });\n\n    var getDocument = function () {\n      return SugarElement.fromDom(document);\n    };\n\n    var focus$3 = function (element) {\n      return element.dom.focus();\n    };\n    var blur$1 = function (element) {\n      return element.dom.blur();\n    };\n    var hasFocus = function (element) {\n      var root = getRootNode(element).dom;\n      return element.dom === root.activeElement;\n    };\n    var active = function (root) {\n      if (root === void 0) {\n        root = getDocument();\n      }\n      return Optional.from(root.dom.activeElement).map(SugarElement.fromDom);\n    };\n    var search = function (element) {\n      return active(getRootNode(element)).filter(function (e) {\n        return element.dom.contains(e.dom);\n      });\n    };\n\n    var preserve$1 = function (f, container) {\n      var dos = getRootNode(container);\n      var refocus = active(dos).bind(function (focused) {\n        var hasFocus = function (elem) {\n          return eq(focused, elem);\n        };\n        return hasFocus(container) ? Optional.some(container) : descendant$1(container, hasFocus);\n      });\n      var result = f(container);\n      refocus.each(function (oldFocus) {\n        active(dos).filter(function (newFocus) {\n          return eq(newFocus, oldFocus);\n        }).fold(function () {\n          focus$3(oldFocus);\n        }, noop);\n      });\n      return result;\n    };\n\n    var NuPositionCss = function (position, left, top, right, bottom) {\n      var toPx = function (num) {\n        return num + 'px';\n      };\n      return {\n        position: position,\n        left: left.map(toPx),\n        top: top.map(toPx),\n        right: right.map(toPx),\n        bottom: bottom.map(toPx)\n      };\n    };\n    var toOptions = function (position) {\n      return __assign(__assign({}, position), { position: Optional.some(position.position) });\n    };\n    var applyPositionCss = function (element, position) {\n      setOptions(element, toOptions(position));\n    };\n\n    var adt$9 = Adt.generate([\n      { none: [] },\n      {\n        relative: [\n          'x',\n          'y',\n          'width',\n          'height'\n        ]\n      },\n      {\n        fixed: [\n          'x',\n          'y',\n          'width',\n          'height'\n        ]\n      }\n    ]);\n    var positionWithDirection = function (posName, decision, x, y, width, height) {\n      var decisionRect = decision.rect;\n      var decisionX = decisionRect.x - x;\n      var decisionY = decisionRect.y - y;\n      var decisionWidth = decisionRect.width;\n      var decisionHeight = decisionRect.height;\n      var decisionRight = width - (decisionX + decisionWidth);\n      var decisionBottom = height - (decisionY + decisionHeight);\n      var left = Optional.some(decisionX);\n      var top = Optional.some(decisionY);\n      var right = Optional.some(decisionRight);\n      var bottom = Optional.some(decisionBottom);\n      var none = Optional.none();\n      return cata$2(decision.direction, function () {\n        return NuPositionCss(posName, left, top, none, none);\n      }, function () {\n        return NuPositionCss(posName, none, top, right, none);\n      }, function () {\n        return NuPositionCss(posName, left, none, none, bottom);\n      }, function () {\n        return NuPositionCss(posName, none, none, right, bottom);\n      }, function () {\n        return NuPositionCss(posName, left, top, none, none);\n      }, function () {\n        return NuPositionCss(posName, left, none, none, bottom);\n      }, function () {\n        return NuPositionCss(posName, left, top, none, none);\n      }, function () {\n        return NuPositionCss(posName, none, top, right, none);\n      });\n    };\n    var reposition = function (origin, decision) {\n      return origin.fold(function () {\n        var decisionRect = decision.rect;\n        return NuPositionCss('absolute', Optional.some(decisionRect.x), Optional.some(decisionRect.y), Optional.none(), Optional.none());\n      }, function (x, y, width, height) {\n        return positionWithDirection('absolute', decision, x, y, width, height);\n      }, function (x, y, width, height) {\n        return positionWithDirection('fixed', decision, x, y, width, height);\n      });\n    };\n    var toBox = function (origin, element) {\n      var rel = curry(find$2, element);\n      var position = origin.fold(rel, rel, function () {\n        var scroll = get$9();\n        return find$2(element).translate(-scroll.left, -scroll.top);\n      });\n      var width = getOuter$1(element);\n      var height = getOuter$2(element);\n      return bounds(position.left, position.top, width, height);\n    };\n    var viewport = function (origin, getBounds) {\n      return getBounds.fold(function () {\n        return origin.fold(win, win, bounds);\n      }, function (b) {\n        return origin.fold(b, b, function () {\n          var bounds$1 = b();\n          var pos = translate$2(origin, bounds$1.x, bounds$1.y);\n          return bounds(pos.left, pos.top, bounds$1.width, bounds$1.height);\n        });\n      });\n    };\n    var translate$2 = function (origin, x, y) {\n      var pos = SugarPosition(x, y);\n      var removeScroll = function () {\n        var outerScroll = get$9();\n        return pos.translate(-outerScroll.left, -outerScroll.top);\n      };\n      return origin.fold(constant$1(pos), constant$1(pos), removeScroll);\n    };\n    var cata$1 = function (subject, onNone, onRelative, onFixed) {\n      return subject.fold(onNone, onRelative, onFixed);\n    };\n    adt$9.none;\n    var relative$1 = adt$9.relative;\n    var fixed$1 = adt$9.fixed;\n\n    var anchor = function (anchorBox, origin) {\n      return {\n        anchorBox: anchorBox,\n        origin: origin\n      };\n    };\n    var box = function (anchorBox, origin) {\n      return anchor(anchorBox, origin);\n    };\n\n    var placementAttribute = 'data-alloy-placement';\n    var setPlacement$1 = function (element, placement) {\n      set$8(element, placementAttribute, placement);\n    };\n    var getPlacement = function (element) {\n      return getOpt(element, placementAttribute);\n    };\n    var reset$2 = function (element) {\n      return remove$7(element, placementAttribute);\n    };\n\n    var adt$8 = Adt.generate([\n      { fit: ['reposition'] },\n      {\n        nofit: [\n          'reposition',\n          'visibleW',\n          'visibleH',\n          'isVisible'\n        ]\n      }\n    ]);\n    var determinePosition = function (box, bounds) {\n      var boundsX = bounds.x, boundsY = bounds.y, boundsRight = bounds.right, boundsBottom = bounds.bottom;\n      var x = box.x, y = box.y, right = box.right, bottom = box.bottom, width = box.width, height = box.height;\n      var xInBounds = x >= boundsX && x <= boundsRight;\n      var yInBounds = y >= boundsY && y <= boundsBottom;\n      var originInBounds = xInBounds && yInBounds;\n      var rightInBounds = right <= boundsRight && right >= boundsX;\n      var bottomInBounds = bottom <= boundsBottom && bottom >= boundsY;\n      var sizeInBounds = rightInBounds && bottomInBounds;\n      var visibleW = Math.min(width, x >= boundsX ? boundsRight - x : right - boundsX);\n      var visibleH = Math.min(height, y >= boundsY ? boundsBottom - y : bottom - boundsY);\n      return {\n        originInBounds: originInBounds,\n        sizeInBounds: sizeInBounds,\n        visibleW: visibleW,\n        visibleH: visibleH\n      };\n    };\n    var calcReposition = function (box, bounds$1) {\n      var boundsX = bounds$1.x, boundsY = bounds$1.y, boundsRight = bounds$1.right, boundsBottom = bounds$1.bottom;\n      var x = box.x, y = box.y, width = box.width, height = box.height;\n      var maxX = Math.max(boundsX, boundsRight - width);\n      var maxY = Math.max(boundsY, boundsBottom - height);\n      var restrictedX = clamp$1(x, boundsX, maxX);\n      var restrictedY = clamp$1(y, boundsY, maxY);\n      var restrictedWidth = Math.min(restrictedX + width, boundsRight) - restrictedX;\n      var restrictedHeight = Math.min(restrictedY + height, boundsBottom) - restrictedY;\n      return bounds(restrictedX, restrictedY, restrictedWidth, restrictedHeight);\n    };\n    var calcMaxSizes = function (direction, box, bounds) {\n      var upAvailable = constant$1(box.bottom - bounds.y);\n      var downAvailable = constant$1(bounds.bottom - box.y);\n      var maxHeight = cataVertical(direction, downAvailable, downAvailable, upAvailable);\n      var westAvailable = constant$1(box.right - bounds.x);\n      var eastAvailable = constant$1(bounds.right - box.x);\n      var maxWidth = cataHorizontal(direction, eastAvailable, eastAvailable, westAvailable);\n      return {\n        maxWidth: maxWidth,\n        maxHeight: maxHeight\n      };\n    };\n    var attempt = function (candidate, width, height, bounds$1) {\n      var bubble = candidate.bubble;\n      var bubbleOffset = bubble.offset;\n      var adjustedBounds = adjustBounds(bounds$1, candidate.restriction, bubbleOffset);\n      var newX = candidate.x + bubbleOffset.left;\n      var newY = candidate.y + bubbleOffset.top;\n      var box = bounds(newX, newY, width, height);\n      var _a = determinePosition(box, adjustedBounds), originInBounds = _a.originInBounds, sizeInBounds = _a.sizeInBounds, visibleW = _a.visibleW, visibleH = _a.visibleH;\n      var fits = originInBounds && sizeInBounds;\n      var fittedBox = fits ? box : calcReposition(box, adjustedBounds);\n      var isPartlyVisible = fittedBox.width > 0 && fittedBox.height > 0;\n      var _b = calcMaxSizes(candidate.direction, fittedBox, bounds$1), maxWidth = _b.maxWidth, maxHeight = _b.maxHeight;\n      var reposition = {\n        rect: fittedBox,\n        maxHeight: maxHeight,\n        maxWidth: maxWidth,\n        direction: candidate.direction,\n        placement: candidate.placement,\n        classes: {\n          on: bubble.classesOn,\n          off: bubble.classesOff\n        },\n        layout: candidate.label,\n        testY: newY\n      };\n      return fits || candidate.alwaysFit ? adt$8.fit(reposition) : adt$8.nofit(reposition, visibleW, visibleH, isPartlyVisible);\n    };\n    var attempts = function (element, candidates, anchorBox, elementBox, bubbles, bounds) {\n      var panelWidth = elementBox.width;\n      var panelHeight = elementBox.height;\n      var attemptBestFit = function (layout, reposition, visibleW, visibleH, isVisible) {\n        var next = layout(anchorBox, elementBox, bubbles, element, bounds);\n        var attemptLayout = attempt(next, panelWidth, panelHeight, bounds);\n        return attemptLayout.fold(constant$1(attemptLayout), function (newReposition, newVisibleW, newVisibleH, newIsVisible) {\n          var improved = isVisible === newIsVisible ? newVisibleH > visibleH || newVisibleW > visibleW : !isVisible && newIsVisible;\n          return improved ? attemptLayout : adt$8.nofit(reposition, visibleW, visibleH, isVisible);\n        });\n      };\n      var abc = foldl(candidates, function (b, a) {\n        var bestNext = curry(attemptBestFit, a);\n        return b.fold(constant$1(b), bestNext);\n      }, adt$8.nofit({\n        rect: anchorBox,\n        maxHeight: elementBox.height,\n        maxWidth: elementBox.width,\n        direction: southeast$3(),\n        placement: 'southeast',\n        classes: {\n          on: [],\n          off: []\n        },\n        layout: 'none',\n        testY: anchorBox.y\n      }, -1, -1, false));\n      return abc.fold(identity$1, identity$1);\n    };\n\n    var singleton = function (doRevoke) {\n      var subject = Cell(Optional.none());\n      var revoke = function () {\n        return subject.get().each(doRevoke);\n      };\n      var clear = function () {\n        revoke();\n        subject.set(Optional.none());\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      var get = function () {\n        return subject.get();\n      };\n      var set = function (s) {\n        revoke();\n        subject.set(Optional.some(s));\n      };\n      return {\n        clear: clear,\n        isSet: isSet,\n        get: get,\n        set: set\n      };\n    };\n    var destroyable = function () {\n      return singleton(function (s) {\n        return s.destroy();\n      });\n    };\n    var unbindable = function () {\n      return singleton(function (s) {\n        return s.unbind();\n      });\n    };\n    var api$1 = function () {\n      var subject = destroyable();\n      var run = function (f) {\n        return subject.get().each(f);\n      };\n      return __assign(__assign({}, subject), { run: run });\n    };\n    var value$1 = function () {\n      var subject = singleton(noop);\n      var on = function (f) {\n        return subject.get().each(f);\n      };\n      return __assign(__assign({}, subject), { on: on });\n    };\n\n    var filter = always;\n    var bind = function (element, event, handler) {\n      return bind$2(element, event, filter, handler);\n    };\n    var capture = function (element, event, handler) {\n      return capture$1(element, event, filter, handler);\n    };\n    var fromRawEvent = fromRawEvent$1;\n\n    var properties = [\n      'top',\n      'bottom',\n      'right',\n      'left'\n    ];\n    var timerAttr = 'data-alloy-transition-timer';\n    var isTransitioning$1 = function (element, transition) {\n      return hasAll(element, transition.classes);\n    };\n    var shouldApplyTransitionCss = function (transition, decision, lastPlacement) {\n      return lastPlacement.exists(function (placer) {\n        var mode = transition.mode;\n        return mode === 'all' ? true : placer[mode] !== decision[mode];\n      });\n    };\n    var hasChanges = function (position, intermediate) {\n      var round = function (value) {\n        return parseFloat(value).toFixed(3);\n      };\n      return find$4(intermediate, function (value, key) {\n        var newValue = position[key].map(round);\n        var val = value.map(round);\n        return !equals(newValue, val);\n      }).isSome();\n    };\n    var getTransitionDuration = function (element) {\n      var get = function (name) {\n        var style = get$c(element, name);\n        var times = isString(style) ? style.split(/\\s*,\\s*/) : [];\n        return filter$2(times, isNotEmpty);\n      };\n      var parse = function (value) {\n        if (isString(value) && /^[\\d.]+/.test(value)) {\n          var num = parseFloat(value);\n          return endsWith(value, 'ms') ? num : num * 1000;\n        } else {\n          return 0;\n        }\n      };\n      var delay = get('transition-delay');\n      var duration = get('transition-duration');\n      return foldl(duration, function (acc, dur, i) {\n        var time = parse(delay[i]) + parse(dur);\n        return Math.max(acc, time);\n      }, 0);\n    };\n    var setupTransitionListeners = function (element, transition) {\n      var transitionEnd = unbindable();\n      var transitionCancel = unbindable();\n      var timer;\n      var isSourceTransition = function (e) {\n        var _a;\n        var pseudoElement = (_a = e.raw.pseudoElement) !== null && _a !== void 0 ? _a : '';\n        return eq(e.target, element) && isEmpty(pseudoElement) && contains$2(properties, e.raw.propertyName);\n      };\n      var transitionDone = function (e) {\n        if (isNullable(e) || isSourceTransition(e)) {\n          transitionEnd.clear();\n          transitionCancel.clear();\n          var type = e === null || e === void 0 ? void 0 : e.raw.type;\n          if (isNullable(type) || type === transitionend()) {\n            clearTimeout(timer);\n            remove$7(element, timerAttr);\n            remove$1(element, transition.classes);\n          }\n        }\n      };\n      var transitionStarted = function () {\n        transitionEnd.set(bind(element, transitionend(), transitionDone));\n        transitionCancel.set(bind(element, transitioncancel(), transitionDone));\n      };\n      if ('ontransitionstart' in element.dom) {\n        var transitionStart_1 = bind(element, transitionstart(), function (e) {\n          if (isSourceTransition(e)) {\n            transitionStart_1.unbind();\n            transitionStarted();\n          }\n        });\n      } else {\n        transitionStarted();\n      }\n      var duration = getTransitionDuration(element);\n      requestAnimationFrame(function () {\n        timer = setTimeout(transitionDone, duration + 17);\n        set$8(element, timerAttr, timer);\n      });\n    };\n    var startTransitioning = function (element, transition) {\n      add$1(element, transition.classes);\n      getOpt(element, timerAttr).each(function (timerId) {\n        clearTimeout(parseInt(timerId, 10));\n        remove$7(element, timerAttr);\n      });\n      setupTransitionListeners(element, transition);\n    };\n    var applyTransitionCss = function (element, origin, position, transition, decision, lastPlacement) {\n      var shouldTransition = shouldApplyTransitionCss(transition, decision, lastPlacement);\n      if (shouldTransition || isTransitioning$1(element, transition)) {\n        set$7(element, 'position', position.position);\n        var rect = toBox(origin, element);\n        var intermediatePosition_1 = reposition(origin, __assign(__assign({}, decision), { rect: rect }));\n        var intermediateCssOptions = mapToObject(properties, function (prop) {\n          return intermediatePosition_1[prop];\n        });\n        if (hasChanges(position, intermediateCssOptions)) {\n          setOptions(element, intermediateCssOptions);\n          if (shouldTransition) {\n            startTransitioning(element, transition);\n          }\n          reflow(element);\n        }\n      } else {\n        remove$1(element, transition.classes);\n      }\n    };\n\n    var elementSize = function (p) {\n      return {\n        width: getOuter$1(p),\n        height: getOuter$2(p)\n      };\n    };\n    var layout = function (anchorBox, element, bubbles, options) {\n      remove$6(element, 'max-height');\n      remove$6(element, 'max-width');\n      var elementBox = elementSize(element);\n      return attempts(element, options.preference, anchorBox, elementBox, bubbles, options.bounds);\n    };\n    var setClasses = function (element, decision) {\n      var classInfo = decision.classes;\n      remove$1(element, classInfo.off);\n      add$1(element, classInfo.on);\n    };\n    var setHeight = function (element, decision, options) {\n      var maxHeightFunction = options.maxHeightFunction;\n      maxHeightFunction(element, decision.maxHeight);\n    };\n    var setWidth = function (element, decision, options) {\n      var maxWidthFunction = options.maxWidthFunction;\n      maxWidthFunction(element, decision.maxWidth);\n    };\n    var position$2 = function (element, decision, options) {\n      var positionCss = reposition(options.origin, decision);\n      options.transition.each(function (transition) {\n        applyTransitionCss(element, options.origin, positionCss, transition, decision, options.lastPlacement);\n      });\n      applyPositionCss(element, positionCss);\n    };\n    var setPlacement = function (element, decision) {\n      setPlacement$1(element, decision.placement);\n    };\n\n    var setMaxHeight = function (element, maxHeight) {\n      setMax$1(element, Math.floor(maxHeight));\n    };\n    var anchored = constant$1(function (element, available) {\n      setMaxHeight(element, available);\n      setAll(element, {\n        'overflow-x': 'hidden',\n        'overflow-y': 'auto'\n      });\n    });\n    var expandable$1 = constant$1(function (element, available) {\n      setMaxHeight(element, available);\n    });\n\n    var defaultOr = function (options, key, dephault) {\n      return options[key] === undefined ? dephault : options[key];\n    };\n    var simple = function (anchor, element, bubble, layouts, lastPlacement, getBounds, overrideOptions, transition) {\n      var maxHeightFunction = defaultOr(overrideOptions, 'maxHeightFunction', anchored());\n      var maxWidthFunction = defaultOr(overrideOptions, 'maxWidthFunction', noop);\n      var anchorBox = anchor.anchorBox;\n      var origin = anchor.origin;\n      var options = {\n        bounds: viewport(origin, getBounds),\n        origin: origin,\n        preference: layouts,\n        maxHeightFunction: maxHeightFunction,\n        maxWidthFunction: maxWidthFunction,\n        lastPlacement: lastPlacement,\n        transition: transition\n      };\n      return go(anchorBox, element, bubble, options);\n    };\n    var go = function (anchorBox, element, bubble, options) {\n      var decision = layout(anchorBox, element, bubble, options);\n      position$2(element, decision, options);\n      setPlacement(element, decision);\n      setClasses(element, decision);\n      setHeight(element, decision, options);\n      setWidth(element, decision, options);\n      return {\n        layout: decision.layout,\n        placement: decision.placement\n      };\n    };\n\n    var allAlignments = [\n      'valignCentre',\n      'alignLeft',\n      'alignRight',\n      'alignCentre',\n      'top',\n      'bottom',\n      'left',\n      'right',\n      'inset'\n    ];\n    var nu$5 = function (xOffset, yOffset, classes, insetModifier) {\n      if (insetModifier === void 0) {\n        insetModifier = 1;\n      }\n      var insetXOffset = xOffset * insetModifier;\n      var insetYOffset = yOffset * insetModifier;\n      var getClasses = function (prop) {\n        return get$e(classes, prop).getOr([]);\n      };\n      var make = function (xDelta, yDelta, alignmentsOn) {\n        var alignmentsOff = difference(allAlignments, alignmentsOn);\n        return {\n          offset: SugarPosition(xDelta, yDelta),\n          classesOn: bind$3(alignmentsOn, getClasses),\n          classesOff: bind$3(alignmentsOff, getClasses)\n        };\n      };\n      return {\n        southeast: function () {\n          return make(-xOffset, yOffset, [\n            'top',\n            'alignLeft'\n          ]);\n        },\n        southwest: function () {\n          return make(xOffset, yOffset, [\n            'top',\n            'alignRight'\n          ]);\n        },\n        south: function () {\n          return make(-xOffset / 2, yOffset, [\n            'top',\n            'alignCentre'\n          ]);\n        },\n        northeast: function () {\n          return make(-xOffset, -yOffset, [\n            'bottom',\n            'alignLeft'\n          ]);\n        },\n        northwest: function () {\n          return make(xOffset, -yOffset, [\n            'bottom',\n            'alignRight'\n          ]);\n        },\n        north: function () {\n          return make(-xOffset / 2, -yOffset, [\n            'bottom',\n            'alignCentre'\n          ]);\n        },\n        east: function () {\n          return make(xOffset, -yOffset / 2, [\n            'valignCentre',\n            'left'\n          ]);\n        },\n        west: function () {\n          return make(-xOffset, -yOffset / 2, [\n            'valignCentre',\n            'right'\n          ]);\n        },\n        insetNortheast: function () {\n          return make(insetXOffset, insetYOffset, [\n            'top',\n            'alignLeft',\n            'inset'\n          ]);\n        },\n        insetNorthwest: function () {\n          return make(-insetXOffset, insetYOffset, [\n            'top',\n            'alignRight',\n            'inset'\n          ]);\n        },\n        insetNorth: function () {\n          return make(-insetXOffset / 2, insetYOffset, [\n            'top',\n            'alignCentre',\n            'inset'\n          ]);\n        },\n        insetSoutheast: function () {\n          return make(insetXOffset, -insetYOffset, [\n            'bottom',\n            'alignLeft',\n            'inset'\n          ]);\n        },\n        insetSouthwest: function () {\n          return make(-insetXOffset, -insetYOffset, [\n            'bottom',\n            'alignRight',\n            'inset'\n          ]);\n        },\n        insetSouth: function () {\n          return make(-insetXOffset / 2, -insetYOffset, [\n            'bottom',\n            'alignCentre',\n            'inset'\n          ]);\n        },\n        insetEast: function () {\n          return make(-insetXOffset, -insetYOffset / 2, [\n            'valignCentre',\n            'right',\n            'inset'\n          ]);\n        },\n        insetWest: function () {\n          return make(insetXOffset, -insetYOffset / 2, [\n            'valignCentre',\n            'left',\n            'inset'\n          ]);\n        }\n      };\n    };\n    var fallback = function () {\n      return nu$5(0, 0, {});\n    };\n\n    var nu$4 = identity$1;\n\n    var onDirection = function (isLtr, isRtl) {\n      return function (element) {\n        return getDirection(element) === 'rtl' ? isRtl : isLtr;\n      };\n    };\n    var getDirection = function (element) {\n      return get$c(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n    };\n\n    var AttributeValue;\n    (function (AttributeValue) {\n      AttributeValue['TopToBottom'] = 'toptobottom';\n      AttributeValue['BottomToTop'] = 'bottomtotop';\n    }(AttributeValue || (AttributeValue = {})));\n    var Attribute = 'data-alloy-vertical-dir';\n    var isBottomToTopDir = function (el) {\n      return closest$2(el, function (current) {\n        return isElement$2(current) && get$d(current, 'data-alloy-vertical-dir') === AttributeValue.BottomToTop;\n      });\n    };\n\n    var schema$y = function () {\n      return optionObjOf('layouts', [\n        required$1('onLtr'),\n        required$1('onRtl'),\n        option('onBottomLtr'),\n        option('onBottomRtl')\n      ]);\n    };\n    var get$4 = function (elem, info, defaultLtr, defaultRtl, defaultBottomLtr, defaultBottomRtl, dirElement) {\n      var isBottomToTop = dirElement.map(isBottomToTopDir).getOr(false);\n      var customLtr = info.layouts.map(function (ls) {\n        return ls.onLtr(elem);\n      });\n      var customRtl = info.layouts.map(function (ls) {\n        return ls.onRtl(elem);\n      });\n      var ltr = isBottomToTop ? info.layouts.bind(function (ls) {\n        return ls.onBottomLtr.map(function (f) {\n          return f(elem);\n        });\n      }).or(customLtr).getOr(defaultBottomLtr) : customLtr.getOr(defaultLtr);\n      var rtl = isBottomToTop ? info.layouts.bind(function (ls) {\n        return ls.onBottomRtl.map(function (f) {\n          return f(elem);\n        });\n      }).or(customRtl).getOr(defaultBottomRtl) : customRtl.getOr(defaultRtl);\n      var f = onDirection(ltr, rtl);\n      return f(elem);\n    };\n\n    var placement$4 = function (component, anchorInfo, origin) {\n      var hotspot = anchorInfo.hotspot;\n      var anchorBox = toBox(origin, hotspot.element);\n      var layouts = get$4(component.element, anchorInfo, belowOrAbove(), belowOrAboveRtl(), aboveOrBelow(), aboveOrBelowRtl(), Optional.some(anchorInfo.hotspot.element));\n      return Optional.some(nu$4({\n        anchorBox: anchorBox,\n        bubble: anchorInfo.bubble.getOr(fallback()),\n        overrides: anchorInfo.overrides,\n        layouts: layouts,\n        placer: Optional.none()\n      }));\n    };\n    var HotspotAnchor = [\n      required$1('hotspot'),\n      option('bubble'),\n      defaulted('overrides', {}),\n      schema$y(),\n      output$1('placement', placement$4)\n    ];\n\n    var placement$3 = function (component, anchorInfo, origin) {\n      var pos = translate$2(origin, anchorInfo.x, anchorInfo.y);\n      var anchorBox = bounds(pos.left, pos.top, anchorInfo.width, anchorInfo.height);\n      var layouts = get$4(component.element, anchorInfo, all$1(), allRtl$1(), all$1(), allRtl$1(), Optional.none());\n      return Optional.some(nu$4({\n        anchorBox: anchorBox,\n        bubble: anchorInfo.bubble,\n        overrides: anchorInfo.overrides,\n        layouts: layouts,\n        placer: Optional.none()\n      }));\n    };\n    var MakeshiftAnchor = [\n      required$1('x'),\n      required$1('y'),\n      defaulted('height', 0),\n      defaulted('width', 0),\n      defaulted('bubble', fallback()),\n      defaulted('overrides', {}),\n      schema$y(),\n      output$1('placement', placement$3)\n    ];\n\n    var adt$7 = Adt.generate([\n      { screen: ['point'] },\n      {\n        absolute: [\n          'point',\n          'scrollLeft',\n          'scrollTop'\n        ]\n      }\n    ]);\n    var toFixed = function (pos) {\n      return pos.fold(identity$1, function (point, scrollLeft, scrollTop) {\n        return point.translate(-scrollLeft, -scrollTop);\n      });\n    };\n    var toAbsolute = function (pos) {\n      return pos.fold(identity$1, identity$1);\n    };\n    var sum = function (points) {\n      return foldl(points, function (b, a) {\n        return b.translate(a.left, a.top);\n      }, SugarPosition(0, 0));\n    };\n    var sumAsFixed = function (positions) {\n      var points = map$2(positions, toFixed);\n      return sum(points);\n    };\n    var sumAsAbsolute = function (positions) {\n      var points = map$2(positions, toAbsolute);\n      return sum(points);\n    };\n    var screen = adt$7.screen;\n    var absolute$1 = adt$7.absolute;\n\n    var getOffset = function (component, origin, anchorInfo) {\n      var win = defaultView(anchorInfo.root).dom;\n      var hasSameOwner = function (frame) {\n        var frameOwner = owner$4(frame);\n        var compOwner = owner$4(component.element);\n        return eq(frameOwner, compOwner);\n      };\n      return Optional.from(win.frameElement).map(SugarElement.fromDom).filter(hasSameOwner).map(absolute$3);\n    };\n    var getRootPoint = function (component, origin, anchorInfo) {\n      var doc = owner$4(component.element);\n      var outerScroll = get$9(doc);\n      var offset = getOffset(component, origin, anchorInfo).getOr(outerScroll);\n      return absolute$1(offset, outerScroll.left, outerScroll.top);\n    };\n\n    var getBox = function (left, top, width, height) {\n      var point = screen(SugarPosition(left, top));\n      return Optional.some(pointed(point, width, height));\n    };\n    var calcNewAnchor = function (optBox, rootPoint, anchorInfo, origin, elem) {\n      return optBox.map(function (box) {\n        var points = [\n          rootPoint,\n          box.point\n        ];\n        var topLeft = cata$1(origin, function () {\n          return sumAsAbsolute(points);\n        }, function () {\n          return sumAsAbsolute(points);\n        }, function () {\n          return sumAsFixed(points);\n        });\n        var anchorBox = rect(topLeft.left, topLeft.top, box.width, box.height);\n        var layoutsLtr = anchorInfo.showAbove ? aboveOrBelow() : belowOrAbove();\n        var layoutsRtl = anchorInfo.showAbove ? aboveOrBelowRtl() : belowOrAboveRtl();\n        var layouts = get$4(elem, anchorInfo, layoutsLtr, layoutsRtl, layoutsLtr, layoutsRtl, Optional.none());\n        return nu$4({\n          anchorBox: anchorBox,\n          bubble: anchorInfo.bubble.getOr(fallback()),\n          overrides: anchorInfo.overrides,\n          layouts: layouts,\n          placer: Optional.none()\n        });\n      });\n    };\n\n    var placement$2 = function (component, anchorInfo, origin) {\n      var rootPoint = getRootPoint(component, origin, anchorInfo);\n      return anchorInfo.node.filter(inBody).bind(function (target) {\n        var rect = target.dom.getBoundingClientRect();\n        var nodeBox = getBox(rect.left, rect.top, rect.width, rect.height);\n        var elem = anchorInfo.node.getOr(component.element);\n        return calcNewAnchor(nodeBox, rootPoint, anchorInfo, origin, elem);\n      });\n    };\n    var NodeAnchor = [\n      required$1('node'),\n      required$1('root'),\n      option('bubble'),\n      schema$y(),\n      defaulted('overrides', {}),\n      defaulted('showAbove', false),\n      output$1('placement', placement$2)\n    ];\n\n    var zeroWidth = '\\uFEFF';\n    var nbsp = '\\xA0';\n\n    var create$6 = function (start, soffset, finish, foffset) {\n      return {\n        start: start,\n        soffset: soffset,\n        finish: finish,\n        foffset: foffset\n      };\n    };\n    var SimRange = { create: create$6 };\n\n    var adt$6 = Adt.generate([\n      { before: ['element'] },\n      {\n        on: [\n          'element',\n          'offset'\n        ]\n      },\n      { after: ['element'] }\n    ]);\n    var cata = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n    var getStart$1 = function (situ) {\n      return situ.fold(identity$1, identity$1, identity$1);\n    };\n    var before = adt$6.before;\n    var on$1 = adt$6.on;\n    var after$1 = adt$6.after;\n    var Situ = {\n      before: before,\n      on: on$1,\n      after: after$1,\n      cata: cata,\n      getStart: getStart$1\n    };\n\n    var adt$5 = Adt.generate([\n      { domRange: ['rng'] },\n      {\n        relative: [\n          'startSitu',\n          'finishSitu'\n        ]\n      },\n      {\n        exact: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var exactFromRange = function (simRange) {\n      return adt$5.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n    };\n    var getStart = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return SugarElement.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, _finishSitu) {\n          return Situ.getStart(startSitu);\n        },\n        exact: function (start, _soffset, _finish, _foffset) {\n          return start;\n        }\n      });\n    };\n    var domRange = adt$5.domRange;\n    var relative = adt$5.relative;\n    var exact = adt$5.exact;\n    var getWin = function (selection) {\n      var start = getStart(selection);\n      return defaultView(start);\n    };\n    var range$1 = SimRange.create;\n    var SimSelection = {\n      domRange: domRange,\n      relative: relative,\n      exact: exact,\n      exactFromRange: exactFromRange,\n      getWin: getWin,\n      range: range$1\n    };\n\n    var setStart = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setStartBefore(e.dom);\n      }, function (e, o) {\n        rng.setStart(e.dom, o);\n      }, function (e) {\n        rng.setStartAfter(e.dom);\n      });\n    };\n    var setFinish = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setEndBefore(e.dom);\n      }, function (e, o) {\n        rng.setEnd(e.dom, o);\n      }, function (e) {\n        rng.setEndAfter(e.dom);\n      });\n    };\n    var relativeToNative = function (win, startSitu, finishSitu) {\n      var range = win.document.createRange();\n      setStart(range, startSitu);\n      setFinish(range, finishSitu);\n      return range;\n    };\n    var exactToNative = function (win, start, soffset, finish, foffset) {\n      var rng = win.document.createRange();\n      rng.setStart(start.dom, soffset);\n      rng.setEnd(finish.dom, foffset);\n      return rng;\n    };\n    var toRect = function (rect) {\n      return {\n        left: rect.left,\n        top: rect.top,\n        right: rect.right,\n        bottom: rect.bottom,\n        width: rect.width,\n        height: rect.height\n      };\n    };\n    var getFirstRect$1 = function (rng) {\n      var rects = rng.getClientRects();\n      var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n      return rect.width > 0 || rect.height > 0 ? Optional.some(rect).map(toRect) : Optional.none();\n    };\n    var getBounds$2 = function (rng) {\n      var rect = rng.getBoundingClientRect();\n      return rect.width > 0 || rect.height > 0 ? Optional.some(rect).map(toRect) : Optional.none();\n    };\n\n    var adt$4 = Adt.generate([\n      {\n        ltr: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      },\n      {\n        rtl: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var fromRange = function (win, type, range) {\n      return type(SugarElement.fromDom(range.startContainer), range.startOffset, SugarElement.fromDom(range.endContainer), range.endOffset);\n    };\n    var getRanges = function (win, selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return {\n            ltr: constant$1(rng),\n            rtl: Optional.none\n          };\n        },\n        relative: function (startSitu, finishSitu) {\n          return {\n            ltr: cached(function () {\n              return relativeToNative(win, startSitu, finishSitu);\n            }),\n            rtl: cached(function () {\n              return Optional.some(relativeToNative(win, finishSitu, startSitu));\n            })\n          };\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return {\n            ltr: cached(function () {\n              return exactToNative(win, start, soffset, finish, foffset);\n            }),\n            rtl: cached(function () {\n              return Optional.some(exactToNative(win, finish, foffset, start, soffset));\n            })\n          };\n        }\n      });\n    };\n    var doDiagnose = function (win, ranges) {\n      var rng = ranges.ltr();\n      if (rng.collapsed) {\n        var reversed = ranges.rtl().filter(function (rev) {\n          return rev.collapsed === false;\n        });\n        return reversed.map(function (rev) {\n          return adt$4.rtl(SugarElement.fromDom(rev.endContainer), rev.endOffset, SugarElement.fromDom(rev.startContainer), rev.startOffset);\n        }).getOrThunk(function () {\n          return fromRange(win, adt$4.ltr, rng);\n        });\n      } else {\n        return fromRange(win, adt$4.ltr, rng);\n      }\n    };\n    var diagnose = function (win, selection) {\n      var ranges = getRanges(win, selection);\n      return doDiagnose(win, ranges);\n    };\n    var asLtrRange = function (win, selection) {\n      var diagnosis = diagnose(win, selection);\n      return diagnosis.match({\n        ltr: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(start.dom, soffset);\n          rng.setEnd(finish.dom, foffset);\n          return rng;\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(finish.dom, foffset);\n          rng.setEnd(start.dom, soffset);\n          return rng;\n        }\n      });\n    };\n    adt$4.ltr;\n    adt$4.rtl;\n\n    var NodeValue = function (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom.nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    };\n\n    var api = NodeValue(isText$1, 'text');\n    var get$3 = function (element) {\n      return api.get(element);\n    };\n    var getOption = function (element) {\n      return api.getOption(element);\n    };\n\n    var getEnd = function (element) {\n      return name$2(element) === 'img' ? 1 : getOption(element).fold(function () {\n        return children(element).length;\n      }, function (v) {\n        return v.length;\n      });\n    };\n    var isTextNodeWithCursorPosition = function (el) {\n      return getOption(el).filter(function (text) {\n        return text.trim().length !== 0 || text.indexOf(nbsp) > -1;\n      }).isSome();\n    };\n    var elementsWithCursorPosition = [\n      'img',\n      'br'\n    ];\n    var isCursorPosition = function (elem) {\n      var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n      return hasCursorPosition || contains$2(elementsWithCursorPosition, name$2(elem));\n    };\n\n    var last$1 = function (element) {\n      return descendantRtl(element, isCursorPosition);\n    };\n    var descendantRtl = function (scope, predicate) {\n      var descend = function (element) {\n        var children$1 = children(element);\n        for (var i = children$1.length - 1; i >= 0; i--) {\n          var child = children$1[i];\n          if (predicate(child)) {\n            return Optional.some(child);\n          }\n          var res = descend(child);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Optional.none();\n      };\n      return descend(scope);\n    };\n\n    var descendants = function (scope, selector) {\n      return all$3(selector, scope);\n    };\n\n    var makeRange = function (start, soffset, finish, foffset) {\n      var doc = owner$4(start);\n      var rng = doc.dom.createRange();\n      rng.setStart(start.dom, soffset);\n      rng.setEnd(finish.dom, foffset);\n      return rng;\n    };\n    var after = function (start, soffset, finish, foffset) {\n      var r = makeRange(start, soffset, finish, foffset);\n      var same = eq(start, finish) && soffset === foffset;\n      return r.collapsed && !same;\n    };\n\n    var getNativeSelection = function (win) {\n      return Optional.from(win.getSelection());\n    };\n    var readRange = function (selection) {\n      if (selection.rangeCount > 0) {\n        var firstRng = selection.getRangeAt(0);\n        var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n        return Optional.some(SimRange.create(SugarElement.fromDom(firstRng.startContainer), firstRng.startOffset, SugarElement.fromDom(lastRng.endContainer), lastRng.endOffset));\n      } else {\n        return Optional.none();\n      }\n    };\n    var doGetExact = function (selection) {\n      if (selection.anchorNode === null || selection.focusNode === null) {\n        return readRange(selection);\n      } else {\n        var anchor = SugarElement.fromDom(selection.anchorNode);\n        var focus_1 = SugarElement.fromDom(selection.focusNode);\n        return after(anchor, selection.anchorOffset, focus_1, selection.focusOffset) ? Optional.some(SimRange.create(anchor, selection.anchorOffset, focus_1, selection.focusOffset)) : readRange(selection);\n      }\n    };\n    var getExact = function (win) {\n      return getNativeSelection(win).filter(function (sel) {\n        return sel.rangeCount > 0;\n      }).bind(doGetExact);\n    };\n    var getFirstRect = function (win, selection) {\n      var rng = asLtrRange(win, selection);\n      return getFirstRect$1(rng);\n    };\n    var getBounds$1 = function (win, selection) {\n      var rng = asLtrRange(win, selection);\n      return getBounds$2(rng);\n    };\n\n    var point$1 = function (element, offset) {\n      return {\n        element: element,\n        offset: offset\n      };\n    };\n    var descendOnce$1 = function (element, offset) {\n      var children$1 = children(element);\n      if (children$1.length === 0) {\n        return point$1(element, offset);\n      } else if (offset < children$1.length) {\n        return point$1(children$1[offset], 0);\n      } else {\n        var last = children$1[children$1.length - 1];\n        var len = isText$1(last) ? get$3(last).length : children(last).length;\n        return point$1(last, len);\n      }\n    };\n\n    var descendOnce = function (element, offset) {\n      return isText$1(element) ? point$1(element, offset) : descendOnce$1(element, offset);\n    };\n    var getAnchorSelection = function (win, anchorInfo) {\n      var getSelection = anchorInfo.getSelection.getOrThunk(function () {\n        return function () {\n          return getExact(win);\n        };\n      });\n      return getSelection().map(function (sel) {\n        var modStart = descendOnce(sel.start, sel.soffset);\n        var modFinish = descendOnce(sel.finish, sel.foffset);\n        return SimSelection.range(modStart.element, modStart.offset, modFinish.element, modFinish.offset);\n      });\n    };\n    var placement$1 = function (component, anchorInfo, origin) {\n      var win = defaultView(anchorInfo.root).dom;\n      var rootPoint = getRootPoint(component, origin, anchorInfo);\n      var selectionBox = getAnchorSelection(win, anchorInfo).bind(function (sel) {\n        var optRect = getBounds$1(win, SimSelection.exactFromRange(sel)).orThunk(function () {\n          var x = SugarElement.fromText(zeroWidth);\n          before$2(sel.start, x);\n          var rect = getFirstRect(win, SimSelection.exact(x, 0, x, 1));\n          remove$5(x);\n          return rect;\n        });\n        return optRect.bind(function (rawRect) {\n          return getBox(rawRect.left, rawRect.top, rawRect.width, rawRect.height);\n        });\n      });\n      var targetElement = getAnchorSelection(win, anchorInfo).bind(function (sel) {\n        return isElement$2(sel.start) ? Optional.some(sel.start) : parentNode(sel.start);\n      });\n      var elem = targetElement.getOr(component.element);\n      return calcNewAnchor(selectionBox, rootPoint, anchorInfo, origin, elem);\n    };\n    var SelectionAnchor = [\n      option('getSelection'),\n      required$1('root'),\n      option('bubble'),\n      schema$y(),\n      defaulted('overrides', {}),\n      defaulted('showAbove', false),\n      output$1('placement', placement$1)\n    ];\n\n    var labelPrefix$1 = 'link-layout';\n    var eastX = function (anchor) {\n      return anchor.x + anchor.width;\n    };\n    var westX = function (anchor, element) {\n      return anchor.x - element.width;\n    };\n    var northY$1 = function (anchor, element) {\n      return anchor.y - element.height + anchor.height;\n    };\n    var southY$1 = function (anchor) {\n      return anchor.y;\n    };\n    var southeast$1 = function (anchor, element, bubbles) {\n      return nu$6(eastX(anchor), southY$1(anchor), bubbles.southeast(), southeast$3(), 'southeast', boundsRestriction(anchor, {\n        left: 0,\n        top: 2\n      }), labelPrefix$1);\n    };\n    var southwest$1 = function (anchor, element, bubbles) {\n      return nu$6(westX(anchor, element), southY$1(anchor), bubbles.southwest(), southwest$3(), 'southwest', boundsRestriction(anchor, {\n        right: 1,\n        top: 2\n      }), labelPrefix$1);\n    };\n    var northeast$1 = function (anchor, element, bubbles) {\n      return nu$6(eastX(anchor), northY$1(anchor, element), bubbles.northeast(), northeast$3(), 'northeast', boundsRestriction(anchor, {\n        left: 0,\n        bottom: 3\n      }), labelPrefix$1);\n    };\n    var northwest$1 = function (anchor, element, bubbles) {\n      return nu$6(westX(anchor, element), northY$1(anchor, element), bubbles.northwest(), northwest$3(), 'northwest', boundsRestriction(anchor, {\n        right: 1,\n        bottom: 3\n      }), labelPrefix$1);\n    };\n    var all = function () {\n      return [\n        southeast$1,\n        southwest$1,\n        northeast$1,\n        northwest$1\n      ];\n    };\n    var allRtl = function () {\n      return [\n        southwest$1,\n        southeast$1,\n        northwest$1,\n        northeast$1\n      ];\n    };\n\n    var placement = function (component, submenuInfo, origin) {\n      var anchorBox = toBox(origin, submenuInfo.item.element);\n      var layouts = get$4(component.element, submenuInfo, all(), allRtl(), all(), allRtl(), Optional.none());\n      return Optional.some(nu$4({\n        anchorBox: anchorBox,\n        bubble: fallback(),\n        overrides: submenuInfo.overrides,\n        layouts: layouts,\n        placer: Optional.none()\n      }));\n    };\n    var SubmenuAnchor = [\n      required$1('item'),\n      schema$y(),\n      defaulted('overrides', {}),\n      output$1('placement', placement)\n    ];\n\n    var AnchorSchema = choose$1('type', {\n      selection: SelectionAnchor,\n      node: NodeAnchor,\n      hotspot: HotspotAnchor,\n      submenu: SubmenuAnchor,\n      makeshift: MakeshiftAnchor\n    });\n\n    var TransitionSchema = [\n      requiredArrayOf('classes', string),\n      defaultedStringEnum('mode', 'all', [\n        'all',\n        'layout',\n        'placement'\n      ])\n    ];\n    var PositionSchema = [\n      defaulted('useFixed', never),\n      option('getBounds')\n    ];\n    var PlacementSchema = [\n      requiredOf('anchor', AnchorSchema),\n      optionObjOf('transition', TransitionSchema)\n    ];\n\n    var getFixedOrigin = function () {\n      var html = document.documentElement;\n      return fixed$1(0, 0, html.clientWidth, html.clientHeight);\n    };\n    var getRelativeOrigin = function (component) {\n      var position = absolute$3(component.element);\n      var bounds = component.element.dom.getBoundingClientRect();\n      return relative$1(position.left, position.top, bounds.width, bounds.height);\n    };\n    var place = function (component, origin, anchoring, getBounds, placee, lastPlace, transition) {\n      var anchor = box(anchoring.anchorBox, origin);\n      return simple(anchor, placee.element, anchoring.bubble, anchoring.layouts, lastPlace, getBounds, anchoring.overrides, transition);\n    };\n    var position$1 = function (component, posConfig, posState, placee, placementSpec) {\n      positionWithin(component, posConfig, posState, placee, placementSpec, Optional.none());\n    };\n    var positionWithin = function (component, posConfig, posState, placee, placementSpec, boxElement) {\n      var boundsBox = boxElement.map(box$1);\n      return positionWithinBounds(component, posConfig, posState, placee, placementSpec, boundsBox);\n    };\n    var positionWithinBounds = function (component, posConfig, posState, placee, placementSpec, bounds) {\n      var placeeDetail = asRawOrDie$1('placement.info', objOf(PlacementSchema), placementSpec);\n      var anchorage = placeeDetail.anchor;\n      var element = placee.element;\n      var placeeState = posState.get(placee.uid);\n      preserve$1(function () {\n        set$7(element, 'position', 'fixed');\n        var oldVisibility = getRaw(element, 'visibility');\n        set$7(element, 'visibility', 'hidden');\n        var origin = posConfig.useFixed() ? getFixedOrigin() : getRelativeOrigin(component);\n        var placer = anchorage.placement;\n        var getBounds = bounds.map(constant$1).or(posConfig.getBounds);\n        placer(component, anchorage, origin).each(function (anchoring) {\n          var doPlace = anchoring.placer.getOr(place);\n          var newState = doPlace(component, origin, anchoring, getBounds, placee, placeeState, placeeDetail.transition);\n          posState.set(placee.uid, newState);\n        });\n        oldVisibility.fold(function () {\n          remove$6(element, 'visibility');\n        }, function (vis) {\n          set$7(element, 'visibility', vis);\n        });\n        if (getRaw(element, 'left').isNone() && getRaw(element, 'top').isNone() && getRaw(element, 'right').isNone() && getRaw(element, 'bottom').isNone() && is$1(getRaw(element, 'position'), 'fixed')) {\n          remove$6(element, 'position');\n        }\n      }, element);\n    };\n    var getMode = function (component, pConfig, _pState) {\n      return pConfig.useFixed() ? 'fixed' : 'absolute';\n    };\n    var reset$1 = function (component, pConfig, posState, placee) {\n      var element = placee.element;\n      each$1([\n        'position',\n        'left',\n        'right',\n        'top',\n        'bottom'\n      ], function (prop) {\n        return remove$6(element, prop);\n      });\n      reset$2(element);\n      posState.clear(placee.uid);\n    };\n\n    var PositionApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        position: position$1,\n        positionWithin: positionWithin,\n        positionWithinBounds: positionWithinBounds,\n        getMode: getMode,\n        reset: reset$1\n    });\n\n    var init$g = function () {\n      var state = {};\n      var set = function (id, data) {\n        state[id] = data;\n      };\n      var get = function (id) {\n        return get$e(state, id);\n      };\n      var clear = function (id) {\n        if (isNonNullable(id)) {\n          delete state[id];\n        } else {\n          state = {};\n        }\n      };\n      return nu$8({\n        readState: function () {\n          return state;\n        },\n        clear: clear,\n        set: set,\n        get: get\n      });\n    };\n\n    var PositioningState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$g\n    });\n\n    var Positioning = create$7({\n      fields: PositionSchema,\n      name: 'positioning',\n      active: ActivePosition,\n      apis: PositionApis,\n      state: PositioningState\n    });\n\n    var fireDetaching = function (component) {\n      emit(component, detachedFromDom());\n      var children = component.components();\n      each$1(children, fireDetaching);\n    };\n    var fireAttaching = function (component) {\n      var children = component.components();\n      each$1(children, fireAttaching);\n      emit(component, attachedToDom());\n    };\n    var attach$1 = function (parent, child) {\n      append$2(parent.element, child.element);\n    };\n    var detachChildren$1 = function (component) {\n      each$1(component.components(), function (childComp) {\n        return remove$5(childComp.element);\n      });\n      empty(component.element);\n      component.syncComponents();\n    };\n    var replaceChildren = function (component, newChildren) {\n      var subs = component.components();\n      detachChildren$1(component);\n      var deleted = difference(subs, newChildren);\n      each$1(deleted, function (comp) {\n        fireDetaching(comp);\n        component.getSystem().removeFromWorld(comp);\n      });\n      each$1(newChildren, function (childComp) {\n        if (!childComp.getSystem().isConnected()) {\n          component.getSystem().addToWorld(childComp);\n          attach$1(component, childComp);\n          if (inBody(component.element)) {\n            fireAttaching(childComp);\n          }\n        } else {\n          attach$1(component, childComp);\n        }\n        component.syncComponents();\n      });\n    };\n\n    var attach = function (parent, child) {\n      attachWith(parent, child, append$2);\n    };\n    var attachWith = function (parent, child, insertion) {\n      parent.getSystem().addToWorld(child);\n      insertion(parent.element, child.element);\n      if (inBody(parent.element)) {\n        fireAttaching(child);\n      }\n      parent.syncComponents();\n    };\n    var doDetach = function (component) {\n      fireDetaching(component);\n      remove$5(component.element);\n      component.getSystem().removeFromWorld(component);\n    };\n    var detach = function (component) {\n      var parent$1 = parent(component.element).bind(function (p) {\n        return component.getSystem().getByDom(p).toOptional();\n      });\n      doDetach(component);\n      parent$1.each(function (p) {\n        p.syncComponents();\n      });\n    };\n    var detachChildren = function (component) {\n      var subs = component.components();\n      each$1(subs, doDetach);\n      empty(component.element);\n      component.syncComponents();\n    };\n    var attachSystem = function (element, guiSystem) {\n      attachSystemWith(element, guiSystem, append$2);\n    };\n    var attachSystemAfter = function (element, guiSystem) {\n      attachSystemWith(element, guiSystem, after$2);\n    };\n    var attachSystemWith = function (element, guiSystem, inserter) {\n      inserter(element, guiSystem.element);\n      var children$1 = children(guiSystem.element);\n      each$1(children$1, function (child) {\n        guiSystem.getByDom(child).each(fireAttaching);\n      });\n    };\n    var detachSystem = function (guiSystem) {\n      var children$1 = children(guiSystem.element);\n      each$1(children$1, function (child) {\n        guiSystem.getByDom(child).each(fireDetaching);\n      });\n      remove$5(guiSystem.element);\n    };\n\n    var rebuild = function (sandbox, sConfig, sState, data) {\n      sState.get().each(function (_data) {\n        detachChildren(sandbox);\n      });\n      var point = sConfig.getAttachPoint(sandbox);\n      attach(point, sandbox);\n      var built = sandbox.getSystem().build(data);\n      attach(sandbox, built);\n      sState.set(built);\n      return built;\n    };\n    var open$1 = function (sandbox, sConfig, sState, data) {\n      var newState = rebuild(sandbox, sConfig, sState, data);\n      sConfig.onOpen(sandbox, newState);\n      return newState;\n    };\n    var setContent = function (sandbox, sConfig, sState, data) {\n      return sState.get().map(function () {\n        return rebuild(sandbox, sConfig, sState, data);\n      });\n    };\n    var openWhileCloaked = function (sandbox, sConfig, sState, data, transaction) {\n      cloak(sandbox, sConfig);\n      open$1(sandbox, sConfig, sState, data);\n      transaction();\n      decloak(sandbox, sConfig);\n    };\n    var close$1 = function (sandbox, sConfig, sState) {\n      sState.get().each(function (data) {\n        detachChildren(sandbox);\n        detach(sandbox);\n        sConfig.onClose(sandbox, data);\n        sState.clear();\n      });\n    };\n    var isOpen$1 = function (_sandbox, _sConfig, sState) {\n      return sState.isOpen();\n    };\n    var isPartOf = function (sandbox, sConfig, sState, queryElem) {\n      return isOpen$1(sandbox, sConfig, sState) && sState.get().exists(function (data) {\n        return sConfig.isPartOf(sandbox, data, queryElem);\n      });\n    };\n    var getState$2 = function (_sandbox, _sConfig, sState) {\n      return sState.get();\n    };\n    var store = function (sandbox, cssKey, attr, newValue) {\n      getRaw(sandbox.element, cssKey).fold(function () {\n        remove$7(sandbox.element, attr);\n      }, function (v) {\n        set$8(sandbox.element, attr, v);\n      });\n      set$7(sandbox.element, cssKey, newValue);\n    };\n    var restore = function (sandbox, cssKey, attr) {\n      getOpt(sandbox.element, attr).fold(function () {\n        return remove$6(sandbox.element, cssKey);\n      }, function (oldValue) {\n        return set$7(sandbox.element, cssKey, oldValue);\n      });\n    };\n    var cloak = function (sandbox, sConfig, _sState) {\n      var sink = sConfig.getAttachPoint(sandbox);\n      set$7(sandbox.element, 'position', Positioning.getMode(sink));\n      store(sandbox, 'visibility', sConfig.cloakVisibilityAttr, 'hidden');\n    };\n    var hasPosition = function (element) {\n      return exists([\n        'top',\n        'left',\n        'right',\n        'bottom'\n      ], function (pos) {\n        return getRaw(element, pos).isSome();\n      });\n    };\n    var decloak = function (sandbox, sConfig, _sState) {\n      if (!hasPosition(sandbox.element)) {\n        remove$6(sandbox.element, 'position');\n      }\n      restore(sandbox, 'visibility', sConfig.cloakVisibilityAttr);\n    };\n\n    var SandboxApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        cloak: cloak,\n        decloak: decloak,\n        open: open$1,\n        openWhileCloaked: openWhileCloaked,\n        close: close$1,\n        isOpen: isOpen$1,\n        isPartOf: isPartOf,\n        getState: getState$2,\n        setContent: setContent\n    });\n\n    var events$g = function (sandboxConfig, sandboxState) {\n      return derive$2([run$1(sandboxClose(), function (sandbox, _simulatedEvent) {\n          close$1(sandbox, sandboxConfig, sandboxState);\n        })]);\n    };\n\n    var ActiveSandbox = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$g\n    });\n\n    var SandboxSchema = [\n      onHandler('onOpen'),\n      onHandler('onClose'),\n      required$1('isPartOf'),\n      required$1('getAttachPoint'),\n      defaulted('cloakVisibilityAttr', 'data-precloak-visibility')\n    ];\n\n    var init$f = function () {\n      var contents = value$1();\n      var readState = constant$1('not-implemented');\n      return nu$8({\n        readState: readState,\n        isOpen: contents.isSet,\n        clear: contents.clear,\n        set: contents.set,\n        get: contents.get\n      });\n    };\n\n    var SandboxState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$f\n    });\n\n    var Sandboxing = create$7({\n      fields: SandboxSchema,\n      name: 'sandboxing',\n      active: ActiveSandbox,\n      apis: SandboxApis,\n      state: SandboxState\n    });\n\n    var dismissPopups = constant$1('dismiss.popups');\n    var repositionPopups = constant$1('reposition.popups');\n    var mouseReleased = constant$1('mouse.released');\n\n    var schema$x = objOfOnly([\n      defaulted('isExtraPart', never),\n      optionObjOf('fireEventInstead', [defaulted('event', dismissRequested())])\n    ]);\n    var receivingChannel$1 = function (rawSpec) {\n      var _a;\n      var detail = asRawOrDie$1('Dismissal', schema$x, rawSpec);\n      return _a = {}, _a[dismissPopups()] = {\n        schema: objOfOnly([required$1('target')]),\n        onReceive: function (sandbox, data) {\n          if (Sandboxing.isOpen(sandbox)) {\n            var isPart = Sandboxing.isPartOf(sandbox, data.target) || detail.isExtraPart(sandbox, data.target);\n            if (!isPart) {\n              detail.fireEventInstead.fold(function () {\n                return Sandboxing.close(sandbox);\n              }, function (fe) {\n                return emit(sandbox, fe.event);\n              });\n            }\n          }\n        }\n      }, _a;\n    };\n\n    var schema$w = objOfOnly([\n      optionObjOf('fireEventInstead', [defaulted('event', repositionRequested())]),\n      requiredFunction('doReposition')\n    ]);\n    var receivingChannel = function (rawSpec) {\n      var _a;\n      var detail = asRawOrDie$1('Reposition', schema$w, rawSpec);\n      return _a = {}, _a[repositionPopups()] = {\n        onReceive: function (sandbox) {\n          if (Sandboxing.isOpen(sandbox)) {\n            detail.fireEventInstead.fold(function () {\n              return detail.doReposition(sandbox);\n            }, function (fe) {\n              return emit(sandbox, fe.event);\n            });\n          }\n        }\n      }, _a;\n    };\n\n    var onLoad$5 = function (component, repConfig, repState) {\n      repConfig.store.manager.onLoad(component, repConfig, repState);\n    };\n    var onUnload$2 = function (component, repConfig, repState) {\n      repConfig.store.manager.onUnload(component, repConfig, repState);\n    };\n    var setValue$3 = function (component, repConfig, repState, data) {\n      repConfig.store.manager.setValue(component, repConfig, repState, data);\n    };\n    var getValue$3 = function (component, repConfig, repState) {\n      return repConfig.store.manager.getValue(component, repConfig, repState);\n    };\n    var getState$1 = function (component, repConfig, repState) {\n      return repState;\n    };\n\n    var RepresentApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        onLoad: onLoad$5,\n        onUnload: onUnload$2,\n        setValue: setValue$3,\n        getValue: getValue$3,\n        getState: getState$1\n    });\n\n    var events$f = function (repConfig, repState) {\n      var es = repConfig.resetOnDom ? [\n        runOnAttached(function (comp, _se) {\n          onLoad$5(comp, repConfig, repState);\n        }),\n        runOnDetached(function (comp, _se) {\n          onUnload$2(comp, repConfig, repState);\n        })\n      ] : [loadEvent(repConfig, repState, onLoad$5)];\n      return derive$2(es);\n    };\n\n    var ActiveRepresenting = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$f\n    });\n\n    var memory$1 = function () {\n      var data = Cell(null);\n      var readState = function () {\n        return {\n          mode: 'memory',\n          value: data.get()\n        };\n      };\n      var isNotSet = function () {\n        return data.get() === null;\n      };\n      var clear = function () {\n        data.set(null);\n      };\n      return nu$8({\n        set: data.set,\n        get: data.get,\n        isNotSet: isNotSet,\n        clear: clear,\n        readState: readState\n      });\n    };\n    var manual = function () {\n      var readState = noop;\n      return nu$8({ readState: readState });\n    };\n    var dataset = function () {\n      var dataByValue = Cell({});\n      var dataByText = Cell({});\n      var readState = function () {\n        return {\n          mode: 'dataset',\n          dataByValue: dataByValue.get(),\n          dataByText: dataByText.get()\n        };\n      };\n      var clear = function () {\n        dataByValue.set({});\n        dataByText.set({});\n      };\n      var lookup = function (itemString) {\n        return get$e(dataByValue.get(), itemString).orThunk(function () {\n          return get$e(dataByText.get(), itemString);\n        });\n      };\n      var update = function (items) {\n        var currentDataByValue = dataByValue.get();\n        var currentDataByText = dataByText.get();\n        var newDataByValue = {};\n        var newDataByText = {};\n        each$1(items, function (item) {\n          newDataByValue[item.value] = item;\n          get$e(item, 'meta').each(function (meta) {\n            get$e(meta, 'text').each(function (text) {\n              newDataByText[text] = item;\n            });\n          });\n        });\n        dataByValue.set(__assign(__assign({}, currentDataByValue), newDataByValue));\n        dataByText.set(__assign(__assign({}, currentDataByText), newDataByText));\n      };\n      return nu$8({\n        readState: readState,\n        lookup: lookup,\n        update: update,\n        clear: clear\n      });\n    };\n    var init$e = function (spec) {\n      return spec.store.manager.state(spec);\n    };\n\n    var RepresentState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        memory: memory$1,\n        dataset: dataset,\n        manual: manual,\n        init: init$e\n    });\n\n    var setValue$2 = function (component, repConfig, repState, data) {\n      var store = repConfig.store;\n      repState.update([data]);\n      store.setValue(component, data);\n      repConfig.onSetValue(component, data);\n    };\n    var getValue$2 = function (component, repConfig, repState) {\n      var store = repConfig.store;\n      var key = store.getDataKey(component);\n      return repState.lookup(key).getOrThunk(function () {\n        return store.getFallbackEntry(key);\n      });\n    };\n    var onLoad$4 = function (component, repConfig, repState) {\n      var store = repConfig.store;\n      store.initialValue.each(function (data) {\n        setValue$2(component, repConfig, repState, data);\n      });\n    };\n    var onUnload$1 = function (component, repConfig, repState) {\n      repState.clear();\n    };\n    var DatasetStore = [\n      option('initialValue'),\n      required$1('getFallbackEntry'),\n      required$1('getDataKey'),\n      required$1('setValue'),\n      output$1('manager', {\n        setValue: setValue$2,\n        getValue: getValue$2,\n        onLoad: onLoad$4,\n        onUnload: onUnload$1,\n        state: dataset\n      })\n    ];\n\n    var getValue$1 = function (component, repConfig, _repState) {\n      return repConfig.store.getValue(component);\n    };\n    var setValue$1 = function (component, repConfig, _repState, data) {\n      repConfig.store.setValue(component, data);\n      repConfig.onSetValue(component, data);\n    };\n    var onLoad$3 = function (component, repConfig, _repState) {\n      repConfig.store.initialValue.each(function (data) {\n        repConfig.store.setValue(component, data);\n      });\n    };\n    var ManualStore = [\n      required$1('getValue'),\n      defaulted('setValue', noop),\n      option('initialValue'),\n      output$1('manager', {\n        setValue: setValue$1,\n        getValue: getValue$1,\n        onLoad: onLoad$3,\n        onUnload: noop,\n        state: NoState.init\n      })\n    ];\n\n    var setValue = function (component, repConfig, repState, data) {\n      repState.set(data);\n      repConfig.onSetValue(component, data);\n    };\n    var getValue = function (component, repConfig, repState) {\n      return repState.get();\n    };\n    var onLoad$2 = function (component, repConfig, repState) {\n      repConfig.store.initialValue.each(function (initVal) {\n        if (repState.isNotSet()) {\n          repState.set(initVal);\n        }\n      });\n    };\n    var onUnload = function (component, repConfig, repState) {\n      repState.clear();\n    };\n    var MemoryStore = [\n      option('initialValue'),\n      output$1('manager', {\n        setValue: setValue,\n        getValue: getValue,\n        onLoad: onLoad$2,\n        onUnload: onUnload,\n        state: memory$1\n      })\n    ];\n\n    var RepresentSchema = [\n      defaultedOf('store', { mode: 'memory' }, choose$1('mode', {\n        memory: MemoryStore,\n        manual: ManualStore,\n        dataset: DatasetStore\n      })),\n      onHandler('onSetValue'),\n      defaulted('resetOnDom', false)\n    ];\n\n    var Representing = create$7({\n      fields: RepresentSchema,\n      name: 'representing',\n      active: ActiveRepresenting,\n      apis: RepresentApis,\n      extra: {\n        setValueFrom: function (component, source) {\n          var value = Representing.getValue(source);\n          Representing.setValue(component, value);\n        }\n      },\n      state: RepresentState\n    });\n\n    var field = function (name, forbidden) {\n      return defaultedObjOf(name, {}, map$2(forbidden, function (f) {\n        return forbid(f.name(), 'Cannot configure ' + f.name() + ' for ' + name);\n      }).concat([customField('dump', identity$1)]));\n    };\n    var get$2 = function (data) {\n      return data.dump;\n    };\n    var augment = function (data, original) {\n      return __assign(__assign({}, derive$1(original)), data.dump);\n    };\n    var SketchBehaviours = {\n      field: field,\n      augment: augment,\n      get: get$2\n    };\n\n    var _placeholder = 'placeholder';\n    var adt$3 = Adt.generate([\n      {\n        single: [\n          'required',\n          'valueThunk'\n        ]\n      },\n      {\n        multiple: [\n          'required',\n          'valueThunks'\n        ]\n      }\n    ]);\n    var isSubstituted = function (spec) {\n      return has$2(spec, 'uiType');\n    };\n    var subPlaceholder = function (owner, detail, compSpec, placeholders) {\n      if (owner.exists(function (o) {\n          return o !== compSpec.owner;\n        })) {\n        return adt$3.single(true, constant$1(compSpec));\n      }\n      return get$e(placeholders, compSpec.name).fold(function () {\n        throw new Error('Unknown placeholder component: ' + compSpec.name + '\\nKnown: [' + keys(placeholders) + ']\\nNamespace: ' + owner.getOr('none') + '\\nSpec: ' + JSON.stringify(compSpec, null, 2));\n      }, function (newSpec) {\n        return newSpec.replace();\n      });\n    };\n    var scan = function (owner, detail, compSpec, placeholders) {\n      if (isSubstituted(compSpec) && compSpec.uiType === _placeholder) {\n        return subPlaceholder(owner, detail, compSpec, placeholders);\n      } else {\n        return adt$3.single(false, constant$1(compSpec));\n      }\n    };\n    var substitute = function (owner, detail, compSpec, placeholders) {\n      var base = scan(owner, detail, compSpec, placeholders);\n      return base.fold(function (req, valueThunk) {\n        var value = isSubstituted(compSpec) ? valueThunk(detail, compSpec.config, compSpec.validated) : valueThunk(detail);\n        var childSpecs = get$e(value, 'components').getOr([]);\n        var substituted = bind$3(childSpecs, function (c) {\n          return substitute(owner, detail, c, placeholders);\n        });\n        return [__assign(__assign({}, value), { components: substituted })];\n      }, function (req, valuesThunk) {\n        if (isSubstituted(compSpec)) {\n          var values = valuesThunk(detail, compSpec.config, compSpec.validated);\n          var preprocessor = compSpec.validated.preprocess.getOr(identity$1);\n          return preprocessor(values);\n        } else {\n          return valuesThunk(detail);\n        }\n      });\n    };\n    var substituteAll = function (owner, detail, components, placeholders) {\n      return bind$3(components, function (c) {\n        return substitute(owner, detail, c, placeholders);\n      });\n    };\n    var oneReplace = function (label, replacements) {\n      var called = false;\n      var used = function () {\n        return called;\n      };\n      var replace = function () {\n        if (called) {\n          throw new Error('Trying to use the same placeholder more than once: ' + label);\n        }\n        called = true;\n        return replacements;\n      };\n      var required = function () {\n        return replacements.fold(function (req, _) {\n          return req;\n        }, function (req, _) {\n          return req;\n        });\n      };\n      return {\n        name: constant$1(label),\n        required: required,\n        used: used,\n        replace: replace\n      };\n    };\n    var substitutePlaces = function (owner, detail, components, placeholders) {\n      var ps = map$1(placeholders, function (ph, name) {\n        return oneReplace(name, ph);\n      });\n      var outcome = substituteAll(owner, detail, components, ps);\n      each(ps, function (p) {\n        if (p.used() === false && p.required()) {\n          throw new Error('Placeholder: ' + p.name() + ' was not found in components list\\nNamespace: ' + owner.getOr('none') + '\\nComponents: ' + JSON.stringify(detail.components, null, 2));\n        }\n      });\n      return outcome;\n    };\n    var single$2 = adt$3.single;\n    var multiple = adt$3.multiple;\n    var placeholder = constant$1(_placeholder);\n\n    var adt$2 = Adt.generate([\n      { required: ['data'] },\n      { external: ['data'] },\n      { optional: ['data'] },\n      { group: ['data'] }\n    ]);\n    var fFactory = defaulted('factory', { sketch: identity$1 });\n    var fSchema = defaulted('schema', []);\n    var fName = required$1('name');\n    var fPname = field$1('pname', 'pname', defaultedThunk(function (typeSpec) {\n      return '<alloy.' + generate$6(typeSpec.name) + '>';\n    }), anyValue());\n    var fGroupSchema = customField('schema', function () {\n      return [option('preprocess')];\n    });\n    var fDefaults = defaulted('defaults', constant$1({}));\n    var fOverrides = defaulted('overrides', constant$1({}));\n    var requiredSpec = objOf([\n      fFactory,\n      fSchema,\n      fName,\n      fPname,\n      fDefaults,\n      fOverrides\n    ]);\n    var externalSpec = objOf([\n      fFactory,\n      fSchema,\n      fName,\n      fDefaults,\n      fOverrides\n    ]);\n    var optionalSpec = objOf([\n      fFactory,\n      fSchema,\n      fName,\n      fPname,\n      fDefaults,\n      fOverrides\n    ]);\n    var groupSpec = objOf([\n      fFactory,\n      fGroupSchema,\n      fName,\n      required$1('unit'),\n      fPname,\n      fDefaults,\n      fOverrides\n    ]);\n    var asNamedPart = function (part) {\n      return part.fold(Optional.some, Optional.none, Optional.some, Optional.some);\n    };\n    var name$1 = function (part) {\n      var get = function (data) {\n        return data.name;\n      };\n      return part.fold(get, get, get, get);\n    };\n    var asCommon = function (part) {\n      return part.fold(identity$1, identity$1, identity$1, identity$1);\n    };\n    var convert = function (adtConstructor, partSchema) {\n      return function (spec) {\n        var data = asRawOrDie$1('Converting part type', partSchema, spec);\n        return adtConstructor(data);\n      };\n    };\n    var required = convert(adt$2.required, requiredSpec);\n    var external$1 = convert(adt$2.external, externalSpec);\n    var optional = convert(adt$2.optional, optionalSpec);\n    var group = convert(adt$2.group, groupSpec);\n    var original = constant$1('entirety');\n\n    var PartType = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        required: required,\n        external: external$1,\n        optional: optional,\n        group: group,\n        asNamedPart: asNamedPart,\n        name: name$1,\n        asCommon: asCommon,\n        original: original\n    });\n\n    var combine = function (detail, data, partSpec, partValidated) {\n      return deepMerge(data.defaults(detail, partSpec, partValidated), partSpec, { uid: detail.partUids[data.name] }, data.overrides(detail, partSpec, partValidated));\n    };\n    var subs = function (owner, detail, parts) {\n      var internals = {};\n      var externals = {};\n      each$1(parts, function (part) {\n        part.fold(function (data) {\n          internals[data.pname] = single$2(true, function (detail, partSpec, partValidated) {\n            return data.factory.sketch(combine(detail, data, partSpec, partValidated));\n          });\n        }, function (data) {\n          var partSpec = detail.parts[data.name];\n          externals[data.name] = constant$1(data.factory.sketch(combine(detail, data, partSpec[original()]), partSpec));\n        }, function (data) {\n          internals[data.pname] = single$2(false, function (detail, partSpec, partValidated) {\n            return data.factory.sketch(combine(detail, data, partSpec, partValidated));\n          });\n        }, function (data) {\n          internals[data.pname] = multiple(true, function (detail, _partSpec, _partValidated) {\n            var units = detail[data.name];\n            return map$2(units, function (u) {\n              return data.factory.sketch(deepMerge(data.defaults(detail, u, _partValidated), u, data.overrides(detail, u)));\n            });\n          });\n        });\n      });\n      return {\n        internals: constant$1(internals),\n        externals: constant$1(externals)\n      };\n    };\n\n    var generate$3 = function (owner, parts) {\n      var r = {};\n      each$1(parts, function (part) {\n        asNamedPart(part).each(function (np) {\n          var g = doGenerateOne(owner, np.pname);\n          r[np.name] = function (config) {\n            var validated = asRawOrDie$1('Part: ' + np.name + ' in ' + owner, objOf(np.schema), config);\n            return __assign(__assign({}, g), {\n              config: config,\n              validated: validated\n            });\n          };\n        });\n      });\n      return r;\n    };\n    var doGenerateOne = function (owner, pname) {\n      return {\n        uiType: placeholder(),\n        owner: owner,\n        name: pname\n      };\n    };\n    var generateOne$1 = function (owner, pname, config) {\n      return {\n        uiType: placeholder(),\n        owner: owner,\n        name: pname,\n        config: config,\n        validated: {}\n      };\n    };\n    var schemas = function (parts) {\n      return bind$3(parts, function (part) {\n        return part.fold(Optional.none, Optional.some, Optional.none, Optional.none).map(function (data) {\n          return requiredObjOf(data.name, data.schema.concat([snapshot(original())]));\n        }).toArray();\n      });\n    };\n    var names = function (parts) {\n      return map$2(parts, name$1);\n    };\n    var substitutes = function (owner, detail, parts) {\n      return subs(owner, detail, parts);\n    };\n    var components$1 = function (owner, detail, internals) {\n      return substitutePlaces(Optional.some(owner), detail, detail.components, internals);\n    };\n    var getPart = function (component, detail, partKey) {\n      var uid = detail.partUids[partKey];\n      return component.getSystem().getByUid(uid).toOptional();\n    };\n    var getPartOrDie = function (component, detail, partKey) {\n      return getPart(component, detail, partKey).getOrDie('Could not find part: ' + partKey);\n    };\n    var getParts = function (component, detail, partKeys) {\n      var r = {};\n      var uids = detail.partUids;\n      var system = component.getSystem();\n      each$1(partKeys, function (pk) {\n        r[pk] = constant$1(system.getByUid(uids[pk]));\n      });\n      return r;\n    };\n    var getAllParts = function (component, detail) {\n      var system = component.getSystem();\n      return map$1(detail.partUids, function (pUid, _k) {\n        return constant$1(system.getByUid(pUid));\n      });\n    };\n    var getAllPartNames = function (detail) {\n      return keys(detail.partUids);\n    };\n    var getPartsOrDie = function (component, detail, partKeys) {\n      var r = {};\n      var uids = detail.partUids;\n      var system = component.getSystem();\n      each$1(partKeys, function (pk) {\n        r[pk] = constant$1(system.getByUid(uids[pk]).getOrDie());\n      });\n      return r;\n    };\n    var defaultUids = function (baseUid, partTypes) {\n      var partNames = names(partTypes);\n      return wrapAll(map$2(partNames, function (pn) {\n        return {\n          key: pn,\n          value: baseUid + '-' + pn\n        };\n      }));\n    };\n    var defaultUidsSchema = function (partTypes) {\n      return field$1('partUids', 'partUids', mergeWithThunk(function (spec) {\n        return defaultUids(spec.uid, partTypes);\n      }), anyValue());\n    };\n\n    var AlloyParts = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        generate: generate$3,\n        generateOne: generateOne$1,\n        schemas: schemas,\n        names: names,\n        substitutes: substitutes,\n        components: components$1,\n        defaultUids: defaultUids,\n        defaultUidsSchema: defaultUidsSchema,\n        getAllParts: getAllParts,\n        getAllPartNames: getAllPartNames,\n        getPart: getPart,\n        getPartOrDie: getPartOrDie,\n        getParts: getParts,\n        getPartsOrDie: getPartsOrDie\n    });\n\n    var base = function (partSchemas, partUidsSchemas) {\n      var ps = partSchemas.length > 0 ? [requiredObjOf('parts', partSchemas)] : [];\n      return ps.concat([\n        required$1('uid'),\n        defaulted('dom', {}),\n        defaulted('components', []),\n        snapshot('originalSpec'),\n        defaulted('debug.sketcher', {})\n      ]).concat(partUidsSchemas);\n    };\n    var asRawOrDie = function (label, schema, spec, partSchemas, partUidsSchemas) {\n      var baseS = base(partSchemas, partUidsSchemas);\n      return asRawOrDie$1(label + ' [SpecSchema]', objOfOnly(baseS.concat(schema)), spec);\n    };\n\n    var single$1 = function (owner, schema, factory, spec) {\n      var specWithUid = supplyUid(spec);\n      var detail = asRawOrDie(owner, schema, specWithUid, [], []);\n      return factory(detail, specWithUid);\n    };\n    var composite$1 = function (owner, schema, partTypes, factory, spec) {\n      var specWithUid = supplyUid(spec);\n      var partSchemas = schemas(partTypes);\n      var partUidsSchema = defaultUidsSchema(partTypes);\n      var detail = asRawOrDie(owner, schema, specWithUid, partSchemas, [partUidsSchema]);\n      var subs = substitutes(owner, detail, partTypes);\n      var components = components$1(owner, detail, subs.internals());\n      return factory(detail, components, specWithUid, subs.externals());\n    };\n    var hasUid = function (spec) {\n      return has$2(spec, 'uid');\n    };\n    var supplyUid = function (spec) {\n      return hasUid(spec) ? spec : __assign(__assign({}, spec), { uid: generate$5('uid') });\n    };\n\n    var isSketchSpec = function (spec) {\n      return spec.uid !== undefined;\n    };\n    var singleSchema = objOfOnly([\n      required$1('name'),\n      required$1('factory'),\n      required$1('configFields'),\n      defaulted('apis', {}),\n      defaulted('extraApis', {})\n    ]);\n    var compositeSchema = objOfOnly([\n      required$1('name'),\n      required$1('factory'),\n      required$1('configFields'),\n      required$1('partFields'),\n      defaulted('apis', {}),\n      defaulted('extraApis', {})\n    ]);\n    var single = function (rawConfig) {\n      var config = asRawOrDie$1('Sketcher for ' + rawConfig.name, singleSchema, rawConfig);\n      var sketch = function (spec) {\n        return single$1(config.name, config.configFields, config.factory, spec);\n      };\n      var apis = map$1(config.apis, makeApi);\n      var extraApis = map$1(config.extraApis, function (f, k) {\n        return markAsExtraApi(f, k);\n      });\n      return __assign(__assign({\n        name: config.name,\n        configFields: config.configFields,\n        sketch: sketch\n      }, apis), extraApis);\n    };\n    var composite = function (rawConfig) {\n      var config = asRawOrDie$1('Sketcher for ' + rawConfig.name, compositeSchema, rawConfig);\n      var sketch = function (spec) {\n        return composite$1(config.name, config.configFields, config.partFields, config.factory, spec);\n      };\n      var parts = generate$3(config.name, config.partFields);\n      var apis = map$1(config.apis, makeApi);\n      var extraApis = map$1(config.extraApis, function (f, k) {\n        return markAsExtraApi(f, k);\n      });\n      return __assign(__assign({\n        name: config.name,\n        partFields: config.partFields,\n        configFields: config.configFields,\n        sketch: sketch,\n        parts: parts\n      }, apis), extraApis);\n    };\n\n    var inside = function (target) {\n      return name$2(target) === 'input' && get$d(target, 'type') !== 'radio' || name$2(target) === 'textarea';\n    };\n\n    var getCurrent = function (component, composeConfig, _composeState) {\n      return composeConfig.find(component);\n    };\n\n    var ComposeApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getCurrent: getCurrent\n    });\n\n    var ComposeSchema = [required$1('find')];\n\n    var Composing = create$7({\n      fields: ComposeSchema,\n      name: 'composing',\n      apis: ComposeApis\n    });\n\n    var nativeDisabled = [\n      'input',\n      'button',\n      'textarea',\n      'select'\n    ];\n    var onLoad$1 = function (component, disableConfig, disableState) {\n      var f = disableConfig.disabled() ? disable$1 : enable$1;\n      f(component, disableConfig);\n    };\n    var hasNative = function (component, config) {\n      return config.useNative === true && contains$2(nativeDisabled, name$2(component.element));\n    };\n    var nativeIsDisabled = function (component) {\n      return has$1(component.element, 'disabled');\n    };\n    var nativeDisable = function (component) {\n      set$8(component.element, 'disabled', 'disabled');\n    };\n    var nativeEnable = function (component) {\n      remove$7(component.element, 'disabled');\n    };\n    var ariaIsDisabled = function (component) {\n      return get$d(component.element, 'aria-disabled') === 'true';\n    };\n    var ariaDisable = function (component) {\n      set$8(component.element, 'aria-disabled', 'true');\n    };\n    var ariaEnable = function (component) {\n      set$8(component.element, 'aria-disabled', 'false');\n    };\n    var disable$1 = function (component, disableConfig, _disableState) {\n      disableConfig.disableClass.each(function (disableClass) {\n        add$2(component.element, disableClass);\n      });\n      var f = hasNative(component, disableConfig) ? nativeDisable : ariaDisable;\n      f(component);\n      disableConfig.onDisabled(component);\n    };\n    var enable$1 = function (component, disableConfig, _disableState) {\n      disableConfig.disableClass.each(function (disableClass) {\n        remove$2(component.element, disableClass);\n      });\n      var f = hasNative(component, disableConfig) ? nativeEnable : ariaEnable;\n      f(component);\n      disableConfig.onEnabled(component);\n    };\n    var isDisabled = function (component, disableConfig) {\n      return hasNative(component, disableConfig) ? nativeIsDisabled(component) : ariaIsDisabled(component);\n    };\n    var set$3 = function (component, disableConfig, disableState, disabled) {\n      var f = disabled ? disable$1 : enable$1;\n      f(component, disableConfig);\n    };\n\n    var DisableApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        enable: enable$1,\n        disable: disable$1,\n        isDisabled: isDisabled,\n        onLoad: onLoad$1,\n        set: set$3\n    });\n\n    var exhibit$5 = function (base, disableConfig) {\n      return nu$7({ classes: disableConfig.disabled() ? disableConfig.disableClass.toArray() : [] });\n    };\n    var events$e = function (disableConfig, disableState) {\n      return derive$2([\n        abort(execute$5(), function (component, _simulatedEvent) {\n          return isDisabled(component, disableConfig);\n        }),\n        loadEvent(disableConfig, disableState, onLoad$1)\n      ]);\n    };\n\n    var ActiveDisable = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$5,\n        events: events$e\n    });\n\n    var DisableSchema = [\n      defaultedFunction('disabled', never),\n      defaulted('useNative', true),\n      option('disableClass'),\n      onHandler('onDisabled'),\n      onHandler('onEnabled')\n    ];\n\n    var Disabling = create$7({\n      fields: DisableSchema,\n      name: 'disabling',\n      active: ActiveDisable,\n      apis: DisableApis\n    });\n\n    var dehighlightAllExcept = function (component, hConfig, hState, skip) {\n      var highlighted = descendants(component.element, '.' + hConfig.highlightClass);\n      each$1(highlighted, function (h) {\n        if (!exists(skip, function (skipComp) {\n            return skipComp.element === h;\n          })) {\n          remove$2(h, hConfig.highlightClass);\n          component.getSystem().getByDom(h).each(function (target) {\n            hConfig.onDehighlight(component, target);\n            emit(target, dehighlight$1());\n          });\n        }\n      });\n    };\n    var dehighlightAll = function (component, hConfig, hState) {\n      return dehighlightAllExcept(component, hConfig, hState, []);\n    };\n    var dehighlight = function (component, hConfig, hState, target) {\n      if (isHighlighted(component, hConfig, hState, target)) {\n        remove$2(target.element, hConfig.highlightClass);\n        hConfig.onDehighlight(component, target);\n        emit(target, dehighlight$1());\n      }\n    };\n    var highlight = function (component, hConfig, hState, target) {\n      dehighlightAllExcept(component, hConfig, hState, [target]);\n      if (!isHighlighted(component, hConfig, hState, target)) {\n        add$2(target.element, hConfig.highlightClass);\n        hConfig.onHighlight(component, target);\n        emit(target, highlight$1());\n      }\n    };\n    var highlightFirst = function (component, hConfig, hState) {\n      getFirst(component, hConfig).each(function (firstComp) {\n        highlight(component, hConfig, hState, firstComp);\n      });\n    };\n    var highlightLast = function (component, hConfig, hState) {\n      getLast(component, hConfig).each(function (lastComp) {\n        highlight(component, hConfig, hState, lastComp);\n      });\n    };\n    var highlightAt = function (component, hConfig, hState, index) {\n      getByIndex(component, hConfig, hState, index).fold(function (err) {\n        throw err;\n      }, function (firstComp) {\n        highlight(component, hConfig, hState, firstComp);\n      });\n    };\n    var highlightBy = function (component, hConfig, hState, predicate) {\n      var candidates = getCandidates(component, hConfig);\n      var targetComp = find$5(candidates, predicate);\n      targetComp.each(function (c) {\n        highlight(component, hConfig, hState, c);\n      });\n    };\n    var isHighlighted = function (component, hConfig, hState, queryTarget) {\n      return has(queryTarget.element, hConfig.highlightClass);\n    };\n    var getHighlighted = function (component, hConfig, _hState) {\n      return descendant(component.element, '.' + hConfig.highlightClass).bind(function (e) {\n        return component.getSystem().getByDom(e).toOptional();\n      });\n    };\n    var getByIndex = function (component, hConfig, hState, index) {\n      var items = descendants(component.element, '.' + hConfig.itemClass);\n      return Optional.from(items[index]).fold(function () {\n        return Result.error(new Error('No element found with index ' + index));\n      }, component.getSystem().getByDom);\n    };\n    var getFirst = function (component, hConfig, _hState) {\n      return descendant(component.element, '.' + hConfig.itemClass).bind(function (e) {\n        return component.getSystem().getByDom(e).toOptional();\n      });\n    };\n    var getLast = function (component, hConfig, _hState) {\n      var items = descendants(component.element, '.' + hConfig.itemClass);\n      var last = items.length > 0 ? Optional.some(items[items.length - 1]) : Optional.none();\n      return last.bind(function (c) {\n        return component.getSystem().getByDom(c).toOptional();\n      });\n    };\n    var getDelta$2 = function (component, hConfig, hState, delta) {\n      var items = descendants(component.element, '.' + hConfig.itemClass);\n      var current = findIndex$1(items, function (item) {\n        return has(item, hConfig.highlightClass);\n      });\n      return current.bind(function (selected) {\n        var dest = cycleBy(selected, delta, 0, items.length - 1);\n        return component.getSystem().getByDom(items[dest]).toOptional();\n      });\n    };\n    var getPrevious = function (component, hConfig, hState) {\n      return getDelta$2(component, hConfig, hState, -1);\n    };\n    var getNext = function (component, hConfig, hState) {\n      return getDelta$2(component, hConfig, hState, +1);\n    };\n    var getCandidates = function (component, hConfig, _hState) {\n      var items = descendants(component.element, '.' + hConfig.itemClass);\n      return cat(map$2(items, function (i) {\n        return component.getSystem().getByDom(i).toOptional();\n      }));\n    };\n\n    var HighlightApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        dehighlightAll: dehighlightAll,\n        dehighlight: dehighlight,\n        highlight: highlight,\n        highlightFirst: highlightFirst,\n        highlightLast: highlightLast,\n        highlightAt: highlightAt,\n        highlightBy: highlightBy,\n        isHighlighted: isHighlighted,\n        getHighlighted: getHighlighted,\n        getFirst: getFirst,\n        getLast: getLast,\n        getPrevious: getPrevious,\n        getNext: getNext,\n        getCandidates: getCandidates\n    });\n\n    var HighlightSchema = [\n      required$1('highlightClass'),\n      required$1('itemClass'),\n      onHandler('onHighlight'),\n      onHandler('onDehighlight')\n    ];\n\n    var Highlighting = create$7({\n      fields: HighlightSchema,\n      name: 'highlighting',\n      apis: HighlightApis\n    });\n\n    var BACKSPACE = [8];\n    var TAB = [9];\n    var ENTER = [13];\n    var ESCAPE = [27];\n    var SPACE = [32];\n    var LEFT = [37];\n    var UP = [38];\n    var RIGHT = [39];\n    var DOWN = [40];\n\n    var cyclePrev = function (values, index, predicate) {\n      var before = reverse(values.slice(0, index));\n      var after = reverse(values.slice(index + 1));\n      return find$5(before.concat(after), predicate);\n    };\n    var tryPrev = function (values, index, predicate) {\n      var before = reverse(values.slice(0, index));\n      return find$5(before, predicate);\n    };\n    var cycleNext = function (values, index, predicate) {\n      var before = values.slice(0, index);\n      var after = values.slice(index + 1);\n      return find$5(after.concat(before), predicate);\n    };\n    var tryNext = function (values, index, predicate) {\n      var after = values.slice(index + 1);\n      return find$5(after, predicate);\n    };\n\n    var inSet = function (keys) {\n      return function (event) {\n        var raw = event.raw;\n        return contains$2(keys, raw.which);\n      };\n    };\n    var and = function (preds) {\n      return function (event) {\n        return forall(preds, function (pred) {\n          return pred(event);\n        });\n      };\n    };\n    var isShift = function (event) {\n      var raw = event.raw;\n      return raw.shiftKey === true;\n    };\n    var isControl = function (event) {\n      var raw = event.raw;\n      return raw.ctrlKey === true;\n    };\n    var isNotShift = not(isShift);\n\n    var rule = function (matches, action) {\n      return {\n        matches: matches,\n        classification: action\n      };\n    };\n    var choose = function (transitions, event) {\n      var transition = find$5(transitions, function (t) {\n        return t.matches(event);\n      });\n      return transition.map(function (t) {\n        return t.classification;\n      });\n    };\n\n    var reportFocusShifting = function (component, prevFocus, newFocus) {\n      var noChange = prevFocus.exists(function (p) {\n        return newFocus.exists(function (n) {\n          return eq(n, p);\n        });\n      });\n      if (!noChange) {\n        emitWith(component, focusShifted(), {\n          prevFocus: prevFocus,\n          newFocus: newFocus\n        });\n      }\n    };\n    var dom$2 = function () {\n      var get = function (component) {\n        return search(component.element);\n      };\n      var set = function (component, focusee) {\n        var prevFocus = get(component);\n        component.getSystem().triggerFocus(focusee, component.element);\n        var newFocus = get(component);\n        reportFocusShifting(component, prevFocus, newFocus);\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n    var highlights = function () {\n      var get = function (component) {\n        return Highlighting.getHighlighted(component).map(function (item) {\n          return item.element;\n        });\n      };\n      var set = function (component, element) {\n        var prevFocus = get(component);\n        component.getSystem().getByDom(element).fold(noop, function (item) {\n          Highlighting.highlight(component, item);\n        });\n        var newFocus = get(component);\n        reportFocusShifting(component, prevFocus, newFocus);\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var FocusInsideModes;\n    (function (FocusInsideModes) {\n      FocusInsideModes['OnFocusMode'] = 'onFocus';\n      FocusInsideModes['OnEnterOrSpaceMode'] = 'onEnterOrSpace';\n      FocusInsideModes['OnApiMode'] = 'onApi';\n    }(FocusInsideModes || (FocusInsideModes = {})));\n\n    var typical = function (infoSchema, stateInit, getKeydownRules, getKeyupRules, optFocusIn) {\n      var schema = function () {\n        return infoSchema.concat([\n          defaulted('focusManager', dom$2()),\n          defaultedOf('focusInside', 'onFocus', valueOf(function (val) {\n            return contains$2([\n              'onFocus',\n              'onEnterOrSpace',\n              'onApi'\n            ], val) ? Result.value(val) : Result.error('Invalid value for focusInside');\n          })),\n          output$1('handler', me),\n          output$1('state', stateInit),\n          output$1('sendFocusIn', optFocusIn)\n        ]);\n      };\n      var processKey = function (component, simulatedEvent, getRules, keyingConfig, keyingState) {\n        var rules = getRules(component, simulatedEvent, keyingConfig, keyingState);\n        return choose(rules, simulatedEvent.event).bind(function (rule) {\n          return rule(component, simulatedEvent, keyingConfig, keyingState);\n        });\n      };\n      var toEvents = function (keyingConfig, keyingState) {\n        var onFocusHandler = keyingConfig.focusInside !== FocusInsideModes.OnFocusMode ? Optional.none() : optFocusIn(keyingConfig).map(function (focusIn) {\n          return run$1(focus$4(), function (component, simulatedEvent) {\n            focusIn(component, keyingConfig, keyingState);\n            simulatedEvent.stop();\n          });\n        });\n        var tryGoInsideComponent = function (component, simulatedEvent) {\n          var isEnterOrSpace = inSet(SPACE.concat(ENTER))(simulatedEvent.event);\n          if (keyingConfig.focusInside === FocusInsideModes.OnEnterOrSpaceMode && isEnterOrSpace && isSource(component, simulatedEvent)) {\n            optFocusIn(keyingConfig).each(function (focusIn) {\n              focusIn(component, keyingConfig, keyingState);\n              simulatedEvent.stop();\n            });\n          }\n        };\n        var keyboardEvents = [\n          run$1(keydown(), function (component, simulatedEvent) {\n            processKey(component, simulatedEvent, getKeydownRules, keyingConfig, keyingState).fold(function () {\n              tryGoInsideComponent(component, simulatedEvent);\n            }, function (_) {\n              simulatedEvent.stop();\n            });\n          }),\n          run$1(keyup(), function (component, simulatedEvent) {\n            processKey(component, simulatedEvent, getKeyupRules, keyingConfig, keyingState).each(function (_) {\n              simulatedEvent.stop();\n            });\n          })\n        ];\n        return derive$2(onFocusHandler.toArray().concat(keyboardEvents));\n      };\n      var me = {\n        schema: schema,\n        processKey: processKey,\n        toEvents: toEvents\n      };\n      return me;\n    };\n\n    var create$5 = function (cyclicField) {\n      var schema = [\n        option('onEscape'),\n        option('onEnter'),\n        defaulted('selector', '[data-alloy-tabstop=\"true\"]:not(:disabled)'),\n        defaulted('firstTabstop', 0),\n        defaulted('useTabstopAt', always),\n        option('visibilitySelector')\n      ].concat([cyclicField]);\n      var isVisible = function (tabbingConfig, element) {\n        var target = tabbingConfig.visibilitySelector.bind(function (sel) {\n          return closest$1(element, sel);\n        }).getOr(element);\n        return get$b(target) > 0;\n      };\n      var findInitial = function (component, tabbingConfig) {\n        var tabstops = descendants(component.element, tabbingConfig.selector);\n        var visibles = filter$2(tabstops, function (elem) {\n          return isVisible(tabbingConfig, elem);\n        });\n        return Optional.from(visibles[tabbingConfig.firstTabstop]);\n      };\n      var findCurrent = function (component, tabbingConfig) {\n        return tabbingConfig.focusManager.get(component).bind(function (elem) {\n          return closest$1(elem, tabbingConfig.selector);\n        });\n      };\n      var isTabstop = function (tabbingConfig, element) {\n        return isVisible(tabbingConfig, element) && tabbingConfig.useTabstopAt(element);\n      };\n      var focusIn = function (component, tabbingConfig, _tabbingState) {\n        findInitial(component, tabbingConfig).each(function (target) {\n          tabbingConfig.focusManager.set(component, target);\n        });\n      };\n      var goFromTabstop = function (component, tabstops, stopIndex, tabbingConfig, cycle) {\n        return cycle(tabstops, stopIndex, function (elem) {\n          return isTabstop(tabbingConfig, elem);\n        }).fold(function () {\n          return tabbingConfig.cyclic ? Optional.some(true) : Optional.none();\n        }, function (target) {\n          tabbingConfig.focusManager.set(component, target);\n          return Optional.some(true);\n        });\n      };\n      var go = function (component, _simulatedEvent, tabbingConfig, cycle) {\n        var tabstops = descendants(component.element, tabbingConfig.selector);\n        return findCurrent(component, tabbingConfig).bind(function (tabstop) {\n          var optStopIndex = findIndex$1(tabstops, curry(eq, tabstop));\n          return optStopIndex.bind(function (stopIndex) {\n            return goFromTabstop(component, tabstops, stopIndex, tabbingConfig, cycle);\n          });\n        });\n      };\n      var goBackwards = function (component, simulatedEvent, tabbingConfig) {\n        var navigate = tabbingConfig.cyclic ? cyclePrev : tryPrev;\n        return go(component, simulatedEvent, tabbingConfig, navigate);\n      };\n      var goForwards = function (component, simulatedEvent, tabbingConfig) {\n        var navigate = tabbingConfig.cyclic ? cycleNext : tryNext;\n        return go(component, simulatedEvent, tabbingConfig, navigate);\n      };\n      var execute = function (component, simulatedEvent, tabbingConfig) {\n        return tabbingConfig.onEnter.bind(function (f) {\n          return f(component, simulatedEvent);\n        });\n      };\n      var exit = function (component, simulatedEvent, tabbingConfig) {\n        return tabbingConfig.onEscape.bind(function (f) {\n          return f(component, simulatedEvent);\n        });\n      };\n      var getKeydownRules = constant$1([\n        rule(and([\n          isShift,\n          inSet(TAB)\n        ]), goBackwards),\n        rule(inSet(TAB), goForwards),\n        rule(inSet(ESCAPE), exit),\n        rule(and([\n          isNotShift,\n          inSet(ENTER)\n        ]), execute)\n      ]);\n      var getKeyupRules = constant$1([]);\n      return typical(schema, NoState.init, getKeydownRules, getKeyupRules, function () {\n        return Optional.some(focusIn);\n      });\n    };\n\n    var AcyclicType = create$5(customField('cyclic', never));\n\n    var CyclicType = create$5(customField('cyclic', always));\n\n    var doDefaultExecute = function (component, _simulatedEvent, focused) {\n      dispatch(component, focused, execute$5());\n      return Optional.some(true);\n    };\n    var defaultExecute = function (component, simulatedEvent, focused) {\n      var isComplex = inside(focused) && inSet(SPACE)(simulatedEvent.event);\n      return isComplex ? Optional.none() : doDefaultExecute(component, simulatedEvent, focused);\n    };\n    var stopEventForFirefox = function (_component, _simulatedEvent) {\n      return Optional.some(true);\n    };\n\n    var schema$v = [\n      defaulted('execute', defaultExecute),\n      defaulted('useSpace', false),\n      defaulted('useEnter', true),\n      defaulted('useControlEnter', false),\n      defaulted('useDown', false)\n    ];\n    var execute$4 = function (component, simulatedEvent, executeConfig) {\n      return executeConfig.execute(component, simulatedEvent, component.element);\n    };\n    var getKeydownRules$5 = function (component, _simulatedEvent, executeConfig, _executeState) {\n      var spaceExec = executeConfig.useSpace && !inside(component.element) ? SPACE : [];\n      var enterExec = executeConfig.useEnter ? ENTER : [];\n      var downExec = executeConfig.useDown ? DOWN : [];\n      var execKeys = spaceExec.concat(enterExec).concat(downExec);\n      return [rule(inSet(execKeys), execute$4)].concat(executeConfig.useControlEnter ? [rule(and([\n          isControl,\n          inSet(ENTER)\n        ]), execute$4)] : []);\n    };\n    var getKeyupRules$5 = function (component, _simulatedEvent, executeConfig, _executeState) {\n      return executeConfig.useSpace && !inside(component.element) ? [rule(inSet(SPACE), stopEventForFirefox)] : [];\n    };\n    var ExecutionType = typical(schema$v, NoState.init, getKeydownRules$5, getKeyupRules$5, function () {\n      return Optional.none();\n    });\n\n    var flatgrid$1 = function () {\n      var dimensions = value$1();\n      var setGridSize = function (numRows, numColumns) {\n        dimensions.set({\n          numRows: numRows,\n          numColumns: numColumns\n        });\n      };\n      var getNumRows = function () {\n        return dimensions.get().map(function (d) {\n          return d.numRows;\n        });\n      };\n      var getNumColumns = function () {\n        return dimensions.get().map(function (d) {\n          return d.numColumns;\n        });\n      };\n      return nu$8({\n        readState: function () {\n          return dimensions.get().map(function (d) {\n            return {\n              numRows: String(d.numRows),\n              numColumns: String(d.numColumns)\n            };\n          }).getOr({\n            numRows: '?',\n            numColumns: '?'\n          });\n        },\n        setGridSize: setGridSize,\n        getNumRows: getNumRows,\n        getNumColumns: getNumColumns\n      });\n    };\n    var init$d = function (spec) {\n      return spec.state(spec);\n    };\n\n    var KeyingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        flatgrid: flatgrid$1,\n        init: init$d\n    });\n\n    var useH = function (movement) {\n      return function (component, simulatedEvent, config, state) {\n        var move = movement(component.element);\n        return use(move, component, simulatedEvent, config, state);\n      };\n    };\n    var west$1 = function (moveLeft, moveRight) {\n      var movement = onDirection(moveLeft, moveRight);\n      return useH(movement);\n    };\n    var east$1 = function (moveLeft, moveRight) {\n      var movement = onDirection(moveRight, moveLeft);\n      return useH(movement);\n    };\n    var useV = function (move) {\n      return function (component, simulatedEvent, config, state) {\n        return use(move, component, simulatedEvent, config, state);\n      };\n    };\n    var use = function (move, component, simulatedEvent, config, state) {\n      var outcome = config.focusManager.get(component).bind(function (focused) {\n        return move(component.element, focused, config, state);\n      });\n      return outcome.map(function (newFocus) {\n        config.focusManager.set(component, newFocus);\n        return true;\n      });\n    };\n    var north$1 = useV;\n    var south$1 = useV;\n    var move$1 = useV;\n\n    var isHidden$1 = function (dom) {\n      return dom.offsetWidth <= 0 && dom.offsetHeight <= 0;\n    };\n    var isVisible = function (element) {\n      return !isHidden$1(element.dom);\n    };\n\n    var locate = function (candidates, predicate) {\n      return findIndex$1(candidates, predicate).map(function (index) {\n        return {\n          index: index,\n          candidates: candidates\n        };\n      });\n    };\n\n    var locateVisible = function (container, current, selector) {\n      var predicate = function (x) {\n        return eq(x, current);\n      };\n      var candidates = descendants(container, selector);\n      var visible = filter$2(candidates, isVisible);\n      return locate(visible, predicate);\n    };\n    var findIndex = function (elements, target) {\n      return findIndex$1(elements, function (elem) {\n        return eq(target, elem);\n      });\n    };\n\n    var withGrid = function (values, index, numCols, f) {\n      var oldRow = Math.floor(index / numCols);\n      var oldColumn = index % numCols;\n      return f(oldRow, oldColumn).bind(function (address) {\n        var newIndex = address.row * numCols + address.column;\n        return newIndex >= 0 && newIndex < values.length ? Optional.some(values[newIndex]) : Optional.none();\n      });\n    };\n    var cycleHorizontal$1 = function (values, index, numRows, numCols, delta) {\n      return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n        var onLastRow = oldRow === numRows - 1;\n        var colsInRow = onLastRow ? values.length - oldRow * numCols : numCols;\n        var newColumn = cycleBy(oldColumn, delta, 0, colsInRow - 1);\n        return Optional.some({\n          row: oldRow,\n          column: newColumn\n        });\n      });\n    };\n    var cycleVertical$1 = function (values, index, numRows, numCols, delta) {\n      return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n        var newRow = cycleBy(oldRow, delta, 0, numRows - 1);\n        var onLastRow = newRow === numRows - 1;\n        var colsInRow = onLastRow ? values.length - newRow * numCols : numCols;\n        var newCol = clamp$1(oldColumn, 0, colsInRow - 1);\n        return Optional.some({\n          row: newRow,\n          column: newCol\n        });\n      });\n    };\n    var cycleRight$1 = function (values, index, numRows, numCols) {\n      return cycleHorizontal$1(values, index, numRows, numCols, +1);\n    };\n    var cycleLeft$1 = function (values, index, numRows, numCols) {\n      return cycleHorizontal$1(values, index, numRows, numCols, -1);\n    };\n    var cycleUp$1 = function (values, index, numRows, numCols) {\n      return cycleVertical$1(values, index, numRows, numCols, -1);\n    };\n    var cycleDown$1 = function (values, index, numRows, numCols) {\n      return cycleVertical$1(values, index, numRows, numCols, +1);\n    };\n\n    var schema$u = [\n      required$1('selector'),\n      defaulted('execute', defaultExecute),\n      onKeyboardHandler('onEscape'),\n      defaulted('captureTab', false),\n      initSize()\n    ];\n    var focusIn$3 = function (component, gridConfig, _gridState) {\n      descendant(component.element, gridConfig.selector).each(function (first) {\n        gridConfig.focusManager.set(component, first);\n      });\n    };\n    var findCurrent$1 = function (component, gridConfig) {\n      return gridConfig.focusManager.get(component).bind(function (elem) {\n        return closest$1(elem, gridConfig.selector);\n      });\n    };\n    var execute$3 = function (component, simulatedEvent, gridConfig, _gridState) {\n      return findCurrent$1(component, gridConfig).bind(function (focused) {\n        return gridConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var doMove$2 = function (cycle) {\n      return function (element, focused, gridConfig, gridState) {\n        return locateVisible(element, focused, gridConfig.selector).bind(function (identified) {\n          return cycle(identified.candidates, identified.index, gridState.getNumRows().getOr(gridConfig.initSize.numRows), gridState.getNumColumns().getOr(gridConfig.initSize.numColumns));\n        });\n      };\n    };\n    var handleTab = function (_component, _simulatedEvent, gridConfig) {\n      return gridConfig.captureTab ? Optional.some(true) : Optional.none();\n    };\n    var doEscape$1 = function (component, simulatedEvent, gridConfig) {\n      return gridConfig.onEscape(component, simulatedEvent);\n    };\n    var moveLeft$3 = doMove$2(cycleLeft$1);\n    var moveRight$3 = doMove$2(cycleRight$1);\n    var moveNorth$1 = doMove$2(cycleUp$1);\n    var moveSouth$1 = doMove$2(cycleDown$1);\n    var getKeydownRules$4 = constant$1([\n      rule(inSet(LEFT), west$1(moveLeft$3, moveRight$3)),\n      rule(inSet(RIGHT), east$1(moveLeft$3, moveRight$3)),\n      rule(inSet(UP), north$1(moveNorth$1)),\n      rule(inSet(DOWN), south$1(moveSouth$1)),\n      rule(and([\n        isShift,\n        inSet(TAB)\n      ]), handleTab),\n      rule(and([\n        isNotShift,\n        inSet(TAB)\n      ]), handleTab),\n      rule(inSet(ESCAPE), doEscape$1),\n      rule(inSet(SPACE.concat(ENTER)), execute$3)\n    ]);\n    var getKeyupRules$4 = constant$1([rule(inSet(SPACE), stopEventForFirefox)]);\n    var FlatgridType = typical(schema$u, flatgrid$1, getKeydownRules$4, getKeyupRules$4, function () {\n      return Optional.some(focusIn$3);\n    });\n\n    var horizontal = function (container, selector, current, delta) {\n      var isDisabledButton = function (candidate) {\n        return name$2(candidate) === 'button' && get$d(candidate, 'disabled') === 'disabled';\n      };\n      var tryCycle = function (initial, index, candidates) {\n        var newIndex = cycleBy(index, delta, 0, candidates.length - 1);\n        if (newIndex === initial) {\n          return Optional.none();\n        } else {\n          return isDisabledButton(candidates[newIndex]) ? tryCycle(initial, newIndex, candidates) : Optional.from(candidates[newIndex]);\n        }\n      };\n      return locateVisible(container, current, selector).bind(function (identified) {\n        var index = identified.index;\n        var candidates = identified.candidates;\n        return tryCycle(index, index, candidates);\n      });\n    };\n\n    var schema$t = [\n      required$1('selector'),\n      defaulted('getInitial', Optional.none),\n      defaulted('execute', defaultExecute),\n      onKeyboardHandler('onEscape'),\n      defaulted('executeOnMove', false),\n      defaulted('allowVertical', true)\n    ];\n    var findCurrent = function (component, flowConfig) {\n      return flowConfig.focusManager.get(component).bind(function (elem) {\n        return closest$1(elem, flowConfig.selector);\n      });\n    };\n    var execute$2 = function (component, simulatedEvent, flowConfig) {\n      return findCurrent(component, flowConfig).bind(function (focused) {\n        return flowConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var focusIn$2 = function (component, flowConfig, _state) {\n      flowConfig.getInitial(component).orThunk(function () {\n        return descendant(component.element, flowConfig.selector);\n      }).each(function (first) {\n        flowConfig.focusManager.set(component, first);\n      });\n    };\n    var moveLeft$2 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, -1);\n    };\n    var moveRight$2 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, +1);\n    };\n    var doMove$1 = function (movement) {\n      return function (component, simulatedEvent, flowConfig, flowState) {\n        return movement(component, simulatedEvent, flowConfig, flowState).bind(function () {\n          return flowConfig.executeOnMove ? execute$2(component, simulatedEvent, flowConfig) : Optional.some(true);\n        });\n      };\n    };\n    var doEscape = function (component, simulatedEvent, flowConfig) {\n      return flowConfig.onEscape(component, simulatedEvent);\n    };\n    var getKeydownRules$3 = function (_component, _se, flowConfig, _flowState) {\n      var westMovers = LEFT.concat(flowConfig.allowVertical ? UP : []);\n      var eastMovers = RIGHT.concat(flowConfig.allowVertical ? DOWN : []);\n      return [\n        rule(inSet(westMovers), doMove$1(west$1(moveLeft$2, moveRight$2))),\n        rule(inSet(eastMovers), doMove$1(east$1(moveLeft$2, moveRight$2))),\n        rule(inSet(ENTER), execute$2),\n        rule(inSet(SPACE), execute$2),\n        rule(inSet(ESCAPE), doEscape)\n      ];\n    };\n    var getKeyupRules$3 = constant$1([rule(inSet(SPACE), stopEventForFirefox)]);\n    var FlowType = typical(schema$t, NoState.init, getKeydownRules$3, getKeyupRules$3, function () {\n      return Optional.some(focusIn$2);\n    });\n\n    var toCell = function (matrix, rowIndex, columnIndex) {\n      return Optional.from(matrix[rowIndex]).bind(function (row) {\n        return Optional.from(row[columnIndex]).map(function (cell) {\n          return {\n            rowIndex: rowIndex,\n            columnIndex: columnIndex,\n            cell: cell\n          };\n        });\n      });\n    };\n    var cycleHorizontal = function (matrix, rowIndex, startCol, deltaCol) {\n      var row = matrix[rowIndex];\n      var colsInRow = row.length;\n      var newColIndex = cycleBy(startCol, deltaCol, 0, colsInRow - 1);\n      return toCell(matrix, rowIndex, newColIndex);\n    };\n    var cycleVertical = function (matrix, colIndex, startRow, deltaRow) {\n      var nextRowIndex = cycleBy(startRow, deltaRow, 0, matrix.length - 1);\n      var colsInNextRow = matrix[nextRowIndex].length;\n      var nextColIndex = clamp$1(colIndex, 0, colsInNextRow - 1);\n      return toCell(matrix, nextRowIndex, nextColIndex);\n    };\n    var moveHorizontal = function (matrix, rowIndex, startCol, deltaCol) {\n      var row = matrix[rowIndex];\n      var colsInRow = row.length;\n      var newColIndex = clamp$1(startCol + deltaCol, 0, colsInRow - 1);\n      return toCell(matrix, rowIndex, newColIndex);\n    };\n    var moveVertical = function (matrix, colIndex, startRow, deltaRow) {\n      var nextRowIndex = clamp$1(startRow + deltaRow, 0, matrix.length - 1);\n      var colsInNextRow = matrix[nextRowIndex].length;\n      var nextColIndex = clamp$1(colIndex, 0, colsInNextRow - 1);\n      return toCell(matrix, nextRowIndex, nextColIndex);\n    };\n    var cycleRight = function (matrix, startRow, startCol) {\n      return cycleHorizontal(matrix, startRow, startCol, +1);\n    };\n    var cycleLeft = function (matrix, startRow, startCol) {\n      return cycleHorizontal(matrix, startRow, startCol, -1);\n    };\n    var cycleUp = function (matrix, startRow, startCol) {\n      return cycleVertical(matrix, startCol, startRow, -1);\n    };\n    var cycleDown = function (matrix, startRow, startCol) {\n      return cycleVertical(matrix, startCol, startRow, +1);\n    };\n    var moveLeft$1 = function (matrix, startRow, startCol) {\n      return moveHorizontal(matrix, startRow, startCol, -1);\n    };\n    var moveRight$1 = function (matrix, startRow, startCol) {\n      return moveHorizontal(matrix, startRow, startCol, +1);\n    };\n    var moveUp$1 = function (matrix, startRow, startCol) {\n      return moveVertical(matrix, startCol, startRow, -1);\n    };\n    var moveDown$1 = function (matrix, startRow, startCol) {\n      return moveVertical(matrix, startCol, startRow, +1);\n    };\n\n    var schema$s = [\n      requiredObjOf('selectors', [\n        required$1('row'),\n        required$1('cell')\n      ]),\n      defaulted('cycles', true),\n      defaulted('previousSelector', Optional.none),\n      defaulted('execute', defaultExecute)\n    ];\n    var focusIn$1 = function (component, matrixConfig, _state) {\n      var focused = matrixConfig.previousSelector(component).orThunk(function () {\n        var selectors = matrixConfig.selectors;\n        return descendant(component.element, selectors.cell);\n      });\n      focused.each(function (cell) {\n        matrixConfig.focusManager.set(component, cell);\n      });\n    };\n    var execute$1 = function (component, simulatedEvent, matrixConfig) {\n      return search(component.element).bind(function (focused) {\n        return matrixConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var toMatrix = function (rows, matrixConfig) {\n      return map$2(rows, function (row) {\n        return descendants(row, matrixConfig.selectors.cell);\n      });\n    };\n    var doMove = function (ifCycle, ifMove) {\n      return function (element, focused, matrixConfig) {\n        var move = matrixConfig.cycles ? ifCycle : ifMove;\n        return closest$1(focused, matrixConfig.selectors.row).bind(function (inRow) {\n          var cellsInRow = descendants(inRow, matrixConfig.selectors.cell);\n          return findIndex(cellsInRow, focused).bind(function (colIndex) {\n            var allRows = descendants(element, matrixConfig.selectors.row);\n            return findIndex(allRows, inRow).bind(function (rowIndex) {\n              var matrix = toMatrix(allRows, matrixConfig);\n              return move(matrix, rowIndex, colIndex).map(function (next) {\n                return next.cell;\n              });\n            });\n          });\n        });\n      };\n    };\n    var moveLeft = doMove(cycleLeft, moveLeft$1);\n    var moveRight = doMove(cycleRight, moveRight$1);\n    var moveNorth = doMove(cycleUp, moveUp$1);\n    var moveSouth = doMove(cycleDown, moveDown$1);\n    var getKeydownRules$2 = constant$1([\n      rule(inSet(LEFT), west$1(moveLeft, moveRight)),\n      rule(inSet(RIGHT), east$1(moveLeft, moveRight)),\n      rule(inSet(UP), north$1(moveNorth)),\n      rule(inSet(DOWN), south$1(moveSouth)),\n      rule(inSet(SPACE.concat(ENTER)), execute$1)\n    ]);\n    var getKeyupRules$2 = constant$1([rule(inSet(SPACE), stopEventForFirefox)]);\n    var MatrixType = typical(schema$s, NoState.init, getKeydownRules$2, getKeyupRules$2, function () {\n      return Optional.some(focusIn$1);\n    });\n\n    var schema$r = [\n      required$1('selector'),\n      defaulted('execute', defaultExecute),\n      defaulted('moveOnTab', false)\n    ];\n    var execute = function (component, simulatedEvent, menuConfig) {\n      return menuConfig.focusManager.get(component).bind(function (focused) {\n        return menuConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var focusIn = function (component, menuConfig, _state) {\n      descendant(component.element, menuConfig.selector).each(function (first) {\n        menuConfig.focusManager.set(component, first);\n      });\n    };\n    var moveUp = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, -1);\n    };\n    var moveDown = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, +1);\n    };\n    var fireShiftTab = function (component, simulatedEvent, menuConfig, menuState) {\n      return menuConfig.moveOnTab ? move$1(moveUp)(component, simulatedEvent, menuConfig, menuState) : Optional.none();\n    };\n    var fireTab = function (component, simulatedEvent, menuConfig, menuState) {\n      return menuConfig.moveOnTab ? move$1(moveDown)(component, simulatedEvent, menuConfig, menuState) : Optional.none();\n    };\n    var getKeydownRules$1 = constant$1([\n      rule(inSet(UP), move$1(moveUp)),\n      rule(inSet(DOWN), move$1(moveDown)),\n      rule(and([\n        isShift,\n        inSet(TAB)\n      ]), fireShiftTab),\n      rule(and([\n        isNotShift,\n        inSet(TAB)\n      ]), fireTab),\n      rule(inSet(ENTER), execute),\n      rule(inSet(SPACE), execute)\n    ]);\n    var getKeyupRules$1 = constant$1([rule(inSet(SPACE), stopEventForFirefox)]);\n    var MenuType = typical(schema$r, NoState.init, getKeydownRules$1, getKeyupRules$1, function () {\n      return Optional.some(focusIn);\n    });\n\n    var schema$q = [\n      onKeyboardHandler('onSpace'),\n      onKeyboardHandler('onEnter'),\n      onKeyboardHandler('onShiftEnter'),\n      onKeyboardHandler('onLeft'),\n      onKeyboardHandler('onRight'),\n      onKeyboardHandler('onTab'),\n      onKeyboardHandler('onShiftTab'),\n      onKeyboardHandler('onUp'),\n      onKeyboardHandler('onDown'),\n      onKeyboardHandler('onEscape'),\n      defaulted('stopSpaceKeyup', false),\n      option('focusIn')\n    ];\n    var getKeydownRules = function (component, simulatedEvent, specialInfo) {\n      return [\n        rule(inSet(SPACE), specialInfo.onSpace),\n        rule(and([\n          isNotShift,\n          inSet(ENTER)\n        ]), specialInfo.onEnter),\n        rule(and([\n          isShift,\n          inSet(ENTER)\n        ]), specialInfo.onShiftEnter),\n        rule(and([\n          isShift,\n          inSet(TAB)\n        ]), specialInfo.onShiftTab),\n        rule(and([\n          isNotShift,\n          inSet(TAB)\n        ]), specialInfo.onTab),\n        rule(inSet(UP), specialInfo.onUp),\n        rule(inSet(DOWN), specialInfo.onDown),\n        rule(inSet(LEFT), specialInfo.onLeft),\n        rule(inSet(RIGHT), specialInfo.onRight),\n        rule(inSet(SPACE), specialInfo.onSpace),\n        rule(inSet(ESCAPE), specialInfo.onEscape)\n      ];\n    };\n    var getKeyupRules = function (component, simulatedEvent, specialInfo) {\n      return specialInfo.stopSpaceKeyup ? [rule(inSet(SPACE), stopEventForFirefox)] : [];\n    };\n    var SpecialType = typical(schema$q, NoState.init, getKeydownRules, getKeyupRules, function (specialInfo) {\n      return specialInfo.focusIn;\n    });\n\n    var acyclic = AcyclicType.schema();\n    var cyclic = CyclicType.schema();\n    var flow = FlowType.schema();\n    var flatgrid = FlatgridType.schema();\n    var matrix = MatrixType.schema();\n    var execution = ExecutionType.schema();\n    var menu = MenuType.schema();\n    var special = SpecialType.schema();\n\n    var KeyboardBranches = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        acyclic: acyclic,\n        cyclic: cyclic,\n        flow: flow,\n        flatgrid: flatgrid,\n        matrix: matrix,\n        execution: execution,\n        menu: menu,\n        special: special\n    });\n\n    var isFlatgridState = function (keyState) {\n      return hasNonNullableKey(keyState, 'setGridSize');\n    };\n    var Keying = createModes({\n      branchKey: 'mode',\n      branches: KeyboardBranches,\n      name: 'keying',\n      active: {\n        events: function (keyingConfig, keyingState) {\n          var handler = keyingConfig.handler;\n          return handler.toEvents(keyingConfig, keyingState);\n        }\n      },\n      apis: {\n        focusIn: function (component, keyConfig, keyState) {\n          keyConfig.sendFocusIn(keyConfig).fold(function () {\n            component.getSystem().triggerFocus(component.element, component.element);\n          }, function (sendFocusIn) {\n            sendFocusIn(component, keyConfig, keyState);\n          });\n        },\n        setGridSize: function (component, keyConfig, keyState, numRows, numColumns) {\n          if (!isFlatgridState(keyState)) {\n            console.error('Layout does not support setGridSize');\n          } else {\n            keyState.setGridSize(numRows, numColumns);\n          }\n        }\n      },\n      state: KeyingState\n    });\n\n    var set$2 = function (component, replaceConfig, replaceState, data) {\n      preserve$1(function () {\n        var newChildren = map$2(data, component.getSystem().build);\n        replaceChildren(component, newChildren);\n      }, component.element);\n    };\n    var insert = function (component, replaceConfig, insertion, childSpec) {\n      var child = component.getSystem().build(childSpec);\n      attachWith(component, child, insertion);\n    };\n    var append = function (component, replaceConfig, replaceState, appendee) {\n      insert(component, replaceConfig, append$2, appendee);\n    };\n    var prepend = function (component, replaceConfig, replaceState, prependee) {\n      insert(component, replaceConfig, prepend$1, prependee);\n    };\n    var remove = function (component, replaceConfig, replaceState, removee) {\n      var children = contents(component);\n      var foundChild = find$5(children, function (child) {\n        return eq(removee.element, child.element);\n      });\n      foundChild.each(detach);\n    };\n    var contents = function (component, _replaceConfig) {\n      return component.components();\n    };\n    var replaceAt = function (component, replaceConfig, replaceState, replaceeIndex, replacer) {\n      var children = contents(component);\n      return Optional.from(children[replaceeIndex]).map(function (replacee) {\n        remove(component, replaceConfig, replaceState, replacee);\n        replacer.each(function (r) {\n          insert(component, replaceConfig, function (p, c) {\n            appendAt(p, c, replaceeIndex);\n          }, r);\n        });\n        return replacee;\n      });\n    };\n    var replaceBy = function (component, replaceConfig, replaceState, replaceePred, replacer) {\n      var children = contents(component);\n      return findIndex$1(children, replaceePred).bind(function (replaceeIndex) {\n        return replaceAt(component, replaceConfig, replaceState, replaceeIndex, replacer);\n      });\n    };\n\n    var ReplaceApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        append: append,\n        prepend: prepend,\n        remove: remove,\n        replaceAt: replaceAt,\n        replaceBy: replaceBy,\n        set: set$2,\n        contents: contents\n    });\n\n    var Replacing = create$7({\n      fields: [],\n      name: 'replacing',\n      apis: ReplaceApis\n    });\n\n    var events$d = function (name, eventHandlers) {\n      var events = derive$2(eventHandlers);\n      return create$7({\n        fields: [required$1('enabled')],\n        name: name,\n        active: { events: constant$1(events) }\n      });\n    };\n    var config = function (name, eventHandlers) {\n      var me = events$d(name, eventHandlers);\n      return {\n        key: name,\n        value: {\n          config: {},\n          me: me,\n          configAsRaw: constant$1({}),\n          initialConfig: {},\n          state: NoState\n        }\n      };\n    };\n\n    var focus$2 = function (component, focusConfig) {\n      if (!focusConfig.ignore) {\n        focus$3(component.element);\n        focusConfig.onFocus(component);\n      }\n    };\n    var blur = function (component, focusConfig) {\n      if (!focusConfig.ignore) {\n        blur$1(component.element);\n      }\n    };\n    var isFocused = function (component) {\n      return hasFocus(component.element);\n    };\n\n    var FocusApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        focus: focus$2,\n        blur: blur,\n        isFocused: isFocused\n    });\n\n    var exhibit$4 = function (base, focusConfig) {\n      var mod = focusConfig.ignore ? {} : { attributes: { tabindex: '-1' } };\n      return nu$7(mod);\n    };\n    var events$c = function (focusConfig) {\n      return derive$2([run$1(focus$4(), function (component, simulatedEvent) {\n          focus$2(component, focusConfig);\n          simulatedEvent.stop();\n        })].concat(focusConfig.stopMousedown ? [run$1(mousedown(), function (_, simulatedEvent) {\n          simulatedEvent.event.prevent();\n        })] : []));\n    };\n\n    var ActiveFocus = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$4,\n        events: events$c\n    });\n\n    var FocusSchema = [\n      onHandler('onFocus'),\n      defaulted('stopMousedown', false),\n      defaulted('ignore', false)\n    ];\n\n    var Focusing = create$7({\n      fields: FocusSchema,\n      name: 'focusing',\n      active: ActiveFocus,\n      apis: FocusApis\n    });\n\n    var SetupBehaviourCellState = function (initialState) {\n      var init = function () {\n        var cell = Cell(initialState);\n        var get = function () {\n          return cell.get();\n        };\n        var set = function (newState) {\n          return cell.set(newState);\n        };\n        var clear = function () {\n          return cell.set(initialState);\n        };\n        var readState = function () {\n          return cell.get();\n        };\n        return {\n          get: get,\n          set: set,\n          clear: clear,\n          readState: readState\n        };\n      };\n      return { init: init };\n    };\n\n    var updateAriaState = function (component, toggleConfig, toggleState) {\n      var ariaInfo = toggleConfig.aria;\n      ariaInfo.update(component, ariaInfo, toggleState.get());\n    };\n    var updateClass = function (component, toggleConfig, toggleState) {\n      toggleConfig.toggleClass.each(function (toggleClass) {\n        if (toggleState.get()) {\n          add$2(component.element, toggleClass);\n        } else {\n          remove$2(component.element, toggleClass);\n        }\n      });\n    };\n    var toggle$2 = function (component, toggleConfig, toggleState) {\n      set$1(component, toggleConfig, toggleState, !toggleState.get());\n    };\n    var on = function (component, toggleConfig, toggleState) {\n      toggleState.set(true);\n      updateClass(component, toggleConfig, toggleState);\n      updateAriaState(component, toggleConfig, toggleState);\n    };\n    var off = function (component, toggleConfig, toggleState) {\n      toggleState.set(false);\n      updateClass(component, toggleConfig, toggleState);\n      updateAriaState(component, toggleConfig, toggleState);\n    };\n    var set$1 = function (component, toggleConfig, toggleState, state) {\n      var action = state ? on : off;\n      action(component, toggleConfig, toggleState);\n    };\n    var isOn = function (component, toggleConfig, toggleState) {\n      return toggleState.get();\n    };\n    var onLoad = function (component, toggleConfig, toggleState) {\n      set$1(component, toggleConfig, toggleState, toggleConfig.selected);\n    };\n\n    var ToggleApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        onLoad: onLoad,\n        toggle: toggle$2,\n        isOn: isOn,\n        on: on,\n        off: off,\n        set: set$1\n    });\n\n    var exhibit$3 = function () {\n      return nu$7({});\n    };\n    var events$b = function (toggleConfig, toggleState) {\n      var execute = executeEvent(toggleConfig, toggleState, toggle$2);\n      var load = loadEvent(toggleConfig, toggleState, onLoad);\n      return derive$2(flatten([\n        toggleConfig.toggleOnExecute ? [execute] : [],\n        [load]\n      ]));\n    };\n\n    var ActiveToggle = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$3,\n        events: events$b\n    });\n\n    var updatePressed = function (component, ariaInfo, status) {\n      set$8(component.element, 'aria-pressed', status);\n      if (ariaInfo.syncWithExpanded) {\n        updateExpanded(component, ariaInfo, status);\n      }\n    };\n    var updateSelected = function (component, ariaInfo, status) {\n      set$8(component.element, 'aria-selected', status);\n    };\n    var updateChecked = function (component, ariaInfo, status) {\n      set$8(component.element, 'aria-checked', status);\n    };\n    var updateExpanded = function (component, ariaInfo, status) {\n      set$8(component.element, 'aria-expanded', status);\n    };\n\n    var ToggleSchema = [\n      defaulted('selected', false),\n      option('toggleClass'),\n      defaulted('toggleOnExecute', true),\n      defaultedOf('aria', { mode: 'none' }, choose$1('mode', {\n        pressed: [\n          defaulted('syncWithExpanded', false),\n          output$1('update', updatePressed)\n        ],\n        checked: [output$1('update', updateChecked)],\n        expanded: [output$1('update', updateExpanded)],\n        selected: [output$1('update', updateSelected)],\n        none: [output$1('update', noop)]\n      }))\n    ];\n\n    var Toggling = create$7({\n      fields: ToggleSchema,\n      name: 'toggling',\n      active: ActiveToggle,\n      apis: ToggleApis,\n      state: SetupBehaviourCellState(false)\n    });\n\n    var pointerEvents = function () {\n      var onClick = function (component, simulatedEvent) {\n        simulatedEvent.stop();\n        emitExecute(component);\n      };\n      return [\n        run$1(click(), onClick),\n        run$1(tap(), onClick),\n        cutter(touchstart()),\n        cutter(mousedown())\n      ];\n    };\n    var events$a = function (optAction) {\n      var executeHandler = function (action) {\n        return runOnExecute$1(function (component, simulatedEvent) {\n          action(component);\n          simulatedEvent.stop();\n        });\n      };\n      return derive$2(flatten([\n        optAction.map(executeHandler).toArray(),\n        pointerEvents()\n      ]));\n    };\n\n    var hoverEvent = 'alloy.item-hover';\n    var focusEvent = 'alloy.item-focus';\n    var onHover = function (item) {\n      if (search(item.element).isNone() || Focusing.isFocused(item)) {\n        if (!Focusing.isFocused(item)) {\n          Focusing.focus(item);\n        }\n        emitWith(item, hoverEvent, { item: item });\n      }\n    };\n    var onFocus$1 = function (item) {\n      emitWith(item, focusEvent, { item: item });\n    };\n    var hover = constant$1(hoverEvent);\n    var focus$1 = constant$1(focusEvent);\n\n    var builder$2 = function (detail) {\n      return {\n        dom: detail.dom,\n        domModification: __assign(__assign({}, detail.domModification), { attributes: __assign(__assign(__assign({ 'role': detail.toggling.isSome() ? 'menuitemcheckbox' : 'menuitem' }, detail.domModification.attributes), { 'aria-haspopup': detail.hasSubmenu }), detail.hasSubmenu ? { 'aria-expanded': false } : {}) }),\n        behaviours: SketchBehaviours.augment(detail.itemBehaviours, [\n          detail.toggling.fold(Toggling.revoke, function (tConfig) {\n            return Toggling.config(__assign({ aria: { mode: 'checked' } }, tConfig));\n          }),\n          Focusing.config({\n            ignore: detail.ignoreFocus,\n            stopMousedown: detail.ignoreFocus,\n            onFocus: function (component) {\n              onFocus$1(component);\n            }\n          }),\n          Keying.config({ mode: 'execution' }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.data\n            }\n          }),\n          config('item-type-events', __spreadArray(__spreadArray([], pointerEvents(), true), [\n            run$1(mouseover(), onHover),\n            run$1(focusItem(), Focusing.focus)\n          ], false))\n        ]),\n        components: detail.components,\n        eventOrder: detail.eventOrder\n      };\n    };\n    var schema$p = [\n      required$1('data'),\n      required$1('components'),\n      required$1('dom'),\n      defaulted('hasSubmenu', false),\n      option('toggling'),\n      SketchBehaviours.field('itemBehaviours', [\n        Toggling,\n        Focusing,\n        Keying,\n        Representing\n      ]),\n      defaulted('ignoreFocus', false),\n      defaulted('domModification', {}),\n      output$1('builder', builder$2),\n      defaulted('eventOrder', {})\n    ];\n\n    var builder$1 = function (detail) {\n      return {\n        dom: detail.dom,\n        components: detail.components,\n        events: derive$2([stopper(focusItem())])\n      };\n    };\n    var schema$o = [\n      required$1('dom'),\n      required$1('components'),\n      output$1('builder', builder$1)\n    ];\n\n    var owner$2 = constant$1('item-widget');\n    var parts$h = constant$1([required({\n        name: 'widget',\n        overrides: function (detail) {\n          return {\n            behaviours: derive$1([Representing.config({\n                store: {\n                  mode: 'manual',\n                  getValue: function (_component) {\n                    return detail.data;\n                  },\n                  setValue: noop\n                }\n              })])\n          };\n        }\n      })]);\n\n    var builder = function (detail) {\n      var subs = substitutes(owner$2(), detail, parts$h());\n      var components = components$1(owner$2(), detail, subs.internals());\n      var focusWidget = function (component) {\n        return getPart(component, detail, 'widget').map(function (widget) {\n          Keying.focusIn(widget);\n          return widget;\n        });\n      };\n      var onHorizontalArrow = function (component, simulatedEvent) {\n        return inside(simulatedEvent.event.target) ? Optional.none() : function () {\n          if (detail.autofocus) {\n            simulatedEvent.setSource(component.element);\n            return Optional.none();\n          } else {\n            return Optional.none();\n          }\n        }();\n      };\n      return {\n        dom: detail.dom,\n        components: components,\n        domModification: detail.domModification,\n        events: derive$2([\n          runOnExecute$1(function (component, simulatedEvent) {\n            focusWidget(component).each(function (_widget) {\n              simulatedEvent.stop();\n            });\n          }),\n          run$1(mouseover(), onHover),\n          run$1(focusItem(), function (component, _simulatedEvent) {\n            if (detail.autofocus) {\n              focusWidget(component);\n            } else {\n              Focusing.focus(component);\n            }\n          })\n        ]),\n        behaviours: SketchBehaviours.augment(detail.widgetBehaviours, [\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.data\n            }\n          }),\n          Focusing.config({\n            ignore: detail.ignoreFocus,\n            onFocus: function (component) {\n              onFocus$1(component);\n            }\n          }),\n          Keying.config({\n            mode: 'special',\n            focusIn: detail.autofocus ? function (component) {\n              focusWidget(component);\n            } : revoke(),\n            onLeft: onHorizontalArrow,\n            onRight: onHorizontalArrow,\n            onEscape: function (component, simulatedEvent) {\n              if (!Focusing.isFocused(component) && !detail.autofocus) {\n                Focusing.focus(component);\n                return Optional.some(true);\n              } else if (detail.autofocus) {\n                simulatedEvent.setSource(component.element);\n                return Optional.none();\n              } else {\n                return Optional.none();\n              }\n            }\n          })\n        ])\n      };\n    };\n    var schema$n = [\n      required$1('uid'),\n      required$1('data'),\n      required$1('components'),\n      required$1('dom'),\n      defaulted('autofocus', false),\n      defaulted('ignoreFocus', false),\n      SketchBehaviours.field('widgetBehaviours', [\n        Representing,\n        Focusing,\n        Keying\n      ]),\n      defaulted('domModification', {}),\n      defaultUidsSchema(parts$h()),\n      output$1('builder', builder)\n    ];\n\n    var itemSchema$2 = choose$1('type', {\n      widget: schema$n,\n      item: schema$p,\n      separator: schema$o\n    });\n    var configureGrid = function (detail, movementInfo) {\n      return {\n        mode: 'flatgrid',\n        selector: '.' + detail.markers.item,\n        initSize: {\n          numColumns: movementInfo.initSize.numColumns,\n          numRows: movementInfo.initSize.numRows\n        },\n        focusManager: detail.focusManager\n      };\n    };\n    var configureMatrix = function (detail, movementInfo) {\n      return {\n        mode: 'matrix',\n        selectors: {\n          row: movementInfo.rowSelector,\n          cell: '.' + detail.markers.item\n        },\n        focusManager: detail.focusManager\n      };\n    };\n    var configureMenu = function (detail, movementInfo) {\n      return {\n        mode: 'menu',\n        selector: '.' + detail.markers.item,\n        moveOnTab: movementInfo.moveOnTab,\n        focusManager: detail.focusManager\n      };\n    };\n    var parts$g = constant$1([group({\n        factory: {\n          sketch: function (spec) {\n            var itemInfo = asRawOrDie$1('menu.spec item', itemSchema$2, spec);\n            return itemInfo.builder(itemInfo);\n          }\n        },\n        name: 'items',\n        unit: 'item',\n        defaults: function (detail, u) {\n          return has$2(u, 'uid') ? u : __assign(__assign({}, u), { uid: generate$5('item') });\n        },\n        overrides: function (detail, u) {\n          return {\n            type: u.type,\n            ignoreFocus: detail.fakeFocus,\n            domModification: { classes: [detail.markers.item] }\n          };\n        }\n      })]);\n    var schema$m = constant$1([\n      required$1('value'),\n      required$1('items'),\n      required$1('dom'),\n      required$1('components'),\n      defaulted('eventOrder', {}),\n      field('menuBehaviours', [\n        Highlighting,\n        Representing,\n        Composing,\n        Keying\n      ]),\n      defaultedOf('movement', {\n        mode: 'menu',\n        moveOnTab: true\n      }, choose$1('mode', {\n        grid: [\n          initSize(),\n          output$1('config', configureGrid)\n        ],\n        matrix: [\n          output$1('config', configureMatrix),\n          required$1('rowSelector')\n        ],\n        menu: [\n          defaulted('moveOnTab', true),\n          output$1('config', configureMenu)\n        ]\n      })),\n      itemMarkers(),\n      defaulted('fakeFocus', false),\n      defaulted('focusManager', dom$2()),\n      onHandler('onHighlight')\n    ]);\n\n    var focus = constant$1('alloy.menu-focus');\n\n    var make$7 = function (detail, components, _spec, _externals) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        markers: detail.markers,\n        behaviours: augment(detail.menuBehaviours, [\n          Highlighting.config({\n            highlightClass: detail.markers.selectedItem,\n            itemClass: detail.markers.item,\n            onHighlight: detail.onHighlight\n          }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.value\n            }\n          }),\n          Composing.config({ find: Optional.some }),\n          Keying.config(detail.movement.config(detail, detail.movement))\n        ]),\n        events: derive$2([\n          run$1(focus$1(), function (menu, simulatedEvent) {\n            var event = simulatedEvent.event;\n            menu.getSystem().getByDom(event.target).each(function (item) {\n              Highlighting.highlight(menu, item);\n              simulatedEvent.stop();\n              emitWith(menu, focus(), {\n                menu: menu,\n                item: item\n              });\n            });\n          }),\n          run$1(hover(), function (menu, simulatedEvent) {\n            var item = simulatedEvent.event.item;\n            Highlighting.highlight(menu, item);\n          })\n        ]),\n        components: components,\n        eventOrder: detail.eventOrder,\n        domModification: { attributes: { role: 'menu' } }\n      };\n    };\n\n    var Menu = composite({\n      name: 'Menu',\n      configFields: schema$m(),\n      partFields: parts$g(),\n      factory: make$7\n    });\n\n    var transpose$1 = function (obj) {\n      return tupleMap(obj, function (v, k) {\n        return {\n          k: v,\n          v: k\n        };\n      });\n    };\n    var trace = function (items, byItem, byMenu, finish) {\n      return get$e(byMenu, finish).bind(function (triggerItem) {\n        return get$e(items, triggerItem).bind(function (triggerMenu) {\n          var rest = trace(items, byItem, byMenu, triggerMenu);\n          return Optional.some([triggerMenu].concat(rest));\n        });\n      }).getOr([]);\n    };\n    var generate$2 = function (menus, expansions) {\n      var items = {};\n      each(menus, function (menuItems, menu) {\n        each$1(menuItems, function (item) {\n          items[item] = menu;\n        });\n      });\n      var byItem = expansions;\n      var byMenu = transpose$1(expansions);\n      var menuPaths = map$1(byMenu, function (_triggerItem, submenu) {\n        return [submenu].concat(trace(items, byItem, byMenu, submenu));\n      });\n      return map$1(items, function (menu) {\n        return get$e(menuPaths, menu).getOr([menu]);\n      });\n    };\n\n    var init$c = function () {\n      var expansions = Cell({});\n      var menus = Cell({});\n      var paths = Cell({});\n      var primary = value$1();\n      var directory = Cell({});\n      var clear = function () {\n        expansions.set({});\n        menus.set({});\n        paths.set({});\n        primary.clear();\n      };\n      var isClear = function () {\n        return primary.get().isNone();\n      };\n      var setMenuBuilt = function (menuName, built) {\n        var _a;\n        menus.set(__assign(__assign({}, menus.get()), (_a = {}, _a[menuName] = {\n          type: 'prepared',\n          menu: built\n        }, _a)));\n      };\n      var setContents = function (sPrimary, sMenus, sExpansions, dir) {\n        primary.set(sPrimary);\n        expansions.set(sExpansions);\n        menus.set(sMenus);\n        directory.set(dir);\n        var sPaths = generate$2(dir, sExpansions);\n        paths.set(sPaths);\n      };\n      var getTriggeringItem = function (menuValue) {\n        return find$4(expansions.get(), function (v, _k) {\n          return v === menuValue;\n        });\n      };\n      var getTriggerData = function (menuValue, getItemByValue, path) {\n        return getPreparedMenu(menuValue).bind(function (menu) {\n          return getTriggeringItem(menuValue).bind(function (triggeringItemValue) {\n            return getItemByValue(triggeringItemValue).map(function (triggeredItem) {\n              return {\n                triggeredMenu: menu,\n                triggeringItem: triggeredItem,\n                triggeringPath: path\n              };\n            });\n          });\n        });\n      };\n      var getTriggeringPath = function (itemValue, getItemByValue) {\n        var extraPath = filter$2(lookupItem(itemValue).toArray(), function (menuValue) {\n          return getPreparedMenu(menuValue).isSome();\n        });\n        return get$e(paths.get(), itemValue).bind(function (path) {\n          var revPath = reverse(extraPath.concat(path));\n          var triggers = bind$3(revPath, function (menuValue, menuIndex) {\n            return getTriggerData(menuValue, getItemByValue, revPath.slice(0, menuIndex + 1)).fold(function () {\n              return is$1(primary.get(), menuValue) ? [] : [Optional.none()];\n            }, function (data) {\n              return [Optional.some(data)];\n            });\n          });\n          return sequence(triggers);\n        });\n      };\n      var expand = function (itemValue) {\n        return get$e(expansions.get(), itemValue).map(function (menu) {\n          var current = get$e(paths.get(), itemValue).getOr([]);\n          return [menu].concat(current);\n        });\n      };\n      var collapse = function (itemValue) {\n        return get$e(paths.get(), itemValue).bind(function (path) {\n          return path.length > 1 ? Optional.some(path.slice(1)) : Optional.none();\n        });\n      };\n      var refresh = function (itemValue) {\n        return get$e(paths.get(), itemValue);\n      };\n      var getPreparedMenu = function (menuValue) {\n        return lookupMenu(menuValue).bind(extractPreparedMenu);\n      };\n      var lookupMenu = function (menuValue) {\n        return get$e(menus.get(), menuValue);\n      };\n      var lookupItem = function (itemValue) {\n        return get$e(expansions.get(), itemValue);\n      };\n      var otherMenus = function (path) {\n        var menuValues = directory.get();\n        return difference(keys(menuValues), path);\n      };\n      var getPrimary = function () {\n        return primary.get().bind(getPreparedMenu);\n      };\n      var getMenus = function () {\n        return menus.get();\n      };\n      return {\n        setMenuBuilt: setMenuBuilt,\n        setContents: setContents,\n        expand: expand,\n        refresh: refresh,\n        collapse: collapse,\n        lookupMenu: lookupMenu,\n        lookupItem: lookupItem,\n        otherMenus: otherMenus,\n        getPrimary: getPrimary,\n        getMenus: getMenus,\n        clear: clear,\n        isClear: isClear,\n        getTriggeringPath: getTriggeringPath\n      };\n    };\n    var extractPreparedMenu = function (prep) {\n      return prep.type === 'prepared' ? Optional.some(prep.menu) : Optional.none();\n    };\n    var LayeredState = {\n      init: init$c,\n      extractPreparedMenu: extractPreparedMenu\n    };\n\n    var make$6 = function (detail, _rawUiSpec) {\n      var submenuParentItems = value$1();\n      var buildMenus = function (container, primaryName, menus) {\n        return map$1(menus, function (spec, name) {\n          var makeSketch = function () {\n            return Menu.sketch(__assign(__assign({}, spec), {\n              value: name,\n              markers: detail.markers,\n              fakeFocus: detail.fakeFocus,\n              onHighlight: detail.onHighlight,\n              focusManager: detail.fakeFocus ? highlights() : dom$2()\n            }));\n          };\n          return name === primaryName ? {\n            type: 'prepared',\n            menu: container.getSystem().build(makeSketch())\n          } : {\n            type: 'notbuilt',\n            nbMenu: makeSketch\n          };\n        });\n      };\n      var layeredState = LayeredState.init();\n      var setup = function (container) {\n        var componentMap = buildMenus(container, detail.data.primary, detail.data.menus);\n        var directory = toDirectory();\n        layeredState.setContents(detail.data.primary, componentMap, detail.data.expansions, directory);\n        return layeredState.getPrimary();\n      };\n      var getItemValue = function (item) {\n        return Representing.getValue(item).value;\n      };\n      var getItemByValue = function (_container, menus, itemValue) {\n        return findMap(menus, function (menu) {\n          if (!menu.getSystem().isConnected()) {\n            return Optional.none();\n          }\n          var candidates = Highlighting.getCandidates(menu);\n          return find$5(candidates, function (c) {\n            return getItemValue(c) === itemValue;\n          });\n        });\n      };\n      var toDirectory = function (_container) {\n        return map$1(detail.data.menus, function (data, _menuName) {\n          return bind$3(data.items, function (item) {\n            return item.type === 'separator' ? [] : [item.data.value];\n          });\n        });\n      };\n      var setActiveMenu = function (container, menu) {\n        Highlighting.highlight(container, menu);\n        Highlighting.getHighlighted(menu).orThunk(function () {\n          return Highlighting.getFirst(menu);\n        }).each(function (item) {\n          dispatch(container, item.element, focusItem());\n        });\n      };\n      var getMenus = function (state, menuValues) {\n        return cat(map$2(menuValues, function (mv) {\n          return state.lookupMenu(mv).bind(function (prep) {\n            return prep.type === 'prepared' ? Optional.some(prep.menu) : Optional.none();\n          });\n        }));\n      };\n      var closeOthers = function (container, state, path) {\n        var others = getMenus(state, state.otherMenus(path));\n        each$1(others, function (o) {\n          remove$1(o.element, [detail.markers.backgroundMenu]);\n          if (!detail.stayInDom) {\n            Replacing.remove(container, o);\n          }\n        });\n      };\n      var getSubmenuParents = function (container) {\n        return submenuParentItems.get().getOrThunk(function () {\n          var r = {};\n          var items = descendants(container.element, '.' + detail.markers.item);\n          var parentItems = filter$2(items, function (i) {\n            return get$d(i, 'aria-haspopup') === 'true';\n          });\n          each$1(parentItems, function (i) {\n            container.getSystem().getByDom(i).each(function (itemComp) {\n              var key = getItemValue(itemComp);\n              r[key] = itemComp;\n            });\n          });\n          submenuParentItems.set(r);\n          return r;\n        });\n      };\n      var updateAriaExpansions = function (container, path) {\n        var parentItems = getSubmenuParents(container);\n        each(parentItems, function (v, k) {\n          var expanded = contains$2(path, k);\n          set$8(v.element, 'aria-expanded', expanded);\n        });\n      };\n      var updateMenuPath = function (container, state, path) {\n        return Optional.from(path[0]).bind(function (latestMenuName) {\n          return state.lookupMenu(latestMenuName).bind(function (menuPrep) {\n            if (menuPrep.type === 'notbuilt') {\n              return Optional.none();\n            } else {\n              var activeMenu = menuPrep.menu;\n              var rest = getMenus(state, path.slice(1));\n              each$1(rest, function (r) {\n                add$2(r.element, detail.markers.backgroundMenu);\n              });\n              if (!inBody(activeMenu.element)) {\n                Replacing.append(container, premade(activeMenu));\n              }\n              remove$1(activeMenu.element, [detail.markers.backgroundMenu]);\n              setActiveMenu(container, activeMenu);\n              closeOthers(container, state, path);\n              return Optional.some(activeMenu);\n            }\n          });\n        });\n      };\n      var ExpandHighlightDecision;\n      (function (ExpandHighlightDecision) {\n        ExpandHighlightDecision[ExpandHighlightDecision['HighlightSubmenu'] = 0] = 'HighlightSubmenu';\n        ExpandHighlightDecision[ExpandHighlightDecision['HighlightParent'] = 1] = 'HighlightParent';\n      }(ExpandHighlightDecision || (ExpandHighlightDecision = {})));\n      var buildIfRequired = function (container, menuName, menuPrep) {\n        if (menuPrep.type === 'notbuilt') {\n          var menu = container.getSystem().build(menuPrep.nbMenu());\n          layeredState.setMenuBuilt(menuName, menu);\n          return menu;\n        } else {\n          return menuPrep.menu;\n        }\n      };\n      var expandRight = function (container, item, decision) {\n        if (decision === void 0) {\n          decision = ExpandHighlightDecision.HighlightSubmenu;\n        }\n        if (item.hasConfigured(Disabling) && Disabling.isDisabled(item)) {\n          return Optional.some(item);\n        } else {\n          var value = getItemValue(item);\n          return layeredState.expand(value).bind(function (path) {\n            updateAriaExpansions(container, path);\n            return Optional.from(path[0]).bind(function (menuName) {\n              return layeredState.lookupMenu(menuName).bind(function (activeMenuPrep) {\n                var activeMenu = buildIfRequired(container, menuName, activeMenuPrep);\n                if (!inBody(activeMenu.element)) {\n                  Replacing.append(container, premade(activeMenu));\n                }\n                detail.onOpenSubmenu(container, item, activeMenu, reverse(path));\n                if (decision === ExpandHighlightDecision.HighlightSubmenu) {\n                  Highlighting.highlightFirst(activeMenu);\n                  return updateMenuPath(container, layeredState, path);\n                } else {\n                  Highlighting.dehighlightAll(activeMenu);\n                  return Optional.some(item);\n                }\n              });\n            });\n          });\n        }\n      };\n      var collapseLeft = function (container, item) {\n        var value = getItemValue(item);\n        return layeredState.collapse(value).bind(function (path) {\n          updateAriaExpansions(container, path);\n          return updateMenuPath(container, layeredState, path).map(function (activeMenu) {\n            detail.onCollapseMenu(container, item, activeMenu);\n            return activeMenu;\n          });\n        });\n      };\n      var updateView = function (container, item) {\n        var value = getItemValue(item);\n        return layeredState.refresh(value).bind(function (path) {\n          updateAriaExpansions(container, path);\n          return updateMenuPath(container, layeredState, path);\n        });\n      };\n      var onRight = function (container, item) {\n        return inside(item.element) ? Optional.none() : expandRight(container, item, ExpandHighlightDecision.HighlightSubmenu);\n      };\n      var onLeft = function (container, item) {\n        return inside(item.element) ? Optional.none() : collapseLeft(container, item);\n      };\n      var onEscape = function (container, item) {\n        return collapseLeft(container, item).orThunk(function () {\n          return detail.onEscape(container, item).map(function () {\n            return container;\n          });\n        });\n      };\n      var keyOnItem = function (f) {\n        return function (container, simulatedEvent) {\n          return closest$1(simulatedEvent.getSource(), '.' + detail.markers.item).bind(function (target) {\n            return container.getSystem().getByDom(target).toOptional().bind(function (item) {\n              return f(container, item).map(always);\n            });\n          });\n        };\n      };\n      var events = derive$2([\n        run$1(focus(), function (sandbox, simulatedEvent) {\n          var item = simulatedEvent.event.item;\n          layeredState.lookupItem(getItemValue(item)).each(function () {\n            var menu = simulatedEvent.event.menu;\n            Highlighting.highlight(sandbox, menu);\n            var value = getItemValue(simulatedEvent.event.item);\n            layeredState.refresh(value).each(function (path) {\n              return closeOthers(sandbox, layeredState, path);\n            });\n          });\n        }),\n        runOnExecute$1(function (component, simulatedEvent) {\n          var target = simulatedEvent.event.target;\n          component.getSystem().getByDom(target).each(function (item) {\n            var itemValue = getItemValue(item);\n            if (itemValue.indexOf('collapse-item') === 0) {\n              collapseLeft(component, item);\n            }\n            expandRight(component, item, ExpandHighlightDecision.HighlightSubmenu).fold(function () {\n              detail.onExecute(component, item);\n            }, noop);\n          });\n        }),\n        runOnAttached(function (container, _simulatedEvent) {\n          setup(container).each(function (primary) {\n            Replacing.append(container, premade(primary));\n            detail.onOpenMenu(container, primary);\n            if (detail.highlightImmediately) {\n              setActiveMenu(container, primary);\n            }\n          });\n        })\n      ].concat(detail.navigateOnHover ? [run$1(hover(), function (sandbox, simulatedEvent) {\n          var item = simulatedEvent.event.item;\n          updateView(sandbox, item);\n          expandRight(sandbox, item, ExpandHighlightDecision.HighlightParent);\n          detail.onHover(sandbox, item);\n        })] : []));\n      var getActiveItem = function (container) {\n        return Highlighting.getHighlighted(container).bind(Highlighting.getHighlighted);\n      };\n      var collapseMenuApi = function (container) {\n        getActiveItem(container).each(function (currentItem) {\n          collapseLeft(container, currentItem);\n        });\n      };\n      var highlightPrimary = function (container) {\n        layeredState.getPrimary().each(function (primary) {\n          setActiveMenu(container, primary);\n        });\n      };\n      var extractMenuFromContainer = function (container) {\n        return Optional.from(container.components()[0]).filter(function (comp) {\n          return get$d(comp.element, 'role') === 'menu';\n        });\n      };\n      var repositionMenus = function (container) {\n        var maybeActivePrimary = layeredState.getPrimary().bind(function (primary) {\n          return getActiveItem(container).bind(function (currentItem) {\n            var itemValue = getItemValue(currentItem);\n            var allMenus = values(layeredState.getMenus());\n            var preparedMenus = cat(map$2(allMenus, LayeredState.extractPreparedMenu));\n            return layeredState.getTriggeringPath(itemValue, function (v) {\n              return getItemByValue(container, preparedMenus, v);\n            });\n          }).map(function (triggeringPath) {\n            return {\n              primary: primary,\n              triggeringPath: triggeringPath\n            };\n          });\n        });\n        maybeActivePrimary.fold(function () {\n          extractMenuFromContainer(container).each(function (primaryMenu) {\n            detail.onRepositionMenu(container, primaryMenu, []);\n          });\n        }, function (_a) {\n          var primary = _a.primary, triggeringPath = _a.triggeringPath;\n          detail.onRepositionMenu(container, primary, triggeringPath);\n        });\n      };\n      var apis = {\n        collapseMenu: collapseMenuApi,\n        highlightPrimary: highlightPrimary,\n        repositionMenus: repositionMenus\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        markers: detail.markers,\n        behaviours: augment(detail.tmenuBehaviours, [\n          Keying.config({\n            mode: 'special',\n            onRight: keyOnItem(onRight),\n            onLeft: keyOnItem(onLeft),\n            onEscape: keyOnItem(onEscape),\n            focusIn: function (container, _keyInfo) {\n              layeredState.getPrimary().each(function (primary) {\n                dispatch(container, primary.element, focusItem());\n              });\n            }\n          }),\n          Highlighting.config({\n            highlightClass: detail.markers.selectedMenu,\n            itemClass: detail.markers.menu\n          }),\n          Composing.config({\n            find: function (container) {\n              return Highlighting.getHighlighted(container);\n            }\n          }),\n          Replacing.config({})\n        ]),\n        eventOrder: detail.eventOrder,\n        apis: apis,\n        events: events\n      };\n    };\n    var collapseItem$1 = constant$1('collapse-item');\n\n    var tieredData = function (primary, menus, expansions) {\n      return {\n        primary: primary,\n        menus: menus,\n        expansions: expansions\n      };\n    };\n    var singleData = function (name, menu) {\n      return {\n        primary: name,\n        menus: wrap$1(name, menu),\n        expansions: {}\n      };\n    };\n    var collapseItem = function (text) {\n      return {\n        value: generate$6(collapseItem$1()),\n        meta: { text: text }\n      };\n    };\n    var tieredMenu = single({\n      name: 'TieredMenu',\n      configFields: [\n        onStrictKeyboardHandler('onExecute'),\n        onStrictKeyboardHandler('onEscape'),\n        onStrictHandler('onOpenMenu'),\n        onStrictHandler('onOpenSubmenu'),\n        onHandler('onRepositionMenu'),\n        onHandler('onCollapseMenu'),\n        defaulted('highlightImmediately', true),\n        requiredObjOf('data', [\n          required$1('primary'),\n          required$1('menus'),\n          required$1('expansions')\n        ]),\n        defaulted('fakeFocus', false),\n        onHandler('onHighlight'),\n        onHandler('onHover'),\n        tieredMenuMarkers(),\n        required$1('dom'),\n        defaulted('navigateOnHover', true),\n        defaulted('stayInDom', false),\n        field('tmenuBehaviours', [\n          Keying,\n          Highlighting,\n          Composing,\n          Replacing\n        ]),\n        defaulted('eventOrder', {})\n      ],\n      apis: {\n        collapseMenu: function (apis, tmenu) {\n          apis.collapseMenu(tmenu);\n        },\n        highlightPrimary: function (apis, tmenu) {\n          apis.highlightPrimary(tmenu);\n        },\n        repositionMenus: function (apis, tmenu) {\n          apis.repositionMenus(tmenu);\n        }\n      },\n      factory: make$6,\n      extraApis: {\n        tieredData: tieredData,\n        singleData: singleData,\n        collapseItem: collapseItem\n      }\n    });\n\n    var makeMenu = function (detail, menuSandbox, placementSpec, menuSpec, getBounds) {\n      var lazySink = function () {\n        return detail.lazySink(menuSandbox);\n      };\n      var layouts = menuSpec.type === 'horizontal' ? {\n        layouts: {\n          onLtr: function () {\n            return belowOrAbove();\n          },\n          onRtl: function () {\n            return belowOrAboveRtl();\n          }\n        }\n      } : {};\n      var isFirstTierSubmenu = function (triggeringPaths) {\n        return triggeringPaths.length === 2;\n      };\n      var getSubmenuLayouts = function (triggeringPaths) {\n        return isFirstTierSubmenu(triggeringPaths) ? layouts : {};\n      };\n      return tieredMenu.sketch({\n        dom: { tag: 'div' },\n        data: menuSpec.data,\n        markers: menuSpec.menu.markers,\n        highlightImmediately: menuSpec.menu.highlightImmediately,\n        onEscape: function () {\n          Sandboxing.close(menuSandbox);\n          detail.onEscape.map(function (handler) {\n            return handler(menuSandbox);\n          });\n          return Optional.some(true);\n        },\n        onExecute: function () {\n          return Optional.some(true);\n        },\n        onOpenMenu: function (tmenu, menu) {\n          Positioning.positionWithinBounds(lazySink().getOrDie(), menu, placementSpec, getBounds());\n        },\n        onOpenSubmenu: function (tmenu, item, submenu, triggeringPaths) {\n          var sink = lazySink().getOrDie();\n          Positioning.position(sink, submenu, {\n            anchor: __assign({\n              type: 'submenu',\n              item: item\n            }, getSubmenuLayouts(triggeringPaths))\n          });\n        },\n        onRepositionMenu: function (tmenu, primaryMenu, submenuTriggers) {\n          var sink = lazySink().getOrDie();\n          Positioning.positionWithinBounds(sink, primaryMenu, placementSpec, getBounds());\n          each$1(submenuTriggers, function (st) {\n            var submenuLayouts = getSubmenuLayouts(st.triggeringPath);\n            Positioning.position(sink, st.triggeredMenu, {\n              anchor: __assign({\n                type: 'submenu',\n                item: st.triggeringItem\n              }, submenuLayouts)\n            });\n          });\n        }\n      });\n    };\n    var factory$m = function (detail, spec) {\n      var isPartOfRelated = function (sandbox, queryElem) {\n        var related = detail.getRelated(sandbox);\n        return related.exists(function (rel) {\n          return isPartOf$1(rel, queryElem);\n        });\n      };\n      var setContent = function (sandbox, thing) {\n        Sandboxing.setContent(sandbox, thing);\n      };\n      var showAt = function (sandbox, thing, placementSpec) {\n        showWithin(sandbox, thing, placementSpec, Optional.none());\n      };\n      var showWithin = function (sandbox, thing, placementSpec, boxElement) {\n        showWithinBounds(sandbox, thing, placementSpec, function () {\n          return boxElement.map(function (elem) {\n            return box$1(elem);\n          });\n        });\n      };\n      var showWithinBounds = function (sandbox, thing, placementSpec, getBounds) {\n        var sink = detail.lazySink(sandbox).getOrDie();\n        Sandboxing.openWhileCloaked(sandbox, thing, function () {\n          return Positioning.positionWithinBounds(sink, sandbox, placementSpec, getBounds());\n        });\n        Representing.setValue(sandbox, Optional.some({\n          mode: 'position',\n          config: placementSpec,\n          getBounds: getBounds\n        }));\n      };\n      var showMenuAt = function (sandbox, placementSpec, menuSpec) {\n        showMenuWithinBounds(sandbox, placementSpec, menuSpec, Optional.none);\n      };\n      var showMenuWithinBounds = function (sandbox, placementSpec, menuSpec, getBounds) {\n        var menu = makeMenu(detail, sandbox, placementSpec, menuSpec, getBounds);\n        Sandboxing.open(sandbox, menu);\n        Representing.setValue(sandbox, Optional.some({\n          mode: 'menu',\n          menu: menu\n        }));\n      };\n      var hide = function (sandbox) {\n        if (Sandboxing.isOpen(sandbox)) {\n          Representing.setValue(sandbox, Optional.none());\n          Sandboxing.close(sandbox);\n        }\n      };\n      var getContent = function (sandbox) {\n        return Sandboxing.getState(sandbox);\n      };\n      var reposition = function (sandbox) {\n        if (Sandboxing.isOpen(sandbox)) {\n          Representing.getValue(sandbox).each(function (state) {\n            switch (state.mode) {\n            case 'menu':\n              Sandboxing.getState(sandbox).each(tieredMenu.repositionMenus);\n              break;\n            case 'position':\n              var sink = detail.lazySink(sandbox).getOrDie();\n              Positioning.positionWithinBounds(sink, sandbox, state.config, state.getBounds());\n              break;\n            }\n          });\n        }\n      };\n      var apis = {\n        setContent: setContent,\n        showAt: showAt,\n        showWithin: showWithin,\n        showWithinBounds: showWithinBounds,\n        showMenuAt: showMenuAt,\n        showMenuWithinBounds: showMenuWithinBounds,\n        hide: hide,\n        getContent: getContent,\n        reposition: reposition,\n        isOpen: Sandboxing.isOpen\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        behaviours: augment(detail.inlineBehaviours, [\n          Sandboxing.config({\n            isPartOf: function (sandbox, data, queryElem) {\n              return isPartOf$1(data, queryElem) || isPartOfRelated(sandbox, queryElem);\n            },\n            getAttachPoint: function (sandbox) {\n              return detail.lazySink(sandbox).getOrDie();\n            },\n            onOpen: function (sandbox) {\n              detail.onShow(sandbox);\n            },\n            onClose: function (sandbox) {\n              detail.onHide(sandbox);\n            }\n          }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: Optional.none()\n            }\n          }),\n          Receiving.config({\n            channels: __assign(__assign({}, receivingChannel$1(__assign({ isExtraPart: spec.isExtraPart }, detail.fireDismissalEventInstead.map(function (fe) {\n              return { fireEventInstead: { event: fe.event } };\n            }).getOr({})))), receivingChannel(__assign(__assign({}, detail.fireRepositionEventInstead.map(function (fe) {\n              return { fireEventInstead: { event: fe.event } };\n            }).getOr({})), { doReposition: reposition })))\n          })\n        ]),\n        eventOrder: detail.eventOrder,\n        apis: apis\n      };\n    };\n    var InlineView = single({\n      name: 'InlineView',\n      configFields: [\n        required$1('lazySink'),\n        onHandler('onShow'),\n        onHandler('onHide'),\n        optionFunction('onEscape'),\n        field('inlineBehaviours', [\n          Sandboxing,\n          Representing,\n          Receiving\n        ]),\n        optionObjOf('fireDismissalEventInstead', [defaulted('event', dismissRequested())]),\n        optionObjOf('fireRepositionEventInstead', [defaulted('event', repositionRequested())]),\n        defaulted('getRelated', Optional.none),\n        defaulted('isExtraPart', never),\n        defaulted('eventOrder', Optional.none)\n      ],\n      factory: factory$m,\n      apis: {\n        showAt: function (apis, component, anchor, thing) {\n          apis.showAt(component, anchor, thing);\n        },\n        showWithin: function (apis, component, anchor, thing, boxElement) {\n          apis.showWithin(component, anchor, thing, boxElement);\n        },\n        showWithinBounds: function (apis, component, anchor, thing, bounds) {\n          apis.showWithinBounds(component, anchor, thing, bounds);\n        },\n        showMenuAt: function (apis, component, anchor, menuSpec) {\n          apis.showMenuAt(component, anchor, menuSpec);\n        },\n        showMenuWithinBounds: function (apis, component, anchor, menuSpec, bounds) {\n          apis.showMenuWithinBounds(component, anchor, menuSpec, bounds);\n        },\n        hide: function (apis, component) {\n          apis.hide(component);\n        },\n        isOpen: function (apis, component) {\n          return apis.isOpen(component);\n        },\n        getContent: function (apis, component) {\n          return apis.getContent(component);\n        },\n        setContent: function (apis, component, thing) {\n          apis.setContent(component, thing);\n        },\n        reposition: function (apis, component) {\n          apis.reposition(component);\n        }\n      }\n    });\n\n    var labelPrefix = 'layout-inset';\n    var westEdgeX = function (anchor) {\n      return anchor.x;\n    };\n    var middleX = function (anchor, element) {\n      return anchor.x + anchor.width / 2 - element.width / 2;\n    };\n    var eastEdgeX = function (anchor, element) {\n      return anchor.x + anchor.width - element.width;\n    };\n    var northY = function (anchor) {\n      return anchor.y;\n    };\n    var southY = function (anchor, element) {\n      return anchor.y + anchor.height - element.height;\n    };\n    var centreY = function (anchor, element) {\n      return anchor.y + anchor.height / 2 - element.height / 2;\n    };\n    var southwest = function (anchor, element, bubbles) {\n      return nu$6(eastEdgeX(anchor, element), southY(anchor, element), bubbles.insetSouthwest(), northwest$3(), 'southwest', boundsRestriction(anchor, {\n        right: 0,\n        bottom: 3\n      }), labelPrefix);\n    };\n    var southeast = function (anchor, element, bubbles) {\n      return nu$6(westEdgeX(anchor), southY(anchor, element), bubbles.insetSoutheast(), northeast$3(), 'southeast', boundsRestriction(anchor, {\n        left: 1,\n        bottom: 3\n      }), labelPrefix);\n    };\n    var northwest = function (anchor, element, bubbles) {\n      return nu$6(eastEdgeX(anchor, element), northY(anchor), bubbles.insetNorthwest(), southwest$3(), 'northwest', boundsRestriction(anchor, {\n        right: 0,\n        top: 2\n      }), labelPrefix);\n    };\n    var northeast = function (anchor, element, bubbles) {\n      return nu$6(westEdgeX(anchor), northY(anchor), bubbles.insetNortheast(), southeast$3(), 'northeast', boundsRestriction(anchor, {\n        left: 1,\n        top: 2\n      }), labelPrefix);\n    };\n    var north = function (anchor, element, bubbles) {\n      return nu$6(middleX(anchor, element), northY(anchor), bubbles.insetNorth(), south$3(), 'north', boundsRestriction(anchor, { top: 2 }), labelPrefix);\n    };\n    var south = function (anchor, element, bubbles) {\n      return nu$6(middleX(anchor, element), southY(anchor, element), bubbles.insetSouth(), north$3(), 'south', boundsRestriction(anchor, { bottom: 3 }), labelPrefix);\n    };\n    var east = function (anchor, element, bubbles) {\n      return nu$6(eastEdgeX(anchor, element), centreY(anchor, element), bubbles.insetEast(), west$3(), 'east', boundsRestriction(anchor, { right: 0 }), labelPrefix);\n    };\n    var west = function (anchor, element, bubbles) {\n      return nu$6(westEdgeX(anchor), centreY(anchor, element), bubbles.insetWest(), east$3(), 'west', boundsRestriction(anchor, { left: 1 }), labelPrefix);\n    };\n    var lookupPreserveLayout = function (lastPlacement) {\n      switch (lastPlacement) {\n      case 'north':\n        return north;\n      case 'northeast':\n        return northeast;\n      case 'northwest':\n        return northwest;\n      case 'south':\n        return south;\n      case 'southeast':\n        return southeast;\n      case 'southwest':\n        return southwest;\n      case 'east':\n        return east;\n      case 'west':\n        return west;\n      }\n    };\n    var preserve = function (anchor, element, bubbles, placee, bounds) {\n      var layout = getPlacement(placee).map(lookupPreserveLayout).getOr(north);\n      return layout(anchor, element, bubbles, placee, bounds);\n    };\n    var lookupFlippedLayout = function (lastPlacement) {\n      switch (lastPlacement) {\n      case 'north':\n        return south;\n      case 'northeast':\n        return southeast;\n      case 'northwest':\n        return southwest;\n      case 'south':\n        return north;\n      case 'southeast':\n        return northeast;\n      case 'southwest':\n        return northwest;\n      case 'east':\n        return west;\n      case 'west':\n        return east;\n      }\n    };\n    var flip$2 = function (anchor, element, bubbles, placee, bounds) {\n      var layout = getPlacement(placee).map(lookupFlippedLayout).getOr(north);\n      return layout(anchor, element, bubbles, placee, bounds);\n    };\n\n    var global$f = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var factory$l = function (detail) {\n      var events = events$a(detail.action);\n      var tag = detail.dom.tag;\n      var lookupAttr = function (attr) {\n        return get$e(detail.dom, 'attributes').bind(function (attrs) {\n          return get$e(attrs, attr);\n        });\n      };\n      var getModAttributes = function () {\n        if (tag === 'button') {\n          var type = lookupAttr('type').getOr('button');\n          var roleAttrs = lookupAttr('role').map(function (role) {\n            return { role: role };\n          }).getOr({});\n          return __assign({ type: type }, roleAttrs);\n        } else {\n          var role = lookupAttr('role').getOr('button');\n          return { role: role };\n        }\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: detail.components,\n        events: events,\n        behaviours: SketchBehaviours.augment(detail.buttonBehaviours, [\n          Focusing.config({}),\n          Keying.config({\n            mode: 'execution',\n            useSpace: true,\n            useEnter: true\n          })\n        ]),\n        domModification: { attributes: getModAttributes() },\n        eventOrder: detail.eventOrder\n      };\n    };\n    var Button = single({\n      name: 'Button',\n      factory: factory$l,\n      configFields: [\n        defaulted('uid', undefined),\n        required$1('dom'),\n        defaulted('components', []),\n        SketchBehaviours.field('buttonBehaviours', [\n          Focusing,\n          Keying\n        ]),\n        option('action'),\n        option('role'),\n        defaulted('eventOrder', {})\n      ]\n    });\n\n    var record = function (spec) {\n      var uid = isSketchSpec(spec) && hasNonNullableKey(spec, 'uid') ? spec.uid : generate$5('memento');\n      var get = function (anyInSystem) {\n        return anyInSystem.getSystem().getByUid(uid).getOrDie();\n      };\n      var getOpt = function (anyInSystem) {\n        return anyInSystem.getSystem().getByUid(uid).toOptional();\n      };\n      var asSpec = function () {\n        return __assign(__assign({}, spec), { uid: uid });\n      };\n      return {\n        get: get,\n        getOpt: getOpt,\n        asSpec: asSpec\n      };\n    };\n\n    var global$e = tinymce.util.Tools.resolve('tinymce.util.I18n');\n\n    var rtlTransform = {\n      'indent': true,\n      'outdent': true,\n      'table-insert-column-after': true,\n      'table-insert-column-before': true,\n      'paste-column-after': true,\n      'paste-column-before': true,\n      'unordered-list': true,\n      'list-bull-circle': true,\n      'list-bull-default': true,\n      'list-bull-square': true\n    };\n    var defaultIconName = 'temporary-placeholder';\n    var defaultIcon = function (icons) {\n      return function () {\n        return get$e(icons, defaultIconName).getOr('!not found!');\n      };\n    };\n    var getIconName = function (name, icons) {\n      var lcName = name.toLowerCase();\n      if (global$e.isRtl()) {\n        var rtlName = ensureTrailing(lcName, '-rtl');\n        return has$2(icons, rtlName) ? rtlName : lcName;\n      } else {\n        return lcName;\n      }\n    };\n    var lookupIcon = function (name, icons) {\n      return get$e(icons, getIconName(name, icons));\n    };\n    var get$1 = function (name, iconProvider) {\n      var icons = iconProvider();\n      return lookupIcon(name, icons).getOrThunk(defaultIcon(icons));\n    };\n    var getOr = function (name, iconProvider, fallbackIcon) {\n      var icons = iconProvider();\n      return lookupIcon(name, icons).or(fallbackIcon).getOrThunk(defaultIcon(icons));\n    };\n    var needsRtlTransform = function (iconName) {\n      return global$e.isRtl() ? has$2(rtlTransform, iconName) : false;\n    };\n    var addFocusableBehaviour = function () {\n      return config('add-focusable', [runOnAttached(function (comp) {\n          child(comp.element, 'svg').each(function (svg) {\n            return set$8(svg, 'focusable', 'false');\n          });\n        })]);\n    };\n    var renderIcon$2 = function (spec, iconName, icons, fallbackIcon) {\n      var _a, _b;\n      var rtlIconClasses = needsRtlTransform(iconName) ? ['tox-icon--flip'] : [];\n      var iconHtml = get$e(icons, getIconName(iconName, icons)).or(fallbackIcon).getOrThunk(defaultIcon(icons));\n      return {\n        dom: {\n          tag: spec.tag,\n          attributes: (_a = spec.attributes) !== null && _a !== void 0 ? _a : {},\n          classes: spec.classes.concat(rtlIconClasses),\n          innerHtml: iconHtml\n        },\n        behaviours: derive$1(__spreadArray(__spreadArray([], (_b = spec.behaviours) !== null && _b !== void 0 ? _b : [], true), [addFocusableBehaviour()], false))\n      };\n    };\n    var render$3 = function (iconName, spec, iconProvider, fallbackIcon) {\n      if (fallbackIcon === void 0) {\n        fallbackIcon = Optional.none();\n      }\n      return renderIcon$2(spec, iconName, iconProvider(), fallbackIcon);\n    };\n    var renderFirst = function (iconNames, spec, iconProvider) {\n      var icons = iconProvider();\n      var iconName = find$5(iconNames, function (name) {\n        return has$2(icons, getIconName(name, icons));\n      });\n      return renderIcon$2(spec, iconName.getOr(defaultIconName), icons, Optional.none());\n    };\n\n    var notificationIconMap = {\n      success: 'checkmark',\n      error: 'warning',\n      err: 'error',\n      warning: 'warning',\n      warn: 'warning',\n      info: 'info'\n    };\n    var factory$k = function (detail) {\n      var memBannerText = record({\n        dom: {\n          tag: 'p',\n          innerHtml: detail.translationProvider(detail.text)\n        },\n        behaviours: derive$1([Replacing.config({})])\n      });\n      var renderPercentBar = function (percent) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-bar'],\n            attributes: { style: 'width: ' + percent + '%' }\n          }\n        };\n      };\n      var renderPercentText = function (percent) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-text'],\n            innerHtml: percent + '%'\n          }\n        };\n      };\n      var memBannerProgress = record({\n        dom: {\n          tag: 'div',\n          classes: detail.progress ? [\n            'tox-progress-bar',\n            'tox-progress-indicator'\n          ] : ['tox-progress-bar']\n        },\n        components: [\n          {\n            dom: {\n              tag: 'div',\n              classes: ['tox-bar-container']\n            },\n            components: [renderPercentBar(0)]\n          },\n          renderPercentText(0)\n        ],\n        behaviours: derive$1([Replacing.config({})])\n      });\n      var updateProgress = function (comp, percent) {\n        if (comp.getSystem().isConnected()) {\n          memBannerProgress.getOpt(comp).each(function (progress) {\n            Replacing.set(progress, [\n              {\n                dom: {\n                  tag: 'div',\n                  classes: ['tox-bar-container']\n                },\n                components: [renderPercentBar(percent)]\n              },\n              renderPercentText(percent)\n            ]);\n          });\n        }\n      };\n      var updateText = function (comp, text$1) {\n        if (comp.getSystem().isConnected()) {\n          var banner = memBannerText.get(comp);\n          Replacing.set(banner, [text(text$1)]);\n        }\n      };\n      var apis = {\n        updateProgress: updateProgress,\n        updateText: updateText\n      };\n      var iconChoices = flatten([\n        detail.icon.toArray(),\n        detail.level.toArray(),\n        detail.level.bind(function (level) {\n          return Optional.from(notificationIconMap[level]);\n        }).toArray()\n      ]);\n      var memButton = record(Button.sketch({\n        dom: {\n          tag: 'button',\n          classes: [\n            'tox-notification__dismiss',\n            'tox-button',\n            'tox-button--naked',\n            'tox-button--icon'\n          ]\n        },\n        components: [render$3('close', {\n            tag: 'div',\n            classes: ['tox-icon'],\n            attributes: { 'aria-label': detail.translationProvider('Close') }\n          }, detail.iconProvider)],\n        action: function (comp) {\n          detail.onAction(comp);\n        }\n      }));\n      var notificationIconSpec = renderFirst(iconChoices, {\n        tag: 'div',\n        classes: ['tox-notification__icon']\n      }, detail.iconProvider);\n      var notificationBodySpec = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-notification__body']\n        },\n        components: [memBannerText.asSpec()],\n        behaviours: derive$1([Replacing.config({})])\n      };\n      var components = [\n        notificationIconSpec,\n        notificationBodySpec\n      ];\n      return {\n        uid: detail.uid,\n        dom: {\n          tag: 'div',\n          attributes: { role: 'alert' },\n          classes: detail.level.map(function (level) {\n            return [\n              'tox-notification',\n              'tox-notification--in',\n              'tox-notification--' + level\n            ];\n          }).getOr([\n            'tox-notification',\n            'tox-notification--in'\n          ])\n        },\n        behaviours: derive$1([\n          Focusing.config({}),\n          config('notification-events', [run$1(focusin(), function (comp) {\n              memButton.getOpt(comp).each(Focusing.focus);\n            })])\n        ]),\n        components: components.concat(detail.progress ? [memBannerProgress.asSpec()] : []).concat(!detail.closeButton ? [] : [memButton.asSpec()]),\n        apis: apis\n      };\n    };\n    var Notification = single({\n      name: 'Notification',\n      factory: factory$k,\n      configFields: [\n        option('level'),\n        required$1('progress'),\n        required$1('icon'),\n        required$1('onAction'),\n        required$1('text'),\n        required$1('iconProvider'),\n        required$1('translationProvider'),\n        defaultedBoolean('closeButton', true)\n      ],\n      apis: {\n        updateProgress: function (apis, comp, percent) {\n          apis.updateProgress(comp, percent);\n        },\n        updateText: function (apis, comp, text) {\n          apis.updateText(comp, text);\n        }\n      }\n    });\n\n    function NotificationManagerImpl (editor, extras, uiMothership) {\n      var sharedBackstage = extras.backstage.shared;\n      var getLayoutDirection = function (rel) {\n        switch (rel) {\n        case 'bc-bc':\n          return south;\n        case 'tc-tc':\n          return north;\n        case 'tc-bc':\n          return north$2;\n        case 'bc-tc':\n        default:\n          return south$2;\n        }\n      };\n      var reposition = function (notifications) {\n        if (notifications.length > 0) {\n          each$1(notifications, function (notification, index) {\n            if (index === 0) {\n              notification.moveRel(null, 'banner');\n            } else {\n              notification.moveRel(notifications[index - 1].getEl(), 'bc-tc');\n            }\n          });\n        }\n      };\n      var open = function (settings, closeCallback) {\n        var hideCloseButton = !settings.closeButton && settings.timeout && (settings.timeout > 0 || settings.timeout < 0);\n        var close = function () {\n          closeCallback();\n          InlineView.hide(notificationWrapper);\n        };\n        var notification = build$1(Notification.sketch({\n          text: settings.text,\n          level: contains$2([\n            'success',\n            'error',\n            'warning',\n            'warn',\n            'info'\n          ], settings.type) ? settings.type : undefined,\n          progress: settings.progressBar === true,\n          icon: Optional.from(settings.icon),\n          closeButton: !hideCloseButton,\n          onAction: close,\n          iconProvider: sharedBackstage.providers.icons,\n          translationProvider: sharedBackstage.providers.translate\n        }));\n        var notificationWrapper = build$1(InlineView.sketch(__assign({\n          dom: {\n            tag: 'div',\n            classes: ['tox-notifications-container']\n          },\n          lazySink: sharedBackstage.getSink,\n          fireDismissalEventInstead: {}\n        }, sharedBackstage.header.isPositionedAtTop() ? {} : { fireRepositionEventInstead: {} })));\n        uiMothership.add(notificationWrapper);\n        if (settings.timeout > 0) {\n          global$f.setTimeout(function () {\n            close();\n          }, settings.timeout);\n        }\n        var getBounds = function () {\n          var contentArea = box$1(SugarElement.fromDom(editor.getContentAreaContainer()));\n          var win$1 = win();\n          var x = clamp$1(win$1.x, contentArea.x, contentArea.right);\n          var y = clamp$1(win$1.y, contentArea.y, contentArea.bottom);\n          var right = Math.max(contentArea.right, win$1.right);\n          var bottom = Math.max(contentArea.bottom, win$1.bottom);\n          return Optional.some(bounds(x, y, right - x, bottom - y));\n        };\n        return {\n          close: close,\n          moveTo: function (x, y) {\n            InlineView.showAt(notificationWrapper, premade(notification), {\n              anchor: {\n                type: 'makeshift',\n                x: x,\n                y: y\n              }\n            });\n          },\n          moveRel: function (element, rel) {\n            var notificationSpec = premade(notification);\n            var anchorOverrides = { maxHeightFunction: expandable$1() };\n            if (rel !== 'banner' && isNonNullable(element)) {\n              var layoutDirection_1 = getLayoutDirection(rel);\n              var nodeAnchor = {\n                type: 'node',\n                root: body(),\n                node: Optional.some(SugarElement.fromDom(element)),\n                overrides: anchorOverrides,\n                layouts: {\n                  onRtl: function () {\n                    return [layoutDirection_1];\n                  },\n                  onLtr: function () {\n                    return [layoutDirection_1];\n                  }\n                }\n              };\n              InlineView.showWithinBounds(notificationWrapper, notificationSpec, { anchor: nodeAnchor }, getBounds);\n            } else {\n              var anchor = __assign(__assign({}, sharedBackstage.anchors.banner()), { overrides: anchorOverrides });\n              InlineView.showWithinBounds(notificationWrapper, notificationSpec, { anchor: anchor }, getBounds);\n            }\n          },\n          text: function (nuText) {\n            Notification.updateText(notification, nuText);\n          },\n          settings: settings,\n          getEl: function () {\n            return notification.element.dom;\n          },\n          progressBar: {\n            value: function (percent) {\n              Notification.updateProgress(notification, percent);\n            }\n          }\n        };\n      };\n      var close = function (notification) {\n        notification.close();\n      };\n      var getArgs = function (notification) {\n        return notification.settings;\n      };\n      return {\n        open: open,\n        close: close,\n        reposition: reposition,\n        getArgs: getArgs\n      };\n    }\n\n    var first = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (!isNull(timer)) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (isNull(timer)) {\n          timer = setTimeout(function () {\n            timer = null;\n            fn.apply(null, args);\n          }, rate);\n        }\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n    var last = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (!isNull(timer)) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        cancel();\n        timer = setTimeout(function () {\n          timer = null;\n          fn.apply(null, args);\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var global$d = tinymce.util.Tools.resolve('tinymce.dom.TextSeeker');\n\n    var isBoundary = function (dom, node) {\n      return dom.isBlock(node) || contains$2([\n        'BR',\n        'IMG',\n        'HR',\n        'INPUT'\n      ], node.nodeName) || dom.getContentEditable(node) === 'false';\n    };\n    var repeatLeft = function (dom, node, offset, process, rootNode) {\n      var search = global$d(dom, function (node) {\n        return isBoundary(dom, node);\n      });\n      return Optional.from(search.backwards(node, offset, process, rootNode));\n    };\n\n    var autocompleteSelector = '[data-mce-autocompleter]';\n    var create$4 = function (editor, range) {\n      return detect(SugarElement.fromDom(editor.selection.getNode())).getOrThunk(function () {\n        var wrapper = SugarElement.fromHtml('<span data-mce-autocompleter=\"1\" data-mce-bogus=\"1\"></span>', editor.getDoc());\n        append$2(wrapper, SugarElement.fromDom(range.extractContents()));\n        range.insertNode(wrapper.dom);\n        parent(wrapper).each(function (elm) {\n          return elm.dom.normalize();\n        });\n        last$1(wrapper).map(function (last) {\n          editor.selection.setCursorLocation(last.dom, getEnd(last));\n        });\n        return wrapper;\n      });\n    };\n    var detect = function (elm) {\n      return closest$1(elm, autocompleteSelector);\n    };\n\n    var isValidTextRange = function (rng) {\n      return rng.collapsed && rng.startContainer.nodeType === 3;\n    };\n    var getText = function (rng) {\n      return rng.toString().replace(/\\u00A0/g, ' ').replace(/\\uFEFF/g, '');\n    };\n    var isWhitespace = function (chr) {\n      return chr !== '' && ' \\xA0\\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n    };\n\n    var stripTriggerChar = function (text, triggerCh) {\n      return text.substring(triggerCh.length);\n    };\n    var findChar = function (text, index, ch) {\n      var i;\n      for (i = index - 1; i >= 0; i--) {\n        var char = text.charAt(i);\n        if (isWhitespace(char)) {\n          return Optional.none();\n        }\n        if (char === ch) {\n          break;\n        }\n      }\n      return Optional.some(i);\n    };\n    var findStart = function (dom, initRange, ch, minChars) {\n      if (minChars === void 0) {\n        minChars = 0;\n      }\n      if (!isValidTextRange(initRange)) {\n        return Optional.none();\n      }\n      var findTriggerChIndex = function (element, offset, text) {\n        return findChar(text, offset, ch).getOr(offset);\n      };\n      var root = dom.getParent(initRange.startContainer, dom.isBlock) || dom.getRoot();\n      return repeatLeft(dom, initRange.startContainer, initRange.startOffset, findTriggerChIndex, root).bind(function (spot) {\n        var range = initRange.cloneRange();\n        range.setStart(spot.container, spot.offset);\n        range.setEnd(initRange.endContainer, initRange.endOffset);\n        if (range.collapsed) {\n          return Optional.none();\n        }\n        var text = getText(range);\n        var triggerCharIndex = text.lastIndexOf(ch);\n        if (triggerCharIndex !== 0 || stripTriggerChar(text, ch).length < minChars) {\n          return Optional.none();\n        } else {\n          return Optional.some({\n            text: stripTriggerChar(text, ch),\n            range: range,\n            triggerChar: ch\n          });\n        }\n      });\n    };\n    var getContext = function (dom, initRange, ch, minChars) {\n      if (minChars === void 0) {\n        minChars = 0;\n      }\n      return detect(SugarElement.fromDom(initRange.startContainer)).fold(function () {\n        return findStart(dom, initRange, ch, minChars);\n      }, function (elm) {\n        var range = dom.createRng();\n        range.selectNode(elm.dom);\n        var text = getText(range);\n        return Optional.some({\n          range: range,\n          text: stripTriggerChar(text, ch),\n          triggerChar: ch\n        });\n      });\n    };\n\n    var setup$e = function (api, editor) {\n      editor.on('keypress compositionend', api.onKeypress.throttle);\n      editor.on('remove', api.onKeypress.cancel);\n      var redirectKeyToItem = function (item, e) {\n        emitWith(item, keydown(), { raw: e });\n      };\n      editor.on('keydown', function (e) {\n        var getItem = function () {\n          return api.getView().bind(Highlighting.getHighlighted);\n        };\n        if (e.which === 8) {\n          api.onKeypress.throttle(e);\n        }\n        if (api.isActive()) {\n          if (e.which === 27) {\n            api.cancelIfNecessary();\n          }\n          if (api.isMenuOpen()) {\n            if (e.which === 13) {\n              getItem().each(emitExecute);\n              e.preventDefault();\n            } else if (e.which === 40) {\n              getItem().fold(function () {\n                api.getView().each(Highlighting.highlightFirst);\n              }, function (item) {\n                redirectKeyToItem(item, e);\n              });\n              e.preventDefault();\n              e.stopImmediatePropagation();\n            } else if (e.which === 37 || e.which === 38 || e.which === 39) {\n              getItem().each(function (item) {\n                redirectKeyToItem(item, e);\n                e.preventDefault();\n                e.stopImmediatePropagation();\n              });\n            }\n          } else {\n            if (e.which === 13 || e.which === 38 || e.which === 40) {\n              api.cancelIfNecessary();\n            }\n          }\n        }\n      });\n      editor.on('NodeChange', function (e) {\n        if (api.isActive() && !api.isProcessingAction() && detect(SugarElement.fromDom(e.element)).isNone()) {\n          api.cancelIfNecessary();\n        }\n      });\n    };\n    var AutocompleterEditorEvents = { setup: setup$e };\n\n    var global$c = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var point = function (container, offset) {\n      return {\n        container: container,\n        offset: offset\n      };\n    };\n\n    var isText = function (node) {\n      return node.nodeType === TEXT;\n    };\n    var isElement$1 = function (node) {\n      return node.nodeType === ELEMENT;\n    };\n    var toLast = function (node) {\n      if (isText(node)) {\n        return point(node, node.data.length);\n      } else {\n        var children = node.childNodes;\n        return children.length > 0 ? toLast(children[children.length - 1]) : point(node, children.length);\n      }\n    };\n    var toLeaf = function (node, offset) {\n      var children = node.childNodes;\n      if (children.length > 0 && offset < children.length) {\n        return toLeaf(children[offset], 0);\n      } else if (children.length > 0 && isElement$1(node) && children.length === offset) {\n        return toLast(children[children.length - 1]);\n      } else {\n        return point(node, offset);\n      }\n    };\n\n    var isPreviousCharContent = function (dom, leaf) {\n      return repeatLeft(dom, leaf.container, leaf.offset, function (element, offset) {\n        return offset === 0 ? -1 : offset;\n      }, dom.getRoot()).filter(function (spot) {\n        var char = spot.container.data.charAt(spot.offset - 1);\n        return !isWhitespace(char);\n      }).isSome();\n    };\n    var isStartOfWord = function (dom) {\n      return function (rng) {\n        var leaf = toLeaf(rng.startContainer, rng.startOffset);\n        return !isPreviousCharContent(dom, leaf);\n      };\n    };\n    var getTriggerContext = function (dom, initRange, database) {\n      return findMap(database.triggerChars, function (ch) {\n        return getContext(dom, initRange, ch);\n      });\n    };\n    var lookup$2 = function (editor, getDatabase) {\n      var database = getDatabase();\n      var rng = editor.selection.getRng();\n      return getTriggerContext(editor.dom, rng, database).bind(function (context) {\n        return lookupWithContext(editor, getDatabase, context);\n      });\n    };\n    var lookupWithContext = function (editor, getDatabase, context, fetchOptions) {\n      if (fetchOptions === void 0) {\n        fetchOptions = {};\n      }\n      var database = getDatabase();\n      var rng = editor.selection.getRng();\n      var startText = rng.startContainer.nodeValue;\n      var autocompleters = filter$2(database.lookupByChar(context.triggerChar), function (autocompleter) {\n        return context.text.length >= autocompleter.minChars && autocompleter.matches.getOrThunk(function () {\n          return isStartOfWord(editor.dom);\n        })(context.range, startText, context.text);\n      });\n      if (autocompleters.length === 0) {\n        return Optional.none();\n      }\n      var lookupData = global$c.all(map$2(autocompleters, function (ac) {\n        var fetchResult = ac.fetch(context.text, ac.maxResults, fetchOptions);\n        return fetchResult.then(function (results) {\n          return {\n            matchText: context.text,\n            items: results,\n            columns: ac.columns,\n            onAction: ac.onAction,\n            highlightOn: ac.highlightOn\n          };\n        });\n      }));\n      return Optional.some({\n        lookupData: lookupData,\n        context: context\n      });\n    };\n\n    var separatorMenuItemSchema = objOf([\n      requiredString('type'),\n      optionString('text')\n    ]);\n    var createSeparatorMenuItem = function (spec) {\n      return asRaw('separatormenuitem', separatorMenuItemSchema, spec);\n    };\n\n    var autocompleterItemSchema = objOf([\n      defaulted('type', 'autocompleteitem'),\n      defaulted('active', false),\n      defaulted('disabled', false),\n      defaulted('meta', {}),\n      requiredString('value'),\n      optionString('text'),\n      optionString('icon')\n    ]);\n    var autocompleterSchema = objOf([\n      requiredString('type'),\n      requiredString('ch'),\n      defaultedNumber('minChars', 1),\n      defaulted('columns', 1),\n      defaultedNumber('maxResults', 10),\n      optionFunction('matches'),\n      requiredFunction('fetch'),\n      requiredFunction('onAction'),\n      defaultedArrayOf('highlightOn', [], string)\n    ]);\n    var createSeparatorItem = function (spec) {\n      return asRaw('Autocompleter.Separator', separatorMenuItemSchema, spec);\n    };\n    var createAutocompleterItem = function (spec) {\n      return asRaw('Autocompleter.Item', autocompleterItemSchema, spec);\n    };\n    var createAutocompleter = function (spec) {\n      return asRaw('Autocompleter', autocompleterSchema, spec);\n    };\n\n    var baseToolbarButtonFields = [\n      defaultedBoolean('disabled', false),\n      optionString('tooltip'),\n      optionString('icon'),\n      optionString('text'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      })\n    ];\n    var toolbarButtonSchema = objOf([\n      requiredString('type'),\n      requiredFunction('onAction')\n    ].concat(baseToolbarButtonFields));\n    var createToolbarButton = function (spec) {\n      return asRaw('toolbarbutton', toolbarButtonSchema, spec);\n    };\n\n    var baseToolbarToggleButtonFields = [defaultedBoolean('active', false)].concat(baseToolbarButtonFields);\n    var toggleButtonSchema = objOf(baseToolbarToggleButtonFields.concat([\n      requiredString('type'),\n      requiredFunction('onAction')\n    ]));\n    var createToggleButton = function (spec) {\n      return asRaw('ToggleButton', toggleButtonSchema, spec);\n    };\n\n    var contextBarFields = [\n      defaultedFunction('predicate', never),\n      defaultedStringEnum('scope', 'node', [\n        'node',\n        'editor'\n      ]),\n      defaultedStringEnum('position', 'selection', [\n        'node',\n        'selection',\n        'line'\n      ])\n    ];\n\n    var contextButtonFields = baseToolbarButtonFields.concat([\n      defaulted('type', 'contextformbutton'),\n      defaulted('primary', false),\n      requiredFunction('onAction'),\n      customField('original', identity$1)\n    ]);\n    var contextToggleButtonFields = baseToolbarToggleButtonFields.concat([\n      defaulted('type', 'contextformbutton'),\n      defaulted('primary', false),\n      requiredFunction('onAction'),\n      customField('original', identity$1)\n    ]);\n    var launchButtonFields = baseToolbarButtonFields.concat([defaulted('type', 'contextformbutton')]);\n    var launchToggleButtonFields = baseToolbarToggleButtonFields.concat([defaulted('type', 'contextformtogglebutton')]);\n    var toggleOrNormal = choose$1('type', {\n      contextformbutton: contextButtonFields,\n      contextformtogglebutton: contextToggleButtonFields\n    });\n    var contextFormSchema = objOf([\n      defaulted('type', 'contextform'),\n      defaultedFunction('initValue', constant$1('')),\n      optionString('label'),\n      requiredArrayOf('commands', toggleOrNormal),\n      optionOf('launch', choose$1('type', {\n        contextformbutton: launchButtonFields,\n        contextformtogglebutton: launchToggleButtonFields\n      }))\n    ].concat(contextBarFields));\n    var createContextForm = function (spec) {\n      return asRaw('ContextForm', contextFormSchema, spec);\n    };\n\n    var contextToolbarSchema = objOf([\n      defaulted('type', 'contexttoolbar'),\n      requiredString('items')\n    ].concat(contextBarFields));\n    var createContextToolbar = function (spec) {\n      return asRaw('ContextToolbar', contextToolbarSchema, spec);\n    };\n\n    var stringArray = function (a) {\n      var all = {};\n      each$1(a, function (key) {\n        all[key] = {};\n      });\n      return keys(all);\n    };\n\n    var register$b = function (editor) {\n      var popups = editor.ui.registry.getAll().popups;\n      var dataset = map$1(popups, function (popup) {\n        return createAutocompleter(popup).fold(function (err) {\n          throw new Error(formatError(err));\n        }, identity$1);\n      });\n      var triggerChars = stringArray(mapToArray(dataset, function (v) {\n        return v.ch;\n      }));\n      var datasetValues = values(dataset);\n      var lookupByChar = function (ch) {\n        return filter$2(datasetValues, function (dv) {\n          return dv.ch === ch;\n        });\n      };\n      return {\n        dataset: dataset,\n        triggerChars: triggerChars,\n        lookupByChar: lookupByChar\n      };\n    };\n\n    var ItemResponse;\n    (function (ItemResponse) {\n      ItemResponse[ItemResponse['CLOSE_ON_EXECUTE'] = 0] = 'CLOSE_ON_EXECUTE';\n      ItemResponse[ItemResponse['BUBBLE_TO_SANDBOX'] = 1] = 'BUBBLE_TO_SANDBOX';\n    }(ItemResponse || (ItemResponse = {})));\n    var ItemResponse$1 = ItemResponse;\n\n    var navClass = 'tox-menu-nav__js';\n    var selectableClass = 'tox-collection__item';\n    var colorClass = 'tox-swatch';\n    var presetClasses = {\n      normal: navClass,\n      color: colorClass\n    };\n    var tickedClass = 'tox-collection__item--enabled';\n    var groupHeadingClass = 'tox-collection__group-heading';\n    var iconClass = 'tox-collection__item-icon';\n    var textClass = 'tox-collection__item-label';\n    var accessoryClass = 'tox-collection__item-accessory';\n    var caretClass = 'tox-collection__item-caret';\n    var checkmarkClass = 'tox-collection__item-checkmark';\n    var activeClass = 'tox-collection__item--active';\n    var containerClass = 'tox-collection__item-container';\n    var containerColumnClass = 'tox-collection__item-container--column';\n    var containerRowClass = 'tox-collection__item-container--row';\n    var containerAlignRightClass = 'tox-collection__item-container--align-right';\n    var containerAlignLeftClass = 'tox-collection__item-container--align-left';\n    var containerValignTopClass = 'tox-collection__item-container--valign-top';\n    var containerValignMiddleClass = 'tox-collection__item-container--valign-middle';\n    var containerValignBottomClass = 'tox-collection__item-container--valign-bottom';\n    var classForPreset = function (presets) {\n      return get$e(presetClasses, presets).getOr(navClass);\n    };\n\n    var forMenu = function (presets) {\n      if (presets === 'color') {\n        return 'tox-swatches';\n      } else {\n        return 'tox-menu';\n      }\n    };\n    var classes = function (presets) {\n      return {\n        backgroundMenu: 'tox-background-menu',\n        selectedMenu: 'tox-selected-menu',\n        selectedItem: 'tox-collection__item--active',\n        hasIcons: 'tox-menu--has-icons',\n        menu: forMenu(presets),\n        tieredMenu: 'tox-tiered-menu'\n      };\n    };\n\n    var markers = function (presets) {\n      var menuClasses = classes(presets);\n      return {\n        backgroundMenu: menuClasses.backgroundMenu,\n        selectedMenu: menuClasses.selectedMenu,\n        menu: menuClasses.menu,\n        selectedItem: menuClasses.selectedItem,\n        item: classForPreset(presets)\n      };\n    };\n    var dom$1 = function (hasIcons, columns, presets) {\n      var menuClasses = classes(presets);\n      return {\n        tag: 'div',\n        classes: flatten([\n          [\n            menuClasses.menu,\n            'tox-menu-' + columns + '-column'\n          ],\n          hasIcons ? [menuClasses.hasIcons] : []\n        ])\n      };\n    };\n    var components = [Menu.parts.items({})];\n    var part = function (hasIcons, columns, presets) {\n      var menuClasses = classes(presets);\n      var d = {\n        tag: 'div',\n        classes: flatten([[menuClasses.tieredMenu]])\n      };\n      return {\n        dom: d,\n        markers: markers(presets)\n      };\n    };\n\n    var chunk = function (rowDom, numColumns) {\n      return function (items) {\n        var chunks = chunk$1(items, numColumns);\n        return map$2(chunks, function (c) {\n          return {\n            dom: rowDom,\n            components: c\n          };\n        });\n      };\n    };\n    var forSwatch = function (columns) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-menu',\n            'tox-swatches-menu'\n          ]\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-swatches']\n            },\n            components: [Menu.parts.items({\n                preprocess: columns !== 'auto' ? chunk({\n                  tag: 'div',\n                  classes: ['tox-swatches__row']\n                }, columns) : identity$1\n              })]\n          }]\n      };\n    };\n    var forToolbar = function (columns) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-menu',\n            'tox-collection',\n            'tox-collection--toolbar',\n            'tox-collection--toolbar-lg'\n          ]\n        },\n        components: [Menu.parts.items({\n            preprocess: chunk({\n              tag: 'div',\n              classes: ['tox-collection__group']\n            }, columns)\n          })]\n      };\n    };\n    var preprocessCollection = function (items, isSeparator) {\n      var allSplits = [];\n      var currentSplit = [];\n      each$1(items, function (item, i) {\n        if (isSeparator(item, i)) {\n          if (currentSplit.length > 0) {\n            allSplits.push(currentSplit);\n          }\n          currentSplit = [];\n          if (has$2(item.dom, 'innerHtml')) {\n            currentSplit.push(item);\n          }\n        } else {\n          currentSplit.push(item);\n        }\n      });\n      if (currentSplit.length > 0) {\n        allSplits.push(currentSplit);\n      }\n      return map$2(allSplits, function (s) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-collection__group']\n          },\n          components: s\n        };\n      });\n    };\n    var forCollection = function (columns, initItems, _hasIcons) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-menu',\n            'tox-collection'\n          ].concat(columns === 1 ? ['tox-collection--list'] : ['tox-collection--grid'])\n        },\n        components: [Menu.parts.items({\n            preprocess: function (items) {\n              if (columns !== 'auto' && columns > 1) {\n                return chunk({\n                  tag: 'div',\n                  classes: ['tox-collection__group']\n                }, columns)(items);\n              } else {\n                return preprocessCollection(items, function (_item, i) {\n                  return initItems[i].type === 'separator';\n                });\n              }\n            }\n          })]\n      };\n    };\n    var forHorizontalCollection = function (initItems, _hasIcons) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-collection',\n            'tox-collection--horizontal'\n          ]\n        },\n        components: [Menu.parts.items({\n            preprocess: function (items) {\n              return preprocessCollection(items, function (_item, i) {\n                return initItems[i].type === 'separator';\n              });\n            }\n          })]\n      };\n    };\n\n    var menuHasIcons = function (xs) {\n      return exists(xs, function (item) {\n        return 'icon' in item && item.icon !== undefined;\n      });\n    };\n    var handleError = function (error) {\n      console.error(formatError(error));\n      console.log(error);\n      return Optional.none();\n    };\n    var createHorizontalPartialMenuWithAlloyItems = function (value, _hasIcons, items, _columns, _presets) {\n      var structure = forHorizontalCollection(items);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    };\n    var createPartialMenuWithAlloyItems = function (value, hasIcons, items, columns, presets) {\n      if (presets === 'color') {\n        var structure = forSwatch(columns);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      if (presets === 'normal' && columns === 'auto') {\n        var structure = forCollection(columns, items);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      if (presets === 'normal' && columns === 1) {\n        var structure = forCollection(1, items);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      if (presets === 'normal') {\n        var structure = forCollection(columns, items);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      if (presets === 'listpreview' && columns !== 'auto') {\n        var structure = forToolbar(columns);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      return {\n        value: value,\n        dom: dom$1(hasIcons, columns, presets),\n        components: components,\n        items: items\n      };\n    };\n\n    var cardImageFields = [\n      requiredString('type'),\n      requiredString('src'),\n      optionString('alt'),\n      defaultedArrayOf('classes', [], string)\n    ];\n    var cardImageSchema = objOf(cardImageFields);\n\n    var cardTextFields = [\n      requiredString('type'),\n      requiredString('text'),\n      optionString('name'),\n      defaultedArrayOf('classes', ['tox-collection__item-label'], string)\n    ];\n    var cardTextSchema = objOf(cardTextFields);\n\n    var itemSchema$1 = valueThunk(function () {\n      return choose$2('type', {\n        cardimage: cardImageSchema,\n        cardtext: cardTextSchema,\n        cardcontainer: cardContainerSchema\n      });\n    });\n    var cardContainerSchema = objOf([\n      requiredString('type'),\n      defaultedString('direction', 'horizontal'),\n      defaultedString('align', 'left'),\n      defaultedString('valign', 'middle'),\n      requiredArrayOf('items', itemSchema$1)\n    ]);\n\n    var commonMenuItemFields = [\n      defaultedBoolean('disabled', false),\n      optionString('text'),\n      optionString('shortcut'),\n      field$1('value', 'value', defaultedThunk(function () {\n        return generate$6('menuitem-value');\n      }), anyValue()),\n      defaulted('meta', {})\n    ];\n\n    var cardMenuItemSchema = objOf([\n      requiredString('type'),\n      optionString('label'),\n      requiredArrayOf('items', itemSchema$1),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      defaultedFunction('onAction', noop)\n    ].concat(commonMenuItemFields));\n    var createCardMenuItem = function (spec) {\n      return asRaw('cardmenuitem', cardMenuItemSchema, spec);\n    };\n\n    var choiceMenuItemSchema = objOf([\n      requiredString('type'),\n      defaultedBoolean('active', false),\n      optionString('icon')\n    ].concat(commonMenuItemFields));\n    var createChoiceMenuItem = function (spec) {\n      return asRaw('choicemenuitem', choiceMenuItemSchema, spec);\n    };\n\n    var baseFields = [\n      requiredString('type'),\n      requiredString('fancytype'),\n      defaultedFunction('onAction', noop)\n    ];\n    var insertTableFields = [defaulted('initData', {})].concat(baseFields);\n    var colorSwatchFields = [defaultedObjOf('initData', {}, [\n        defaultedBoolean('allowCustomColors', true),\n        optionArrayOf('colors', anyValue())\n      ])].concat(baseFields);\n    var fancyMenuItemSchema = choose$1('fancytype', {\n      inserttable: insertTableFields,\n      colorswatch: colorSwatchFields\n    });\n    var createFancyMenuItem = function (spec) {\n      return asRaw('fancymenuitem', fancyMenuItemSchema, spec);\n    };\n\n    var menuItemSchema = objOf([\n      requiredString('type'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      defaultedFunction('onAction', noop),\n      optionString('icon')\n    ].concat(commonMenuItemFields));\n    var createMenuItem = function (spec) {\n      return asRaw('menuitem', menuItemSchema, spec);\n    };\n\n    var nestedMenuItemSchema = objOf([\n      requiredString('type'),\n      requiredFunction('getSubmenuItems'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      optionString('icon')\n    ].concat(commonMenuItemFields));\n    var createNestedMenuItem = function (spec) {\n      return asRaw('nestedmenuitem', nestedMenuItemSchema, spec);\n    };\n\n    var toggleMenuItemSchema = objOf([\n      requiredString('type'),\n      optionString('icon'),\n      defaultedBoolean('active', false),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      requiredFunction('onAction')\n    ].concat(commonMenuItemFields));\n    var createToggleMenuItem = function (spec) {\n      return asRaw('togglemenuitem', toggleMenuItemSchema, spec);\n    };\n\n    var detectSize = function (comp, margin, selectorClass) {\n      var descendants$1 = descendants(comp.element, '.' + selectorClass);\n      if (descendants$1.length > 0) {\n        var columnLength = findIndex$1(descendants$1, function (c) {\n          var thisTop = c.dom.getBoundingClientRect().top;\n          var cTop = descendants$1[0].dom.getBoundingClientRect().top;\n          return Math.abs(thisTop - cTop) > margin;\n        }).getOr(descendants$1.length);\n        return Optional.some({\n          numColumns: columnLength,\n          numRows: Math.ceil(descendants$1.length / columnLength)\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n\n    var namedEvents = function (name, handlers) {\n      return derive$1([config(name, handlers)]);\n    };\n    var unnamedEvents = function (handlers) {\n      return namedEvents(generate$6('unnamed-events'), handlers);\n    };\n    var SimpleBehaviours = {\n      namedEvents: namedEvents,\n      unnamedEvents: unnamedEvents\n    };\n\n    var ExclusivityChannel = generate$6('tooltip.exclusive');\n    var ShowTooltipEvent = generate$6('tooltip.show');\n    var HideTooltipEvent = generate$6('tooltip.hide');\n\n    var hideAllExclusive = function (component, _tConfig, _tState) {\n      component.getSystem().broadcastOn([ExclusivityChannel], {});\n    };\n    var setComponents = function (component, tConfig, tState, specs) {\n      tState.getTooltip().each(function (tooltip) {\n        if (tooltip.getSystem().isConnected()) {\n          Replacing.set(tooltip, specs);\n        }\n      });\n    };\n\n    var TooltippingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        hideAllExclusive: hideAllExclusive,\n        setComponents: setComponents\n    });\n\n    var events$9 = function (tooltipConfig, state) {\n      var hide = function (comp) {\n        state.getTooltip().each(function (p) {\n          detach(p);\n          tooltipConfig.onHide(comp, p);\n          state.clearTooltip();\n        });\n        state.clearTimer();\n      };\n      var show = function (comp) {\n        if (!state.isShowing()) {\n          hideAllExclusive(comp);\n          var sink = tooltipConfig.lazySink(comp).getOrDie();\n          var popup = comp.getSystem().build({\n            dom: tooltipConfig.tooltipDom,\n            components: tooltipConfig.tooltipComponents,\n            events: derive$2(tooltipConfig.mode === 'normal' ? [\n              run$1(mouseover(), function (_) {\n                emit(comp, ShowTooltipEvent);\n              }),\n              run$1(mouseout(), function (_) {\n                emit(comp, HideTooltipEvent);\n              })\n            ] : []),\n            behaviours: derive$1([Replacing.config({})])\n          });\n          state.setTooltip(popup);\n          attach(sink, popup);\n          tooltipConfig.onShow(comp, popup);\n          Positioning.position(sink, popup, { anchor: tooltipConfig.anchor(comp) });\n        }\n      };\n      return derive$2(flatten([\n        [\n          run$1(ShowTooltipEvent, function (comp) {\n            state.resetTimer(function () {\n              show(comp);\n            }, tooltipConfig.delay);\n          }),\n          run$1(HideTooltipEvent, function (comp) {\n            state.resetTimer(function () {\n              hide(comp);\n            }, tooltipConfig.delay);\n          }),\n          run$1(receive(), function (comp, message) {\n            var receivingData = message;\n            if (!receivingData.universal) {\n              if (contains$2(receivingData.channels, ExclusivityChannel)) {\n                hide(comp);\n              }\n            }\n          }),\n          runOnDetached(function (comp) {\n            hide(comp);\n          })\n        ],\n        tooltipConfig.mode === 'normal' ? [\n          run$1(focusin(), function (comp) {\n            emit(comp, ShowTooltipEvent);\n          }),\n          run$1(postBlur(), function (comp) {\n            emit(comp, HideTooltipEvent);\n          }),\n          run$1(mouseover(), function (comp) {\n            emit(comp, ShowTooltipEvent);\n          }),\n          run$1(mouseout(), function (comp) {\n            emit(comp, HideTooltipEvent);\n          })\n        ] : [\n          run$1(highlight$1(), function (comp, _se) {\n            emit(comp, ShowTooltipEvent);\n          }),\n          run$1(dehighlight$1(), function (comp) {\n            emit(comp, HideTooltipEvent);\n          })\n        ]\n      ]));\n    };\n\n    var ActiveTooltipping = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$9\n    });\n\n    var TooltippingSchema = [\n      required$1('lazySink'),\n      required$1('tooltipDom'),\n      defaulted('exclusive', true),\n      defaulted('tooltipComponents', []),\n      defaulted('delay', 300),\n      defaultedStringEnum('mode', 'normal', [\n        'normal',\n        'follow-highlight'\n      ]),\n      defaulted('anchor', function (comp) {\n        return {\n          type: 'hotspot',\n          hotspot: comp,\n          layouts: {\n            onLtr: constant$1([\n              south$2,\n              north$2,\n              southeast$2,\n              northeast$2,\n              southwest$2,\n              northwest$2\n            ]),\n            onRtl: constant$1([\n              south$2,\n              north$2,\n              southeast$2,\n              northeast$2,\n              southwest$2,\n              northwest$2\n            ])\n          }\n        };\n      }),\n      onHandler('onHide'),\n      onHandler('onShow')\n    ];\n\n    var init$b = function () {\n      var timer = value$1();\n      var popup = value$1();\n      var clearTimer = function () {\n        timer.on(clearTimeout);\n      };\n      var resetTimer = function (f, delay) {\n        clearTimer();\n        timer.set(setTimeout(f, delay));\n      };\n      var readState = constant$1('not-implemented');\n      return nu$8({\n        getTooltip: popup.get,\n        isShowing: popup.isSet,\n        setTooltip: popup.set,\n        clearTooltip: popup.clear,\n        clearTimer: clearTimer,\n        resetTimer: resetTimer,\n        readState: readState\n      });\n    };\n\n    var TooltippingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$b\n    });\n\n    var Tooltipping = create$7({\n      fields: TooltippingSchema,\n      name: 'tooltipping',\n      active: ActiveTooltipping,\n      state: TooltippingState,\n      apis: TooltippingApis\n    });\n\n    var escape = function (text) {\n      return text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    };\n\n    var global$b = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var global$a = tinymce.util.Tools.resolve('tinymce.EditorManager');\n\n    var getSkinUrl = function (editor) {\n      var skin = editor.getParam('skin');\n      var skinUrl = editor.getParam('skin_url');\n      if (skin !== false) {\n        var skinName = skin ? skin : 'oxide';\n        if (skinUrl) {\n          skinUrl = editor.documentBaseURI.toAbsolute(skinUrl);\n        } else {\n          skinUrl = global$a.baseURL + '/skins/ui/' + skinName;\n        }\n      }\n      return skinUrl;\n    };\n    var isReadOnly = function (editor) {\n      return editor.getParam('readonly', false, 'boolean');\n    };\n    var isSkinDisabled = function (editor) {\n      return editor.getParam('skin') === false;\n    };\n    var getHeightSetting = function (editor) {\n      return editor.getParam('height', Math.max(editor.getElement().offsetHeight, 200));\n    };\n    var getWidthSetting = function (editor) {\n      return editor.getParam('width', global$b.DOM.getStyle(editor.getElement(), 'width'));\n    };\n    var getMinWidthSetting = function (editor) {\n      return Optional.from(editor.getParam('min_width')).filter(isNumber);\n    };\n    var getMinHeightSetting = function (editor) {\n      return Optional.from(editor.getParam('min_height')).filter(isNumber);\n    };\n    var getMaxWidthSetting = function (editor) {\n      return Optional.from(editor.getParam('max_width')).filter(isNumber);\n    };\n    var getMaxHeightSetting = function (editor) {\n      return Optional.from(editor.getParam('max_height')).filter(isNumber);\n    };\n    var getUserStyleFormats = function (editor) {\n      return Optional.from(editor.getParam('style_formats')).filter(isArray);\n    };\n    var isMergeStyleFormats = function (editor) {\n      return editor.getParam('style_formats_merge', false, 'boolean');\n    };\n    var getLineHeightFormats = function (editor) {\n      return editor.getParam('lineheight_formats', '1 1.1 1.2 1.3 1.4 1.5 2', 'string').split(' ');\n    };\n    var getContentLanguages = function (editor) {\n      return editor.getParam('content_langs', undefined, 'array');\n    };\n    var getRemovedMenuItems = function (editor) {\n      return editor.getParam('removed_menuitems', '');\n    };\n    var isMenubarEnabled = function (editor) {\n      return editor.getParam('menubar', true, 'boolean') !== false;\n    };\n    var isToolbarEnabled = function (editor) {\n      var toolbar = editor.getParam('toolbar', true);\n      var isToolbarTrue = toolbar === true;\n      var isToolbarString = isString(toolbar);\n      var isToolbarObjectArray = isArray(toolbar) && toolbar.length > 0;\n      return !isMultipleToolbars(editor) && (isToolbarObjectArray || isToolbarString || isToolbarTrue);\n    };\n    var getMultipleToolbarsSetting = function (editor) {\n      var toolbars = range$2(9, function (num) {\n        return editor.getParam('toolbar' + (num + 1), false, 'string');\n      });\n      var toolbarArray = filter$2(toolbars, function (toolbar) {\n        return typeof toolbar === 'string';\n      });\n      return toolbarArray.length > 0 ? Optional.some(toolbarArray) : Optional.none();\n    };\n    var isMultipleToolbars = function (editor) {\n      return getMultipleToolbarsSetting(editor).fold(function () {\n        var toolbar = editor.getParam('toolbar', [], 'string[]');\n        return toolbar.length > 0;\n      }, always);\n    };\n    var ToolbarMode;\n    (function (ToolbarMode) {\n      ToolbarMode['default'] = 'wrap';\n      ToolbarMode['floating'] = 'floating';\n      ToolbarMode['sliding'] = 'sliding';\n      ToolbarMode['scrolling'] = 'scrolling';\n    }(ToolbarMode || (ToolbarMode = {})));\n    var getToolbarMode = function (editor) {\n      return editor.getParam('toolbar_mode', '', 'string');\n    };\n    var ToolbarLocation;\n    (function (ToolbarLocation) {\n      ToolbarLocation['auto'] = 'auto';\n      ToolbarLocation['top'] = 'top';\n      ToolbarLocation['bottom'] = 'bottom';\n    }(ToolbarLocation || (ToolbarLocation = {})));\n    var getToolbarGroups = function (editor) {\n      return editor.getParam('toolbar_groups', {}, 'object');\n    };\n    var getToolbarLocation = function (editor) {\n      return editor.getParam('toolbar_location', ToolbarLocation.auto, 'string');\n    };\n    var isToolbarLocationBottom = function (editor) {\n      return getToolbarLocation(editor) === ToolbarLocation.bottom;\n    };\n    var fixedContainerSelector = function (editor) {\n      return editor.getParam('fixed_toolbar_container', '', 'string');\n    };\n    var fixedToolbarContainerTarget = function (editor) {\n      return editor.getParam('fixed_toolbar_container_target');\n    };\n    var isToolbarPersist = function (editor) {\n      return editor.getParam('toolbar_persist', false, 'boolean');\n    };\n    var fixedContainerTarget = function (editor) {\n      if (!editor.inline) {\n        return Optional.none();\n      }\n      var selector = fixedContainerSelector(editor);\n      if (selector.length > 0) {\n        return descendant(body(), selector);\n      }\n      var element = fixedToolbarContainerTarget(editor);\n      if (isNonNullable(element)) {\n        return Optional.some(SugarElement.fromDom(element));\n      }\n      return Optional.none();\n    };\n    var useFixedContainer = function (editor) {\n      return editor.inline && fixedContainerTarget(editor).isSome();\n    };\n    var getUiContainer = function (editor) {\n      var fixedContainer = fixedContainerTarget(editor);\n      return fixedContainer.getOrThunk(function () {\n        return getContentContainer(getRootNode(SugarElement.fromDom(editor.getElement())));\n      });\n    };\n    var isDistractionFree = function (editor) {\n      return editor.inline && !isMenubarEnabled(editor) && !isToolbarEnabled(editor) && !isMultipleToolbars(editor);\n    };\n    var isStickyToolbar = function (editor) {\n      var isStickyToolbar = editor.getParam('toolbar_sticky', false, 'boolean');\n      return (isStickyToolbar || editor.inline) && !useFixedContainer(editor) && !isDistractionFree(editor);\n    };\n    var getStickyToolbarOffset = function (editor) {\n      return editor.getParam('toolbar_sticky_offset', 0, 'number');\n    };\n    var isDraggableModal$1 = function (editor) {\n      return editor.getParam('draggable_modal', false, 'boolean');\n    };\n    var getMenus = function (editor) {\n      var menu = editor.getParam('menu');\n      if (menu) {\n        return map$1(menu, function (menu) {\n          return __assign(__assign({}, menu), { items: menu.items });\n        });\n      } else {\n        return {};\n      }\n    };\n    var getMenubar = function (editor) {\n      return editor.getParam('menubar');\n    };\n    var getToolbar = function (editor) {\n      return editor.getParam('toolbar', true);\n    };\n    var getFilePickerCallback = function (editor) {\n      return editor.getParam('file_picker_callback');\n    };\n    var getFilePickerTypes = function (editor) {\n      return editor.getParam('file_picker_types');\n    };\n    var getFileBrowserCallbackTypes = function (editor) {\n      return editor.getParam('file_browser_callback_types');\n    };\n    var noTypeaheadUrls = function (editor) {\n      return editor.getParam('typeahead_urls') === false;\n    };\n    var getAnchorTop = function (editor) {\n      return editor.getParam('anchor_top', '#top');\n    };\n    var getAnchorBottom = function (editor) {\n      return editor.getParam('anchor_bottom', '#bottom');\n    };\n    var getFilePickerValidatorHandler = function (editor) {\n      var handler = editor.getParam('file_picker_validator_handler', undefined, 'function');\n      if (handler === undefined) {\n        return editor.getParam('filepicker_validator_handler', undefined, 'function');\n      } else {\n        return handler;\n      }\n    };\n\n    var ReadOnlyChannel = 'silver.readonly';\n    var ReadOnlyDataSchema = objOf([requiredBoolean('readonly')]);\n    var broadcastReadonly = function (uiComponents, readonly) {\n      var outerContainer = uiComponents.outerContainer;\n      var target = outerContainer.element;\n      if (readonly) {\n        uiComponents.mothership.broadcastOn([dismissPopups()], { target: target });\n        uiComponents.uiMothership.broadcastOn([dismissPopups()], { target: target });\n      }\n      uiComponents.mothership.broadcastOn([ReadOnlyChannel], { readonly: readonly });\n      uiComponents.uiMothership.broadcastOn([ReadOnlyChannel], { readonly: readonly });\n    };\n    var setupReadonlyModeSwitch = function (editor, uiComponents) {\n      editor.on('init', function () {\n        if (editor.mode.isReadOnly()) {\n          broadcastReadonly(uiComponents, true);\n        }\n      });\n      editor.on('SwitchMode', function () {\n        return broadcastReadonly(uiComponents, editor.mode.isReadOnly());\n      });\n      if (isReadOnly(editor)) {\n        editor.setMode('readonly');\n      }\n    };\n    var receivingConfig = function () {\n      var _a;\n      return Receiving.config({\n        channels: (_a = {}, _a[ReadOnlyChannel] = {\n          schema: ReadOnlyDataSchema,\n          onReceive: function (comp, data) {\n            Disabling.set(comp, data.readonly);\n          }\n        }, _a)\n      });\n    };\n\n    var item = function (disabled) {\n      return Disabling.config({\n        disabled: disabled,\n        disableClass: 'tox-collection__item--state-disabled'\n      });\n    };\n    var button = function (disabled) {\n      return Disabling.config({ disabled: disabled });\n    };\n    var splitButton = function (disabled) {\n      return Disabling.config({\n        disabled: disabled,\n        disableClass: 'tox-tbtn--disabled'\n      });\n    };\n    var toolbarButton = function (disabled) {\n      return Disabling.config({\n        disabled: disabled,\n        disableClass: 'tox-tbtn--disabled',\n        useNative: false\n      });\n    };\n    var DisablingConfigs = {\n      item: item,\n      button: button,\n      splitButton: splitButton,\n      toolbarButton: toolbarButton\n    };\n\n    var runWithApi = function (info, comp) {\n      var api = info.getApi(comp);\n      return function (f) {\n        f(api);\n      };\n    };\n    var onControlAttached = function (info, editorOffCell) {\n      return runOnAttached(function (comp) {\n        var run = runWithApi(info, comp);\n        run(function (api) {\n          var onDestroy = info.onSetup(api);\n          if (isFunction(onDestroy)) {\n            editorOffCell.set(onDestroy);\n          }\n        });\n      });\n    };\n    var onControlDetached = function (getApi, editorOffCell) {\n      return runOnDetached(function (comp) {\n        return runWithApi(getApi, comp)(editorOffCell.get());\n      });\n    };\n\n    var _a$1;\n    var onMenuItemExecute = function (info, itemResponse) {\n      return runOnExecute$1(function (comp, simulatedEvent) {\n        runWithApi(info, comp)(info.onAction);\n        if (!info.triggersSubmenu && itemResponse === ItemResponse$1.CLOSE_ON_EXECUTE) {\n          emit(comp, sandboxClose());\n          simulatedEvent.stop();\n        }\n      });\n    };\n    var menuItemEventOrder = (_a$1 = {}, _a$1[execute$5()] = [\n      'disabling',\n      'alloy.base.behaviour',\n      'toggling',\n      'item-events'\n    ], _a$1);\n\n    var componentRenderPipeline = cat;\n    var renderCommonItem = function (spec, structure, itemResponse, providersbackstage) {\n      var editorOffCell = Cell(noop);\n      return {\n        type: 'item',\n        dom: structure.dom,\n        components: componentRenderPipeline(structure.optComponents),\n        data: spec.data,\n        eventOrder: menuItemEventOrder,\n        hasSubmenu: spec.triggersSubmenu,\n        itemBehaviours: derive$1([\n          config('item-events', [\n            onMenuItemExecute(spec, itemResponse),\n            onControlAttached(spec, editorOffCell),\n            onControlDetached(spec, editorOffCell)\n          ]),\n          DisablingConfigs.item(function () {\n            return spec.disabled || providersbackstage.isDisabled();\n          }),\n          receivingConfig(),\n          Replacing.config({})\n        ].concat(spec.itemBehaviours))\n      };\n    };\n    var buildData = function (source) {\n      return {\n        value: source.value,\n        meta: __assign({ text: source.text.getOr('') }, source.meta)\n      };\n    };\n\n    var global$9 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var convertText = function (source) {\n      var mac = {\n        alt: '&#x2325;',\n        ctrl: '&#x2303;',\n        shift: '&#x21E7;',\n        meta: '&#x2318;',\n        access: '&#x2303;&#x2325;'\n      };\n      var other = {\n        meta: 'Ctrl',\n        access: 'Shift+Alt'\n      };\n      var replace = global$9.mac ? mac : other;\n      var shortcut = source.split('+');\n      var updated = map$2(shortcut, function (segment) {\n        var search = segment.toLowerCase().trim();\n        return has$2(replace, search) ? replace[search] : segment;\n      });\n      return global$9.mac ? updated.join('') : updated.join('+');\n    };\n\n    var renderIcon$1 = function (name, icons, classes) {\n      if (classes === void 0) {\n        classes = [iconClass];\n      }\n      return render$3(name, {\n        tag: 'div',\n        classes: classes\n      }, icons);\n    };\n    var renderText = function (text$1) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [textClass]\n        },\n        components: [text(global$e.translate(text$1))]\n      };\n    };\n    var renderHtml = function (html, classes) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: classes,\n          innerHtml: html\n        }\n      };\n    };\n    var renderStyledText = function (style, text$1) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [textClass]\n        },\n        components: [{\n            dom: {\n              tag: style.tag,\n              styles: style.styles\n            },\n            components: [text(global$e.translate(text$1))]\n          }]\n      };\n    };\n    var renderShortcut = function (shortcut) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [accessoryClass],\n          innerHtml: convertText(shortcut)\n        }\n      };\n    };\n    var renderCheckmark = function (icons) {\n      return renderIcon$1('checkmark', icons, [checkmarkClass]);\n    };\n    var renderSubmenuCaret = function (icons) {\n      return renderIcon$1('chevron-right', icons, [caretClass]);\n    };\n    var renderDownwardsCaret = function (icons) {\n      return renderIcon$1('chevron-down', icons, [caretClass]);\n    };\n    var renderContainer = function (container, components) {\n      var directionClass = container.direction === 'vertical' ? containerColumnClass : containerRowClass;\n      var alignClass = container.align === 'left' ? containerAlignLeftClass : containerAlignRightClass;\n      var getValignClass = function () {\n        switch (container.valign) {\n        case 'top':\n          return containerValignTopClass;\n        case 'middle':\n          return containerValignMiddleClass;\n        case 'bottom':\n          return containerValignBottomClass;\n        }\n      };\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            containerClass,\n            directionClass,\n            alignClass,\n            getValignClass()\n          ]\n        },\n        components: components\n      };\n    };\n    var renderImage = function (src, classes, alt) {\n      return {\n        dom: {\n          tag: 'img',\n          classes: classes,\n          attributes: {\n            src: src,\n            alt: alt.getOr('')\n          }\n        }\n      };\n    };\n\n    var renderColorStructure = function (item, providerBackstage, fallbackIcon) {\n      var colorPickerCommand = 'custom';\n      var removeColorCommand = 'remove';\n      var itemText = item.ariaLabel;\n      var itemValue = item.value;\n      var iconSvg = item.iconContent.map(function (name) {\n        return getOr(name, providerBackstage.icons, fallbackIcon);\n      });\n      var getDom = function () {\n        var common = colorClass;\n        var icon = iconSvg.getOr('');\n        var attributes = itemText.map(function (text) {\n          return { title: providerBackstage.translate(text) };\n        }).getOr({});\n        var baseDom = {\n          tag: 'div',\n          attributes: attributes,\n          classes: [common]\n        };\n        if (itemValue === colorPickerCommand) {\n          return __assign(__assign({}, baseDom), {\n            tag: 'button',\n            classes: __spreadArray(__spreadArray([], baseDom.classes, true), ['tox-swatches__picker-btn'], false),\n            innerHtml: icon\n          });\n        } else if (itemValue === removeColorCommand) {\n          return __assign(__assign({}, baseDom), {\n            classes: __spreadArray(__spreadArray([], baseDom.classes, true), ['tox-swatch--remove'], false),\n            innerHtml: icon\n          });\n        } else {\n          return __assign(__assign({}, baseDom), {\n            attributes: __assign(__assign({}, baseDom.attributes), { 'data-mce-color': itemValue }),\n            styles: { 'background-color': itemValue }\n          });\n        }\n      };\n      return {\n        dom: getDom(),\n        optComponents: []\n      };\n    };\n    var renderItemDomStructure = function (ariaLabel) {\n      var domTitle = ariaLabel.map(function (label) {\n        return { attributes: { title: global$e.translate(label) } };\n      }).getOr({});\n      return __assign({\n        tag: 'div',\n        classes: [\n          navClass,\n          selectableClass\n        ]\n      }, domTitle);\n    };\n    var renderNormalItemStructure = function (info, providersBackstage, renderIcons, fallbackIcon) {\n      var iconSpec = {\n        tag: 'div',\n        classes: [iconClass]\n      };\n      var renderIcon = function (iconName) {\n        return render$3(iconName, iconSpec, providersBackstage.icons, fallbackIcon);\n      };\n      var renderEmptyIcon = function () {\n        return Optional.some({ dom: iconSpec });\n      };\n      var leftIcon = renderIcons ? info.iconContent.map(renderIcon).orThunk(renderEmptyIcon) : Optional.none();\n      var checkmark = info.checkMark;\n      var textRender = Optional.from(info.meta).fold(function () {\n        return renderText;\n      }, function (meta) {\n        return has$2(meta, 'style') ? curry(renderStyledText, meta.style) : renderText;\n      });\n      var content = info.htmlContent.fold(function () {\n        return info.textContent.map(textRender);\n      }, function (html) {\n        return Optional.some(renderHtml(html, [textClass]));\n      });\n      var menuItem = {\n        dom: renderItemDomStructure(info.ariaLabel),\n        optComponents: [\n          leftIcon,\n          content,\n          info.shortcutContent.map(renderShortcut),\n          checkmark,\n          info.caret\n        ]\n      };\n      return menuItem;\n    };\n    var renderItemStructure = function (info, providersBackstage, renderIcons, fallbackIcon) {\n      if (fallbackIcon === void 0) {\n        fallbackIcon = Optional.none();\n      }\n      if (info.presets === 'color') {\n        return renderColorStructure(info, providersBackstage, fallbackIcon);\n      } else {\n        return renderNormalItemStructure(info, providersBackstage, renderIcons, fallbackIcon);\n      }\n    };\n\n    var tooltipBehaviour = function (meta, sharedBackstage) {\n      return get$e(meta, 'tooltipWorker').map(function (tooltipWorker) {\n        return [Tooltipping.config({\n            lazySink: sharedBackstage.getSink,\n            tooltipDom: {\n              tag: 'div',\n              classes: ['tox-tooltip-worker-container']\n            },\n            tooltipComponents: [],\n            anchor: function (comp) {\n              return {\n                type: 'submenu',\n                item: comp,\n                overrides: { maxHeightFunction: expandable$1 }\n              };\n            },\n            mode: 'follow-highlight',\n            onShow: function (component, _tooltip) {\n              tooltipWorker(function (elm) {\n                Tooltipping.setComponents(component, [external$2({ element: SugarElement.fromDom(elm) })]);\n              });\n            }\n          })];\n      }).getOr([]);\n    };\n    var encodeText = function (text) {\n      return global$b.DOM.encode(text);\n    };\n    var replaceText = function (text, matchText) {\n      var translated = global$e.translate(text);\n      var encoded = encodeText(translated);\n      if (matchText.length > 0) {\n        var escapedMatchRegex = new RegExp(escape(matchText), 'gi');\n        return encoded.replace(escapedMatchRegex, function (match) {\n          return '<span class=\"tox-autocompleter-highlight\">' + match + '</span>';\n        });\n      } else {\n        return encoded;\n      }\n    };\n    var renderAutocompleteItem = function (spec, matchText, useText, presets, onItemValueHandler, itemResponse, sharedBackstage, renderIcons) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      var structure = renderItemStructure({\n        presets: presets,\n        textContent: Optional.none(),\n        htmlContent: useText ? spec.text.map(function (text) {\n          return replaceText(text, matchText);\n        }) : Optional.none(),\n        ariaLabel: spec.text,\n        iconContent: spec.icon,\n        shortcutContent: Optional.none(),\n        checkMark: Optional.none(),\n        caret: Optional.none(),\n        value: spec.value\n      }, sharedBackstage.providers, renderIcons, spec.icon);\n      return renderCommonItem({\n        data: buildData(spec),\n        disabled: spec.disabled,\n        getApi: constant$1({}),\n        onAction: function (_api) {\n          return onItemValueHandler(spec.value, spec.meta);\n        },\n        onSetup: constant$1(noop),\n        triggersSubmenu: false,\n        itemBehaviours: tooltipBehaviour(spec.meta, sharedBackstage)\n      }, structure, itemResponse, sharedBackstage.providers);\n    };\n\n    var render$2 = function (items, extras) {\n      return map$2(items, function (item) {\n        switch (item.type) {\n        case 'cardcontainer':\n          return renderContainer(item, render$2(item.items, extras));\n        case 'cardimage':\n          return renderImage(item.src, item.classes, item.alt);\n        case 'cardtext':\n          var shouldHighlight = item.name.exists(function (name) {\n            return contains$2(extras.cardText.highlightOn, name);\n          });\n          var matchText = shouldHighlight ? Optional.from(extras.cardText.matchText).getOr('') : '';\n          return renderHtml(replaceText(item.text, matchText), item.classes);\n        }\n      });\n    };\n    var renderCardMenuItem = function (spec, itemResponse, sharedBackstage, extras) {\n      var getApi = function (component) {\n        return {\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            Disabling.set(component, state);\n            each$1(descendants(component.element, '*'), function (elm) {\n              component.getSystem().getByDom(elm).each(function (comp) {\n                if (comp.hasConfigured(Disabling)) {\n                  Disabling.set(comp, state);\n                }\n              });\n            });\n          }\n        };\n      };\n      var structure = {\n        dom: renderItemDomStructure(spec.label),\n        optComponents: [Optional.some({\n            dom: {\n              tag: 'div',\n              classes: [\n                containerClass,\n                containerRowClass\n              ]\n            },\n            components: render$2(spec.items, extras)\n          })]\n      };\n      return renderCommonItem({\n        data: buildData(__assign({ text: Optional.none() }, spec)),\n        disabled: spec.disabled,\n        getApi: getApi,\n        onAction: spec.onAction,\n        onSetup: spec.onSetup,\n        triggersSubmenu: false,\n        itemBehaviours: Optional.from(extras.itemBehaviours).getOr([])\n      }, structure, itemResponse, sharedBackstage.providers);\n    };\n\n    var renderChoiceItem = function (spec, useText, presets, onItemValueHandler, isSelected, itemResponse, providersBackstage, renderIcons) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      var getApi = function (component) {\n        return {\n          setActive: function (state) {\n            Toggling.set(component, state);\n          },\n          isActive: function () {\n            return Toggling.isOn(component);\n          },\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(component, state);\n          }\n        };\n      };\n      var structure = renderItemStructure({\n        presets: presets,\n        textContent: useText ? spec.text : Optional.none(),\n        htmlContent: Optional.none(),\n        ariaLabel: spec.text,\n        iconContent: spec.icon,\n        shortcutContent: useText ? spec.shortcut : Optional.none(),\n        checkMark: useText ? Optional.some(renderCheckmark(providersBackstage.icons)) : Optional.none(),\n        caret: Optional.none(),\n        value: spec.value\n      }, providersBackstage, renderIcons);\n      return deepMerge(renderCommonItem({\n        data: buildData(spec),\n        disabled: spec.disabled,\n        getApi: getApi,\n        onAction: function (_api) {\n          return onItemValueHandler(spec.value);\n        },\n        onSetup: function (api) {\n          api.setActive(isSelected);\n          return noop;\n        },\n        triggersSubmenu: false,\n        itemBehaviours: []\n      }, structure, itemResponse, providersBackstage), {\n        toggling: {\n          toggleClass: tickedClass,\n          toggleOnExecute: false,\n          selected: spec.active\n        }\n      });\n    };\n\n    var parts$f = generate$3(owner$2(), parts$h());\n\n    var hexColour = function (value) {\n      return { value: value };\n    };\n    var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n    var longformRegex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\n    var isHexString = function (hex) {\n      return shorthandRegex.test(hex) || longformRegex.test(hex);\n    };\n    var normalizeHex = function (hex) {\n      return removeLeading(hex, '#').toUpperCase();\n    };\n    var fromString$1 = function (hex) {\n      return isHexString(hex) ? Optional.some({ value: normalizeHex(hex) }) : Optional.none();\n    };\n    var getLongForm = function (hex) {\n      var hexString = hex.value.replace(shorthandRegex, function (m, r, g, b) {\n        return r + r + g + g + b + b;\n      });\n      return { value: hexString };\n    };\n    var extractValues = function (hex) {\n      var longForm = getLongForm(hex);\n      var splitForm = longformRegex.exec(longForm.value);\n      return splitForm === null ? [\n        'FFFFFF',\n        'FF',\n        'FF',\n        'FF'\n      ] : splitForm;\n    };\n    var toHex = function (component) {\n      var hex = component.toString(16);\n      return (hex.length === 1 ? '0' + hex : hex).toUpperCase();\n    };\n    var fromRgba = function (rgbaColour) {\n      var value = toHex(rgbaColour.red) + toHex(rgbaColour.green) + toHex(rgbaColour.blue);\n      return hexColour(value);\n    };\n\n    var min = Math.min;\n    var max = Math.max;\n    var round$1 = Math.round;\n    var rgbRegex = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/;\n    var rgbaRegex = /^rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*(\\d?(?:\\.\\d+)?)\\)/;\n    var rgbaColour = function (red, green, blue, alpha) {\n      return {\n        red: red,\n        green: green,\n        blue: blue,\n        alpha: alpha\n      };\n    };\n    var isRgbaComponent = function (value) {\n      var num = parseInt(value, 10);\n      return num.toString() === value && num >= 0 && num <= 255;\n    };\n    var fromHsv = function (hsv) {\n      var r;\n      var g;\n      var b;\n      var hue = (hsv.hue || 0) % 360;\n      var saturation = hsv.saturation / 100;\n      var brightness = hsv.value / 100;\n      saturation = max(0, min(saturation, 1));\n      brightness = max(0, min(brightness, 1));\n      if (saturation === 0) {\n        r = g = b = round$1(255 * brightness);\n        return rgbaColour(r, g, b, 1);\n      }\n      var side = hue / 60;\n      var chroma = brightness * saturation;\n      var x = chroma * (1 - Math.abs(side % 2 - 1));\n      var match = brightness - chroma;\n      switch (Math.floor(side)) {\n      case 0:\n        r = chroma;\n        g = x;\n        b = 0;\n        break;\n      case 1:\n        r = x;\n        g = chroma;\n        b = 0;\n        break;\n      case 2:\n        r = 0;\n        g = chroma;\n        b = x;\n        break;\n      case 3:\n        r = 0;\n        g = x;\n        b = chroma;\n        break;\n      case 4:\n        r = x;\n        g = 0;\n        b = chroma;\n        break;\n      case 5:\n        r = chroma;\n        g = 0;\n        b = x;\n        break;\n      default:\n        r = g = b = 0;\n      }\n      r = round$1(255 * (r + match));\n      g = round$1(255 * (g + match));\n      b = round$1(255 * (b + match));\n      return rgbaColour(r, g, b, 1);\n    };\n    var fromHex = function (hexColour) {\n      var result = extractValues(hexColour);\n      var red = parseInt(result[1], 16);\n      var green = parseInt(result[2], 16);\n      var blue = parseInt(result[3], 16);\n      return rgbaColour(red, green, blue, 1);\n    };\n    var fromStringValues = function (red, green, blue, alpha) {\n      var r = parseInt(red, 10);\n      var g = parseInt(green, 10);\n      var b = parseInt(blue, 10);\n      var a = parseFloat(alpha);\n      return rgbaColour(r, g, b, a);\n    };\n    var fromString = function (rgbaString) {\n      if (rgbaString === 'transparent') {\n        return Optional.some(rgbaColour(0, 0, 0, 0));\n      }\n      var rgbMatch = rgbRegex.exec(rgbaString);\n      if (rgbMatch !== null) {\n        return Optional.some(fromStringValues(rgbMatch[1], rgbMatch[2], rgbMatch[3], '1'));\n      }\n      var rgbaMatch = rgbaRegex.exec(rgbaString);\n      if (rgbaMatch !== null) {\n        return Optional.some(fromStringValues(rgbaMatch[1], rgbaMatch[2], rgbaMatch[3], rgbaMatch[4]));\n      }\n      return Optional.none();\n    };\n    var toString = function (rgba) {\n      return 'rgba(' + rgba.red + ',' + rgba.green + ',' + rgba.blue + ',' + rgba.alpha + ')';\n    };\n    var red = rgbaColour(255, 0, 0, 1);\n\n    var fireSkinLoaded$1 = function (editor) {\n      return editor.fire('SkinLoaded');\n    };\n    var fireSkinLoadError$1 = function (editor, error) {\n      return editor.fire('SkinLoadError', error);\n    };\n    var fireResizeEditor = function (editor) {\n      return editor.fire('ResizeEditor');\n    };\n    var fireResizeContent = function (editor, e) {\n      return editor.fire('ResizeContent', e);\n    };\n    var fireScrollContent = function (editor, e) {\n      return editor.fire('ScrollContent', e);\n    };\n    var fireTextColorChange = function (editor, data) {\n      return editor.fire('TextColorChange', data);\n    };\n\n    var hsvColour = function (hue, saturation, value) {\n      return {\n        hue: hue,\n        saturation: saturation,\n        value: value\n      };\n    };\n    var fromRgb = function (rgbaColour) {\n      var h = 0;\n      var s = 0;\n      var v = 0;\n      var r = rgbaColour.red / 255;\n      var g = rgbaColour.green / 255;\n      var b = rgbaColour.blue / 255;\n      var minRGB = Math.min(r, Math.min(g, b));\n      var maxRGB = Math.max(r, Math.max(g, b));\n      if (minRGB === maxRGB) {\n        v = minRGB;\n        return hsvColour(0, 0, v * 100);\n      }\n      var d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n      h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n      h = 60 * (h - d / (maxRGB - minRGB));\n      s = (maxRGB - minRGB) / maxRGB;\n      v = maxRGB;\n      return hsvColour(Math.round(h), Math.round(s * 100), Math.round(v * 100));\n    };\n\n    var hexToHsv = function (hex) {\n      return fromRgb(fromHex(hex));\n    };\n    var hsvToHex = function (hsv) {\n      return fromRgba(fromHsv(hsv));\n    };\n    var anyToHex = function (color) {\n      return fromString$1(color).orThunk(function () {\n        return fromString(color).map(fromRgba);\n      }).getOrThunk(function () {\n        var canvas = document.createElement('canvas');\n        canvas.height = 1;\n        canvas.width = 1;\n        var canvasContext = canvas.getContext('2d');\n        canvasContext.clearRect(0, 0, canvas.width, canvas.height);\n        canvasContext.fillStyle = '#FFFFFF';\n        canvasContext.fillStyle = color;\n        canvasContext.fillRect(0, 0, 1, 1);\n        var rgba = canvasContext.getImageData(0, 0, 1, 1).data;\n        var r = rgba[0];\n        var g = rgba[1];\n        var b = rgba[2];\n        var a = rgba[3];\n        return fromRgba(rgbaColour(r, g, b, a));\n      });\n    };\n\n    var global$8 = tinymce.util.Tools.resolve('tinymce.util.LocalStorage');\n\n    var storageName = 'tinymce-custom-colors';\n    function ColorCache (max) {\n      if (max === void 0) {\n        max = 10;\n      }\n      var storageString = global$8.getItem(storageName);\n      var localstorage = isString(storageString) ? JSON.parse(storageString) : [];\n      var prune = function (list) {\n        var diff = max - list.length;\n        return diff < 0 ? list.slice(0, max) : list;\n      };\n      var cache = prune(localstorage);\n      var add = function (key) {\n        indexOf(cache, key).each(remove);\n        cache.unshift(key);\n        if (cache.length > max) {\n          cache.pop();\n        }\n        global$8.setItem(storageName, JSON.stringify(cache));\n      };\n      var remove = function (idx) {\n        cache.splice(idx, 1);\n      };\n      var state = function () {\n        return cache.slice(0);\n      };\n      return {\n        add: add,\n        state: state\n      };\n    }\n\n    var choiceItem = 'choiceitem';\n    var defaultColors = [\n      {\n        type: choiceItem,\n        text: 'Light Green',\n        value: '#BFEDD2'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Yellow',\n        value: '#FBEEB8'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Red',\n        value: '#F8CAC6'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Purple',\n        value: '#ECCAFA'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Blue',\n        value: '#C2E0F4'\n      },\n      {\n        type: choiceItem,\n        text: 'Green',\n        value: '#2DC26B'\n      },\n      {\n        type: choiceItem,\n        text: 'Yellow',\n        value: '#F1C40F'\n      },\n      {\n        type: choiceItem,\n        text: 'Red',\n        value: '#E03E2D'\n      },\n      {\n        type: choiceItem,\n        text: 'Purple',\n        value: '#B96AD9'\n      },\n      {\n        type: choiceItem,\n        text: 'Blue',\n        value: '#3598DB'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Turquoise',\n        value: '#169179'\n      },\n      {\n        type: choiceItem,\n        text: 'Orange',\n        value: '#E67E23'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Red',\n        value: '#BA372A'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Purple',\n        value: '#843FA1'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Blue',\n        value: '#236FA1'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Gray',\n        value: '#ECF0F1'\n      },\n      {\n        type: choiceItem,\n        text: 'Medium Gray',\n        value: '#CED4D9'\n      },\n      {\n        type: choiceItem,\n        text: 'Gray',\n        value: '#95A5A6'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Gray',\n        value: '#7E8C8D'\n      },\n      {\n        type: choiceItem,\n        text: 'Navy Blue',\n        value: '#34495E'\n      },\n      {\n        type: choiceItem,\n        text: 'Black',\n        value: '#000000'\n      },\n      {\n        type: choiceItem,\n        text: 'White',\n        value: '#ffffff'\n      }\n    ];\n    var colorCache = ColorCache(10);\n    var mapColors = function (colorMap) {\n      var colors = [];\n      for (var i = 0; i < colorMap.length; i += 2) {\n        colors.push({\n          text: colorMap[i + 1],\n          value: '#' + anyToHex(colorMap[i]).value,\n          type: 'choiceitem'\n        });\n      }\n      return colors;\n    };\n    var getColorCols$2 = function (editor, defaultCols) {\n      return editor.getParam('color_cols', defaultCols, 'number');\n    };\n    var hasCustomColors$1 = function (editor) {\n      return editor.getParam('custom_colors') !== false;\n    };\n    var getColorMap = function (editor) {\n      return editor.getParam('color_map');\n    };\n    var getColors$2 = function (editor) {\n      var unmapped = getColorMap(editor);\n      return unmapped !== undefined ? mapColors(unmapped) : defaultColors;\n    };\n    var getCurrentColors = function () {\n      return map$2(colorCache.state(), function (color) {\n        return {\n          type: choiceItem,\n          text: color,\n          value: color\n        };\n      });\n    };\n    var addColor = function (color) {\n      colorCache.add(color);\n    };\n\n    var fallbackColor = '#000000';\n    var getCurrentColor = function (editor, format) {\n      var color;\n      editor.dom.getParents(editor.selection.getStart(), function (elm) {\n        var value;\n        if (value = elm.style[format === 'forecolor' ? 'color' : 'background-color']) {\n          color = color ? color : value;\n        }\n      });\n      return Optional.from(color);\n    };\n    var applyFormat = function (editor, format, value) {\n      editor.undoManager.transact(function () {\n        editor.focus();\n        editor.formatter.apply(format, { value: value });\n        editor.nodeChanged();\n      });\n    };\n    var removeFormat = function (editor, format) {\n      editor.undoManager.transact(function () {\n        editor.focus();\n        editor.formatter.remove(format, { value: null }, null, true);\n        editor.nodeChanged();\n      });\n    };\n    var registerCommands = function (editor) {\n      editor.addCommand('mceApplyTextcolor', function (format, value) {\n        applyFormat(editor, format, value);\n      });\n      editor.addCommand('mceRemoveTextcolor', function (format) {\n        removeFormat(editor, format);\n      });\n    };\n    var calcCols = function (colors) {\n      return Math.max(5, Math.ceil(Math.sqrt(colors)));\n    };\n    var getColorCols$1 = function (editor) {\n      var colors = getColors$2(editor);\n      var defaultCols = calcCols(colors.length);\n      return getColorCols$2(editor, defaultCols);\n    };\n    var getAdditionalColors = function (hasCustom) {\n      var type = 'choiceitem';\n      var remove = {\n        type: type,\n        text: 'Remove color',\n        icon: 'color-swatch-remove-color',\n        value: 'remove'\n      };\n      var custom = {\n        type: type,\n        text: 'Custom color',\n        icon: 'color-picker',\n        value: 'custom'\n      };\n      return hasCustom ? [\n        remove,\n        custom\n      ] : [remove];\n    };\n    var applyColor = function (editor, format, value, onChoice) {\n      if (value === 'custom') {\n        var dialog = colorPickerDialog(editor);\n        dialog(function (colorOpt) {\n          colorOpt.each(function (color) {\n            addColor(color);\n            editor.execCommand('mceApplyTextcolor', format, color);\n            onChoice(color);\n          });\n        }, fallbackColor);\n      } else if (value === 'remove') {\n        onChoice('');\n        editor.execCommand('mceRemoveTextcolor', format);\n      } else {\n        onChoice(value);\n        editor.execCommand('mceApplyTextcolor', format, value);\n      }\n    };\n    var getColors$1 = function (colors, hasCustom) {\n      return colors.concat(getCurrentColors().concat(getAdditionalColors(hasCustom)));\n    };\n    var getFetch$1 = function (colors, hasCustom) {\n      return function (callback) {\n        callback(getColors$1(colors, hasCustom));\n      };\n    };\n    var setIconColor = function (splitButtonApi, name, newColor) {\n      var id = name === 'forecolor' ? 'tox-icon-text-color__color' : 'tox-icon-highlight-bg-color__color';\n      splitButtonApi.setIconFill(id, newColor);\n    };\n    var registerTextColorButton = function (editor, name, format, tooltip, lastColor) {\n      editor.ui.registry.addSplitButton(name, {\n        tooltip: tooltip,\n        presets: 'color',\n        icon: name === 'forecolor' ? 'text-color' : 'highlight-bg-color',\n        select: function (value) {\n          var optCurrentRgb = getCurrentColor(editor, format);\n          return optCurrentRgb.bind(function (currentRgb) {\n            return fromString(currentRgb).map(function (rgba) {\n              var currentHex = fromRgba(rgba).value;\n              return contains$1(value.toLowerCase(), currentHex);\n            });\n          }).getOr(false);\n        },\n        columns: getColorCols$1(editor),\n        fetch: getFetch$1(getColors$2(editor), hasCustomColors$1(editor)),\n        onAction: function (_splitButtonApi) {\n          applyColor(editor, format, lastColor.get(), noop);\n        },\n        onItemAction: function (_splitButtonApi, value) {\n          applyColor(editor, format, value, function (newColor) {\n            lastColor.set(newColor);\n            fireTextColorChange(editor, {\n              name: name,\n              color: newColor\n            });\n          });\n        },\n        onSetup: function (splitButtonApi) {\n          setIconColor(splitButtonApi, name, lastColor.get());\n          var handler = function (e) {\n            if (e.name === name) {\n              setIconColor(splitButtonApi, e.name, e.color);\n            }\n          };\n          editor.on('TextColorChange', handler);\n          return function () {\n            editor.off('TextColorChange', handler);\n          };\n        }\n      });\n    };\n    var registerTextColorMenuItem = function (editor, name, format, text) {\n      editor.ui.registry.addNestedMenuItem(name, {\n        text: text,\n        icon: name === 'forecolor' ? 'text-color' : 'highlight-bg-color',\n        getSubmenuItems: function () {\n          return [{\n              type: 'fancymenuitem',\n              fancytype: 'colorswatch',\n              onAction: function (data) {\n                applyColor(editor, format, data.value, noop);\n              }\n            }];\n        }\n      });\n    };\n    var colorPickerDialog = function (editor) {\n      return function (callback, value) {\n        var isValid = false;\n        var onSubmit = function (api) {\n          var data = api.getData();\n          var hex = data.colorpicker;\n          if (isValid) {\n            callback(Optional.from(hex));\n            api.close();\n          } else {\n            editor.windowManager.alert(editor.translate([\n              'Invalid hex color code: {0}',\n              hex\n            ]));\n          }\n        };\n        var onAction = function (_api, details) {\n          if (details.name === 'hex-valid') {\n            isValid = details.value;\n          }\n        };\n        var initialData = { colorpicker: value };\n        editor.windowManager.open({\n          title: 'Color Picker',\n          size: 'normal',\n          body: {\n            type: 'panel',\n            items: [{\n                type: 'colorpicker',\n                name: 'colorpicker',\n                label: 'Color'\n              }]\n          },\n          buttons: [\n            {\n              type: 'cancel',\n              name: 'cancel',\n              text: 'Cancel'\n            },\n            {\n              type: 'submit',\n              name: 'save',\n              text: 'Save',\n              primary: true\n            }\n          ],\n          initialData: initialData,\n          onAction: onAction,\n          onSubmit: onSubmit,\n          onClose: noop,\n          onCancel: function () {\n            callback(Optional.none());\n          }\n        });\n      };\n    };\n    var register$a = function (editor) {\n      registerCommands(editor);\n      var lastForeColor = Cell(fallbackColor);\n      var lastBackColor = Cell(fallbackColor);\n      registerTextColorButton(editor, 'forecolor', 'forecolor', 'Text color', lastForeColor);\n      registerTextColorButton(editor, 'backcolor', 'hilitecolor', 'Background color', lastBackColor);\n      registerTextColorMenuItem(editor, 'forecolor', 'forecolor', 'Text color');\n      registerTextColorMenuItem(editor, 'backcolor', 'hilitecolor', 'Background color');\n    };\n\n    var createPartialChoiceMenu = function (value, items, onItemValueHandler, columns, presets, itemResponse, select, providersBackstage) {\n      var hasIcons = menuHasIcons(items);\n      var presetItemTypes = presets !== 'color' ? 'normal' : 'color';\n      var alloyItems = createChoiceItems(items, onItemValueHandler, columns, presetItemTypes, itemResponse, select, providersBackstage);\n      return createPartialMenuWithAlloyItems(value, hasIcons, alloyItems, columns, presets);\n    };\n    var createChoiceItems = function (items, onItemValueHandler, columns, itemPresets, itemResponse, select, providersBackstage) {\n      return cat(map$2(items, function (item) {\n        if (item.type === 'choiceitem') {\n          return createChoiceMenuItem(item).fold(handleError, function (d) {\n            return Optional.some(renderChoiceItem(d, columns === 1, itemPresets, onItemValueHandler, select(item.value), itemResponse, providersBackstage, menuHasIcons(items)));\n          });\n        } else {\n          return Optional.none();\n        }\n      }));\n    };\n\n    var deriveMenuMovement = function (columns, presets) {\n      var menuMarkers = markers(presets);\n      if (columns === 1) {\n        return {\n          mode: 'menu',\n          moveOnTab: true\n        };\n      } else if (columns === 'auto') {\n        return {\n          mode: 'grid',\n          selector: '.' + menuMarkers.item,\n          initSize: {\n            numColumns: 1,\n            numRows: 1\n          }\n        };\n      } else {\n        var rowClass = presets === 'color' ? 'tox-swatches__row' : 'tox-collection__group';\n        return {\n          mode: 'matrix',\n          rowSelector: '.' + rowClass\n        };\n      }\n    };\n    var deriveCollectionMovement = function (columns, presets) {\n      if (columns === 1) {\n        return {\n          mode: 'menu',\n          moveOnTab: false,\n          selector: '.tox-collection__item'\n        };\n      } else if (columns === 'auto') {\n        return {\n          mode: 'flatgrid',\n          selector: '.' + 'tox-collection__item',\n          initSize: {\n            numColumns: 1,\n            numRows: 1\n          }\n        };\n      } else {\n        return {\n          mode: 'matrix',\n          selectors: {\n            row: presets === 'color' ? '.tox-swatches__row' : '.tox-collection__group',\n            cell: presets === 'color' ? '.' + colorClass : '.' + selectableClass\n          }\n        };\n      }\n    };\n\n    var renderColorSwatchItem = function (spec, backstage) {\n      var items = getColorItems(spec, backstage);\n      var columns = backstage.colorinput.getColorCols();\n      var presets = 'color';\n      var menuSpec = createPartialChoiceMenu(generate$6('menu-value'), items, function (value) {\n        spec.onAction({ value: value });\n      }, columns, presets, ItemResponse$1.CLOSE_ON_EXECUTE, never, backstage.shared.providers);\n      var widgetSpec = __assign(__assign({}, menuSpec), {\n        markers: markers(presets),\n        movement: deriveMenuMovement(columns, presets)\n      });\n      return {\n        type: 'widget',\n        data: { value: generate$6('widget-id') },\n        dom: {\n          tag: 'div',\n          classes: ['tox-fancymenuitem']\n        },\n        autofocus: true,\n        components: [parts$f.widget(Menu.sketch(widgetSpec))]\n      };\n    };\n    var getColorItems = function (spec, backstage) {\n      var useCustomColors = spec.initData.allowCustomColors && backstage.colorinput.hasCustomColors();\n      return spec.initData.colors.fold(function () {\n        return getColors$1(backstage.colorinput.getColors(), useCustomColors);\n      }, function (colors) {\n        return colors.concat(getAdditionalColors(useCustomColors));\n      });\n    };\n\n    var cellOverEvent = generate$6('cell-over');\n    var cellExecuteEvent = generate$6('cell-execute');\n    var makeCell = function (row, col, labelId) {\n      var _a;\n      var emitCellOver = function (c) {\n        return emitWith(c, cellOverEvent, {\n          row: row,\n          col: col\n        });\n      };\n      var emitExecute = function (c) {\n        return emitWith(c, cellExecuteEvent, {\n          row: row,\n          col: col\n        });\n      };\n      var onClick = function (c, se) {\n        se.stop();\n        emitExecute(c);\n      };\n      return build$1({\n        dom: {\n          tag: 'div',\n          attributes: (_a = { role: 'button' }, _a['aria-labelledby'] = labelId, _a)\n        },\n        behaviours: derive$1([\n          config('insert-table-picker-cell', [\n            run$1(mouseover(), Focusing.focus),\n            run$1(execute$5(), emitExecute),\n            run$1(click(), onClick),\n            run$1(tap(), onClick)\n          ]),\n          Toggling.config({\n            toggleClass: 'tox-insert-table-picker__selected',\n            toggleOnExecute: false\n          }),\n          Focusing.config({ onFocus: emitCellOver })\n        ])\n      });\n    };\n    var makeCells = function (labelId, numRows, numCols) {\n      var cells = [];\n      for (var i = 0; i < numRows; i++) {\n        var row = [];\n        for (var j = 0; j < numCols; j++) {\n          row.push(makeCell(i, j, labelId));\n        }\n        cells.push(row);\n      }\n      return cells;\n    };\n    var selectCells = function (cells, selectedRow, selectedColumn, numRows, numColumns) {\n      for (var i = 0; i < numRows; i++) {\n        for (var j = 0; j < numColumns; j++) {\n          Toggling.set(cells[i][j], i <= selectedRow && j <= selectedColumn);\n        }\n      }\n    };\n    var makeComponents = function (cells) {\n      return bind$3(cells, function (cellRow) {\n        return map$2(cellRow, premade);\n      });\n    };\n    var makeLabelText = function (row, col) {\n      return text(col + 'x' + row);\n    };\n    var renderInsertTableMenuItem = function (spec) {\n      var numRows = 10;\n      var numColumns = 10;\n      var sizeLabelId = generate$6('size-label');\n      var cells = makeCells(sizeLabelId, numRows, numColumns);\n      var emptyLabelText = makeLabelText(0, 0);\n      var memLabel = record({\n        dom: {\n          tag: 'span',\n          classes: ['tox-insert-table-picker__label'],\n          attributes: { id: sizeLabelId }\n        },\n        components: [emptyLabelText],\n        behaviours: derive$1([Replacing.config({})])\n      });\n      return {\n        type: 'widget',\n        data: { value: generate$6('widget-id') },\n        dom: {\n          tag: 'div',\n          classes: ['tox-fancymenuitem']\n        },\n        autofocus: true,\n        components: [parts$f.widget({\n            dom: {\n              tag: 'div',\n              classes: ['tox-insert-table-picker']\n            },\n            components: makeComponents(cells).concat(memLabel.asSpec()),\n            behaviours: derive$1([\n              config('insert-table-picker', [\n                runOnAttached(function (c) {\n                  Replacing.set(memLabel.get(c), [emptyLabelText]);\n                }),\n                runWithTarget(cellOverEvent, function (c, t, e) {\n                  var _a = e.event, row = _a.row, col = _a.col;\n                  selectCells(cells, row, col, numRows, numColumns);\n                  Replacing.set(memLabel.get(c), [makeLabelText(row + 1, col + 1)]);\n                }),\n                runWithTarget(cellExecuteEvent, function (c, _, e) {\n                  var _a = e.event, row = _a.row, col = _a.col;\n                  spec.onAction({\n                    numRows: row + 1,\n                    numColumns: col + 1\n                  });\n                  emit(c, sandboxClose());\n                })\n              ]),\n              Keying.config({\n                initSize: {\n                  numRows: numRows,\n                  numColumns: numColumns\n                },\n                mode: 'flatgrid',\n                selector: '[role=\"button\"]'\n              })\n            ])\n          })]\n      };\n    };\n\n    var fancyMenuItems = {\n      inserttable: renderInsertTableMenuItem,\n      colorswatch: renderColorSwatchItem\n    };\n    var renderFancyMenuItem = function (spec, backstage) {\n      return get$e(fancyMenuItems, spec.fancytype).map(function (render) {\n        return render(spec, backstage);\n      });\n    };\n\n    var renderNestedItem = function (spec, itemResponse, providersBackstage, renderIcons, downwardsCaret) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      if (downwardsCaret === void 0) {\n        downwardsCaret = false;\n      }\n      var caret = downwardsCaret ? renderDownwardsCaret(providersBackstage.icons) : renderSubmenuCaret(providersBackstage.icons);\n      var getApi = function (component) {\n        return {\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(component, state);\n          }\n        };\n      };\n      var structure = renderItemStructure({\n        presets: 'normal',\n        iconContent: spec.icon,\n        textContent: spec.text,\n        htmlContent: Optional.none(),\n        ariaLabel: spec.text,\n        caret: Optional.some(caret),\n        checkMark: Optional.none(),\n        shortcutContent: spec.shortcut\n      }, providersBackstage, renderIcons);\n      return renderCommonItem({\n        data: buildData(spec),\n        getApi: getApi,\n        disabled: spec.disabled,\n        onAction: noop,\n        onSetup: spec.onSetup,\n        triggersSubmenu: true,\n        itemBehaviours: []\n      }, structure, itemResponse, providersBackstage);\n    };\n\n    var renderNormalItem = function (spec, itemResponse, providersBackstage, renderIcons) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      var getApi = function (component) {\n        return {\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(component, state);\n          }\n        };\n      };\n      var structure = renderItemStructure({\n        presets: 'normal',\n        iconContent: spec.icon,\n        textContent: spec.text,\n        htmlContent: Optional.none(),\n        ariaLabel: spec.text,\n        caret: Optional.none(),\n        checkMark: Optional.none(),\n        shortcutContent: spec.shortcut\n      }, providersBackstage, renderIcons);\n      return renderCommonItem({\n        data: buildData(spec),\n        getApi: getApi,\n        disabled: spec.disabled,\n        onAction: spec.onAction,\n        onSetup: spec.onSetup,\n        triggersSubmenu: false,\n        itemBehaviours: []\n      }, structure, itemResponse, providersBackstage);\n    };\n\n    var renderSeparatorItem = function (spec) {\n      var innerHtml = spec.text.fold(function () {\n        return {};\n      }, function (text) {\n        return { innerHtml: text };\n      });\n      return {\n        type: 'separator',\n        dom: __assign({\n          tag: 'div',\n          classes: [\n            selectableClass,\n            groupHeadingClass\n          ]\n        }, innerHtml),\n        components: []\n      };\n    };\n\n    var renderToggleMenuItem = function (spec, itemResponse, providersBackstage, renderIcons) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      var getApi = function (component) {\n        return {\n          setActive: function (state) {\n            Toggling.set(component, state);\n          },\n          isActive: function () {\n            return Toggling.isOn(component);\n          },\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(component, state);\n          }\n        };\n      };\n      var structure = renderItemStructure({\n        iconContent: spec.icon,\n        textContent: spec.text,\n        htmlContent: Optional.none(),\n        ariaLabel: spec.text,\n        checkMark: Optional.some(renderCheckmark(providersBackstage.icons)),\n        caret: Optional.none(),\n        shortcutContent: spec.shortcut,\n        presets: 'normal',\n        meta: spec.meta\n      }, providersBackstage, renderIcons);\n      return deepMerge(renderCommonItem({\n        data: buildData(spec),\n        disabled: spec.disabled,\n        getApi: getApi,\n        onAction: spec.onAction,\n        onSetup: spec.onSetup,\n        triggersSubmenu: false,\n        itemBehaviours: []\n      }, structure, itemResponse, providersBackstage), {\n        toggling: {\n          toggleClass: tickedClass,\n          toggleOnExecute: false,\n          selected: spec.active\n        }\n      });\n    };\n\n    var autocomplete = renderAutocompleteItem;\n    var separator$3 = renderSeparatorItem;\n    var normal = renderNormalItem;\n    var nested = renderNestedItem;\n    var toggle$1 = renderToggleMenuItem;\n    var fancy = renderFancyMenuItem;\n    var card = renderCardMenuItem;\n\n    var FocusMode;\n    (function (FocusMode) {\n      FocusMode[FocusMode['ContentFocus'] = 0] = 'ContentFocus';\n      FocusMode[FocusMode['UiFocus'] = 1] = 'UiFocus';\n    }(FocusMode || (FocusMode = {})));\n    var createMenuItemFromBridge = function (item, itemResponse, backstage, menuHasIcons, isHorizontalMenu) {\n      var providersBackstage = backstage.shared.providers;\n      var parseForHorizontalMenu = function (menuitem) {\n        return !isHorizontalMenu ? menuitem : __assign(__assign({}, menuitem), {\n          shortcut: Optional.none(),\n          icon: menuitem.text.isSome() ? Optional.none() : menuitem.icon\n        });\n      };\n      switch (item.type) {\n      case 'menuitem':\n        return createMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(normal(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons));\n        });\n      case 'nestedmenuitem':\n        return createNestedMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(nested(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons, isHorizontalMenu));\n        });\n      case 'togglemenuitem':\n        return createToggleMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(toggle$1(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons));\n        });\n      case 'separator':\n        return createSeparatorMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(separator$3(d));\n        });\n      case 'fancymenuitem':\n        return createFancyMenuItem(item).fold(handleError, function (d) {\n          return fancy(parseForHorizontalMenu(d), backstage);\n        });\n      default: {\n          console.error('Unknown item in general menu', item);\n          return Optional.none();\n        }\n      }\n    };\n    var createAutocompleteItems = function (items, matchText, onItemValueHandler, columns, itemResponse, sharedBackstage, highlightOn) {\n      var renderText = columns === 1;\n      var renderIcons = !renderText || menuHasIcons(items);\n      return cat(map$2(items, function (item) {\n        switch (item.type) {\n        case 'separator':\n          return createSeparatorItem(item).fold(handleError, function (d) {\n            return Optional.some(separator$3(d));\n          });\n        case 'cardmenuitem':\n          return createCardMenuItem(item).fold(handleError, function (d) {\n            return Optional.some(card(__assign(__assign({}, d), {\n              onAction: function (api) {\n                d.onAction(api);\n                onItemValueHandler(d.value, d.meta);\n              }\n            }), itemResponse, sharedBackstage, {\n              itemBehaviours: tooltipBehaviour(d.meta, sharedBackstage),\n              cardText: {\n                matchText: matchText,\n                highlightOn: highlightOn\n              }\n            }));\n          });\n        case 'autocompleteitem':\n        default:\n          return createAutocompleterItem(item).fold(handleError, function (d) {\n            return Optional.some(autocomplete(d, matchText, renderText, 'normal', onItemValueHandler, itemResponse, sharedBackstage, renderIcons));\n          });\n        }\n      }));\n    };\n    var createPartialMenu = function (value, items, itemResponse, backstage, isHorizontalMenu) {\n      var hasIcons = menuHasIcons(items);\n      var alloyItems = cat(map$2(items, function (item) {\n        var itemHasIcon = function (i) {\n          return isHorizontalMenu ? !has$2(i, 'text') : hasIcons;\n        };\n        var createItem = function (i) {\n          return createMenuItemFromBridge(i, itemResponse, backstage, itemHasIcon(i), isHorizontalMenu);\n        };\n        if (item.type === 'nestedmenuitem' && item.getSubmenuItems().length <= 0) {\n          return createItem(__assign(__assign({}, item), { disabled: true }));\n        } else {\n          return createItem(item);\n        }\n      }));\n      var createPartial = isHorizontalMenu ? createHorizontalPartialMenuWithAlloyItems : createPartialMenuWithAlloyItems;\n      return createPartial(value, hasIcons, alloyItems, 1, 'normal');\n    };\n    var createTieredDataFrom = function (partialMenu) {\n      return tieredMenu.singleData(partialMenu.value, partialMenu);\n    };\n    var createMenuFrom = function (partialMenu, columns, focusMode, presets) {\n      var focusManager = focusMode === FocusMode.ContentFocus ? highlights() : dom$2();\n      var movement = deriveMenuMovement(columns, presets);\n      var menuMarkers = markers(presets);\n      return {\n        dom: partialMenu.dom,\n        components: partialMenu.components,\n        items: partialMenu.items,\n        value: partialMenu.value,\n        markers: {\n          selectedItem: menuMarkers.selectedItem,\n          item: menuMarkers.item\n        },\n        movement: movement,\n        fakeFocus: focusMode === FocusMode.ContentFocus,\n        focusManager: focusManager,\n        menuBehaviours: SimpleBehaviours.unnamedEvents(columns !== 'auto' ? [] : [runOnAttached(function (comp, _se) {\n            detectSize(comp, 4, menuMarkers.item).each(function (_a) {\n              var numColumns = _a.numColumns, numRows = _a.numRows;\n              Keying.setGridSize(comp, numRows, numColumns);\n            });\n          })])\n      };\n    };\n\n    var register$9 = function (editor, sharedBackstage) {\n      var activeAutocompleter = value$1();\n      var processingAction = Cell(false);\n      var autocompleter = build$1(InlineView.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-autocompleter']\n        },\n        components: [],\n        fireDismissalEventInstead: {},\n        inlineBehaviours: derive$1([config('dismissAutocompleter', [run$1(dismissRequested(), function () {\n              return cancelIfNecessary();\n            })])]),\n        lazySink: sharedBackstage.getSink\n      }));\n      var isMenuOpen = function () {\n        return InlineView.isOpen(autocompleter);\n      };\n      var isActive = function () {\n        return activeAutocompleter.get().isSome();\n      };\n      var hideIfNecessary = function () {\n        if (isActive()) {\n          InlineView.hide(autocompleter);\n        }\n      };\n      var cancelIfNecessary = function () {\n        if (isActive()) {\n          var lastElement = activeAutocompleter.get().map(function (ac) {\n            return ac.element;\n          });\n          detect(lastElement.getOr(SugarElement.fromDom(editor.selection.getNode()))).each(unwrap);\n          hideIfNecessary();\n          activeAutocompleter.clear();\n          processingAction.set(false);\n        }\n      };\n      var getAutocompleters = cached(function () {\n        return register$b(editor);\n      });\n      var getCombinedItems = function (triggerChar, matches) {\n        var columns = findMap(matches, function (m) {\n          return Optional.from(m.columns);\n        }).getOr(1);\n        return bind$3(matches, function (match) {\n          var choices = match.items;\n          return createAutocompleteItems(choices, match.matchText, function (itemValue, itemMeta) {\n            var nr = editor.selection.getRng();\n            getContext(editor.dom, nr, triggerChar).fold(function () {\n              return console.error('Lost context. Cursor probably moved');\n            }, function (_a) {\n              var range = _a.range;\n              var autocompleterApi = {\n                hide: function () {\n                  cancelIfNecessary();\n                },\n                reload: function (fetchOptions) {\n                  hideIfNecessary();\n                  load(fetchOptions);\n                }\n              };\n              processingAction.set(true);\n              match.onAction(autocompleterApi, range, itemValue, itemMeta);\n              processingAction.set(false);\n            });\n          }, columns, ItemResponse$1.BUBBLE_TO_SANDBOX, sharedBackstage, match.highlightOn);\n        });\n      };\n      var commenceIfNecessary = function (context) {\n        if (!isActive()) {\n          var wrapper = create$4(editor, context.range);\n          activeAutocompleter.set({\n            triggerChar: context.triggerChar,\n            element: wrapper,\n            matchLength: context.text.length\n          });\n          processingAction.set(false);\n        }\n      };\n      var display = function (ac, context, lookupData, items) {\n        ac.matchLength = context.text.length;\n        var columns = findMap(lookupData, function (ld) {\n          return Optional.from(ld.columns);\n        }).getOr(1);\n        InlineView.showAt(autocompleter, Menu.sketch(createMenuFrom(createPartialMenuWithAlloyItems('autocompleter-value', true, items, columns, 'normal'), columns, FocusMode.ContentFocus, 'normal')), {\n          anchor: {\n            type: 'node',\n            root: SugarElement.fromDom(editor.getBody()),\n            node: Optional.from(ac.element)\n          }\n        });\n        InlineView.getContent(autocompleter).each(Highlighting.highlightFirst);\n      };\n      var doLookup = function (fetchOptions) {\n        return activeAutocompleter.get().map(function (ac) {\n          return getContext(editor.dom, editor.selection.getRng(), ac.triggerChar).bind(function (newContext) {\n            return lookupWithContext(editor, getAutocompleters, newContext, fetchOptions);\n          });\n        }).getOrThunk(function () {\n          return lookup$2(editor, getAutocompleters);\n        });\n      };\n      var load = function (fetchOptions) {\n        doLookup(fetchOptions).fold(cancelIfNecessary, function (lookupInfo) {\n          commenceIfNecessary(lookupInfo.context);\n          lookupInfo.lookupData.then(function (lookupData) {\n            activeAutocompleter.get().map(function (ac) {\n              var context = lookupInfo.context;\n              if (ac.triggerChar === context.triggerChar) {\n                var combinedItems = getCombinedItems(context.triggerChar, lookupData);\n                if (combinedItems.length > 0) {\n                  display(ac, context, lookupData, combinedItems);\n                } else if (context.text.length - ac.matchLength >= 10) {\n                  cancelIfNecessary();\n                } else {\n                  hideIfNecessary();\n                }\n              }\n            });\n          });\n        });\n      };\n      var onKeypress = last(function (e) {\n        if (e.which === 27) {\n          return;\n        }\n        load();\n      }, 50);\n      var autocompleterUiApi = {\n        onKeypress: onKeypress,\n        cancelIfNecessary: cancelIfNecessary,\n        isMenuOpen: isMenuOpen,\n        isActive: isActive,\n        isProcessingAction: processingAction.get,\n        getView: function () {\n          return InlineView.getContent(autocompleter);\n        }\n      };\n      if (editor.hasPlugin('rtc') === false) {\n        AutocompleterEditorEvents.setup(autocompleterUiApi, editor);\n      }\n    };\n    var Autocompleter = { register: register$9 };\n\n    var closest = function (scope, selector, isRoot) {\n      return closest$1(scope, selector, isRoot).isSome();\n    };\n\n    var DelayedFunction = function (fun, delay) {\n      var ref = null;\n      var schedule = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        ref = setTimeout(function () {\n          fun.apply(null, args);\n          ref = null;\n        }, delay);\n      };\n      var cancel = function () {\n        if (ref !== null) {\n          clearTimeout(ref);\n          ref = null;\n        }\n      };\n      return {\n        cancel: cancel,\n        schedule: schedule\n      };\n    };\n\n    var SIGNIFICANT_MOVE = 5;\n    var LONGPRESS_DELAY = 400;\n    var getTouch = function (event) {\n      var raw = event.raw;\n      if (raw.touches === undefined || raw.touches.length !== 1) {\n        return Optional.none();\n      }\n      return Optional.some(raw.touches[0]);\n    };\n    var isFarEnough = function (touch, data) {\n      var distX = Math.abs(touch.clientX - data.x);\n      var distY = Math.abs(touch.clientY - data.y);\n      return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n    };\n    var monitor = function (settings) {\n      var startData = value$1();\n      var longpressFired = Cell(false);\n      var longpress$1 = DelayedFunction(function (event) {\n        settings.triggerEvent(longpress(), event);\n        longpressFired.set(true);\n      }, LONGPRESS_DELAY);\n      var handleTouchstart = function (event) {\n        getTouch(event).each(function (touch) {\n          longpress$1.cancel();\n          var data = {\n            x: touch.clientX,\n            y: touch.clientY,\n            target: event.target\n          };\n          longpress$1.schedule(event);\n          longpressFired.set(false);\n          startData.set(data);\n        });\n        return Optional.none();\n      };\n      var handleTouchmove = function (event) {\n        longpress$1.cancel();\n        getTouch(event).each(function (touch) {\n          startData.on(function (data) {\n            if (isFarEnough(touch, data)) {\n              startData.clear();\n            }\n          });\n        });\n        return Optional.none();\n      };\n      var handleTouchend = function (event) {\n        longpress$1.cancel();\n        var isSame = function (data) {\n          return eq(data.target, event.target);\n        };\n        return startData.get().filter(isSame).map(function (_data) {\n          if (longpressFired.get()) {\n            event.prevent();\n            return false;\n          } else {\n            return settings.triggerEvent(tap(), event);\n          }\n        });\n      };\n      var handlers = wrapAll([\n        {\n          key: touchstart(),\n          value: handleTouchstart\n        },\n        {\n          key: touchmove(),\n          value: handleTouchmove\n        },\n        {\n          key: touchend(),\n          value: handleTouchend\n        }\n      ]);\n      var fireIfReady = function (event, type) {\n        return get$e(handlers, type).bind(function (handler) {\n          return handler(event);\n        });\n      };\n      return { fireIfReady: fireIfReady };\n    };\n\n    var isDangerous = function (event) {\n      var keyEv = event.raw;\n      return keyEv.which === BACKSPACE[0] && !contains$2([\n        'input',\n        'textarea'\n      ], name$2(event.target)) && !closest(event.target, '[contenteditable=\"true\"]');\n    };\n    var isFirefox = function () {\n      return detect$1().browser.isFirefox();\n    };\n    var bindFocus = function (container, handler) {\n      if (isFirefox()) {\n        return capture(container, 'focus', handler);\n      } else {\n        return bind(container, 'focusin', handler);\n      }\n    };\n    var bindBlur = function (container, handler) {\n      if (isFirefox()) {\n        return capture(container, 'blur', handler);\n      } else {\n        return bind(container, 'focusout', handler);\n      }\n    };\n    var setup$d = function (container, rawSettings) {\n      var settings = __assign({ stopBackspace: true }, rawSettings);\n      var pointerEvents = [\n        'touchstart',\n        'touchmove',\n        'touchend',\n        'touchcancel',\n        'gesturestart',\n        'mousedown',\n        'mouseup',\n        'mouseover',\n        'mousemove',\n        'mouseout',\n        'click'\n      ];\n      var tapEvent = monitor(settings);\n      var simpleEvents = map$2(pointerEvents.concat([\n        'selectstart',\n        'input',\n        'contextmenu',\n        'change',\n        'transitionend',\n        'transitioncancel',\n        'drag',\n        'dragstart',\n        'dragend',\n        'dragenter',\n        'dragleave',\n        'dragover',\n        'drop',\n        'keyup'\n      ]), function (type) {\n        return bind(container, type, function (event) {\n          tapEvent.fireIfReady(event, type).each(function (tapStopped) {\n            if (tapStopped) {\n              event.kill();\n            }\n          });\n          var stopped = settings.triggerEvent(type, event);\n          if (stopped) {\n            event.kill();\n          }\n        });\n      });\n      var pasteTimeout = value$1();\n      var onPaste = bind(container, 'paste', function (event) {\n        tapEvent.fireIfReady(event, 'paste').each(function (tapStopped) {\n          if (tapStopped) {\n            event.kill();\n          }\n        });\n        var stopped = settings.triggerEvent('paste', event);\n        if (stopped) {\n          event.kill();\n        }\n        pasteTimeout.set(setTimeout(function () {\n          settings.triggerEvent(postPaste(), event);\n        }, 0));\n      });\n      var onKeydown = bind(container, 'keydown', function (event) {\n        var stopped = settings.triggerEvent('keydown', event);\n        if (stopped) {\n          event.kill();\n        } else if (settings.stopBackspace && isDangerous(event)) {\n          event.prevent();\n        }\n      });\n      var onFocusIn = bindFocus(container, function (event) {\n        var stopped = settings.triggerEvent('focusin', event);\n        if (stopped) {\n          event.kill();\n        }\n      });\n      var focusoutTimeout = value$1();\n      var onFocusOut = bindBlur(container, function (event) {\n        var stopped = settings.triggerEvent('focusout', event);\n        if (stopped) {\n          event.kill();\n        }\n        focusoutTimeout.set(setTimeout(function () {\n          settings.triggerEvent(postBlur(), event);\n        }, 0));\n      });\n      var unbind = function () {\n        each$1(simpleEvents, function (e) {\n          e.unbind();\n        });\n        onKeydown.unbind();\n        onFocusIn.unbind();\n        onFocusOut.unbind();\n        onPaste.unbind();\n        pasteTimeout.on(clearTimeout);\n        focusoutTimeout.on(clearTimeout);\n      };\n      return { unbind: unbind };\n    };\n\n    var derive = function (rawEvent, rawTarget) {\n      var source = get$e(rawEvent, 'target').getOr(rawTarget);\n      return Cell(source);\n    };\n\n    var fromSource = function (event, source) {\n      var stopper = Cell(false);\n      var cutter = Cell(false);\n      var stop = function () {\n        stopper.set(true);\n      };\n      var cut = function () {\n        cutter.set(true);\n      };\n      return {\n        stop: stop,\n        cut: cut,\n        isStopped: stopper.get,\n        isCut: cutter.get,\n        event: event,\n        setSource: source.set,\n        getSource: source.get\n      };\n    };\n    var fromExternal = function (event) {\n      var stopper = Cell(false);\n      var stop = function () {\n        stopper.set(true);\n      };\n      return {\n        stop: stop,\n        cut: noop,\n        isStopped: stopper.get,\n        isCut: never,\n        event: event,\n        setSource: die('Cannot set source of a broadcasted event'),\n        getSource: die('Cannot get source of a broadcasted event')\n      };\n    };\n\n    var adt$1 = Adt.generate([\n      { stopped: [] },\n      { resume: ['element'] },\n      { complete: [] }\n    ]);\n    var doTriggerHandler = function (lookup, eventType, rawEvent, target, source, logger) {\n      var handler = lookup(eventType, target);\n      var simulatedEvent = fromSource(rawEvent, source);\n      return handler.fold(function () {\n        logger.logEventNoHandlers(eventType, target);\n        return adt$1.complete();\n      }, function (handlerInfo) {\n        var descHandler = handlerInfo.descHandler;\n        var eventHandler = getCurried(descHandler);\n        eventHandler(simulatedEvent);\n        if (simulatedEvent.isStopped()) {\n          logger.logEventStopped(eventType, handlerInfo.element, descHandler.purpose);\n          return adt$1.stopped();\n        } else if (simulatedEvent.isCut()) {\n          logger.logEventCut(eventType, handlerInfo.element, descHandler.purpose);\n          return adt$1.complete();\n        } else {\n          return parent(handlerInfo.element).fold(function () {\n            logger.logNoParent(eventType, handlerInfo.element, descHandler.purpose);\n            return adt$1.complete();\n          }, function (parent) {\n            logger.logEventResponse(eventType, handlerInfo.element, descHandler.purpose);\n            return adt$1.resume(parent);\n          });\n        }\n      });\n    };\n    var doTriggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, source, logger) {\n      return doTriggerHandler(lookup, eventType, rawEvent, rawTarget, source, logger).fold(always, function (parent) {\n        return doTriggerOnUntilStopped(lookup, eventType, rawEvent, parent, source, logger);\n      }, never);\n    };\n    var triggerHandler = function (lookup, eventType, rawEvent, target, logger) {\n      var source = derive(rawEvent, target);\n      return doTriggerHandler(lookup, eventType, rawEvent, target, source, logger);\n    };\n    var broadcast = function (listeners, rawEvent, _logger) {\n      var simulatedEvent = fromExternal(rawEvent);\n      each$1(listeners, function (listener) {\n        var descHandler = listener.descHandler;\n        var handler = getCurried(descHandler);\n        handler(simulatedEvent);\n      });\n      return simulatedEvent.isStopped();\n    };\n    var triggerUntilStopped = function (lookup, eventType, rawEvent, logger) {\n      return triggerOnUntilStopped(lookup, eventType, rawEvent, rawEvent.target, logger);\n    };\n    var triggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, logger) {\n      var source = derive(rawEvent, rawTarget);\n      return doTriggerOnUntilStopped(lookup, eventType, rawEvent, rawTarget, source, logger);\n    };\n\n    var eventHandler = function (element, descHandler) {\n      return {\n        element: element,\n        descHandler: descHandler\n      };\n    };\n    var broadcastHandler = function (id, handler) {\n      return {\n        id: id,\n        descHandler: handler\n      };\n    };\n    var EventRegistry = function () {\n      var registry = {};\n      var registerId = function (extraArgs, id, events) {\n        each(events, function (v, k) {\n          var handlers = registry[k] !== undefined ? registry[k] : {};\n          handlers[id] = curryArgs(v, extraArgs);\n          registry[k] = handlers;\n        });\n      };\n      var findHandler = function (handlers, elem) {\n        return read$1(elem).bind(function (id) {\n          return get$e(handlers, id);\n        }).map(function (descHandler) {\n          return eventHandler(elem, descHandler);\n        });\n      };\n      var filterByType = function (type) {\n        return get$e(registry, type).map(function (handlers) {\n          return mapToArray(handlers, function (f, id) {\n            return broadcastHandler(id, f);\n          });\n        }).getOr([]);\n      };\n      var find = function (isAboveRoot, type, target) {\n        return get$e(registry, type).bind(function (handlers) {\n          return closest$4(target, function (elem) {\n            return findHandler(handlers, elem);\n          }, isAboveRoot);\n        });\n      };\n      var unregisterId = function (id) {\n        each(registry, function (handlersById, _eventName) {\n          if (has$2(handlersById, id)) {\n            delete handlersById[id];\n          }\n        });\n      };\n      return {\n        registerId: registerId,\n        unregisterId: unregisterId,\n        filterByType: filterByType,\n        find: find\n      };\n    };\n\n    var Registry = function () {\n      var events = EventRegistry();\n      var components = {};\n      var readOrTag = function (component) {\n        var elem = component.element;\n        return read$1(elem).getOrThunk(function () {\n          return write('uid-', component.element);\n        });\n      };\n      var failOnDuplicate = function (component, tagId) {\n        var conflict = components[tagId];\n        if (conflict === component) {\n          unregister(component);\n        } else {\n          throw new Error('The tagId \"' + tagId + '\" is already used by: ' + element(conflict.element) + '\\nCannot use it for: ' + element(component.element) + '\\n' + 'The conflicting element is' + (inBody(conflict.element) ? ' ' : ' not ') + 'already in the DOM');\n        }\n      };\n      var register = function (component) {\n        var tagId = readOrTag(component);\n        if (hasNonNullableKey(components, tagId)) {\n          failOnDuplicate(component, tagId);\n        }\n        var extraArgs = [component];\n        events.registerId(extraArgs, tagId, component.events);\n        components[tagId] = component;\n      };\n      var unregister = function (component) {\n        read$1(component.element).each(function (tagId) {\n          delete components[tagId];\n          events.unregisterId(tagId);\n        });\n      };\n      var filter = function (type) {\n        return events.filterByType(type);\n      };\n      var find = function (isAboveRoot, type, target) {\n        return events.find(isAboveRoot, type, target);\n      };\n      var getById = function (id) {\n        return get$e(components, id);\n      };\n      return {\n        find: find,\n        filter: filter,\n        register: register,\n        unregister: unregister,\n        getById: getById\n      };\n    };\n\n    var factory$j = function (detail) {\n      var _a = detail.dom, attributes = _a.attributes, domWithoutAttributes = __rest(_a, ['attributes']);\n      return {\n        uid: detail.uid,\n        dom: __assign({\n          tag: 'div',\n          attributes: __assign({ role: 'presentation' }, attributes)\n        }, domWithoutAttributes),\n        components: detail.components,\n        behaviours: get$2(detail.containerBehaviours),\n        events: detail.events,\n        domModification: detail.domModification,\n        eventOrder: detail.eventOrder\n      };\n    };\n    var Container = single({\n      name: 'Container',\n      factory: factory$j,\n      configFields: [\n        defaulted('components', []),\n        field('containerBehaviours', []),\n        defaulted('events', {}),\n        defaulted('domModification', {}),\n        defaulted('eventOrder', {})\n      ]\n    });\n\n    var takeover = function (root) {\n      var isAboveRoot = function (el) {\n        return parent(root.element).fold(always, function (parent) {\n          return eq(el, parent);\n        });\n      };\n      var registry = Registry();\n      var lookup = function (eventName, target) {\n        return registry.find(isAboveRoot, eventName, target);\n      };\n      var domEvents = setup$d(root.element, {\n        triggerEvent: function (eventName, event) {\n          return monitorEvent(eventName, event.target, function (logger) {\n            return triggerUntilStopped(lookup, eventName, event, logger);\n          });\n        }\n      });\n      var systemApi = {\n        debugInfo: constant$1('real'),\n        triggerEvent: function (eventName, target, data) {\n          monitorEvent(eventName, target, function (logger) {\n            return triggerOnUntilStopped(lookup, eventName, data, target, logger);\n          });\n        },\n        triggerFocus: function (target, originator) {\n          read$1(target).fold(function () {\n            focus$3(target);\n          }, function (_alloyId) {\n            monitorEvent(focus$4(), target, function (logger) {\n              triggerHandler(lookup, focus$4(), {\n                originator: originator,\n                kill: noop,\n                prevent: noop,\n                target: target\n              }, target, logger);\n              return false;\n            });\n          });\n        },\n        triggerEscape: function (comp, simulatedEvent) {\n          systemApi.triggerEvent('keydown', comp.element, simulatedEvent.event);\n        },\n        getByUid: function (uid) {\n          return getByUid(uid);\n        },\n        getByDom: function (elem) {\n          return getByDom(elem);\n        },\n        build: build$1,\n        addToGui: function (c) {\n          add(c);\n        },\n        removeFromGui: function (c) {\n          remove(c);\n        },\n        addToWorld: function (c) {\n          addToWorld(c);\n        },\n        removeFromWorld: function (c) {\n          removeFromWorld(c);\n        },\n        broadcast: function (message) {\n          broadcast$1(message);\n        },\n        broadcastOn: function (channels, message) {\n          broadcastOn(channels, message);\n        },\n        broadcastEvent: function (eventName, event) {\n          broadcastEvent(eventName, event);\n        },\n        isConnected: always\n      };\n      var addToWorld = function (component) {\n        component.connect(systemApi);\n        if (!isText$1(component.element)) {\n          registry.register(component);\n          each$1(component.components(), addToWorld);\n          systemApi.triggerEvent(systemInit(), component.element, { target: component.element });\n        }\n      };\n      var removeFromWorld = function (component) {\n        if (!isText$1(component.element)) {\n          each$1(component.components(), removeFromWorld);\n          registry.unregister(component);\n        }\n        component.disconnect();\n      };\n      var add = function (component) {\n        attach(root, component);\n      };\n      var remove = function (component) {\n        detach(component);\n      };\n      var destroy = function () {\n        domEvents.unbind();\n        remove$5(root.element);\n      };\n      var broadcastData = function (data) {\n        var receivers = registry.filter(receive());\n        each$1(receivers, function (receiver) {\n          var descHandler = receiver.descHandler;\n          var handler = getCurried(descHandler);\n          handler(data);\n        });\n      };\n      var broadcast$1 = function (message) {\n        broadcastData({\n          universal: true,\n          data: message\n        });\n      };\n      var broadcastOn = function (channels, message) {\n        broadcastData({\n          universal: false,\n          channels: channels,\n          data: message\n        });\n      };\n      var broadcastEvent = function (eventName, event) {\n        var listeners = registry.filter(eventName);\n        return broadcast(listeners, event);\n      };\n      var getByUid = function (uid) {\n        return registry.getById(uid).fold(function () {\n          return Result.error(new Error('Could not find component with uid: \"' + uid + '\" in system.'));\n        }, Result.value);\n      };\n      var getByDom = function (elem) {\n        var uid = read$1(elem).getOr('not found');\n        return getByUid(uid);\n      };\n      addToWorld(root);\n      return {\n        root: root,\n        element: root.element,\n        destroy: destroy,\n        add: add,\n        remove: remove,\n        getByUid: getByUid,\n        getByDom: getByDom,\n        addToWorld: addToWorld,\n        removeFromWorld: removeFromWorld,\n        broadcast: broadcast$1,\n        broadcastOn: broadcastOn,\n        broadcastEvent: broadcastEvent\n      };\n    };\n\n    var renderBar = function (spec, backstage) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-bar',\n            'tox-form__controls-h-stack'\n          ]\n        },\n        components: map$2(spec.items, backstage.interpreter)\n      };\n    };\n\n    var schema$l = constant$1([\n      defaulted('prefix', 'form-field'),\n      field('fieldBehaviours', [\n        Composing,\n        Representing\n      ])\n    ]);\n    var parts$e = constant$1([\n      optional({\n        schema: [required$1('dom')],\n        name: 'label'\n      }),\n      optional({\n        factory: {\n          sketch: function (spec) {\n            return {\n              uid: spec.uid,\n              dom: {\n                tag: 'span',\n                styles: { display: 'none' },\n                attributes: { 'aria-hidden': 'true' },\n                innerHtml: spec.text\n              }\n            };\n          }\n        },\n        schema: [required$1('text')],\n        name: 'aria-descriptor'\n      }),\n      required({\n        factory: {\n          sketch: function (spec) {\n            var excludeFactory = exclude(spec, ['factory']);\n            return spec.factory.sketch(excludeFactory);\n          }\n        },\n        schema: [required$1('factory')],\n        name: 'field'\n      })\n    ]);\n\n    var factory$i = function (detail, components, _spec, _externals) {\n      var behaviours = augment(detail.fieldBehaviours, [\n        Composing.config({\n          find: function (container) {\n            return getPart(container, detail, 'field');\n          }\n        }),\n        Representing.config({\n          store: {\n            mode: 'manual',\n            getValue: function (field) {\n              return Composing.getCurrent(field).bind(Representing.getValue);\n            },\n            setValue: function (field, value) {\n              Composing.getCurrent(field).each(function (current) {\n                Representing.setValue(current, value);\n              });\n            }\n          }\n        })\n      ]);\n      var events = derive$2([runOnAttached(function (component, _simulatedEvent) {\n          var ps = getParts(component, detail, [\n            'label',\n            'field',\n            'aria-descriptor'\n          ]);\n          ps.field().each(function (field) {\n            var id = generate$6(detail.prefix);\n            ps.label().each(function (label) {\n              set$8(label.element, 'for', id);\n              set$8(field.element, 'id', id);\n            });\n            ps['aria-descriptor']().each(function (descriptor) {\n              var descriptorId = generate$6(detail.prefix);\n              set$8(descriptor.element, 'id', descriptorId);\n              set$8(field.element, 'aria-describedby', descriptorId);\n            });\n          });\n        })]);\n      var apis = {\n        getField: function (container) {\n          return getPart(container, detail, 'field');\n        },\n        getLabel: function (container) {\n          return getPart(container, detail, 'label');\n        }\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: behaviours,\n        events: events,\n        apis: apis\n      };\n    };\n    var FormField = composite({\n      name: 'FormField',\n      configFields: schema$l(),\n      partFields: parts$e(),\n      factory: factory$i,\n      apis: {\n        getField: function (apis, comp) {\n          return apis.getField(comp);\n        },\n        getLabel: function (apis, comp) {\n          return apis.getLabel(comp);\n        }\n      }\n    });\n\n    var exhibit$2 = function (base, tabConfig) {\n      return nu$7({\n        attributes: wrapAll([{\n            key: tabConfig.tabAttr,\n            value: 'true'\n          }])\n      });\n    };\n\n    var ActiveTabstopping = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$2\n    });\n\n    var TabstopSchema = [defaulted('tabAttr', 'data-alloy-tabstop')];\n\n    var Tabstopping = create$7({\n      fields: TabstopSchema,\n      name: 'tabstopping',\n      active: ActiveTabstopping\n    });\n\n    var global$7 = tinymce.util.Tools.resolve('tinymce.html.Entities');\n\n    var renderFormFieldWith = function (pLabel, pField, extraClasses, extraBehaviours) {\n      var spec = renderFormFieldSpecWith(pLabel, pField, extraClasses, extraBehaviours);\n      return FormField.sketch(spec);\n    };\n    var renderFormField = function (pLabel, pField) {\n      return renderFormFieldWith(pLabel, pField, [], []);\n    };\n    var renderFormFieldSpecWith = function (pLabel, pField, extraClasses, extraBehaviours) {\n      return {\n        dom: renderFormFieldDomWith(extraClasses),\n        components: pLabel.toArray().concat([pField]),\n        fieldBehaviours: derive$1(extraBehaviours)\n      };\n    };\n    var renderFormFieldDom = function () {\n      return renderFormFieldDomWith([]);\n    };\n    var renderFormFieldDomWith = function (extraClasses) {\n      return {\n        tag: 'div',\n        classes: ['tox-form__group'].concat(extraClasses)\n      };\n    };\n    var renderLabel$2 = function (label, providersBackstage) {\n      return FormField.parts.label({\n        dom: {\n          tag: 'label',\n          classes: ['tox-label'],\n          innerHtml: providersBackstage.translate(label)\n        }\n      });\n    };\n\n    var formChangeEvent = generate$6('form-component-change');\n    var formCloseEvent = generate$6('form-close');\n    var formCancelEvent = generate$6('form-cancel');\n    var formActionEvent = generate$6('form-action');\n    var formSubmitEvent = generate$6('form-submit');\n    var formBlockEvent = generate$6('form-block');\n    var formUnblockEvent = generate$6('form-unblock');\n    var formTabChangeEvent = generate$6('form-tabchange');\n    var formResizeEvent = generate$6('form-resize');\n\n    var renderCollection = function (spec, providersBackstage) {\n      var _a;\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel$2(label, providersBackstage);\n      });\n      var runOnItem = function (f) {\n        return function (comp, se) {\n          closest$1(se.event.target, '[data-collection-item-value]').each(function (target) {\n            f(comp, se, target, get$d(target, 'data-collection-item-value'));\n          });\n        };\n      };\n      var setContents = function (comp, items) {\n        var htmlLines = map$2(items, function (item) {\n          var itemText = global$e.translate(item.text);\n          var textContent = spec.columns === 1 ? '<div class=\"tox-collection__item-label\">' + itemText + '</div>' : '';\n          var iconContent = '<div class=\"tox-collection__item-icon\">' + item.icon + '</div>';\n          var mapItemName = {\n            '_': ' ',\n            ' - ': ' ',\n            '-': ' '\n          };\n          var ariaLabel = itemText.replace(/\\_| \\- |\\-/g, function (match) {\n            return mapItemName[match];\n          });\n          var disabledClass = providersBackstage.isDisabled() ? ' tox-collection__item--state-disabled' : '';\n          return '<div class=\"tox-collection__item' + disabledClass + '\" tabindex=\"-1\" data-collection-item-value=\"' + global$7.encodeAllRaw(item.value) + '\" title=\"' + ariaLabel + '\" aria-label=\"' + ariaLabel + '\">' + iconContent + textContent + '</div>';\n        });\n        var chunks = spec.columns !== 'auto' && spec.columns > 1 ? chunk$1(htmlLines, spec.columns) : [htmlLines];\n        var html = map$2(chunks, function (ch) {\n          return '<div class=\"tox-collection__group\">' + ch.join('') + '</div>';\n        });\n        set$5(comp.element, html.join(''));\n      };\n      var onClick = runOnItem(function (comp, se, tgt, itemValue) {\n        se.stop();\n        if (!providersBackstage.isDisabled()) {\n          emitWith(comp, formActionEvent, {\n            name: spec.name,\n            value: itemValue\n          });\n        }\n      });\n      var collectionEvents = [\n        run$1(mouseover(), runOnItem(function (comp, se, tgt) {\n          focus$3(tgt);\n        })),\n        run$1(click(), onClick),\n        run$1(tap(), onClick),\n        run$1(focusin(), runOnItem(function (comp, se, tgt) {\n          descendant(comp.element, '.' + activeClass).each(function (currentActive) {\n            remove$2(currentActive, activeClass);\n          });\n          add$2(tgt, activeClass);\n        })),\n        run$1(focusout(), runOnItem(function (comp) {\n          descendant(comp.element, '.' + activeClass).each(function (currentActive) {\n            remove$2(currentActive, activeClass);\n          });\n        })),\n        runOnExecute$1(runOnItem(function (comp, se, tgt, itemValue) {\n          emitWith(comp, formActionEvent, {\n            name: spec.name,\n            value: itemValue\n          });\n        }))\n      ];\n      var iterCollectionItems = function (comp, applyAttributes) {\n        return map$2(descendants(comp.element, '.tox-collection__item'), applyAttributes);\n      };\n      var pField = FormField.parts.field({\n        dom: {\n          tag: 'div',\n          classes: ['tox-collection'].concat(spec.columns !== 1 ? ['tox-collection--grid'] : ['tox-collection--list'])\n        },\n        components: [],\n        factory: { sketch: identity$1 },\n        behaviours: derive$1([\n          Disabling.config({\n            disabled: providersBackstage.isDisabled,\n            onDisabled: function (comp) {\n              iterCollectionItems(comp, function (childElm) {\n                add$2(childElm, 'tox-collection__item--state-disabled');\n                set$8(childElm, 'aria-disabled', true);\n              });\n            },\n            onEnabled: function (comp) {\n              iterCollectionItems(comp, function (childElm) {\n                remove$2(childElm, 'tox-collection__item--state-disabled');\n                remove$7(childElm, 'aria-disabled');\n              });\n            }\n          }),\n          receivingConfig(),\n          Replacing.config({}),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: []\n            },\n            onSetValue: function (comp, items) {\n              setContents(comp, items);\n              if (spec.columns === 'auto') {\n                detectSize(comp, 5, 'tox-collection__item').each(function (_a) {\n                  var numRows = _a.numRows, numColumns = _a.numColumns;\n                  Keying.setGridSize(comp, numRows, numColumns);\n                });\n              }\n              emit(comp, formResizeEvent);\n            }\n          }),\n          Tabstopping.config({}),\n          Keying.config(deriveCollectionMovement(spec.columns, 'normal')),\n          config('collection-events', collectionEvents)\n        ]),\n        eventOrder: (_a = {}, _a[execute$5()] = [\n          'disabling',\n          'alloy.base.behaviour',\n          'collection-events'\n        ], _a)\n      });\n      var extraClasses = ['tox-form__group--collection'];\n      return renderFormFieldWith(pLabel, pField, extraClasses, []);\n    };\n\n    var schema$k = constant$1([\n      option('data'),\n      defaulted('inputAttributes', {}),\n      defaulted('inputStyles', {}),\n      defaulted('tag', 'input'),\n      defaulted('inputClasses', []),\n      onHandler('onSetValue'),\n      defaulted('styles', {}),\n      defaulted('eventOrder', {}),\n      field('inputBehaviours', [\n        Representing,\n        Focusing\n      ]),\n      defaulted('selectOnFocus', true)\n    ]);\n    var focusBehaviours = function (detail) {\n      return derive$1([Focusing.config({\n          onFocus: !detail.selectOnFocus ? noop : function (component) {\n            var input = component.element;\n            var value = get$5(input);\n            input.dom.setSelectionRange(0, value.length);\n          }\n        })]);\n    };\n    var behaviours = function (detail) {\n      return __assign(__assign({}, focusBehaviours(detail)), augment(detail.inputBehaviours, [Representing.config({\n          store: __assign(__assign({ mode: 'manual' }, detail.data.map(function (data) {\n            return { initialValue: data };\n          }).getOr({})), {\n            getValue: function (input) {\n              return get$5(input.element);\n            },\n            setValue: function (input, data) {\n              var current = get$5(input.element);\n              if (current !== data) {\n                set$4(input.element, data);\n              }\n            }\n          }),\n          onSetValue: detail.onSetValue\n        })]));\n    };\n    var dom = function (detail) {\n      return {\n        tag: detail.tag,\n        attributes: __assign({ type: 'text' }, detail.inputAttributes),\n        styles: detail.inputStyles,\n        classes: detail.inputClasses\n      };\n    };\n\n    var factory$h = function (detail, _spec) {\n      return {\n        uid: detail.uid,\n        dom: dom(detail),\n        components: [],\n        behaviours: behaviours(detail),\n        eventOrder: detail.eventOrder\n      };\n    };\n    var Input = single({\n      name: 'Input',\n      configFields: schema$k(),\n      factory: factory$h\n    });\n\n    var exports$1 = {}, module = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (global, factory) {\n        typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.EphoxContactWrapper = factory());\n      }(this, function () {\n        var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n        var promise = { exports: {} };\n        (function (module) {\n          (function (root) {\n            var setTimeoutFunc = setTimeout;\n            function noop() {\n            }\n            function bind(fn, thisArg) {\n              return function () {\n                fn.apply(thisArg, arguments);\n              };\n            }\n            function Promise(fn) {\n              if (typeof this !== 'object')\n                throw new TypeError('Promises must be constructed via new');\n              if (typeof fn !== 'function')\n                throw new TypeError('not a function');\n              this._state = 0;\n              this._handled = false;\n              this._value = undefined;\n              this._deferreds = [];\n              doResolve(fn, this);\n            }\n            function handle(self, deferred) {\n              while (self._state === 3) {\n                self = self._value;\n              }\n              if (self._state === 0) {\n                self._deferreds.push(deferred);\n                return;\n              }\n              self._handled = true;\n              Promise._immediateFn(function () {\n                var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                if (cb === null) {\n                  (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                  return;\n                }\n                var ret;\n                try {\n                  ret = cb(self._value);\n                } catch (e) {\n                  reject(deferred.promise, e);\n                  return;\n                }\n                resolve(deferred.promise, ret);\n              });\n            }\n            function resolve(self, newValue) {\n              try {\n                if (newValue === self)\n                  throw new TypeError('A promise cannot be resolved with itself.');\n                if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                  var then = newValue.then;\n                  if (newValue instanceof Promise) {\n                    self._state = 3;\n                    self._value = newValue;\n                    finale(self);\n                    return;\n                  } else if (typeof then === 'function') {\n                    doResolve(bind(then, newValue), self);\n                    return;\n                  }\n                }\n                self._state = 1;\n                self._value = newValue;\n                finale(self);\n              } catch (e) {\n                reject(self, e);\n              }\n            }\n            function reject(self, newValue) {\n              self._state = 2;\n              self._value = newValue;\n              finale(self);\n            }\n            function finale(self) {\n              if (self._state === 2 && self._deferreds.length === 0) {\n                Promise._immediateFn(function () {\n                  if (!self._handled) {\n                    Promise._unhandledRejectionFn(self._value);\n                  }\n                });\n              }\n              for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                handle(self, self._deferreds[i]);\n              }\n              self._deferreds = null;\n            }\n            function Handler(onFulfilled, onRejected, promise) {\n              this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n              this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n              this.promise = promise;\n            }\n            function doResolve(fn, self) {\n              var done = false;\n              try {\n                fn(function (value) {\n                  if (done)\n                    return;\n                  done = true;\n                  resolve(self, value);\n                }, function (reason) {\n                  if (done)\n                    return;\n                  done = true;\n                  reject(self, reason);\n                });\n              } catch (ex) {\n                if (done)\n                  return;\n                done = true;\n                reject(self, ex);\n              }\n            }\n            Promise.prototype['catch'] = function (onRejected) {\n              return this.then(null, onRejected);\n            };\n            Promise.prototype.then = function (onFulfilled, onRejected) {\n              var prom = new this.constructor(noop);\n              handle(this, new Handler(onFulfilled, onRejected, prom));\n              return prom;\n            };\n            Promise.all = function (arr) {\n              var args = Array.prototype.slice.call(arr);\n              return new Promise(function (resolve, reject) {\n                if (args.length === 0)\n                  return resolve([]);\n                var remaining = args.length;\n                function res(i, val) {\n                  try {\n                    if (val && (typeof val === 'object' || typeof val === 'function')) {\n                      var then = val.then;\n                      if (typeof then === 'function') {\n                        then.call(val, function (val) {\n                          res(i, val);\n                        }, reject);\n                        return;\n                      }\n                    }\n                    args[i] = val;\n                    if (--remaining === 0) {\n                      resolve(args);\n                    }\n                  } catch (ex) {\n                    reject(ex);\n                  }\n                }\n                for (var i = 0; i < args.length; i++) {\n                  res(i, args[i]);\n                }\n              });\n            };\n            Promise.resolve = function (value) {\n              if (value && typeof value === 'object' && value.constructor === Promise) {\n                return value;\n              }\n              return new Promise(function (resolve) {\n                resolve(value);\n              });\n            };\n            Promise.reject = function (value) {\n              return new Promise(function (resolve, reject) {\n                reject(value);\n              });\n            };\n            Promise.race = function (values) {\n              return new Promise(function (resolve, reject) {\n                for (var i = 0, len = values.length; i < len; i++) {\n                  values[i].then(resolve, reject);\n                }\n              });\n            };\n            Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n              setImmediate(fn);\n            } : function (fn) {\n              setTimeoutFunc(fn, 0);\n            };\n            Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n              if (typeof console !== 'undefined' && console) {\n                console.warn('Possible Unhandled Promise Rejection:', err);\n              }\n            };\n            Promise._setImmediateFn = function _setImmediateFn(fn) {\n              Promise._immediateFn = fn;\n            };\n            Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n              Promise._unhandledRejectionFn = fn;\n            };\n            if (module.exports) {\n              module.exports = Promise;\n            } else if (!root.Promise) {\n              root.Promise = Promise;\n            }\n          }(commonjsGlobal));\n        }(promise));\n        var promisePolyfill = promise.exports;\n        var Global = function () {\n          if (typeof window !== 'undefined') {\n            return window;\n          } else {\n            return Function('return this;')();\n          }\n        }();\n        var promisePolyfill_1 = { boltExport: Global.Promise || promisePolyfill };\n        return promisePolyfill_1;\n      }));\n    }(undefined, exports$1, module));\n    var Promise$1 = module.exports.boltExport;\n\n    var nu$3 = function (baseFn) {\n      var data = Optional.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu$3(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady()) {\n          call(nCallback);\n        } else {\n          callbacks.push(nCallback);\n        }\n      };\n      var set = function (x) {\n        if (!isReady()) {\n          data = Optional.some(x);\n          run(callbacks);\n          callbacks = [];\n        }\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each$1(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure$1 = function (a) {\n      return nu$3(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu$3,\n      pure: pure$1\n    };\n\n    var errorReporter = function (err) {\n      setTimeout(function () {\n        throw err;\n      }, 0);\n    };\n    var make$5 = function (run) {\n      var get = function (callback) {\n        run().then(callback, errorReporter);\n      };\n      var map = function (fab) {\n        return make$5(function () {\n          return run().then(fab);\n        });\n      };\n      var bind = function (aFutureB) {\n        return make$5(function () {\n          return run().then(function (v) {\n            return aFutureB(v).toPromise();\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return make$5(function () {\n          return run().then(function () {\n            return futureB.toPromise();\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return make$5(function () {\n          if (cache === null) {\n            cache = run();\n          }\n          return cache;\n        });\n      };\n      var toPromise = run;\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        toPromise: toPromise,\n        get: get\n      };\n    };\n    var nu$2 = function (baseFn) {\n      return make$5(function () {\n        return new Promise$1(baseFn);\n      });\n    };\n    var pure = function (a) {\n      return make$5(function () {\n        return Promise$1.resolve(a);\n      });\n    };\n    var Future = {\n      nu: nu$2,\n      pure: pure\n    };\n\n    var ariaElements = [\n      'input',\n      'textarea'\n    ];\n    var isAriaElement = function (elem) {\n      var name = name$2(elem);\n      return contains$2(ariaElements, name);\n    };\n    var markValid = function (component, invalidConfig) {\n      var elem = invalidConfig.getRoot(component).getOr(component.element);\n      remove$2(elem, invalidConfig.invalidClass);\n      invalidConfig.notify.each(function (notifyInfo) {\n        if (isAriaElement(component.element)) {\n          set$8(component.element, 'aria-invalid', false);\n        }\n        notifyInfo.getContainer(component).each(function (container) {\n          set$5(container, notifyInfo.validHtml);\n        });\n        notifyInfo.onValid(component);\n      });\n    };\n    var markInvalid = function (component, invalidConfig, invalidState, text) {\n      var elem = invalidConfig.getRoot(component).getOr(component.element);\n      add$2(elem, invalidConfig.invalidClass);\n      invalidConfig.notify.each(function (notifyInfo) {\n        if (isAriaElement(component.element)) {\n          set$8(component.element, 'aria-invalid', true);\n        }\n        notifyInfo.getContainer(component).each(function (container) {\n          set$5(container, text);\n        });\n        notifyInfo.onInvalid(component, text);\n      });\n    };\n    var query = function (component, invalidConfig, _invalidState) {\n      return invalidConfig.validator.fold(function () {\n        return Future.pure(Result.value(true));\n      }, function (validatorInfo) {\n        return validatorInfo.validate(component);\n      });\n    };\n    var run = function (component, invalidConfig, invalidState) {\n      invalidConfig.notify.each(function (notifyInfo) {\n        notifyInfo.onValidate(component);\n      });\n      return query(component, invalidConfig).map(function (valid) {\n        if (component.getSystem().isConnected()) {\n          return valid.fold(function (err) {\n            markInvalid(component, invalidConfig, invalidState, err);\n            return Result.error(err);\n          }, function (v) {\n            markValid(component, invalidConfig);\n            return Result.value(v);\n          });\n        } else {\n          return Result.error('No longer in system');\n        }\n      });\n    };\n    var isInvalid = function (component, invalidConfig) {\n      var elem = invalidConfig.getRoot(component).getOr(component.element);\n      return has(elem, invalidConfig.invalidClass);\n    };\n\n    var InvalidateApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        markValid: markValid,\n        markInvalid: markInvalid,\n        query: query,\n        run: run,\n        isInvalid: isInvalid\n    });\n\n    var events$8 = function (invalidConfig, invalidState) {\n      return invalidConfig.validator.map(function (validatorInfo) {\n        return derive$2([run$1(validatorInfo.onEvent, function (component) {\n            run(component, invalidConfig, invalidState).get(identity$1);\n          })].concat(validatorInfo.validateOnLoad ? [runOnAttached(function (component) {\n            run(component, invalidConfig, invalidState).get(noop);\n          })] : []));\n      }).getOr({});\n    };\n\n    var ActiveInvalidate = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$8\n    });\n\n    var InvalidateSchema = [\n      required$1('invalidClass'),\n      defaulted('getRoot', Optional.none),\n      optionObjOf('notify', [\n        defaulted('aria', 'alert'),\n        defaulted('getContainer', Optional.none),\n        defaulted('validHtml', ''),\n        onHandler('onValid'),\n        onHandler('onInvalid'),\n        onHandler('onValidate')\n      ]),\n      optionObjOf('validator', [\n        required$1('validate'),\n        defaulted('onEvent', 'input'),\n        defaulted('validateOnLoad', true)\n      ])\n    ];\n\n    var Invalidating = create$7({\n      fields: InvalidateSchema,\n      name: 'invalidating',\n      active: ActiveInvalidate,\n      apis: InvalidateApis,\n      extra: {\n        validation: function (validator) {\n          return function (component) {\n            var v = Representing.getValue(component);\n            return Future.pure(validator(v));\n          };\n        }\n      }\n    });\n\n    var getCoupled = function (component, coupleConfig, coupleState, name) {\n      return coupleState.getOrCreate(component, coupleConfig, name);\n    };\n\n    var CouplingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getCoupled: getCoupled\n    });\n\n    var CouplingSchema = [requiredOf('others', setOf(Result.value, anyValue()))];\n\n    var init$a = function () {\n      var coupled = {};\n      var getOrCreate = function (component, coupleConfig, name) {\n        var available = keys(coupleConfig.others);\n        if (!available) {\n          throw new Error('Cannot find coupled component: ' + name + '. Known coupled components: ' + JSON.stringify(available, null, 2));\n        } else {\n          return get$e(coupled, name).getOrThunk(function () {\n            var builder = get$e(coupleConfig.others, name).getOrDie('No information found for coupled component: ' + name);\n            var spec = builder(component);\n            var built = component.getSystem().build(spec);\n            coupled[name] = built;\n            return built;\n          });\n        }\n      };\n      var readState = constant$1({});\n      return nu$8({\n        readState: readState,\n        getOrCreate: getOrCreate\n      });\n    };\n\n    var CouplingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$a\n    });\n\n    var Coupling = create$7({\n      fields: CouplingSchema,\n      name: 'coupling',\n      apis: CouplingApis,\n      state: CouplingState\n    });\n\n    var suffix = constant$1('sink');\n    var partType$1 = constant$1(optional({\n      name: suffix(),\n      overrides: constant$1({\n        dom: { tag: 'div' },\n        behaviours: derive$1([Positioning.config({ useFixed: always })]),\n        events: derive$2([\n          cutter(keydown()),\n          cutter(mousedown()),\n          cutter(click())\n        ])\n      })\n    }));\n\n    var HighlightOnOpen;\n    (function (HighlightOnOpen) {\n      HighlightOnOpen[HighlightOnOpen['HighlightFirst'] = 0] = 'HighlightFirst';\n      HighlightOnOpen[HighlightOnOpen['HighlightNone'] = 1] = 'HighlightNone';\n    }(HighlightOnOpen || (HighlightOnOpen = {})));\n    var getAnchor = function (detail, component) {\n      var hotspot = detail.getHotspot(component).getOr(component);\n      var type = 'hotspot';\n      var overrides = detail.getAnchorOverrides();\n      return detail.layouts.fold(function () {\n        return {\n          type: type,\n          hotspot: hotspot,\n          overrides: overrides\n        };\n      }, function (layouts) {\n        return {\n          type: type,\n          hotspot: hotspot,\n          overrides: overrides,\n          layouts: layouts\n        };\n      });\n    };\n    var fetch = function (detail, mapFetch, component) {\n      var fetcher = detail.fetch;\n      return fetcher(component).map(mapFetch);\n    };\n    var openF = function (detail, mapFetch, anchor, component, sandbox, externals, highlightOnOpen) {\n      var futureData = fetch(detail, mapFetch, component);\n      var getLazySink = getSink(component, detail);\n      return futureData.map(function (tdata) {\n        return tdata.bind(function (data) {\n          return Optional.from(tieredMenu.sketch(__assign(__assign({}, externals.menu()), {\n            uid: generate$5(''),\n            data: data,\n            highlightImmediately: highlightOnOpen === HighlightOnOpen.HighlightFirst,\n            onOpenMenu: function (tmenu, menu) {\n              var sink = getLazySink().getOrDie();\n              Positioning.position(sink, menu, { anchor: anchor });\n              Sandboxing.decloak(sandbox);\n            },\n            onOpenSubmenu: function (tmenu, item, submenu) {\n              var sink = getLazySink().getOrDie();\n              Positioning.position(sink, submenu, {\n                anchor: {\n                  type: 'submenu',\n                  item: item\n                }\n              });\n              Sandboxing.decloak(sandbox);\n            },\n            onRepositionMenu: function (tmenu, primaryMenu, submenuTriggers) {\n              var sink = getLazySink().getOrDie();\n              Positioning.position(sink, primaryMenu, { anchor: anchor });\n              each$1(submenuTriggers, function (st) {\n                Positioning.position(sink, st.triggeredMenu, {\n                  anchor: {\n                    type: 'submenu',\n                    item: st.triggeringItem\n                  }\n                });\n              });\n            },\n            onEscape: function () {\n              Focusing.focus(component);\n              Sandboxing.close(sandbox);\n              return Optional.some(true);\n            }\n          })));\n        });\n      });\n    };\n    var open = function (detail, mapFetch, hotspot, sandbox, externals, onOpenSync, highlightOnOpen) {\n      var anchor = getAnchor(detail, hotspot);\n      var processed = openF(detail, mapFetch, anchor, hotspot, sandbox, externals, highlightOnOpen);\n      return processed.map(function (tdata) {\n        tdata.fold(function () {\n          if (Sandboxing.isOpen(sandbox)) {\n            Sandboxing.close(sandbox);\n          }\n        }, function (data) {\n          Sandboxing.cloak(sandbox);\n          Sandboxing.open(sandbox, data);\n          onOpenSync(sandbox);\n        });\n        return sandbox;\n      });\n    };\n    var close = function (detail, mapFetch, component, sandbox, _externals, _onOpenSync, _highlightOnOpen) {\n      Sandboxing.close(sandbox);\n      return Future.pure(sandbox);\n    };\n    var togglePopup = function (detail, mapFetch, hotspot, externals, onOpenSync, highlightOnOpen) {\n      var sandbox = Coupling.getCoupled(hotspot, 'sandbox');\n      var showing = Sandboxing.isOpen(sandbox);\n      var action = showing ? close : open;\n      return action(detail, mapFetch, hotspot, sandbox, externals, onOpenSync, highlightOnOpen);\n    };\n    var matchWidth = function (hotspot, container, useMinWidth) {\n      var menu = Composing.getCurrent(container).getOr(container);\n      var buttonWidth = get$a(hotspot.element);\n      if (useMinWidth) {\n        set$7(menu.element, 'min-width', buttonWidth + 'px');\n      } else {\n        set$6(menu.element, buttonWidth);\n      }\n    };\n    var getSink = function (anyInSystem, sinkDetail) {\n      return anyInSystem.getSystem().getByUid(sinkDetail.uid + '-' + suffix()).map(function (internalSink) {\n        return function () {\n          return Result.value(internalSink);\n        };\n      }).getOrThunk(function () {\n        return sinkDetail.lazySink.fold(function () {\n          return function () {\n            return Result.error(new Error('No internal sink is specified, nor could an external sink be found'));\n          };\n        }, function (lazySinkFn) {\n          return function () {\n            return lazySinkFn(anyInSystem);\n          };\n        });\n      });\n    };\n    var doRepositionMenus = function (sandbox) {\n      Sandboxing.getState(sandbox).each(function (tmenu) {\n        tieredMenu.repositionMenus(tmenu);\n      });\n    };\n    var makeSandbox$1 = function (detail, hotspot, extras) {\n      var ariaOwner = manager();\n      var onOpen = function (component, menu) {\n        var anchor = getAnchor(detail, hotspot);\n        ariaOwner.link(hotspot.element);\n        if (detail.matchWidth) {\n          matchWidth(anchor.hotspot, menu, detail.useMinWidth);\n        }\n        detail.onOpen(anchor, component, menu);\n        if (extras !== undefined && extras.onOpen !== undefined) {\n          extras.onOpen(component, menu);\n        }\n      };\n      var onClose = function (component, menu) {\n        ariaOwner.unlink(hotspot.element);\n        if (extras !== undefined && extras.onClose !== undefined) {\n          extras.onClose(component, menu);\n        }\n      };\n      var lazySink = getSink(hotspot, detail);\n      return {\n        dom: {\n          tag: 'div',\n          classes: detail.sandboxClasses,\n          attributes: {\n            id: ariaOwner.id,\n            role: 'listbox'\n          }\n        },\n        behaviours: SketchBehaviours.augment(detail.sandboxBehaviours, [\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: hotspot\n            }\n          }),\n          Sandboxing.config({\n            onOpen: onOpen,\n            onClose: onClose,\n            isPartOf: function (container, data, queryElem) {\n              return isPartOf$1(data, queryElem) || isPartOf$1(hotspot, queryElem);\n            },\n            getAttachPoint: function () {\n              return lazySink().getOrDie();\n            }\n          }),\n          Composing.config({\n            find: function (sandbox) {\n              return Sandboxing.getState(sandbox).bind(function (menu) {\n                return Composing.getCurrent(menu);\n              });\n            }\n          }),\n          Receiving.config({ channels: __assign(__assign({}, receivingChannel$1({ isExtraPart: never })), receivingChannel({ doReposition: doRepositionMenus })) })\n        ])\n      };\n    };\n    var repositionMenus = function (comp) {\n      var sandbox = Coupling.getCoupled(comp, 'sandbox');\n      doRepositionMenus(sandbox);\n    };\n\n    var sandboxFields = function () {\n      return [\n        defaulted('sandboxClasses', []),\n        SketchBehaviours.field('sandboxBehaviours', [\n          Composing,\n          Receiving,\n          Sandboxing,\n          Representing\n        ])\n      ];\n    };\n\n    var schema$j = constant$1([\n      required$1('dom'),\n      required$1('fetch'),\n      onHandler('onOpen'),\n      onKeyboardHandler('onExecute'),\n      defaulted('getHotspot', Optional.some),\n      defaulted('getAnchorOverrides', constant$1({})),\n      schema$y(),\n      field('dropdownBehaviours', [\n        Toggling,\n        Coupling,\n        Keying,\n        Focusing\n      ]),\n      required$1('toggleClass'),\n      defaulted('eventOrder', {}),\n      option('lazySink'),\n      defaulted('matchWidth', false),\n      defaulted('useMinWidth', false),\n      option('role')\n    ].concat(sandboxFields()));\n    var parts$d = constant$1([\n      external$1({\n        schema: [tieredMenuMarkers()],\n        name: 'menu',\n        defaults: function (detail) {\n          return { onExecute: detail.onExecute };\n        }\n      }),\n      partType$1()\n    ]);\n\n    var factory$g = function (detail, components, _spec, externals) {\n      var _a;\n      var lookupAttr = function (attr) {\n        return get$e(detail.dom, 'attributes').bind(function (attrs) {\n          return get$e(attrs, attr);\n        });\n      };\n      var switchToMenu = function (sandbox) {\n        Sandboxing.getState(sandbox).each(function (tmenu) {\n          tieredMenu.highlightPrimary(tmenu);\n        });\n      };\n      var action = function (component) {\n        var onOpenSync = switchToMenu;\n        togglePopup(detail, identity$1, component, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n      };\n      var apis = {\n        expand: function (comp) {\n          if (!Toggling.isOn(comp)) {\n            togglePopup(detail, identity$1, comp, externals, noop, HighlightOnOpen.HighlightNone).get(noop);\n          }\n        },\n        open: function (comp) {\n          if (!Toggling.isOn(comp)) {\n            togglePopup(detail, identity$1, comp, externals, noop, HighlightOnOpen.HighlightFirst).get(noop);\n          }\n        },\n        isOpen: Toggling.isOn,\n        close: function (comp) {\n          if (Toggling.isOn(comp)) {\n            togglePopup(detail, identity$1, comp, externals, noop, HighlightOnOpen.HighlightFirst).get(noop);\n          }\n        },\n        repositionMenus: function (comp) {\n          if (Toggling.isOn(comp)) {\n            repositionMenus(comp);\n          }\n        }\n      };\n      var triggerExecute = function (comp, _se) {\n        emitExecute(comp);\n        return Optional.some(true);\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.dropdownBehaviours, [\n          Toggling.config({\n            toggleClass: detail.toggleClass,\n            aria: { mode: 'expanded' }\n          }),\n          Coupling.config({\n            others: {\n              sandbox: function (hotspot) {\n                return makeSandbox$1(detail, hotspot, {\n                  onOpen: function () {\n                    return Toggling.on(hotspot);\n                  },\n                  onClose: function () {\n                    return Toggling.off(hotspot);\n                  }\n                });\n              }\n            }\n          }),\n          Keying.config({\n            mode: 'special',\n            onSpace: triggerExecute,\n            onEnter: triggerExecute,\n            onDown: function (comp, _se) {\n              if (Dropdown.isOpen(comp)) {\n                var sandbox = Coupling.getCoupled(comp, 'sandbox');\n                switchToMenu(sandbox);\n              } else {\n                Dropdown.open(comp);\n              }\n              return Optional.some(true);\n            },\n            onEscape: function (comp, _se) {\n              if (Dropdown.isOpen(comp)) {\n                Dropdown.close(comp);\n                return Optional.some(true);\n              } else {\n                return Optional.none();\n              }\n            }\n          }),\n          Focusing.config({})\n        ]),\n        events: events$a(Optional.some(action)),\n        eventOrder: __assign(__assign({}, detail.eventOrder), (_a = {}, _a[execute$5()] = [\n          'disabling',\n          'toggling',\n          'alloy.base.behaviour'\n        ], _a)),\n        apis: apis,\n        domModification: {\n          attributes: __assign(__assign({ 'aria-haspopup': 'true' }, detail.role.fold(function () {\n            return {};\n          }, function (role) {\n            return { role: role };\n          })), detail.dom.tag === 'button' ? { type: lookupAttr('type').getOr('button') } : {})\n        }\n      };\n    };\n    var Dropdown = composite({\n      name: 'Dropdown',\n      configFields: schema$j(),\n      partFields: parts$d(),\n      factory: factory$g,\n      apis: {\n        open: function (apis, comp) {\n          return apis.open(comp);\n        },\n        expand: function (apis, comp) {\n          return apis.expand(comp);\n        },\n        close: function (apis, comp) {\n          return apis.close(comp);\n        },\n        isOpen: function (apis, comp) {\n          return apis.isOpen(comp);\n        },\n        repositionMenus: function (apis, comp) {\n          return apis.repositionMenus(comp);\n        }\n      }\n    });\n\n    var exhibit$1 = function () {\n      return nu$7({\n        styles: {\n          '-webkit-user-select': 'none',\n          'user-select': 'none',\n          '-ms-user-select': 'none',\n          '-moz-user-select': '-moz-none'\n        },\n        attributes: { unselectable: 'on' }\n      });\n    };\n    var events$7 = function () {\n      return derive$2([abort(selectstart(), always)]);\n    };\n\n    var ActiveUnselecting = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$7,\n        exhibit: exhibit$1\n    });\n\n    var Unselecting = create$7({\n      fields: [],\n      name: 'unselecting',\n      active: ActiveUnselecting\n    });\n\n    var renderPanelButton = function (spec, sharedBackstage) {\n      return Dropdown.sketch({\n        dom: spec.dom,\n        components: spec.components,\n        toggleClass: 'mce-active',\n        dropdownBehaviours: derive$1([\n          DisablingConfigs.button(sharedBackstage.providers.isDisabled),\n          receivingConfig(),\n          Unselecting.config({}),\n          Tabstopping.config({})\n        ]),\n        layouts: spec.layouts,\n        sandboxClasses: ['tox-dialog__popups'],\n        lazySink: sharedBackstage.getSink,\n        fetch: function (comp) {\n          return Future.nu(function (callback) {\n            return spec.fetch(callback);\n          }).map(function (items) {\n            return Optional.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$6('menu-value'), items, function (value) {\n              spec.onItemAction(comp, value);\n            }, spec.columns, spec.presets, ItemResponse$1.CLOSE_ON_EXECUTE, never, sharedBackstage.providers), { movement: deriveMenuMovement(spec.columns, spec.presets) })));\n          });\n        },\n        parts: { menu: part(false, 1, spec.presets) }\n      });\n    };\n\n    var colorInputChangeEvent = generate$6('color-input-change');\n    var colorSwatchChangeEvent = generate$6('color-swatch-change');\n    var colorPickerCancelEvent = generate$6('color-picker-cancel');\n    var renderColorInput = function (spec, sharedBackstage, colorInputBackstage) {\n      var pField = FormField.parts.field({\n        factory: Input,\n        inputClasses: ['tox-textfield'],\n        onSetValue: function (c) {\n          return Invalidating.run(c).get(noop);\n        },\n        inputBehaviours: derive$1([\n          Disabling.config({ disabled: sharedBackstage.providers.isDisabled }),\n          receivingConfig(),\n          Tabstopping.config({}),\n          Invalidating.config({\n            invalidClass: 'tox-textbox-field-invalid',\n            getRoot: function (comp) {\n              return parent(comp.element);\n            },\n            notify: {\n              onValid: function (comp) {\n                var val = Representing.getValue(comp);\n                emitWith(comp, colorInputChangeEvent, { color: val });\n              }\n            },\n            validator: {\n              validateOnLoad: false,\n              validate: function (input) {\n                var inputValue = Representing.getValue(input);\n                if (inputValue.length === 0) {\n                  return Future.pure(Result.value(true));\n                } else {\n                  var span = SugarElement.fromTag('span');\n                  set$7(span, 'background-color', inputValue);\n                  var res = getRaw(span, 'background-color').fold(function () {\n                    return Result.error('blah');\n                  }, function (_) {\n                    return Result.value(inputValue);\n                  });\n                  return Future.pure(res);\n                }\n              }\n            }\n          })\n        ]),\n        selectOnFocus: false\n      });\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel$2(label, sharedBackstage.providers);\n      });\n      var emitSwatchChange = function (colorBit, value) {\n        emitWith(colorBit, colorSwatchChangeEvent, { value: value });\n      };\n      var onItemAction = function (comp, value) {\n        memColorButton.getOpt(comp).each(function (colorBit) {\n          if (value === 'custom') {\n            colorInputBackstage.colorPicker(function (valueOpt) {\n              valueOpt.fold(function () {\n                return emit(colorBit, colorPickerCancelEvent);\n              }, function (value) {\n                emitSwatchChange(colorBit, value);\n                addColor(value);\n              });\n            }, '#ffffff');\n          } else if (value === 'remove') {\n            emitSwatchChange(colorBit, '');\n          } else {\n            emitSwatchChange(colorBit, value);\n          }\n        });\n      };\n      var memColorButton = record(renderPanelButton({\n        dom: {\n          tag: 'span',\n          attributes: { 'aria-label': sharedBackstage.providers.translate('Color swatch') }\n        },\n        layouts: {\n          onRtl: function () {\n            return [\n              southwest$2,\n              southeast$2,\n              south$2\n            ];\n          },\n          onLtr: function () {\n            return [\n              southeast$2,\n              southwest$2,\n              south$2\n            ];\n          }\n        },\n        components: [],\n        fetch: getFetch$1(colorInputBackstage.getColors(), colorInputBackstage.hasCustomColors()),\n        columns: colorInputBackstage.getColorCols(),\n        presets: 'color',\n        onItemAction: onItemAction\n      }, sharedBackstage));\n      return FormField.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: pLabel.toArray().concat([{\n            dom: {\n              tag: 'div',\n              classes: ['tox-color-input']\n            },\n            components: [\n              pField,\n              memColorButton.asSpec()\n            ]\n          }]),\n        fieldBehaviours: derive$1([config('form-field-events', [\n            run$1(colorInputChangeEvent, function (comp, se) {\n              memColorButton.getOpt(comp).each(function (colorButton) {\n                set$7(colorButton.element, 'background-color', se.event.color);\n              });\n              emitWith(comp, formChangeEvent, { name: spec.name });\n            }),\n            run$1(colorSwatchChangeEvent, function (comp, se) {\n              FormField.getField(comp).each(function (field) {\n                Representing.setValue(field, se.event.value);\n                Composing.getCurrent(comp).each(Focusing.focus);\n              });\n            }),\n            run$1(colorPickerCancelEvent, function (comp, _se) {\n              FormField.getField(comp).each(function (_field) {\n                Composing.getCurrent(comp).each(Focusing.focus);\n              });\n            })\n          ])])\n      });\n    };\n\n    var labelPart = optional({\n      schema: [required$1('dom')],\n      name: 'label'\n    });\n    var edgePart = function (name) {\n      return optional({\n        name: '' + name + '-edge',\n        overrides: function (detail) {\n          var action = detail.model.manager.edgeActions[name];\n          return action.fold(function () {\n            return {};\n          }, function (a) {\n            return {\n              events: derive$2([\n                runActionExtra(touchstart(), function (comp, se, d) {\n                  return a(comp, d);\n                }, [detail]),\n                runActionExtra(mousedown(), function (comp, se, d) {\n                  return a(comp, d);\n                }, [detail]),\n                runActionExtra(mousemove(), function (comp, se, det) {\n                  if (det.mouseIsDown.get()) {\n                    a(comp, det);\n                  }\n                }, [detail])\n              ])\n            };\n          });\n        }\n      });\n    };\n    var tlEdgePart = edgePart('top-left');\n    var tedgePart = edgePart('top');\n    var trEdgePart = edgePart('top-right');\n    var redgePart = edgePart('right');\n    var brEdgePart = edgePart('bottom-right');\n    var bedgePart = edgePart('bottom');\n    var blEdgePart = edgePart('bottom-left');\n    var ledgePart = edgePart('left');\n    var thumbPart = required({\n      name: 'thumb',\n      defaults: constant$1({ dom: { styles: { position: 'absolute' } } }),\n      overrides: function (detail) {\n        return {\n          events: derive$2([\n            redirectToPart(touchstart(), detail, 'spectrum'),\n            redirectToPart(touchmove(), detail, 'spectrum'),\n            redirectToPart(touchend(), detail, 'spectrum'),\n            redirectToPart(mousedown(), detail, 'spectrum'),\n            redirectToPart(mousemove(), detail, 'spectrum'),\n            redirectToPart(mouseup(), detail, 'spectrum')\n          ])\n        };\n      }\n    });\n    var spectrumPart = required({\n      schema: [customField('mouseIsDown', function () {\n          return Cell(false);\n        })],\n      name: 'spectrum',\n      overrides: function (detail) {\n        var modelDetail = detail.model;\n        var model = modelDetail.manager;\n        var setValueFrom = function (component, simulatedEvent) {\n          return model.getValueFromEvent(simulatedEvent).map(function (value) {\n            return model.setValueFrom(component, detail, value);\n          });\n        };\n        return {\n          behaviours: derive$1([\n            Keying.config({\n              mode: 'special',\n              onLeft: function (spectrum) {\n                return model.onLeft(spectrum, detail);\n              },\n              onRight: function (spectrum) {\n                return model.onRight(spectrum, detail);\n              },\n              onUp: function (spectrum) {\n                return model.onUp(spectrum, detail);\n              },\n              onDown: function (spectrum) {\n                return model.onDown(spectrum, detail);\n              }\n            }),\n            Focusing.config({})\n          ]),\n          events: derive$2([\n            run$1(touchstart(), setValueFrom),\n            run$1(touchmove(), setValueFrom),\n            run$1(mousedown(), setValueFrom),\n            run$1(mousemove(), function (spectrum, se) {\n              if (detail.mouseIsDown.get()) {\n                setValueFrom(spectrum, se);\n              }\n            })\n          ])\n        };\n      }\n    });\n    var SliderParts = [\n      labelPart,\n      ledgePart,\n      redgePart,\n      tedgePart,\n      bedgePart,\n      tlEdgePart,\n      trEdgePart,\n      blEdgePart,\n      brEdgePart,\n      thumbPart,\n      spectrumPart\n    ];\n\n    var _sliderChangeEvent = 'slider.change.value';\n    var sliderChangeEvent = constant$1(_sliderChangeEvent);\n    var isTouchEvent$2 = function (evt) {\n      return evt.type.indexOf('touch') !== -1;\n    };\n    var getEventSource = function (simulatedEvent) {\n      var evt = simulatedEvent.event.raw;\n      if (isTouchEvent$2(evt)) {\n        var touchEvent = evt;\n        return touchEvent.touches !== undefined && touchEvent.touches.length === 1 ? Optional.some(touchEvent.touches[0]).map(function (t) {\n          return SugarPosition(t.clientX, t.clientY);\n        }) : Optional.none();\n      } else {\n        var mouseEvent = evt;\n        return mouseEvent.clientX !== undefined ? Optional.some(mouseEvent).map(function (me) {\n          return SugarPosition(me.clientX, me.clientY);\n        }) : Optional.none();\n      }\n    };\n\n    var t = 'top', r = 'right', b = 'bottom', l = 'left';\n    var minX = function (detail) {\n      return detail.model.minX;\n    };\n    var minY = function (detail) {\n      return detail.model.minY;\n    };\n    var min1X = function (detail) {\n      return detail.model.minX - 1;\n    };\n    var min1Y = function (detail) {\n      return detail.model.minY - 1;\n    };\n    var maxX = function (detail) {\n      return detail.model.maxX;\n    };\n    var maxY = function (detail) {\n      return detail.model.maxY;\n    };\n    var max1X = function (detail) {\n      return detail.model.maxX + 1;\n    };\n    var max1Y = function (detail) {\n      return detail.model.maxY + 1;\n    };\n    var range = function (detail, max, min) {\n      return max(detail) - min(detail);\n    };\n    var xRange = function (detail) {\n      return range(detail, maxX, minX);\n    };\n    var yRange = function (detail) {\n      return range(detail, maxY, minY);\n    };\n    var halfX = function (detail) {\n      return xRange(detail) / 2;\n    };\n    var halfY = function (detail) {\n      return yRange(detail) / 2;\n    };\n    var step = function (detail) {\n      return detail.stepSize;\n    };\n    var snap = function (detail) {\n      return detail.snapToGrid;\n    };\n    var snapStart = function (detail) {\n      return detail.snapStart;\n    };\n    var rounded = function (detail) {\n      return detail.rounded;\n    };\n    var hasEdge = function (detail, edgeName) {\n      return detail[edgeName + '-edge'] !== undefined;\n    };\n    var hasLEdge = function (detail) {\n      return hasEdge(detail, l);\n    };\n    var hasREdge = function (detail) {\n      return hasEdge(detail, r);\n    };\n    var hasTEdge = function (detail) {\n      return hasEdge(detail, t);\n    };\n    var hasBEdge = function (detail) {\n      return hasEdge(detail, b);\n    };\n    var currentValue = function (detail) {\n      return detail.model.value.get();\n    };\n\n    var xValue = function (x) {\n      return { x: x };\n    };\n    var yValue = function (y) {\n      return { y: y };\n    };\n    var xyValue = function (x, y) {\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var fireSliderChange$3 = function (component, value) {\n      emitWith(component, sliderChangeEvent(), { value: value });\n    };\n    var setToTLEdgeXY = function (edge, detail) {\n      fireSliderChange$3(edge, xyValue(min1X(detail), min1Y(detail)));\n    };\n    var setToTEdge = function (edge, detail) {\n      fireSliderChange$3(edge, yValue(min1Y(detail)));\n    };\n    var setToTEdgeXY = function (edge, detail) {\n      fireSliderChange$3(edge, xyValue(halfX(detail), min1Y(detail)));\n    };\n    var setToTREdgeXY = function (edge, detail) {\n      fireSliderChange$3(edge, xyValue(max1X(detail), min1Y(detail)));\n    };\n    var setToREdge = function (edge, detail) {\n      fireSliderChange$3(edge, xValue(max1X(detail)));\n    };\n    var setToREdgeXY = function (edge, detail) {\n      fireSliderChange$3(edge, xyValue(max1X(detail), halfY(detail)));\n    };\n    var setToBREdgeXY = function (edge, detail) {\n      fireSliderChange$3(edge, xyValue(max1X(detail), max1Y(detail)));\n    };\n    var setToBEdge = function (edge, detail) {\n      fireSliderChange$3(edge, yValue(max1Y(detail)));\n    };\n    var setToBEdgeXY = function (edge, detail) {\n      fireSliderChange$3(edge, xyValue(halfX(detail), max1Y(detail)));\n    };\n    var setToBLEdgeXY = function (edge, detail) {\n      fireSliderChange$3(edge, xyValue(min1X(detail), max1Y(detail)));\n    };\n    var setToLEdge = function (edge, detail) {\n      fireSliderChange$3(edge, xValue(min1X(detail)));\n    };\n    var setToLEdgeXY = function (edge, detail) {\n      fireSliderChange$3(edge, xyValue(min1X(detail), halfY(detail)));\n    };\n\n    var reduceBy = function (value, min, max, step) {\n      if (value < min) {\n        return value;\n      } else if (value > max) {\n        return max;\n      } else if (value === min) {\n        return min - 1;\n      } else {\n        return Math.max(min, value - step);\n      }\n    };\n    var increaseBy = function (value, min, max, step) {\n      if (value > max) {\n        return value;\n      } else if (value < min) {\n        return min;\n      } else if (value === max) {\n        return max + 1;\n      } else {\n        return Math.min(max, value + step);\n      }\n    };\n    var capValue = function (value, min, max) {\n      return Math.max(min, Math.min(max, value));\n    };\n    var snapValueOf = function (value, min, max, step, snapStart) {\n      return snapStart.fold(function () {\n        var initValue = value - min;\n        var extraValue = Math.round(initValue / step) * step;\n        return capValue(min + extraValue, min - 1, max + 1);\n      }, function (start) {\n        var remainder = (value - start) % step;\n        var adjustment = Math.round(remainder / step);\n        var rawSteps = Math.floor((value - start) / step);\n        var maxSteps = Math.floor((max - start) / step);\n        var numSteps = Math.min(maxSteps, rawSteps + adjustment);\n        var r = start + numSteps * step;\n        return Math.max(start, r);\n      });\n    };\n    var findOffsetOf = function (value, min, max) {\n      return Math.min(max, Math.max(value, min)) - min;\n    };\n    var findValueOf = function (args) {\n      var min = args.min, max = args.max, range = args.range, value = args.value, step = args.step, snap = args.snap, snapStart = args.snapStart, rounded = args.rounded, hasMinEdge = args.hasMinEdge, hasMaxEdge = args.hasMaxEdge, minBound = args.minBound, maxBound = args.maxBound, screenRange = args.screenRange;\n      var capMin = hasMinEdge ? min - 1 : min;\n      var capMax = hasMaxEdge ? max + 1 : max;\n      if (value < minBound) {\n        return capMin;\n      } else if (value > maxBound) {\n        return capMax;\n      } else {\n        var offset = findOffsetOf(value, minBound, maxBound);\n        var newValue = capValue(offset / screenRange * range + min, capMin, capMax);\n        if (snap && newValue >= min && newValue <= max) {\n          return snapValueOf(newValue, min, max, step, snapStart);\n        } else if (rounded) {\n          return Math.round(newValue);\n        } else {\n          return newValue;\n        }\n      }\n    };\n    var findOffsetOfValue$2 = function (args) {\n      var min = args.min, max = args.max, range = args.range, value = args.value, hasMinEdge = args.hasMinEdge, hasMaxEdge = args.hasMaxEdge, maxBound = args.maxBound, maxOffset = args.maxOffset, centerMinEdge = args.centerMinEdge, centerMaxEdge = args.centerMaxEdge;\n      if (value < min) {\n        return hasMinEdge ? 0 : centerMinEdge;\n      } else if (value > max) {\n        return hasMaxEdge ? maxBound : centerMaxEdge;\n      } else {\n        return (value - min) / range * maxOffset;\n      }\n    };\n\n    var top = 'top', right = 'right', bottom = 'bottom', left = 'left', width = 'width', height = 'height';\n    var getBounds = function (component) {\n      return component.element.dom.getBoundingClientRect();\n    };\n    var getBoundsProperty = function (bounds, property) {\n      return bounds[property];\n    };\n    var getMinXBounds = function (component) {\n      var bounds = getBounds(component);\n      return getBoundsProperty(bounds, left);\n    };\n    var getMaxXBounds = function (component) {\n      var bounds = getBounds(component);\n      return getBoundsProperty(bounds, right);\n    };\n    var getMinYBounds = function (component) {\n      var bounds = getBounds(component);\n      return getBoundsProperty(bounds, top);\n    };\n    var getMaxYBounds = function (component) {\n      var bounds = getBounds(component);\n      return getBoundsProperty(bounds, bottom);\n    };\n    var getXScreenRange = function (component) {\n      var bounds = getBounds(component);\n      return getBoundsProperty(bounds, width);\n    };\n    var getYScreenRange = function (component) {\n      var bounds = getBounds(component);\n      return getBoundsProperty(bounds, height);\n    };\n    var getCenterOffsetOf = function (componentMinEdge, componentMaxEdge, spectrumMinEdge) {\n      return (componentMinEdge + componentMaxEdge) / 2 - spectrumMinEdge;\n    };\n    var getXCenterOffSetOf = function (component, spectrum) {\n      var componentBounds = getBounds(component);\n      var spectrumBounds = getBounds(spectrum);\n      var componentMinEdge = getBoundsProperty(componentBounds, left);\n      var componentMaxEdge = getBoundsProperty(componentBounds, right);\n      var spectrumMinEdge = getBoundsProperty(spectrumBounds, left);\n      return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n    };\n    var getYCenterOffSetOf = function (component, spectrum) {\n      var componentBounds = getBounds(component);\n      var spectrumBounds = getBounds(spectrum);\n      var componentMinEdge = getBoundsProperty(componentBounds, top);\n      var componentMaxEdge = getBoundsProperty(componentBounds, bottom);\n      var spectrumMinEdge = getBoundsProperty(spectrumBounds, top);\n      return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n    };\n\n    var fireSliderChange$2 = function (spectrum, value) {\n      emitWith(spectrum, sliderChangeEvent(), { value: value });\n    };\n    var sliderValue$2 = function (x) {\n      return { x: x };\n    };\n    var findValueOfOffset$1 = function (spectrum, detail, left) {\n      var args = {\n        min: minX(detail),\n        max: maxX(detail),\n        range: xRange(detail),\n        value: left,\n        step: step(detail),\n        snap: snap(detail),\n        snapStart: snapStart(detail),\n        rounded: rounded(detail),\n        hasMinEdge: hasLEdge(detail),\n        hasMaxEdge: hasREdge(detail),\n        minBound: getMinXBounds(spectrum),\n        maxBound: getMaxXBounds(spectrum),\n        screenRange: getXScreenRange(spectrum)\n      };\n      return findValueOf(args);\n    };\n    var setValueFrom$2 = function (spectrum, detail, value) {\n      var xValue = findValueOfOffset$1(spectrum, detail, value);\n      var sliderVal = sliderValue$2(xValue);\n      fireSliderChange$2(spectrum, sliderVal);\n      return xValue;\n    };\n    var setToMin$2 = function (spectrum, detail) {\n      var min = minX(detail);\n      fireSliderChange$2(spectrum, sliderValue$2(min));\n    };\n    var setToMax$2 = function (spectrum, detail) {\n      var max = maxX(detail);\n      fireSliderChange$2(spectrum, sliderValue$2(max));\n    };\n    var moveBy$2 = function (direction, spectrum, detail) {\n      var f = direction > 0 ? increaseBy : reduceBy;\n      var xValue = f(currentValue(detail).x, minX(detail), maxX(detail), step(detail));\n      fireSliderChange$2(spectrum, sliderValue$2(xValue));\n      return Optional.some(xValue);\n    };\n    var handleMovement$2 = function (direction) {\n      return function (spectrum, detail) {\n        return moveBy$2(direction, spectrum, detail).map(always);\n      };\n    };\n    var getValueFromEvent$2 = function (simulatedEvent) {\n      var pos = getEventSource(simulatedEvent);\n      return pos.map(function (p) {\n        return p.left;\n      });\n    };\n    var findOffsetOfValue$1 = function (spectrum, detail, value, minEdge, maxEdge) {\n      var minOffset = 0;\n      var maxOffset = getXScreenRange(spectrum);\n      var centerMinEdge = minEdge.bind(function (edge) {\n        return Optional.some(getXCenterOffSetOf(edge, spectrum));\n      }).getOr(minOffset);\n      var centerMaxEdge = maxEdge.bind(function (edge) {\n        return Optional.some(getXCenterOffSetOf(edge, spectrum));\n      }).getOr(maxOffset);\n      var args = {\n        min: minX(detail),\n        max: maxX(detail),\n        range: xRange(detail),\n        value: value,\n        hasMinEdge: hasLEdge(detail),\n        hasMaxEdge: hasREdge(detail),\n        minBound: getMinXBounds(spectrum),\n        minOffset: minOffset,\n        maxBound: getMaxXBounds(spectrum),\n        maxOffset: maxOffset,\n        centerMinEdge: centerMinEdge,\n        centerMaxEdge: centerMaxEdge\n      };\n      return findOffsetOfValue$2(args);\n    };\n    var findPositionOfValue$1 = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n      var offset = findOffsetOfValue$1(spectrum, detail, value, minEdge, maxEdge);\n      return getMinXBounds(spectrum) - getMinXBounds(slider) + offset;\n    };\n    var setPositionFromValue$2 = function (slider, thumb, detail, edges) {\n      var value = currentValue(detail);\n      var pos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.x, edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n      var thumbRadius = get$a(thumb.element) / 2;\n      set$7(thumb.element, 'left', pos - thumbRadius + 'px');\n    };\n    var onLeft$2 = handleMovement$2(-1);\n    var onRight$2 = handleMovement$2(1);\n    var onUp$2 = Optional.none;\n    var onDown$2 = Optional.none;\n    var edgeActions$2 = {\n      'top-left': Optional.none(),\n      'top': Optional.none(),\n      'top-right': Optional.none(),\n      'right': Optional.some(setToREdge),\n      'bottom-right': Optional.none(),\n      'bottom': Optional.none(),\n      'bottom-left': Optional.none(),\n      'left': Optional.some(setToLEdge)\n    };\n\n    var HorizontalModel = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setValueFrom: setValueFrom$2,\n        setToMin: setToMin$2,\n        setToMax: setToMax$2,\n        findValueOfOffset: findValueOfOffset$1,\n        getValueFromEvent: getValueFromEvent$2,\n        findPositionOfValue: findPositionOfValue$1,\n        setPositionFromValue: setPositionFromValue$2,\n        onLeft: onLeft$2,\n        onRight: onRight$2,\n        onUp: onUp$2,\n        onDown: onDown$2,\n        edgeActions: edgeActions$2\n    });\n\n    var fireSliderChange$1 = function (spectrum, value) {\n      emitWith(spectrum, sliderChangeEvent(), { value: value });\n    };\n    var sliderValue$1 = function (y) {\n      return { y: y };\n    };\n    var findValueOfOffset = function (spectrum, detail, top) {\n      var args = {\n        min: minY(detail),\n        max: maxY(detail),\n        range: yRange(detail),\n        value: top,\n        step: step(detail),\n        snap: snap(detail),\n        snapStart: snapStart(detail),\n        rounded: rounded(detail),\n        hasMinEdge: hasTEdge(detail),\n        hasMaxEdge: hasBEdge(detail),\n        minBound: getMinYBounds(spectrum),\n        maxBound: getMaxYBounds(spectrum),\n        screenRange: getYScreenRange(spectrum)\n      };\n      return findValueOf(args);\n    };\n    var setValueFrom$1 = function (spectrum, detail, value) {\n      var yValue = findValueOfOffset(spectrum, detail, value);\n      var sliderVal = sliderValue$1(yValue);\n      fireSliderChange$1(spectrum, sliderVal);\n      return yValue;\n    };\n    var setToMin$1 = function (spectrum, detail) {\n      var min = minY(detail);\n      fireSliderChange$1(spectrum, sliderValue$1(min));\n    };\n    var setToMax$1 = function (spectrum, detail) {\n      var max = maxY(detail);\n      fireSliderChange$1(spectrum, sliderValue$1(max));\n    };\n    var moveBy$1 = function (direction, spectrum, detail) {\n      var f = direction > 0 ? increaseBy : reduceBy;\n      var yValue = f(currentValue(detail).y, minY(detail), maxY(detail), step(detail));\n      fireSliderChange$1(spectrum, sliderValue$1(yValue));\n      return Optional.some(yValue);\n    };\n    var handleMovement$1 = function (direction) {\n      return function (spectrum, detail) {\n        return moveBy$1(direction, spectrum, detail).map(always);\n      };\n    };\n    var getValueFromEvent$1 = function (simulatedEvent) {\n      var pos = getEventSource(simulatedEvent);\n      return pos.map(function (p) {\n        return p.top;\n      });\n    };\n    var findOffsetOfValue = function (spectrum, detail, value, minEdge, maxEdge) {\n      var minOffset = 0;\n      var maxOffset = getYScreenRange(spectrum);\n      var centerMinEdge = minEdge.bind(function (edge) {\n        return Optional.some(getYCenterOffSetOf(edge, spectrum));\n      }).getOr(minOffset);\n      var centerMaxEdge = maxEdge.bind(function (edge) {\n        return Optional.some(getYCenterOffSetOf(edge, spectrum));\n      }).getOr(maxOffset);\n      var args = {\n        min: minY(detail),\n        max: maxY(detail),\n        range: yRange(detail),\n        value: value,\n        hasMinEdge: hasTEdge(detail),\n        hasMaxEdge: hasBEdge(detail),\n        minBound: getMinYBounds(spectrum),\n        minOffset: minOffset,\n        maxBound: getMaxYBounds(spectrum),\n        maxOffset: maxOffset,\n        centerMinEdge: centerMinEdge,\n        centerMaxEdge: centerMaxEdge\n      };\n      return findOffsetOfValue$2(args);\n    };\n    var findPositionOfValue = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n      var offset = findOffsetOfValue(spectrum, detail, value, minEdge, maxEdge);\n      return getMinYBounds(spectrum) - getMinYBounds(slider) + offset;\n    };\n    var setPositionFromValue$1 = function (slider, thumb, detail, edges) {\n      var value = currentValue(detail);\n      var pos = findPositionOfValue(slider, edges.getSpectrum(slider), value.y, edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n      var thumbRadius = get$b(thumb.element) / 2;\n      set$7(thumb.element, 'top', pos - thumbRadius + 'px');\n    };\n    var onLeft$1 = Optional.none;\n    var onRight$1 = Optional.none;\n    var onUp$1 = handleMovement$1(-1);\n    var onDown$1 = handleMovement$1(1);\n    var edgeActions$1 = {\n      'top-left': Optional.none(),\n      'top': Optional.some(setToTEdge),\n      'top-right': Optional.none(),\n      'right': Optional.none(),\n      'bottom-right': Optional.none(),\n      'bottom': Optional.some(setToBEdge),\n      'bottom-left': Optional.none(),\n      'left': Optional.none()\n    };\n\n    var VerticalModel = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setValueFrom: setValueFrom$1,\n        setToMin: setToMin$1,\n        setToMax: setToMax$1,\n        findValueOfOffset: findValueOfOffset,\n        getValueFromEvent: getValueFromEvent$1,\n        findPositionOfValue: findPositionOfValue,\n        setPositionFromValue: setPositionFromValue$1,\n        onLeft: onLeft$1,\n        onRight: onRight$1,\n        onUp: onUp$1,\n        onDown: onDown$1,\n        edgeActions: edgeActions$1\n    });\n\n    var fireSliderChange = function (spectrum, value) {\n      emitWith(spectrum, sliderChangeEvent(), { value: value });\n    };\n    var sliderValue = function (x, y) {\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var setValueFrom = function (spectrum, detail, value) {\n      var xValue = findValueOfOffset$1(spectrum, detail, value.left);\n      var yValue = findValueOfOffset(spectrum, detail, value.top);\n      var val = sliderValue(xValue, yValue);\n      fireSliderChange(spectrum, val);\n      return val;\n    };\n    var moveBy = function (direction, isVerticalMovement, spectrum, detail) {\n      var f = direction > 0 ? increaseBy : reduceBy;\n      var xValue = isVerticalMovement ? currentValue(detail).x : f(currentValue(detail).x, minX(detail), maxX(detail), step(detail));\n      var yValue = !isVerticalMovement ? currentValue(detail).y : f(currentValue(detail).y, minY(detail), maxY(detail), step(detail));\n      fireSliderChange(spectrum, sliderValue(xValue, yValue));\n      return Optional.some(xValue);\n    };\n    var handleMovement = function (direction, isVerticalMovement) {\n      return function (spectrum, detail) {\n        return moveBy(direction, isVerticalMovement, spectrum, detail).map(always);\n      };\n    };\n    var setToMin = function (spectrum, detail) {\n      var mX = minX(detail);\n      var mY = minY(detail);\n      fireSliderChange(spectrum, sliderValue(mX, mY));\n    };\n    var setToMax = function (spectrum, detail) {\n      var mX = maxX(detail);\n      var mY = maxY(detail);\n      fireSliderChange(spectrum, sliderValue(mX, mY));\n    };\n    var getValueFromEvent = function (simulatedEvent) {\n      return getEventSource(simulatedEvent);\n    };\n    var setPositionFromValue = function (slider, thumb, detail, edges) {\n      var value = currentValue(detail);\n      var xPos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.x, edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n      var yPos = findPositionOfValue(slider, edges.getSpectrum(slider), value.y, edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n      var thumbXRadius = get$a(thumb.element) / 2;\n      var thumbYRadius = get$b(thumb.element) / 2;\n      set$7(thumb.element, 'left', xPos - thumbXRadius + 'px');\n      set$7(thumb.element, 'top', yPos - thumbYRadius + 'px');\n    };\n    var onLeft = handleMovement(-1, false);\n    var onRight = handleMovement(1, false);\n    var onUp = handleMovement(-1, true);\n    var onDown = handleMovement(1, true);\n    var edgeActions = {\n      'top-left': Optional.some(setToTLEdgeXY),\n      'top': Optional.some(setToTEdgeXY),\n      'top-right': Optional.some(setToTREdgeXY),\n      'right': Optional.some(setToREdgeXY),\n      'bottom-right': Optional.some(setToBREdgeXY),\n      'bottom': Optional.some(setToBEdgeXY),\n      'bottom-left': Optional.some(setToBLEdgeXY),\n      'left': Optional.some(setToLEdgeXY)\n    };\n\n    var TwoDModel = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setValueFrom: setValueFrom,\n        setToMin: setToMin,\n        setToMax: setToMax,\n        getValueFromEvent: getValueFromEvent,\n        setPositionFromValue: setPositionFromValue,\n        onLeft: onLeft,\n        onRight: onRight,\n        onUp: onUp,\n        onDown: onDown,\n        edgeActions: edgeActions\n    });\n\n    var SliderSchema = [\n      defaulted('stepSize', 1),\n      defaulted('onChange', noop),\n      defaulted('onChoose', noop),\n      defaulted('onInit', noop),\n      defaulted('onDragStart', noop),\n      defaulted('onDragEnd', noop),\n      defaulted('snapToGrid', false),\n      defaulted('rounded', true),\n      option('snapStart'),\n      requiredOf('model', choose$1('mode', {\n        x: [\n          defaulted('minX', 0),\n          defaulted('maxX', 100),\n          customField('value', function (spec) {\n            return Cell(spec.mode.minX);\n          }),\n          required$1('getInitialValue'),\n          output$1('manager', HorizontalModel)\n        ],\n        y: [\n          defaulted('minY', 0),\n          defaulted('maxY', 100),\n          customField('value', function (spec) {\n            return Cell(spec.mode.minY);\n          }),\n          required$1('getInitialValue'),\n          output$1('manager', VerticalModel)\n        ],\n        xy: [\n          defaulted('minX', 0),\n          defaulted('maxX', 100),\n          defaulted('minY', 0),\n          defaulted('maxY', 100),\n          customField('value', function (spec) {\n            return Cell({\n              x: spec.mode.minX,\n              y: spec.mode.minY\n            });\n          }),\n          required$1('getInitialValue'),\n          output$1('manager', TwoDModel)\n        ]\n      })),\n      field('sliderBehaviours', [\n        Keying,\n        Representing\n      ]),\n      customField('mouseIsDown', function () {\n        return Cell(false);\n      })\n    ];\n\n    var sketch$2 = function (detail, components, _spec, _externals) {\n      var _a;\n      var getThumb = function (component) {\n        return getPartOrDie(component, detail, 'thumb');\n      };\n      var getSpectrum = function (component) {\n        return getPartOrDie(component, detail, 'spectrum');\n      };\n      var getLeftEdge = function (component) {\n        return getPart(component, detail, 'left-edge');\n      };\n      var getRightEdge = function (component) {\n        return getPart(component, detail, 'right-edge');\n      };\n      var getTopEdge = function (component) {\n        return getPart(component, detail, 'top-edge');\n      };\n      var getBottomEdge = function (component) {\n        return getPart(component, detail, 'bottom-edge');\n      };\n      var modelDetail = detail.model;\n      var model = modelDetail.manager;\n      var refresh = function (slider, thumb) {\n        model.setPositionFromValue(slider, thumb, detail, {\n          getLeftEdge: getLeftEdge,\n          getRightEdge: getRightEdge,\n          getTopEdge: getTopEdge,\n          getBottomEdge: getBottomEdge,\n          getSpectrum: getSpectrum\n        });\n      };\n      var setValue = function (slider, newValue) {\n        modelDetail.value.set(newValue);\n        var thumb = getThumb(slider);\n        refresh(slider, thumb);\n      };\n      var changeValue = function (slider, newValue) {\n        setValue(slider, newValue);\n        var thumb = getThumb(slider);\n        detail.onChange(slider, thumb, newValue);\n        return Optional.some(true);\n      };\n      var resetToMin = function (slider) {\n        model.setToMin(slider, detail);\n      };\n      var resetToMax = function (slider) {\n        model.setToMax(slider, detail);\n      };\n      var choose = function (slider) {\n        var fireOnChoose = function () {\n          getPart(slider, detail, 'thumb').each(function (thumb) {\n            var value = modelDetail.value.get();\n            detail.onChoose(slider, thumb, value);\n          });\n        };\n        var wasDown = detail.mouseIsDown.get();\n        detail.mouseIsDown.set(false);\n        if (wasDown) {\n          fireOnChoose();\n        }\n      };\n      var onDragStart = function (slider, simulatedEvent) {\n        simulatedEvent.stop();\n        detail.mouseIsDown.set(true);\n        detail.onDragStart(slider, getThumb(slider));\n      };\n      var onDragEnd = function (slider, simulatedEvent) {\n        simulatedEvent.stop();\n        detail.onDragEnd(slider, getThumb(slider));\n        choose(slider);\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.sliderBehaviours, [\n          Keying.config({\n            mode: 'special',\n            focusIn: function (slider) {\n              return getPart(slider, detail, 'spectrum').map(Keying.focusIn).map(always);\n            }\n          }),\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (_) {\n                return modelDetail.value.get();\n              }\n            }\n          }),\n          Receiving.config({ channels: (_a = {}, _a[mouseReleased()] = { onReceive: choose }, _a) })\n        ]),\n        events: derive$2([\n          run$1(sliderChangeEvent(), function (slider, simulatedEvent) {\n            changeValue(slider, simulatedEvent.event.value);\n          }),\n          runOnAttached(function (slider, _simulatedEvent) {\n            var getInitial = modelDetail.getInitialValue();\n            modelDetail.value.set(getInitial);\n            var thumb = getThumb(slider);\n            refresh(slider, thumb);\n            var spectrum = getSpectrum(slider);\n            detail.onInit(slider, thumb, spectrum, modelDetail.value.get());\n          }),\n          run$1(touchstart(), onDragStart),\n          run$1(touchend(), onDragEnd),\n          run$1(mousedown(), onDragStart),\n          run$1(mouseup(), onDragEnd)\n        ]),\n        apis: {\n          resetToMin: resetToMin,\n          resetToMax: resetToMax,\n          setValue: setValue,\n          refresh: refresh\n        },\n        domModification: { styles: { position: 'relative' } }\n      };\n    };\n\n    var Slider = composite({\n      name: 'Slider',\n      configFields: SliderSchema,\n      partFields: SliderParts,\n      factory: sketch$2,\n      apis: {\n        setValue: function (apis, slider, value) {\n          apis.setValue(slider, value);\n        },\n        resetToMin: function (apis, slider) {\n          apis.resetToMin(slider);\n        },\n        resetToMax: function (apis, slider) {\n          apis.resetToMax(slider);\n        },\n        refresh: function (apis, slider) {\n          apis.refresh(slider);\n        }\n      }\n    });\n\n    var fieldsUpdate = generate$6('rgb-hex-update');\n    var sliderUpdate = generate$6('slider-update');\n    var paletteUpdate = generate$6('palette-update');\n\n    var sliderFactory = function (translate, getClass) {\n      var spectrum = Slider.parts.spectrum({\n        dom: {\n          tag: 'div',\n          classes: [getClass('hue-slider-spectrum')],\n          attributes: { role: 'presentation' }\n        }\n      });\n      var thumb = Slider.parts.thumb({\n        dom: {\n          tag: 'div',\n          classes: [getClass('hue-slider-thumb')],\n          attributes: { role: 'presentation' }\n        }\n      });\n      return Slider.sketch({\n        dom: {\n          tag: 'div',\n          classes: [getClass('hue-slider')],\n          attributes: { role: 'presentation' }\n        },\n        rounded: false,\n        model: {\n          mode: 'y',\n          getInitialValue: constant$1({ y: 0 })\n        },\n        components: [\n          spectrum,\n          thumb\n        ],\n        sliderBehaviours: derive$1([Focusing.config({})]),\n        onChange: function (slider, _thumb, value) {\n          emitWith(slider, sliderUpdate, { value: value });\n        }\n      });\n    };\n\n    var owner$1 = 'form';\n    var schema$i = [field('formBehaviours', [Representing])];\n    var getPartName$1 = function (name) {\n      return '<alloy.field.' + name + '>';\n    };\n    var sketch$1 = function (fSpec) {\n      var parts = function () {\n        var record = [];\n        var field = function (name, config) {\n          record.push(name);\n          return generateOne$1(owner$1, getPartName$1(name), config);\n        };\n        return {\n          field: field,\n          record: constant$1(record)\n        };\n      }();\n      var spec = fSpec(parts);\n      var partNames = parts.record();\n      var fieldParts = map$2(partNames, function (n) {\n        return required({\n          name: n,\n          pname: getPartName$1(n)\n        });\n      });\n      return composite$1(owner$1, schema$i, fieldParts, make$4, spec);\n    };\n    var toResult = function (o, e) {\n      return o.fold(function () {\n        return Result.error(e);\n      }, Result.value);\n    };\n    var make$4 = function (detail, components) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.formBehaviours, [Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (form) {\n                var resPs = getAllParts(form, detail);\n                return map$1(resPs, function (resPThunk, pName) {\n                  return resPThunk().bind(function (v) {\n                    var opt = Composing.getCurrent(v);\n                    return toResult(opt, new Error('Cannot find a current component to extract the value from for form part \\'' + pName + '\\': ' + element(v.element)));\n                  }).map(Representing.getValue);\n                });\n              },\n              setValue: function (form, values) {\n                each(values, function (newValue, key) {\n                  getPart(form, detail, key).each(function (wrapper) {\n                    Composing.getCurrent(wrapper).each(function (field) {\n                      Representing.setValue(field, newValue);\n                    });\n                  });\n                });\n              }\n            }\n          })]),\n        apis: {\n          getField: function (form, key) {\n            return getPart(form, detail, key).bind(Composing.getCurrent);\n          }\n        }\n      };\n    };\n    var Form = {\n      getField: makeApi(function (apis, component, key) {\n        return apis.getField(component, key);\n      }),\n      sketch: sketch$1\n    };\n\n    var validInput = generate$6('valid-input');\n    var invalidInput = generate$6('invalid-input');\n    var validatingInput = generate$6('validating-input');\n    var translatePrefix = 'colorcustom.rgb.';\n    var rgbFormFactory = function (translate, getClass, onValidHexx, onInvalidHexx) {\n      var invalidation = function (label, isValid) {\n        return Invalidating.config({\n          invalidClass: getClass('invalid'),\n          notify: {\n            onValidate: function (comp) {\n              emitWith(comp, validatingInput, { type: label });\n            },\n            onValid: function (comp) {\n              emitWith(comp, validInput, {\n                type: label,\n                value: Representing.getValue(comp)\n              });\n            },\n            onInvalid: function (comp) {\n              emitWith(comp, invalidInput, {\n                type: label,\n                value: Representing.getValue(comp)\n              });\n            }\n          },\n          validator: {\n            validate: function (comp) {\n              var value = Representing.getValue(comp);\n              var res = isValid(value) ? Result.value(true) : Result.error(translate('aria.input.invalid'));\n              return Future.pure(res);\n            },\n            validateOnLoad: false\n          }\n        });\n      };\n      var renderTextField = function (isValid, name, label, description, data) {\n        var helptext = translate(translatePrefix + 'range');\n        var pLabel = FormField.parts.label({\n          dom: {\n            tag: 'label',\n            innerHtml: label,\n            attributes: { 'aria-label': description }\n          }\n        });\n        var pField = FormField.parts.field({\n          data: data,\n          factory: Input,\n          inputAttributes: __assign({ type: 'text' }, name === 'hex' ? { 'aria-live': 'polite' } : {}),\n          inputClasses: [getClass('textfield')],\n          inputBehaviours: derive$1([\n            invalidation(name, isValid),\n            Tabstopping.config({})\n          ]),\n          onSetValue: function (input) {\n            if (Invalidating.isInvalid(input)) {\n              var run = Invalidating.run(input);\n              run.get(noop);\n            }\n          }\n        });\n        var comps = [\n          pLabel,\n          pField\n        ];\n        var concats = name !== 'hex' ? [FormField.parts['aria-descriptor']({ text: helptext })] : [];\n        var components = comps.concat(concats);\n        return {\n          dom: {\n            tag: 'div',\n            attributes: { role: 'presentation' }\n          },\n          components: components\n        };\n      };\n      var copyRgbToHex = function (form, rgba) {\n        var hex = fromRgba(rgba);\n        Form.getField(form, 'hex').each(function (hexField) {\n          if (!Focusing.isFocused(hexField)) {\n            Representing.setValue(form, { hex: hex.value });\n          }\n        });\n        return hex;\n      };\n      var copyRgbToForm = function (form, rgb) {\n        var red = rgb.red;\n        var green = rgb.green;\n        var blue = rgb.blue;\n        Representing.setValue(form, {\n          red: red,\n          green: green,\n          blue: blue\n        });\n      };\n      var memPreview = record({\n        dom: {\n          tag: 'div',\n          classes: [getClass('rgba-preview')],\n          styles: { 'background-color': 'white' },\n          attributes: { role: 'presentation' }\n        }\n      });\n      var updatePreview = function (anyInSystem, hex) {\n        memPreview.getOpt(anyInSystem).each(function (preview) {\n          set$7(preview.element, 'background-color', '#' + hex.value);\n        });\n      };\n      var factory = function () {\n        var state = {\n          red: Cell(Optional.some(255)),\n          green: Cell(Optional.some(255)),\n          blue: Cell(Optional.some(255)),\n          hex: Cell(Optional.some('ffffff'))\n        };\n        var copyHexToRgb = function (form, hex) {\n          var rgb = fromHex(hex);\n          copyRgbToForm(form, rgb);\n          setValueRgb(rgb);\n        };\n        var get = function (prop) {\n          return state[prop].get();\n        };\n        var set = function (prop, value) {\n          state[prop].set(value);\n        };\n        var getValueRgb = function () {\n          return get('red').bind(function (red) {\n            return get('green').bind(function (green) {\n              return get('blue').map(function (blue) {\n                return rgbaColour(red, green, blue, 1);\n              });\n            });\n          });\n        };\n        var setValueRgb = function (rgb) {\n          var red = rgb.red;\n          var green = rgb.green;\n          var blue = rgb.blue;\n          set('red', Optional.some(red));\n          set('green', Optional.some(green));\n          set('blue', Optional.some(blue));\n        };\n        var onInvalidInput = function (form, simulatedEvent) {\n          var data = simulatedEvent.event;\n          if (data.type !== 'hex') {\n            set(data.type, Optional.none());\n          } else {\n            onInvalidHexx(form);\n          }\n        };\n        var onValidHex = function (form, value) {\n          onValidHexx(form);\n          var hex = hexColour(value);\n          set('hex', Optional.some(value));\n          var rgb = fromHex(hex);\n          copyRgbToForm(form, rgb);\n          setValueRgb(rgb);\n          emitWith(form, fieldsUpdate, { hex: hex });\n          updatePreview(form, hex);\n        };\n        var onValidRgb = function (form, prop, value) {\n          var val = parseInt(value, 10);\n          set(prop, Optional.some(val));\n          getValueRgb().each(function (rgb) {\n            var hex = copyRgbToHex(form, rgb);\n            emitWith(form, fieldsUpdate, { hex: hex });\n            updatePreview(form, hex);\n          });\n        };\n        var isHexInputEvent = function (data) {\n          return data.type === 'hex';\n        };\n        var onValidInput = function (form, simulatedEvent) {\n          var data = simulatedEvent.event;\n          if (isHexInputEvent(data)) {\n            onValidHex(form, data.value);\n          } else {\n            onValidRgb(form, data.type, data.value);\n          }\n        };\n        var formPartStrings = function (key) {\n          return {\n            label: translate(translatePrefix + key + '.label'),\n            description: translate(translatePrefix + key + '.description')\n          };\n        };\n        var redStrings = formPartStrings('red');\n        var greenStrings = formPartStrings('green');\n        var blueStrings = formPartStrings('blue');\n        var hexStrings = formPartStrings('hex');\n        return deepMerge(Form.sketch(function (parts) {\n          return {\n            dom: {\n              tag: 'form',\n              classes: [getClass('rgb-form')],\n              attributes: { 'aria-label': translate('aria.color.picker') }\n            },\n            components: [\n              parts.field('red', FormField.sketch(renderTextField(isRgbaComponent, 'red', redStrings.label, redStrings.description, 255))),\n              parts.field('green', FormField.sketch(renderTextField(isRgbaComponent, 'green', greenStrings.label, greenStrings.description, 255))),\n              parts.field('blue', FormField.sketch(renderTextField(isRgbaComponent, 'blue', blueStrings.label, blueStrings.description, 255))),\n              parts.field('hex', FormField.sketch(renderTextField(isHexString, 'hex', hexStrings.label, hexStrings.description, 'ffffff'))),\n              memPreview.asSpec()\n            ],\n            formBehaviours: derive$1([\n              Invalidating.config({ invalidClass: getClass('form-invalid') }),\n              config('rgb-form-events', [\n                run$1(validInput, onValidInput),\n                run$1(invalidInput, onInvalidInput),\n                run$1(validatingInput, onInvalidInput)\n              ])\n            ])\n          };\n        }), {\n          apis: {\n            updateHex: function (form, hex) {\n              Representing.setValue(form, { hex: hex.value });\n              copyHexToRgb(form, hex);\n              updatePreview(form, hex);\n            }\n          }\n        });\n      };\n      var rgbFormSketcher = single({\n        factory: factory,\n        name: 'RgbForm',\n        configFields: [],\n        apis: {\n          updateHex: function (apis, form, hex) {\n            apis.updateHex(form, hex);\n          }\n        },\n        extraApis: {}\n      });\n      return rgbFormSketcher;\n    };\n\n    var paletteFactory = function (_translate, getClass) {\n      var spectrumPart = Slider.parts.spectrum({\n        dom: {\n          tag: 'canvas',\n          attributes: { role: 'presentation' },\n          classes: [getClass('sv-palette-spectrum')]\n        }\n      });\n      var thumbPart = Slider.parts.thumb({\n        dom: {\n          tag: 'div',\n          attributes: { role: 'presentation' },\n          classes: [getClass('sv-palette-thumb')],\n          innerHtml: '<div class=' + getClass('sv-palette-inner-thumb') + ' role=\"presentation\"></div>'\n        }\n      });\n      var setColour = function (canvas, rgba) {\n        var width = canvas.width, height = canvas.height;\n        var ctx = canvas.getContext('2d');\n        if (ctx === null) {\n          return;\n        }\n        ctx.fillStyle = rgba;\n        ctx.fillRect(0, 0, width, height);\n        var grdWhite = ctx.createLinearGradient(0, 0, width, 0);\n        grdWhite.addColorStop(0, 'rgba(255,255,255,1)');\n        grdWhite.addColorStop(1, 'rgba(255,255,255,0)');\n        ctx.fillStyle = grdWhite;\n        ctx.fillRect(0, 0, width, height);\n        var grdBlack = ctx.createLinearGradient(0, 0, 0, height);\n        grdBlack.addColorStop(0, 'rgba(0,0,0,0)');\n        grdBlack.addColorStop(1, 'rgba(0,0,0,1)');\n        ctx.fillStyle = grdBlack;\n        ctx.fillRect(0, 0, width, height);\n      };\n      var setPaletteHue = function (slider, hue) {\n        var canvas = slider.components()[0].element.dom;\n        var hsv = hsvColour(hue, 100, 100);\n        var rgba = fromHsv(hsv);\n        setColour(canvas, toString(rgba));\n      };\n      var setPaletteThumb = function (slider, hex) {\n        var hsv = fromRgb(fromHex(hex));\n        Slider.setValue(slider, {\n          x: hsv.saturation,\n          y: 100 - hsv.value\n        });\n      };\n      var factory = function (_detail) {\n        var getInitialValue = constant$1({\n          x: 0,\n          y: 0\n        });\n        var onChange = function (slider, _thumb, value) {\n          emitWith(slider, paletteUpdate, { value: value });\n        };\n        var onInit = function (_slider, _thumb, spectrum, _value) {\n          setColour(spectrum.element.dom, toString(red));\n        };\n        var sliderBehaviours = derive$1([\n          Composing.config({ find: Optional.some }),\n          Focusing.config({})\n        ]);\n        return Slider.sketch({\n          dom: {\n            tag: 'div',\n            attributes: { role: 'presentation' },\n            classes: [getClass('sv-palette')]\n          },\n          model: {\n            mode: 'xy',\n            getInitialValue: getInitialValue\n          },\n          rounded: false,\n          components: [\n            spectrumPart,\n            thumbPart\n          ],\n          onChange: onChange,\n          onInit: onInit,\n          sliderBehaviours: sliderBehaviours\n        });\n      };\n      var saturationBrightnessPaletteSketcher = single({\n        factory: factory,\n        name: 'SaturationBrightnessPalette',\n        configFields: [],\n        apis: {\n          setHue: function (_apis, slider, hue) {\n            setPaletteHue(slider, hue);\n          },\n          setThumb: function (_apis, slider, hex) {\n            setPaletteThumb(slider, hex);\n          }\n        },\n        extraApis: {}\n      });\n      return saturationBrightnessPaletteSketcher;\n    };\n\n    var makeFactory = function (translate, getClass) {\n      var factory = function (detail) {\n        var rgbForm = rgbFormFactory(translate, getClass, detail.onValidHex, detail.onInvalidHex);\n        var sbPalette = paletteFactory(translate, getClass);\n        var hueSliderToDegrees = function (hue) {\n          return (100 - hue) / 100 * 360;\n        };\n        var hueDegreesToSlider = function (hue) {\n          return 100 - hue / 360 * 100;\n        };\n        var state = {\n          paletteRgba: Cell(red),\n          paletteHue: Cell(0)\n        };\n        var memSlider = record(sliderFactory(translate, getClass));\n        var memPalette = record(sbPalette.sketch({}));\n        var memRgb = record(rgbForm.sketch({}));\n        var updatePalette = function (anyInSystem, _hex, hue) {\n          memPalette.getOpt(anyInSystem).each(function (palette) {\n            sbPalette.setHue(palette, hue);\n          });\n        };\n        var updateFields = function (anyInSystem, hex) {\n          memRgb.getOpt(anyInSystem).each(function (form) {\n            rgbForm.updateHex(form, hex);\n          });\n        };\n        var updateSlider = function (anyInSystem, _hex, hue) {\n          memSlider.getOpt(anyInSystem).each(function (slider) {\n            Slider.setValue(slider, { y: hueDegreesToSlider(hue) });\n          });\n        };\n        var updatePaletteThumb = function (anyInSystem, hex) {\n          memPalette.getOpt(anyInSystem).each(function (palette) {\n            sbPalette.setThumb(palette, hex);\n          });\n        };\n        var updateState = function (hex, hue) {\n          var rgba = fromHex(hex);\n          state.paletteRgba.set(rgba);\n          state.paletteHue.set(hue);\n        };\n        var runUpdates = function (anyInSystem, hex, hue, updates) {\n          updateState(hex, hue);\n          each$1(updates, function (update) {\n            update(anyInSystem, hex, hue);\n          });\n        };\n        var onPaletteUpdate = function () {\n          var updates = [updateFields];\n          return function (form, simulatedEvent) {\n            var value = simulatedEvent.event.value;\n            var oldHue = state.paletteHue.get();\n            var newHsv = hsvColour(oldHue, value.x, 100 - value.y);\n            var newHex = hsvToHex(newHsv);\n            runUpdates(form, newHex, oldHue, updates);\n          };\n        };\n        var onSliderUpdate = function () {\n          var updates = [\n            updatePalette,\n            updateFields\n          ];\n          return function (form, simulatedEvent) {\n            var hue = hueSliderToDegrees(simulatedEvent.event.value.y);\n            var oldRgb = state.paletteRgba.get();\n            var oldHsv = fromRgb(oldRgb);\n            var newHsv = hsvColour(hue, oldHsv.saturation, oldHsv.value);\n            var newHex = hsvToHex(newHsv);\n            runUpdates(form, newHex, hue, updates);\n          };\n        };\n        var onFieldsUpdate = function () {\n          var updates = [\n            updatePalette,\n            updateSlider,\n            updatePaletteThumb\n          ];\n          return function (form, simulatedEvent) {\n            var hex = simulatedEvent.event.hex;\n            var hsv = hexToHsv(hex);\n            runUpdates(form, hex, hsv.hue, updates);\n          };\n        };\n        return {\n          uid: detail.uid,\n          dom: detail.dom,\n          components: [\n            memPalette.asSpec(),\n            memSlider.asSpec(),\n            memRgb.asSpec()\n          ],\n          behaviours: derive$1([\n            config('colour-picker-events', [\n              run$1(fieldsUpdate, onFieldsUpdate()),\n              run$1(paletteUpdate, onPaletteUpdate()),\n              run$1(sliderUpdate, onSliderUpdate())\n            ]),\n            Composing.config({\n              find: function (comp) {\n                return memRgb.getOpt(comp);\n              }\n            }),\n            Keying.config({ mode: 'acyclic' })\n          ])\n        };\n      };\n      var colourPickerSketcher = single({\n        name: 'ColourPicker',\n        configFields: [\n          required$1('dom'),\n          defaulted('onValidHex', noop),\n          defaulted('onInvalidHex', noop)\n        ],\n        factory: factory\n      });\n      return colourPickerSketcher;\n    };\n\n    var self$1 = function () {\n      return Composing.config({ find: Optional.some });\n    };\n    var memento$1 = function (mem) {\n      return Composing.config({ find: mem.getOpt });\n    };\n    var childAt = function (index) {\n      return Composing.config({\n        find: function (comp) {\n          return child$2(comp.element, index).bind(function (element) {\n            return comp.getSystem().getByDom(element).toOptional();\n          });\n        }\n      });\n    };\n    var ComposingConfigs = {\n      self: self$1,\n      memento: memento$1,\n      childAt: childAt\n    };\n\n    var english = {\n      'colorcustom.rgb.red.label': 'R',\n      'colorcustom.rgb.red.description': 'Red component',\n      'colorcustom.rgb.green.label': 'G',\n      'colorcustom.rgb.green.description': 'Green component',\n      'colorcustom.rgb.blue.label': 'B',\n      'colorcustom.rgb.blue.description': 'Blue component',\n      'colorcustom.rgb.hex.label': '#',\n      'colorcustom.rgb.hex.description': 'Hex color code',\n      'colorcustom.rgb.range': 'Range 0 to 255',\n      'colorcustom.sb.saturation': 'Saturation',\n      'colorcustom.sb.brightness': 'Brightness',\n      'colorcustom.sb.picker': 'Saturation and Brightness Picker',\n      'colorcustom.sb.palette': 'Saturation and Brightness Palette',\n      'colorcustom.sb.instructions': 'Use arrow keys to select saturation and brightness, on x and y axes',\n      'colorcustom.hue.hue': 'Hue',\n      'colorcustom.hue.slider': 'Hue Slider',\n      'colorcustom.hue.palette': 'Hue Palette',\n      'colorcustom.hue.instructions': 'Use arrow keys to select a hue',\n      'aria.color.picker': 'Color Picker',\n      'aria.input.invalid': 'Invalid input'\n    };\n    var getEnglishText = function (key) {\n      return english[key];\n    };\n    var translate$1 = function (key) {\n      return getEnglishText(key);\n    };\n    var renderColorPicker = function (_spec) {\n      var getClass = function (key) {\n        return 'tox-' + key;\n      };\n      var colourPickerFactory = makeFactory(translate$1, getClass);\n      var onValidHex = function (form) {\n        emitWith(form, formActionEvent, {\n          name: 'hex-valid',\n          value: true\n        });\n      };\n      var onInvalidHex = function (form) {\n        emitWith(form, formActionEvent, {\n          name: 'hex-valid',\n          value: false\n        });\n      };\n      var memPicker = record(colourPickerFactory.sketch({\n        dom: {\n          tag: 'div',\n          classes: [getClass('color-picker-container')],\n          attributes: { role: 'presentation' }\n        },\n        onValidHex: onValidHex,\n        onInvalidHex: onInvalidHex\n      }));\n      return {\n        dom: { tag: 'div' },\n        components: [memPicker.asSpec()],\n        behaviours: derive$1([\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (comp) {\n                var picker = memPicker.get(comp);\n                var optRgbForm = Composing.getCurrent(picker);\n                var optHex = optRgbForm.bind(function (rgbForm) {\n                  var formValues = Representing.getValue(rgbForm);\n                  return formValues.hex;\n                });\n                return optHex.map(function (hex) {\n                  return '#' + hex;\n                }).getOr('');\n              },\n              setValue: function (comp, newValue) {\n                var pattern = /^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/;\n                var m = pattern.exec(newValue);\n                var picker = memPicker.get(comp);\n                var optRgbForm = Composing.getCurrent(picker);\n                optRgbForm.fold(function () {\n                  console.log('Can not find form');\n                }, function (rgbForm) {\n                  Representing.setValue(rgbForm, { hex: Optional.from(m[1]).getOr('') });\n                  Form.getField(rgbForm, 'hex').each(function (hexField) {\n                    emit(hexField, input());\n                  });\n                });\n              }\n            }\n          }),\n          ComposingConfigs.self()\n        ])\n      };\n    };\n\n    var global$6 = tinymce.util.Tools.resolve('tinymce.Resource');\n\n    var isOldCustomEditor = function (spec) {\n      return has$2(spec, 'init');\n    };\n    var renderCustomEditor = function (spec) {\n      var editorApi = value$1();\n      var memReplaced = record({ dom: { tag: spec.tag } });\n      var initialValue = value$1();\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-custom-editor']\n        },\n        behaviours: derive$1([\n          config('custom-editor-events', [runOnAttached(function (component) {\n              memReplaced.getOpt(component).each(function (ta) {\n                (isOldCustomEditor(spec) ? spec.init(ta.element.dom) : global$6.load(spec.scriptId, spec.scriptUrl).then(function (init) {\n                  return init(ta.element.dom, spec.settings);\n                })).then(function (ea) {\n                  initialValue.on(function (cvalue) {\n                    ea.setValue(cvalue);\n                  });\n                  initialValue.clear();\n                  editorApi.set(ea);\n                });\n              });\n            })]),\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function () {\n                return editorApi.get().fold(function () {\n                  return initialValue.get().getOr('');\n                }, function (ed) {\n                  return ed.getValue();\n                });\n              },\n              setValue: function (component, value) {\n                editorApi.get().fold(function () {\n                  initialValue.set(value);\n                }, function (ed) {\n                  return ed.setValue(value);\n                });\n              }\n            }\n          }),\n          ComposingConfigs.self()\n        ]),\n        components: [memReplaced.asSpec()]\n      };\n    };\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var processors = objOf([\n      defaulted('preprocess', identity$1),\n      defaulted('postprocess', identity$1)\n    ]);\n    var memento = function (mem, rawProcessors) {\n      var ps = asRawOrDie$1('RepresentingConfigs.memento processors', processors, rawProcessors);\n      return Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (comp) {\n            var other = mem.get(comp);\n            var rawValue = Representing.getValue(other);\n            return ps.postprocess(rawValue);\n          },\n          setValue: function (comp, rawValue) {\n            var newValue = ps.preprocess(rawValue);\n            var other = mem.get(comp);\n            Representing.setValue(other, newValue);\n          }\n        }\n      });\n    };\n    var withComp = function (optInitialValue, getter, setter) {\n      return Representing.config(deepMerge({\n        store: {\n          mode: 'manual',\n          getValue: getter,\n          setValue: setter\n        }\n      }, optInitialValue.map(function (initialValue) {\n        return { store: { initialValue: initialValue } };\n      }).getOr({})));\n    };\n    var withElement = function (initialValue, getter, setter) {\n      return withComp(initialValue, function (c) {\n        return getter(c.element);\n      }, function (c, v) {\n        return setter(c.element, v);\n      });\n    };\n    var domValue = function (optInitialValue) {\n      return withElement(optInitialValue, get$5, set$4);\n    };\n    var domHtml = function (optInitialValue) {\n      return withElement(optInitialValue, get$7, set$5);\n    };\n    var memory = function (initialValue) {\n      return Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: initialValue\n        }\n      });\n    };\n    var RepresentingConfigs = {\n      memento: memento,\n      withElement: withElement,\n      withComp: withComp,\n      domValue: domValue,\n      domHtml: domHtml,\n      memory: memory\n    };\n\n    var defaultImageFileTypes = 'jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp';\n    var filterByExtension = function (files, providersBackstage) {\n      var allowedImageFileTypes = global$5.explode(providersBackstage.getSetting('images_file_types', defaultImageFileTypes, 'string'));\n      var isFileInAllowedTypes = function (file) {\n        return exists(allowedImageFileTypes, function (type) {\n          return endsWith(file.name.toLowerCase(), '.' + type.toLowerCase());\n        });\n      };\n      return filter$2(from(files), isFileInAllowedTypes);\n    };\n    var renderDropZone = function (spec, providersBackstage) {\n      var stopper = function (_, se) {\n        se.stop();\n      };\n      var sequence = function (actions) {\n        return function (comp, se) {\n          each$1(actions, function (a) {\n            a(comp, se);\n          });\n        };\n      };\n      var onDrop = function (comp, se) {\n        if (!Disabling.isDisabled(comp)) {\n          var transferEvent = se.event.raw;\n          handleFiles(comp, transferEvent.dataTransfer.files);\n        }\n      };\n      var onSelect = function (component, simulatedEvent) {\n        var input = simulatedEvent.event.raw.target;\n        handleFiles(component, input.files);\n      };\n      var handleFiles = function (component, files) {\n        Representing.setValue(component, filterByExtension(files, providersBackstage));\n        emitWith(component, formChangeEvent, { name: spec.name });\n      };\n      var memInput = record({\n        dom: {\n          tag: 'input',\n          attributes: {\n            type: 'file',\n            accept: 'image/*'\n          },\n          styles: { display: 'none' }\n        },\n        behaviours: derive$1([config('input-file-events', [\n            cutter(click()),\n            cutter(tap())\n          ])])\n      });\n      var renderField = function (s) {\n        return {\n          uid: s.uid,\n          dom: {\n            tag: 'div',\n            classes: ['tox-dropzone-container']\n          },\n          behaviours: derive$1([\n            RepresentingConfigs.memory([]),\n            ComposingConfigs.self(),\n            Disabling.config({}),\n            Toggling.config({\n              toggleClass: 'dragenter',\n              toggleOnExecute: false\n            }),\n            config('dropzone-events', [\n              run$1('dragenter', sequence([\n                stopper,\n                Toggling.toggle\n              ])),\n              run$1('dragleave', sequence([\n                stopper,\n                Toggling.toggle\n              ])),\n              run$1('dragover', stopper),\n              run$1('drop', sequence([\n                stopper,\n                onDrop\n              ])),\n              run$1(change(), onSelect)\n            ])\n          ]),\n          components: [{\n              dom: {\n                tag: 'div',\n                classes: ['tox-dropzone'],\n                styles: {}\n              },\n              components: [\n                {\n                  dom: {\n                    tag: 'p',\n                    innerHtml: providersBackstage.translate('Drop an image here')\n                  }\n                },\n                Button.sketch({\n                  dom: {\n                    tag: 'button',\n                    innerHtml: providersBackstage.translate('Browse for an image'),\n                    styles: { position: 'relative' },\n                    classes: [\n                      'tox-button',\n                      'tox-button--secondary'\n                    ]\n                  },\n                  components: [memInput.asSpec()],\n                  action: function (comp) {\n                    var inputComp = memInput.get(comp);\n                    inputComp.element.dom.click();\n                  },\n                  buttonBehaviours: derive$1([\n                    Tabstopping.config({}),\n                    DisablingConfigs.button(providersBackstage.isDisabled),\n                    receivingConfig()\n                  ])\n                })\n              ]\n            }]\n        };\n      };\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel$2(label, providersBackstage);\n      });\n      var pField = FormField.parts.field({ factory: { sketch: renderField } });\n      return renderFormFieldWith(pLabel, pField, ['tox-form__group--stretched'], []);\n    };\n\n    var renderGrid = function (spec, backstage) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-form__grid',\n            'tox-form__grid--' + spec.columns + 'col'\n          ]\n        },\n        components: map$2(spec.items, backstage.interpreter)\n      };\n    };\n\n    var beforeObject = generate$6('alloy-fake-before-tabstop');\n    var afterObject = generate$6('alloy-fake-after-tabstop');\n    var craftWithClasses = function (classes) {\n      return {\n        dom: {\n          tag: 'div',\n          styles: {\n            width: '1px',\n            height: '1px',\n            outline: 'none'\n          },\n          attributes: { tabindex: '0' },\n          classes: classes\n        },\n        behaviours: derive$1([\n          Focusing.config({ ignore: true }),\n          Tabstopping.config({})\n        ])\n      };\n    };\n    var craft = function (spec) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-navobj']\n        },\n        components: [\n          craftWithClasses([beforeObject]),\n          spec,\n          craftWithClasses([afterObject])\n        ],\n        behaviours: derive$1([ComposingConfigs.childAt(1)])\n      };\n    };\n    var triggerTab = function (placeholder, shiftKey) {\n      emitWith(placeholder, keydown(), {\n        raw: {\n          which: 9,\n          shiftKey: shiftKey\n        }\n      });\n    };\n    var onFocus = function (container, targetComp) {\n      var target = targetComp.element;\n      if (has(target, beforeObject)) {\n        triggerTab(container, true);\n      } else if (has(target, afterObject)) {\n        triggerTab(container, false);\n      }\n    };\n    var isPseudoStop = function (element) {\n      return closest(element, [\n        '.' + beforeObject,\n        '.' + afterObject\n      ].join(','), never);\n    };\n\n    var platformNeedsSandboxing = !(detect$1().browser.isIE() || detect$1().browser.isEdge());\n    var getDynamicSource = function (isSandbox) {\n      var cachedValue = Cell('');\n      return {\n        getValue: function (_frameComponent) {\n          return cachedValue.get();\n        },\n        setValue: function (frameComponent, html) {\n          if (!isSandbox) {\n            set$8(frameComponent.element, 'src', 'javascript:\\'\\'');\n            var doc = frameComponent.element.dom.contentWindow.document;\n            doc.open();\n            doc.write(html);\n            doc.close();\n          } else {\n            set$8(frameComponent.element, 'srcdoc', html);\n          }\n          cachedValue.set(html);\n        }\n      };\n    };\n    var renderIFrame = function (spec, providersBackstage) {\n      var isSandbox = platformNeedsSandboxing && spec.sandboxed;\n      var attributes = __assign(__assign({}, spec.label.map(function (title) {\n        return { title: title };\n      }).getOr({})), isSandbox ? { sandbox: 'allow-scripts allow-same-origin' } : {});\n      var sourcing = getDynamicSource(isSandbox);\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel$2(label, providersBackstage);\n      });\n      var factory = function (newSpec) {\n        return craft({\n          uid: newSpec.uid,\n          dom: {\n            tag: 'iframe',\n            attributes: attributes\n          },\n          behaviours: derive$1([\n            Tabstopping.config({}),\n            Focusing.config({}),\n            RepresentingConfigs.withComp(Optional.none(), sourcing.getValue, sourcing.setValue)\n          ])\n        });\n      };\n      var pField = FormField.parts.field({ factory: { sketch: factory } });\n      return renderFormFieldWith(pLabel, pField, ['tox-form__group--stretched'], []);\n    };\n\n    var create$3 = function (width, height) {\n      return resize$3(document.createElement('canvas'), width, height);\n    };\n    var clone = function (canvas) {\n      var tCanvas = create$3(canvas.width, canvas.height);\n      var ctx = get2dContext(tCanvas);\n      ctx.drawImage(canvas, 0, 0);\n      return tCanvas;\n    };\n    var get2dContext = function (canvas) {\n      return canvas.getContext('2d');\n    };\n    var resize$3 = function (canvas, width, height) {\n      canvas.width = width;\n      canvas.height = height;\n      return canvas;\n    };\n\n    var getWidth$1 = function (image) {\n      return image.naturalWidth || image.width;\n    };\n    var getHeight$1 = function (image) {\n      return image.naturalHeight || image.height;\n    };\n\n    var blobToImage = function (blob) {\n      return new Promise$1(function (resolve, reject) {\n        var blobUrl = URL.createObjectURL(blob);\n        var image = new Image();\n        var removeListeners = function () {\n          image.removeEventListener('load', loaded);\n          image.removeEventListener('error', error);\n        };\n        var loaded = function () {\n          removeListeners();\n          resolve(image);\n        };\n        var error = function () {\n          removeListeners();\n          reject('Unable to load data of type ' + blob.type + ': ' + blobUrl);\n        };\n        image.addEventListener('load', loaded);\n        image.addEventListener('error', error);\n        image.src = blobUrl;\n        if (image.complete) {\n          setTimeout(loaded, 0);\n        }\n      });\n    };\n    var dataUriToBlobSync = function (uri) {\n      var data = uri.split(',');\n      var matches = /data:([^;]+)/.exec(data[0]);\n      if (!matches) {\n        return Optional.none();\n      }\n      var mimetype = matches[1];\n      var base64 = data[1];\n      var sliceSize = 1024;\n      var byteCharacters = atob(base64);\n      var bytesLength = byteCharacters.length;\n      var slicesCount = Math.ceil(bytesLength / sliceSize);\n      var byteArrays = new Array(slicesCount);\n      for (var sliceIndex = 0; sliceIndex < slicesCount; ++sliceIndex) {\n        var begin = sliceIndex * sliceSize;\n        var end = Math.min(begin + sliceSize, bytesLength);\n        var bytes = new Array(end - begin);\n        for (var offset = begin, i = 0; offset < end; ++i, ++offset) {\n          bytes[i] = byteCharacters[offset].charCodeAt(0);\n        }\n        byteArrays[sliceIndex] = new Uint8Array(bytes);\n      }\n      return Optional.some(new Blob(byteArrays, { type: mimetype }));\n    };\n    var dataUriToBlob = function (uri) {\n      return new Promise$1(function (resolve, reject) {\n        dataUriToBlobSync(uri).fold(function () {\n          reject('uri is not base64: ' + uri);\n        }, resolve);\n      });\n    };\n    var canvasToBlob = function (canvas, type, quality) {\n      type = type || 'image/png';\n      if (isFunction(HTMLCanvasElement.prototype.toBlob)) {\n        return new Promise$1(function (resolve, reject) {\n          canvas.toBlob(function (blob) {\n            if (blob) {\n              resolve(blob);\n            } else {\n              reject();\n            }\n          }, type, quality);\n        });\n      } else {\n        return dataUriToBlob(canvas.toDataURL(type, quality));\n      }\n    };\n    var canvasToDataURL = function (canvas, type, quality) {\n      type = type || 'image/png';\n      return canvas.toDataURL(type, quality);\n    };\n    var blobToCanvas = function (blob) {\n      return blobToImage(blob).then(function (image) {\n        revokeImageUrl(image);\n        var canvas = create$3(getWidth$1(image), getHeight$1(image));\n        var context = get2dContext(canvas);\n        context.drawImage(image, 0, 0);\n        return canvas;\n      });\n    };\n    var blobToDataUri = function (blob) {\n      return new Promise$1(function (resolve) {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(blob);\n      });\n    };\n    var revokeImageUrl = function (image) {\n      URL.revokeObjectURL(image.src);\n    };\n\n    var create$2 = function (getCanvas, blob, uri) {\n      var initialType = blob.type;\n      var getType = constant$1(initialType);\n      var toBlob = function () {\n        return Promise$1.resolve(blob);\n      };\n      var toDataURL = constant$1(uri);\n      var toBase64 = function () {\n        return uri.split(',')[1];\n      };\n      var toAdjustedBlob = function (type, quality) {\n        return getCanvas.then(function (canvas) {\n          return canvasToBlob(canvas, type, quality);\n        });\n      };\n      var toAdjustedDataURL = function (type, quality) {\n        return getCanvas.then(function (canvas) {\n          return canvasToDataURL(canvas, type, quality);\n        });\n      };\n      var toAdjustedBase64 = function (type, quality) {\n        return toAdjustedDataURL(type, quality).then(function (dataurl) {\n          return dataurl.split(',')[1];\n        });\n      };\n      var toCanvas = function () {\n        return getCanvas.then(clone);\n      };\n      return {\n        getType: getType,\n        toBlob: toBlob,\n        toDataURL: toDataURL,\n        toBase64: toBase64,\n        toAdjustedBlob: toAdjustedBlob,\n        toAdjustedDataURL: toAdjustedDataURL,\n        toAdjustedBase64: toAdjustedBase64,\n        toCanvas: toCanvas\n      };\n    };\n    var fromBlob = function (blob) {\n      return blobToDataUri(blob).then(function (uri) {\n        return create$2(blobToCanvas(blob), blob, uri);\n      });\n    };\n    var fromCanvas = function (canvas, type) {\n      return canvasToBlob(canvas, type).then(function (blob) {\n        return create$2(Promise$1.resolve(canvas), blob, canvas.toDataURL());\n      });\n    };\n\n    var blobToImageResult = function (blob) {\n      return fromBlob(blob);\n    };\n\n    var clamp = function (value, min, max) {\n      var parsedValue = typeof value === 'string' ? parseFloat(value) : value;\n      if (parsedValue > max) {\n        parsedValue = max;\n      } else if (parsedValue < min) {\n        parsedValue = min;\n      }\n      return parsedValue;\n    };\n    var identity = function () {\n      return [\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1\n      ];\n    };\n    var DELTA_INDEX = [\n      0,\n      0.01,\n      0.02,\n      0.04,\n      0.05,\n      0.06,\n      0.07,\n      0.08,\n      0.1,\n      0.11,\n      0.12,\n      0.14,\n      0.15,\n      0.16,\n      0.17,\n      0.18,\n      0.2,\n      0.21,\n      0.22,\n      0.24,\n      0.25,\n      0.27,\n      0.28,\n      0.3,\n      0.32,\n      0.34,\n      0.36,\n      0.38,\n      0.4,\n      0.42,\n      0.44,\n      0.46,\n      0.48,\n      0.5,\n      0.53,\n      0.56,\n      0.59,\n      0.62,\n      0.65,\n      0.68,\n      0.71,\n      0.74,\n      0.77,\n      0.8,\n      0.83,\n      0.86,\n      0.89,\n      0.92,\n      0.95,\n      0.98,\n      1,\n      1.06,\n      1.12,\n      1.18,\n      1.24,\n      1.3,\n      1.36,\n      1.42,\n      1.48,\n      1.54,\n      1.6,\n      1.66,\n      1.72,\n      1.78,\n      1.84,\n      1.9,\n      1.96,\n      2,\n      2.12,\n      2.25,\n      2.37,\n      2.5,\n      2.62,\n      2.75,\n      2.87,\n      3,\n      3.2,\n      3.4,\n      3.6,\n      3.8,\n      4,\n      4.3,\n      4.7,\n      4.9,\n      5,\n      5.5,\n      6,\n      6.5,\n      6.8,\n      7,\n      7.3,\n      7.5,\n      7.8,\n      8,\n      8.4,\n      8.7,\n      9,\n      9.4,\n      9.6,\n      9.8,\n      10\n    ];\n    var multiply = function (matrix1, matrix2) {\n      var col = [];\n      var out = new Array(25);\n      var val;\n      for (var i = 0; i < 5; i++) {\n        for (var j = 0; j < 5; j++) {\n          col[j] = matrix2[j + i * 5];\n        }\n        for (var j = 0; j < 5; j++) {\n          val = 0;\n          for (var k = 0; k < 5; k++) {\n            val += matrix1[j + k * 5] * col[k];\n          }\n          out[j + i * 5] = val;\n        }\n      }\n      return out;\n    };\n    var adjustContrast = function (matrix, value) {\n      var x;\n      value = clamp(value, -1, 1);\n      value *= 100;\n      if (value < 0) {\n        x = 127 + value / 100 * 127;\n      } else {\n        x = value % 1;\n        if (x === 0) {\n          x = DELTA_INDEX[value];\n        } else {\n          x = DELTA_INDEX[Math.floor(value)] * (1 - x) + DELTA_INDEX[Math.floor(value) + 1] * x;\n        }\n        x = x * 127 + 127;\n      }\n      return multiply(matrix, [\n        x / 127,\n        0,\n        0,\n        0,\n        0.5 * (127 - x),\n        0,\n        x / 127,\n        0,\n        0,\n        0.5 * (127 - x),\n        0,\n        0,\n        x / 127,\n        0,\n        0.5 * (127 - x),\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1\n      ]);\n    };\n    var adjustBrightness = function (matrix, value) {\n      value = clamp(255 * value, -255, 255);\n      return multiply(matrix, [\n        1,\n        0,\n        0,\n        0,\n        value,\n        0,\n        1,\n        0,\n        0,\n        value,\n        0,\n        0,\n        1,\n        0,\n        value,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1\n      ]);\n    };\n    var adjustColors = function (matrix, adjustR, adjustG, adjustB) {\n      adjustR = clamp(adjustR, 0, 2);\n      adjustG = clamp(adjustG, 0, 2);\n      adjustB = clamp(adjustB, 0, 2);\n      return multiply(matrix, [\n        adjustR,\n        0,\n        0,\n        0,\n        0,\n        0,\n        adjustG,\n        0,\n        0,\n        0,\n        0,\n        0,\n        adjustB,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1\n      ]);\n    };\n\n    var colorFilter = function (ir, matrix) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyColorFilter(canvas, ir.getType(), matrix);\n      });\n    };\n    var applyColorFilter = function (canvas, type, matrix) {\n      var context = get2dContext(canvas);\n      var applyMatrix = function (pixelsData, m) {\n        var r, g, b, a;\n        var data = pixelsData.data, m0 = m[0], m1 = m[1], m2 = m[2], m3 = m[3], m4 = m[4], m5 = m[5], m6 = m[6], m7 = m[7], m8 = m[8], m9 = m[9], m10 = m[10], m11 = m[11], m12 = m[12], m13 = m[13], m14 = m[14], m15 = m[15], m16 = m[16], m17 = m[17], m18 = m[18], m19 = m[19];\n        for (var i = 0; i < data.length; i += 4) {\n          r = data[i];\n          g = data[i + 1];\n          b = data[i + 2];\n          a = data[i + 3];\n          data[i] = r * m0 + g * m1 + b * m2 + a * m3 + m4;\n          data[i + 1] = r * m5 + g * m6 + b * m7 + a * m8 + m9;\n          data[i + 2] = r * m10 + g * m11 + b * m12 + a * m13 + m14;\n          data[i + 3] = r * m15 + g * m16 + b * m17 + a * m18 + m19;\n        }\n        return pixelsData;\n      };\n      var pixels = applyMatrix(context.getImageData(0, 0, canvas.width, canvas.height), matrix);\n      context.putImageData(pixels, 0, 0);\n      return fromCanvas(canvas, type);\n    };\n    var convoluteFilter = function (ir, matrix) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyConvoluteFilter(canvas, ir.getType(), matrix);\n      });\n    };\n    var applyConvoluteFilter = function (canvas, type, matrix) {\n      var context = get2dContext(canvas);\n      var applyMatrix = function (pIn, pOut, aMatrix) {\n        var clamp = function (value, min, max) {\n          if (value > max) {\n            value = max;\n          } else if (value < min) {\n            value = min;\n          }\n          return value;\n        };\n        var side = Math.round(Math.sqrt(aMatrix.length));\n        var halfSide = Math.floor(side / 2);\n        var rgba = pIn.data;\n        var drgba = pOut.data;\n        var w = pIn.width;\n        var h = pIn.height;\n        for (var y = 0; y < h; y++) {\n          for (var x = 0; x < w; x++) {\n            var r = 0;\n            var g = 0;\n            var b = 0;\n            for (var cy = 0; cy < side; cy++) {\n              for (var cx = 0; cx < side; cx++) {\n                var scx = clamp(x + cx - halfSide, 0, w - 1);\n                var scy = clamp(y + cy - halfSide, 0, h - 1);\n                var innerOffset = (scy * w + scx) * 4;\n                var wt = aMatrix[cy * side + cx];\n                r += rgba[innerOffset] * wt;\n                g += rgba[innerOffset + 1] * wt;\n                b += rgba[innerOffset + 2] * wt;\n              }\n            }\n            var offset = (y * w + x) * 4;\n            drgba[offset] = clamp(r, 0, 255);\n            drgba[offset + 1] = clamp(g, 0, 255);\n            drgba[offset + 2] = clamp(b, 0, 255);\n          }\n        }\n        return pOut;\n      };\n      var pixelsIn = context.getImageData(0, 0, canvas.width, canvas.height);\n      var pixelsOut = context.getImageData(0, 0, canvas.width, canvas.height);\n      pixelsOut = applyMatrix(pixelsIn, pixelsOut, matrix);\n      context.putImageData(pixelsOut, 0, 0);\n      return fromCanvas(canvas, type);\n    };\n    var functionColorFilter = function (colorFn) {\n      var filterImpl = function (canvas, type, value) {\n        var context = get2dContext(canvas);\n        var lookup = new Array(256);\n        var applyLookup = function (pixelsData, lookupData) {\n          var data = pixelsData.data;\n          for (var i = 0; i < data.length; i += 4) {\n            data[i] = lookupData[data[i]];\n            data[i + 1] = lookupData[data[i + 1]];\n            data[i + 2] = lookupData[data[i + 2]];\n          }\n          return pixelsData;\n        };\n        for (var i = 0; i < lookup.length; i++) {\n          lookup[i] = colorFn(i, value);\n        }\n        var pixels = applyLookup(context.getImageData(0, 0, canvas.width, canvas.height), lookup);\n        context.putImageData(pixels, 0, 0);\n        return fromCanvas(canvas, type);\n      };\n      return function (ir, value) {\n        return ir.toCanvas().then(function (canvas) {\n          return filterImpl(canvas, ir.getType(), value);\n        });\n      };\n    };\n    var complexAdjustableColorFilter = function (matrixAdjustFn) {\n      return function (ir, adjust) {\n        return colorFilter(ir, matrixAdjustFn(identity(), adjust));\n      };\n    };\n    var basicColorFilter = function (matrix) {\n      return function (ir) {\n        return colorFilter(ir, matrix);\n      };\n    };\n    var basicConvolutionFilter = function (kernel) {\n      return function (ir) {\n        return convoluteFilter(ir, kernel);\n      };\n    };\n    var invert$1 = basicColorFilter([\n      -1,\n      0,\n      0,\n      0,\n      255,\n      0,\n      -1,\n      0,\n      0,\n      255,\n      0,\n      0,\n      -1,\n      0,\n      255,\n      0,\n      0,\n      0,\n      1,\n      0,\n      0,\n      0,\n      0,\n      0,\n      1\n    ]);\n    var brightness$1 = complexAdjustableColorFilter(adjustBrightness);\n    var contrast$1 = complexAdjustableColorFilter(adjustContrast);\n    var colorize$1 = function (ir, adjustR, adjustG, adjustB) {\n      return colorFilter(ir, adjustColors(identity(), adjustR, adjustG, adjustB));\n    };\n    var sharpen$1 = basicConvolutionFilter([\n      0,\n      -1,\n      0,\n      -1,\n      5,\n      -1,\n      0,\n      -1,\n      0\n    ]);\n    var gamma$1 = functionColorFilter(function (color, value) {\n      return Math.pow(color / 255, 1 - value) * 255;\n    });\n\n    var scale = function (image, dW, dH) {\n      var sW = getWidth$1(image);\n      var sH = getHeight$1(image);\n      var wRatio = dW / sW;\n      var hRatio = dH / sH;\n      var scaleCapped = false;\n      if (wRatio < 0.5 || wRatio > 2) {\n        wRatio = wRatio < 0.5 ? 0.5 : 2;\n        scaleCapped = true;\n      }\n      if (hRatio < 0.5 || hRatio > 2) {\n        hRatio = hRatio < 0.5 ? 0.5 : 2;\n        scaleCapped = true;\n      }\n      var scaled = _scale(image, wRatio, hRatio);\n      return !scaleCapped ? scaled : scaled.then(function (tCanvas) {\n        return scale(tCanvas, dW, dH);\n      });\n    };\n    var _scale = function (image, wRatio, hRatio) {\n      return new Promise$1(function (resolve) {\n        var sW = getWidth$1(image);\n        var sH = getHeight$1(image);\n        var dW = Math.floor(sW * wRatio);\n        var dH = Math.floor(sH * hRatio);\n        var canvas = create$3(dW, dH);\n        var context = get2dContext(canvas);\n        context.drawImage(image, 0, 0, sW, sH, 0, 0, dW, dH);\n        resolve(canvas);\n      });\n    };\n\n    var ceilWithPrecision = function (num, precision) {\n      if (precision === void 0) {\n        precision = 2;\n      }\n      var mul = Math.pow(10, precision);\n      var upper = Math.round(num * mul);\n      return Math.ceil(upper / mul);\n    };\n    var rotate$1 = function (ir, angle) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyRotate(canvas, ir.getType(), angle);\n      });\n    };\n    var applyRotate = function (image, type, angle) {\n      var degrees = angle < 0 ? 360 + angle : angle;\n      var rad = degrees * Math.PI / 180;\n      var width = image.width;\n      var height = image.height;\n      var sin = Math.sin(rad);\n      var cos = Math.cos(rad);\n      var newWidth = ceilWithPrecision(Math.abs(width * cos) + Math.abs(height * sin));\n      var newHeight = ceilWithPrecision(Math.abs(width * sin) + Math.abs(height * cos));\n      var canvas = create$3(newWidth, newHeight);\n      var context = get2dContext(canvas);\n      context.translate(newWidth / 2, newHeight / 2);\n      context.rotate(rad);\n      context.drawImage(image, -width / 2, -height / 2);\n      return fromCanvas(canvas, type);\n    };\n    var flip$1 = function (ir, axis) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyFlip(canvas, ir.getType(), axis);\n      });\n    };\n    var applyFlip = function (image, type, axis) {\n      var canvas = create$3(image.width, image.height);\n      var context = get2dContext(canvas);\n      if (axis === 'v') {\n        context.scale(1, -1);\n        context.drawImage(image, 0, -canvas.height);\n      } else {\n        context.scale(-1, 1);\n        context.drawImage(image, -canvas.width, 0);\n      }\n      return fromCanvas(canvas, type);\n    };\n    var crop$1 = function (ir, x, y, w, h) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyCrop(canvas, ir.getType(), x, y, w, h);\n      });\n    };\n    var applyCrop = function (image, type, x, y, w, h) {\n      var canvas = create$3(w, h);\n      var context = get2dContext(canvas);\n      context.drawImage(image, -x, -y);\n      return fromCanvas(canvas, type);\n    };\n    var resize$2 = function (ir, w, h) {\n      return ir.toCanvas().then(function (canvas) {\n        return scale(canvas, w, h).then(function (newCanvas) {\n          return fromCanvas(newCanvas, ir.getType());\n        });\n      });\n    };\n\n    var invert = function (ir) {\n      return invert$1(ir);\n    };\n    var sharpen = function (ir) {\n      return sharpen$1(ir);\n    };\n    var gamma = function (ir, value) {\n      return gamma$1(ir, value);\n    };\n    var colorize = function (ir, adjustR, adjustG, adjustB) {\n      return colorize$1(ir, adjustR, adjustG, adjustB);\n    };\n    var brightness = function (ir, adjust) {\n      return brightness$1(ir, adjust);\n    };\n    var contrast = function (ir, adjust) {\n      return contrast$1(ir, adjust);\n    };\n    var flip = function (ir, axis) {\n      return flip$1(ir, axis);\n    };\n    var crop = function (ir, x, y, w, h) {\n      return crop$1(ir, x, y, w, h);\n    };\n    var resize$1 = function (ir, w, h) {\n      return resize$2(ir, w, h);\n    };\n    var rotate = function (ir, angle) {\n      return rotate$1(ir, angle);\n    };\n\n    var renderIcon = function (iconName, iconsProvider, behaviours) {\n      return render$3(iconName, {\n        tag: 'span',\n        classes: [\n          'tox-icon',\n          'tox-tbtn__icon-wrap'\n        ],\n        behaviours: behaviours\n      }, iconsProvider);\n    };\n    var renderIconFromPack = function (iconName, iconsProvider) {\n      return renderIcon(iconName, iconsProvider, []);\n    };\n    var renderReplacableIconFromPack = function (iconName, iconsProvider) {\n      return renderIcon(iconName, iconsProvider, [Replacing.config({})]);\n    };\n    var renderLabel$1 = function (text, prefix, providersBackstage) {\n      return {\n        dom: {\n          tag: 'span',\n          innerHtml: providersBackstage.translate(text),\n          classes: [prefix + '__select-label']\n        },\n        behaviours: derive$1([Replacing.config({})])\n      };\n    };\n\n    var _a;\n    var internalToolbarButtonExecute = generate$6('toolbar.button.execute');\n    var onToolbarButtonExecute = function (info) {\n      return runOnExecute$1(function (comp, _simulatedEvent) {\n        runWithApi(info, comp)(function (itemApi) {\n          emitWith(comp, internalToolbarButtonExecute, { buttonApi: itemApi });\n          info.onAction(itemApi);\n        });\n      });\n    };\n    var toolbarButtonEventOrder = (_a = {}, _a[execute$5()] = [\n      'disabling',\n      'alloy.base.behaviour',\n      'toggling',\n      'toolbar-button-events'\n    ], _a);\n\n    var updateMenuText = generate$6('update-menu-text');\n    var updateMenuIcon = generate$6('update-menu-icon');\n    var renderCommonDropdown = function (spec, prefix, sharedBackstage) {\n      var editorOffCell = Cell(noop);\n      var optMemDisplayText = spec.text.map(function (text) {\n        return record(renderLabel$1(text, prefix, sharedBackstage.providers));\n      });\n      var optMemDisplayIcon = spec.icon.map(function (iconName) {\n        return record(renderReplacableIconFromPack(iconName, sharedBackstage.providers.icons));\n      });\n      var onLeftOrRightInMenu = function (comp, se) {\n        var dropdown = Representing.getValue(comp);\n        Focusing.focus(dropdown);\n        emitWith(dropdown, 'keydown', { raw: se.event.raw });\n        Dropdown.close(dropdown);\n        return Optional.some(true);\n      };\n      var role = spec.role.fold(function () {\n        return {};\n      }, function (role) {\n        return { role: role };\n      });\n      var tooltipAttributes = spec.tooltip.fold(function () {\n        return {};\n      }, function (tooltip) {\n        var translatedTooltip = sharedBackstage.providers.translate(tooltip);\n        return {\n          'title': translatedTooltip,\n          'aria-label': translatedTooltip\n        };\n      });\n      var iconSpec = render$3('chevron-down', {\n        tag: 'div',\n        classes: [prefix + '__select-chevron']\n      }, sharedBackstage.providers.icons);\n      var memDropdown = record(Dropdown.sketch(__assign(__assign(__assign({}, spec.uid ? { uid: spec.uid } : {}), role), {\n        dom: {\n          tag: 'button',\n          classes: [\n            prefix,\n            prefix + '--select'\n          ].concat(map$2(spec.classes, function (c) {\n            return prefix + '--' + c;\n          })),\n          attributes: __assign({}, tooltipAttributes)\n        },\n        components: componentRenderPipeline([\n          optMemDisplayIcon.map(function (mem) {\n            return mem.asSpec();\n          }),\n          optMemDisplayText.map(function (mem) {\n            return mem.asSpec();\n          }),\n          Optional.some(iconSpec)\n        ]),\n        matchWidth: true,\n        useMinWidth: true,\n        dropdownBehaviours: derive$1(__spreadArray(__spreadArray([], spec.dropdownBehaviours, true), [\n          DisablingConfigs.button(function () {\n            return spec.disabled || sharedBackstage.providers.isDisabled();\n          }),\n          receivingConfig(),\n          Unselecting.config({}),\n          Replacing.config({}),\n          config('dropdown-events', [\n            onControlAttached(spec, editorOffCell),\n            onControlDetached(spec, editorOffCell)\n          ]),\n          config('menubutton-update-display-text', [\n            run$1(updateMenuText, function (comp, se) {\n              optMemDisplayText.bind(function (mem) {\n                return mem.getOpt(comp);\n              }).each(function (displayText) {\n                Replacing.set(displayText, [text(sharedBackstage.providers.translate(se.event.text))]);\n              });\n            }),\n            run$1(updateMenuIcon, function (comp, se) {\n              optMemDisplayIcon.bind(function (mem) {\n                return mem.getOpt(comp);\n              }).each(function (displayIcon) {\n                Replacing.set(displayIcon, [renderReplacableIconFromPack(se.event.icon, sharedBackstage.providers.icons)]);\n              });\n            })\n          ])\n        ], false)),\n        eventOrder: deepMerge(toolbarButtonEventOrder, {\n          mousedown: [\n            'focusing',\n            'alloy.base.behaviour',\n            'item-type-events',\n            'normal-dropdown-events'\n          ]\n        }),\n        sandboxBehaviours: derive$1([Keying.config({\n            mode: 'special',\n            onLeft: onLeftOrRightInMenu,\n            onRight: onLeftOrRightInMenu\n          })]),\n        lazySink: sharedBackstage.getSink,\n        toggleClass: prefix + '--active',\n        parts: { menu: part(false, spec.columns, spec.presets) },\n        fetch: function (comp) {\n          return Future.nu(curry(spec.fetch, comp));\n        }\n      })));\n      return memDropdown.asSpec();\n    };\n\n    var isMenuItemReference = function (item) {\n      return isString(item);\n    };\n    var isSeparator$1 = function (item) {\n      return item.type === 'separator';\n    };\n    var isExpandingMenuItem = function (item) {\n      return has$2(item, 'getSubmenuItems');\n    };\n    var separator$2 = { type: 'separator' };\n    var unwrapReferences = function (items, menuItems) {\n      var realItems = foldl(items, function (acc, item) {\n        if (isMenuItemReference(item)) {\n          if (item === '') {\n            return acc;\n          } else if (item === '|') {\n            return acc.length > 0 && !isSeparator$1(acc[acc.length - 1]) ? acc.concat([separator$2]) : acc;\n          } else if (has$2(menuItems, item.toLowerCase())) {\n            return acc.concat([menuItems[item.toLowerCase()]]);\n          } else {\n            return acc;\n          }\n        } else {\n          return acc.concat([item]);\n        }\n      }, []);\n      if (realItems.length > 0 && isSeparator$1(realItems[realItems.length - 1])) {\n        realItems.pop();\n      }\n      return realItems;\n    };\n    var getFromExpandingItem = function (item, menuItems) {\n      var submenuItems = item.getSubmenuItems();\n      var rest = expand(submenuItems, menuItems);\n      var newMenus = deepMerge(rest.menus, wrap$1(item.value, rest.items));\n      var newExpansions = deepMerge(rest.expansions, wrap$1(item.value, item.value));\n      return {\n        item: item,\n        menus: newMenus,\n        expansions: newExpansions\n      };\n    };\n    var getFromItem = function (item, menuItems) {\n      return isExpandingMenuItem(item) ? getFromExpandingItem(item, menuItems) : {\n        item: item,\n        menus: {},\n        expansions: {}\n      };\n    };\n    var generateValueIfRequired = function (item) {\n      if (isSeparator$1(item)) {\n        return item;\n      } else {\n        var itemValue = get$e(item, 'value').getOrThunk(function () {\n          return generate$6('generated-menu-item');\n        });\n        return deepMerge({ value: itemValue }, item);\n      }\n    };\n    var expand = function (items, menuItems) {\n      var realItems = unwrapReferences(isString(items) ? items.split(' ') : items, menuItems);\n      return foldr(realItems, function (acc, item) {\n        var itemWithValue = generateValueIfRequired(item);\n        var newData = getFromItem(itemWithValue, menuItems);\n        return {\n          menus: deepMerge(acc.menus, newData.menus),\n          items: [newData.item].concat(acc.items),\n          expansions: deepMerge(acc.expansions, newData.expansions)\n        };\n      }, {\n        menus: {},\n        expansions: {},\n        items: []\n      });\n    };\n\n    var build = function (items, itemResponse, backstage, isHorizontalMenu) {\n      var primary = generate$6('primary-menu');\n      var data = expand(items, backstage.shared.providers.menuItems());\n      if (data.items.length === 0) {\n        return Optional.none();\n      }\n      var mainMenu = createPartialMenu(primary, data.items, itemResponse, backstage, isHorizontalMenu);\n      var submenus = map$1(data.menus, function (menuItems, menuName) {\n        return createPartialMenu(menuName, menuItems, itemResponse, backstage, false);\n      });\n      var menus = deepMerge(submenus, wrap$1(primary, mainMenu));\n      return Optional.from(tieredMenu.tieredData(primary, menus, data.expansions));\n    };\n\n    var getMenuButtonApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        },\n        setActive: function (state) {\n          var elm = component.element;\n          if (state) {\n            add$2(elm, 'tox-tbtn--enabled');\n            set$8(elm, 'aria-pressed', true);\n          } else {\n            remove$2(elm, 'tox-tbtn--enabled');\n            remove$7(elm, 'aria-pressed');\n          }\n        },\n        isActive: function () {\n          return has(component.element, 'tox-tbtn--enabled');\n        }\n      };\n    };\n    var renderMenuButton = function (spec, prefix, backstage, role) {\n      return renderCommonDropdown({\n        text: spec.text,\n        icon: spec.icon,\n        tooltip: spec.tooltip,\n        role: role,\n        fetch: function (_comp, callback) {\n          spec.fetch(function (items) {\n            callback(build(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false));\n          });\n        },\n        onSetup: spec.onSetup,\n        getApi: getMenuButtonApi,\n        columns: 1,\n        presets: 'normal',\n        classes: [],\n        dropdownBehaviours: [Tabstopping.config({})]\n      }, prefix, backstage.shared);\n    };\n    var getFetch = function (items, getButton, backstage) {\n      var getMenuItemAction = function (item) {\n        return function (api) {\n          var newValue = !api.isActive();\n          api.setActive(newValue);\n          item.storage.set(newValue);\n          backstage.shared.getSink().each(function (sink) {\n            getButton().getOpt(sink).each(function (orig) {\n              focus$3(orig.element);\n              emitWith(orig, formActionEvent, {\n                name: item.name,\n                value: item.storage.get()\n              });\n            });\n          });\n        };\n      };\n      var getMenuItemSetup = function (item) {\n        return function (api) {\n          api.setActive(item.storage.get());\n        };\n      };\n      return function (success) {\n        success(map$2(items, function (item) {\n          var text = item.text.fold(function () {\n            return {};\n          }, function (text) {\n            return { text: text };\n          });\n          return __assign(__assign({\n            type: item.type,\n            active: false\n          }, text), {\n            onAction: getMenuItemAction(item),\n            onSetup: getMenuItemSetup(item)\n          });\n        }));\n      };\n    };\n\n    var renderCommonSpec = function (spec, actionOpt, extraBehaviours, dom, components, providersBackstage) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      var action = actionOpt.fold(function () {\n        return {};\n      }, function (action) {\n        return { action: action };\n      });\n      var common = __assign({\n        buttonBehaviours: derive$1([\n          DisablingConfigs.button(function () {\n            return spec.disabled || providersBackstage.isDisabled();\n          }),\n          receivingConfig(),\n          Tabstopping.config({}),\n          config('button press', [\n            preventDefault('click'),\n            preventDefault('mousedown')\n          ])\n        ].concat(extraBehaviours)),\n        eventOrder: {\n          click: [\n            'button press',\n            'alloy.base.behaviour'\n          ],\n          mousedown: [\n            'button press',\n            'alloy.base.behaviour'\n          ]\n        }\n      }, action);\n      var domFinal = deepMerge(common, { dom: dom });\n      return deepMerge(domFinal, { components: components });\n    };\n    var renderIconButtonSpec = function (spec, action, providersBackstage, extraBehaviours) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      var tooltipAttributes = spec.tooltip.map(function (tooltip) {\n        return {\n          'aria-label': providersBackstage.translate(tooltip),\n          'title': providersBackstage.translate(tooltip)\n        };\n      }).getOr({});\n      var dom = {\n        tag: 'button',\n        classes: ['tox-tbtn'],\n        attributes: tooltipAttributes\n      };\n      var icon = spec.icon.map(function (iconName) {\n        return renderIconFromPack(iconName, providersBackstage.icons);\n      });\n      var components = componentRenderPipeline([icon]);\n      return renderCommonSpec(spec, action, extraBehaviours, dom, components, providersBackstage);\n    };\n    var renderIconButton = function (spec, action, providersBackstage, extraBehaviours) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      var iconButtonSpec = renderIconButtonSpec(spec, Optional.some(action), providersBackstage, extraBehaviours);\n      return Button.sketch(iconButtonSpec);\n    };\n    var renderButtonSpec = function (spec, action, providersBackstage, extraBehaviours, extraClasses) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      if (extraClasses === void 0) {\n        extraClasses = [];\n      }\n      var translatedText = providersBackstage.translate(spec.text);\n      var icon = spec.icon ? spec.icon.map(function (iconName) {\n        return renderIconFromPack(iconName, providersBackstage.icons);\n      }) : Optional.none();\n      var components = icon.isSome() ? componentRenderPipeline([icon]) : [];\n      var innerHtml = icon.isSome() ? {} : { innerHtml: translatedText };\n      var classes = __spreadArray(__spreadArray(__spreadArray(__spreadArray([], !spec.primary && !spec.borderless ? [\n        'tox-button',\n        'tox-button--secondary'\n      ] : ['tox-button'], true), icon.isSome() ? ['tox-button--icon'] : [], true), spec.borderless ? ['tox-button--naked'] : [], true), extraClasses, true);\n      var dom = __assign(__assign({\n        tag: 'button',\n        classes: classes\n      }, innerHtml), { attributes: { title: translatedText } });\n      return renderCommonSpec(spec, action, extraBehaviours, dom, components, providersBackstage);\n    };\n    var renderButton = function (spec, action, providersBackstage, extraBehaviours, extraClasses) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      if (extraClasses === void 0) {\n        extraClasses = [];\n      }\n      var buttonSpec = renderButtonSpec(spec, Optional.some(action), providersBackstage, extraBehaviours, extraClasses);\n      return Button.sketch(buttonSpec);\n    };\n    var getAction = function (name, buttonType) {\n      return function (comp) {\n        if (buttonType === 'custom') {\n          emitWith(comp, formActionEvent, {\n            name: name,\n            value: {}\n          });\n        } else if (buttonType === 'submit') {\n          emit(comp, formSubmitEvent);\n        } else if (buttonType === 'cancel') {\n          emit(comp, formCancelEvent);\n        } else {\n          console.error('Unknown button type: ', buttonType);\n        }\n      };\n    };\n    var isMenuFooterButtonSpec = function (spec, buttonType) {\n      return buttonType === 'menu';\n    };\n    var isNormalFooterButtonSpec = function (spec, buttonType) {\n      return buttonType === 'custom' || buttonType === 'cancel' || buttonType === 'submit';\n    };\n    var renderFooterButton = function (spec, buttonType, backstage) {\n      if (isMenuFooterButtonSpec(spec, buttonType)) {\n        var getButton = function () {\n          return memButton_1;\n        };\n        var menuButtonSpec = spec;\n        var fixedSpec = __assign(__assign({}, spec), {\n          onSetup: function (api) {\n            api.setDisabled(spec.disabled);\n            return noop;\n          },\n          fetch: getFetch(menuButtonSpec.items, getButton, backstage)\n        });\n        var memButton_1 = record(renderMenuButton(fixedSpec, 'tox-tbtn', backstage, Optional.none()));\n        return memButton_1.asSpec();\n      } else if (isNormalFooterButtonSpec(spec, buttonType)) {\n        var action = getAction(spec.name, buttonType);\n        var buttonSpec = __assign(__assign({}, spec), { borderless: false });\n        return renderButton(buttonSpec, action, backstage.shared.providers, []);\n      } else {\n        console.error('Unknown footer button type: ', buttonType);\n      }\n    };\n    var renderDialogButton = function (spec, providersBackstage) {\n      var action = getAction(spec.name, 'custom');\n      return renderFormField(Optional.none(), FormField.parts.field(__assign({ factory: Button }, renderButtonSpec(spec, Optional.some(action), providersBackstage, [\n        RepresentingConfigs.memory(''),\n        ComposingConfigs.self()\n      ]))));\n    };\n\n    var schema$h = constant$1([\n      defaulted('field1Name', 'field1'),\n      defaulted('field2Name', 'field2'),\n      onStrictHandler('onLockedChange'),\n      markers$1(['lockClass']),\n      defaulted('locked', false),\n      SketchBehaviours.field('coupledFieldBehaviours', [\n        Composing,\n        Representing\n      ])\n    ]);\n    var getField = function (comp, detail, partName) {\n      return getPart(comp, detail, partName).bind(Composing.getCurrent);\n    };\n    var coupledPart = function (selfName, otherName) {\n      return required({\n        factory: FormField,\n        name: selfName,\n        overrides: function (detail) {\n          return {\n            fieldBehaviours: derive$1([config('coupled-input-behaviour', [run$1(input(), function (me) {\n                  getField(me, detail, otherName).each(function (other) {\n                    getPart(me, detail, 'lock').each(function (lock) {\n                      if (Toggling.isOn(lock)) {\n                        detail.onLockedChange(me, other, lock);\n                      }\n                    });\n                  });\n                })])])\n          };\n        }\n      });\n    };\n    var parts$c = constant$1([\n      coupledPart('field1', 'field2'),\n      coupledPart('field2', 'field1'),\n      required({\n        factory: Button,\n        schema: [required$1('dom')],\n        name: 'lock',\n        overrides: function (detail) {\n          return {\n            buttonBehaviours: derive$1([Toggling.config({\n                selected: detail.locked,\n                toggleClass: detail.markers.lockClass,\n                aria: { mode: 'pressed' }\n              })])\n          };\n        }\n      })\n    ]);\n\n    var factory$f = function (detail, components, _spec, _externals) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: SketchBehaviours.augment(detail.coupledFieldBehaviours, [\n          Composing.config({ find: Optional.some }),\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (comp) {\n                var _a;\n                var parts = getPartsOrDie(comp, detail, [\n                  'field1',\n                  'field2'\n                ]);\n                return _a = {}, _a[detail.field1Name] = Representing.getValue(parts.field1()), _a[detail.field2Name] = Representing.getValue(parts.field2()), _a;\n              },\n              setValue: function (comp, value) {\n                var parts = getPartsOrDie(comp, detail, [\n                  'field1',\n                  'field2'\n                ]);\n                if (hasNonNullableKey(value, detail.field1Name)) {\n                  Representing.setValue(parts.field1(), value[detail.field1Name]);\n                }\n                if (hasNonNullableKey(value, detail.field2Name)) {\n                  Representing.setValue(parts.field2(), value[detail.field2Name]);\n                }\n              }\n            }\n          })\n        ]),\n        apis: {\n          getField1: function (component) {\n            return getPart(component, detail, 'field1');\n          },\n          getField2: function (component) {\n            return getPart(component, detail, 'field2');\n          },\n          getLock: function (component) {\n            return getPart(component, detail, 'lock');\n          }\n        }\n      };\n    };\n    var FormCoupledInputs = composite({\n      name: 'FormCoupledInputs',\n      configFields: schema$h(),\n      partFields: parts$c(),\n      factory: factory$f,\n      apis: {\n        getField1: function (apis, component) {\n          return apis.getField1(component);\n        },\n        getField2: function (apis, component) {\n          return apis.getField2(component);\n        },\n        getLock: function (apis, component) {\n          return apis.getLock(component);\n        }\n      }\n    });\n\n    var formatSize = function (size) {\n      var unitDec = {\n        '': 0,\n        'px': 0,\n        'pt': 1,\n        'mm': 1,\n        'pc': 2,\n        'ex': 2,\n        'em': 2,\n        'ch': 2,\n        'rem': 2,\n        'cm': 3,\n        'in': 4,\n        '%': 4\n      };\n      var maxDecimal = function (unit) {\n        return unit in unitDec ? unitDec[unit] : 1;\n      };\n      var numText = size.value.toFixed(maxDecimal(size.unit));\n      if (numText.indexOf('.') !== -1) {\n        numText = numText.replace(/\\.?0*$/, '');\n      }\n      return numText + size.unit;\n    };\n    var parseSize = function (sizeText) {\n      var numPattern = /^\\s*(\\d+(?:\\.\\d+)?)\\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\\s*$/;\n      var match = numPattern.exec(sizeText);\n      if (match !== null) {\n        var value = parseFloat(match[1]);\n        var unit = match[2];\n        return Result.value({\n          value: value,\n          unit: unit\n        });\n      } else {\n        return Result.error(sizeText);\n      }\n    };\n    var convertUnit = function (size, unit) {\n      var inInch = {\n        '': 96,\n        'px': 96,\n        'pt': 72,\n        'cm': 2.54,\n        'pc': 12,\n        'mm': 25.4,\n        'in': 1\n      };\n      var supported = function (u) {\n        return has$2(inInch, u);\n      };\n      if (size.unit === unit) {\n        return Optional.some(size.value);\n      } else if (supported(size.unit) && supported(unit)) {\n        if (inInch[size.unit] === inInch[unit]) {\n          return Optional.some(size.value);\n        } else {\n          return Optional.some(size.value / inInch[size.unit] * inInch[unit]);\n        }\n      } else {\n        return Optional.none();\n      }\n    };\n    var noSizeConversion = function (_input) {\n      return Optional.none();\n    };\n    var ratioSizeConversion = function (scale, unit) {\n      return function (size) {\n        return convertUnit(size, unit).map(function (value) {\n          return {\n            value: value * scale,\n            unit: unit\n          };\n        });\n      };\n    };\n    var makeRatioConverter = function (currentFieldText, otherFieldText) {\n      var cValue = parseSize(currentFieldText).toOptional();\n      var oValue = parseSize(otherFieldText).toOptional();\n      return lift2(cValue, oValue, function (cSize, oSize) {\n        return convertUnit(cSize, oSize.unit).map(function (val) {\n          return oSize.value / val;\n        }).map(function (r) {\n          return ratioSizeConversion(r, oSize.unit);\n        }).getOr(noSizeConversion);\n      }).getOr(noSizeConversion);\n    };\n\n    var renderSizeInput = function (spec, providersBackstage) {\n      var converter = noSizeConversion;\n      var ratioEvent = generate$6('ratio-event');\n      var makeIcon = function (iconName) {\n        return render$3(iconName, {\n          tag: 'span',\n          classes: [\n            'tox-icon',\n            'tox-lock-icon__' + iconName\n          ]\n        }, providersBackstage.icons);\n      };\n      var pLock = FormCoupledInputs.parts.lock({\n        dom: {\n          tag: 'button',\n          classes: [\n            'tox-lock',\n            'tox-button',\n            'tox-button--naked',\n            'tox-button--icon'\n          ],\n          attributes: { title: providersBackstage.translate(spec.label.getOr('Constrain proportions')) }\n        },\n        components: [\n          makeIcon('lock'),\n          makeIcon('unlock')\n        ],\n        buttonBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isDisabled();\n            }\n          }),\n          receivingConfig(),\n          Tabstopping.config({})\n        ])\n      });\n      var formGroup = function (components) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-form__group']\n          },\n          components: components\n        };\n      };\n      var getFieldPart = function (isField1) {\n        return FormField.parts.field({\n          factory: Input,\n          inputClasses: ['tox-textfield'],\n          inputBehaviours: derive$1([\n            Disabling.config({\n              disabled: function () {\n                return spec.disabled || providersBackstage.isDisabled();\n              }\n            }),\n            receivingConfig(),\n            Tabstopping.config({}),\n            config('size-input-events', [\n              run$1(focusin(), function (component, _simulatedEvent) {\n                emitWith(component, ratioEvent, { isField1: isField1 });\n              }),\n              run$1(change(), function (component, _simulatedEvent) {\n                emitWith(component, formChangeEvent, { name: spec.name });\n              })\n            ])\n          ]),\n          selectOnFocus: false\n        });\n      };\n      var getLabel = function (label) {\n        return {\n          dom: {\n            tag: 'label',\n            classes: ['tox-label'],\n            innerHtml: providersBackstage.translate(label)\n          }\n        };\n      };\n      var widthField = FormCoupledInputs.parts.field1(formGroup([\n        FormField.parts.label(getLabel('Width')),\n        getFieldPart(true)\n      ]));\n      var heightField = FormCoupledInputs.parts.field2(formGroup([\n        FormField.parts.label(getLabel('Height')),\n        getFieldPart(false)\n      ]));\n      return FormCoupledInputs.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-form__controls-h-stack']\n            },\n            components: [\n              widthField,\n              heightField,\n              formGroup([\n                getLabel('&nbsp;'),\n                pLock\n              ])\n            ]\n          }],\n        field1Name: 'width',\n        field2Name: 'height',\n        locked: true,\n        markers: { lockClass: 'tox-locked' },\n        onLockedChange: function (current, other, _lock) {\n          parseSize(Representing.getValue(current)).each(function (size) {\n            converter(size).each(function (newSize) {\n              Representing.setValue(other, formatSize(newSize));\n            });\n          });\n        },\n        coupledFieldBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isDisabled();\n            },\n            onDisabled: function (comp) {\n              FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.disable);\n              FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.disable);\n              FormCoupledInputs.getLock(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.enable);\n              FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.enable);\n              FormCoupledInputs.getLock(comp).each(Disabling.enable);\n            }\n          }),\n          receivingConfig(),\n          config('size-input-events2', [run$1(ratioEvent, function (component, simulatedEvent) {\n              var isField1 = simulatedEvent.event.isField1;\n              var optCurrent = isField1 ? FormCoupledInputs.getField1(component) : FormCoupledInputs.getField2(component);\n              var optOther = isField1 ? FormCoupledInputs.getField2(component) : FormCoupledInputs.getField1(component);\n              var value1 = optCurrent.map(Representing.getValue).getOr('');\n              var value2 = optOther.map(Representing.getValue).getOr('');\n              converter = makeRatioConverter(value1, value2);\n            })])\n        ])\n      });\n    };\n\n    var undo = constant$1(generate$6('undo'));\n    var redo = constant$1(generate$6('redo'));\n    var zoom = constant$1(generate$6('zoom'));\n    var back = constant$1(generate$6('back'));\n    var apply = constant$1(generate$6('apply'));\n    var swap = constant$1(generate$6('swap'));\n    var transform$1 = constant$1(generate$6('transform'));\n    var tempTransform = constant$1(generate$6('temp-transform'));\n    var transformApply = constant$1(generate$6('transform-apply'));\n    var internal = {\n      undo: undo,\n      redo: redo,\n      zoom: zoom,\n      back: back,\n      apply: apply,\n      swap: swap,\n      transform: transform$1,\n      tempTransform: tempTransform,\n      transformApply: transformApply\n    };\n    var saveState = constant$1('save-state');\n    var disable = constant$1('disable');\n    var enable = constant$1('enable');\n    var external = {\n      formActionEvent: formActionEvent,\n      saveState: saveState,\n      disable: disable,\n      enable: enable\n    };\n\n    var renderEditPanel = function (imagePanel, providersBackstage) {\n      var createButton = function (text, action, disabled, primary) {\n        return record(renderButton({\n          name: text,\n          text: text,\n          disabled: disabled,\n          primary: primary,\n          icon: Optional.none(),\n          borderless: false\n        }, action, providersBackstage));\n      };\n      var createIconButton = function (icon, tooltip, action, disabled) {\n        return record(renderIconButton({\n          name: icon,\n          icon: Optional.some(icon),\n          tooltip: Optional.some(tooltip),\n          disabled: disabled,\n          primary: false,\n          borderless: false\n        }, action, providersBackstage));\n      };\n      var disableAllComponents = function (comps, eventcomp) {\n        comps.map(function (mem) {\n          var component = mem.get(eventcomp);\n          if (component.hasConfigured(Disabling)) {\n            Disabling.disable(component);\n          }\n        });\n      };\n      var enableAllComponents = function (comps, eventcomp) {\n        comps.map(function (mem) {\n          var component = mem.get(eventcomp);\n          if (component.hasConfigured(Disabling)) {\n            Disabling.enable(component);\n          }\n        });\n      };\n      var panelDom = {\n        tag: 'div',\n        classes: [\n          'tox-image-tools__toolbar',\n          'tox-image-tools-edit-panel'\n        ]\n      };\n      var noop$1 = noop;\n      var emit$1 = function (comp, event, data) {\n        emitWith(comp, event, data);\n      };\n      var emitDisable = function (component) {\n        return emit(component, external.disable());\n      };\n      var emitEnable = function (component) {\n        return emit(component, external.enable());\n      };\n      var emitTransform = function (comp, transform) {\n        emitDisable(comp);\n        emit$1(comp, internal.transform(), { transform: transform });\n        emitEnable(comp);\n      };\n      var emitTempTransform = function (comp, transform) {\n        emitDisable(comp);\n        emit$1(comp, internal.tempTransform(), { transform: transform });\n        emitEnable(comp);\n      };\n      var getBackSwap = function (anyInSystem) {\n        return function () {\n          memContainer.getOpt(anyInSystem).each(function (container) {\n            Replacing.set(container, [ButtonPanel]);\n          });\n        };\n      };\n      var emitTransformApply = function (comp, transform) {\n        emitDisable(comp);\n        emit$1(comp, internal.transformApply(), {\n          transform: transform,\n          swap: getBackSwap(comp)\n        });\n        emitEnable(comp);\n      };\n      var createBackButton = function () {\n        return createButton('Back', function (button) {\n          return emit$1(button, internal.back(), { swap: getBackSwap(button) });\n        }, false, false);\n      };\n      var createSpacer = function () {\n        return record({\n          dom: {\n            tag: 'div',\n            classes: ['tox-spacer']\n          },\n          behaviours: derive$1([Disabling.config({})])\n        });\n      };\n      var createApplyButton = function () {\n        return createButton('Apply', function (button) {\n          return emit$1(button, internal.apply(), { swap: getBackSwap(button) });\n        }, true, true);\n      };\n      var makeCropTransform = function () {\n        return function (ir) {\n          var rect = imagePanel.getRect();\n          return crop(ir, rect.x, rect.y, rect.w, rect.h);\n        };\n      };\n      var cropPanelComponents = [\n        createBackButton(),\n        createSpacer(),\n        createButton('Apply', function (button) {\n          var transform = makeCropTransform();\n          emitTransformApply(button, transform);\n          imagePanel.hideCrop();\n        }, false, true)\n      ];\n      var CropPanel = Container.sketch({\n        dom: panelDom,\n        components: cropPanelComponents.map(function (mem) {\n          return mem.asSpec();\n        }),\n        containerBehaviours: derive$1([config('image-tools-crop-buttons-events', [\n            run$1(external.disable(), function (comp, _se) {\n              disableAllComponents(cropPanelComponents, comp);\n            }),\n            run$1(external.enable(), function (comp, _se) {\n              enableAllComponents(cropPanelComponents, comp);\n            })\n          ])])\n      });\n      var memSize = record(renderSizeInput({\n        name: 'size',\n        label: Optional.none(),\n        constrain: true,\n        disabled: false\n      }, providersBackstage));\n      var makeResizeTransform = function (width, height) {\n        return function (ir) {\n          return resize$1(ir, width, height);\n        };\n      };\n      var resizePanelComponents = [\n        createBackButton(),\n        createSpacer(),\n        memSize,\n        createSpacer(),\n        createButton('Apply', function (button) {\n          memSize.getOpt(button).each(function (sizeInput) {\n            var value = Representing.getValue(sizeInput);\n            var width = parseInt(value.width, 10);\n            var height = parseInt(value.height, 10);\n            var transform = makeResizeTransform(width, height);\n            emitTransformApply(button, transform);\n          });\n        }, false, true)\n      ];\n      var ResizePanel = Container.sketch({\n        dom: panelDom,\n        components: resizePanelComponents.map(function (mem) {\n          return mem.asSpec();\n        }),\n        containerBehaviours: derive$1([config('image-tools-resize-buttons-events', [\n            run$1(external.disable(), function (comp, _se) {\n              disableAllComponents(resizePanelComponents, comp);\n            }),\n            run$1(external.enable(), function (comp, _se) {\n              enableAllComponents(resizePanelComponents, comp);\n            })\n          ])])\n      });\n      var makeValueTransform = function (transform, value) {\n        return function (ir) {\n          return transform(ir, value);\n        };\n      };\n      var horizontalFlip = makeValueTransform(flip, 'h');\n      var verticalFlip = makeValueTransform(flip, 'v');\n      var counterclockwiseRotate = makeValueTransform(rotate, -90);\n      var clockwiseRotate = makeValueTransform(rotate, 90);\n      var flipRotateOnAction = function (comp, operation) {\n        emitTempTransform(comp, operation);\n      };\n      var flipRotateComponents = [\n        createBackButton(),\n        createSpacer(),\n        createIconButton('flip-horizontally', 'Flip horizontally', function (button) {\n          flipRotateOnAction(button, horizontalFlip);\n        }, false),\n        createIconButton('flip-vertically', 'Flip vertically', function (button) {\n          flipRotateOnAction(button, verticalFlip);\n        }, false),\n        createIconButton('rotate-left', 'Rotate counterclockwise', function (button) {\n          flipRotateOnAction(button, counterclockwiseRotate);\n        }, false),\n        createIconButton('rotate-right', 'Rotate clockwise', function (button) {\n          flipRotateOnAction(button, clockwiseRotate);\n        }, false),\n        createSpacer(),\n        createApplyButton()\n      ];\n      var FlipRotatePanel = Container.sketch({\n        dom: panelDom,\n        components: flipRotateComponents.map(function (mem) {\n          return mem.asSpec();\n        }),\n        containerBehaviours: derive$1([config('image-tools-fliprotate-buttons-events', [\n            run$1(external.disable(), function (comp, _se) {\n              disableAllComponents(flipRotateComponents, comp);\n            }),\n            run$1(external.enable(), function (comp, _se) {\n              enableAllComponents(flipRotateComponents, comp);\n            })\n          ])])\n      });\n      var makeSlider = function (label, onChoose, min, value, max) {\n        var labelPart = Slider.parts.label({\n          dom: {\n            tag: 'label',\n            classes: ['tox-label'],\n            innerHtml: providersBackstage.translate(label)\n          }\n        });\n        var spectrum = Slider.parts.spectrum({\n          dom: {\n            tag: 'div',\n            classes: ['tox-slider__rail'],\n            attributes: { role: 'presentation' }\n          }\n        });\n        var thumb = Slider.parts.thumb({\n          dom: {\n            tag: 'div',\n            classes: ['tox-slider__handle'],\n            attributes: { role: 'presentation' }\n          }\n        });\n        return record(Slider.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-slider'],\n            attributes: { role: 'presentation' }\n          },\n          model: {\n            mode: 'x',\n            minX: min,\n            maxX: max,\n            getInitialValue: constant$1({ x: value })\n          },\n          components: [\n            labelPart,\n            spectrum,\n            thumb\n          ],\n          sliderBehaviours: derive$1([Focusing.config({})]),\n          onChoose: onChoose\n        }));\n      };\n      var makeVariableSlider = function (label, transform, min, value, max) {\n        var onChoose = function (slider, _thumb, value) {\n          var valTransform = makeValueTransform(transform, value.x / 100);\n          emitTransform(slider, valTransform);\n        };\n        return makeSlider(label, onChoose, min, value, max);\n      };\n      var variableFilterPanelComponents = function (label, transform, min, value, max) {\n        return [\n          createBackButton(),\n          makeVariableSlider(label, transform, min, value, max),\n          createApplyButton()\n        ];\n      };\n      var createVariableFilterPanel = function (label, transform, min, value, max) {\n        var filterPanelComponents = variableFilterPanelComponents(label, transform, min, value, max);\n        return Container.sketch({\n          dom: panelDom,\n          components: filterPanelComponents.map(function (mem) {\n            return mem.asSpec();\n          }),\n          containerBehaviours: derive$1([config('image-tools-filter-panel-buttons-events', [\n              run$1(external.disable(), function (comp, _se) {\n                disableAllComponents(filterPanelComponents, comp);\n              }),\n              run$1(external.enable(), function (comp, _se) {\n                enableAllComponents(filterPanelComponents, comp);\n              })\n            ])])\n        });\n      };\n      var filterPanelComponents = [\n        createBackButton(),\n        createSpacer(),\n        createApplyButton()\n      ];\n      var FilterPanel = Container.sketch({\n        dom: panelDom,\n        components: filterPanelComponents.map(function (mem) {\n          return mem.asSpec();\n        })\n      });\n      var BrightnessPanel = createVariableFilterPanel('Brightness', brightness, -100, 0, 100);\n      var ContrastPanel = createVariableFilterPanel('Contrast', contrast, -100, 0, 100);\n      var GammaPanel = createVariableFilterPanel('Gamma', gamma, -100, 0, 100);\n      var makeColorTransform = function (red, green, blue) {\n        return function (ir) {\n          return colorize(ir, red, green, blue);\n        };\n      };\n      var makeColorSlider = function (label) {\n        var onChoose = function (slider, _thumb, _value) {\n          var redOpt = memRed.getOpt(slider);\n          var blueOpt = memBlue.getOpt(slider);\n          var greenOpt = memGreen.getOpt(slider);\n          redOpt.each(function (red) {\n            blueOpt.each(function (blue) {\n              greenOpt.each(function (green) {\n                var r = Representing.getValue(red).x / 100;\n                var g = Representing.getValue(green).x / 100;\n                var b = Representing.getValue(blue).x / 100;\n                var transform = makeColorTransform(r, g, b);\n                emitTransform(slider, transform);\n              });\n            });\n          });\n        };\n        return makeSlider(label, onChoose, 0, 100, 200);\n      };\n      var memRed = makeColorSlider('R');\n      var memGreen = makeColorSlider('G');\n      var memBlue = makeColorSlider('B');\n      var colorizePanelComponents = [\n        createBackButton(),\n        memRed,\n        memGreen,\n        memBlue,\n        createApplyButton()\n      ];\n      var ColorizePanel = Container.sketch({\n        dom: panelDom,\n        components: colorizePanelComponents.map(function (mem) {\n          return mem.asSpec();\n        })\n      });\n      var getTransformPanelEvent = function (panel, transform, update) {\n        return function (button) {\n          var swap = function () {\n            memContainer.getOpt(button).each(function (container) {\n              Replacing.set(container, [panel]);\n              update(container);\n            });\n          };\n          emit$1(button, internal.swap(), {\n            transform: transform,\n            swap: swap\n          });\n        };\n      };\n      var cropPanelUpdate = function (_anyInSystem) {\n        imagePanel.showCrop();\n      };\n      var resizePanelUpdate = function (anyInSystem) {\n        memSize.getOpt(anyInSystem).each(function (sizeInput) {\n          var measurements = imagePanel.getMeasurements();\n          var width = measurements.width;\n          var height = measurements.height;\n          Representing.setValue(sizeInput, {\n            width: width,\n            height: height\n          });\n        });\n      };\n      var sharpenTransform = Optional.some(sharpen);\n      var invertTransform = Optional.some(invert);\n      var buttonPanelComponents = [\n        createIconButton('crop', 'Crop', getTransformPanelEvent(CropPanel, Optional.none(), cropPanelUpdate), false),\n        createIconButton('resize', 'Resize', getTransformPanelEvent(ResizePanel, Optional.none(), resizePanelUpdate), false),\n        createIconButton('orientation', 'Orientation', getTransformPanelEvent(FlipRotatePanel, Optional.none(), noop$1), false),\n        createIconButton('brightness', 'Brightness', getTransformPanelEvent(BrightnessPanel, Optional.none(), noop$1), false),\n        createIconButton('sharpen', 'Sharpen', getTransformPanelEvent(FilterPanel, sharpenTransform, noop$1), false),\n        createIconButton('contrast', 'Contrast', getTransformPanelEvent(ContrastPanel, Optional.none(), noop$1), false),\n        createIconButton('color-levels', 'Color levels', getTransformPanelEvent(ColorizePanel, Optional.none(), noop$1), false),\n        createIconButton('gamma', 'Gamma', getTransformPanelEvent(GammaPanel, Optional.none(), noop$1), false),\n        createIconButton('invert', 'Invert', getTransformPanelEvent(FilterPanel, invertTransform, noop$1), false)\n      ];\n      var ButtonPanel = Container.sketch({\n        dom: panelDom,\n        components: buttonPanelComponents.map(function (mem) {\n          return mem.asSpec();\n        })\n      });\n      var container = Container.sketch({\n        dom: { tag: 'div' },\n        components: [ButtonPanel],\n        containerBehaviours: derive$1([Replacing.config({})])\n      });\n      var memContainer = record(container);\n      var getApplyButton = function (anyInSystem) {\n        return memContainer.getOpt(anyInSystem).map(function (container) {\n          var panel = container.components()[0];\n          return panel.components()[panel.components().length - 1];\n        });\n      };\n      return {\n        memContainer: memContainer,\n        getApplyButton: getApplyButton\n      };\n    };\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.geom.Rect');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.Observable');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var getDocumentSize = function (doc) {\n      var max = Math.max;\n      var documentElement = doc.documentElement;\n      var body = doc.body;\n      var scrollWidth = max(documentElement.scrollWidth, body.scrollWidth);\n      var clientWidth = max(documentElement.clientWidth, body.clientWidth);\n      var offsetWidth = max(documentElement.offsetWidth, body.offsetWidth);\n      var scrollHeight = max(documentElement.scrollHeight, body.scrollHeight);\n      var clientHeight = max(documentElement.clientHeight, body.clientHeight);\n      var offsetHeight = max(documentElement.offsetHeight, body.offsetHeight);\n      return {\n        width: scrollWidth < offsetWidth ? clientWidth : scrollWidth,\n        height: scrollHeight < offsetHeight ? clientHeight : scrollHeight\n      };\n    };\n    var isTouchEvent$1 = function (e) {\n      return isNonNullable(e.changedTouches);\n    };\n    var updateWithTouchData = function (e) {\n      if (isTouchEvent$1(e)) {\n        var keys = 'screenX screenY pageX pageY clientX clientY'.split(' ');\n        for (var i = 0; i < keys.length; i++) {\n          e[keys[i]] = e.changedTouches[0][keys[i]];\n        }\n      }\n    };\n    function DragHelper (id, settings) {\n      var _a, _b, _c;\n      var eventOverlay;\n      var handleEvents = [];\n      var overlayEvents = [];\n      var doc = (_a = settings.document) !== null && _a !== void 0 ? _a : document;\n      var root = (_b = settings.root) !== null && _b !== void 0 ? _b : doc;\n      var sugarDoc = SugarElement.fromDom(doc);\n      var downButton;\n      var startX;\n      var startY;\n      var handleElement = SugarElement.fromDom(root.getElementById((_c = settings.handle) !== null && _c !== void 0 ? _c : id));\n      var start = function (e) {\n        var rawEvent = e.raw;\n        var docSize = getDocumentSize(doc);\n        updateWithTouchData(rawEvent);\n        e.prevent();\n        downButton = rawEvent.button;\n        startX = rawEvent.screenX;\n        startY = rawEvent.screenY;\n        var cursor = get$c(handleElement, 'cursor');\n        eventOverlay = SugarElement.fromTag('div', doc);\n        setAll(eventOverlay, {\n          'position': 'absolute',\n          'top': '0',\n          'left': '0',\n          'width': docSize.width + 'px',\n          'height': docSize.height + 'px',\n          'z-index': 2147483647 + '',\n          'opacity': '0.0001',\n          cursor: cursor\n        });\n        append$2(getBody(sugarDoc), eventOverlay);\n        overlayEvents.push(bind(sugarDoc, 'mousemove', drag), bind(sugarDoc, 'touchmove', drag), bind(sugarDoc, 'mouseup', stop), bind(sugarDoc, 'touchend', stop));\n        settings.start(rawEvent);\n      };\n      var drag = function (e) {\n        var rawEvent = e.raw;\n        updateWithTouchData(rawEvent);\n        if (rawEvent.button !== downButton) {\n          return stop(e);\n        }\n        rawEvent.deltaX = rawEvent.screenX - startX;\n        rawEvent.deltaY = rawEvent.screenY - startY;\n        e.prevent();\n        settings.drag(rawEvent);\n      };\n      var stop = function (e) {\n        updateWithTouchData(e.raw);\n        each$1(overlayEvents, function (e) {\n          return e.unbind();\n        });\n        overlayEvents = [];\n        remove$5(eventOverlay);\n        if (settings.stop) {\n          settings.stop(e.raw);\n        }\n      };\n      var destroy = function () {\n        each$1(overlayEvents.concat(handleEvents), function (e) {\n          return e.unbind();\n        });\n        overlayEvents = [];\n        handleEvents = [];\n        if (isNonNullable(eventOverlay)) {\n          remove$5(eventOverlay);\n        }\n      };\n      handleEvents.push(bind(handleElement, 'mousedown', start), bind(handleElement, 'touchstart', start));\n      return { destroy: destroy };\n    }\n\n    var count = 0;\n    var create$1 = function (currentRect, viewPortRect, clampRect, containerElm, action) {\n      var dragHelpers;\n      var events = [];\n      var prefix = 'tox-';\n      var id = prefix + 'crid-' + count++;\n      var container = SugarElement.fromDom(containerElm);\n      var handles = [\n        {\n          name: 'move',\n          xMul: 0,\n          yMul: 0,\n          deltaX: 1,\n          deltaY: 1,\n          deltaW: 0,\n          deltaH: 0,\n          label: 'Crop Mask'\n        },\n        {\n          name: 'nw',\n          xMul: 0,\n          yMul: 0,\n          deltaX: 1,\n          deltaY: 1,\n          deltaW: -1,\n          deltaH: -1,\n          label: 'Top Left Crop Handle'\n        },\n        {\n          name: 'ne',\n          xMul: 1,\n          yMul: 0,\n          deltaX: 0,\n          deltaY: 1,\n          deltaW: 1,\n          deltaH: -1,\n          label: 'Top Right Crop Handle'\n        },\n        {\n          name: 'sw',\n          xMul: 0,\n          yMul: 1,\n          deltaX: 1,\n          deltaY: 0,\n          deltaW: -1,\n          deltaH: 1,\n          label: 'Bottom Left Crop Handle'\n        },\n        {\n          name: 'se',\n          xMul: 1,\n          yMul: 1,\n          deltaX: 0,\n          deltaY: 0,\n          deltaW: 1,\n          deltaH: 1,\n          label: 'Bottom Right Crop Handle'\n        }\n      ];\n      var blockers = [\n        'top',\n        'right',\n        'bottom',\n        'left'\n      ];\n      var getAbsoluteRect = function (outerRect, relativeRect) {\n        return {\n          x: relativeRect.x + outerRect.x,\n          y: relativeRect.y + outerRect.y,\n          w: relativeRect.w,\n          h: relativeRect.h\n        };\n      };\n      var getRelativeRect = function (outerRect, innerRect) {\n        return {\n          x: innerRect.x - outerRect.x,\n          y: innerRect.y - outerRect.y,\n          w: innerRect.w,\n          h: innerRect.h\n        };\n      };\n      var getInnerRect = function () {\n        return getRelativeRect(clampRect, currentRect);\n      };\n      var moveRect = function (handle, startRect, deltaX, deltaY) {\n        var x = startRect.x + deltaX * handle.deltaX;\n        var y = startRect.y + deltaY * handle.deltaY;\n        var w = Math.max(20, startRect.w + deltaX * handle.deltaW);\n        var h = Math.max(20, startRect.h + deltaY * handle.deltaH);\n        var rect = currentRect = global$4.clamp({\n          x: x,\n          y: y,\n          w: w,\n          h: h\n        }, clampRect, handle.name === 'move');\n        rect = getRelativeRect(clampRect, rect);\n        instance.fire('updateRect', { rect: rect });\n        setInnerRect(rect);\n      };\n      var render = function () {\n        var createDragHelper = function (handle) {\n          var startRect;\n          return DragHelper(id, {\n            document: containerElm.ownerDocument,\n            root: getRootNode(container).dom,\n            handle: id + '-' + handle.name,\n            start: function () {\n              startRect = currentRect;\n            },\n            drag: function (e) {\n              moveRect(handle, startRect, e.deltaX, e.deltaY);\n            }\n          });\n        };\n        var cropContainer = SugarElement.fromTag('div');\n        setAll$1(cropContainer, {\n          id: id,\n          'class': prefix + 'croprect-container',\n          'role': 'grid',\n          'aria-dropeffect': 'execute'\n        });\n        append$2(container, cropContainer);\n        each$1(blockers, function (blocker) {\n          descendant(container, '#' + id).each(function (blockerElm) {\n            var cropBlocker = SugarElement.fromTag('div');\n            setAll$1(cropBlocker, {\n              'id': id + '-' + blocker,\n              'class': prefix + 'croprect-block',\n              'data-mce-bogus': 'all'\n            });\n            set$7(cropBlocker, 'display', 'none');\n            append$2(blockerElm, cropBlocker);\n          });\n        });\n        each$1(handles, function (handle) {\n          descendant(container, '#' + id).each(function (handleElm) {\n            var cropHandle = SugarElement.fromTag('div');\n            setAll$1(cropHandle, {\n              'id': id + '-' + handle.name,\n              'aria-label': handle.label,\n              'aria-grabbed': 'false',\n              'data-mce-bogus': 'all',\n              'role': 'gridcell',\n              'tabindex': '-1',\n              'title': handle.label\n            });\n            add$1(cropHandle, [\n              prefix + 'croprect-handle',\n              prefix + 'croprect-handle-' + handle.name\n            ]);\n            set$7(cropHandle, 'display', 'none');\n            append$2(handleElm, cropHandle);\n          });\n        });\n        dragHelpers = map$2(handles, createDragHelper);\n        repaint(currentRect);\n        var handleFocus = function (e) {\n          set$8(e.target, 'aria-grabbed', e.raw.type === 'focus' ? 'true' : 'false');\n        };\n        var handleKeydown = function (e) {\n          var activeHandle;\n          each$1(handles, function (handle) {\n            if (get$d(e.target, 'id') === id + '-' + handle.name) {\n              activeHandle = handle;\n              return false;\n            }\n          });\n          var moveAndBlock = function (evt, handle, startRect, deltaX, deltaY) {\n            evt.stopPropagation();\n            evt.preventDefault();\n            moveRect(activeHandle, startRect, deltaX, deltaY);\n          };\n          switch (e.raw.keyCode) {\n          case global$2.LEFT:\n            moveAndBlock(e, activeHandle, currentRect, -10, 0);\n            break;\n          case global$2.RIGHT:\n            moveAndBlock(e, activeHandle, currentRect, 10, 0);\n            break;\n          case global$2.UP:\n            moveAndBlock(e, activeHandle, currentRect, 0, -10);\n            break;\n          case global$2.DOWN:\n            moveAndBlock(e, activeHandle, currentRect, 0, 10);\n            break;\n          case global$2.ENTER:\n          case global$2.SPACEBAR:\n            e.prevent();\n            action();\n            break;\n          }\n        };\n        events.push(bind(container, 'focusin', handleFocus), bind(container, 'focusout', handleFocus), bind(container, 'keydown', handleKeydown));\n      };\n      var toggleVisibility = function (state) {\n        var selectors = __spreadArray(__spreadArray([], map$2(handles, function (handle) {\n          return '#' + id + '-' + handle.name;\n        }), true), map$2(blockers, function (blocker) {\n          return '#' + id + '-' + blocker;\n        }), true).join(',');\n        var elems = descendants(container, selectors);\n        if (state) {\n          each$1(elems, function (elm) {\n            return remove$6(elm, 'display');\n          });\n        } else {\n          each$1(elems, function (elm) {\n            return set$7(elm, 'display', 'none');\n          });\n        }\n      };\n      var repaint = function (rect) {\n        var updateElementRect = function (name, newRect) {\n          descendant(container, '#' + id + '-' + name).each(function (elm) {\n            setAll(elm, {\n              left: newRect.x + 'px',\n              top: newRect.y + 'px',\n              width: Math.max(0, newRect.w) + 'px',\n              height: Math.max(0, newRect.h) + 'px'\n            });\n          });\n        };\n        each$1(handles, function (handle) {\n          descendant(container, '#' + id + '-' + handle.name).each(function (elm) {\n            setAll(elm, {\n              left: rect.w * handle.xMul + rect.x + 'px',\n              top: rect.h * handle.yMul + rect.y + 'px'\n            });\n          });\n        });\n        updateElementRect('top', {\n          x: viewPortRect.x,\n          y: viewPortRect.y,\n          w: viewPortRect.w,\n          h: rect.y - viewPortRect.y\n        });\n        updateElementRect('right', {\n          x: rect.x + rect.w,\n          y: rect.y,\n          w: viewPortRect.w - rect.x - rect.w + viewPortRect.x,\n          h: rect.h\n        });\n        updateElementRect('bottom', {\n          x: viewPortRect.x,\n          y: rect.y + rect.h,\n          w: viewPortRect.w,\n          h: viewPortRect.h - rect.y - rect.h + viewPortRect.y\n        });\n        updateElementRect('left', {\n          x: viewPortRect.x,\n          y: rect.y,\n          w: rect.x - viewPortRect.x,\n          h: rect.h\n        });\n        updateElementRect('move', rect);\n      };\n      var setRect = function (rect) {\n        currentRect = rect;\n        repaint(currentRect);\n      };\n      var setViewPortRect = function (rect) {\n        viewPortRect = rect;\n        repaint(currentRect);\n      };\n      var setInnerRect = function (rect) {\n        setRect(getAbsoluteRect(clampRect, rect));\n      };\n      var setClampRect = function (rect) {\n        clampRect = rect;\n        repaint(currentRect);\n      };\n      var destroy = function () {\n        each$1(dragHelpers, function (helper) {\n          return helper.destroy();\n        });\n        dragHelpers = [];\n        each$1(events, function (e) {\n          return e.unbind();\n        });\n        events = [];\n      };\n      render();\n      var instance = __assign(__assign({}, global$3), {\n        toggleVisibility: toggleVisibility,\n        setClampRect: setClampRect,\n        setRect: setRect,\n        getInnerRect: getInnerRect,\n        setInnerRect: setInnerRect,\n        setViewPortRect: setViewPortRect,\n        destroy: destroy\n      });\n      return instance;\n    };\n    var CropRect = { create: create$1 };\n\n    var loadImage = function (image) {\n      return new global$c(function (resolve) {\n        var loaded = function () {\n          image.removeEventListener('load', loaded);\n          resolve(image);\n        };\n        if (image.complete) {\n          resolve(image);\n        } else {\n          image.addEventListener('load', loaded);\n        }\n      });\n    };\n    var renderImagePanel = function (initialUrl) {\n      var memBg = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-image-tools__image-bg'],\n          attributes: { role: 'presentation' }\n        }\n      });\n      var zoomState = Cell(1);\n      var cropRect = api$1();\n      var rectState = Cell({\n        x: 0,\n        y: 0,\n        w: 1,\n        h: 1\n      });\n      var viewRectState = Cell({\n        x: 0,\n        y: 0,\n        w: 1,\n        h: 1\n      });\n      var repaintImg = function (anyInSystem, img) {\n        memContainer.getOpt(anyInSystem).each(function (panel) {\n          var zoom = zoomState.get();\n          var panelW = get$a(panel.element);\n          var panelH = get$b(panel.element);\n          var width = img.dom.naturalWidth * zoom;\n          var height = img.dom.naturalHeight * zoom;\n          var left = Math.max(0, panelW / 2 - width / 2);\n          var top = Math.max(0, panelH / 2 - height / 2);\n          var css = {\n            left: left.toString() + 'px',\n            top: top.toString() + 'px',\n            width: width.toString() + 'px',\n            height: height.toString() + 'px',\n            position: 'absolute'\n          };\n          setAll(img, css);\n          memBg.getOpt(panel).each(function (bg) {\n            setAll(bg.element, css);\n          });\n          cropRect.run(function (cRect) {\n            var rect = rectState.get();\n            cRect.setRect({\n              x: rect.x * zoom + left,\n              y: rect.y * zoom + top,\n              w: rect.w * zoom,\n              h: rect.h * zoom\n            });\n            cRect.setClampRect({\n              x: left,\n              y: top,\n              w: width,\n              h: height\n            });\n            cRect.setViewPortRect({\n              x: 0,\n              y: 0,\n              w: panelW,\n              h: panelH\n            });\n          });\n        });\n      };\n      var zoomFit = function (anyInSystem, img) {\n        memContainer.getOpt(anyInSystem).each(function (panel) {\n          var panelW = get$a(panel.element);\n          var panelH = get$b(panel.element);\n          var width = img.dom.naturalWidth;\n          var height = img.dom.naturalHeight;\n          var zoom = Math.min(panelW / width, panelH / height);\n          if (zoom >= 1) {\n            zoomState.set(1);\n          } else {\n            zoomState.set(zoom);\n          }\n        });\n      };\n      var updateSrc = function (anyInSystem, url) {\n        var img = SugarElement.fromTag('img');\n        set$8(img, 'src', url);\n        return loadImage(img.dom).then(function () {\n          if (anyInSystem.getSystem().isConnected()) {\n            memContainer.getOpt(anyInSystem).map(function (panel) {\n              var aImg = external$2({ element: img });\n              Replacing.replaceAt(panel, 1, Optional.some(aImg));\n              var lastViewRect = viewRectState.get();\n              var viewRect = {\n                x: 0,\n                y: 0,\n                w: img.dom.naturalWidth,\n                h: img.dom.naturalHeight\n              };\n              viewRectState.set(viewRect);\n              var rect = global$4.inflate(viewRect, -20, -20);\n              rectState.set(rect);\n              if (lastViewRect.w !== viewRect.w || lastViewRect.h !== viewRect.h) {\n                zoomFit(panel, img);\n              }\n              repaintImg(panel, img);\n            });\n          }\n        });\n      };\n      var zoom = function (anyInSystem, direction) {\n        var currentZoom = zoomState.get();\n        var newZoom = direction > 0 ? Math.min(2, currentZoom + 0.1) : Math.max(0.1, currentZoom - 0.1);\n        zoomState.set(newZoom);\n        memContainer.getOpt(anyInSystem).each(function (panel) {\n          var img = panel.components()[1].element;\n          repaintImg(panel, img);\n        });\n      };\n      var showCrop = function () {\n        cropRect.run(function (cRect) {\n          cRect.toggleVisibility(true);\n        });\n      };\n      var hideCrop = function () {\n        cropRect.run(function (cRect) {\n          cRect.toggleVisibility(false);\n        });\n      };\n      var getRect = function () {\n        return rectState.get();\n      };\n      var container = Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-image-tools__image']\n        },\n        components: [\n          memBg.asSpec(),\n          {\n            dom: {\n              tag: 'img',\n              attributes: { src: initialUrl }\n            }\n          },\n          {\n            dom: { tag: 'div' },\n            behaviours: derive$1([config('image-panel-crop-events', [\n                runOnAttached(function (comp) {\n                  memContainer.getOpt(comp).each(function (container) {\n                    var el = container.element.dom;\n                    var cRect = CropRect.create({\n                      x: 10,\n                      y: 10,\n                      w: 100,\n                      h: 100\n                    }, {\n                      x: 0,\n                      y: 0,\n                      w: 200,\n                      h: 200\n                    }, {\n                      x: 0,\n                      y: 0,\n                      w: 200,\n                      h: 200\n                    }, el, noop);\n                    cRect.toggleVisibility(false);\n                    cRect.on('updateRect', function (e) {\n                      var rect = e.rect;\n                      var zoom = zoomState.get();\n                      var newRect = {\n                        x: Math.round(rect.x / zoom),\n                        y: Math.round(rect.y / zoom),\n                        w: Math.round(rect.w / zoom),\n                        h: Math.round(rect.h / zoom)\n                      };\n                      rectState.set(newRect);\n                    });\n                    cropRect.set(cRect);\n                  });\n                }),\n                runOnDetached(function () {\n                  cropRect.clear();\n                })\n              ])])\n          }\n        ],\n        containerBehaviours: derive$1([\n          Replacing.config({}),\n          config('image-panel-events', [runOnAttached(function (comp) {\n              updateSrc(comp, initialUrl);\n            })])\n        ])\n      });\n      var memContainer = record(container);\n      var getMeasurements = function () {\n        var viewRect = viewRectState.get();\n        return {\n          width: viewRect.w,\n          height: viewRect.h\n        };\n      };\n      return {\n        memContainer: memContainer,\n        updateSrc: updateSrc,\n        zoom: zoom,\n        showCrop: showCrop,\n        hideCrop: hideCrop,\n        getRect: getRect,\n        getMeasurements: getMeasurements\n      };\n    };\n\n    var createButton = function (innerHtml, icon, disabled, action, providersBackstage) {\n      return renderIconButton({\n        name: innerHtml,\n        icon: Optional.some(icon),\n        disabled: disabled,\n        tooltip: Optional.some(innerHtml),\n        primary: false,\n        borderless: false\n      }, action, providersBackstage);\n    };\n    var setButtonEnabled = function (button, enabled) {\n      if (enabled) {\n        Disabling.enable(button);\n      } else {\n        Disabling.disable(button);\n      }\n    };\n    var renderSideBar = function (providersBackstage) {\n      var updateButtonUndoStates = function (anyInSystem, undoEnabled, redoEnabled) {\n        memUndo.getOpt(anyInSystem).each(function (undo) {\n          setButtonEnabled(undo, undoEnabled);\n        });\n        memRedo.getOpt(anyInSystem).each(function (redo) {\n          setButtonEnabled(redo, redoEnabled);\n        });\n      };\n      var memUndo = record(createButton('Undo', 'undo', true, function (button) {\n        emitWith(button, internal.undo(), { direction: 1 });\n      }, providersBackstage));\n      var memRedo = record(createButton('Redo', 'redo', true, function (button) {\n        emitWith(button, internal.redo(), { direction: 1 });\n      }, providersBackstage));\n      var container = Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-image-tools__toolbar',\n            'tox-image-tools__sidebar'\n          ]\n        },\n        components: [\n          memUndo.asSpec(),\n          memRedo.asSpec(),\n          createButton('Zoom in', 'zoom-in', false, function (button) {\n            emitWith(button, internal.zoom(), { direction: 1 });\n          }, providersBackstage),\n          createButton('Zoom out', 'zoom-out', false, function (button) {\n            emitWith(button, internal.zoom(), { direction: -1 });\n          }, providersBackstage)\n        ]\n      });\n      return {\n        container: container,\n        updateButtonUndoStates: updateButtonUndoStates\n      };\n    };\n\n    function UndoStack () {\n      var data = [];\n      var index = -1;\n      var add = function (state) {\n        var removed = data.splice(++index);\n        data.push(state);\n        return {\n          state: state,\n          removed: removed\n        };\n      };\n      var undo = function () {\n        if (canUndo()) {\n          return data[--index];\n        }\n      };\n      var redo = function () {\n        if (canRedo()) {\n          return data[++index];\n        }\n      };\n      var canUndo = function () {\n        return index > 0;\n      };\n      var canRedo = function () {\n        return index !== -1 && index < data.length - 1;\n      };\n      return {\n        data: data,\n        add: add,\n        undo: undo,\n        redo: redo,\n        canUndo: canUndo,\n        canRedo: canRedo\n      };\n    }\n\n    var makeState = function (initialState) {\n      var blobState = Cell(initialState);\n      var tempState = value$1();\n      var undoStack = UndoStack();\n      undoStack.add(initialState);\n      var getBlobState = function () {\n        return blobState.get();\n      };\n      var setBlobState = function (state) {\n        blobState.set(state);\n      };\n      var getTempState = function () {\n        return tempState.get().getOrThunk(blobState.get);\n      };\n      var updateTempState = function (blob) {\n        var newTempState = createState(blob);\n        destroyTempState();\n        tempState.set(newTempState);\n        return newTempState.url;\n      };\n      var createState = function (blob) {\n        return {\n          blob: blob,\n          url: URL.createObjectURL(blob)\n        };\n      };\n      var destroyState = function (state) {\n        URL.revokeObjectURL(state.url);\n      };\n      var destroyStates = function (states) {\n        global$5.each(states, destroyState);\n      };\n      var destroyTempState = function () {\n        tempState.on(destroyState);\n        tempState.clear();\n      };\n      var addBlobState = function (blob) {\n        var newState = createState(blob);\n        setBlobState(newState);\n        var removed = undoStack.add(newState).removed;\n        destroyStates(removed);\n        return newState.url;\n      };\n      var addTempState = function (blob) {\n        var newState = createState(blob);\n        tempState.set(newState);\n        return newState.url;\n      };\n      var applyTempState = function (postApply) {\n        return tempState.get().fold(noop, function (temp) {\n          addBlobState(temp.blob);\n          postApply();\n        });\n      };\n      var undo = function () {\n        var currentState = undoStack.undo();\n        setBlobState(currentState);\n        return currentState.url;\n      };\n      var redo = function () {\n        var currentState = undoStack.redo();\n        setBlobState(currentState);\n        return currentState.url;\n      };\n      var getHistoryStates = function () {\n        var undoEnabled = undoStack.canUndo();\n        var redoEnabled = undoStack.canRedo();\n        return {\n          undoEnabled: undoEnabled,\n          redoEnabled: redoEnabled\n        };\n      };\n      return {\n        getBlobState: getBlobState,\n        setBlobState: setBlobState,\n        addBlobState: addBlobState,\n        getTempState: getTempState,\n        updateTempState: updateTempState,\n        addTempState: addTempState,\n        applyTempState: applyTempState,\n        destroyTempState: destroyTempState,\n        undo: undo,\n        redo: redo,\n        getHistoryStates: getHistoryStates\n      };\n    };\n\n    var renderImageTools = function (detail, providersBackstage) {\n      var state = makeState(detail.currentState);\n      var zoom = function (anyInSystem, simulatedEvent) {\n        var direction = simulatedEvent.event.direction;\n        imagePanel.zoom(anyInSystem, direction);\n      };\n      var updateButtonUndoStates = function (anyInSystem) {\n        var historyStates = state.getHistoryStates();\n        sideBar.updateButtonUndoStates(anyInSystem, historyStates.undoEnabled, historyStates.redoEnabled);\n        emitWith(anyInSystem, external.formActionEvent, {\n          name: external.saveState(),\n          value: historyStates.undoEnabled\n        });\n      };\n      var disableUndoRedo = function (anyInSystem) {\n        sideBar.updateButtonUndoStates(anyInSystem, false, false);\n      };\n      var undo = function (anyInSystem, _simulatedEvent) {\n        var url = state.undo();\n        updateSrc(anyInSystem, url).then(function (_oImg) {\n          unblock(anyInSystem);\n          updateButtonUndoStates(anyInSystem);\n        });\n      };\n      var redo = function (anyInSystem, _simulatedEvent) {\n        var url = state.redo();\n        updateSrc(anyInSystem, url).then(function (_oImg) {\n          unblock(anyInSystem);\n          updateButtonUndoStates(anyInSystem);\n        });\n      };\n      var imageResultToBlob = function (ir) {\n        return ir.toBlob();\n      };\n      var block = function (anyInSystem) {\n        emitWith(anyInSystem, external.formActionEvent, {\n          name: external.disable(),\n          value: {}\n        });\n      };\n      var unblock = function (anyInSystem) {\n        editPanel.getApplyButton(anyInSystem).each(function (applyButton) {\n          Disabling.enable(applyButton);\n        });\n        emitWith(anyInSystem, external.formActionEvent, {\n          name: external.enable(),\n          value: {}\n        });\n      };\n      var updateSrc = function (anyInSystem, src) {\n        block(anyInSystem);\n        return imagePanel.updateSrc(anyInSystem, src);\n      };\n      var blobManipulate = function (anyInSystem, blob, filter, action, swap) {\n        block(anyInSystem);\n        blobToImageResult(blob).then(filter).then(imageResultToBlob).then(action).then(function (url) {\n          return updateSrc(anyInSystem, url);\n        }).then(function () {\n          updateButtonUndoStates(anyInSystem);\n          swap();\n          unblock(anyInSystem);\n        }).catch(function (err) {\n          console.log(err);\n          if (anyInSystem.getSystem().isConnected()) {\n            unblock(anyInSystem);\n          }\n        });\n      };\n      var manipulate = function (anyInSystem, filter, swap) {\n        var blob = state.getBlobState().blob;\n        var action = function (blob) {\n          return state.updateTempState(blob);\n        };\n        blobManipulate(anyInSystem, blob, filter, action, swap);\n      };\n      var tempManipulate = function (anyInSystem, filter) {\n        var blob = state.getTempState().blob;\n        var action = function (blob) {\n          return state.addTempState(blob);\n        };\n        blobManipulate(anyInSystem, blob, filter, action, noop);\n      };\n      var manipulateApply = function (anyInSystem, filter, swap) {\n        var blob = state.getBlobState().blob;\n        var action = function (blob) {\n          var url = state.addBlobState(blob);\n          destroyTempState(anyInSystem);\n          return url;\n        };\n        blobManipulate(anyInSystem, blob, filter, action, swap);\n      };\n      var apply = function (anyInSystem, simulatedEvent) {\n        var postApply = function () {\n          destroyTempState(anyInSystem);\n          var swap = simulatedEvent.event.swap;\n          swap();\n        };\n        state.applyTempState(postApply);\n      };\n      var destroyTempState = function (anyInSystem) {\n        var currentUrl = state.getBlobState().url;\n        state.destroyTempState();\n        updateButtonUndoStates(anyInSystem);\n        return currentUrl;\n      };\n      var cancel = function (anyInSystem) {\n        var currentUrl = destroyTempState(anyInSystem);\n        updateSrc(anyInSystem, currentUrl).then(function (_oImg) {\n          unblock(anyInSystem);\n        });\n      };\n      var back = function (anyInSystem, simulatedEvent) {\n        cancel(anyInSystem);\n        var swap = simulatedEvent.event.swap;\n        swap();\n        imagePanel.hideCrop();\n      };\n      var transform = function (anyInSystem, simulatedEvent) {\n        return manipulate(anyInSystem, simulatedEvent.event.transform, noop);\n      };\n      var tempTransform = function (anyInSystem, simulatedEvent) {\n        return tempManipulate(anyInSystem, simulatedEvent.event.transform);\n      };\n      var transformApply = function (anyInSystem, simulatedEvent) {\n        return manipulateApply(anyInSystem, simulatedEvent.event.transform, simulatedEvent.event.swap);\n      };\n      var imagePanel = renderImagePanel(detail.currentState.url);\n      var sideBar = renderSideBar(providersBackstage);\n      var editPanel = renderEditPanel(imagePanel, providersBackstage);\n      var swap = function (anyInSystem, simulatedEvent) {\n        disableUndoRedo(anyInSystem);\n        var transform = simulatedEvent.event.transform;\n        var swap = simulatedEvent.event.swap;\n        transform.fold(function () {\n          swap();\n        }, function (transform) {\n          manipulate(anyInSystem, transform, swap);\n        });\n      };\n      return {\n        dom: {\n          tag: 'div',\n          attributes: { role: 'presentation' }\n        },\n        components: [\n          editPanel.memContainer.asSpec(),\n          imagePanel.memContainer.asSpec(),\n          sideBar.container\n        ],\n        behaviours: derive$1([\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function () {\n                return state.getBlobState();\n              }\n            }\n          }),\n          config('image-tools-events', [\n            run$1(internal.undo(), undo),\n            run$1(internal.redo(), redo),\n            run$1(internal.zoom(), zoom),\n            run$1(internal.back(), back),\n            run$1(internal.apply(), apply),\n            run$1(internal.transform(), transform),\n            run$1(internal.tempTransform(), tempTransform),\n            run$1(internal.transformApply(), transformApply),\n            run$1(internal.swap(), swap)\n          ]),\n          ComposingConfigs.self()\n        ])\n      };\n    };\n\n    var renderLabel = function (spec, backstageShared) {\n      var label = {\n        dom: {\n          tag: 'label',\n          innerHtml: backstageShared.providers.translate(spec.label),\n          classes: ['tox-label']\n        }\n      };\n      var comps = map$2(spec.items, backstageShared.interpreter);\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: [label].concat(comps),\n        behaviours: derive$1([\n          ComposingConfigs.self(),\n          Replacing.config({}),\n          RepresentingConfigs.domHtml(Optional.none()),\n          Keying.config({ mode: 'acyclic' })\n        ])\n      };\n    };\n\n    var isSingleListItem = function (item) {\n      return !has$2(item, 'items');\n    };\n    var dataAttribute = 'data-value';\n    var fetchItems = function (dropdownComp, name, items, selectedValue) {\n      return map$2(items, function (item) {\n        if (!isSingleListItem(item)) {\n          return {\n            type: 'nestedmenuitem',\n            text: item.text,\n            getSubmenuItems: function () {\n              return fetchItems(dropdownComp, name, item.items, selectedValue);\n            }\n          };\n        } else {\n          return {\n            type: 'togglemenuitem',\n            text: item.text,\n            value: item.value,\n            active: item.value === selectedValue,\n            onAction: function () {\n              Representing.setValue(dropdownComp, item.value);\n              emitWith(dropdownComp, formChangeEvent, { name: name });\n              Focusing.focus(dropdownComp);\n            }\n          };\n        }\n      });\n    };\n    var findItemByValue = function (items, value) {\n      return findMap(items, function (item) {\n        if (!isSingleListItem(item)) {\n          return findItemByValue(item.items, value);\n        } else {\n          return someIf(item.value === value, item);\n        }\n      });\n    };\n    var renderListBox = function (spec, backstage) {\n      var providersBackstage = backstage.shared.providers;\n      var initialItem = head(spec.items).filter(isSingleListItem);\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel$2(label, providersBackstage);\n      });\n      var pField = FormField.parts.field({\n        dom: {},\n        factory: {\n          sketch: function (sketchSpec) {\n            return renderCommonDropdown({\n              uid: sketchSpec.uid,\n              text: initialItem.map(function (item) {\n                return item.text;\n              }),\n              icon: Optional.none(),\n              tooltip: spec.label,\n              role: Optional.none(),\n              fetch: function (comp, callback) {\n                var items = fetchItems(comp, spec.name, spec.items, Representing.getValue(comp));\n                callback(build(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false));\n              },\n              onSetup: constant$1(noop),\n              getApi: constant$1({}),\n              columns: 1,\n              presets: 'normal',\n              classes: [],\n              dropdownBehaviours: [\n                Tabstopping.config({}),\n                Representing.config({\n                  store: {\n                    mode: 'manual',\n                    initialValue: initialItem.map(function (item) {\n                      return item.value;\n                    }).getOr(''),\n                    getValue: function (comp) {\n                      return get$d(comp.element, dataAttribute);\n                    },\n                    setValue: function (comp, data) {\n                      findItemByValue(spec.items, data).each(function (item) {\n                        set$8(comp.element, dataAttribute, item.value);\n                        emitWith(comp, updateMenuText, { text: item.text });\n                      });\n                    }\n                  }\n                })\n              ]\n            }, 'tox-listbox', backstage.shared);\n          }\n        }\n      });\n      var listBoxWrap = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-listboxfield']\n        },\n        components: [pField]\n      };\n      return FormField.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: flatten([\n          pLabel.toArray(),\n          [listBoxWrap]\n        ]),\n        fieldBehaviours: derive$1([Disabling.config({\n            disabled: constant$1(spec.disabled),\n            onDisabled: function (comp) {\n              FormField.getField(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormField.getField(comp).each(Disabling.enable);\n            }\n          })])\n      });\n    };\n\n    var renderPanel = function (spec, backstage) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: spec.classes\n        },\n        components: map$2(spec.items, backstage.shared.interpreter)\n      };\n    };\n\n    var factory$e = function (detail, _spec) {\n      var options = map$2(detail.options, function (option) {\n        return {\n          dom: {\n            tag: 'option',\n            value: option.value,\n            innerHtml: option.text\n          }\n        };\n      });\n      var initialValues = detail.data.map(function (v) {\n        return wrap$1('initialValue', v);\n      }).getOr({});\n      return {\n        uid: detail.uid,\n        dom: {\n          tag: 'select',\n          classes: detail.selectClasses,\n          attributes: detail.selectAttributes\n        },\n        components: options,\n        behaviours: augment(detail.selectBehaviours, [\n          Focusing.config({}),\n          Representing.config({\n            store: __assign({\n              mode: 'manual',\n              getValue: function (select) {\n                return get$5(select.element);\n              },\n              setValue: function (select, newValue) {\n                var found = find$5(detail.options, function (opt) {\n                  return opt.value === newValue;\n                });\n                if (found.isSome()) {\n                  set$4(select.element, newValue);\n                }\n              }\n            }, initialValues)\n          })\n        ])\n      };\n    };\n    var HtmlSelect = single({\n      name: 'HtmlSelect',\n      configFields: [\n        required$1('options'),\n        field('selectBehaviours', [\n          Focusing,\n          Representing\n        ]),\n        defaulted('selectClasses', []),\n        defaulted('selectAttributes', {}),\n        option('data')\n      ],\n      factory: factory$e\n    });\n\n    var renderSelectBox = function (spec, providersBackstage) {\n      var translatedOptions = map$2(spec.items, function (item) {\n        return {\n          text: providersBackstage.translate(item.text),\n          value: item.value\n        };\n      });\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel$2(label, providersBackstage);\n      });\n      var pField = FormField.parts.field({\n        dom: {},\n        selectAttributes: { size: spec.size },\n        options: translatedOptions,\n        factory: HtmlSelect,\n        selectBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isDisabled();\n            }\n          }),\n          Tabstopping.config({}),\n          config('selectbox-change', [run$1(change(), function (component, _) {\n              emitWith(component, formChangeEvent, { name: spec.name });\n            })])\n        ])\n      });\n      var chevron = spec.size > 1 ? Optional.none() : Optional.some(render$3('chevron-down', {\n        tag: 'div',\n        classes: ['tox-selectfield__icon-js']\n      }, providersBackstage.icons));\n      var selectWrap = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-selectfield']\n        },\n        components: flatten([\n          [pField],\n          chevron.toArray()\n        ])\n      };\n      return FormField.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: flatten([\n          pLabel.toArray(),\n          [selectWrap]\n        ]),\n        fieldBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isDisabled();\n            },\n            onDisabled: function (comp) {\n              FormField.getField(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormField.getField(comp).each(Disabling.enable);\n            }\n          }),\n          receivingConfig()\n        ])\n      });\n    };\n\n    var renderTable = function (spec, providersBackstage) {\n      var renderTh = function (text) {\n        return {\n          dom: {\n            tag: 'th',\n            innerHtml: providersBackstage.translate(text)\n          }\n        };\n      };\n      var renderHeader = function (header) {\n        return {\n          dom: { tag: 'thead' },\n          components: [{\n              dom: { tag: 'tr' },\n              components: map$2(header, renderTh)\n            }]\n        };\n      };\n      var renderTd = function (text) {\n        return {\n          dom: {\n            tag: 'td',\n            innerHtml: providersBackstage.translate(text)\n          }\n        };\n      };\n      var renderTr = function (row) {\n        return {\n          dom: { tag: 'tr' },\n          components: map$2(row, renderTd)\n        };\n      };\n      var renderRows = function (rows) {\n        return {\n          dom: { tag: 'tbody' },\n          components: map$2(rows, renderTr)\n        };\n      };\n      return {\n        dom: {\n          tag: 'table',\n          classes: ['tox-dialog__table']\n        },\n        components: [\n          renderHeader(spec.header),\n          renderRows(spec.cells)\n        ],\n        behaviours: derive$1([\n          Tabstopping.config({}),\n          Focusing.config({})\n        ])\n      };\n    };\n\n    var renderTextField = function (spec, providersBackstage) {\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel$2(label, providersBackstage);\n      });\n      var baseInputBehaviours = [\n        Disabling.config({\n          disabled: function () {\n            return spec.disabled || providersBackstage.isDisabled();\n          }\n        }),\n        receivingConfig(),\n        Keying.config({\n          mode: 'execution',\n          useEnter: spec.multiline !== true,\n          useControlEnter: spec.multiline === true,\n          execute: function (comp) {\n            emit(comp, formSubmitEvent);\n            return Optional.some(true);\n          }\n        }),\n        config('textfield-change', [\n          run$1(input(), function (component, _) {\n            emitWith(component, formChangeEvent, { name: spec.name });\n          }),\n          run$1(postPaste(), function (component, _) {\n            emitWith(component, formChangeEvent, { name: spec.name });\n          })\n        ]),\n        Tabstopping.config({})\n      ];\n      var validatingBehaviours = spec.validation.map(function (vl) {\n        return Invalidating.config({\n          getRoot: function (input) {\n            return parent(input.element);\n          },\n          invalidClass: 'tox-invalid',\n          validator: {\n            validate: function (input) {\n              var v = Representing.getValue(input);\n              var result = vl.validator(v);\n              return Future.pure(result === true ? Result.value(v) : Result.error(result));\n            },\n            validateOnLoad: vl.validateOnLoad\n          }\n        });\n      }).toArray();\n      var placeholder = spec.placeholder.fold(constant$1({}), function (p) {\n        return { placeholder: providersBackstage.translate(p) };\n      });\n      var inputMode = spec.inputMode.fold(constant$1({}), function (mode) {\n        return { inputmode: mode };\n      });\n      var inputAttributes = __assign(__assign({}, placeholder), inputMode);\n      var pField = FormField.parts.field({\n        tag: spec.multiline === true ? 'textarea' : 'input',\n        inputAttributes: inputAttributes,\n        inputClasses: [spec.classname],\n        inputBehaviours: derive$1(flatten([\n          baseInputBehaviours,\n          validatingBehaviours\n        ])),\n        selectOnFocus: false,\n        factory: Input\n      });\n      var extraClasses = spec.flex ? ['tox-form__group--stretched'] : [];\n      var extraClasses2 = extraClasses.concat(spec.maximized ? ['tox-form-group--maximize'] : []);\n      var extraBehaviours = [\n        Disabling.config({\n          disabled: function () {\n            return spec.disabled || providersBackstage.isDisabled();\n          },\n          onDisabled: function (comp) {\n            FormField.getField(comp).each(Disabling.disable);\n          },\n          onEnabled: function (comp) {\n            FormField.getField(comp).each(Disabling.enable);\n          }\n        }),\n        receivingConfig()\n      ];\n      return renderFormFieldWith(pLabel, pField, extraClasses2, extraBehaviours);\n    };\n    var renderInput = function (spec, providersBackstage) {\n      return renderTextField({\n        name: spec.name,\n        multiline: false,\n        label: spec.label,\n        inputMode: spec.inputMode,\n        placeholder: spec.placeholder,\n        flex: false,\n        disabled: spec.disabled,\n        classname: 'tox-textfield',\n        validation: Optional.none(),\n        maximized: spec.maximized\n      }, providersBackstage);\n    };\n    var renderTextarea = function (spec, providersBackstage) {\n      return renderTextField({\n        name: spec.name,\n        multiline: true,\n        label: spec.label,\n        inputMode: Optional.none(),\n        placeholder: spec.placeholder,\n        flex: true,\n        disabled: spec.disabled,\n        classname: 'tox-textarea',\n        validation: Optional.none(),\n        maximized: spec.maximized\n      }, providersBackstage);\n    };\n\n    var events$6 = function (streamConfig, streamState) {\n      var streams = streamConfig.stream.streams;\n      var processor = streams.setup(streamConfig, streamState);\n      return derive$2([\n        run$1(streamConfig.event, processor),\n        runOnDetached(function () {\n          return streamState.cancel();\n        })\n      ].concat(streamConfig.cancelEvent.map(function (e) {\n        return [run$1(e, function () {\n            return streamState.cancel();\n          })];\n      }).getOr([])));\n    };\n\n    var ActiveStreaming = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$6\n    });\n\n    var throttle = function (_config) {\n      var state = Cell(null);\n      var readState = function () {\n        return { timer: state.get() !== null ? 'set' : 'unset' };\n      };\n      var setTimer = function (t) {\n        state.set(t);\n      };\n      var cancel = function () {\n        var t = state.get();\n        if (t !== null) {\n          t.cancel();\n        }\n      };\n      return nu$8({\n        readState: readState,\n        setTimer: setTimer,\n        cancel: cancel\n      });\n    };\n    var init$9 = function (spec) {\n      return spec.stream.streams.state(spec);\n    };\n\n    var StreamingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        throttle: throttle,\n        init: init$9\n    });\n\n    var setup$c = function (streamInfo, streamState) {\n      var sInfo = streamInfo.stream;\n      var throttler = last(streamInfo.onStream, sInfo.delay);\n      streamState.setTimer(throttler);\n      return function (component, simulatedEvent) {\n        throttler.throttle(component, simulatedEvent);\n        if (sInfo.stopEvent) {\n          simulatedEvent.stop();\n        }\n      };\n    };\n    var StreamingSchema = [\n      requiredOf('stream', choose$1('mode', {\n        throttle: [\n          required$1('delay'),\n          defaulted('stopEvent', true),\n          output$1('streams', {\n            setup: setup$c,\n            state: throttle\n          })\n        ]\n      })),\n      defaulted('event', 'input'),\n      option('cancelEvent'),\n      onStrictHandler('onStream')\n    ];\n\n    var Streaming = create$7({\n      fields: StreamingSchema,\n      name: 'streaming',\n      active: ActiveStreaming,\n      state: StreamingState\n    });\n\n    var setValueFromItem = function (model, input, item) {\n      var itemData = Representing.getValue(item);\n      Representing.setValue(input, itemData);\n      setCursorAtEnd(input);\n    };\n    var setSelectionOn = function (input, f) {\n      var el = input.element;\n      var value = get$5(el);\n      var node = el.dom;\n      if (get$d(el, 'type') !== 'number') {\n        f(node, value);\n      }\n    };\n    var setCursorAtEnd = function (input) {\n      setSelectionOn(input, function (node, value) {\n        return node.setSelectionRange(value.length, value.length);\n      });\n    };\n    var setSelectionToEnd = function (input, startOffset) {\n      setSelectionOn(input, function (node, value) {\n        return node.setSelectionRange(startOffset, value.length);\n      });\n    };\n    var attemptSelectOver = function (model, input, item) {\n      if (!model.selectsOver) {\n        return Optional.none();\n      } else {\n        var currentValue = Representing.getValue(input);\n        var inputDisplay_1 = model.getDisplayText(currentValue);\n        var itemValue = Representing.getValue(item);\n        var itemDisplay = model.getDisplayText(itemValue);\n        return itemDisplay.indexOf(inputDisplay_1) === 0 ? Optional.some(function () {\n          setValueFromItem(model, input, item);\n          setSelectionToEnd(input, inputDisplay_1.length);\n        }) : Optional.none();\n      }\n    };\n\n    var itemExecute = constant$1('alloy.typeahead.itemexecute');\n\n    var make$3 = function (detail, components, spec, externals) {\n      var navigateList = function (comp, simulatedEvent, highlighter) {\n        detail.previewing.set(false);\n        var sandbox = Coupling.getCoupled(comp, 'sandbox');\n        if (Sandboxing.isOpen(sandbox)) {\n          Composing.getCurrent(sandbox).each(function (menu) {\n            Highlighting.getHighlighted(menu).fold(function () {\n              highlighter(menu);\n            }, function () {\n              dispatchEvent(sandbox, menu.element, 'keydown', simulatedEvent);\n            });\n          });\n        } else {\n          var onOpenSync = function (sandbox) {\n            Composing.getCurrent(sandbox).each(highlighter);\n          };\n          open(detail, mapFetch(comp), comp, sandbox, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n        }\n      };\n      var focusBehaviours$1 = focusBehaviours(detail);\n      var mapFetch = function (comp) {\n        return function (tdata) {\n          return tdata.map(function (data) {\n            var menus = values(data.menus);\n            var items = bind$3(menus, function (menu) {\n              return filter$2(menu.items, function (item) {\n                return item.type === 'item';\n              });\n            });\n            var repState = Representing.getState(comp);\n            repState.update(map$2(items, function (item) {\n              return item.data;\n            }));\n            return data;\n          });\n        };\n      };\n      var behaviours = [\n        Focusing.config({}),\n        Representing.config({\n          onSetValue: detail.onSetValue,\n          store: __assign({\n            mode: 'dataset',\n            getDataKey: function (comp) {\n              return get$5(comp.element);\n            },\n            getFallbackEntry: function (itemString) {\n              return {\n                value: itemString,\n                meta: {}\n              };\n            },\n            setValue: function (comp, data) {\n              set$4(comp.element, detail.model.getDisplayText(data));\n            }\n          }, detail.initialData.map(function (d) {\n            return wrap$1('initialValue', d);\n          }).getOr({}))\n        }),\n        Streaming.config({\n          stream: {\n            mode: 'throttle',\n            delay: detail.responseTime,\n            stopEvent: false\n          },\n          onStream: function (component, _simulatedEvent) {\n            var sandbox = Coupling.getCoupled(component, 'sandbox');\n            var focusInInput = Focusing.isFocused(component);\n            if (focusInInput) {\n              if (get$5(component.element).length >= detail.minChars) {\n                var previousValue_1 = Composing.getCurrent(sandbox).bind(function (menu) {\n                  return Highlighting.getHighlighted(menu).map(Representing.getValue);\n                });\n                detail.previewing.set(true);\n                var onOpenSync = function (_sandbox) {\n                  Composing.getCurrent(sandbox).each(function (menu) {\n                    previousValue_1.fold(function () {\n                      if (detail.model.selectsOver) {\n                        Highlighting.highlightFirst(menu);\n                      }\n                    }, function (pv) {\n                      Highlighting.highlightBy(menu, function (item) {\n                        var itemData = Representing.getValue(item);\n                        return itemData.value === pv.value;\n                      });\n                      Highlighting.getHighlighted(menu).orThunk(function () {\n                        Highlighting.highlightFirst(menu);\n                        return Optional.none();\n                      });\n                    });\n                  });\n                };\n                open(detail, mapFetch(component), component, sandbox, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n              }\n            }\n          },\n          cancelEvent: typeaheadCancel()\n        }),\n        Keying.config({\n          mode: 'special',\n          onDown: function (comp, simulatedEvent) {\n            navigateList(comp, simulatedEvent, Highlighting.highlightFirst);\n            return Optional.some(true);\n          },\n          onEscape: function (comp) {\n            var sandbox = Coupling.getCoupled(comp, 'sandbox');\n            if (Sandboxing.isOpen(sandbox)) {\n              Sandboxing.close(sandbox);\n              return Optional.some(true);\n            }\n            return Optional.none();\n          },\n          onUp: function (comp, simulatedEvent) {\n            navigateList(comp, simulatedEvent, Highlighting.highlightLast);\n            return Optional.some(true);\n          },\n          onEnter: function (comp) {\n            var sandbox = Coupling.getCoupled(comp, 'sandbox');\n            var sandboxIsOpen = Sandboxing.isOpen(sandbox);\n            if (sandboxIsOpen && !detail.previewing.get()) {\n              return Composing.getCurrent(sandbox).bind(function (menu) {\n                return Highlighting.getHighlighted(menu);\n              }).map(function (item) {\n                emitWith(comp, itemExecute(), { item: item });\n                return true;\n              });\n            } else {\n              var currentValue = Representing.getValue(comp);\n              emit(comp, typeaheadCancel());\n              detail.onExecute(sandbox, comp, currentValue);\n              if (sandboxIsOpen) {\n                Sandboxing.close(sandbox);\n              }\n              return Optional.some(true);\n            }\n          }\n        }),\n        Toggling.config({\n          toggleClass: detail.markers.openClass,\n          aria: { mode: 'expanded' }\n        }),\n        Coupling.config({\n          others: {\n            sandbox: function (hotspot) {\n              return makeSandbox$1(detail, hotspot, {\n                onOpen: function () {\n                  return Toggling.on(hotspot);\n                },\n                onClose: function () {\n                  return Toggling.off(hotspot);\n                }\n              });\n            }\n          }\n        }),\n        config('typeaheadevents', [\n          runOnExecute$1(function (comp) {\n            var onOpenSync = noop;\n            togglePopup(detail, mapFetch(comp), comp, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n          }),\n          run$1(itemExecute(), function (comp, se) {\n            var sandbox = Coupling.getCoupled(comp, 'sandbox');\n            setValueFromItem(detail.model, comp, se.event.item);\n            emit(comp, typeaheadCancel());\n            detail.onItemExecute(comp, sandbox, se.event.item, Representing.getValue(comp));\n            Sandboxing.close(sandbox);\n            setCursorAtEnd(comp);\n          })\n        ].concat(detail.dismissOnBlur ? [run$1(postBlur(), function (typeahead) {\n            var sandbox = Coupling.getCoupled(typeahead, 'sandbox');\n            if (search(sandbox.element).isNone()) {\n              Sandboxing.close(sandbox);\n            }\n          })] : []))\n      ];\n      return {\n        uid: detail.uid,\n        dom: dom(deepMerge(detail, {\n          inputAttributes: {\n            'role': 'combobox',\n            'aria-autocomplete': 'list',\n            'aria-haspopup': 'true'\n          }\n        })),\n        behaviours: __assign(__assign({}, focusBehaviours$1), augment(detail.typeaheadBehaviours, behaviours)),\n        eventOrder: detail.eventOrder\n      };\n    };\n\n    var schema$g = constant$1([\n      option('lazySink'),\n      required$1('fetch'),\n      defaulted('minChars', 5),\n      defaulted('responseTime', 1000),\n      onHandler('onOpen'),\n      defaulted('getHotspot', Optional.some),\n      defaulted('getAnchorOverrides', constant$1({})),\n      defaulted('layouts', Optional.none()),\n      defaulted('eventOrder', {}),\n      defaultedObjOf('model', {}, [\n        defaulted('getDisplayText', function (itemData) {\n          return itemData.meta !== undefined && itemData.meta.text !== undefined ? itemData.meta.text : itemData.value;\n        }),\n        defaulted('selectsOver', true),\n        defaulted('populateFromBrowse', true)\n      ]),\n      onHandler('onSetValue'),\n      onKeyboardHandler('onExecute'),\n      onHandler('onItemExecute'),\n      defaulted('inputClasses', []),\n      defaulted('inputAttributes', {}),\n      defaulted('inputStyles', {}),\n      defaulted('matchWidth', true),\n      defaulted('useMinWidth', false),\n      defaulted('dismissOnBlur', true),\n      markers$1(['openClass']),\n      option('initialData'),\n      field('typeaheadBehaviours', [\n        Focusing,\n        Representing,\n        Streaming,\n        Keying,\n        Toggling,\n        Coupling\n      ]),\n      customField('previewing', function () {\n        return Cell(true);\n      })\n    ].concat(schema$k()).concat(sandboxFields()));\n    var parts$b = constant$1([external$1({\n        schema: [tieredMenuMarkers()],\n        name: 'menu',\n        overrides: function (detail) {\n          return {\n            fakeFocus: true,\n            onHighlight: function (menu, item) {\n              if (!detail.previewing.get()) {\n                menu.getSystem().getByUid(detail.uid).each(function (input) {\n                  if (detail.model.populateFromBrowse) {\n                    setValueFromItem(detail.model, input, item);\n                  }\n                });\n              } else {\n                menu.getSystem().getByUid(detail.uid).each(function (input) {\n                  attemptSelectOver(detail.model, input, item).fold(function () {\n                    return Highlighting.dehighlight(menu, item);\n                  }, function (fn) {\n                    return fn();\n                  });\n                });\n              }\n              detail.previewing.set(false);\n            },\n            onExecute: function (menu, item) {\n              return menu.getSystem().getByUid(detail.uid).toOptional().map(function (typeahead) {\n                emitWith(typeahead, itemExecute(), { item: item });\n                return true;\n              });\n            },\n            onHover: function (menu, item) {\n              detail.previewing.set(false);\n              menu.getSystem().getByUid(detail.uid).each(function (input) {\n                if (detail.model.populateFromBrowse) {\n                  setValueFromItem(detail.model, input, item);\n                }\n              });\n            }\n          };\n        }\n      })]);\n\n    var Typeahead = composite({\n      name: 'Typeahead',\n      configFields: schema$g(),\n      partFields: parts$b(),\n      factory: make$3\n    });\n\n    var wrap = function (delegate) {\n      var toCached = function () {\n        return wrap(delegate.toCached());\n      };\n      var bindFuture = function (f) {\n        return wrap(delegate.bind(function (resA) {\n          return resA.fold(function (err) {\n            return Future.pure(Result.error(err));\n          }, function (a) {\n            return f(a);\n          });\n        }));\n      };\n      var bindResult = function (f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.bind(f);\n        }));\n      };\n      var mapResult = function (f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.map(f);\n        }));\n      };\n      var mapError = function (f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.mapError(f);\n        }));\n      };\n      var foldResult = function (whenError, whenValue) {\n        return delegate.map(function (res) {\n          return res.fold(whenError, whenValue);\n        });\n      };\n      var withTimeout = function (timeout, errorThunk) {\n        return wrap(Future.nu(function (callback) {\n          var timedOut = false;\n          var timer = setTimeout(function () {\n            timedOut = true;\n            callback(Result.error(errorThunk()));\n          }, timeout);\n          delegate.get(function (result) {\n            if (!timedOut) {\n              clearTimeout(timer);\n              callback(result);\n            }\n          });\n        }));\n      };\n      return __assign(__assign({}, delegate), {\n        toCached: toCached,\n        bindFuture: bindFuture,\n        bindResult: bindResult,\n        mapResult: mapResult,\n        mapError: mapError,\n        foldResult: foldResult,\n        withTimeout: withTimeout\n      });\n    };\n    var nu$1 = function (worker) {\n      return wrap(Future.nu(worker));\n    };\n    var value = function (value) {\n      return wrap(Future.pure(Result.value(value)));\n    };\n    var error = function (error) {\n      return wrap(Future.pure(Result.error(error)));\n    };\n    var fromResult = function (result) {\n      return wrap(Future.pure(result));\n    };\n    var fromFuture = function (future) {\n      return wrap(future.map(Result.value));\n    };\n    var fromPromise = function (promise) {\n      return nu$1(function (completer) {\n        promise.then(function (value) {\n          completer(Result.value(value));\n        }, function (error) {\n          completer(Result.error(error));\n        });\n      });\n    };\n    var FutureResult = {\n      nu: nu$1,\n      wrap: wrap,\n      pure: value,\n      value: value,\n      error: error,\n      fromResult: fromResult,\n      fromFuture: fromFuture,\n      fromPromise: fromPromise\n    };\n\n    var separator$1 = { type: 'separator' };\n    var toMenuItem = function (target) {\n      return {\n        type: 'menuitem',\n        value: target.url,\n        text: target.title,\n        meta: { attach: target.attach },\n        onAction: noop\n      };\n    };\n    var staticMenuItem = function (title, url) {\n      return {\n        type: 'menuitem',\n        value: url,\n        text: title,\n        meta: { attach: undefined },\n        onAction: noop\n      };\n    };\n    var toMenuItems = function (targets) {\n      return map$2(targets, toMenuItem);\n    };\n    var filterLinkTargets = function (type, targets) {\n      return filter$2(targets, function (target) {\n        return target.type === type;\n      });\n    };\n    var filteredTargets = function (type, targets) {\n      return toMenuItems(filterLinkTargets(type, targets));\n    };\n    var headerTargets = function (linkInfo) {\n      return filteredTargets('header', linkInfo.targets);\n    };\n    var anchorTargets = function (linkInfo) {\n      return filteredTargets('anchor', linkInfo.targets);\n    };\n    var anchorTargetTop = function (linkInfo) {\n      return Optional.from(linkInfo.anchorTop).map(function (url) {\n        return staticMenuItem('<top>', url);\n      }).toArray();\n    };\n    var anchorTargetBottom = function (linkInfo) {\n      return Optional.from(linkInfo.anchorBottom).map(function (url) {\n        return staticMenuItem('<bottom>', url);\n      }).toArray();\n    };\n    var historyTargets = function (history) {\n      return map$2(history, function (url) {\n        return staticMenuItem(url, url);\n      });\n    };\n    var joinMenuLists = function (items) {\n      return foldl(items, function (a, b) {\n        var bothEmpty = a.length === 0 || b.length === 0;\n        return bothEmpty ? a.concat(b) : a.concat(separator$1, b);\n      }, []);\n    };\n    var filterByQuery = function (term, menuItems) {\n      var lowerCaseTerm = term.toLowerCase();\n      return filter$2(menuItems, function (item) {\n        var text = item.meta !== undefined && item.meta.text !== undefined ? item.meta.text : item.text;\n        return contains$1(text.toLowerCase(), lowerCaseTerm) || contains$1(item.value.toLowerCase(), lowerCaseTerm);\n      });\n    };\n\n    var getItems = function (fileType, input, urlBackstage) {\n      var urlInputValue = Representing.getValue(input);\n      var term = urlInputValue.meta.text !== undefined ? urlInputValue.meta.text : urlInputValue.value;\n      var info = urlBackstage.getLinkInformation();\n      return info.fold(function () {\n        return [];\n      }, function (linkInfo) {\n        var history = filterByQuery(term, historyTargets(urlBackstage.getHistory(fileType)));\n        return fileType === 'file' ? joinMenuLists([\n          history,\n          filterByQuery(term, headerTargets(linkInfo)),\n          filterByQuery(term, flatten([\n            anchorTargetTop(linkInfo),\n            anchorTargets(linkInfo),\n            anchorTargetBottom(linkInfo)\n          ]))\n        ]) : history;\n      });\n    };\n    var errorId = generate$6('aria-invalid');\n    var renderUrlInput = function (spec, backstage, urlBackstage) {\n      var _a;\n      var providersBackstage = backstage.shared.providers;\n      var updateHistory = function (component) {\n        var urlEntry = Representing.getValue(component);\n        urlBackstage.addToHistory(urlEntry.value, spec.filetype);\n      };\n      var pField = FormField.parts.field({\n        factory: Typeahead,\n        dismissOnBlur: true,\n        inputClasses: ['tox-textfield'],\n        sandboxClasses: ['tox-dialog__popups'],\n        inputAttributes: {\n          'aria-errormessage': errorId,\n          'type': 'url'\n        },\n        minChars: 0,\n        responseTime: 0,\n        fetch: function (input) {\n          var items = getItems(spec.filetype, input, urlBackstage);\n          var tdata = build(items, ItemResponse$1.BUBBLE_TO_SANDBOX, backstage, false);\n          return Future.pure(tdata);\n        },\n        getHotspot: function (comp) {\n          return memUrlBox.getOpt(comp);\n        },\n        onSetValue: function (comp, _newValue) {\n          if (comp.hasConfigured(Invalidating)) {\n            Invalidating.run(comp).get(noop);\n          }\n        },\n        typeaheadBehaviours: derive$1(flatten([\n          urlBackstage.getValidationHandler().map(function (handler) {\n            return Invalidating.config({\n              getRoot: function (comp) {\n                return parent(comp.element);\n              },\n              invalidClass: 'tox-control-wrap--status-invalid',\n              notify: {\n                onInvalid: function (comp, err) {\n                  memInvalidIcon.getOpt(comp).each(function (invalidComp) {\n                    set$8(invalidComp.element, 'title', providersBackstage.translate(err));\n                  });\n                }\n              },\n              validator: {\n                validate: function (input) {\n                  var urlEntry = Representing.getValue(input);\n                  return FutureResult.nu(function (completer) {\n                    handler({\n                      type: spec.filetype,\n                      url: urlEntry.value\n                    }, function (validation) {\n                      if (validation.status === 'invalid') {\n                        var err = Result.error(validation.message);\n                        completer(err);\n                      } else {\n                        var val = Result.value(validation.message);\n                        completer(val);\n                      }\n                    });\n                  });\n                },\n                validateOnLoad: false\n              }\n            });\n          }).toArray(),\n          [\n            Disabling.config({\n              disabled: function () {\n                return spec.disabled || providersBackstage.isDisabled();\n              }\n            }),\n            Tabstopping.config({}),\n            config('urlinput-events', flatten([\n              spec.filetype === 'file' ? [run$1(input(), function (comp) {\n                  emitWith(comp, formChangeEvent, { name: spec.name });\n                })] : [],\n              [\n                run$1(change(), function (comp) {\n                  emitWith(comp, formChangeEvent, { name: spec.name });\n                  updateHistory(comp);\n                }),\n                run$1(postPaste(), function (comp) {\n                  emitWith(comp, formChangeEvent, { name: spec.name });\n                  updateHistory(comp);\n                })\n              ]\n            ]))\n          ]\n        ])),\n        eventOrder: (_a = {}, _a[input()] = [\n          'streaming',\n          'urlinput-events',\n          'invalidating'\n        ], _a),\n        model: {\n          getDisplayText: function (itemData) {\n            return itemData.value;\n          },\n          selectsOver: false,\n          populateFromBrowse: false\n        },\n        markers: { openClass: 'tox-textfield--popup-open' },\n        lazySink: backstage.shared.getSink,\n        parts: { menu: part(false, 1, 'normal') },\n        onExecute: function (_menu, component, _entry) {\n          emitWith(component, formSubmitEvent, {});\n        },\n        onItemExecute: function (typeahead, _sandbox, _item, _value) {\n          updateHistory(typeahead);\n          emitWith(typeahead, formChangeEvent, { name: spec.name });\n        }\n      });\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel$2(label, providersBackstage);\n      });\n      var makeIcon = function (name, errId, icon, label) {\n        if (icon === void 0) {\n          icon = name;\n        }\n        if (label === void 0) {\n          label = name;\n        }\n        return render$3(icon, {\n          tag: 'div',\n          classes: [\n            'tox-icon',\n            'tox-control-wrap__status-icon-' + name\n          ],\n          attributes: __assign({\n            'title': providersBackstage.translate(label),\n            'aria-live': 'polite'\n          }, errId.fold(function () {\n            return {};\n          }, function (id) {\n            return { id: id };\n          }))\n        }, providersBackstage.icons);\n      };\n      var memInvalidIcon = record(makeIcon('invalid', Optional.some(errorId), 'warning'));\n      var memStatus = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-control-wrap__status-icon-wrap']\n        },\n        components: [memInvalidIcon.asSpec()]\n      });\n      var optUrlPicker = urlBackstage.getUrlPicker(spec.filetype);\n      var browseUrlEvent = generate$6('browser.url.event');\n      var memUrlBox = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-control-wrap']\n        },\n        components: [\n          pField,\n          memStatus.asSpec()\n        ],\n        behaviours: derive$1([Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isDisabled();\n            }\n          })])\n      });\n      var memUrlPickerButton = record(renderButton({\n        name: spec.name,\n        icon: Optional.some('browse'),\n        text: spec.label.getOr(''),\n        disabled: spec.disabled,\n        primary: false,\n        borderless: true\n      }, function (component) {\n        return emit(component, browseUrlEvent);\n      }, providersBackstage, [], ['tox-browse-url']));\n      var controlHWrapper = function () {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-form__controls-h-stack']\n          },\n          components: flatten([\n            [memUrlBox.asSpec()],\n            optUrlPicker.map(function () {\n              return memUrlPickerButton.asSpec();\n            }).toArray()\n          ])\n        };\n      };\n      var openUrlPicker = function (comp) {\n        Composing.getCurrent(comp).each(function (field) {\n          var componentData = Representing.getValue(field);\n          var urlData = __assign({ fieldname: spec.name }, componentData);\n          optUrlPicker.each(function (picker) {\n            picker(urlData).get(function (chosenData) {\n              Representing.setValue(field, chosenData);\n              emitWith(comp, formChangeEvent, { name: spec.name });\n            });\n          });\n        });\n      };\n      return FormField.sketch({\n        dom: renderFormFieldDom(),\n        components: pLabel.toArray().concat([controlHWrapper()]),\n        fieldBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isDisabled();\n            },\n            onDisabled: function (comp) {\n              FormField.getField(comp).each(Disabling.disable);\n              memUrlPickerButton.getOpt(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormField.getField(comp).each(Disabling.enable);\n              memUrlPickerButton.getOpt(comp).each(Disabling.enable);\n            }\n          }),\n          receivingConfig(),\n          config('url-input-events', [run$1(browseUrlEvent, openUrlPicker)])\n        ])\n      });\n    };\n\n    var renderAlertBanner = function (spec, providersBackstage) {\n      return Container.sketch({\n        dom: {\n          tag: 'div',\n          attributes: { role: 'alert' },\n          classes: [\n            'tox-notification',\n            'tox-notification--in',\n            'tox-notification--' + spec.level\n          ]\n        },\n        components: [\n          {\n            dom: {\n              tag: 'div',\n              classes: ['tox-notification__icon']\n            },\n            components: [Button.sketch({\n                dom: {\n                  tag: 'button',\n                  classes: [\n                    'tox-button',\n                    'tox-button--naked',\n                    'tox-button--icon'\n                  ],\n                  innerHtml: get$1(spec.icon, providersBackstage.icons),\n                  attributes: { title: providersBackstage.translate(spec.iconTooltip) }\n                },\n                action: function (comp) {\n                  emitWith(comp, formActionEvent, {\n                    name: 'alert-banner',\n                    value: spec.url\n                  });\n                },\n                buttonBehaviours: derive$1([addFocusableBehaviour()])\n              })]\n          },\n          {\n            dom: {\n              tag: 'div',\n              classes: ['tox-notification__body'],\n              innerHtml: providersBackstage.translate(spec.text)\n            }\n          }\n        ]\n      });\n    };\n\n    var renderCheckbox = function (spec, providerBackstage) {\n      var repBehaviour = Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (comp) {\n            var el = comp.element.dom;\n            return el.checked;\n          },\n          setValue: function (comp, value) {\n            var el = comp.element.dom;\n            el.checked = value;\n          }\n        }\n      });\n      var toggleCheckboxHandler = function (comp) {\n        comp.element.dom.click();\n        return Optional.some(true);\n      };\n      var pField = FormField.parts.field({\n        factory: { sketch: identity$1 },\n        dom: {\n          tag: 'input',\n          classes: ['tox-checkbox__input'],\n          attributes: { type: 'checkbox' }\n        },\n        behaviours: derive$1([\n          ComposingConfigs.self(),\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providerBackstage.isDisabled();\n            }\n          }),\n          Tabstopping.config({}),\n          Focusing.config({}),\n          repBehaviour,\n          Keying.config({\n            mode: 'special',\n            onEnter: toggleCheckboxHandler,\n            onSpace: toggleCheckboxHandler,\n            stopSpaceKeyup: true\n          }),\n          config('checkbox-events', [run$1(change(), function (component, _) {\n              emitWith(component, formChangeEvent, { name: spec.name });\n            })])\n        ])\n      });\n      var pLabel = FormField.parts.label({\n        dom: {\n          tag: 'span',\n          classes: ['tox-checkbox__label'],\n          innerHtml: providerBackstage.translate(spec.label)\n        },\n        behaviours: derive$1([Unselecting.config({})])\n      });\n      var makeIcon = function (className) {\n        var iconName = className === 'checked' ? 'selected' : 'unselected';\n        return render$3(iconName, {\n          tag: 'span',\n          classes: [\n            'tox-icon',\n            'tox-checkbox-icon__' + className\n          ]\n        }, providerBackstage.icons);\n      };\n      var memIcons = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-checkbox__icons']\n        },\n        components: [\n          makeIcon('checked'),\n          makeIcon('unchecked')\n        ]\n      });\n      return FormField.sketch({\n        dom: {\n          tag: 'label',\n          classes: ['tox-checkbox']\n        },\n        components: [\n          pField,\n          memIcons.asSpec(),\n          pLabel\n        ],\n        fieldBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providerBackstage.isDisabled();\n            },\n            disableClass: 'tox-checkbox--disabled',\n            onDisabled: function (comp) {\n              FormField.getField(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormField.getField(comp).each(Disabling.enable);\n            }\n          }),\n          receivingConfig()\n        ])\n      });\n    };\n\n    var renderHtmlPanel = function (spec) {\n      if (spec.presets === 'presentation') {\n        return Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-form__group'],\n            innerHtml: spec.html\n          }\n        });\n      } else {\n        return Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-form__group'],\n            innerHtml: spec.html,\n            attributes: { role: 'document' }\n          },\n          containerBehaviours: derive$1([\n            Tabstopping.config({}),\n            Focusing.config({})\n          ])\n        });\n      }\n    };\n\n    var make$2 = function (render) {\n      return function (parts, spec, backstage) {\n        return get$e(spec, 'name').fold(function () {\n          return render(spec, backstage);\n        }, function (fieldName) {\n          return parts.field(fieldName, render(spec, backstage));\n        });\n      };\n    };\n    var makeIframe = function (render) {\n      return function (parts, spec, backstage) {\n        var iframeSpec = deepMerge(spec, { source: 'dynamic' });\n        return make$2(render)(parts, iframeSpec, backstage);\n      };\n    };\n    var factories = {\n      bar: make$2(function (spec, backstage) {\n        return renderBar(spec, backstage.shared);\n      }),\n      collection: make$2(function (spec, backstage) {\n        return renderCollection(spec, backstage.shared.providers);\n      }),\n      alertbanner: make$2(function (spec, backstage) {\n        return renderAlertBanner(spec, backstage.shared.providers);\n      }),\n      input: make$2(function (spec, backstage) {\n        return renderInput(spec, backstage.shared.providers);\n      }),\n      textarea: make$2(function (spec, backstage) {\n        return renderTextarea(spec, backstage.shared.providers);\n      }),\n      label: make$2(function (spec, backstage) {\n        return renderLabel(spec, backstage.shared);\n      }),\n      iframe: makeIframe(function (spec, backstage) {\n        return renderIFrame(spec, backstage.shared.providers);\n      }),\n      button: make$2(function (spec, backstage) {\n        return renderDialogButton(spec, backstage.shared.providers);\n      }),\n      checkbox: make$2(function (spec, backstage) {\n        return renderCheckbox(spec, backstage.shared.providers);\n      }),\n      colorinput: make$2(function (spec, backstage) {\n        return renderColorInput(spec, backstage.shared, backstage.colorinput);\n      }),\n      colorpicker: make$2(renderColorPicker),\n      dropzone: make$2(function (spec, backstage) {\n        return renderDropZone(spec, backstage.shared.providers);\n      }),\n      grid: make$2(function (spec, backstage) {\n        return renderGrid(spec, backstage.shared);\n      }),\n      listbox: make$2(function (spec, backstage) {\n        return renderListBox(spec, backstage);\n      }),\n      selectbox: make$2(function (spec, backstage) {\n        return renderSelectBox(spec, backstage.shared.providers);\n      }),\n      sizeinput: make$2(function (spec, backstage) {\n        return renderSizeInput(spec, backstage.shared.providers);\n      }),\n      urlinput: make$2(function (spec, backstage) {\n        return renderUrlInput(spec, backstage, backstage.urlinput);\n      }),\n      customeditor: make$2(renderCustomEditor),\n      htmlpanel: make$2(renderHtmlPanel),\n      imagetools: make$2(function (spec, backstage) {\n        return renderImageTools(spec, backstage.shared.providers);\n      }),\n      table: make$2(function (spec, backstage) {\n        return renderTable(spec, backstage.shared.providers);\n      }),\n      panel: make$2(function (spec, backstage) {\n        return renderPanel(spec, backstage);\n      })\n    };\n    var noFormParts = {\n      field: function (_name, spec) {\n        return spec;\n      }\n    };\n    var interpretInForm = function (parts, spec, oldBackstage) {\n      var newBackstage = deepMerge(oldBackstage, {\n        shared: {\n          interpreter: function (childSpec) {\n            return interpretParts(parts, childSpec, newBackstage);\n          }\n        }\n      });\n      return interpretParts(parts, spec, newBackstage);\n    };\n    var interpretParts = function (parts, spec, backstage) {\n      return get$e(factories, spec.type).fold(function () {\n        console.error('Unknown factory type \"' + spec.type + '\", defaulting to container: ', spec);\n        return spec;\n      }, function (factory) {\n        return factory(parts, spec, backstage);\n      });\n    };\n    var interpretWithoutForm = function (spec, backstage) {\n      var parts = noFormParts;\n      return interpretParts(parts, spec, backstage);\n    };\n\n    var bubbleAlignments$2 = {\n      valignCentre: [],\n      alignCentre: [],\n      alignLeft: [],\n      alignRight: [],\n      right: [],\n      left: [],\n      bottom: [],\n      top: []\n    };\n    var getInlineDialogAnchor = function (contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor) {\n      var bubbleSize = 12;\n      var overrides = { maxHeightFunction: expandable$1() };\n      var editableAreaAnchor = function () {\n        return {\n          type: 'node',\n          root: getContentContainer(contentAreaElement()),\n          node: Optional.from(contentAreaElement()),\n          bubble: nu$5(bubbleSize, bubbleSize, bubbleAlignments$2),\n          layouts: {\n            onRtl: function () {\n              return [northeast];\n            },\n            onLtr: function () {\n              return [northwest];\n            }\n          },\n          overrides: overrides\n        };\n      };\n      var standardAnchor = function () {\n        return {\n          type: 'hotspot',\n          hotspot: lazyAnchorbar(),\n          bubble: nu$5(-bubbleSize, bubbleSize, bubbleAlignments$2),\n          layouts: {\n            onRtl: function () {\n              return [southeast$2];\n            },\n            onLtr: function () {\n              return [southwest$2];\n            }\n          },\n          overrides: overrides\n        };\n      };\n      return function () {\n        return lazyUseEditableAreaAnchor() ? editableAreaAnchor() : standardAnchor();\n      };\n    };\n    var getBannerAnchor = function (contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor) {\n      var editableAreaAnchor = function () {\n        return {\n          type: 'node',\n          root: getContentContainer(contentAreaElement()),\n          node: Optional.from(contentAreaElement()),\n          layouts: {\n            onRtl: function () {\n              return [north];\n            },\n            onLtr: function () {\n              return [north];\n            }\n          }\n        };\n      };\n      var standardAnchor = function () {\n        return {\n          type: 'hotspot',\n          hotspot: lazyAnchorbar(),\n          layouts: {\n            onRtl: function () {\n              return [south$2];\n            },\n            onLtr: function () {\n              return [south$2];\n            }\n          }\n        };\n      };\n      return function () {\n        return lazyUseEditableAreaAnchor() ? editableAreaAnchor() : standardAnchor();\n      };\n    };\n    var getCursorAnchor = function (editor, bodyElement) {\n      return function () {\n        return {\n          type: 'selection',\n          root: bodyElement(),\n          getSelection: function () {\n            var rng = editor.selection.getRng();\n            return Optional.some(SimSelection.range(SugarElement.fromDom(rng.startContainer), rng.startOffset, SugarElement.fromDom(rng.endContainer), rng.endOffset));\n          }\n        };\n      };\n    };\n    var getNodeAnchor$1 = function (bodyElement) {\n      return function (element) {\n        return {\n          type: 'node',\n          root: bodyElement(),\n          node: element\n        };\n      };\n    };\n    var getAnchors = function (editor, lazyAnchorbar, isToolbarTop) {\n      var useFixedToolbarContainer = useFixedContainer(editor);\n      var bodyElement = function () {\n        return SugarElement.fromDom(editor.getBody());\n      };\n      var contentAreaElement = function () {\n        return SugarElement.fromDom(editor.getContentAreaContainer());\n      };\n      var lazyUseEditableAreaAnchor = function () {\n        return useFixedToolbarContainer || !isToolbarTop();\n      };\n      return {\n        inlineDialog: getInlineDialogAnchor(contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor),\n        banner: getBannerAnchor(contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor),\n        cursor: getCursorAnchor(editor, bodyElement),\n        node: getNodeAnchor$1(bodyElement)\n      };\n    };\n\n    var colorPicker = function (editor) {\n      return function (callback, value) {\n        var dialog = colorPickerDialog(editor);\n        dialog(callback, value);\n      };\n    };\n    var hasCustomColors = function (editor) {\n      return function () {\n        return hasCustomColors$1(editor);\n      };\n    };\n    var getColors = function (editor) {\n      return function () {\n        return getColors$2(editor);\n      };\n    };\n    var getColorCols = function (editor) {\n      return function () {\n        return getColorCols$1(editor);\n      };\n    };\n    var ColorInputBackstage = function (editor) {\n      return {\n        colorPicker: colorPicker(editor),\n        hasCustomColors: hasCustomColors(editor),\n        getColors: getColors(editor),\n        getColorCols: getColorCols(editor)\n      };\n    };\n\n    var isDraggableModal = function (editor) {\n      return function () {\n        return isDraggableModal$1(editor);\n      };\n    };\n    var DialogBackstage = function (editor) {\n      return { isDraggableModal: isDraggableModal(editor) };\n    };\n\n    var HeaderBackstage = function (editor) {\n      var mode = Cell(isToolbarLocationBottom(editor) ? 'bottom' : 'top');\n      return {\n        isPositionedAtTop: function () {\n          return mode.get() === 'top';\n        },\n        getDockingMode: mode.get,\n        setDockingMode: mode.set\n      };\n    };\n\n    var defaultStyleFormats = [\n      {\n        title: 'Headings',\n        items: [\n          {\n            title: 'Heading 1',\n            format: 'h1'\n          },\n          {\n            title: 'Heading 2',\n            format: 'h2'\n          },\n          {\n            title: 'Heading 3',\n            format: 'h3'\n          },\n          {\n            title: 'Heading 4',\n            format: 'h4'\n          },\n          {\n            title: 'Heading 5',\n            format: 'h5'\n          },\n          {\n            title: 'Heading 6',\n            format: 'h6'\n          }\n        ]\n      },\n      {\n        title: 'Inline',\n        items: [\n          {\n            title: 'Bold',\n            format: 'bold'\n          },\n          {\n            title: 'Italic',\n            format: 'italic'\n          },\n          {\n            title: 'Underline',\n            format: 'underline'\n          },\n          {\n            title: 'Strikethrough',\n            format: 'strikethrough'\n          },\n          {\n            title: 'Superscript',\n            format: 'superscript'\n          },\n          {\n            title: 'Subscript',\n            format: 'subscript'\n          },\n          {\n            title: 'Code',\n            format: 'code'\n          }\n        ]\n      },\n      {\n        title: 'Blocks',\n        items: [\n          {\n            title: 'Paragraph',\n            format: 'p'\n          },\n          {\n            title: 'Blockquote',\n            format: 'blockquote'\n          },\n          {\n            title: 'Div',\n            format: 'div'\n          },\n          {\n            title: 'Pre',\n            format: 'pre'\n          }\n        ]\n      },\n      {\n        title: 'Align',\n        items: [\n          {\n            title: 'Left',\n            format: 'alignleft'\n          },\n          {\n            title: 'Center',\n            format: 'aligncenter'\n          },\n          {\n            title: 'Right',\n            format: 'alignright'\n          },\n          {\n            title: 'Justify',\n            format: 'alignjustify'\n          }\n        ]\n      }\n    ];\n    var isNestedFormat = function (format) {\n      return has$2(format, 'items');\n    };\n    var isBlockFormat = function (format) {\n      return has$2(format, 'block');\n    };\n    var isInlineFormat = function (format) {\n      return has$2(format, 'inline');\n    };\n    var isSelectorFormat = function (format) {\n      return has$2(format, 'selector');\n    };\n    var mapFormats = function (userFormats) {\n      return foldl(userFormats, function (acc, fmt) {\n        if (isNestedFormat(fmt)) {\n          var result = mapFormats(fmt.items);\n          return {\n            customFormats: acc.customFormats.concat(result.customFormats),\n            formats: acc.formats.concat([{\n                title: fmt.title,\n                items: result.formats\n              }])\n          };\n        } else if (isInlineFormat(fmt) || isBlockFormat(fmt) || isSelectorFormat(fmt)) {\n          var formatName = isString(fmt.name) ? fmt.name : fmt.title.toLowerCase();\n          var formatNameWithPrefix = 'custom-' + formatName;\n          return {\n            customFormats: acc.customFormats.concat([{\n                name: formatNameWithPrefix,\n                format: fmt\n              }]),\n            formats: acc.formats.concat([{\n                title: fmt.title,\n                format: formatNameWithPrefix,\n                icon: fmt.icon\n              }])\n          };\n        } else {\n          return __assign(__assign({}, acc), { formats: acc.formats.concat(fmt) });\n        }\n      }, {\n        customFormats: [],\n        formats: []\n      });\n    };\n    var registerCustomFormats = function (editor, userFormats) {\n      var result = mapFormats(userFormats);\n      var registerFormats = function (customFormats) {\n        each$1(customFormats, function (fmt) {\n          if (!editor.formatter.has(fmt.name)) {\n            editor.formatter.register(fmt.name, fmt.format);\n          }\n        });\n      };\n      if (editor.formatter) {\n        registerFormats(result.customFormats);\n      } else {\n        editor.on('init', function () {\n          registerFormats(result.customFormats);\n        });\n      }\n      return result.formats;\n    };\n    var getStyleFormats = function (editor) {\n      return getUserStyleFormats(editor).map(function (userFormats) {\n        var registeredUserFormats = registerCustomFormats(editor, userFormats);\n        return isMergeStyleFormats(editor) ? defaultStyleFormats.concat(registeredUserFormats) : registeredUserFormats;\n      }).getOr(defaultStyleFormats);\n    };\n\n    var processBasic = function (item, isSelectedFor, getPreviewFor) {\n      var formatterSpec = {\n        type: 'formatter',\n        isSelected: isSelectedFor(item.format),\n        getStylePreview: getPreviewFor(item.format)\n      };\n      return deepMerge(item, formatterSpec);\n    };\n    var register$8 = function (editor, formats, isSelectedFor, getPreviewFor) {\n      var enrichSupported = function (item) {\n        return processBasic(item, isSelectedFor, getPreviewFor);\n      };\n      var enrichMenu = function (item) {\n        var submenuSpec = { type: 'submenu' };\n        return deepMerge(item, submenuSpec);\n      };\n      var enrichCustom = function (item) {\n        var formatName = isString(item.name) ? item.name : generate$6(item.title);\n        var formatNameWithPrefix = 'custom-' + formatName;\n        var customSpec = {\n          type: 'formatter',\n          format: formatNameWithPrefix,\n          isSelected: isSelectedFor(formatNameWithPrefix),\n          getStylePreview: getPreviewFor(formatNameWithPrefix)\n        };\n        var newItem = deepMerge(item, customSpec);\n        editor.formatter.register(formatName, newItem);\n        return newItem;\n      };\n      var doEnrich = function (items) {\n        return map$2(items, function (item) {\n          var keys$1 = keys(item);\n          if (hasNonNullableKey(item, 'items')) {\n            var newItems = doEnrich(item.items);\n            return deepMerge(enrichMenu(item), { getStyleItems: constant$1(newItems) });\n          } else if (hasNonNullableKey(item, 'format')) {\n            return enrichSupported(item);\n          } else if (keys$1.length === 1 && contains$2(keys$1, 'title')) {\n            return deepMerge(item, { type: 'separator' });\n          } else {\n            return enrichCustom(item);\n          }\n        });\n      };\n      return doEnrich(formats);\n    };\n\n    var init$8 = function (editor) {\n      var isSelectedFor = function (format) {\n        return function () {\n          return editor.formatter.match(format);\n        };\n      };\n      var getPreviewFor = function (format) {\n        return function () {\n          var fmt = editor.formatter.get(format);\n          return fmt !== undefined ? Optional.some({\n            tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n            styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n          }) : Optional.none();\n        };\n      };\n      var flatten = function (fmt) {\n        var subs = fmt.items;\n        return subs !== undefined && subs.length > 0 ? bind$3(subs, flatten) : [fmt.format];\n      };\n      var settingsFormats = Cell([]);\n      var settingsFlattenedFormats = Cell([]);\n      var eventsFormats = Cell([]);\n      var eventsFlattenedFormats = Cell([]);\n      var replaceSettings = Cell(false);\n      editor.on('PreInit', function (_e) {\n        var formats = getStyleFormats(editor);\n        var enriched = register$8(editor, formats, isSelectedFor, getPreviewFor);\n        settingsFormats.set(enriched);\n        settingsFlattenedFormats.set(bind$3(enriched, flatten));\n      });\n      editor.on('addStyleModifications', function (e) {\n        var modifications = register$8(editor, e.items, isSelectedFor, getPreviewFor);\n        eventsFormats.set(modifications);\n        replaceSettings.set(e.replace);\n        eventsFlattenedFormats.set(bind$3(modifications, flatten));\n      });\n      var getData = function () {\n        var fromSettings = replaceSettings.get() ? [] : settingsFormats.get();\n        var fromEvents = eventsFormats.get();\n        return fromSettings.concat(fromEvents);\n      };\n      var getFlattenedKeys = function () {\n        var fromSettings = replaceSettings.get() ? [] : settingsFlattenedFormats.get();\n        var fromEvents = eventsFlattenedFormats.get();\n        return fromSettings.concat(fromEvents);\n      };\n      return {\n        getData: getData,\n        getFlattenedKeys: getFlattenedKeys\n      };\n    };\n\n    var isElement = function (node) {\n      return isNonNullable(node) && node.nodeType === 1;\n    };\n    var trim = global$5.trim;\n    var hasContentEditableState = function (value) {\n      return function (node) {\n        if (isElement(node)) {\n          if (node.contentEditable === value) {\n            return true;\n          }\n          if (node.getAttribute('data-mce-contenteditable') === value) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var isContentEditableTrue = hasContentEditableState('true');\n    var isContentEditableFalse = hasContentEditableState('false');\n    var create = function (type, title, url, level, attach) {\n      return {\n        type: type,\n        title: title,\n        url: url,\n        level: level,\n        attach: attach\n      };\n    };\n    var isChildOfContentEditableTrue = function (node) {\n      while (node = node.parentNode) {\n        var value = node.contentEditable;\n        if (value && value !== 'inherit') {\n          return isContentEditableTrue(node);\n        }\n      }\n      return false;\n    };\n    var select = function (selector, root) {\n      return map$2(descendants(SugarElement.fromDom(root), selector), function (element) {\n        return element.dom;\n      });\n    };\n    var getElementText = function (elm) {\n      return elm.innerText || elm.textContent;\n    };\n    var getOrGenerateId = function (elm) {\n      return elm.id ? elm.id : generate$6('h');\n    };\n    var isAnchor = function (elm) {\n      return elm && elm.nodeName === 'A' && (elm.id || elm.name) !== undefined;\n    };\n    var isValidAnchor = function (elm) {\n      return isAnchor(elm) && isEditable(elm);\n    };\n    var isHeader = function (elm) {\n      return elm && /^(H[1-6])$/.test(elm.nodeName);\n    };\n    var isEditable = function (elm) {\n      return isChildOfContentEditableTrue(elm) && !isContentEditableFalse(elm);\n    };\n    var isValidHeader = function (elm) {\n      return isHeader(elm) && isEditable(elm);\n    };\n    var getLevel = function (elm) {\n      return isHeader(elm) ? parseInt(elm.nodeName.substr(1), 10) : 0;\n    };\n    var headerTarget = function (elm) {\n      var headerId = getOrGenerateId(elm);\n      var attach = function () {\n        elm.id = headerId;\n      };\n      return create('header', getElementText(elm), '#' + headerId, getLevel(elm), attach);\n    };\n    var anchorTarget = function (elm) {\n      var anchorId = elm.id || elm.name;\n      var anchorText = getElementText(elm);\n      return create('anchor', anchorText ? anchorText : '#' + anchorId, '#' + anchorId, 0, noop);\n    };\n    var getHeaderTargets = function (elms) {\n      return map$2(filter$2(elms, isValidHeader), headerTarget);\n    };\n    var getAnchorTargets = function (elms) {\n      return map$2(filter$2(elms, isValidAnchor), anchorTarget);\n    };\n    var getTargetElements = function (elm) {\n      var elms = select('h1,h2,h3,h4,h5,h6,a:not([href])', elm);\n      return elms;\n    };\n    var hasTitle = function (target) {\n      return trim(target.title).length > 0;\n    };\n    var find = function (elm) {\n      var elms = getTargetElements(elm);\n      return filter$2(getHeaderTargets(elms).concat(getAnchorTargets(elms)), hasTitle);\n    };\n    var LinkTargets = { find: find };\n\n    var STORAGE_KEY = 'tinymce-url-history';\n    var HISTORY_LENGTH = 5;\n    var isHttpUrl = function (url) {\n      return isString(url) && /^https?/.test(url);\n    };\n    var isArrayOfUrl = function (a) {\n      return isArray(a) && a.length <= HISTORY_LENGTH && forall(a, isHttpUrl);\n    };\n    var isRecordOfUrlArray = function (r) {\n      return isObject(r) && find$4(r, function (value) {\n        return !isArrayOfUrl(value);\n      }).isNone();\n    };\n    var getAllHistory = function () {\n      var unparsedHistory = global$8.getItem(STORAGE_KEY);\n      if (unparsedHistory === null) {\n        return {};\n      }\n      var history;\n      try {\n        history = JSON.parse(unparsedHistory);\n      } catch (e) {\n        if (e instanceof SyntaxError) {\n          console.log('Local storage ' + STORAGE_KEY + ' was not valid JSON', e);\n          return {};\n        }\n        throw e;\n      }\n      if (!isRecordOfUrlArray(history)) {\n        console.log('Local storage ' + STORAGE_KEY + ' was not valid format', history);\n        return {};\n      }\n      return history;\n    };\n    var setAllHistory = function (history) {\n      if (!isRecordOfUrlArray(history)) {\n        throw new Error('Bad format for history:\\n' + JSON.stringify(history));\n      }\n      global$8.setItem(STORAGE_KEY, JSON.stringify(history));\n    };\n    var getHistory = function (fileType) {\n      var history = getAllHistory();\n      return get$e(history, fileType).getOr([]);\n    };\n    var addToHistory = function (url, fileType) {\n      if (!isHttpUrl(url)) {\n        return;\n      }\n      var history = getAllHistory();\n      var items = get$e(history, fileType).getOr([]);\n      var itemsWithoutUrl = filter$2(items, function (item) {\n        return item !== url;\n      });\n      history[fileType] = [url].concat(itemsWithoutUrl).slice(0, HISTORY_LENGTH);\n      setAllHistory(history);\n    };\n\n    var isTruthy = function (value) {\n      return !!value;\n    };\n    var makeMap = function (value) {\n      return map$1(global$5.makeMap(value, /[, ]/), isTruthy);\n    };\n    var getPicker = function (editor) {\n      return Optional.from(getFilePickerCallback(editor)).filter(isFunction);\n    };\n    var getPickerTypes = function (editor) {\n      var optFileTypes = Optional.some(getFilePickerTypes(editor)).filter(isTruthy);\n      var optLegacyTypes = Optional.some(getFileBrowserCallbackTypes(editor)).filter(isTruthy);\n      var optTypes = optFileTypes.or(optLegacyTypes).map(makeMap);\n      return getPicker(editor).fold(never, function (_picker) {\n        return optTypes.fold(always, function (types) {\n          return keys(types).length > 0 ? types : false;\n        });\n      });\n    };\n    var getPickerSetting = function (editor, filetype) {\n      var pickerTypes = getPickerTypes(editor);\n      if (isBoolean(pickerTypes)) {\n        return pickerTypes ? getPicker(editor) : Optional.none();\n      } else {\n        return pickerTypes[filetype] ? getPicker(editor) : Optional.none();\n      }\n    };\n    var getUrlPicker = function (editor, filetype) {\n      return getPickerSetting(editor, filetype).map(function (picker) {\n        return function (entry) {\n          return Future.nu(function (completer) {\n            var handler = function (value, meta) {\n              if (!isString(value)) {\n                throw new Error('Expected value to be string');\n              }\n              if (meta !== undefined && !isObject(meta)) {\n                throw new Error('Expected meta to be a object');\n              }\n              var r = {\n                value: value,\n                meta: meta\n              };\n              completer(r);\n            };\n            var meta = __assign({\n              filetype: filetype,\n              fieldname: entry.fieldname\n            }, Optional.from(entry.meta).getOr({}));\n            picker.call(editor, handler, entry.value, meta);\n          });\n        };\n      });\n    };\n    var getTextSetting = function (value) {\n      return Optional.from(value).filter(isString).getOrUndefined();\n    };\n    var getLinkInformation = function (editor) {\n      if (noTypeaheadUrls(editor)) {\n        return Optional.none();\n      }\n      return Optional.some({\n        targets: LinkTargets.find(editor.getBody()),\n        anchorTop: getTextSetting(getAnchorTop(editor)),\n        anchorBottom: getTextSetting(getAnchorBottom(editor))\n      });\n    };\n    var getValidationHandler = function (editor) {\n      return Optional.from(getFilePickerValidatorHandler(editor));\n    };\n    var UrlInputBackstage = function (editor) {\n      return {\n        getHistory: getHistory,\n        addToHistory: addToHistory,\n        getLinkInformation: function () {\n          return getLinkInformation(editor);\n        },\n        getValidationHandler: function () {\n          return getValidationHandler(editor);\n        },\n        getUrlPicker: function (filetype) {\n          return getUrlPicker(editor, filetype);\n        }\n      };\n    };\n\n    var init$7 = function (sink, editor, lazyAnchorbar) {\n      var contextMenuState = Cell(false);\n      var toolbar = HeaderBackstage(editor);\n      var backstage = {\n        shared: {\n          providers: {\n            icons: function () {\n              return editor.ui.registry.getAll().icons;\n            },\n            menuItems: function () {\n              return editor.ui.registry.getAll().menuItems;\n            },\n            translate: global$e.translate,\n            isDisabled: function () {\n              return editor.mode.isReadOnly() || editor.ui.isDisabled();\n            },\n            getSetting: editor.getParam.bind(editor)\n          },\n          interpreter: function (s) {\n            return interpretWithoutForm(s, backstage);\n          },\n          anchors: getAnchors(editor, lazyAnchorbar, toolbar.isPositionedAtTop),\n          header: toolbar,\n          getSink: function () {\n            return Result.value(sink);\n          }\n        },\n        urlinput: UrlInputBackstage(editor),\n        styleselect: init$8(editor),\n        colorinput: ColorInputBackstage(editor),\n        dialog: DialogBackstage(editor),\n        isContextMenuOpen: function () {\n          return contextMenuState.get();\n        },\n        setContextMenuState: function (state) {\n          return contextMenuState.set(state);\n        }\n      };\n      return backstage;\n    };\n\n    var setup$b = function (editor, mothership, uiMothership) {\n      var broadcastEvent = function (name, evt) {\n        each$1([\n          mothership,\n          uiMothership\n        ], function (ship) {\n          ship.broadcastEvent(name, evt);\n        });\n      };\n      var broadcastOn = function (channel, message) {\n        each$1([\n          mothership,\n          uiMothership\n        ], function (ship) {\n          ship.broadcastOn([channel], message);\n        });\n      };\n      var fireDismissPopups = function (evt) {\n        return broadcastOn(dismissPopups(), { target: evt.target });\n      };\n      var doc = getDocument();\n      var onTouchstart = bind(doc, 'touchstart', fireDismissPopups);\n      var onTouchmove = bind(doc, 'touchmove', function (evt) {\n        return broadcastEvent(documentTouchmove(), evt);\n      });\n      var onTouchend = bind(doc, 'touchend', function (evt) {\n        return broadcastEvent(documentTouchend(), evt);\n      });\n      var onMousedown = bind(doc, 'mousedown', fireDismissPopups);\n      var onMouseup = bind(doc, 'mouseup', function (evt) {\n        if (evt.raw.button === 0) {\n          broadcastOn(mouseReleased(), { target: evt.target });\n        }\n      });\n      var onContentClick = function (raw) {\n        return broadcastOn(dismissPopups(), { target: SugarElement.fromDom(raw.target) });\n      };\n      var onContentMouseup = function (raw) {\n        if (raw.button === 0) {\n          broadcastOn(mouseReleased(), { target: SugarElement.fromDom(raw.target) });\n        }\n      };\n      var onContentMousedown = function () {\n        each$1(editor.editorManager.get(), function (loopEditor) {\n          if (editor !== loopEditor) {\n            loopEditor.fire('DismissPopups', { relatedTarget: editor });\n          }\n        });\n      };\n      var onWindowScroll = function (evt) {\n        return broadcastEvent(windowScroll(), fromRawEvent(evt));\n      };\n      var onWindowResize = function (evt) {\n        broadcastOn(repositionPopups(), {});\n        broadcastEvent(windowResize(), fromRawEvent(evt));\n      };\n      var onEditorResize = function () {\n        return broadcastOn(repositionPopups(), {});\n      };\n      var onEditorProgress = function (evt) {\n        if (evt.state) {\n          broadcastOn(dismissPopups(), { target: SugarElement.fromDom(editor.getContainer()) });\n        }\n      };\n      var onDismissPopups = function (event) {\n        broadcastOn(dismissPopups(), { target: SugarElement.fromDom(event.relatedTarget.getContainer()) });\n      };\n      editor.on('PostRender', function () {\n        editor.on('click', onContentClick);\n        editor.on('tap', onContentClick);\n        editor.on('mouseup', onContentMouseup);\n        editor.on('mousedown', onContentMousedown);\n        editor.on('ScrollWindow', onWindowScroll);\n        editor.on('ResizeWindow', onWindowResize);\n        editor.on('ResizeEditor', onEditorResize);\n        editor.on('AfterProgressState', onEditorProgress);\n        editor.on('DismissPopups', onDismissPopups);\n      });\n      editor.on('remove', function () {\n        editor.off('click', onContentClick);\n        editor.off('tap', onContentClick);\n        editor.off('mouseup', onContentMouseup);\n        editor.off('mousedown', onContentMousedown);\n        editor.off('ScrollWindow', onWindowScroll);\n        editor.off('ResizeWindow', onWindowResize);\n        editor.off('ResizeEditor', onEditorResize);\n        editor.off('AfterProgressState', onEditorProgress);\n        editor.off('DismissPopups', onDismissPopups);\n        onMousedown.unbind();\n        onTouchstart.unbind();\n        onTouchmove.unbind();\n        onTouchend.unbind();\n        onMouseup.unbind();\n      });\n      editor.on('detach', function () {\n        detachSystem(mothership);\n        detachSystem(uiMothership);\n        mothership.destroy();\n        uiMothership.destroy();\n      });\n    };\n\n    var parts$a = AlloyParts;\n    var partType = PartType;\n\n    var schema$f = constant$1([\n      defaulted('shell', false),\n      required$1('makeItem'),\n      defaulted('setupItem', noop),\n      SketchBehaviours.field('listBehaviours', [Replacing])\n    ]);\n    var customListDetail = function () {\n      return { behaviours: derive$1([Replacing.config({})]) };\n    };\n    var itemsPart = optional({\n      name: 'items',\n      overrides: customListDetail\n    });\n    var parts$9 = constant$1([itemsPart]);\n    var name = constant$1('CustomList');\n\n    var factory$d = function (detail, components, _spec, _external) {\n      var setItems = function (list, items) {\n        getListContainer(list).fold(function () {\n          console.error('Custom List was defined to not be a shell, but no item container was specified in components');\n          throw new Error('Custom List was defined to not be a shell, but no item container was specified in components');\n        }, function (container) {\n          var itemComps = Replacing.contents(container);\n          var numListsRequired = items.length;\n          var numListsToAdd = numListsRequired - itemComps.length;\n          var itemsToAdd = numListsToAdd > 0 ? range$2(numListsToAdd, function () {\n            return detail.makeItem();\n          }) : [];\n          var itemsToRemove = itemComps.slice(numListsRequired);\n          each$1(itemsToRemove, function (item) {\n            return Replacing.remove(container, item);\n          });\n          each$1(itemsToAdd, function (item) {\n            return Replacing.append(container, item);\n          });\n          var builtLists = Replacing.contents(container);\n          each$1(builtLists, function (item, i) {\n            detail.setupItem(list, item, items[i], i);\n          });\n        });\n      };\n      var extra = detail.shell ? {\n        behaviours: [Replacing.config({})],\n        components: []\n      } : {\n        behaviours: [],\n        components: components\n      };\n      var getListContainer = function (component) {\n        return detail.shell ? Optional.some(component) : getPart(component, detail, 'items');\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: extra.components,\n        behaviours: augment(detail.listBehaviours, extra.behaviours),\n        apis: { setItems: setItems }\n      };\n    };\n    var CustomList = composite({\n      name: name(),\n      configFields: schema$f(),\n      partFields: parts$9(),\n      factory: factory$d,\n      apis: {\n        setItems: function (apis, list, items) {\n          apis.setItems(list, items);\n        }\n      }\n    });\n\n    var schema$e = constant$1([\n      required$1('dom'),\n      defaulted('shell', true),\n      field('toolbarBehaviours', [Replacing])\n    ]);\n    var enhanceGroups = function () {\n      return { behaviours: derive$1([Replacing.config({})]) };\n    };\n    var parts$8 = constant$1([optional({\n        name: 'groups',\n        overrides: enhanceGroups\n      })]);\n\n    var factory$c = function (detail, components, _spec, _externals) {\n      var setGroups = function (toolbar, groups) {\n        getGroupContainer(toolbar).fold(function () {\n          console.error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n          throw new Error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n        }, function (container) {\n          Replacing.set(container, groups);\n        });\n      };\n      var getGroupContainer = function (component) {\n        return detail.shell ? Optional.some(component) : getPart(component, detail, 'groups');\n      };\n      var extra = detail.shell ? {\n        behaviours: [Replacing.config({})],\n        components: []\n      } : {\n        behaviours: [],\n        components: components\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: extra.components,\n        behaviours: augment(detail.toolbarBehaviours, extra.behaviours),\n        apis: { setGroups: setGroups },\n        domModification: { attributes: { role: 'group' } }\n      };\n    };\n    var Toolbar = composite({\n      name: 'Toolbar',\n      configFields: schema$e(),\n      partFields: parts$8(),\n      factory: factory$c,\n      apis: {\n        setGroups: function (apis, toolbar, groups) {\n          apis.setGroups(toolbar, groups);\n        }\n      }\n    });\n\n    var setup$a = noop;\n    var isDocked$2 = never;\n    var getBehaviours$1 = constant$1([]);\n\n    var StaticHeader = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setup: setup$a,\n        isDocked: isDocked$2,\n        getBehaviours: getBehaviours$1\n    });\n\n    var getOffsetParent = function (element) {\n      var isFixed = is$1(getRaw(element, 'position'), 'fixed');\n      var offsetParent$1 = isFixed ? Optional.none() : offsetParent(element);\n      return offsetParent$1.orThunk(function () {\n        var marker = SugarElement.fromTag('span');\n        return parent(element).bind(function (parent) {\n          append$2(parent, marker);\n          var offsetParent$1 = offsetParent(marker);\n          remove$5(marker);\n          return offsetParent$1;\n        });\n      });\n    };\n    var getOrigin = function (element) {\n      return getOffsetParent(element).map(absolute$3).getOrThunk(function () {\n        return SugarPosition(0, 0);\n      });\n    };\n\n    var morphAdt = Adt.generate([\n      { static: [] },\n      { absolute: ['positionCss'] },\n      { fixed: ['positionCss'] }\n    ]);\n    var appear = function (component, contextualInfo) {\n      var elem = component.element;\n      add$2(elem, contextualInfo.transitionClass);\n      remove$2(elem, contextualInfo.fadeOutClass);\n      add$2(elem, contextualInfo.fadeInClass);\n      contextualInfo.onShow(component);\n    };\n    var disappear = function (component, contextualInfo) {\n      var elem = component.element;\n      add$2(elem, contextualInfo.transitionClass);\n      remove$2(elem, contextualInfo.fadeInClass);\n      add$2(elem, contextualInfo.fadeOutClass);\n      contextualInfo.onHide(component);\n    };\n    var isPartiallyVisible = function (box, viewport) {\n      return box.y < viewport.bottom && box.bottom > viewport.y;\n    };\n    var isTopCompletelyVisible = function (box, viewport) {\n      return box.y >= viewport.y;\n    };\n    var isBottomCompletelyVisible = function (box, viewport) {\n      return box.bottom <= viewport.bottom;\n    };\n    var isVisibleForModes = function (modes, box, viewport) {\n      return forall(modes, function (mode) {\n        switch (mode) {\n        case 'bottom':\n          return isBottomCompletelyVisible(box, viewport);\n        case 'top':\n          return isTopCompletelyVisible(box, viewport);\n        }\n      });\n    };\n    var getPrior = function (elem, state) {\n      return state.getInitialPos().map(function (pos) {\n        return bounds(pos.bounds.x, pos.bounds.y, get$a(elem), get$b(elem));\n      });\n    };\n    var storePrior = function (elem, box, state) {\n      state.setInitialPos({\n        style: getAllRaw(elem),\n        position: get$c(elem, 'position') || 'static',\n        bounds: box\n      });\n    };\n    var revertToOriginal = function (elem, box, state) {\n      return state.getInitialPos().bind(function (position) {\n        state.clearInitialPos();\n        switch (position.position) {\n        case 'static':\n          return Optional.some(morphAdt.static());\n        case 'absolute':\n          var offsetBox_1 = getOffsetParent(elem).map(box$1).getOrThunk(function () {\n            return box$1(body());\n          });\n          return Optional.some(morphAdt.absolute(NuPositionCss('absolute', get$e(position.style, 'left').map(function (_left) {\n            return box.x - offsetBox_1.x;\n          }), get$e(position.style, 'top').map(function (_top) {\n            return box.y - offsetBox_1.y;\n          }), get$e(position.style, 'right').map(function (_right) {\n            return offsetBox_1.right - box.right;\n          }), get$e(position.style, 'bottom').map(function (_bottom) {\n            return offsetBox_1.bottom - box.bottom;\n          }))));\n        default:\n          return Optional.none();\n        }\n      });\n    };\n    var morphToOriginal = function (elem, viewport, state) {\n      return getPrior(elem, state).filter(function (box) {\n        return isVisibleForModes(state.getModes(), box, viewport);\n      }).bind(function (box) {\n        return revertToOriginal(elem, box, state);\n      });\n    };\n    var morphToFixed = function (elem, viewport, state) {\n      var box = box$1(elem);\n      if (!isVisibleForModes(state.getModes(), box, viewport)) {\n        storePrior(elem, box, state);\n        var winBox = win();\n        var left = box.x - winBox.x;\n        var top_1 = viewport.y - winBox.y;\n        var bottom = winBox.bottom - viewport.bottom;\n        var isTop = box.y <= viewport.y;\n        return Optional.some(morphAdt.fixed(NuPositionCss('fixed', Optional.some(left), isTop ? Optional.some(top_1) : Optional.none(), Optional.none(), !isTop ? Optional.some(bottom) : Optional.none())));\n      } else {\n        return Optional.none();\n      }\n    };\n    var getMorph = function (component, viewport, state) {\n      var elem = component.element;\n      var isDocked = is$1(getRaw(elem, 'position'), 'fixed');\n      return isDocked ? morphToOriginal(elem, viewport, state) : morphToFixed(elem, viewport, state);\n    };\n    var getMorphToOriginal = function (component, state) {\n      var elem = component.element;\n      return getPrior(elem, state).bind(function (box) {\n        return revertToOriginal(elem, box, state);\n      });\n    };\n\n    var morphToStatic = function (component, config, state) {\n      state.setDocked(false);\n      each$1([\n        'left',\n        'right',\n        'top',\n        'bottom',\n        'position'\n      ], function (prop) {\n        return remove$6(component.element, prop);\n      });\n      config.onUndocked(component);\n    };\n    var morphToCoord = function (component, config, state, position) {\n      var isDocked = position.position === 'fixed';\n      state.setDocked(isDocked);\n      applyPositionCss(component.element, position);\n      var method = isDocked ? config.onDocked : config.onUndocked;\n      method(component);\n    };\n    var updateVisibility = function (component, config, state, viewport, morphToDocked) {\n      if (morphToDocked === void 0) {\n        morphToDocked = false;\n      }\n      config.contextual.each(function (contextInfo) {\n        contextInfo.lazyContext(component).each(function (box) {\n          var isVisible = isPartiallyVisible(box, viewport);\n          if (isVisible !== state.isVisible()) {\n            state.setVisible(isVisible);\n            if (morphToDocked && !isVisible) {\n              add$1(component.element, [contextInfo.fadeOutClass]);\n              contextInfo.onHide(component);\n            } else {\n              var method = isVisible ? appear : disappear;\n              method(component, contextInfo);\n            }\n          }\n        });\n      });\n    };\n    var refreshInternal = function (component, config, state) {\n      var viewport = config.lazyViewport(component);\n      var isDocked = state.isDocked();\n      if (isDocked) {\n        updateVisibility(component, config, state, viewport);\n      }\n      getMorph(component, viewport, state).each(function (morph) {\n        morph.fold(function () {\n          return morphToStatic(component, config, state);\n        }, function (position) {\n          return morphToCoord(component, config, state, position);\n        }, function (position) {\n          updateVisibility(component, config, state, viewport, true);\n          morphToCoord(component, config, state, position);\n        });\n      });\n    };\n    var resetInternal = function (component, config, state) {\n      var elem = component.element;\n      state.setDocked(false);\n      getMorphToOriginal(component, state).each(function (morph) {\n        morph.fold(function () {\n          return morphToStatic(component, config, state);\n        }, function (position) {\n          return morphToCoord(component, config, state, position);\n        }, noop);\n      });\n      state.setVisible(true);\n      config.contextual.each(function (contextInfo) {\n        remove$1(elem, [\n          contextInfo.fadeInClass,\n          contextInfo.fadeOutClass,\n          contextInfo.transitionClass\n        ]);\n        contextInfo.onShow(component);\n      });\n      refresh$4(component, config, state);\n    };\n    var refresh$4 = function (component, config, state) {\n      if (component.getSystem().isConnected()) {\n        refreshInternal(component, config, state);\n      }\n    };\n    var reset = function (component, config, state) {\n      if (state.isDocked()) {\n        resetInternal(component, config, state);\n      }\n    };\n    var isDocked$1 = function (component, config, state) {\n      return state.isDocked();\n    };\n    var setModes = function (component, config, state, modes) {\n      return state.setModes(modes);\n    };\n    var getModes = function (component, config, state) {\n      return state.getModes();\n    };\n\n    var DockingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        refresh: refresh$4,\n        reset: reset,\n        isDocked: isDocked$1,\n        getModes: getModes,\n        setModes: setModes\n    });\n\n    var events$5 = function (dockInfo, dockState) {\n      return derive$2([\n        runOnSource(transitionend(), function (component, simulatedEvent) {\n          dockInfo.contextual.each(function (contextInfo) {\n            if (has(component.element, contextInfo.transitionClass)) {\n              remove$1(component.element, [\n                contextInfo.transitionClass,\n                contextInfo.fadeInClass\n              ]);\n              var notify = dockState.isVisible() ? contextInfo.onShown : contextInfo.onHidden;\n              notify(component);\n            }\n            simulatedEvent.stop();\n          });\n        }),\n        run$1(windowScroll(), function (component, _) {\n          refresh$4(component, dockInfo, dockState);\n        }),\n        run$1(windowResize(), function (component, _) {\n          reset(component, dockInfo, dockState);\n        })\n      ]);\n    };\n\n    var ActiveDocking = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$5\n    });\n\n    var DockingSchema = [\n      optionObjOf('contextual', [\n        requiredString('fadeInClass'),\n        requiredString('fadeOutClass'),\n        requiredString('transitionClass'),\n        requiredFunction('lazyContext'),\n        onHandler('onShow'),\n        onHandler('onShown'),\n        onHandler('onHide'),\n        onHandler('onHidden')\n      ]),\n      defaultedFunction('lazyViewport', win),\n      defaultedArrayOf('modes', [\n        'top',\n        'bottom'\n      ], string),\n      onHandler('onDocked'),\n      onHandler('onUndocked')\n    ];\n\n    var init$6 = function (spec) {\n      var docked = Cell(false);\n      var visible = Cell(true);\n      var initialBounds = value$1();\n      var modes = Cell(spec.modes);\n      var readState = function () {\n        return 'docked:  ' + docked.get() + ', visible: ' + visible.get() + ', modes: ' + modes.get().join(',');\n      };\n      return nu$8({\n        isDocked: docked.get,\n        setDocked: docked.set,\n        getInitialPos: initialBounds.get,\n        setInitialPos: initialBounds.set,\n        clearInitialPos: initialBounds.clear,\n        isVisible: visible.get,\n        setVisible: visible.set,\n        getModes: modes.get,\n        setModes: modes.set,\n        readState: readState\n      });\n    };\n\n    var DockingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$6\n    });\n\n    var Docking = create$7({\n      fields: DockingSchema,\n      name: 'docking',\n      active: ActiveDocking,\n      apis: DockingApis,\n      state: DockingState\n    });\n\n    var toolbarHeightChange = constant$1(generate$6('toolbar-height-change'));\n\n    var visibility = {\n      fadeInClass: 'tox-editor-dock-fadein',\n      fadeOutClass: 'tox-editor-dock-fadeout',\n      transitionClass: 'tox-editor-dock-transition'\n    };\n    var editorStickyOnClass = 'tox-tinymce--toolbar-sticky-on';\n    var editorStickyOffClass = 'tox-tinymce--toolbar-sticky-off';\n    var scrollFromBehindHeader = function (e, containerHeader) {\n      var doc = owner$4(containerHeader);\n      var viewHeight = doc.dom.defaultView.innerHeight;\n      var scrollPos = get$9(doc);\n      var markerElement = SugarElement.fromDom(e.elm);\n      var markerPos = absolute$2(markerElement);\n      var markerHeight = get$b(markerElement);\n      var markerTop = markerPos.y;\n      var markerBottom = markerTop + markerHeight;\n      var editorHeaderPos = absolute$3(containerHeader);\n      var editorHeaderHeight = get$b(containerHeader);\n      var editorHeaderTop = editorHeaderPos.top;\n      var editorHeaderBottom = editorHeaderTop + editorHeaderHeight;\n      var editorHeaderDockedAtTop = Math.abs(editorHeaderTop - scrollPos.top) < 2;\n      var editorHeaderDockedAtBottom = Math.abs(editorHeaderBottom - (scrollPos.top + viewHeight)) < 2;\n      if (editorHeaderDockedAtTop && markerTop < editorHeaderBottom) {\n        to(scrollPos.left, markerTop - editorHeaderHeight, doc);\n      } else if (editorHeaderDockedAtBottom && markerBottom > editorHeaderTop) {\n        var y = markerTop - viewHeight + markerHeight + editorHeaderHeight;\n        to(scrollPos.left, y, doc);\n      }\n    };\n    var isDockedMode = function (header, mode) {\n      return contains$2(Docking.getModes(header), mode);\n    };\n    var updateIframeContentFlow = function (header) {\n      var getOccupiedHeight = function (elm) {\n        return getOuter$2(elm) + (parseInt(get$c(elm, 'margin-top'), 10) || 0) + (parseInt(get$c(elm, 'margin-bottom'), 10) || 0);\n      };\n      var elm = header.element;\n      parent(elm).each(function (parentElem) {\n        var padding = 'padding-' + Docking.getModes(header)[0];\n        if (Docking.isDocked(header)) {\n          var parentWidth = get$a(parentElem);\n          set$7(elm, 'width', parentWidth + 'px');\n          set$7(parentElem, padding, getOccupiedHeight(elm) + 'px');\n        } else {\n          remove$6(elm, 'width');\n          remove$6(parentElem, padding);\n        }\n      });\n    };\n    var updateSinkVisibility = function (sinkElem, visible) {\n      if (visible) {\n        remove$2(sinkElem, visibility.fadeOutClass);\n        add$1(sinkElem, [\n          visibility.transitionClass,\n          visibility.fadeInClass\n        ]);\n      } else {\n        remove$2(sinkElem, visibility.fadeInClass);\n        add$1(sinkElem, [\n          visibility.fadeOutClass,\n          visibility.transitionClass\n        ]);\n      }\n    };\n    var updateEditorClasses = function (editor, docked) {\n      var editorContainer = SugarElement.fromDom(editor.getContainer());\n      if (docked) {\n        add$2(editorContainer, editorStickyOnClass);\n        remove$2(editorContainer, editorStickyOffClass);\n      } else {\n        add$2(editorContainer, editorStickyOffClass);\n        remove$2(editorContainer, editorStickyOnClass);\n      }\n    };\n    var restoreFocus = function (headerElem, focusedElem) {\n      var ownerDoc = owner$4(focusedElem);\n      active(ownerDoc).filter(function (activeElm) {\n        return !eq(focusedElem, activeElm);\n      }).filter(function (activeElm) {\n        return eq(activeElm, SugarElement.fromDom(ownerDoc.dom.body)) || contains(headerElem, activeElm);\n      }).each(function () {\n        return focus$3(focusedElem);\n      });\n    };\n    var findFocusedElem = function (rootElm, lazySink) {\n      return search(rootElm).orThunk(function () {\n        return lazySink().toOptional().bind(function (sink) {\n          return search(sink.element);\n        });\n      });\n    };\n    var setup$9 = function (editor, sharedBackstage, lazyHeader) {\n      if (!editor.inline) {\n        if (!sharedBackstage.header.isPositionedAtTop()) {\n          editor.on('ResizeEditor', function () {\n            lazyHeader().each(Docking.reset);\n          });\n        }\n        editor.on('ResizeWindow ResizeEditor', function () {\n          lazyHeader().each(updateIframeContentFlow);\n        });\n        editor.on('SkinLoaded', function () {\n          lazyHeader().each(function (comp) {\n            Docking.isDocked(comp) ? Docking.reset(comp) : Docking.refresh(comp);\n          });\n        });\n        editor.on('FullscreenStateChanged', function () {\n          lazyHeader().each(Docking.reset);\n        });\n      }\n      editor.on('AfterScrollIntoView', function (e) {\n        lazyHeader().each(function (header) {\n          Docking.refresh(header);\n          var headerElem = header.element;\n          if (isVisible(headerElem)) {\n            scrollFromBehindHeader(e, headerElem);\n          }\n        });\n      });\n      editor.on('PostRender', function () {\n        updateEditorClasses(editor, false);\n      });\n    };\n    var isDocked = function (lazyHeader) {\n      return lazyHeader().map(Docking.isDocked).getOr(false);\n    };\n    var getIframeBehaviours = function () {\n      var _a;\n      return [Receiving.config({ channels: (_a = {}, _a[toolbarHeightChange()] = { onReceive: updateIframeContentFlow }, _a) })];\n    };\n    var getBehaviours = function (editor, sharedBackstage) {\n      var focusedElm = value$1();\n      var lazySink = sharedBackstage.getSink;\n      var runOnSinkElement = function (f) {\n        lazySink().each(function (sink) {\n          return f(sink.element);\n        });\n      };\n      var onDockingSwitch = function (comp) {\n        if (!editor.inline) {\n          updateIframeContentFlow(comp);\n        }\n        updateEditorClasses(editor, Docking.isDocked(comp));\n        comp.getSystem().broadcastOn([repositionPopups()], {});\n        lazySink().each(function (sink) {\n          return sink.getSystem().broadcastOn([repositionPopups()], {});\n        });\n      };\n      var additionalBehaviours = editor.inline ? [] : getIframeBehaviours();\n      return __spreadArray([\n        Focusing.config({}),\n        Docking.config({\n          contextual: __assign({\n            lazyContext: function (comp) {\n              var headerHeight = getOuter$2(comp.element);\n              var container = editor.inline ? editor.getContentAreaContainer() : editor.getContainer();\n              var box = box$1(SugarElement.fromDom(container));\n              var boxHeight = box.height - headerHeight;\n              var topBound = box.y + (isDockedMode(comp, 'top') ? 0 : headerHeight);\n              return Optional.some(bounds(box.x, topBound, box.width, boxHeight));\n            },\n            onShow: function () {\n              runOnSinkElement(function (elem) {\n                return updateSinkVisibility(elem, true);\n              });\n            },\n            onShown: function (comp) {\n              runOnSinkElement(function (elem) {\n                return remove$1(elem, [\n                  visibility.transitionClass,\n                  visibility.fadeInClass\n                ]);\n              });\n              focusedElm.get().each(function (elem) {\n                restoreFocus(comp.element, elem);\n                focusedElm.clear();\n              });\n            },\n            onHide: function (comp) {\n              findFocusedElem(comp.element, lazySink).fold(focusedElm.clear, focusedElm.set);\n              runOnSinkElement(function (elem) {\n                return updateSinkVisibility(elem, false);\n              });\n            },\n            onHidden: function () {\n              runOnSinkElement(function (elem) {\n                return remove$1(elem, [visibility.transitionClass]);\n              });\n            }\n          }, visibility),\n          lazyViewport: function (comp) {\n            var win$1 = win();\n            var offset = getStickyToolbarOffset(editor);\n            var top = win$1.y + (isDockedMode(comp, 'top') ? offset : 0);\n            var height = win$1.height - (isDockedMode(comp, 'bottom') ? offset : 0);\n            return bounds(win$1.x, top, win$1.width, height);\n          },\n          modes: [sharedBackstage.header.getDockingMode()],\n          onDocked: onDockingSwitch,\n          onUndocked: onDockingSwitch\n        })\n      ], additionalBehaviours, true);\n    };\n\n    var StickyHeader = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setup: setup$9,\n        isDocked: isDocked,\n        getBehaviours: getBehaviours\n    });\n\n    var renderHeader = function (spec) {\n      var editor = spec.editor;\n      var getBehaviours$2 = spec.sticky ? getBehaviours : getBehaviours$1;\n      return {\n        uid: spec.uid,\n        dom: spec.dom,\n        components: spec.components,\n        behaviours: derive$1(getBehaviours$2(editor, spec.sharedBackstage))\n      };\n    };\n\n    var groupToolbarButtonSchema = objOf([\n      requiredString('type'),\n      requiredOf('items', oneOf([\n        arrOfObj([\n          requiredString('name'),\n          requiredArrayOf('items', string)\n        ]),\n        string\n      ]))\n    ].concat(baseToolbarButtonFields));\n    var createGroupToolbarButton = function (spec) {\n      return asRaw('GroupToolbarButton', groupToolbarButtonSchema, spec);\n    };\n\n    var baseMenuButtonFields = [\n      optionString('text'),\n      optionString('tooltip'),\n      optionString('icon'),\n      requiredFunction('fetch'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      })\n    ];\n\n    var MenuButtonSchema = objOf(__spreadArray([requiredString('type')], baseMenuButtonFields, true));\n    var createMenuButton = function (spec) {\n      return asRaw('menubutton', MenuButtonSchema, spec);\n    };\n\n    var splitButtonSchema = objOf([\n      requiredString('type'),\n      optionString('tooltip'),\n      optionString('icon'),\n      optionString('text'),\n      optionFunction('select'),\n      requiredFunction('fetch'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      defaultedStringEnum('presets', 'normal', [\n        'normal',\n        'color',\n        'listpreview'\n      ]),\n      defaulted('columns', 1),\n      requiredFunction('onAction'),\n      requiredFunction('onItemAction')\n    ]);\n    var createSplitButton = function (spec) {\n      return asRaw('SplitButton', splitButtonSchema, spec);\n    };\n\n    var factory$b = function (detail, spec) {\n      var setMenus = function (comp, menus) {\n        var newMenus = map$2(menus, function (m) {\n          var buttonSpec = {\n            type: 'menubutton',\n            text: m.text,\n            fetch: function (callback) {\n              callback(m.getItems());\n            }\n          };\n          var internal = createMenuButton(buttonSpec).mapError(function (errInfo) {\n            return formatError(errInfo);\n          }).getOrDie();\n          return renderMenuButton(internal, 'tox-mbtn', spec.backstage, Optional.some('menuitem'));\n        });\n        Replacing.set(comp, newMenus);\n      };\n      var apis = {\n        focus: Keying.focusIn,\n        setMenus: setMenus\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: [],\n        behaviours: derive$1([\n          Replacing.config({}),\n          config('menubar-events', [\n            runOnAttached(function (component) {\n              detail.onSetup(component);\n            }),\n            run$1(mouseover(), function (comp, se) {\n              descendant(comp.element, '.' + 'tox-mbtn--active').each(function (activeButton) {\n                closest$1(se.event.target, '.' + 'tox-mbtn').each(function (hoveredButton) {\n                  if (!eq(activeButton, hoveredButton)) {\n                    comp.getSystem().getByDom(activeButton).each(function (activeComp) {\n                      comp.getSystem().getByDom(hoveredButton).each(function (hoveredComp) {\n                        Dropdown.expand(hoveredComp);\n                        Dropdown.close(activeComp);\n                        Focusing.focus(hoveredComp);\n                      });\n                    });\n                  }\n                });\n              });\n            }),\n            run$1(focusShifted(), function (comp, se) {\n              se.event.prevFocus.bind(function (prev) {\n                return comp.getSystem().getByDom(prev).toOptional();\n              }).each(function (prev) {\n                se.event.newFocus.bind(function (nu) {\n                  return comp.getSystem().getByDom(nu).toOptional();\n                }).each(function (nu) {\n                  if (Dropdown.isOpen(prev)) {\n                    Dropdown.expand(nu);\n                    Dropdown.close(prev);\n                  }\n                });\n              });\n            })\n          ]),\n          Keying.config({\n            mode: 'flow',\n            selector: '.' + 'tox-mbtn',\n            onEscape: function (comp) {\n              detail.onEscape(comp);\n              return Optional.some(true);\n            }\n          }),\n          Tabstopping.config({})\n        ]),\n        apis: apis,\n        domModification: { attributes: { role: 'menubar' } }\n      };\n    };\n    var SilverMenubar = single({\n      factory: factory$b,\n      name: 'silver.Menubar',\n      configFields: [\n        required$1('dom'),\n        required$1('uid'),\n        required$1('onEscape'),\n        required$1('backstage'),\n        defaulted('onSetup', noop)\n      ],\n      apis: {\n        focus: function (apis, comp) {\n          apis.focus(comp);\n        },\n        setMenus: function (apis, comp, menus) {\n          apis.setMenus(comp, menus);\n        }\n      }\n    });\n\n    var getAnimationRoot = function (component, slideConfig) {\n      return slideConfig.getAnimationRoot.fold(function () {\n        return component.element;\n      }, function (get) {\n        return get(component);\n      });\n    };\n\n    var getDimensionProperty = function (slideConfig) {\n      return slideConfig.dimension.property;\n    };\n    var getDimension = function (slideConfig, elem) {\n      return slideConfig.dimension.getDimension(elem);\n    };\n    var disableTransitions = function (component, slideConfig) {\n      var root = getAnimationRoot(component, slideConfig);\n      remove$1(root, [\n        slideConfig.shrinkingClass,\n        slideConfig.growingClass\n      ]);\n    };\n    var setShrunk = function (component, slideConfig) {\n      remove$2(component.element, slideConfig.openClass);\n      add$2(component.element, slideConfig.closedClass);\n      set$7(component.element, getDimensionProperty(slideConfig), '0px');\n      reflow(component.element);\n    };\n    var setGrown = function (component, slideConfig) {\n      remove$2(component.element, slideConfig.closedClass);\n      add$2(component.element, slideConfig.openClass);\n      remove$6(component.element, getDimensionProperty(slideConfig));\n    };\n    var doImmediateShrink = function (component, slideConfig, slideState, _calculatedSize) {\n      slideState.setCollapsed();\n      set$7(component.element, getDimensionProperty(slideConfig), getDimension(slideConfig, component.element));\n      reflow(component.element);\n      disableTransitions(component, slideConfig);\n      setShrunk(component, slideConfig);\n      slideConfig.onStartShrink(component);\n      slideConfig.onShrunk(component);\n    };\n    var doStartShrink = function (component, slideConfig, slideState, calculatedSize) {\n      var size = calculatedSize.getOrThunk(function () {\n        return getDimension(slideConfig, component.element);\n      });\n      slideState.setCollapsed();\n      set$7(component.element, getDimensionProperty(slideConfig), size);\n      reflow(component.element);\n      var root = getAnimationRoot(component, slideConfig);\n      remove$2(root, slideConfig.growingClass);\n      add$2(root, slideConfig.shrinkingClass);\n      setShrunk(component, slideConfig);\n      slideConfig.onStartShrink(component);\n    };\n    var doStartSmartShrink = function (component, slideConfig, slideState) {\n      var size = getDimension(slideConfig, component.element);\n      var shrinker = size === '0px' ? doImmediateShrink : doStartShrink;\n      shrinker(component, slideConfig, slideState, Optional.some(size));\n    };\n    var doStartGrow = function (component, slideConfig, slideState) {\n      var root = getAnimationRoot(component, slideConfig);\n      var wasShrinking = has(root, slideConfig.shrinkingClass);\n      var beforeSize = getDimension(slideConfig, component.element);\n      setGrown(component, slideConfig);\n      var fullSize = getDimension(slideConfig, component.element);\n      var startPartialGrow = function () {\n        set$7(component.element, getDimensionProperty(slideConfig), beforeSize);\n        reflow(component.element);\n      };\n      var startCompleteGrow = function () {\n        setShrunk(component, slideConfig);\n      };\n      var setStartSize = wasShrinking ? startPartialGrow : startCompleteGrow;\n      setStartSize();\n      remove$2(root, slideConfig.shrinkingClass);\n      add$2(root, slideConfig.growingClass);\n      setGrown(component, slideConfig);\n      set$7(component.element, getDimensionProperty(slideConfig), fullSize);\n      slideState.setExpanded();\n      slideConfig.onStartGrow(component);\n    };\n    var refresh$3 = function (component, slideConfig, slideState) {\n      if (slideState.isExpanded()) {\n        remove$6(component.element, getDimensionProperty(slideConfig));\n        var fullSize = getDimension(slideConfig, component.element);\n        set$7(component.element, getDimensionProperty(slideConfig), fullSize);\n      }\n    };\n    var grow = function (component, slideConfig, slideState) {\n      if (!slideState.isExpanded()) {\n        doStartGrow(component, slideConfig, slideState);\n      }\n    };\n    var shrink = function (component, slideConfig, slideState) {\n      if (slideState.isExpanded()) {\n        doStartSmartShrink(component, slideConfig, slideState);\n      }\n    };\n    var immediateShrink = function (component, slideConfig, slideState) {\n      if (slideState.isExpanded()) {\n        doImmediateShrink(component, slideConfig, slideState);\n      }\n    };\n    var hasGrown = function (component, slideConfig, slideState) {\n      return slideState.isExpanded();\n    };\n    var hasShrunk = function (component, slideConfig, slideState) {\n      return slideState.isCollapsed();\n    };\n    var isGrowing = function (component, slideConfig, _slideState) {\n      var root = getAnimationRoot(component, slideConfig);\n      return has(root, slideConfig.growingClass) === true;\n    };\n    var isShrinking = function (component, slideConfig, _slideState) {\n      var root = getAnimationRoot(component, slideConfig);\n      return has(root, slideConfig.shrinkingClass) === true;\n    };\n    var isTransitioning = function (component, slideConfig, slideState) {\n      return isGrowing(component, slideConfig) || isShrinking(component, slideConfig);\n    };\n    var toggleGrow = function (component, slideConfig, slideState) {\n      var f = slideState.isExpanded() ? doStartSmartShrink : doStartGrow;\n      f(component, slideConfig, slideState);\n    };\n\n    var SlidingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        refresh: refresh$3,\n        grow: grow,\n        shrink: shrink,\n        immediateShrink: immediateShrink,\n        hasGrown: hasGrown,\n        hasShrunk: hasShrunk,\n        isGrowing: isGrowing,\n        isShrinking: isShrinking,\n        isTransitioning: isTransitioning,\n        toggleGrow: toggleGrow,\n        disableTransitions: disableTransitions\n    });\n\n    var exhibit = function (base, slideConfig, _slideState) {\n      var expanded = slideConfig.expanded;\n      return expanded ? nu$7({\n        classes: [slideConfig.openClass],\n        styles: {}\n      }) : nu$7({\n        classes: [slideConfig.closedClass],\n        styles: wrap$1(slideConfig.dimension.property, '0px')\n      });\n    };\n    var events$4 = function (slideConfig, slideState) {\n      return derive$2([runOnSource(transitionend(), function (component, simulatedEvent) {\n          var raw = simulatedEvent.event.raw;\n          if (raw.propertyName === slideConfig.dimension.property) {\n            disableTransitions(component, slideConfig);\n            if (slideState.isExpanded()) {\n              remove$6(component.element, slideConfig.dimension.property);\n            }\n            var notify = slideState.isExpanded() ? slideConfig.onGrown : slideConfig.onShrunk;\n            notify(component);\n          }\n        })]);\n    };\n\n    var ActiveSliding = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit,\n        events: events$4\n    });\n\n    var SlidingSchema = [\n      required$1('closedClass'),\n      required$1('openClass'),\n      required$1('shrinkingClass'),\n      required$1('growingClass'),\n      option('getAnimationRoot'),\n      onHandler('onShrunk'),\n      onHandler('onStartShrink'),\n      onHandler('onGrown'),\n      onHandler('onStartGrow'),\n      defaulted('expanded', false),\n      requiredOf('dimension', choose$1('property', {\n        width: [\n          output$1('property', 'width'),\n          output$1('getDimension', function (elem) {\n            return get$a(elem) + 'px';\n          })\n        ],\n        height: [\n          output$1('property', 'height'),\n          output$1('getDimension', function (elem) {\n            return get$b(elem) + 'px';\n          })\n        ]\n      }))\n    ];\n\n    var init$5 = function (spec) {\n      var state = Cell(spec.expanded);\n      var readState = function () {\n        return 'expanded: ' + state.get();\n      };\n      return nu$8({\n        isExpanded: function () {\n          return state.get() === true;\n        },\n        isCollapsed: function () {\n          return state.get() === false;\n        },\n        setCollapsed: curry(state.set, false),\n        setExpanded: curry(state.set, true),\n        readState: readState\n      });\n    };\n\n    var SlidingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$5\n    });\n\n    var Sliding = create$7({\n      fields: SlidingSchema,\n      name: 'sliding',\n      active: ActiveSliding,\n      apis: SlidingApis,\n      state: SlidingState\n    });\n\n    var owner = 'container';\n    var schema$d = [field('slotBehaviours', [])];\n    var getPartName = function (name) {\n      return '<alloy.field.' + name + '>';\n    };\n    var sketch = function (sSpec) {\n      var parts = function () {\n        var record = [];\n        var slot = function (name, config) {\n          record.push(name);\n          return generateOne$1(owner, getPartName(name), config);\n        };\n        return {\n          slot: slot,\n          record: constant$1(record)\n        };\n      }();\n      var spec = sSpec(parts);\n      var partNames = parts.record();\n      var fieldParts = map$2(partNames, function (n) {\n        return required({\n          name: n,\n          pname: getPartName(n)\n        });\n      });\n      return composite$1(owner, schema$d, fieldParts, make$1, spec);\n    };\n    var make$1 = function (detail, components) {\n      var getSlotNames = function (_) {\n        return getAllPartNames(detail);\n      };\n      var getSlot = function (container, key) {\n        return getPart(container, detail, key);\n      };\n      var onSlot = function (f, def) {\n        return function (container, key) {\n          return getPart(container, detail, key).map(function (slot) {\n            return f(slot, key);\n          }).getOr(def);\n        };\n      };\n      var onSlots = function (f) {\n        return function (container, keys) {\n          each$1(keys, function (key) {\n            return f(container, key);\n          });\n        };\n      };\n      var doShowing = function (comp, _key) {\n        return get$d(comp.element, 'aria-hidden') !== 'true';\n      };\n      var doShow = function (comp, key) {\n        if (!doShowing(comp)) {\n          var element = comp.element;\n          remove$6(element, 'display');\n          remove$7(element, 'aria-hidden');\n          emitWith(comp, slotVisibility(), {\n            name: key,\n            visible: true\n          });\n        }\n      };\n      var doHide = function (comp, key) {\n        if (doShowing(comp)) {\n          var element = comp.element;\n          set$7(element, 'display', 'none');\n          set$8(element, 'aria-hidden', 'true');\n          emitWith(comp, slotVisibility(), {\n            name: key,\n            visible: false\n          });\n        }\n      };\n      var isShowing = onSlot(doShowing, false);\n      var hideSlot = onSlot(doHide);\n      var hideSlots = onSlots(hideSlot);\n      var hideAllSlots = function (container) {\n        return hideSlots(container, getSlotNames());\n      };\n      var showSlot = onSlot(doShow);\n      var apis = {\n        getSlotNames: getSlotNames,\n        getSlot: getSlot,\n        isShowing: isShowing,\n        hideSlot: hideSlot,\n        hideAllSlots: hideAllSlots,\n        showSlot: showSlot\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: get$2(detail.slotBehaviours),\n        apis: apis\n      };\n    };\n    var slotApis = map$1({\n      getSlotNames: function (apis, c) {\n        return apis.getSlotNames(c);\n      },\n      getSlot: function (apis, c, key) {\n        return apis.getSlot(c, key);\n      },\n      isShowing: function (apis, c, key) {\n        return apis.isShowing(c, key);\n      },\n      hideSlot: function (apis, c, key) {\n        return apis.hideSlot(c, key);\n      },\n      hideAllSlots: function (apis, c) {\n        return apis.hideAllSlots(c);\n      },\n      showSlot: function (apis, c, key) {\n        return apis.showSlot(c, key);\n      }\n    }, function (value) {\n      return makeApi(value);\n    });\n    var SlotContainer = __assign(__assign({}, slotApis), { sketch: sketch });\n\n    var sidebarSchema = objOf([\n      optionString('icon'),\n      optionString('tooltip'),\n      defaultedFunction('onShow', noop),\n      defaultedFunction('onHide', noop),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      })\n    ]);\n    var createSidebar = function (spec) {\n      return asRaw('sidebar', sidebarSchema, spec);\n    };\n\n    var setup$8 = function (editor) {\n      var sidebars = editor.ui.registry.getAll().sidebars;\n      each$1(keys(sidebars), function (name) {\n        var spec = sidebars[name];\n        var isActive = function () {\n          return is$1(Optional.from(editor.queryCommandValue('ToggleSidebar')), name);\n        };\n        editor.ui.registry.addToggleButton(name, {\n          icon: spec.icon,\n          tooltip: spec.tooltip,\n          onAction: function (buttonApi) {\n            editor.execCommand('ToggleSidebar', false, name);\n            buttonApi.setActive(isActive());\n          },\n          onSetup: function (buttonApi) {\n            var handleToggle = function () {\n              return buttonApi.setActive(isActive());\n            };\n            editor.on('ToggleSidebar', handleToggle);\n            return function () {\n              editor.off('ToggleSidebar', handleToggle);\n            };\n          }\n        });\n      });\n    };\n    var getApi = function (comp) {\n      return {\n        element: function () {\n          return comp.element.dom;\n        }\n      };\n    };\n    var makePanels = function (parts, panelConfigs) {\n      var specs = map$2(keys(panelConfigs), function (name) {\n        var spec = panelConfigs[name];\n        var bridged = getOrDie(createSidebar(spec));\n        return {\n          name: name,\n          getApi: getApi,\n          onSetup: bridged.onSetup,\n          onShow: bridged.onShow,\n          onHide: bridged.onHide\n        };\n      });\n      return map$2(specs, function (spec) {\n        var editorOffCell = Cell(noop);\n        return parts.slot(spec.name, {\n          dom: {\n            tag: 'div',\n            classes: ['tox-sidebar__pane']\n          },\n          behaviours: SimpleBehaviours.unnamedEvents([\n            onControlAttached(spec, editorOffCell),\n            onControlDetached(spec, editorOffCell),\n            run$1(slotVisibility(), function (sidepanel, se) {\n              var data = se.event;\n              var optSidePanelSpec = find$5(specs, function (config) {\n                return config.name === data.name;\n              });\n              optSidePanelSpec.each(function (sidePanelSpec) {\n                var handler = data.visible ? sidePanelSpec.onShow : sidePanelSpec.onHide;\n                handler(sidePanelSpec.getApi(sidepanel));\n              });\n            })\n          ])\n        });\n      });\n    };\n    var makeSidebar = function (panelConfigs) {\n      return SlotContainer.sketch(function (parts) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-sidebar__pane-container']\n          },\n          components: makePanels(parts, panelConfigs),\n          slotBehaviours: SimpleBehaviours.unnamedEvents([runOnAttached(function (slotContainer) {\n              return SlotContainer.hideAllSlots(slotContainer);\n            })])\n        };\n      });\n    };\n    var setSidebar = function (sidebar, panelConfigs) {\n      var optSlider = Composing.getCurrent(sidebar);\n      optSlider.each(function (slider) {\n        return Replacing.set(slider, [makeSidebar(panelConfigs)]);\n      });\n    };\n    var toggleSidebar = function (sidebar, name) {\n      var optSlider = Composing.getCurrent(sidebar);\n      optSlider.each(function (slider) {\n        var optSlotContainer = Composing.getCurrent(slider);\n        optSlotContainer.each(function (slotContainer) {\n          if (Sliding.hasGrown(slider)) {\n            if (SlotContainer.isShowing(slotContainer, name)) {\n              Sliding.shrink(slider);\n            } else {\n              SlotContainer.hideAllSlots(slotContainer);\n              SlotContainer.showSlot(slotContainer, name);\n            }\n          } else {\n            SlotContainer.hideAllSlots(slotContainer);\n            SlotContainer.showSlot(slotContainer, name);\n            Sliding.grow(slider);\n          }\n        });\n      });\n    };\n    var whichSidebar = function (sidebar) {\n      var optSlider = Composing.getCurrent(sidebar);\n      return optSlider.bind(function (slider) {\n        var sidebarOpen = Sliding.isGrowing(slider) || Sliding.hasGrown(slider);\n        if (sidebarOpen) {\n          var optSlotContainer = Composing.getCurrent(slider);\n          return optSlotContainer.bind(function (slotContainer) {\n            return find$5(SlotContainer.getSlotNames(slotContainer), function (name) {\n              return SlotContainer.isShowing(slotContainer, name);\n            });\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var fixSize = generate$6('FixSizeEvent');\n    var autoSize = generate$6('AutoSizeEvent');\n    var renderSidebar = function (spec) {\n      return {\n        uid: spec.uid,\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar'],\n          attributes: { role: 'complementary' }\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-sidebar__slider']\n            },\n            components: [],\n            behaviours: derive$1([\n              Tabstopping.config({}),\n              Focusing.config({}),\n              Sliding.config({\n                dimension: { property: 'width' },\n                closedClass: 'tox-sidebar--sliding-closed',\n                openClass: 'tox-sidebar--sliding-open',\n                shrinkingClass: 'tox-sidebar--sliding-shrinking',\n                growingClass: 'tox-sidebar--sliding-growing',\n                onShrunk: function (slider) {\n                  var optSlotContainer = Composing.getCurrent(slider);\n                  optSlotContainer.each(SlotContainer.hideAllSlots);\n                  emit(slider, autoSize);\n                },\n                onGrown: function (slider) {\n                  emit(slider, autoSize);\n                },\n                onStartGrow: function (slider) {\n                  emitWith(slider, fixSize, { width: getRaw(slider.element, 'width').getOr('') });\n                },\n                onStartShrink: function (slider) {\n                  emitWith(slider, fixSize, { width: get$a(slider.element) + 'px' });\n                }\n              }),\n              Replacing.config({}),\n              Composing.config({\n                find: function (comp) {\n                  var children = Replacing.contents(comp);\n                  return head(children);\n                }\n              })\n            ])\n          }],\n        behaviours: derive$1([\n          ComposingConfigs.childAt(0),\n          config('sidebar-sliding-events', [\n            run$1(fixSize, function (comp, se) {\n              set$7(comp.element, 'width', se.event.width);\n            }),\n            run$1(autoSize, function (comp, _se) {\n              remove$6(comp.element, 'width');\n            })\n          ])\n        ])\n      };\n    };\n\n    var block = function (component, config, state, getBusySpec) {\n      set$8(component.element, 'aria-busy', true);\n      var root = config.getRoot(component).getOr(component);\n      var blockerBehaviours = derive$1([\n        Keying.config({\n          mode: 'special',\n          onTab: function () {\n            return Optional.some(true);\n          },\n          onShiftTab: function () {\n            return Optional.some(true);\n          }\n        }),\n        Focusing.config({})\n      ]);\n      var blockSpec = getBusySpec(root, blockerBehaviours);\n      var blocker = root.getSystem().build(blockSpec);\n      Replacing.append(root, premade(blocker));\n      if (blocker.hasConfigured(Keying) && config.focus) {\n        Keying.focusIn(blocker);\n      }\n      if (!state.isBlocked()) {\n        config.onBlock(component);\n      }\n      state.blockWith(function () {\n        return Replacing.remove(root, blocker);\n      });\n    };\n    var unblock = function (component, config, state) {\n      remove$7(component.element, 'aria-busy');\n      if (state.isBlocked()) {\n        config.onUnblock(component);\n      }\n      state.clear();\n    };\n\n    var BlockingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        block: block,\n        unblock: unblock\n    });\n\n    var BlockingSchema = [\n      defaultedFunction('getRoot', Optional.none),\n      defaultedBoolean('focus', true),\n      onHandler('onBlock'),\n      onHandler('onUnblock')\n    ];\n\n    var init$4 = function () {\n      var blocker = destroyable();\n      var blockWith = function (destroy) {\n        blocker.set({ destroy: destroy });\n      };\n      return nu$8({\n        readState: blocker.isSet,\n        blockWith: blockWith,\n        clear: blocker.clear,\n        isBlocked: blocker.isSet\n      });\n    };\n\n    var BlockingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$4\n    });\n\n    var Blocking = create$7({\n      fields: BlockingSchema,\n      name: 'blocking',\n      apis: BlockingApis,\n      state: BlockingState\n    });\n\n    var getAttrs = function (elem) {\n      var attributes = elem.dom.attributes !== undefined ? elem.dom.attributes : [];\n      return foldl(attributes, function (b, attr) {\n        var _a;\n        if (attr.name === 'class') {\n          return b;\n        } else {\n          return __assign(__assign({}, b), (_a = {}, _a[attr.name] = attr.value, _a));\n        }\n      }, {});\n    };\n    var getClasses = function (elem) {\n      return Array.prototype.slice.call(elem.dom.classList, 0);\n    };\n    var fromHtml = function (html) {\n      var elem = SugarElement.fromHtml(html);\n      var children$1 = children(elem);\n      var attrs = getAttrs(elem);\n      var classes = getClasses(elem);\n      var contents = children$1.length === 0 ? {} : { innerHtml: get$7(elem) };\n      return __assign({\n        tag: name$2(elem),\n        classes: classes,\n        attributes: attrs\n      }, contents);\n    };\n\n    var getBusySpec$1 = function (providerBackstage) {\n      return function (_root, _behaviours) {\n        return {\n          dom: {\n            tag: 'div',\n            attributes: {\n              'aria-label': providerBackstage.translate('Loading...'),\n              'tabindex': '0'\n            },\n            classes: ['tox-throbber__busy-spinner']\n          },\n          components: [{ dom: fromHtml('<div class=\"tox-spinner\"><div></div><div></div><div></div></div>') }]\n        };\n      };\n    };\n    var focusBusyComponent = function (throbber) {\n      return Composing.getCurrent(throbber).each(function (comp) {\n        return focus$3(comp.element);\n      });\n    };\n    var toggleEditorTabIndex = function (editor, state) {\n      var tabIndexAttr = 'tabindex';\n      var dataTabIndexAttr = 'data-mce-' + tabIndexAttr;\n      Optional.from(editor.iframeElement).map(SugarElement.fromDom).each(function (iframe) {\n        if (state) {\n          getOpt(iframe, tabIndexAttr).each(function (tabIndex) {\n            return set$8(iframe, dataTabIndexAttr, tabIndex);\n          });\n          set$8(iframe, tabIndexAttr, -1);\n        } else {\n          remove$7(iframe, tabIndexAttr);\n          getOpt(iframe, dataTabIndexAttr).each(function (tabIndex) {\n            set$8(iframe, tabIndexAttr, tabIndex);\n            remove$7(iframe, dataTabIndexAttr);\n          });\n        }\n      });\n    };\n    var toggleThrobber = function (editor, comp, state, providerBackstage) {\n      var element = comp.element;\n      toggleEditorTabIndex(editor, state);\n      if (state) {\n        Blocking.block(comp, getBusySpec$1(providerBackstage));\n        remove$6(element, 'display');\n        remove$7(element, 'aria-hidden');\n        if (editor.hasFocus()) {\n          focusBusyComponent(comp);\n        }\n      } else {\n        var throbberFocus = Composing.getCurrent(comp).exists(function (busyComp) {\n          return hasFocus(busyComp.element);\n        });\n        Blocking.unblock(comp);\n        set$7(element, 'display', 'none');\n        set$8(element, 'aria-hidden', 'true');\n        if (throbberFocus) {\n          editor.focus();\n        }\n      }\n    };\n    var renderThrobber = function (spec) {\n      return {\n        uid: spec.uid,\n        dom: {\n          tag: 'div',\n          attributes: { 'aria-hidden': 'true' },\n          classes: ['tox-throbber'],\n          styles: { display: 'none' }\n        },\n        behaviours: derive$1([\n          Replacing.config({}),\n          Blocking.config({ focus: false }),\n          Composing.config({\n            find: function (comp) {\n              return head(comp.components());\n            }\n          })\n        ]),\n        components: []\n      };\n    };\n    var isFocusEvent = function (event) {\n      return event.type === 'focusin';\n    };\n    var isPasteBinTarget = function (event) {\n      if (isFocusEvent(event)) {\n        var node = event.composed ? head(event.composedPath()) : Optional.from(event.target);\n        return node.map(SugarElement.fromDom).filter(isElement$2).exists(function (targetElm) {\n          return has(targetElm, 'mce-pastebin');\n        });\n      } else {\n        return false;\n      }\n    };\n    var setup$7 = function (editor, lazyThrobber, sharedBackstage) {\n      var throbberState = Cell(false);\n      var timer = value$1();\n      var stealFocus = function (e) {\n        if (throbberState.get() && !isPasteBinTarget(e)) {\n          e.preventDefault();\n          focusBusyComponent(lazyThrobber());\n          editor.editorManager.setActive(editor);\n        }\n      };\n      if (!editor.inline) {\n        editor.on('PreInit', function () {\n          editor.dom.bind(editor.getWin(), 'focusin', stealFocus);\n          editor.on('BeforeExecCommand', function (e) {\n            if (e.command.toLowerCase() === 'mcefocus' && e.value !== true) {\n              stealFocus(e);\n            }\n          });\n        });\n      }\n      var toggle = function (state) {\n        if (state !== throbberState.get()) {\n          throbberState.set(state);\n          toggleThrobber(editor, lazyThrobber(), state, sharedBackstage.providers);\n          editor.fire('AfterProgressState', { state: state });\n        }\n      };\n      editor.on('ProgressState', function (e) {\n        timer.on(global$f.clearTimeout);\n        if (isNumber(e.time)) {\n          var timerId = global$f.setEditorTimeout(editor, function () {\n            return toggle(e.state);\n          }, e.time);\n          timer.set(timerId);\n        } else {\n          toggle(e.state);\n          timer.clear();\n        }\n      });\n    };\n\n    var generate$1 = function (xs, f) {\n      var init = {\n        len: 0,\n        list: []\n      };\n      var r = foldl(xs, function (b, a) {\n        var value = f(a, b.len);\n        return value.fold(constant$1(b), function (v) {\n          return {\n            len: v.finish,\n            list: b.list.concat([v])\n          };\n        });\n      }, init);\n      return r.list;\n    };\n\n    var output = function (within, extra, withinWidth) {\n      return {\n        within: within,\n        extra: extra,\n        withinWidth: withinWidth\n      };\n    };\n    var apportion = function (units, total, len) {\n      var parray = generate$1(units, function (unit, current) {\n        var width = len(unit);\n        return Optional.some({\n          element: unit,\n          start: current,\n          finish: current + width,\n          width: width\n        });\n      });\n      var within = filter$2(parray, function (unit) {\n        return unit.finish <= total;\n      });\n      var withinWidth = foldr(within, function (acc, el) {\n        return acc + el.width;\n      }, 0);\n      var extra = parray.slice(within.length);\n      return {\n        within: within,\n        extra: extra,\n        withinWidth: withinWidth\n      };\n    };\n    var toUnit = function (parray) {\n      return map$2(parray, function (unit) {\n        return unit.element;\n      });\n    };\n    var fitLast = function (within, extra, withinWidth) {\n      var fits = toUnit(within.concat(extra));\n      return output(fits, [], withinWidth);\n    };\n    var overflow = function (within, extra, overflower, withinWidth) {\n      var fits = toUnit(within).concat([overflower]);\n      return output(fits, toUnit(extra), withinWidth);\n    };\n    var fitAll = function (within, extra, withinWidth) {\n      return output(toUnit(within), [], withinWidth);\n    };\n    var tryFit = function (total, units, len) {\n      var divide = apportion(units, total, len);\n      return divide.extra.length === 0 ? Optional.some(divide) : Optional.none();\n    };\n    var partition = function (total, units, len, overflower) {\n      var divide = tryFit(total, units, len).getOrThunk(function () {\n        return apportion(units, total - len(overflower), len);\n      });\n      var within = divide.within;\n      var extra = divide.extra;\n      var withinWidth = divide.withinWidth;\n      if (extra.length === 1 && extra[0].width <= len(overflower)) {\n        return fitLast(within, extra, withinWidth);\n      } else if (extra.length >= 1) {\n        return overflow(within, extra, overflower, withinWidth);\n      } else {\n        return fitAll(within, extra, withinWidth);\n      }\n    };\n\n    var setGroups$1 = function (toolbar, storedGroups) {\n      var bGroups = map$2(storedGroups, function (g) {\n        return premade(g);\n      });\n      Toolbar.setGroups(toolbar, bGroups);\n    };\n    var findFocusedComp = function (comps) {\n      return findMap(comps, function (comp) {\n        return search(comp.element).bind(function (focusedElm) {\n          return comp.getSystem().getByDom(focusedElm).toOptional();\n        });\n      });\n    };\n    var refresh$2 = function (toolbar, detail, setOverflow) {\n      var builtGroups = detail.builtGroups.get();\n      if (builtGroups.length === 0) {\n        return;\n      }\n      var primary = getPartOrDie(toolbar, detail, 'primary');\n      var overflowGroup = Coupling.getCoupled(toolbar, 'overflowGroup');\n      set$7(primary.element, 'visibility', 'hidden');\n      var groups = builtGroups.concat([overflowGroup]);\n      var focusedComp = findFocusedComp(groups);\n      setOverflow([]);\n      setGroups$1(primary, groups);\n      var availableWidth = get$a(primary.element);\n      var overflows = partition(availableWidth, detail.builtGroups.get(), function (comp) {\n        return get$a(comp.element);\n      }, overflowGroup);\n      if (overflows.extra.length === 0) {\n        Replacing.remove(primary, overflowGroup);\n        setOverflow([]);\n      } else {\n        setGroups$1(primary, overflows.within);\n        setOverflow(overflows.extra);\n      }\n      remove$6(primary.element, 'visibility');\n      reflow(primary.element);\n      focusedComp.each(Focusing.focus);\n    };\n\n    var schema$c = constant$1([\n      field('splitToolbarBehaviours', [Coupling]),\n      customField('builtGroups', function () {\n        return Cell([]);\n      })\n    ]);\n\n    var schema$b = constant$1([\n      markers$1(['overflowToggledClass']),\n      optionFunction('getOverflowBounds'),\n      required$1('lazySink'),\n      customField('overflowGroups', function () {\n        return Cell([]);\n      })\n    ].concat(schema$c()));\n    var parts$7 = constant$1([\n      required({\n        factory: Toolbar,\n        schema: schema$e(),\n        name: 'primary'\n      }),\n      external$1({\n        schema: schema$e(),\n        name: 'overflow'\n      }),\n      external$1({ name: 'overflow-button' }),\n      external$1({ name: 'overflow-group' })\n    ]);\n\n    var expandable = constant$1(function (element, available) {\n      setMax(element, Math.floor(available));\n    });\n\n    var schema$a = constant$1([\n      markers$1(['toggledClass']),\n      required$1('lazySink'),\n      requiredFunction('fetch'),\n      optionFunction('getBounds'),\n      optionObjOf('fireDismissalEventInstead', [defaulted('event', dismissRequested())]),\n      schema$y()\n    ]);\n    var parts$6 = constant$1([\n      external$1({\n        name: 'button',\n        overrides: function (detail) {\n          return {\n            dom: { attributes: { 'aria-haspopup': 'true' } },\n            buttonBehaviours: derive$1([Toggling.config({\n                toggleClass: detail.markers.toggledClass,\n                aria: { mode: 'expanded' },\n                toggleOnExecute: false\n              })])\n          };\n        }\n      }),\n      external$1({\n        factory: Toolbar,\n        schema: schema$e(),\n        name: 'toolbar',\n        overrides: function (detail) {\n          return {\n            toolbarBehaviours: derive$1([Keying.config({\n                mode: 'cyclic',\n                onEscape: function (comp) {\n                  getPart(comp, detail, 'button').each(Focusing.focus);\n                  return Optional.none();\n                }\n              })])\n          };\n        }\n      })\n    ]);\n\n    var toggle = function (button, externals) {\n      var toolbarSandbox = Coupling.getCoupled(button, 'toolbarSandbox');\n      if (Sandboxing.isOpen(toolbarSandbox)) {\n        Sandboxing.close(toolbarSandbox);\n      } else {\n        Sandboxing.open(toolbarSandbox, externals.toolbar());\n      }\n    };\n    var position = function (button, toolbar, detail, layouts) {\n      var bounds = detail.getBounds.map(function (bounder) {\n        return bounder();\n      });\n      var sink = detail.lazySink(button).getOrDie();\n      Positioning.positionWithinBounds(sink, toolbar, {\n        anchor: {\n          type: 'hotspot',\n          hotspot: button,\n          layouts: layouts,\n          overrides: { maxWidthFunction: expandable() }\n        }\n      }, bounds);\n    };\n    var setGroups = function (button, toolbar, detail, layouts, groups) {\n      Toolbar.setGroups(toolbar, groups);\n      position(button, toolbar, detail, layouts);\n      Toggling.on(button);\n    };\n    var makeSandbox = function (button, spec, detail) {\n      var ariaOwner = manager();\n      var onOpen = function (sandbox, toolbar) {\n        detail.fetch().get(function (groups) {\n          setGroups(button, toolbar, detail, spec.layouts, groups);\n          ariaOwner.link(button.element);\n          Keying.focusIn(toolbar);\n        });\n      };\n      var onClose = function () {\n        Toggling.off(button);\n        Focusing.focus(button);\n        ariaOwner.unlink(button.element);\n      };\n      return {\n        dom: {\n          tag: 'div',\n          attributes: { id: ariaOwner.id }\n        },\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'special',\n            onEscape: function (comp) {\n              Sandboxing.close(comp);\n              return Optional.some(true);\n            }\n          }),\n          Sandboxing.config({\n            onOpen: onOpen,\n            onClose: onClose,\n            isPartOf: function (container, data, queryElem) {\n              return isPartOf$1(data, queryElem) || isPartOf$1(button, queryElem);\n            },\n            getAttachPoint: function () {\n              return detail.lazySink(button).getOrDie();\n            }\n          }),\n          Receiving.config({\n            channels: __assign(__assign({}, receivingChannel$1(__assign({ isExtraPart: never }, detail.fireDismissalEventInstead.map(function (fe) {\n              return { fireEventInstead: { event: fe.event } };\n            }).getOr({})))), receivingChannel({\n              doReposition: function () {\n                Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n                  position(button, toolbar, detail, spec.layouts);\n                });\n              }\n            }))\n          })\n        ])\n      };\n    };\n    var factory$a = function (detail, components, spec, externals) {\n      return __assign(__assign({}, Button.sketch(__assign(__assign({}, externals.button()), {\n        action: function (button) {\n          toggle(button, externals);\n        },\n        buttonBehaviours: SketchBehaviours.augment({ dump: externals.button().buttonBehaviours }, [Coupling.config({\n            others: {\n              toolbarSandbox: function (button) {\n                return makeSandbox(button, spec, detail);\n              }\n            }\n          })])\n      }))), {\n        apis: {\n          setGroups: function (button, groups) {\n            Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n              setGroups(button, toolbar, detail, spec.layouts, groups);\n            });\n          },\n          reposition: function (button) {\n            Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n              position(button, toolbar, detail, spec.layouts);\n            });\n          },\n          toggle: function (button) {\n            toggle(button, externals);\n          },\n          getToolbar: function (button) {\n            return Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox'));\n          },\n          isOpen: function (button) {\n            return Sandboxing.isOpen(Coupling.getCoupled(button, 'toolbarSandbox'));\n          }\n        }\n      });\n    };\n    var FloatingToolbarButton = composite({\n      name: 'FloatingToolbarButton',\n      factory: factory$a,\n      configFields: schema$a(),\n      partFields: parts$6(),\n      apis: {\n        setGroups: function (apis, button, groups) {\n          apis.setGroups(button, groups);\n        },\n        reposition: function (apis, button) {\n          apis.reposition(button);\n        },\n        toggle: function (apis, button) {\n          apis.toggle(button);\n        },\n        getToolbar: function (apis, button) {\n          return apis.getToolbar(button);\n        },\n        isOpen: function (apis, button) {\n          return apis.isOpen(button);\n        }\n      }\n    });\n\n    var schema$9 = constant$1([\n      required$1('items'),\n      markers$1(['itemSelector']),\n      field('tgroupBehaviours', [Keying])\n    ]);\n    var parts$5 = constant$1([group({\n        name: 'items',\n        unit: 'item'\n      })]);\n\n    var factory$9 = function (detail, components, _spec, _externals) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.tgroupBehaviours, [Keying.config({\n            mode: 'flow',\n            selector: detail.markers.itemSelector\n          })]),\n        domModification: { attributes: { role: 'toolbar' } }\n      };\n    };\n    var ToolbarGroup = composite({\n      name: 'ToolbarGroup',\n      configFields: schema$9(),\n      partFields: parts$5(),\n      factory: factory$9\n    });\n\n    var buildGroups = function (comps) {\n      return map$2(comps, function (g) {\n        return premade(g);\n      });\n    };\n    var refresh$1 = function (toolbar, memFloatingToolbarButton, detail) {\n      refresh$2(toolbar, detail, function (overflowGroups) {\n        detail.overflowGroups.set(overflowGroups);\n        memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n          FloatingToolbarButton.setGroups(floatingToolbarButton, buildGroups(overflowGroups));\n        });\n      });\n    };\n    var factory$8 = function (detail, components, spec, externals) {\n      var memFloatingToolbarButton = record(FloatingToolbarButton.sketch({\n        fetch: function () {\n          return Future.nu(function (resolve) {\n            resolve(buildGroups(detail.overflowGroups.get()));\n          });\n        },\n        layouts: {\n          onLtr: function () {\n            return [\n              southwest$2,\n              southeast$2\n            ];\n          },\n          onRtl: function () {\n            return [\n              southeast$2,\n              southwest$2\n            ];\n          },\n          onBottomLtr: function () {\n            return [\n              northwest$2,\n              northeast$2\n            ];\n          },\n          onBottomRtl: function () {\n            return [\n              northeast$2,\n              northwest$2\n            ];\n          }\n        },\n        getBounds: spec.getOverflowBounds,\n        lazySink: detail.lazySink,\n        fireDismissalEventInstead: {},\n        markers: { toggledClass: detail.markers.overflowToggledClass },\n        parts: {\n          button: externals['overflow-button'](),\n          toolbar: externals.overflow()\n        }\n      }));\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.splitToolbarBehaviours, [Coupling.config({\n            others: {\n              overflowGroup: function () {\n                return ToolbarGroup.sketch(__assign(__assign({}, externals['overflow-group']()), { items: [memFloatingToolbarButton.asSpec()] }));\n              }\n            }\n          })]),\n        apis: {\n          setGroups: function (toolbar, groups) {\n            detail.builtGroups.set(map$2(groups, toolbar.getSystem().build));\n            refresh$1(toolbar, memFloatingToolbarButton, detail);\n          },\n          refresh: function (toolbar) {\n            return refresh$1(toolbar, memFloatingToolbarButton, detail);\n          },\n          toggle: function (toolbar) {\n            memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n              FloatingToolbarButton.toggle(floatingToolbarButton);\n            });\n          },\n          isOpen: function (toolbar) {\n            return memFloatingToolbarButton.getOpt(toolbar).map(FloatingToolbarButton.isOpen).getOr(false);\n          },\n          reposition: function (toolbar) {\n            memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n              FloatingToolbarButton.reposition(floatingToolbarButton);\n            });\n          },\n          getOverflow: function (toolbar) {\n            return memFloatingToolbarButton.getOpt(toolbar).bind(FloatingToolbarButton.getToolbar);\n          }\n        },\n        domModification: { attributes: { role: 'group' } }\n      };\n    };\n    var SplitFloatingToolbar = composite({\n      name: 'SplitFloatingToolbar',\n      configFields: schema$b(),\n      partFields: parts$7(),\n      factory: factory$8,\n      apis: {\n        setGroups: function (apis, toolbar, groups) {\n          apis.setGroups(toolbar, groups);\n        },\n        refresh: function (apis, toolbar) {\n          apis.refresh(toolbar);\n        },\n        reposition: function (apis, toolbar) {\n          apis.reposition(toolbar);\n        },\n        toggle: function (apis, toolbar) {\n          apis.toggle(toolbar);\n        },\n        isOpen: function (apis, toolbar) {\n          return apis.isOpen(toolbar);\n        },\n        getOverflow: function (apis, toolbar) {\n          return apis.getOverflow(toolbar);\n        }\n      }\n    });\n\n    var schema$8 = constant$1([\n      markers$1([\n        'closedClass',\n        'openClass',\n        'shrinkingClass',\n        'growingClass',\n        'overflowToggledClass'\n      ]),\n      onHandler('onOpened'),\n      onHandler('onClosed')\n    ].concat(schema$c()));\n    var parts$4 = constant$1([\n      required({\n        factory: Toolbar,\n        schema: schema$e(),\n        name: 'primary'\n      }),\n      required({\n        factory: Toolbar,\n        schema: schema$e(),\n        name: 'overflow',\n        overrides: function (detail) {\n          return {\n            toolbarBehaviours: derive$1([\n              Sliding.config({\n                dimension: { property: 'height' },\n                closedClass: detail.markers.closedClass,\n                openClass: detail.markers.openClass,\n                shrinkingClass: detail.markers.shrinkingClass,\n                growingClass: detail.markers.growingClass,\n                onShrunk: function (comp) {\n                  getPart(comp, detail, 'overflow-button').each(function (button) {\n                    Toggling.off(button);\n                    Focusing.focus(button);\n                  });\n                  detail.onClosed(comp);\n                },\n                onGrown: function (comp) {\n                  Keying.focusIn(comp);\n                  detail.onOpened(comp);\n                },\n                onStartGrow: function (comp) {\n                  getPart(comp, detail, 'overflow-button').each(Toggling.on);\n                }\n              }),\n              Keying.config({\n                mode: 'acyclic',\n                onEscape: function (comp) {\n                  getPart(comp, detail, 'overflow-button').each(Focusing.focus);\n                  return Optional.some(true);\n                }\n              })\n            ])\n          };\n        }\n      }),\n      external$1({\n        name: 'overflow-button',\n        overrides: function (detail) {\n          return {\n            buttonBehaviours: derive$1([Toggling.config({\n                toggleClass: detail.markers.overflowToggledClass,\n                aria: { mode: 'pressed' },\n                toggleOnExecute: false\n              })])\n          };\n        }\n      }),\n      external$1({ name: 'overflow-group' })\n    ]);\n\n    var isOpen = function (toolbar, detail) {\n      return getPart(toolbar, detail, 'overflow').map(Sliding.hasGrown).getOr(false);\n    };\n    var toggleToolbar = function (toolbar, detail) {\n      getPart(toolbar, detail, 'overflow-button').bind(function () {\n        return getPart(toolbar, detail, 'overflow');\n      }).each(function (overf) {\n        refresh(toolbar, detail);\n        Sliding.toggleGrow(overf);\n      });\n    };\n    var refresh = function (toolbar, detail) {\n      getPart(toolbar, detail, 'overflow').each(function (overflow) {\n        refresh$2(toolbar, detail, function (groups) {\n          var builtGroups = map$2(groups, function (g) {\n            return premade(g);\n          });\n          Toolbar.setGroups(overflow, builtGroups);\n        });\n        getPart(toolbar, detail, 'overflow-button').each(function (button) {\n          if (Sliding.hasGrown(overflow)) {\n            Toggling.on(button);\n          }\n        });\n        Sliding.refresh(overflow);\n      });\n    };\n    var factory$7 = function (detail, components, spec, externals) {\n      var toolbarToggleEvent = 'alloy.toolbar.toggle';\n      var doSetGroups = function (toolbar, groups) {\n        var built = map$2(groups, toolbar.getSystem().build);\n        detail.builtGroups.set(built);\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.splitToolbarBehaviours, [\n          Coupling.config({\n            others: {\n              overflowGroup: function (toolbar) {\n                return ToolbarGroup.sketch(__assign(__assign({}, externals['overflow-group']()), {\n                  items: [Button.sketch(__assign(__assign({}, externals['overflow-button']()), {\n                      action: function (_button) {\n                        emit(toolbar, toolbarToggleEvent);\n                      }\n                    }))]\n                }));\n              }\n            }\n          }),\n          config('toolbar-toggle-events', [run$1(toolbarToggleEvent, function (toolbar) {\n              toggleToolbar(toolbar, detail);\n            })])\n        ]),\n        apis: {\n          setGroups: function (toolbar, groups) {\n            doSetGroups(toolbar, groups);\n            refresh(toolbar, detail);\n          },\n          refresh: function (toolbar) {\n            return refresh(toolbar, detail);\n          },\n          toggle: function (toolbar) {\n            return toggleToolbar(toolbar, detail);\n          },\n          isOpen: function (toolbar) {\n            return isOpen(toolbar, detail);\n          }\n        },\n        domModification: { attributes: { role: 'group' } }\n      };\n    };\n    var SplitSlidingToolbar = composite({\n      name: 'SplitSlidingToolbar',\n      configFields: schema$8(),\n      partFields: parts$4(),\n      factory: factory$7,\n      apis: {\n        setGroups: function (apis, toolbar, groups) {\n          apis.setGroups(toolbar, groups);\n        },\n        refresh: function (apis, toolbar) {\n          apis.refresh(toolbar);\n        },\n        toggle: function (apis, toolbar) {\n          apis.toggle(toolbar);\n        },\n        isOpen: function (apis, toolbar) {\n          return apis.isOpen(toolbar);\n        }\n      }\n    });\n\n    var renderToolbarGroupCommon = function (toolbarGroup) {\n      var attributes = toolbarGroup.title.fold(function () {\n        return {};\n      }, function (title) {\n        return { attributes: { title: title } };\n      });\n      return {\n        dom: __assign({\n          tag: 'div',\n          classes: ['tox-toolbar__group']\n        }, attributes),\n        components: [ToolbarGroup.parts.items({})],\n        items: toolbarGroup.items,\n        markers: { itemSelector: '*:not(.tox-split-button) > .tox-tbtn:not([disabled]), ' + '.tox-split-button:not([disabled]), ' + '.tox-toolbar-nav-js:not([disabled])' },\n        tgroupBehaviours: derive$1([\n          Tabstopping.config({}),\n          Focusing.config({})\n        ])\n      };\n    };\n    var renderToolbarGroup = function (toolbarGroup) {\n      return ToolbarGroup.sketch(renderToolbarGroupCommon(toolbarGroup));\n    };\n    var getToolbarbehaviours = function (toolbarSpec, modeName) {\n      var onAttached = runOnAttached(function (component) {\n        var groups = map$2(toolbarSpec.initGroups, renderToolbarGroup);\n        Toolbar.setGroups(component, groups);\n      });\n      return derive$1([\n        DisablingConfigs.toolbarButton(toolbarSpec.providers.isDisabled),\n        receivingConfig(),\n        Keying.config({\n          mode: modeName,\n          onEscape: toolbarSpec.onEscape,\n          selector: '.tox-toolbar__group'\n        }),\n        config('toolbar-events', [onAttached])\n      ]);\n    };\n    var renderMoreToolbarCommon = function (toolbarSpec) {\n      var modeName = toolbarSpec.cyclicKeying ? 'cyclic' : 'acyclic';\n      return {\n        uid: toolbarSpec.uid,\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar-overlord']\n        },\n        parts: {\n          'overflow-group': renderToolbarGroupCommon({\n            title: Optional.none(),\n            items: []\n          }),\n          'overflow-button': renderIconButtonSpec({\n            name: 'more',\n            icon: Optional.some('more-drawer'),\n            disabled: false,\n            tooltip: Optional.some('More...'),\n            primary: false,\n            borderless: false\n          }, Optional.none(), toolbarSpec.providers)\n        },\n        splitToolbarBehaviours: getToolbarbehaviours(toolbarSpec, modeName)\n      };\n    };\n    var renderFloatingMoreToolbar = function (toolbarSpec) {\n      var baseSpec = renderMoreToolbarCommon(toolbarSpec);\n      var overflowXOffset = 4;\n      var primary = SplitFloatingToolbar.parts.primary({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar__primary']\n        }\n      });\n      return SplitFloatingToolbar.sketch(__assign(__assign({}, baseSpec), {\n        lazySink: toolbarSpec.getSink,\n        getOverflowBounds: function () {\n          var headerElem = toolbarSpec.moreDrawerData.lazyHeader().element;\n          var headerBounds = absolute$2(headerElem);\n          var docElem = documentElement(headerElem);\n          var docBounds = absolute$2(docElem);\n          var height = Math.max(docElem.dom.scrollHeight, docBounds.height);\n          return bounds(headerBounds.x + overflowXOffset, docBounds.y, headerBounds.width - overflowXOffset * 2, height);\n        },\n        parts: __assign(__assign({}, baseSpec.parts), {\n          overflow: {\n            dom: {\n              tag: 'div',\n              classes: ['tox-toolbar__overflow'],\n              attributes: toolbarSpec.attributes\n            }\n          }\n        }),\n        components: [primary],\n        markers: { overflowToggledClass: 'tox-tbtn--enabled' }\n      }));\n    };\n    var renderSlidingMoreToolbar = function (toolbarSpec) {\n      var primary = SplitSlidingToolbar.parts.primary({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar__primary']\n        }\n      });\n      var overflow = SplitSlidingToolbar.parts.overflow({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar__overflow']\n        }\n      });\n      var baseSpec = renderMoreToolbarCommon(toolbarSpec);\n      return SplitSlidingToolbar.sketch(__assign(__assign({}, baseSpec), {\n        components: [\n          primary,\n          overflow\n        ],\n        markers: {\n          openClass: 'tox-toolbar__overflow--open',\n          closedClass: 'tox-toolbar__overflow--closed',\n          growingClass: 'tox-toolbar__overflow--growing',\n          shrinkingClass: 'tox-toolbar__overflow--shrinking',\n          overflowToggledClass: 'tox-tbtn--enabled'\n        },\n        onOpened: function (comp) {\n          comp.getSystem().broadcastOn([toolbarHeightChange()], { type: 'opened' });\n        },\n        onClosed: function (comp) {\n          comp.getSystem().broadcastOn([toolbarHeightChange()], { type: 'closed' });\n        }\n      }));\n    };\n    var renderToolbar = function (toolbarSpec) {\n      var modeName = toolbarSpec.cyclicKeying ? 'cyclic' : 'acyclic';\n      return Toolbar.sketch({\n        uid: toolbarSpec.uid,\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar'].concat(toolbarSpec.type === ToolbarMode.scrolling ? ['tox-toolbar--scrolling'] : [])\n        },\n        components: [Toolbar.parts.groups({})],\n        toolbarBehaviours: getToolbarbehaviours(toolbarSpec, modeName)\n      });\n    };\n\n    var factory$6 = function (detail, components, _spec) {\n      var apis = {\n        getSocket: function (comp) {\n          return parts$a.getPart(comp, detail, 'socket');\n        },\n        setSidebar: function (comp, panelConfigs) {\n          parts$a.getPart(comp, detail, 'sidebar').each(function (sidebar) {\n            return setSidebar(sidebar, panelConfigs);\n          });\n        },\n        toggleSidebar: function (comp, name) {\n          parts$a.getPart(comp, detail, 'sidebar').each(function (sidebar) {\n            return toggleSidebar(sidebar, name);\n          });\n        },\n        whichSidebar: function (comp) {\n          return parts$a.getPart(comp, detail, 'sidebar').bind(whichSidebar).getOrNull();\n        },\n        getHeader: function (comp) {\n          return parts$a.getPart(comp, detail, 'header');\n        },\n        getToolbar: function (comp) {\n          return parts$a.getPart(comp, detail, 'toolbar');\n        },\n        setToolbar: function (comp, groups) {\n          parts$a.getPart(comp, detail, 'toolbar').each(function (toolbar) {\n            toolbar.getApis().setGroups(toolbar, groups);\n          });\n        },\n        setToolbars: function (comp, toolbars) {\n          parts$a.getPart(comp, detail, 'multiple-toolbar').each(function (mToolbar) {\n            CustomList.setItems(mToolbar, toolbars);\n          });\n        },\n        refreshToolbar: function (comp) {\n          var toolbar = parts$a.getPart(comp, detail, 'toolbar');\n          toolbar.each(function (toolbar) {\n            return toolbar.getApis().refresh(toolbar);\n          });\n        },\n        toggleToolbarDrawer: function (comp) {\n          parts$a.getPart(comp, detail, 'toolbar').each(function (toolbar) {\n            mapFrom(toolbar.getApis().toggle, function (toggle) {\n              return toggle(toolbar);\n            });\n          });\n        },\n        isToolbarDrawerToggled: function (comp) {\n          return parts$a.getPart(comp, detail, 'toolbar').bind(function (toolbar) {\n            return Optional.from(toolbar.getApis().isOpen).map(function (isOpen) {\n              return isOpen(toolbar);\n            });\n          }).getOr(false);\n        },\n        getThrobber: function (comp) {\n          return parts$a.getPart(comp, detail, 'throbber');\n        },\n        focusToolbar: function (comp) {\n          var optToolbar = parts$a.getPart(comp, detail, 'toolbar').orThunk(function () {\n            return parts$a.getPart(comp, detail, 'multiple-toolbar');\n          });\n          optToolbar.each(function (toolbar) {\n            Keying.focusIn(toolbar);\n          });\n        },\n        setMenubar: function (comp, menus) {\n          parts$a.getPart(comp, detail, 'menubar').each(function (menubar) {\n            SilverMenubar.setMenus(menubar, menus);\n          });\n        },\n        focusMenubar: function (comp) {\n          parts$a.getPart(comp, detail, 'menubar').each(function (menubar) {\n            SilverMenubar.focus(menubar);\n          });\n        }\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        apis: apis,\n        behaviours: detail.behaviours\n      };\n    };\n    var partMenubar = partType.optional({\n      factory: SilverMenubar,\n      name: 'menubar',\n      schema: [required$1('backstage')]\n    });\n    var toolbarFactory = function (spec) {\n      if (spec.type === ToolbarMode.sliding) {\n        return renderSlidingMoreToolbar;\n      } else if (spec.type === ToolbarMode.floating) {\n        return renderFloatingMoreToolbar;\n      } else {\n        return renderToolbar;\n      }\n    };\n    var partMultipleToolbar = partType.optional({\n      factory: {\n        sketch: function (spec) {\n          return CustomList.sketch({\n            uid: spec.uid,\n            dom: spec.dom,\n            listBehaviours: derive$1([Keying.config({\n                mode: 'acyclic',\n                selector: '.tox-toolbar'\n              })]),\n            makeItem: function () {\n              return renderToolbar({\n                type: spec.type,\n                uid: generate$6('multiple-toolbar-item'),\n                cyclicKeying: false,\n                initGroups: [],\n                providers: spec.providers,\n                onEscape: function () {\n                  spec.onEscape();\n                  return Optional.some(true);\n                }\n              });\n            },\n            setupItem: function (_mToolbar, tc, data, _index) {\n              Toolbar.setGroups(tc, data);\n            },\n            shell: true\n          });\n        }\n      },\n      name: 'multiple-toolbar',\n      schema: [\n        required$1('dom'),\n        required$1('onEscape')\n      ]\n    });\n    var partToolbar = partType.optional({\n      factory: {\n        sketch: function (spec) {\n          var renderer = toolbarFactory(spec);\n          var toolbarSpec = {\n            type: spec.type,\n            uid: spec.uid,\n            onEscape: function () {\n              spec.onEscape();\n              return Optional.some(true);\n            },\n            cyclicKeying: false,\n            initGroups: [],\n            getSink: spec.getSink,\n            providers: spec.providers,\n            moreDrawerData: {\n              lazyToolbar: spec.lazyToolbar,\n              lazyMoreButton: spec.lazyMoreButton,\n              lazyHeader: spec.lazyHeader\n            },\n            attributes: spec.attributes\n          };\n          return renderer(toolbarSpec);\n        }\n      },\n      name: 'toolbar',\n      schema: [\n        required$1('dom'),\n        required$1('onEscape'),\n        required$1('getSink')\n      ]\n    });\n    var partHeader = partType.optional({\n      factory: { sketch: renderHeader },\n      name: 'header',\n      schema: [required$1('dom')]\n    });\n    var partSocket = partType.optional({\n      name: 'socket',\n      schema: [required$1('dom')]\n    });\n    var partSidebar = partType.optional({\n      factory: { sketch: renderSidebar },\n      name: 'sidebar',\n      schema: [required$1('dom')]\n    });\n    var partThrobber = partType.optional({\n      factory: { sketch: renderThrobber },\n      name: 'throbber',\n      schema: [required$1('dom')]\n    });\n    var OuterContainer = composite({\n      name: 'OuterContainer',\n      factory: factory$6,\n      configFields: [\n        required$1('dom'),\n        required$1('behaviours')\n      ],\n      partFields: [\n        partHeader,\n        partMenubar,\n        partToolbar,\n        partMultipleToolbar,\n        partSocket,\n        partSidebar,\n        partThrobber\n      ],\n      apis: {\n        getSocket: function (apis, comp) {\n          return apis.getSocket(comp);\n        },\n        setSidebar: function (apis, comp, panelConfigs) {\n          apis.setSidebar(comp, panelConfigs);\n        },\n        toggleSidebar: function (apis, comp, name) {\n          apis.toggleSidebar(comp, name);\n        },\n        whichSidebar: function (apis, comp) {\n          return apis.whichSidebar(comp);\n        },\n        getHeader: function (apis, comp) {\n          return apis.getHeader(comp);\n        },\n        getToolbar: function (apis, comp) {\n          return apis.getToolbar(comp);\n        },\n        setToolbar: function (apis, comp, grps) {\n          var groups = map$2(grps, function (grp) {\n            return renderToolbarGroup(grp);\n          });\n          apis.setToolbar(comp, groups);\n        },\n        setToolbars: function (apis, comp, ts) {\n          var renderedToolbars = map$2(ts, function (g) {\n            return map$2(g, renderToolbarGroup);\n          });\n          apis.setToolbars(comp, renderedToolbars);\n        },\n        refreshToolbar: function (apis, comp) {\n          return apis.refreshToolbar(comp);\n        },\n        toggleToolbarDrawer: function (apis, comp) {\n          apis.toggleToolbarDrawer(comp);\n        },\n        isToolbarDrawerToggled: function (apis, comp) {\n          return apis.isToolbarDrawerToggled(comp);\n        },\n        getThrobber: function (apis, comp) {\n          return apis.getThrobber(comp);\n        },\n        setMenubar: function (apis, comp, menus) {\n          apis.setMenubar(comp, menus);\n        },\n        focusMenubar: function (apis, comp) {\n          apis.focusMenubar(comp);\n        },\n        focusToolbar: function (apis, comp) {\n          apis.focusToolbar(comp);\n        }\n      }\n    });\n\n    var defaultMenubar = 'file edit view insert format tools table help';\n    var defaultMenus = {\n      file: {\n        title: 'File',\n        items: 'newdocument restoredraft | preview | export print | deleteallconversations'\n      },\n      edit: {\n        title: 'Edit',\n        items: 'undo redo | cut copy paste pastetext | selectall | searchreplace'\n      },\n      view: {\n        title: 'View',\n        items: 'code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments'\n      },\n      insert: {\n        title: 'Insert',\n        items: 'image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime'\n      },\n      format: {\n        title: 'Format',\n        items: 'bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | language | removeformat'\n      },\n      tools: {\n        title: 'Tools',\n        items: 'spellchecker spellcheckerlanguage | a11ycheck code wordcount'\n      },\n      table: {\n        title: 'Table',\n        items: 'inserttable | cell row column | advtablesort | tableprops deletetable'\n      },\n      help: {\n        title: 'Help',\n        items: 'help'\n      }\n    };\n    var make = function (menu, registry, editor) {\n      var removedMenuItems = getRemovedMenuItems(editor).split(/[ ,]/);\n      return {\n        text: menu.title,\n        getItems: function () {\n          return bind$3(menu.items, function (i) {\n            var itemName = i.toLowerCase();\n            if (itemName.trim().length === 0) {\n              return [];\n            } else if (exists(removedMenuItems, function (removedMenuItem) {\n                return removedMenuItem === itemName;\n              })) {\n              return [];\n            } else if (itemName === 'separator' || itemName === '|') {\n              return [{ type: 'separator' }];\n            } else if (registry.menuItems[itemName]) {\n              return [registry.menuItems[itemName]];\n            } else {\n              return [];\n            }\n          });\n        }\n      };\n    };\n    var parseItemsString = function (items) {\n      if (typeof items === 'string') {\n        return items.split(' ');\n      }\n      return items;\n    };\n    var identifyMenus = function (editor, registry) {\n      var rawMenuData = __assign(__assign({}, defaultMenus), registry.menus);\n      var userDefinedMenus = keys(registry.menus).length > 0;\n      var menubar = registry.menubar === undefined || registry.menubar === true ? parseItemsString(defaultMenubar) : parseItemsString(registry.menubar === false ? '' : registry.menubar);\n      var validMenus = filter$2(menubar, function (menuName) {\n        var isDefaultMenu = has$2(defaultMenus, menuName);\n        if (userDefinedMenus) {\n          return isDefaultMenu || get$e(registry.menus, menuName).exists(function (menu) {\n            return has$2(menu, 'items');\n          });\n        } else {\n          return isDefaultMenu;\n        }\n      });\n      var menus = map$2(validMenus, function (menuName) {\n        var menuData = rawMenuData[menuName];\n        return make({\n          title: menuData.title,\n          items: parseItemsString(menuData.items)\n        }, registry, editor);\n      });\n      return filter$2(menus, function (menu) {\n        var isNotSeparator = function (item) {\n          return item.type !== 'separator';\n        };\n        return menu.getItems().length > 0 && exists(menu.getItems(), isNotSeparator);\n      });\n    };\n\n    var fireSkinLoaded = function (editor) {\n      var done = function () {\n        editor._skinLoaded = true;\n        fireSkinLoaded$1(editor);\n      };\n      return function () {\n        if (editor.initialized) {\n          done();\n        } else {\n          editor.on('init', done);\n        }\n      };\n    };\n    var fireSkinLoadError = function (editor, err) {\n      return function () {\n        return fireSkinLoadError$1(editor, { message: err });\n      };\n    };\n\n    var loadStylesheet = function (editor, stylesheetUrl, styleSheetLoader) {\n      return new global$c(function (resolve, reject) {\n        styleSheetLoader.load(stylesheetUrl, resolve, reject);\n        editor.on('remove', function () {\n          return styleSheetLoader.unload(stylesheetUrl);\n        });\n      });\n    };\n    var loadUiSkins = function (editor, skinUrl) {\n      var skinUiCss = skinUrl + '/skin.min.css';\n      return loadStylesheet(editor, skinUiCss, editor.ui.styleSheetLoader);\n    };\n    var loadShadowDomUiSkins = function (editor, skinUrl) {\n      var isInShadowRoot$1 = isInShadowRoot(SugarElement.fromDom(editor.getElement()));\n      if (isInShadowRoot$1) {\n        var shadowDomSkinCss = skinUrl + '/skin.shadowdom.min.css';\n        return loadStylesheet(editor, shadowDomSkinCss, global$b.DOM.styleSheetLoader);\n      } else {\n        return global$c.resolve();\n      }\n    };\n    var loadSkin = function (isInline, editor) {\n      var skinUrl = getSkinUrl(editor);\n      if (skinUrl) {\n        editor.contentCSS.push(skinUrl + (isInline ? '/content.inline' : '/content') + '.min.css');\n      }\n      if (isSkinDisabled(editor) === false && isString(skinUrl)) {\n        global$c.all([\n          loadUiSkins(editor, skinUrl),\n          loadShadowDomUiSkins(editor, skinUrl)\n        ]).then(fireSkinLoaded(editor), fireSkinLoadError(editor, 'Skin could not be loaded'));\n      } else {\n        fireSkinLoaded(editor)();\n      }\n    };\n    var iframe = curry(loadSkin, false);\n    var inline = curry(loadSkin, true);\n\n    var onSetupFormatToggle = function (editor, name) {\n      return function (api) {\n        var boundCallback = unbindable();\n        var init = function () {\n          api.setActive(editor.formatter.match(name));\n          var binding = editor.formatter.formatChanged(name, api.setActive);\n          boundCallback.set(binding);\n        };\n        editor.initialized ? init() : editor.once('init', init);\n        return function () {\n          editor.off('init', init);\n          boundCallback.clear();\n        };\n      };\n    };\n    var onSetupEvent = function (editor, event, f) {\n      return function (api) {\n        var handleEvent = function () {\n          return f(api);\n        };\n        var init = function () {\n          f(api);\n          editor.on(event, handleEvent);\n        };\n        editor.initialized ? init() : editor.once('init', init);\n        return function () {\n          editor.off('init', init);\n          editor.off(event, handleEvent);\n        };\n      };\n    };\n    var onActionToggleFormat$1 = function (editor) {\n      return function (rawItem) {\n        return function () {\n          editor.undoManager.transact(function () {\n            editor.focus();\n            editor.execCommand('mceToggleFormat', false, rawItem.format);\n          });\n        };\n      };\n    };\n    var onActionExecCommand = function (editor, command) {\n      return function () {\n        return editor.execCommand(command);\n      };\n    };\n\n    var generateSelectItems = function (_editor, backstage, spec) {\n      var generateItem = function (rawItem, response, disabled, value) {\n        var translatedText = backstage.shared.providers.translate(rawItem.title);\n        if (rawItem.type === 'separator') {\n          return Optional.some({\n            type: 'separator',\n            text: translatedText\n          });\n        } else if (rawItem.type === 'submenu') {\n          var items = bind$3(rawItem.getStyleItems(), function (si) {\n            return validate(si, response, value);\n          });\n          if (response === 0 && items.length <= 0) {\n            return Optional.none();\n          } else {\n            return Optional.some({\n              type: 'nestedmenuitem',\n              text: translatedText,\n              disabled: items.length <= 0,\n              getSubmenuItems: function () {\n                return bind$3(rawItem.getStyleItems(), function (si) {\n                  return validate(si, response, value);\n                });\n              }\n            });\n          }\n        } else {\n          return Optional.some(__assign({\n            type: 'togglemenuitem',\n            text: translatedText,\n            icon: rawItem.icon,\n            active: rawItem.isSelected(value),\n            disabled: disabled,\n            onAction: spec.onAction(rawItem)\n          }, rawItem.getStylePreview().fold(function () {\n            return {};\n          }, function (preview) {\n            return { meta: { style: preview } };\n          })));\n        }\n      };\n      var validate = function (item, response, value) {\n        var invalid = item.type === 'formatter' && spec.isInvalid(item);\n        if (response === 0) {\n          return invalid ? [] : generateItem(item, response, false, value).toArray();\n        } else {\n          return generateItem(item, response, invalid, value).toArray();\n        }\n      };\n      var validateItems = function (preItems) {\n        var value = spec.getCurrentValue();\n        var response = spec.shouldHide ? 0 : 1;\n        return bind$3(preItems, function (item) {\n          return validate(item, response, value);\n        });\n      };\n      var getFetch = function (backstage, getStyleItems) {\n        return function (comp, callback) {\n          var preItems = getStyleItems();\n          var items = validateItems(preItems);\n          var menu = build(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false);\n          callback(menu);\n        };\n      };\n      return {\n        validateItems: validateItems,\n        getFetch: getFetch\n      };\n    };\n    var createMenuItems = function (editor, backstage, spec) {\n      var dataset = spec.dataset;\n      var getStyleItems = dataset.type === 'basic' ? function () {\n        return map$2(dataset.data, function (d) {\n          return processBasic(d, spec.isSelectedFor, spec.getPreviewFor);\n        });\n      } : dataset.getData;\n      return {\n        items: generateSelectItems(editor, backstage, spec),\n        getStyleItems: getStyleItems\n      };\n    };\n    var createSelectButton = function (editor, backstage, spec) {\n      var _a = createMenuItems(editor, backstage, spec), items = _a.items, getStyleItems = _a.getStyleItems;\n      var getApi = function (comp) {\n        return { getComponent: constant$1(comp) };\n      };\n      var onSetup = onSetupEvent(editor, 'NodeChange', function (api) {\n        var comp = api.getComponent();\n        spec.updateText(comp);\n      });\n      return renderCommonDropdown({\n        text: spec.icon.isSome() ? Optional.none() : spec.text,\n        icon: spec.icon,\n        tooltip: Optional.from(spec.tooltip),\n        role: Optional.none(),\n        fetch: items.getFetch(backstage, getStyleItems),\n        onSetup: onSetup,\n        getApi: getApi,\n        columns: 1,\n        presets: 'normal',\n        classes: spec.icon.isSome() ? [] : ['bespoke'],\n        dropdownBehaviours: []\n      }, 'tox-tbtn', backstage.shared);\n    };\n\n    var process = function (rawFormats) {\n      return map$2(rawFormats, function (item) {\n        var title = item, format = item;\n        var values = item.split('=');\n        if (values.length > 1) {\n          title = values[0];\n          format = values[1];\n        }\n        return {\n          title: title,\n          format: format\n        };\n      });\n    };\n    var buildBasicStaticDataset = function (data) {\n      return {\n        type: 'basic',\n        data: data\n      };\n    };\n    var Delimiter;\n    (function (Delimiter) {\n      Delimiter[Delimiter['SemiColon'] = 0] = 'SemiColon';\n      Delimiter[Delimiter['Space'] = 1] = 'Space';\n    }(Delimiter || (Delimiter = {})));\n    var split = function (rawFormats, delimiter) {\n      if (delimiter === Delimiter.SemiColon) {\n        return rawFormats.replace(/;$/, '').split(';');\n      } else {\n        return rawFormats.split(' ');\n      }\n    };\n    var buildBasicSettingsDataset = function (editor, settingName, defaults, delimiter) {\n      var rawFormats = editor.getParam(settingName, defaults, 'string');\n      var data = process(split(rawFormats, delimiter));\n      return {\n        type: 'basic',\n        data: data\n      };\n    };\n\n    var alignMenuItems = [\n      {\n        title: 'Left',\n        icon: 'align-left',\n        format: 'alignleft',\n        command: 'JustifyLeft'\n      },\n      {\n        title: 'Center',\n        icon: 'align-center',\n        format: 'aligncenter',\n        command: 'JustifyCenter'\n      },\n      {\n        title: 'Right',\n        icon: 'align-right',\n        format: 'alignright',\n        command: 'JustifyRight'\n      },\n      {\n        title: 'Justify',\n        icon: 'align-justify',\n        format: 'alignjustify',\n        command: 'JustifyFull'\n      }\n    ];\n    var getSpec$4 = function (editor) {\n      var getMatchingValue = function () {\n        return find$5(alignMenuItems, function (item) {\n          return editor.formatter.match(item.format);\n        });\n      };\n      var isSelectedFor = function (format) {\n        return function () {\n          return editor.formatter.match(format);\n        };\n      };\n      var getPreviewFor = function (_format) {\n        return Optional.none;\n      };\n      var updateSelectMenuIcon = function (comp) {\n        var match = getMatchingValue();\n        var alignment = match.fold(constant$1('left'), function (item) {\n          return item.title.toLowerCase();\n        });\n        emitWith(comp, updateMenuIcon, { icon: 'align-' + alignment });\n      };\n      var dataset = buildBasicStaticDataset(alignMenuItems);\n      var onAction = function (rawItem) {\n        return function () {\n          return find$5(alignMenuItems, function (item) {\n            return item.format === rawItem.format;\n          }).each(function (item) {\n            return editor.execCommand(item.command);\n          });\n        };\n      };\n      return {\n        tooltip: 'Align',\n        text: Optional.none(),\n        icon: Optional.some('align-left'),\n        isSelectedFor: isSelectedFor,\n        getCurrentValue: Optional.none,\n        getPreviewFor: getPreviewFor,\n        onAction: onAction,\n        updateText: updateSelectMenuIcon,\n        dataset: dataset,\n        shouldHide: false,\n        isInvalid: function (item) {\n          return !editor.formatter.canApply(item.format);\n        }\n      };\n    };\n    var createAlignSelect = function (editor, backstage) {\n      return createSelectButton(editor, backstage, getSpec$4(editor));\n    };\n    var alignSelectMenu = function (editor, backstage) {\n      var menuItems = createMenuItems(editor, backstage, getSpec$4(editor));\n      editor.ui.registry.addNestedMenuItem('align', {\n        text: backstage.shared.providers.translate('Align'),\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var defaultFontsFormats = 'Andale Mono=andale mono,monospace;' + 'Arial=arial,helvetica,sans-serif;' + 'Arial Black=arial black,sans-serif;' + 'Book Antiqua=book antiqua,palatino,serif;' + 'Comic Sans MS=comic sans ms,sans-serif;' + 'Courier New=courier new,courier,monospace;' + 'Georgia=georgia,palatino,serif;' + 'Helvetica=helvetica,arial,sans-serif;' + 'Impact=impact,sans-serif;' + 'Symbol=symbol;' + 'Tahoma=tahoma,arial,helvetica,sans-serif;' + 'Terminal=terminal,monaco,monospace;' + 'Times New Roman=times new roman,times,serif;' + 'Trebuchet MS=trebuchet ms,geneva,sans-serif;' + 'Verdana=verdana,geneva,sans-serif;' + 'Webdings=webdings;' + 'Wingdings=wingdings,zapf dingbats';\n    var systemStackFonts = [\n      '-apple-system',\n      'Segoe UI',\n      'Roboto',\n      'Helvetica Neue',\n      'sans-serif'\n    ];\n    var splitFonts = function (fontFamily) {\n      var fonts = fontFamily.split(/\\s*,\\s*/);\n      return map$2(fonts, function (font) {\n        return font.replace(/^['\"]+|['\"]+$/g, '');\n      });\n    };\n    var isSystemFontStack = function (fontFamily) {\n      var matchesSystemStack = function () {\n        var fonts = splitFonts(fontFamily.toLowerCase());\n        return forall(systemStackFonts, function (font) {\n          return fonts.indexOf(font.toLowerCase()) > -1;\n        });\n      };\n      return fontFamily.indexOf('-apple-system') === 0 && matchesSystemStack();\n    };\n    var getSpec$3 = function (editor) {\n      var systemFont = 'System Font';\n      var getMatchingValue = function () {\n        var getFirstFont = function (fontFamily) {\n          return fontFamily ? splitFonts(fontFamily)[0] : '';\n        };\n        var fontFamily = editor.queryCommandValue('FontName');\n        var items = dataset.data;\n        var font = fontFamily ? fontFamily.toLowerCase() : '';\n        var matchOpt = find$5(items, function (item) {\n          var format = item.format;\n          return format.toLowerCase() === font || getFirstFont(format).toLowerCase() === getFirstFont(font).toLowerCase();\n        }).orThunk(function () {\n          return someIf(isSystemFontStack(font), {\n            title: systemFont,\n            format: font\n          });\n        });\n        return {\n          matchOpt: matchOpt,\n          font: fontFamily\n        };\n      };\n      var isSelectedFor = function (item) {\n        return function (valueOpt) {\n          return valueOpt.exists(function (value) {\n            return value.format === item;\n          });\n        };\n      };\n      var getCurrentValue = function () {\n        var matchOpt = getMatchingValue().matchOpt;\n        return matchOpt;\n      };\n      var getPreviewFor = function (item) {\n        return function () {\n          return Optional.some({\n            tag: 'div',\n            styles: item.indexOf('dings') === -1 ? { 'font-family': item } : {}\n          });\n        };\n      };\n      var onAction = function (rawItem) {\n        return function () {\n          editor.undoManager.transact(function () {\n            editor.focus();\n            editor.execCommand('FontName', false, rawItem.format);\n          });\n        };\n      };\n      var updateSelectMenuText = function (comp) {\n        var _a = getMatchingValue(), matchOpt = _a.matchOpt, font = _a.font;\n        var text = matchOpt.fold(constant$1(font), function (item) {\n          return item.title;\n        });\n        emitWith(comp, updateMenuText, { text: text });\n      };\n      var dataset = buildBasicSettingsDataset(editor, 'font_formats', defaultFontsFormats, Delimiter.SemiColon);\n      return {\n        tooltip: 'Fonts',\n        text: Optional.some(systemFont),\n        icon: Optional.none(),\n        isSelectedFor: isSelectedFor,\n        getCurrentValue: getCurrentValue,\n        getPreviewFor: getPreviewFor,\n        onAction: onAction,\n        updateText: updateSelectMenuText,\n        dataset: dataset,\n        shouldHide: false,\n        isInvalid: never\n      };\n    };\n    var createFontSelect = function (editor, backstage) {\n      return createSelectButton(editor, backstage, getSpec$3(editor));\n    };\n    var fontSelectMenu = function (editor, backstage) {\n      var menuItems = createMenuItems(editor, backstage, getSpec$3(editor));\n      editor.ui.registry.addNestedMenuItem('fontformats', {\n        text: backstage.shared.providers.translate('Fonts'),\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var defaultFontsizeFormats = '8pt 10pt 12pt 14pt 18pt 24pt 36pt';\n    var legacyFontSizes = {\n      '8pt': '1',\n      '10pt': '2',\n      '12pt': '3',\n      '14pt': '4',\n      '18pt': '5',\n      '24pt': '6',\n      '36pt': '7'\n    };\n    var keywordFontSizes = {\n      'xx-small': '7pt',\n      'x-small': '8pt',\n      'small': '10pt',\n      'medium': '12pt',\n      'large': '14pt',\n      'x-large': '18pt',\n      'xx-large': '24pt'\n    };\n    var round = function (number, precision) {\n      var factor = Math.pow(10, precision);\n      return Math.round(number * factor) / factor;\n    };\n    var toPt = function (fontSize, precision) {\n      if (/[0-9.]+px$/.test(fontSize)) {\n        return round(parseInt(fontSize, 10) * 72 / 96, precision || 0) + 'pt';\n      } else {\n        return get$e(keywordFontSizes, fontSize).getOr(fontSize);\n      }\n    };\n    var toLegacy = function (fontSize) {\n      return get$e(legacyFontSizes, fontSize).getOr('');\n    };\n    var getSpec$2 = function (editor) {\n      var getMatchingValue = function () {\n        var matchOpt = Optional.none();\n        var items = dataset.data;\n        var fontSize = editor.queryCommandValue('FontSize');\n        if (fontSize) {\n          var _loop_1 = function (precision) {\n            var pt = toPt(fontSize, precision);\n            var legacy = toLegacy(pt);\n            matchOpt = find$5(items, function (item) {\n              return item.format === fontSize || item.format === pt || item.format === legacy;\n            });\n          };\n          for (var precision = 3; matchOpt.isNone() && precision >= 0; precision--) {\n            _loop_1(precision);\n          }\n        }\n        return {\n          matchOpt: matchOpt,\n          size: fontSize\n        };\n      };\n      var isSelectedFor = function (item) {\n        return function (valueOpt) {\n          return valueOpt.exists(function (value) {\n            return value.format === item;\n          });\n        };\n      };\n      var getCurrentValue = function () {\n        var matchOpt = getMatchingValue().matchOpt;\n        return matchOpt;\n      };\n      var getPreviewFor = constant$1(Optional.none);\n      var onAction = function (rawItem) {\n        return function () {\n          editor.undoManager.transact(function () {\n            editor.focus();\n            editor.execCommand('FontSize', false, rawItem.format);\n          });\n        };\n      };\n      var updateSelectMenuText = function (comp) {\n        var _a = getMatchingValue(), matchOpt = _a.matchOpt, size = _a.size;\n        var text = matchOpt.fold(constant$1(size), function (match) {\n          return match.title;\n        });\n        emitWith(comp, updateMenuText, { text: text });\n      };\n      var dataset = buildBasicSettingsDataset(editor, 'fontsize_formats', defaultFontsizeFormats, Delimiter.Space);\n      return {\n        tooltip: 'Font sizes',\n        text: Optional.some('12pt'),\n        icon: Optional.none(),\n        isSelectedFor: isSelectedFor,\n        getPreviewFor: getPreviewFor,\n        getCurrentValue: getCurrentValue,\n        onAction: onAction,\n        updateText: updateSelectMenuText,\n        dataset: dataset,\n        shouldHide: false,\n        isInvalid: never\n      };\n    };\n    var createFontsizeSelect = function (editor, backstage) {\n      return createSelectButton(editor, backstage, getSpec$2(editor));\n    };\n    var fontsizeSelectMenu = function (editor, backstage) {\n      var menuItems = createMenuItems(editor, backstage, getSpec$2(editor));\n      editor.ui.registry.addNestedMenuItem('fontsizes', {\n        text: 'Font sizes',\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var findNearest = function (editor, getStyles) {\n      var styles = getStyles();\n      var formats = map$2(styles, function (style) {\n        return style.format;\n      });\n      return Optional.from(editor.formatter.closest(formats)).bind(function (fmt) {\n        return find$5(styles, function (data) {\n          return data.format === fmt;\n        });\n      }).orThunk(function () {\n        return someIf(editor.formatter.match('p'), {\n          title: 'Paragraph',\n          format: 'p'\n        });\n      });\n    };\n\n    var defaultBlocks = 'Paragraph=p;' + 'Heading 1=h1;' + 'Heading 2=h2;' + 'Heading 3=h3;' + 'Heading 4=h4;' + 'Heading 5=h5;' + 'Heading 6=h6;' + 'Preformatted=pre';\n    var getSpec$1 = function (editor) {\n      var fallbackFormat = 'Paragraph';\n      var isSelectedFor = function (format) {\n        return function () {\n          return editor.formatter.match(format);\n        };\n      };\n      var getPreviewFor = function (format) {\n        return function () {\n          var fmt = editor.formatter.get(format);\n          return Optional.some({\n            tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n            styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n          });\n        };\n      };\n      var updateSelectMenuText = function (comp) {\n        var detectedFormat = findNearest(editor, function () {\n          return dataset.data;\n        });\n        var text = detectedFormat.fold(constant$1(fallbackFormat), function (fmt) {\n          return fmt.title;\n        });\n        emitWith(comp, updateMenuText, { text: text });\n      };\n      var dataset = buildBasicSettingsDataset(editor, 'block_formats', defaultBlocks, Delimiter.SemiColon);\n      return {\n        tooltip: 'Blocks',\n        text: Optional.some(fallbackFormat),\n        icon: Optional.none(),\n        isSelectedFor: isSelectedFor,\n        getCurrentValue: Optional.none,\n        getPreviewFor: getPreviewFor,\n        onAction: onActionToggleFormat$1(editor),\n        updateText: updateSelectMenuText,\n        dataset: dataset,\n        shouldHide: false,\n        isInvalid: function (item) {\n          return !editor.formatter.canApply(item.format);\n        }\n      };\n    };\n    var createFormatSelect = function (editor, backstage) {\n      return createSelectButton(editor, backstage, getSpec$1(editor));\n    };\n    var formatSelectMenu = function (editor, backstage) {\n      var menuItems = createMenuItems(editor, backstage, getSpec$1(editor));\n      editor.ui.registry.addNestedMenuItem('blockformats', {\n        text: 'Blocks',\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var getSpec = function (editor, dataset) {\n      var fallbackFormat = 'Paragraph';\n      var isSelectedFor = function (format) {\n        return function () {\n          return editor.formatter.match(format);\n        };\n      };\n      var getPreviewFor = function (format) {\n        return function () {\n          var fmt = editor.formatter.get(format);\n          return fmt !== undefined ? Optional.some({\n            tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n            styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n          }) : Optional.none();\n        };\n      };\n      var updateSelectMenuText = function (comp) {\n        var getFormatItems = function (fmt) {\n          var subs = fmt.items;\n          return subs !== undefined && subs.length > 0 ? bind$3(subs, getFormatItems) : [{\n              title: fmt.title,\n              format: fmt.format\n            }];\n        };\n        var flattenedItems = bind$3(getStyleFormats(editor), getFormatItems);\n        var detectedFormat = findNearest(editor, constant$1(flattenedItems));\n        var text = detectedFormat.fold(constant$1(fallbackFormat), function (fmt) {\n          return fmt.title;\n        });\n        emitWith(comp, updateMenuText, { text: text });\n      };\n      return {\n        tooltip: 'Formats',\n        text: Optional.some(fallbackFormat),\n        icon: Optional.none(),\n        isSelectedFor: isSelectedFor,\n        getCurrentValue: Optional.none,\n        getPreviewFor: getPreviewFor,\n        onAction: onActionToggleFormat$1(editor),\n        updateText: updateSelectMenuText,\n        shouldHide: editor.getParam('style_formats_autohide', false, 'boolean'),\n        isInvalid: function (item) {\n          return !editor.formatter.canApply(item.format);\n        },\n        dataset: dataset\n      };\n    };\n    var createStyleSelect = function (editor, backstage) {\n      var dataset = __assign({ type: 'advanced' }, backstage.styleselect);\n      return createSelectButton(editor, backstage, getSpec(editor, dataset));\n    };\n    var styleSelectMenu = function (editor, backstage) {\n      var dataset = __assign({ type: 'advanced' }, backstage.styleselect);\n      var menuItems = createMenuItems(editor, backstage, getSpec(editor, dataset));\n      editor.ui.registry.addNestedMenuItem('formats', {\n        text: 'Formats',\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var events$3 = function (reflectingConfig, reflectingState) {\n      var update = function (component, data) {\n        reflectingConfig.updateState.each(function (updateState) {\n          var newState = updateState(component, data);\n          reflectingState.set(newState);\n        });\n        reflectingConfig.renderComponents.each(function (renderComponents) {\n          var newComponents = renderComponents(data, reflectingState.get());\n          var newChildren = map$2(newComponents, component.getSystem().build);\n          replaceChildren(component, newChildren);\n        });\n      };\n      return derive$2([\n        run$1(receive(), function (component, message) {\n          var receivingData = message;\n          if (!receivingData.universal) {\n            var channel = reflectingConfig.channel;\n            if (contains$2(receivingData.channels, channel)) {\n              update(component, receivingData.data);\n            }\n          }\n        }),\n        runOnAttached(function (comp, _se) {\n          reflectingConfig.initialData.each(function (rawData) {\n            update(comp, rawData);\n          });\n        })\n      ]);\n    };\n\n    var ActiveReflecting = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$3\n    });\n\n    var getState = function (component, replaceConfig, reflectState) {\n      return reflectState;\n    };\n\n    var ReflectingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getState: getState\n    });\n\n    var ReflectingSchema = [\n      required$1('channel'),\n      option('renderComponents'),\n      option('updateState'),\n      option('initialData')\n    ];\n\n    var init$3 = function () {\n      var cell = Cell(Optional.none());\n      var clear = function () {\n        return cell.set(Optional.none());\n      };\n      var readState = function () {\n        return cell.get().getOr('none');\n      };\n      return {\n        readState: readState,\n        get: cell.get,\n        set: cell.set,\n        clear: clear\n      };\n    };\n\n    var ReflectingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$3\n    });\n\n    var Reflecting = create$7({\n      fields: ReflectingSchema,\n      name: 'reflecting',\n      active: ActiveReflecting,\n      apis: ReflectingApis,\n      state: ReflectingState\n    });\n\n    var schema$7 = constant$1([\n      required$1('toggleClass'),\n      required$1('fetch'),\n      onStrictHandler('onExecute'),\n      defaulted('getHotspot', Optional.some),\n      defaulted('getAnchorOverrides', constant$1({})),\n      schema$y(),\n      onStrictHandler('onItemExecute'),\n      option('lazySink'),\n      required$1('dom'),\n      onHandler('onOpen'),\n      field('splitDropdownBehaviours', [\n        Coupling,\n        Keying,\n        Focusing\n      ]),\n      defaulted('matchWidth', false),\n      defaulted('useMinWidth', false),\n      defaulted('eventOrder', {}),\n      option('role')\n    ].concat(sandboxFields()));\n    var arrowPart = required({\n      factory: Button,\n      schema: [required$1('dom')],\n      name: 'arrow',\n      defaults: function () {\n        return { buttonBehaviours: derive$1([Focusing.revoke()]) };\n      },\n      overrides: function (detail) {\n        return {\n          dom: {\n            tag: 'span',\n            attributes: { role: 'presentation' }\n          },\n          action: function (arrow) {\n            arrow.getSystem().getByUid(detail.uid).each(emitExecute);\n          },\n          buttonBehaviours: derive$1([Toggling.config({\n              toggleOnExecute: false,\n              toggleClass: detail.toggleClass\n            })])\n        };\n      }\n    });\n    var buttonPart = required({\n      factory: Button,\n      schema: [required$1('dom')],\n      name: 'button',\n      defaults: function () {\n        return { buttonBehaviours: derive$1([Focusing.revoke()]) };\n      },\n      overrides: function (detail) {\n        return {\n          dom: {\n            tag: 'span',\n            attributes: { role: 'presentation' }\n          },\n          action: function (btn) {\n            btn.getSystem().getByUid(detail.uid).each(function (splitDropdown) {\n              detail.onExecute(splitDropdown, btn);\n            });\n          }\n        };\n      }\n    });\n    var parts$3 = constant$1([\n      arrowPart,\n      buttonPart,\n      optional({\n        factory: {\n          sketch: function (spec) {\n            return {\n              uid: spec.uid,\n              dom: {\n                tag: 'span',\n                styles: { display: 'none' },\n                attributes: { 'aria-hidden': 'true' },\n                innerHtml: spec.text\n              }\n            };\n          }\n        },\n        schema: [required$1('text')],\n        name: 'aria-descriptor'\n      }),\n      external$1({\n        schema: [tieredMenuMarkers()],\n        name: 'menu',\n        defaults: function (detail) {\n          return {\n            onExecute: function (tmenu, item) {\n              tmenu.getSystem().getByUid(detail.uid).each(function (splitDropdown) {\n                detail.onItemExecute(splitDropdown, tmenu, item);\n              });\n            }\n          };\n        }\n      }),\n      partType$1()\n    ]);\n\n    var factory$5 = function (detail, components, spec, externals) {\n      var _a;\n      var switchToMenu = function (sandbox) {\n        Composing.getCurrent(sandbox).each(function (current) {\n          Highlighting.highlightFirst(current);\n          Keying.focusIn(current);\n        });\n      };\n      var action = function (component) {\n        var onOpenSync = switchToMenu;\n        togglePopup(detail, identity$1, component, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n      };\n      var openMenu = function (comp) {\n        action(comp);\n        return Optional.some(true);\n      };\n      var executeOnButton = function (comp) {\n        var button = getPartOrDie(comp, detail, 'button');\n        emitExecute(button);\n        return Optional.some(true);\n      };\n      var buttonEvents = __assign(__assign({}, derive$2([runOnAttached(function (component, _simulatedEvent) {\n          var ariaDescriptor = getPart(component, detail, 'aria-descriptor');\n          ariaDescriptor.each(function (descriptor) {\n            var descriptorId = generate$6('aria');\n            set$8(descriptor.element, 'id', descriptorId);\n            set$8(component.element, 'aria-describedby', descriptorId);\n          });\n        })])), events$a(Optional.some(action)));\n      var apis = {\n        repositionMenus: function (comp) {\n          if (Toggling.isOn(comp)) {\n            repositionMenus(comp);\n          }\n        }\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        apis: apis,\n        eventOrder: __assign(__assign({}, detail.eventOrder), (_a = {}, _a[execute$5()] = [\n          'disabling',\n          'toggling',\n          'alloy.base.behaviour'\n        ], _a)),\n        events: buttonEvents,\n        behaviours: augment(detail.splitDropdownBehaviours, [\n          Coupling.config({\n            others: {\n              sandbox: function (hotspot) {\n                var arrow = getPartOrDie(hotspot, detail, 'arrow');\n                var extras = {\n                  onOpen: function () {\n                    Toggling.on(arrow);\n                    Toggling.on(hotspot);\n                  },\n                  onClose: function () {\n                    Toggling.off(arrow);\n                    Toggling.off(hotspot);\n                  }\n                };\n                return makeSandbox$1(detail, hotspot, extras);\n              }\n            }\n          }),\n          Keying.config({\n            mode: 'special',\n            onSpace: executeOnButton,\n            onEnter: executeOnButton,\n            onDown: openMenu\n          }),\n          Focusing.config({}),\n          Toggling.config({\n            toggleOnExecute: false,\n            aria: { mode: 'expanded' }\n          })\n        ]),\n        domModification: {\n          attributes: {\n            'role': detail.role.getOr('button'),\n            'aria-haspopup': true\n          }\n        }\n      };\n    };\n    var SplitDropdown = composite({\n      name: 'SplitDropdown',\n      configFields: schema$7(),\n      partFields: parts$3(),\n      factory: factory$5,\n      apis: {\n        repositionMenus: function (apis, comp) {\n          return apis.repositionMenus(comp);\n        }\n      }\n    });\n\n    var getButtonApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n    var getToggleApi = function (component) {\n      return {\n        setActive: function (state) {\n          Toggling.set(component, state);\n        },\n        isActive: function () {\n          return Toggling.isOn(component);\n        },\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n    var getTooltipAttributes = function (tooltip, providersBackstage) {\n      return tooltip.map(function (tooltip) {\n        return {\n          'aria-label': providersBackstage.translate(tooltip),\n          'title': providersBackstage.translate(tooltip)\n        };\n      }).getOr({});\n    };\n    var focusButtonEvent = generate$6('focus-button');\n    var renderCommonStructure = function (icon, text, tooltip, receiver, behaviours, providersBackstage) {\n      var _d;\n      return {\n        dom: {\n          tag: 'button',\n          classes: ['tox-tbtn'].concat(text.isSome() ? ['tox-tbtn--select'] : []),\n          attributes: getTooltipAttributes(tooltip, providersBackstage)\n        },\n        components: componentRenderPipeline([\n          icon.map(function (iconName) {\n            return renderIconFromPack(iconName, providersBackstage.icons);\n          }),\n          text.map(function (text) {\n            return renderLabel$1(text, 'tox-tbtn', providersBackstage);\n          })\n        ]),\n        eventOrder: (_d = {}, _d[mousedown()] = [\n          'focusing',\n          'alloy.base.behaviour',\n          'common-button-display-events'\n        ], _d),\n        buttonBehaviours: derive$1([\n          DisablingConfigs.toolbarButton(providersBackstage.isDisabled),\n          receivingConfig(),\n          config('common-button-display-events', [run$1(mousedown(), function (button, se) {\n              se.event.prevent();\n              emit(button, focusButtonEvent);\n            })])\n        ].concat(receiver.map(function (r) {\n          return Reflecting.config({\n            channel: r,\n            initialData: {\n              icon: icon,\n              text: text\n            },\n            renderComponents: function (data, _state) {\n              return componentRenderPipeline([\n                data.icon.map(function (iconName) {\n                  return renderIconFromPack(iconName, providersBackstage.icons);\n                }),\n                data.text.map(function (text) {\n                  return renderLabel$1(text, 'tox-tbtn', providersBackstage);\n                })\n              ]);\n            }\n          });\n        }).toArray()).concat(behaviours.getOr([])))\n      };\n    };\n    var renderFloatingToolbarButton = function (spec, backstage, identifyButtons, attributes) {\n      var sharedBackstage = backstage.shared;\n      return FloatingToolbarButton.sketch({\n        lazySink: sharedBackstage.getSink,\n        fetch: function () {\n          return Future.nu(function (resolve) {\n            resolve(map$2(identifyButtons(spec.items), renderToolbarGroup));\n          });\n        },\n        markers: { toggledClass: 'tox-tbtn--enabled' },\n        parts: {\n          button: renderCommonStructure(spec.icon, spec.text, spec.tooltip, Optional.none(), Optional.none(), sharedBackstage.providers),\n          toolbar: {\n            dom: {\n              tag: 'div',\n              classes: ['tox-toolbar__overflow'],\n              attributes: attributes\n            }\n          }\n        }\n      });\n    };\n    var renderCommonToolbarButton = function (spec, specialisation, providersBackstage) {\n      var editorOffCell = Cell(noop);\n      var structure = renderCommonStructure(spec.icon, spec.text, spec.tooltip, Optional.none(), Optional.none(), providersBackstage);\n      return Button.sketch({\n        dom: structure.dom,\n        components: structure.components,\n        eventOrder: toolbarButtonEventOrder,\n        buttonBehaviours: derive$1([\n          config('toolbar-button-events', [\n            onToolbarButtonExecute({\n              onAction: spec.onAction,\n              getApi: specialisation.getApi\n            }),\n            onControlAttached(specialisation, editorOffCell),\n            onControlDetached(specialisation, editorOffCell)\n          ]),\n          DisablingConfigs.toolbarButton(function () {\n            return spec.disabled || providersBackstage.isDisabled();\n          }),\n          receivingConfig()\n        ].concat(specialisation.toolbarButtonBehaviours))\n      });\n    };\n    var renderToolbarButton = function (spec, providersBackstage) {\n      return renderToolbarButtonWith(spec, providersBackstage, []);\n    };\n    var renderToolbarButtonWith = function (spec, providersBackstage, bonusEvents) {\n      return renderCommonToolbarButton(spec, {\n        toolbarButtonBehaviours: [].concat(bonusEvents.length > 0 ? [config('toolbarButtonWith', bonusEvents)] : []),\n        getApi: getButtonApi,\n        onSetup: spec.onSetup\n      }, providersBackstage);\n    };\n    var renderToolbarToggleButton = function (spec, providersBackstage) {\n      return renderToolbarToggleButtonWith(spec, providersBackstage, []);\n    };\n    var renderToolbarToggleButtonWith = function (spec, providersBackstage, bonusEvents) {\n      return deepMerge(renderCommonToolbarButton(spec, {\n        toolbarButtonBehaviours: [\n          Replacing.config({}),\n          Toggling.config({\n            toggleClass: 'tox-tbtn--enabled',\n            aria: { mode: 'pressed' },\n            toggleOnExecute: false\n          })\n        ].concat(bonusEvents.length > 0 ? [config('toolbarToggleButtonWith', bonusEvents)] : []),\n        getApi: getToggleApi,\n        onSetup: spec.onSetup\n      }, providersBackstage));\n    };\n    var fetchChoices = function (getApi, spec, providersBackstage) {\n      return function (comp) {\n        return Future.nu(function (callback) {\n          return spec.fetch(callback);\n        }).map(function (items) {\n          return Optional.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$6('menu-value'), items, function (value) {\n            spec.onItemAction(getApi(comp), value);\n          }, spec.columns, spec.presets, ItemResponse$1.CLOSE_ON_EXECUTE, spec.select.getOr(never), providersBackstage), {\n            movement: deriveMenuMovement(spec.columns, spec.presets),\n            menuBehaviours: SimpleBehaviours.unnamedEvents(spec.columns !== 'auto' ? [] : [runOnAttached(function (comp, _se) {\n                detectSize(comp, 4, classForPreset(spec.presets)).each(function (_d) {\n                  var numRows = _d.numRows, numColumns = _d.numColumns;\n                  Keying.setGridSize(comp, numRows, numColumns);\n                });\n              })])\n          })));\n        });\n      };\n    };\n    var renderSplitButton = function (spec, sharedBackstage) {\n      var _d;\n      var displayChannel = generate$6('channel-update-split-dropdown-display');\n      var getApi = function (comp) {\n        return {\n          isDisabled: function () {\n            return Disabling.isDisabled(comp);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(comp, state);\n          },\n          setIconFill: function (id, value) {\n            descendant(comp.element, 'svg path[id=\"' + id + '\"], rect[id=\"' + id + '\"]').each(function (underlinePath) {\n              set$8(underlinePath, 'fill', value);\n            });\n          },\n          setIconStroke: function (id, value) {\n            descendant(comp.element, 'svg path[id=\"' + id + '\"], rect[id=\"' + id + '\"]').each(function (underlinePath) {\n              set$8(underlinePath, 'stroke', value);\n            });\n          },\n          setActive: function (state) {\n            set$8(comp.element, 'aria-pressed', state);\n            descendant(comp.element, 'span').each(function (button) {\n              comp.getSystem().getByDom(button).each(function (buttonComp) {\n                return Toggling.set(buttonComp, state);\n              });\n            });\n          },\n          isActive: function () {\n            return descendant(comp.element, 'span').exists(function (button) {\n              return comp.getSystem().getByDom(button).exists(Toggling.isOn);\n            });\n          }\n        };\n      };\n      var editorOffCell = Cell(noop);\n      var specialisation = {\n        getApi: getApi,\n        onSetup: spec.onSetup\n      };\n      return SplitDropdown.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-split-button'],\n          attributes: __assign({ 'aria-pressed': false }, getTooltipAttributes(spec.tooltip, sharedBackstage.providers))\n        },\n        onExecute: function (button) {\n          spec.onAction(getApi(button));\n        },\n        onItemExecute: function (_a, _b, _c) {\n        },\n        splitDropdownBehaviours: derive$1([\n          DisablingConfigs.splitButton(sharedBackstage.providers.isDisabled),\n          receivingConfig(),\n          config('split-dropdown-events', [\n            run$1(focusButtonEvent, Focusing.focus),\n            onControlAttached(specialisation, editorOffCell),\n            onControlDetached(specialisation, editorOffCell)\n          ]),\n          Unselecting.config({})\n        ]),\n        eventOrder: (_d = {}, _d[attachedToDom()] = [\n          'alloy.base.behaviour',\n          'split-dropdown-events'\n        ], _d),\n        toggleClass: 'tox-tbtn--enabled',\n        lazySink: sharedBackstage.getSink,\n        fetch: fetchChoices(getApi, spec, sharedBackstage.providers),\n        parts: { menu: part(false, spec.columns, spec.presets) },\n        components: [\n          SplitDropdown.parts.button(renderCommonStructure(spec.icon, spec.text, Optional.none(), Optional.some(displayChannel), Optional.some([Toggling.config({\n              toggleClass: 'tox-tbtn--enabled',\n              toggleOnExecute: false\n            })]), sharedBackstage.providers)),\n          SplitDropdown.parts.arrow({\n            dom: {\n              tag: 'button',\n              classes: [\n                'tox-tbtn',\n                'tox-split-button__chevron'\n              ],\n              innerHtml: get$1('chevron-down', sharedBackstage.providers.icons)\n            },\n            buttonBehaviours: derive$1([\n              DisablingConfigs.splitButton(sharedBackstage.providers.isDisabled),\n              receivingConfig(),\n              addFocusableBehaviour()\n            ])\n          }),\n          SplitDropdown.parts['aria-descriptor']({ text: sharedBackstage.providers.translate('To open the popup, press Shift+Enter') })\n        ]\n      });\n    };\n\n    var defaultToolbar = [\n      {\n        name: 'history',\n        items: [\n          'undo',\n          'redo'\n        ]\n      },\n      {\n        name: 'styles',\n        items: ['styleselect']\n      },\n      {\n        name: 'formatting',\n        items: [\n          'bold',\n          'italic'\n        ]\n      },\n      {\n        name: 'alignment',\n        items: [\n          'alignleft',\n          'aligncenter',\n          'alignright',\n          'alignjustify'\n        ]\n      },\n      {\n        name: 'indentation',\n        items: [\n          'outdent',\n          'indent'\n        ]\n      },\n      {\n        name: 'permanent pen',\n        items: ['permanentpen']\n      },\n      {\n        name: 'comments',\n        items: ['addcomment']\n      }\n    ];\n    var renderFromBridge = function (bridgeBuilder, render) {\n      return function (spec, extras, editor) {\n        var internal = bridgeBuilder(spec).mapError(function (errInfo) {\n          return formatError(errInfo);\n        }).getOrDie();\n        return render(internal, extras, editor);\n      };\n    };\n    var types = {\n      button: renderFromBridge(createToolbarButton, function (s, extras) {\n        return renderToolbarButton(s, extras.backstage.shared.providers);\n      }),\n      togglebutton: renderFromBridge(createToggleButton, function (s, extras) {\n        return renderToolbarToggleButton(s, extras.backstage.shared.providers);\n      }),\n      menubutton: renderFromBridge(createMenuButton, function (s, extras) {\n        return renderMenuButton(s, 'tox-tbtn', extras.backstage, Optional.none());\n      }),\n      splitbutton: renderFromBridge(createSplitButton, function (s, extras) {\n        return renderSplitButton(s, extras.backstage.shared);\n      }),\n      grouptoolbarbutton: renderFromBridge(createGroupToolbarButton, function (s, extras, editor) {\n        var _a;\n        var buttons = editor.ui.registry.getAll().buttons;\n        var identify = function (toolbar) {\n          return identifyButtons(editor, {\n            buttons: buttons,\n            toolbar: toolbar,\n            allowToolbarGroups: false\n          }, extras, Optional.none());\n        };\n        var attributes = (_a = {}, _a[Attribute] = extras.backstage.shared.header.isPositionedAtTop() ? AttributeValue.TopToBottom : AttributeValue.BottomToTop, _a);\n        switch (getToolbarMode(editor)) {\n        case ToolbarMode.floating:\n          return renderFloatingToolbarButton(s, extras.backstage, identify, attributes);\n        default:\n          throw new Error('Toolbar groups are only supported when using floating toolbar mode');\n        }\n      }),\n      styleSelectButton: function (editor, extras) {\n        return createStyleSelect(editor, extras.backstage);\n      },\n      fontsizeSelectButton: function (editor, extras) {\n        return createFontsizeSelect(editor, extras.backstage);\n      },\n      fontSelectButton: function (editor, extras) {\n        return createFontSelect(editor, extras.backstage);\n      },\n      formatButton: function (editor, extras) {\n        return createFormatSelect(editor, extras.backstage);\n      },\n      alignMenuButton: function (editor, extras) {\n        return createAlignSelect(editor, extras.backstage);\n      }\n    };\n    var extractFrom = function (spec, extras, editor) {\n      return get$e(types, spec.type).fold(function () {\n        console.error('skipping button defined by', spec);\n        return Optional.none();\n      }, function (render) {\n        return Optional.some(render(spec, extras, editor));\n      });\n    };\n    var bespokeButtons = {\n      styleselect: types.styleSelectButton,\n      fontsizeselect: types.fontsizeSelectButton,\n      fontselect: types.fontSelectButton,\n      formatselect: types.formatButton,\n      align: types.alignMenuButton\n    };\n    var removeUnusedDefaults = function (buttons) {\n      var filteredItemGroups = map$2(defaultToolbar, function (group) {\n        var items = filter$2(group.items, function (subItem) {\n          return has$2(buttons, subItem) || has$2(bespokeButtons, subItem);\n        });\n        return {\n          name: group.name,\n          items: items\n        };\n      });\n      return filter$2(filteredItemGroups, function (group) {\n        return group.items.length > 0;\n      });\n    };\n    var convertStringToolbar = function (strToolbar) {\n      var groupsStrings = strToolbar.split('|');\n      return map$2(groupsStrings, function (g) {\n        return { items: g.trim().split(' ') };\n      });\n    };\n    var isToolbarGroupSettingArray = function (toolbar) {\n      return isArrayOf(toolbar, function (t) {\n        return has$2(t, 'name') && has$2(t, 'items');\n      });\n    };\n    var createToolbar = function (toolbarConfig) {\n      var toolbar = toolbarConfig.toolbar;\n      var buttons = toolbarConfig.buttons;\n      if (toolbar === false) {\n        return [];\n      } else if (toolbar === undefined || toolbar === true) {\n        return removeUnusedDefaults(buttons);\n      } else if (isString(toolbar)) {\n        return convertStringToolbar(toolbar);\n      } else if (isToolbarGroupSettingArray(toolbar)) {\n        return toolbar;\n      } else {\n        console.error('Toolbar type should be string, string[], boolean or ToolbarGroup[]');\n        return [];\n      }\n    };\n    var lookupButton = function (editor, buttons, toolbarItem, allowToolbarGroups, extras, prefixes) {\n      return get$e(buttons, toolbarItem.toLowerCase()).orThunk(function () {\n        return prefixes.bind(function (ps) {\n          return findMap(ps, function (prefix) {\n            return get$e(buttons, prefix + toolbarItem.toLowerCase());\n          });\n        });\n      }).fold(function () {\n        return get$e(bespokeButtons, toolbarItem.toLowerCase()).map(function (r) {\n          return r(editor, extras);\n        }).orThunk(function () {\n          return Optional.none();\n        });\n      }, function (spec) {\n        if (spec.type === 'grouptoolbarbutton' && !allowToolbarGroups) {\n          console.warn('Ignoring the \\'' + toolbarItem + '\\' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.');\n          return Optional.none();\n        } else {\n          return extractFrom(spec, extras, editor);\n        }\n      });\n    };\n    var identifyButtons = function (editor, toolbarConfig, extras, prefixes) {\n      var toolbarGroups = createToolbar(toolbarConfig);\n      var groups = map$2(toolbarGroups, function (group) {\n        var items = bind$3(group.items, function (toolbarItem) {\n          return toolbarItem.trim().length === 0 ? [] : lookupButton(editor, toolbarConfig.buttons, toolbarItem, toolbarConfig.allowToolbarGroups, extras, prefixes).toArray();\n        });\n        return {\n          title: Optional.from(editor.translate(group.name)),\n          items: items\n        };\n      });\n      return filter$2(groups, function (group) {\n        return group.items.length > 0;\n      });\n    };\n\n    var setToolbar = function (editor, uiComponents, rawUiConfig, backstage) {\n      var comp = uiComponents.outerContainer;\n      var toolbarConfig = rawUiConfig.toolbar;\n      var toolbarButtonsConfig = rawUiConfig.buttons;\n      if (isArrayOf(toolbarConfig, isString)) {\n        var toolbars = toolbarConfig.map(function (t) {\n          var config = {\n            toolbar: t,\n            buttons: toolbarButtonsConfig,\n            allowToolbarGroups: rawUiConfig.allowToolbarGroups\n          };\n          return identifyButtons(editor, config, { backstage: backstage }, Optional.none());\n        });\n        OuterContainer.setToolbars(comp, toolbars);\n      } else {\n        OuterContainer.setToolbar(comp, identifyButtons(editor, rawUiConfig, { backstage: backstage }, Optional.none()));\n      }\n    };\n\n    var detection = detect$1();\n    var isiOS12 = detection.os.isiOS() && detection.os.version.major <= 12;\n    var setupEvents$1 = function (editor, uiComponents) {\n      var dom = editor.dom;\n      var contentWindow = editor.getWin();\n      var initialDocEle = editor.getDoc().documentElement;\n      var lastWindowDimensions = Cell(SugarPosition(contentWindow.innerWidth, contentWindow.innerHeight));\n      var lastDocumentDimensions = Cell(SugarPosition(initialDocEle.offsetWidth, initialDocEle.offsetHeight));\n      var resizeWindow = function () {\n        var outer = lastWindowDimensions.get();\n        if (outer.left !== contentWindow.innerWidth || outer.top !== contentWindow.innerHeight) {\n          lastWindowDimensions.set(SugarPosition(contentWindow.innerWidth, contentWindow.innerHeight));\n          fireResizeContent(editor);\n        }\n      };\n      var resizeDocument = function () {\n        var docEle = editor.getDoc().documentElement;\n        var inner = lastDocumentDimensions.get();\n        if (inner.left !== docEle.offsetWidth || inner.top !== docEle.offsetHeight) {\n          lastDocumentDimensions.set(SugarPosition(docEle.offsetWidth, docEle.offsetHeight));\n          fireResizeContent(editor);\n        }\n      };\n      var scroll = function (e) {\n        return fireScrollContent(editor, e);\n      };\n      dom.bind(contentWindow, 'resize', resizeWindow);\n      dom.bind(contentWindow, 'scroll', scroll);\n      var elementLoad = capture(SugarElement.fromDom(editor.getBody()), 'load', resizeDocument);\n      var mothership = uiComponents.uiMothership.element;\n      editor.on('hide', function () {\n        set$7(mothership, 'display', 'none');\n      });\n      editor.on('show', function () {\n        remove$6(mothership, 'display');\n      });\n      editor.on('NodeChange', resizeDocument);\n      editor.on('remove', function () {\n        elementLoad.unbind();\n        dom.unbind(contentWindow, 'resize', resizeWindow);\n        dom.unbind(contentWindow, 'scroll', scroll);\n        contentWindow = null;\n      });\n    };\n    var render$1 = function (editor, uiComponents, rawUiConfig, backstage, args) {\n      var lastToolbarWidth = Cell(0);\n      var outerContainer = uiComponents.outerContainer;\n      iframe(editor);\n      var eTargetNode = SugarElement.fromDom(args.targetNode);\n      var uiRoot = getContentContainer(getRootNode(eTargetNode));\n      attachSystemAfter(eTargetNode, uiComponents.mothership);\n      attachSystem(uiRoot, uiComponents.uiMothership);\n      editor.on('PostRender', function () {\n        setToolbar(editor, uiComponents, rawUiConfig, backstage);\n        lastToolbarWidth.set(editor.getWin().innerWidth);\n        OuterContainer.setMenubar(outerContainer, identifyMenus(editor, rawUiConfig));\n        OuterContainer.setSidebar(outerContainer, rawUiConfig.sidebar);\n        setupEvents$1(editor, uiComponents);\n      });\n      var socket = OuterContainer.getSocket(outerContainer).getOrDie('Could not find expected socket element');\n      if (isiOS12) {\n        setAll(socket.element, {\n          'overflow': 'scroll',\n          '-webkit-overflow-scrolling': 'touch'\n        });\n        var limit = first(function () {\n          editor.fire('ScrollContent');\n        }, 20);\n        var unbinder = bind(socket.element, 'scroll', limit.throttle);\n        editor.on('remove', unbinder.unbind);\n      }\n      setupReadonlyModeSwitch(editor, uiComponents);\n      editor.addCommand('ToggleSidebar', function (_ui, value) {\n        OuterContainer.toggleSidebar(outerContainer, value);\n        editor.fire('ToggleSidebar');\n      });\n      editor.addQueryValueHandler('ToggleSidebar', function () {\n        return OuterContainer.whichSidebar(outerContainer);\n      });\n      var toolbarMode = getToolbarMode(editor);\n      var refreshDrawer = function () {\n        OuterContainer.refreshToolbar(uiComponents.outerContainer);\n      };\n      if (toolbarMode === ToolbarMode.sliding || toolbarMode === ToolbarMode.floating) {\n        editor.on('ResizeWindow ResizeEditor ResizeContent', function () {\n          var width = editor.getWin().innerWidth;\n          if (width !== lastToolbarWidth.get()) {\n            refreshDrawer();\n            lastToolbarWidth.set(width);\n          }\n        });\n      }\n      var api = {\n        enable: function () {\n          broadcastReadonly(uiComponents, false);\n        },\n        disable: function () {\n          broadcastReadonly(uiComponents, true);\n        },\n        isDisabled: function () {\n          return Disabling.isDisabled(outerContainer);\n        }\n      };\n      return {\n        iframeContainer: socket.element.dom,\n        editorContainer: outerContainer.element.dom,\n        api: api\n      };\n    };\n\n    var Iframe = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        render: render$1\n    });\n\n    var parseToInt = function (val) {\n      var re = /^[0-9\\.]+(|px)$/i;\n      if (re.test('' + val)) {\n        return Optional.some(parseInt('' + val, 10));\n      }\n      return Optional.none();\n    };\n    var numToPx = function (val) {\n      return isNumber(val) ? val + 'px' : val;\n    };\n    var calcCappedSize = function (size, minSize, maxSize) {\n      var minOverride = minSize.filter(function (min) {\n        return size < min;\n      });\n      var maxOverride = maxSize.filter(function (max) {\n        return size > max;\n      });\n      return minOverride.or(maxOverride).getOr(size);\n    };\n\n    var getHeight = function (editor) {\n      var baseHeight = getHeightSetting(editor);\n      var minHeight = getMinHeightSetting(editor);\n      var maxHeight = getMaxHeightSetting(editor);\n      return parseToInt(baseHeight).map(function (height) {\n        return calcCappedSize(height, minHeight, maxHeight);\n      });\n    };\n    var getHeightWithFallback = function (editor) {\n      var height = getHeight(editor);\n      return height.getOr(getHeightSetting(editor));\n    };\n    var getWidth = function (editor) {\n      var baseWidth = getWidthSetting(editor);\n      var minWidth = getMinWidthSetting(editor);\n      var maxWidth = getMaxWidthSetting(editor);\n      return parseToInt(baseWidth).map(function (width) {\n        return calcCappedSize(width, minWidth, maxWidth);\n      });\n    };\n    var getWidthWithFallback = function (editor) {\n      var width = getWidth(editor);\n      return width.getOr(getWidthSetting(editor));\n    };\n\n    var InlineHeader = function (editor, targetElm, uiComponents, backstage, floatContainer) {\n      var uiMothership = uiComponents.uiMothership, outerContainer = uiComponents.outerContainer;\n      var DOM = global$b.DOM;\n      var useFixedToolbarContainer = useFixedContainer(editor);\n      var isSticky = isStickyToolbar(editor);\n      var editorMaxWidthOpt = getMaxWidthSetting(editor).or(getWidth(editor));\n      var headerBackstage = backstage.shared.header;\n      var isPositionedAtTop = headerBackstage.isPositionedAtTop;\n      var toolbarMode = getToolbarMode(editor);\n      var isSplitToolbar = toolbarMode === ToolbarMode.sliding || toolbarMode === ToolbarMode.floating;\n      var visible = Cell(false);\n      var isVisible = function () {\n        return visible.get() && !editor.removed;\n      };\n      var calcToolbarOffset = function (toolbar) {\n        return isSplitToolbar ? toolbar.fold(constant$1(0), function (tbar) {\n          return tbar.components().length > 1 ? get$b(tbar.components()[1].element) : 0;\n        }) : 0;\n      };\n      var calcMode = function (container) {\n        switch (getToolbarLocation(editor)) {\n        case ToolbarLocation.auto:\n          var toolbar_1 = OuterContainer.getToolbar(outerContainer);\n          var offset = calcToolbarOffset(toolbar_1);\n          var toolbarHeight = get$b(container.element) - offset;\n          var targetBounds = box$1(targetElm);\n          var roomAtTop = targetBounds.y > toolbarHeight;\n          if (roomAtTop) {\n            return 'top';\n          } else {\n            var doc = documentElement(targetElm);\n            var docHeight = Math.max(doc.dom.scrollHeight, get$b(doc));\n            var roomAtBottom = targetBounds.bottom < docHeight - toolbarHeight;\n            if (roomAtBottom) {\n              return 'bottom';\n            } else {\n              var winBounds = win();\n              var isRoomAtBottomViewport = winBounds.bottom < targetBounds.bottom - toolbarHeight;\n              return isRoomAtBottomViewport ? 'bottom' : 'top';\n            }\n          }\n        case ToolbarLocation.bottom:\n          return 'bottom';\n        case ToolbarLocation.top:\n        default:\n          return 'top';\n        }\n      };\n      var setupMode = function (mode) {\n        var container = floatContainer.get();\n        Docking.setModes(container, [mode]);\n        headerBackstage.setDockingMode(mode);\n        var verticalDir = isPositionedAtTop() ? AttributeValue.TopToBottom : AttributeValue.BottomToTop;\n        set$8(container.element, Attribute, verticalDir);\n      };\n      var updateChromeWidth = function () {\n        var maxWidth = editorMaxWidthOpt.getOrThunk(function () {\n          var bodyMargin = parseToInt(get$c(body(), 'margin-left')).getOr(0);\n          return get$a(body()) - absolute$3(targetElm).left + bodyMargin;\n        });\n        set$7(floatContainer.get().element, 'max-width', maxWidth + 'px');\n      };\n      var updateChromePosition = function () {\n        var toolbar = OuterContainer.getToolbar(outerContainer);\n        var offset = calcToolbarOffset(toolbar);\n        var targetBounds = box$1(targetElm);\n        var top = isPositionedAtTop() ? Math.max(targetBounds.y - get$b(floatContainer.get().element) + offset, 0) : targetBounds.bottom;\n        setAll(outerContainer.element, {\n          position: 'absolute',\n          top: Math.round(top) + 'px',\n          left: Math.round(targetBounds.x) + 'px'\n        });\n      };\n      var repositionPopups$1 = function () {\n        uiMothership.broadcastOn([repositionPopups()], {});\n      };\n      var updateChromeUi = function (resetDocking) {\n        if (resetDocking === void 0) {\n          resetDocking = false;\n        }\n        if (!isVisible()) {\n          return;\n        }\n        if (!useFixedToolbarContainer) {\n          updateChromeWidth();\n        }\n        if (isSplitToolbar) {\n          OuterContainer.refreshToolbar(outerContainer);\n        }\n        if (!useFixedToolbarContainer) {\n          updateChromePosition();\n        }\n        if (isSticky) {\n          var floatContainerComp = floatContainer.get();\n          resetDocking ? Docking.reset(floatContainerComp) : Docking.refresh(floatContainerComp);\n        }\n        repositionPopups$1();\n      };\n      var updateMode = function (updateUi) {\n        if (updateUi === void 0) {\n          updateUi = true;\n        }\n        if (useFixedToolbarContainer || !isSticky || !isVisible()) {\n          return;\n        }\n        var currentMode = headerBackstage.getDockingMode();\n        var newMode = calcMode(floatContainer.get());\n        if (newMode !== currentMode) {\n          setupMode(newMode);\n          if (updateUi) {\n            updateChromeUi(true);\n          }\n        }\n      };\n      var show = function () {\n        visible.set(true);\n        set$7(outerContainer.element, 'display', 'flex');\n        DOM.addClass(editor.getBody(), 'mce-edit-focus');\n        remove$6(uiMothership.element, 'display');\n        updateMode(false);\n        updateChromeUi();\n      };\n      var hide = function () {\n        visible.set(false);\n        if (uiComponents.outerContainer) {\n          set$7(outerContainer.element, 'display', 'none');\n          DOM.removeClass(editor.getBody(), 'mce-edit-focus');\n        }\n        set$7(uiMothership.element, 'display', 'none');\n      };\n      return {\n        isVisible: isVisible,\n        isPositionedAtTop: isPositionedAtTop,\n        show: show,\n        hide: hide,\n        update: updateChromeUi,\n        updateMode: updateMode,\n        repositionPopups: repositionPopups$1\n      };\n    };\n\n    var getTargetPosAndBounds = function (targetElm, isToolbarTop) {\n      var bounds = box$1(targetElm);\n      return {\n        pos: isToolbarTop ? bounds.y : bounds.bottom,\n        bounds: bounds\n      };\n    };\n    var setupEvents = function (editor, targetElm, ui, toolbarPersist) {\n      var prevPosAndBounds = Cell(getTargetPosAndBounds(targetElm, ui.isPositionedAtTop()));\n      var resizeContent = function (e) {\n        var _a = getTargetPosAndBounds(targetElm, ui.isPositionedAtTop()), pos = _a.pos, bounds = _a.bounds;\n        var _b = prevPosAndBounds.get(), prevPos = _b.pos, prevBounds = _b.bounds;\n        var hasResized = bounds.height !== prevBounds.height || bounds.width !== prevBounds.width;\n        prevPosAndBounds.set({\n          pos: pos,\n          bounds: bounds\n        });\n        if (hasResized) {\n          fireResizeContent(editor, e);\n        }\n        if (ui.isVisible()) {\n          if (prevPos !== pos) {\n            ui.update(true);\n          } else if (hasResized) {\n            ui.updateMode();\n            ui.repositionPopups();\n          }\n        }\n      };\n      if (!toolbarPersist) {\n        editor.on('activate', ui.show);\n        editor.on('deactivate', ui.hide);\n      }\n      editor.on('SkinLoaded ResizeWindow', function () {\n        return ui.update(true);\n      });\n      editor.on('NodeChange keydown', function (e) {\n        global$f.requestAnimationFrame(function () {\n          return resizeContent(e);\n        });\n      });\n      editor.on('ScrollWindow', function () {\n        return ui.updateMode();\n      });\n      var elementLoad = unbindable();\n      elementLoad.set(capture(SugarElement.fromDom(editor.getBody()), 'load', resizeContent));\n      editor.on('remove', function () {\n        elementLoad.clear();\n      });\n    };\n    var render = function (editor, uiComponents, rawUiConfig, backstage, args) {\n      var mothership = uiComponents.mothership, uiMothership = uiComponents.uiMothership, outerContainer = uiComponents.outerContainer;\n      var floatContainer = Cell(null);\n      var targetElm = SugarElement.fromDom(args.targetNode);\n      var ui = InlineHeader(editor, targetElm, uiComponents, backstage, floatContainer);\n      var toolbarPersist = isToolbarPersist(editor);\n      inline(editor);\n      var render = function () {\n        if (floatContainer.get()) {\n          ui.show();\n          return;\n        }\n        floatContainer.set(OuterContainer.getHeader(outerContainer).getOrDie());\n        var uiContainer = getUiContainer(editor);\n        attachSystem(uiContainer, mothership);\n        attachSystem(uiContainer, uiMothership);\n        setToolbar(editor, uiComponents, rawUiConfig, backstage);\n        OuterContainer.setMenubar(outerContainer, identifyMenus(editor, rawUiConfig));\n        ui.show();\n        setupEvents(editor, targetElm, ui, toolbarPersist);\n        editor.nodeChanged();\n      };\n      var delayedRender = function () {\n        return global$f.setEditorTimeout(editor, render, 0);\n      };\n      editor.on('show', render);\n      editor.on('hide', ui.hide);\n      if (!toolbarPersist) {\n        editor.on('focus', delayedRender);\n        editor.on('blur', ui.hide);\n      }\n      editor.on('init', function () {\n        if (editor.hasFocus() || toolbarPersist) {\n          delayedRender();\n        }\n      });\n      setupReadonlyModeSwitch(editor, uiComponents);\n      var api = {\n        show: function () {\n          ui.show();\n        },\n        hide: function () {\n          ui.hide();\n        },\n        enable: function () {\n          broadcastReadonly(uiComponents, false);\n        },\n        disable: function () {\n          broadcastReadonly(uiComponents, true);\n        },\n        isDisabled: function () {\n          return Disabling.isDisabled(outerContainer);\n        }\n      };\n      return {\n        editorContainer: outerContainer.element.dom,\n        api: api\n      };\n    };\n\n    var Inline = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        render: render\n    });\n\n    var showContextToolbarEvent = 'contexttoolbar-show';\n    var hideContextToolbarEvent = 'contexttoolbar-hide';\n\n    var getFormApi = function (input) {\n      return {\n        hide: function () {\n          return emit(input, sandboxClose());\n        },\n        getValue: function () {\n          return Representing.getValue(input);\n        }\n      };\n    };\n    var runOnExecute = function (memInput, original) {\n      return run$1(internalToolbarButtonExecute, function (comp, se) {\n        var input = memInput.get(comp);\n        var formApi = getFormApi(input);\n        original.onAction(formApi, se.event.buttonApi);\n      });\n    };\n    var renderContextButton = function (memInput, button, extras) {\n      var _a = button.original; _a.primary; var rest = __rest(_a, ['primary']);\n      var bridged = getOrDie(createToolbarButton(__assign(__assign({}, rest), {\n        type: 'button',\n        onAction: noop\n      })));\n      return renderToolbarButtonWith(bridged, extras.backstage.shared.providers, [runOnExecute(memInput, button)]);\n    };\n    var renderContextToggleButton = function (memInput, button, extras) {\n      var _a = button.original; _a.primary; var rest = __rest(_a, ['primary']);\n      var bridged = getOrDie(createToggleButton(__assign(__assign({}, rest), {\n        type: 'togglebutton',\n        onAction: noop\n      })));\n      return renderToolbarToggleButtonWith(bridged, extras.backstage.shared.providers, [runOnExecute(memInput, button)]);\n    };\n    var generateOne = function (memInput, button, providersBackstage) {\n      var extras = { backstage: { shared: { providers: providersBackstage } } };\n      if (button.type === 'contextformtogglebutton') {\n        return renderContextToggleButton(memInput, button, extras);\n      } else {\n        return renderContextButton(memInput, button, extras);\n      }\n    };\n    var generate = function (memInput, buttons, providersBackstage) {\n      var mementos = map$2(buttons, function (button) {\n        return record(generateOne(memInput, button, providersBackstage));\n      });\n      var asSpecs = function () {\n        return map$2(mementos, function (mem) {\n          return mem.asSpec();\n        });\n      };\n      var findPrimary = function (compInSystem) {\n        return findMap(buttons, function (button, i) {\n          if (button.primary) {\n            return Optional.from(mementos[i]).bind(function (mem) {\n              return mem.getOpt(compInSystem);\n            }).filter(not(Disabling.isDisabled));\n          } else {\n            return Optional.none();\n          }\n        });\n      };\n      return {\n        asSpecs: asSpecs,\n        findPrimary: findPrimary\n      };\n    };\n\n    var buildInitGroups = function (ctx, providers) {\n      var inputAttributes = ctx.label.fold(function () {\n        return {};\n      }, function (label) {\n        return { 'aria-label': label };\n      });\n      var memInput = record(Input.sketch({\n        inputClasses: [\n          'tox-toolbar-textfield',\n          'tox-toolbar-nav-js'\n        ],\n        data: ctx.initValue(),\n        inputAttributes: inputAttributes,\n        selectOnFocus: true,\n        inputBehaviours: derive$1([Keying.config({\n            mode: 'special',\n            onEnter: function (input) {\n              return commands.findPrimary(input).map(function (primary) {\n                emitExecute(primary);\n                return true;\n              });\n            },\n            onLeft: function (comp, se) {\n              se.cut();\n              return Optional.none();\n            },\n            onRight: function (comp, se) {\n              se.cut();\n              return Optional.none();\n            }\n          })])\n      }));\n      var commands = generate(memInput, ctx.commands, providers);\n      return [\n        {\n          title: Optional.none(),\n          items: [memInput.asSpec()]\n        },\n        {\n          title: Optional.none(),\n          items: commands.asSpecs()\n        }\n      ];\n    };\n    var renderContextForm = function (toolbarType, ctx, providers) {\n      return renderToolbar({\n        type: toolbarType,\n        uid: generate$6('context-toolbar'),\n        initGroups: buildInitGroups(ctx, providers),\n        onEscape: Optional.none,\n        cyclicKeying: true,\n        providers: providers\n      });\n    };\n    var ContextForm = {\n      renderContextForm: renderContextForm,\n      buildInitGroups: buildInitGroups\n    };\n\n    var isVerticalOverlap = function (a, b, threshold) {\n      if (threshold === void 0) {\n        threshold = 0.01;\n      }\n      return b.bottom - a.y >= threshold && a.bottom - b.y >= threshold;\n    };\n    var getRangeRect = function (rng) {\n      var rect = rng.getBoundingClientRect();\n      if (rect.height <= 0 && rect.width <= 0) {\n        var leaf$1 = leaf(SugarElement.fromDom(rng.startContainer), rng.startOffset).element;\n        var elm = isText$1(leaf$1) ? parent(leaf$1) : Optional.some(leaf$1);\n        return elm.filter(isElement$2).map(function (e) {\n          return e.dom.getBoundingClientRect();\n        }).getOr(rect);\n      } else {\n        return rect;\n      }\n    };\n    var getSelectionBounds = function (editor) {\n      var rng = editor.selection.getRng();\n      var rect = getRangeRect(rng);\n      if (editor.inline) {\n        var scroll_1 = get$9();\n        return bounds(scroll_1.left + rect.left, scroll_1.top + rect.top, rect.width, rect.height);\n      } else {\n        var bodyPos = absolute$2(SugarElement.fromDom(editor.getBody()));\n        return bounds(bodyPos.x + rect.left, bodyPos.y + rect.top, rect.width, rect.height);\n      }\n    };\n    var getAnchorElementBounds = function (editor, lastElement) {\n      return lastElement.filter(inBody).map(absolute$2).getOrThunk(function () {\n        return getSelectionBounds(editor);\n      });\n    };\n    var getHorizontalBounds = function (contentAreaBox, viewportBounds, margin) {\n      var x = Math.max(contentAreaBox.x + margin, viewportBounds.x);\n      var right = Math.min(contentAreaBox.right - margin, viewportBounds.right);\n      return {\n        x: x,\n        width: right - x\n      };\n    };\n    var getVerticalBounds = function (editor, contentAreaBox, viewportBounds, isToolbarLocationTop, toolbarType, margin) {\n      var container = SugarElement.fromDom(editor.getContainer());\n      var header = descendant(container, '.tox-editor-header').getOr(container);\n      var headerBox = box$1(header);\n      var isToolbarBelowContentArea = headerBox.y >= contentAreaBox.bottom;\n      var isToolbarAbove = isToolbarLocationTop && !isToolbarBelowContentArea;\n      if (editor.inline && isToolbarAbove) {\n        return {\n          y: Math.max(headerBox.bottom + margin, viewportBounds.y),\n          bottom: viewportBounds.bottom\n        };\n      }\n      if (editor.inline && !isToolbarAbove) {\n        return {\n          y: viewportBounds.y,\n          bottom: Math.min(headerBox.y - margin, viewportBounds.bottom)\n        };\n      }\n      var containerBounds = toolbarType === 'line' ? box$1(container) : contentAreaBox;\n      if (isToolbarAbove) {\n        return {\n          y: Math.max(headerBox.bottom + margin, viewportBounds.y),\n          bottom: Math.min(containerBounds.bottom - margin, viewportBounds.bottom)\n        };\n      }\n      return {\n        y: Math.max(containerBounds.y + margin, viewportBounds.y),\n        bottom: Math.min(headerBox.y - margin, viewportBounds.bottom)\n      };\n    };\n    var getContextToolbarBounds = function (editor, sharedBackstage, toolbarType, margin) {\n      if (margin === void 0) {\n        margin = 0;\n      }\n      var viewportBounds = getBounds$3(window);\n      var contentAreaBox = box$1(SugarElement.fromDom(editor.getContentAreaContainer()));\n      var toolbarOrMenubarEnabled = isMenubarEnabled(editor) || isToolbarEnabled(editor) || isMultipleToolbars(editor);\n      var _a = getHorizontalBounds(contentAreaBox, viewportBounds, margin), x = _a.x, width = _a.width;\n      if (editor.inline && !toolbarOrMenubarEnabled) {\n        return bounds(x, viewportBounds.y, width, viewportBounds.height);\n      } else {\n        var isToolbarTop = sharedBackstage.header.isPositionedAtTop();\n        var _b = getVerticalBounds(editor, contentAreaBox, viewportBounds, isToolbarTop, toolbarType, margin), y = _b.y, bottom = _b.bottom;\n        return bounds(x, y, width, bottom - y);\n      }\n    };\n\n    var bubbleSize$1 = 12;\n    var bubbleAlignments$1 = {\n      valignCentre: [],\n      alignCentre: [],\n      alignLeft: ['tox-pop--align-left'],\n      alignRight: ['tox-pop--align-right'],\n      right: ['tox-pop--right'],\n      left: ['tox-pop--left'],\n      bottom: ['tox-pop--bottom'],\n      top: ['tox-pop--top'],\n      inset: ['tox-pop--inset']\n    };\n    var anchorOverrides = {\n      maxHeightFunction: expandable$1(),\n      maxWidthFunction: expandable()\n    };\n    var isEntireElementSelected = function (editor, elem) {\n      var rng = editor.selection.getRng();\n      var leaf$1 = leaf(SugarElement.fromDom(rng.startContainer), rng.startOffset);\n      return rng.startContainer === rng.endContainer && rng.startOffset === rng.endOffset - 1 && eq(leaf$1.element, elem);\n    };\n    var preservePosition = function (elem, position, f) {\n      var currentPosition = getRaw(elem, 'position');\n      set$7(elem, 'position', position);\n      var result = f(elem);\n      currentPosition.each(function (pos) {\n        return set$7(elem, 'position', pos);\n      });\n      return result;\n    };\n    var shouldUseInsetLayouts = function (position) {\n      return position === 'node';\n    };\n    var determineInsetLayout = function (editor, contextbar, elem, data, bounds) {\n      var selectionBounds = getSelectionBounds(editor);\n      var isSameAnchorElement = data.lastElement().exists(function (prev) {\n        return eq(elem, prev);\n      });\n      if (isEntireElementSelected(editor, elem)) {\n        return isSameAnchorElement ? preserve : north;\n      } else if (isSameAnchorElement) {\n        return preservePosition(contextbar, data.getMode(), function () {\n          var isOverlapping = isVerticalOverlap(selectionBounds, box$1(contextbar));\n          return isOverlapping && !data.isReposition() ? flip$2 : preserve;\n        });\n      } else {\n        var yBounds = data.getMode() === 'fixed' ? bounds.y + get$9().top : bounds.y;\n        var contextbarHeight = get$b(contextbar) + bubbleSize$1;\n        return yBounds + contextbarHeight <= selectionBounds.y ? north : south;\n      }\n    };\n    var getAnchorSpec$2 = function (editor, mobile, data, position) {\n      var smartInsetLayout = function (elem) {\n        return function (anchor, element, bubbles, placee, bounds) {\n          var layout = determineInsetLayout(editor, placee, elem, data, bounds);\n          var newAnchor = __assign(__assign({}, anchor), {\n            y: bounds.y,\n            height: bounds.height\n          });\n          return __assign(__assign({}, layout(newAnchor, element, bubbles, placee, bounds)), { alwaysFit: true });\n        };\n      };\n      var getInsetLayouts = function (elem) {\n        return shouldUseInsetLayouts(position) ? [smartInsetLayout(elem)] : [];\n      };\n      var desktopAnchorSpecLayouts = {\n        onLtr: function (elem) {\n          return [\n            north$2,\n            south$2,\n            northeast$2,\n            southeast$2,\n            northwest$2,\n            southwest$2\n          ].concat(getInsetLayouts(elem));\n        },\n        onRtl: function (elem) {\n          return [\n            north$2,\n            south$2,\n            northwest$2,\n            southwest$2,\n            northeast$2,\n            southeast$2\n          ].concat(getInsetLayouts(elem));\n        }\n      };\n      var mobileAnchorSpecLayouts = {\n        onLtr: function (elem) {\n          return [\n            south$2,\n            southeast$2,\n            southwest$2,\n            northeast$2,\n            northwest$2,\n            north$2\n          ].concat(getInsetLayouts(elem));\n        },\n        onRtl: function (elem) {\n          return [\n            south$2,\n            southwest$2,\n            southeast$2,\n            northwest$2,\n            northeast$2,\n            north$2\n          ].concat(getInsetLayouts(elem));\n        }\n      };\n      return mobile ? mobileAnchorSpecLayouts : desktopAnchorSpecLayouts;\n    };\n    var getAnchorLayout = function (editor, position, isTouch, data) {\n      if (position === 'line') {\n        return {\n          bubble: nu$5(bubbleSize$1, 0, bubbleAlignments$1),\n          layouts: {\n            onLtr: function () {\n              return [east$2];\n            },\n            onRtl: function () {\n              return [west$2];\n            }\n          },\n          overrides: anchorOverrides\n        };\n      } else {\n        return {\n          bubble: nu$5(0, bubbleSize$1, bubbleAlignments$1, 1 / bubbleSize$1),\n          layouts: getAnchorSpec$2(editor, isTouch, data, position),\n          overrides: anchorOverrides\n        };\n      }\n    };\n\n    var matchTargetWith = function (elem, candidates) {\n      var ctxs = filter$2(candidates, function (toolbarApi) {\n        return toolbarApi.predicate(elem.dom);\n      });\n      var _a = partition$3(ctxs, function (t) {\n          return t.type === 'contexttoolbar';\n        }), pass = _a.pass, fail = _a.fail;\n      return {\n        contextToolbars: pass,\n        contextForms: fail\n      };\n    };\n    var filterByPositionForStartNode = function (toolbars) {\n      if (toolbars.length <= 1) {\n        return toolbars;\n      } else {\n        var doesPositionExist = function (value) {\n          return exists(toolbars, function (t) {\n            return t.position === value;\n          });\n        };\n        var filterToolbarsByPosition = function (value) {\n          return filter$2(toolbars, function (t) {\n            return t.position === value;\n          });\n        };\n        var hasSelectionToolbars = doesPositionExist('selection');\n        var hasNodeToolbars = doesPositionExist('node');\n        if (hasSelectionToolbars || hasNodeToolbars) {\n          if (hasNodeToolbars && hasSelectionToolbars) {\n            var nodeToolbars = filterToolbarsByPosition('node');\n            var selectionToolbars = map$2(filterToolbarsByPosition('selection'), function (t) {\n              return __assign(__assign({}, t), { position: 'node' });\n            });\n            return nodeToolbars.concat(selectionToolbars);\n          } else {\n            return hasSelectionToolbars ? filterToolbarsByPosition('selection') : filterToolbarsByPosition('node');\n          }\n        } else {\n          return filterToolbarsByPosition('line');\n        }\n      }\n    };\n    var filterByPositionForAncestorNode = function (toolbars) {\n      if (toolbars.length <= 1) {\n        return toolbars;\n      } else {\n        var findPosition_1 = function (value) {\n          return find$5(toolbars, function (t) {\n            return t.position === value;\n          });\n        };\n        var basePosition = findPosition_1('selection').orThunk(function () {\n          return findPosition_1('node');\n        }).orThunk(function () {\n          return findPosition_1('line');\n        }).map(function (t) {\n          return t.position;\n        });\n        return basePosition.fold(function () {\n          return [];\n        }, function (pos) {\n          return filter$2(toolbars, function (t) {\n            return t.position === pos;\n          });\n        });\n      }\n    };\n    var matchStartNode = function (elem, nodeCandidates, editorCandidates) {\n      var nodeMatches = matchTargetWith(elem, nodeCandidates);\n      if (nodeMatches.contextForms.length > 0) {\n        return Optional.some({\n          elem: elem,\n          toolbars: [nodeMatches.contextForms[0]]\n        });\n      } else {\n        var editorMatches = matchTargetWith(elem, editorCandidates);\n        if (editorMatches.contextForms.length > 0) {\n          return Optional.some({\n            elem: elem,\n            toolbars: [editorMatches.contextForms[0]]\n          });\n        } else if (nodeMatches.contextToolbars.length > 0 || editorMatches.contextToolbars.length > 0) {\n          var toolbars = filterByPositionForStartNode(nodeMatches.contextToolbars.concat(editorMatches.contextToolbars));\n          return Optional.some({\n            elem: elem,\n            toolbars: toolbars\n          });\n        } else {\n          return Optional.none();\n        }\n      }\n    };\n    var matchAncestor = function (isRoot, startNode, scopes) {\n      if (isRoot(startNode)) {\n        return Optional.none();\n      } else {\n        return ancestor$2(startNode, function (ancestorElem) {\n          if (isElement$2(ancestorElem)) {\n            var _a = matchTargetWith(ancestorElem, scopes.inNodeScope), contextToolbars = _a.contextToolbars, contextForms = _a.contextForms;\n            var toolbars = contextForms.length > 0 ? contextForms : filterByPositionForAncestorNode(contextToolbars);\n            return toolbars.length > 0 ? Optional.some({\n              elem: ancestorElem,\n              toolbars: toolbars\n            }) : Optional.none();\n          } else {\n            return Optional.none();\n          }\n        }, isRoot);\n      }\n    };\n    var lookup$1 = function (scopes, editor) {\n      var rootElem = SugarElement.fromDom(editor.getBody());\n      var isRoot = function (elem) {\n        return eq(elem, rootElem);\n      };\n      var isOutsideRoot = function (startNode) {\n        return !isRoot(startNode) && !contains(rootElem, startNode);\n      };\n      var startNode = SugarElement.fromDom(editor.selection.getNode());\n      if (isOutsideRoot(startNode)) {\n        return Optional.none();\n      }\n      return matchStartNode(startNode, scopes.inNodeScope, scopes.inEditorScope).orThunk(function () {\n        return matchAncestor(isRoot, startNode, scopes);\n      });\n    };\n\n    var categorise = function (contextToolbars, navigate) {\n      var forms = {};\n      var inNodeScope = [];\n      var inEditorScope = [];\n      var formNavigators = {};\n      var lookupTable = {};\n      var registerForm = function (key, toolbarSpec) {\n        var contextForm = getOrDie(createContextForm(toolbarSpec));\n        forms[key] = contextForm;\n        contextForm.launch.map(function (launch) {\n          formNavigators['form:' + key + ''] = __assign(__assign({}, toolbarSpec.launch), {\n            type: launch.type === 'contextformtogglebutton' ? 'togglebutton' : 'button',\n            onAction: function () {\n              navigate(contextForm);\n            }\n          });\n        });\n        if (contextForm.scope === 'editor') {\n          inEditorScope.push(contextForm);\n        } else {\n          inNodeScope.push(contextForm);\n        }\n        lookupTable[key] = contextForm;\n      };\n      var registerToolbar = function (key, toolbarSpec) {\n        createContextToolbar(toolbarSpec).each(function (contextToolbar) {\n          if (toolbarSpec.scope === 'editor') {\n            inEditorScope.push(contextToolbar);\n          } else {\n            inNodeScope.push(contextToolbar);\n          }\n          lookupTable[key] = contextToolbar;\n        });\n      };\n      var keys$1 = keys(contextToolbars);\n      each$1(keys$1, function (key) {\n        var toolbarApi = contextToolbars[key];\n        if (toolbarApi.type === 'contextform') {\n          registerForm(key, toolbarApi);\n        } else if (toolbarApi.type === 'contexttoolbar') {\n          registerToolbar(key, toolbarApi);\n        }\n      });\n      return {\n        forms: forms,\n        inNodeScope: inNodeScope,\n        inEditorScope: inEditorScope,\n        lookupTable: lookupTable,\n        formNavigators: formNavigators\n      };\n    };\n\n    var forwardSlideEvent = generate$6('forward-slide');\n    var backSlideEvent = generate$6('backward-slide');\n    var changeSlideEvent = generate$6('change-slide-event');\n    var resizingClass = 'tox-pop--resizing';\n    var renderContextToolbar = function (spec) {\n      var stack = Cell([]);\n      return InlineView.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-pop']\n        },\n        fireDismissalEventInstead: { event: 'doNotDismissYet' },\n        onShow: function (comp) {\n          stack.set([]);\n          InlineView.getContent(comp).each(function (c) {\n            remove$6(c.element, 'visibility');\n          });\n          remove$2(comp.element, resizingClass);\n          remove$6(comp.element, 'width');\n        },\n        inlineBehaviours: derive$1([\n          config('context-toolbar-events', [\n            runOnSource(transitionend(), function (comp, se) {\n              if (se.event.raw.propertyName === 'width') {\n                remove$2(comp.element, resizingClass);\n                remove$6(comp.element, 'width');\n              }\n            }),\n            run$1(changeSlideEvent, function (comp, se) {\n              var elem = comp.element;\n              remove$6(elem, 'width');\n              var currentWidth = get$a(elem);\n              InlineView.setContent(comp, se.event.contents);\n              add$2(elem, resizingClass);\n              var newWidth = get$a(elem);\n              set$7(elem, 'width', currentWidth + 'px');\n              InlineView.getContent(comp).each(function (newContents) {\n                se.event.focus.bind(function (f) {\n                  focus$3(f);\n                  return search(elem);\n                }).orThunk(function () {\n                  Keying.focusIn(newContents);\n                  return active(getRootNode(elem));\n                });\n              });\n              global$f.setTimeout(function () {\n                set$7(comp.element, 'width', newWidth + 'px');\n              }, 0);\n            }),\n            run$1(forwardSlideEvent, function (comp, se) {\n              InlineView.getContent(comp).each(function (oldContents) {\n                stack.set(stack.get().concat([{\n                    bar: oldContents,\n                    focus: active(getRootNode(comp.element))\n                  }]));\n              });\n              emitWith(comp, changeSlideEvent, {\n                contents: se.event.forwardContents,\n                focus: Optional.none()\n              });\n            }),\n            run$1(backSlideEvent, function (comp, _se) {\n              last$2(stack.get()).each(function (last) {\n                stack.set(stack.get().slice(0, stack.get().length - 1));\n                emitWith(comp, changeSlideEvent, {\n                  contents: premade(last.bar),\n                  focus: last.focus\n                });\n              });\n            })\n          ]),\n          Keying.config({\n            mode: 'special',\n            onEscape: function (comp) {\n              return last$2(stack.get()).fold(function () {\n                return spec.onEscape();\n              }, function (_) {\n                emit(comp, backSlideEvent);\n                return Optional.some(true);\n              });\n            }\n          })\n        ]),\n        lazySink: function () {\n          return Result.value(spec.sink);\n        }\n      });\n    };\n\n    var transitionClass = 'tox-pop--transition';\n    var register$7 = function (editor, registryContextToolbars, sink, extras) {\n      var backstage = extras.backstage;\n      var sharedBackstage = backstage.shared;\n      var isTouch = detect$1().deviceType.isTouch;\n      var lastElement = value$1();\n      var lastTrigger = value$1();\n      var lastContextPosition = value$1();\n      var contextbar = build$1(renderContextToolbar({\n        sink: sink,\n        onEscape: function () {\n          editor.focus();\n          return Optional.some(true);\n        }\n      }));\n      var getBounds = function () {\n        var position = lastContextPosition.get().getOr('node');\n        var margin = shouldUseInsetLayouts(position) ? 1 : 0;\n        return getContextToolbarBounds(editor, sharedBackstage, position, margin);\n      };\n      var canLaunchToolbar = function () {\n        return !editor.removed && !(isTouch() && backstage.isContextMenuOpen());\n      };\n      var isSameLaunchElement = function (elem) {\n        return is$1(lift2(elem, lastElement.get(), eq), true);\n      };\n      var shouldContextToolbarHide = function () {\n        if (!canLaunchToolbar()) {\n          return true;\n        } else {\n          var contextToolbarBounds = getBounds();\n          var anchorBounds = is$1(lastContextPosition.get(), 'node') ? getAnchorElementBounds(editor, lastElement.get()) : getSelectionBounds(editor);\n          return contextToolbarBounds.height <= 0 || !isVerticalOverlap(anchorBounds, contextToolbarBounds);\n        }\n      };\n      var close = function () {\n        lastElement.clear();\n        lastTrigger.clear();\n        lastContextPosition.clear();\n        InlineView.hide(contextbar);\n      };\n      var hideOrRepositionIfNecessary = function () {\n        if (InlineView.isOpen(contextbar)) {\n          var contextBarEle = contextbar.element;\n          remove$6(contextBarEle, 'display');\n          if (shouldContextToolbarHide()) {\n            set$7(contextBarEle, 'display', 'none');\n          } else {\n            lastTrigger.set(0);\n            InlineView.reposition(contextbar);\n          }\n        }\n      };\n      var wrapInPopDialog = function (toolbarSpec) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-pop__dialog']\n          },\n          components: [toolbarSpec],\n          behaviours: derive$1([\n            Keying.config({ mode: 'acyclic' }),\n            config('pop-dialog-wrap-events', [\n              runOnAttached(function (comp) {\n                editor.shortcuts.add('ctrl+F9', 'focus statusbar', function () {\n                  return Keying.focusIn(comp);\n                });\n              }),\n              runOnDetached(function (_comp) {\n                editor.shortcuts.remove('ctrl+F9');\n              })\n            ])\n          ])\n        };\n      };\n      var getScopes = cached(function () {\n        return categorise(registryContextToolbars, function (toolbarApi) {\n          var alloySpec = buildToolbar([toolbarApi]);\n          emitWith(contextbar, forwardSlideEvent, { forwardContents: wrapInPopDialog(alloySpec) });\n        });\n      });\n      var buildContextToolbarGroups = function (allButtons, ctx) {\n        return identifyButtons(editor, {\n          buttons: allButtons,\n          toolbar: ctx.items,\n          allowToolbarGroups: false\n        }, extras, Optional.some(['form:']));\n      };\n      var buildContextFormGroups = function (ctx, providers) {\n        return ContextForm.buildInitGroups(ctx, providers);\n      };\n      var buildToolbar = function (toolbars) {\n        var buttons = editor.ui.registry.getAll().buttons;\n        var scopes = getScopes();\n        var allButtons = __assign(__assign({}, buttons), scopes.formNavigators);\n        var toolbarType = getToolbarMode(editor) === ToolbarMode.scrolling ? ToolbarMode.scrolling : ToolbarMode.default;\n        var initGroups = flatten(map$2(toolbars, function (ctx) {\n          return ctx.type === 'contexttoolbar' ? buildContextToolbarGroups(allButtons, ctx) : buildContextFormGroups(ctx, sharedBackstage.providers);\n        }));\n        return renderToolbar({\n          type: toolbarType,\n          uid: generate$6('context-toolbar'),\n          initGroups: initGroups,\n          onEscape: Optional.none,\n          cyclicKeying: true,\n          providers: sharedBackstage.providers\n        });\n      };\n      var getAnchor = function (position, element) {\n        var anchorage = position === 'node' ? sharedBackstage.anchors.node(element) : sharedBackstage.anchors.cursor();\n        var anchorLayout = getAnchorLayout(editor, position, isTouch(), {\n          lastElement: lastElement.get,\n          isReposition: function () {\n            return is$1(lastTrigger.get(), 0);\n          },\n          getMode: function () {\n            return Positioning.getMode(sink);\n          }\n        });\n        return deepMerge(anchorage, anchorLayout);\n      };\n      var launchContext = function (toolbarApi, elem) {\n        launchContextToolbar.cancel();\n        if (!canLaunchToolbar()) {\n          return;\n        }\n        var toolbarSpec = buildToolbar(toolbarApi);\n        var position = toolbarApi[0].position;\n        var anchor = getAnchor(position, elem);\n        lastContextPosition.set(position);\n        lastTrigger.set(1);\n        var contextBarEle = contextbar.element;\n        remove$6(contextBarEle, 'display');\n        if (!isSameLaunchElement(elem)) {\n          remove$2(contextBarEle, transitionClass);\n          Positioning.reset(sink, contextbar);\n        }\n        InlineView.showWithinBounds(contextbar, wrapInPopDialog(toolbarSpec), {\n          anchor: anchor,\n          transition: {\n            classes: [transitionClass],\n            mode: 'placement'\n          }\n        }, function () {\n          return Optional.some(getBounds());\n        });\n        elem.fold(lastElement.clear, lastElement.set);\n        if (shouldContextToolbarHide()) {\n          set$7(contextBarEle, 'display', 'none');\n        }\n      };\n      var launchContextToolbar = last(function () {\n        if (!editor.hasFocus() || editor.removed) {\n          return;\n        }\n        if (has(contextbar.element, transitionClass)) {\n          launchContextToolbar.throttle();\n        } else {\n          var scopes = getScopes();\n          lookup$1(scopes, editor).fold(close, function (info) {\n            launchContext(info.toolbars, Optional.some(info.elem));\n          });\n        }\n      }, 17);\n      editor.on('init', function () {\n        editor.on('remove', close);\n        editor.on('ScrollContent ScrollWindow ObjectResized ResizeEditor longpress', hideOrRepositionIfNecessary);\n        editor.on('click keyup focus SetContent', launchContextToolbar.throttle);\n        editor.on(hideContextToolbarEvent, close);\n        editor.on(showContextToolbarEvent, function (e) {\n          var scopes = getScopes();\n          get$e(scopes.lookupTable, e.toolbarKey).each(function (ctx) {\n            launchContext([ctx], someIf(e.target !== editor, e.target));\n            InlineView.getContent(contextbar).each(Keying.focusIn);\n          });\n        });\n        editor.on('focusout', function (_e) {\n          global$f.setEditorTimeout(editor, function () {\n            if (search(sink.element).isNone() && search(contextbar.element).isNone()) {\n              close();\n            }\n          }, 0);\n        });\n        editor.on('SwitchMode', function () {\n          if (editor.mode.isReadOnly()) {\n            close();\n          }\n        });\n        editor.on('AfterProgressState', function (event) {\n          if (event.state) {\n            close();\n          } else if (editor.hasFocus()) {\n            launchContextToolbar.throttle();\n          }\n        });\n        editor.on('NodeChange', function (_e) {\n          search(contextbar.element).fold(launchContextToolbar.throttle, noop);\n        });\n      });\n    };\n\n    var register$6 = function (editor) {\n      var alignToolbarButtons = [\n        {\n          name: 'alignleft',\n          text: 'Align left',\n          cmd: 'JustifyLeft',\n          icon: 'align-left'\n        },\n        {\n          name: 'aligncenter',\n          text: 'Align center',\n          cmd: 'JustifyCenter',\n          icon: 'align-center'\n        },\n        {\n          name: 'alignright',\n          text: 'Align right',\n          cmd: 'JustifyRight',\n          icon: 'align-right'\n        },\n        {\n          name: 'alignjustify',\n          text: 'Justify',\n          cmd: 'JustifyFull',\n          icon: 'align-justify'\n        }\n      ];\n      each$1(alignToolbarButtons, function (item) {\n        editor.ui.registry.addToggleButton(item.name, {\n          tooltip: item.text,\n          icon: item.icon,\n          onAction: onActionExecCommand(editor, item.cmd),\n          onSetup: onSetupFormatToggle(editor, item.name)\n        });\n      });\n      editor.ui.registry.addButton('alignnone', {\n        tooltip: 'No alignment',\n        icon: 'align-none',\n        onAction: onActionExecCommand(editor, 'JustifyNone')\n      });\n    };\n\n    var units = {\n      unsupportedLength: [\n        'em',\n        'ex',\n        'cap',\n        'ch',\n        'ic',\n        'rem',\n        'lh',\n        'rlh',\n        'vw',\n        'vh',\n        'vi',\n        'vb',\n        'vmin',\n        'vmax',\n        'cm',\n        'mm',\n        'Q',\n        'in',\n        'pc',\n        'pt',\n        'px'\n      ],\n      fixed: [\n        'px',\n        'pt'\n      ],\n      relative: ['%'],\n      empty: ['']\n    };\n    var pattern = function () {\n      var decimalDigits = '[0-9]+';\n      var signedInteger = '[+-]?' + decimalDigits;\n      var exponentPart = '[eE]' + signedInteger;\n      var dot = '\\\\.';\n      var opt = function (input) {\n        return '(?:' + input + ')?';\n      };\n      var unsignedDecimalLiteral = [\n        'Infinity',\n        decimalDigits + dot + opt(decimalDigits) + opt(exponentPart),\n        dot + decimalDigits + opt(exponentPart),\n        decimalDigits + opt(exponentPart)\n      ].join('|');\n      var float = '[+-]?(?:' + unsignedDecimalLiteral + ')';\n      return new RegExp('^(' + float + ')(.*)$');\n    }();\n    var isUnit = function (unit, accepted) {\n      return exists(accepted, function (acc) {\n        return exists(units[acc], function (check) {\n          return unit === check;\n        });\n      });\n    };\n    var parse = function (input, accepted) {\n      var match = Optional.from(pattern.exec(input));\n      return match.bind(function (array) {\n        var value = Number(array[1]);\n        var unitRaw = array[2];\n        if (isUnit(unitRaw, accepted)) {\n          return Optional.some({\n            value: value,\n            unit: unitRaw\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var normalise = function (input, accepted) {\n      return parse(input, accepted).map(function (_a) {\n        var value = _a.value, unit = _a.unit;\n        return value + unit;\n      });\n    };\n\n    var registerController = function (editor, spec) {\n      var getMenuItems = function () {\n        var options = spec.getOptions(editor);\n        var initial = spec.getCurrent(editor).map(spec.hash);\n        var current = value$1();\n        return map$2(options, function (value) {\n          return {\n            type: 'togglemenuitem',\n            text: spec.display(value),\n            onSetup: function (api) {\n              var setActive = function (active) {\n                if (active) {\n                  current.on(function (oldApi) {\n                    return oldApi.setActive(false);\n                  });\n                  current.set(api);\n                }\n                api.setActive(active);\n              };\n              setActive(is$1(initial, spec.hash(value)));\n              var unbindWatcher = spec.watcher(editor, value, setActive);\n              return function () {\n                current.clear();\n                unbindWatcher();\n              };\n            },\n            onAction: function () {\n              return spec.setCurrent(editor, value);\n            }\n          };\n        });\n      };\n      editor.ui.registry.addMenuButton(spec.name, {\n        tooltip: spec.text,\n        icon: spec.icon,\n        fetch: function (callback) {\n          return callback(getMenuItems());\n        },\n        onSetup: spec.onToolbarSetup\n      });\n      editor.ui.registry.addNestedMenuItem(spec.name, {\n        type: 'nestedmenuitem',\n        text: spec.text,\n        getSubmenuItems: getMenuItems,\n        onSetup: spec.onMenuSetup\n      });\n    };\n    var lineHeightSpec = {\n      name: 'lineheight',\n      text: 'Line height',\n      icon: 'line-height',\n      getOptions: getLineHeightFormats,\n      hash: function (input) {\n        return normalise(input, [\n          'fixed',\n          'relative',\n          'empty'\n        ]).getOr(input);\n      },\n      display: identity$1,\n      watcher: function (editor, value, callback) {\n        return editor.formatter.formatChanged('lineheight', callback, false, { value: value }).unbind;\n      },\n      getCurrent: function (editor) {\n        return Optional.from(editor.queryCommandValue('LineHeight'));\n      },\n      setCurrent: function (editor, value) {\n        return editor.execCommand('LineHeight', false, value);\n      }\n    };\n    var languageSpec = function (editor) {\n      var settingsOpt = Optional.from(getContentLanguages(editor));\n      return settingsOpt.map(function (settings) {\n        return {\n          name: 'language',\n          text: 'Language',\n          icon: 'language',\n          getOptions: constant$1(settings),\n          hash: function (input) {\n            return isUndefined(input.customCode) ? input.code : input.code + '/' + input.customCode;\n          },\n          display: function (input) {\n            return input.title;\n          },\n          watcher: function (editor, value, callback) {\n            return editor.formatter.formatChanged('lang', callback, false, {\n              value: value.code,\n              customValue: value.customCode\n            }).unbind;\n          },\n          getCurrent: function (editor) {\n            var node = SugarElement.fromDom(editor.selection.getNode());\n            return closest$4(node, function (n) {\n              return Optional.some(n).filter(isElement$2).bind(function (ele) {\n                var codeOpt = getOpt(ele, 'lang');\n                return codeOpt.map(function (code) {\n                  var customCode = getOpt(ele, 'data-mce-lang').getOrUndefined();\n                  return {\n                    code: code,\n                    customCode: customCode,\n                    title: ''\n                  };\n                });\n              });\n            });\n          },\n          setCurrent: function (editor, lang) {\n            return editor.execCommand('Lang', false, lang);\n          },\n          onToolbarSetup: function (api) {\n            var unbinder = unbindable();\n            api.setActive(editor.formatter.match('lang', {}, undefined, true));\n            unbinder.set(editor.formatter.formatChanged('lang', api.setActive, true));\n            return unbinder.clear;\n          }\n        };\n      });\n    };\n    var register$5 = function (editor) {\n      registerController(editor, lineHeightSpec);\n      languageSpec(editor).each(function (spec) {\n        return registerController(editor, spec);\n      });\n    };\n\n    var register$4 = function (editor, backstage) {\n      alignSelectMenu(editor, backstage);\n      fontSelectMenu(editor, backstage);\n      styleSelectMenu(editor, backstage);\n      formatSelectMenu(editor, backstage);\n      fontsizeSelectMenu(editor, backstage);\n    };\n\n    var onSetupOutdentState = function (editor) {\n      return onSetupEvent(editor, 'NodeChange', function (api) {\n        api.setDisabled(!editor.queryCommandState('outdent'));\n      });\n    };\n    var registerButtons$2 = function (editor) {\n      editor.ui.registry.addButton('outdent', {\n        tooltip: 'Decrease indent',\n        icon: 'outdent',\n        onSetup: onSetupOutdentState(editor),\n        onAction: onActionExecCommand(editor, 'outdent')\n      });\n      editor.ui.registry.addButton('indent', {\n        tooltip: 'Increase indent',\n        icon: 'indent',\n        onAction: onActionExecCommand(editor, 'indent')\n      });\n    };\n    var register$3 = function (editor) {\n      registerButtons$2(editor);\n    };\n\n    var onActionToggleFormat = function (editor, fmt) {\n      return function () {\n        editor.execCommand('mceToggleFormat', false, fmt);\n      };\n    };\n    var registerFormatButtons = function (editor) {\n      global$5.each([\n        {\n          name: 'bold',\n          text: 'Bold',\n          icon: 'bold'\n        },\n        {\n          name: 'italic',\n          text: 'Italic',\n          icon: 'italic'\n        },\n        {\n          name: 'underline',\n          text: 'Underline',\n          icon: 'underline'\n        },\n        {\n          name: 'strikethrough',\n          text: 'Strikethrough',\n          icon: 'strike-through'\n        },\n        {\n          name: 'subscript',\n          text: 'Subscript',\n          icon: 'subscript'\n        },\n        {\n          name: 'superscript',\n          text: 'Superscript',\n          icon: 'superscript'\n        }\n      ], function (btn, _idx) {\n        editor.ui.registry.addToggleButton(btn.name, {\n          tooltip: btn.text,\n          icon: btn.icon,\n          onSetup: onSetupFormatToggle(editor, btn.name),\n          onAction: onActionToggleFormat(editor, btn.name)\n        });\n      });\n      for (var i = 1; i <= 6; i++) {\n        var name_1 = 'h' + i;\n        editor.ui.registry.addToggleButton(name_1, {\n          text: name_1.toUpperCase(),\n          tooltip: 'Heading ' + i,\n          onSetup: onSetupFormatToggle(editor, name_1),\n          onAction: onActionToggleFormat(editor, name_1)\n        });\n      }\n    };\n    var registerCommandButtons = function (editor) {\n      global$5.each([\n        {\n          name: 'cut',\n          text: 'Cut',\n          action: 'Cut',\n          icon: 'cut'\n        },\n        {\n          name: 'copy',\n          text: 'Copy',\n          action: 'Copy',\n          icon: 'copy'\n        },\n        {\n          name: 'paste',\n          text: 'Paste',\n          action: 'Paste',\n          icon: 'paste'\n        },\n        {\n          name: 'help',\n          text: 'Help',\n          action: 'mceHelp',\n          icon: 'help'\n        },\n        {\n          name: 'selectall',\n          text: 'Select all',\n          action: 'SelectAll',\n          icon: 'select-all'\n        },\n        {\n          name: 'newdocument',\n          text: 'New document',\n          action: 'mceNewDocument',\n          icon: 'new-document'\n        },\n        {\n          name: 'removeformat',\n          text: 'Clear formatting',\n          action: 'RemoveFormat',\n          icon: 'remove-formatting'\n        },\n        {\n          name: 'remove',\n          text: 'Remove',\n          action: 'Delete',\n          icon: 'remove'\n        }\n      ], function (btn) {\n        editor.ui.registry.addButton(btn.name, {\n          tooltip: btn.text,\n          icon: btn.icon,\n          onAction: onActionExecCommand(editor, btn.action)\n        });\n      });\n    };\n    var registerCommandToggleButtons = function (editor) {\n      global$5.each([{\n          name: 'blockquote',\n          text: 'Blockquote',\n          action: 'mceBlockQuote',\n          icon: 'quote'\n        }], function (btn) {\n        editor.ui.registry.addToggleButton(btn.name, {\n          tooltip: btn.text,\n          icon: btn.icon,\n          onAction: onActionExecCommand(editor, btn.action),\n          onSetup: onSetupFormatToggle(editor, btn.name)\n        });\n      });\n    };\n    var registerButtons$1 = function (editor) {\n      registerFormatButtons(editor);\n      registerCommandButtons(editor);\n      registerCommandToggleButtons(editor);\n    };\n    var registerMenuItems$2 = function (editor) {\n      global$5.each([\n        {\n          name: 'bold',\n          text: 'Bold',\n          action: 'Bold',\n          icon: 'bold',\n          shortcut: 'Meta+B'\n        },\n        {\n          name: 'italic',\n          text: 'Italic',\n          action: 'Italic',\n          icon: 'italic',\n          shortcut: 'Meta+I'\n        },\n        {\n          name: 'underline',\n          text: 'Underline',\n          action: 'Underline',\n          icon: 'underline',\n          shortcut: 'Meta+U'\n        },\n        {\n          name: 'strikethrough',\n          text: 'Strikethrough',\n          action: 'Strikethrough',\n          icon: 'strike-through',\n          shortcut: ''\n        },\n        {\n          name: 'subscript',\n          text: 'Subscript',\n          action: 'Subscript',\n          icon: 'subscript',\n          shortcut: ''\n        },\n        {\n          name: 'superscript',\n          text: 'Superscript',\n          action: 'Superscript',\n          icon: 'superscript',\n          shortcut: ''\n        },\n        {\n          name: 'removeformat',\n          text: 'Clear formatting',\n          action: 'RemoveFormat',\n          icon: 'remove-formatting',\n          shortcut: ''\n        },\n        {\n          name: 'newdocument',\n          text: 'New document',\n          action: 'mceNewDocument',\n          icon: 'new-document',\n          shortcut: ''\n        },\n        {\n          name: 'cut',\n          text: 'Cut',\n          action: 'Cut',\n          icon: 'cut',\n          shortcut: 'Meta+X'\n        },\n        {\n          name: 'copy',\n          text: 'Copy',\n          action: 'Copy',\n          icon: 'copy',\n          shortcut: 'Meta+C'\n        },\n        {\n          name: 'paste',\n          text: 'Paste',\n          action: 'Paste',\n          icon: 'paste',\n          shortcut: 'Meta+V'\n        },\n        {\n          name: 'selectall',\n          text: 'Select all',\n          action: 'SelectAll',\n          icon: 'select-all',\n          shortcut: 'Meta+A'\n        }\n      ], function (btn) {\n        editor.ui.registry.addMenuItem(btn.name, {\n          text: btn.text,\n          icon: btn.icon,\n          shortcut: btn.shortcut,\n          onAction: onActionExecCommand(editor, btn.action)\n        });\n      });\n      editor.ui.registry.addMenuItem('codeformat', {\n        text: 'Code',\n        icon: 'sourcecode',\n        onAction: onActionToggleFormat(editor, 'code')\n      });\n    };\n    var register$2 = function (editor) {\n      registerButtons$1(editor);\n      registerMenuItems$2(editor);\n    };\n\n    var onSetupUndoRedoState = function (editor, type) {\n      return onSetupEvent(editor, 'Undo Redo AddUndo TypingUndo ClearUndos SwitchMode', function (api) {\n        api.setDisabled(editor.mode.isReadOnly() || !editor.undoManager[type]());\n      });\n    };\n    var registerMenuItems$1 = function (editor) {\n      editor.ui.registry.addMenuItem('undo', {\n        text: 'Undo',\n        icon: 'undo',\n        shortcut: 'Meta+Z',\n        onSetup: onSetupUndoRedoState(editor, 'hasUndo'),\n        onAction: onActionExecCommand(editor, 'undo')\n      });\n      editor.ui.registry.addMenuItem('redo', {\n        text: 'Redo',\n        icon: 'redo',\n        shortcut: 'Meta+Y',\n        onSetup: onSetupUndoRedoState(editor, 'hasRedo'),\n        onAction: onActionExecCommand(editor, 'redo')\n      });\n    };\n    var registerButtons = function (editor) {\n      editor.ui.registry.addButton('undo', {\n        tooltip: 'Undo',\n        icon: 'undo',\n        disabled: true,\n        onSetup: onSetupUndoRedoState(editor, 'hasUndo'),\n        onAction: onActionExecCommand(editor, 'undo')\n      });\n      editor.ui.registry.addButton('redo', {\n        tooltip: 'Redo',\n        icon: 'redo',\n        disabled: true,\n        onSetup: onSetupUndoRedoState(editor, 'hasRedo'),\n        onAction: onActionExecCommand(editor, 'redo')\n      });\n    };\n    var register$1 = function (editor) {\n      registerMenuItems$1(editor);\n      registerButtons(editor);\n    };\n\n    var onSetupVisualAidState = function (editor) {\n      return onSetupEvent(editor, 'VisualAid', function (api) {\n        api.setActive(editor.hasVisual);\n      });\n    };\n    var registerMenuItems = function (editor) {\n      editor.ui.registry.addToggleMenuItem('visualaid', {\n        text: 'Visual aids',\n        onSetup: onSetupVisualAidState(editor),\n        onAction: onActionExecCommand(editor, 'mceToggleVisualAid')\n      });\n    };\n    var registerToolbarButton = function (editor) {\n      editor.ui.registry.addButton('visualaid', {\n        tooltip: 'Visual aids',\n        text: 'Visual aids',\n        onAction: onActionExecCommand(editor, 'mceToggleVisualAid')\n      });\n    };\n    var register = function (editor) {\n      registerToolbarButton(editor);\n      registerMenuItems(editor);\n    };\n\n    var setup$6 = function (editor, backstage) {\n      register$6(editor);\n      register$2(editor);\n      register$4(editor, backstage);\n      register$1(editor);\n      register$a(editor);\n      register(editor);\n      register$3(editor);\n      register$5(editor);\n    };\n\n    var nu = function (x, y) {\n      return {\n        type: 'makeshift',\n        x: x,\n        y: y\n      };\n    };\n    var transpose = function (pos, dx, dy) {\n      return nu(pos.x + dx, pos.y + dy);\n    };\n    var isTouchEvent = function (e) {\n      return e.type === 'longpress' || e.type.indexOf('touch') === 0;\n    };\n    var fromPageXY = function (e) {\n      if (isTouchEvent(e)) {\n        var touch = e.touches[0];\n        return nu(touch.pageX, touch.pageY);\n      } else {\n        return nu(e.pageX, e.pageY);\n      }\n    };\n    var fromClientXY = function (e) {\n      if (isTouchEvent(e)) {\n        var touch = e.touches[0];\n        return nu(touch.clientX, touch.clientY);\n      } else {\n        return nu(e.clientX, e.clientY);\n      }\n    };\n    var transposeContentAreaContainer = function (element, pos) {\n      var containerPos = global$b.DOM.getPos(element);\n      return transpose(pos, containerPos.x, containerPos.y);\n    };\n    var getPointAnchor = function (editor, e) {\n      if (e.type === 'contextmenu' || e.type === 'longpress') {\n        if (editor.inline) {\n          return fromPageXY(e);\n        } else {\n          return transposeContentAreaContainer(editor.getContentAreaContainer(), fromClientXY(e));\n        }\n      } else {\n        return getSelectionAnchor(editor);\n      }\n    };\n    var getSelectionAnchor = function (editor) {\n      return {\n        type: 'selection',\n        root: SugarElement.fromDom(editor.selection.getNode())\n      };\n    };\n    var getNodeAnchor = function (editor) {\n      return {\n        type: 'node',\n        node: Optional.some(SugarElement.fromDom(editor.selection.getNode())),\n        root: SugarElement.fromDom(editor.getBody())\n      };\n    };\n    var getAnchorSpec$1 = function (editor, e, anchorType) {\n      switch (anchorType) {\n      case 'node':\n        return getNodeAnchor(editor);\n      case 'point':\n        return getPointAnchor(editor, e);\n      case 'selection':\n        return getSelectionAnchor(editor);\n      }\n    };\n\n    var initAndShow$1 = function (editor, e, buildMenu, backstage, contextmenu, anchorType) {\n      var items = buildMenu();\n      var anchorSpec = getAnchorSpec$1(editor, e, anchorType);\n      build(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false).map(function (menuData) {\n        e.preventDefault();\n        InlineView.showMenuAt(contextmenu, { anchor: anchorSpec }, {\n          menu: { markers: markers('normal') },\n          data: menuData\n        });\n      });\n    };\n\n    var layouts = {\n      onLtr: function () {\n        return [\n          south$2,\n          southeast$2,\n          southwest$2,\n          northeast$2,\n          northwest$2,\n          north$2,\n          north,\n          south,\n          northeast,\n          southeast,\n          northwest,\n          southwest\n        ];\n      },\n      onRtl: function () {\n        return [\n          south$2,\n          southwest$2,\n          southeast$2,\n          northwest$2,\n          northeast$2,\n          north$2,\n          north,\n          south,\n          northwest,\n          southwest,\n          northeast,\n          southeast\n        ];\n      }\n    };\n    var bubbleSize = 12;\n    var bubbleAlignments = {\n      valignCentre: [],\n      alignCentre: [],\n      alignLeft: ['tox-pop--align-left'],\n      alignRight: ['tox-pop--align-right'],\n      right: ['tox-pop--right'],\n      left: ['tox-pop--left'],\n      bottom: ['tox-pop--bottom'],\n      top: ['tox-pop--top']\n    };\n    var isTouchWithinSelection = function (editor, e) {\n      var selection = editor.selection;\n      if (selection.isCollapsed() || e.touches.length < 1) {\n        return false;\n      } else {\n        var touch_1 = e.touches[0];\n        var rng = selection.getRng();\n        var rngRectOpt = getFirstRect(editor.getWin(), SimSelection.domRange(rng));\n        return rngRectOpt.exists(function (rngRect) {\n          return rngRect.left <= touch_1.clientX && rngRect.right >= touch_1.clientX && rngRect.top <= touch_1.clientY && rngRect.bottom >= touch_1.clientY;\n        });\n      }\n    };\n    var setupiOSOverrides = function (editor) {\n      var originalSelection = editor.selection.getRng();\n      var selectionReset = function () {\n        global$f.setEditorTimeout(editor, function () {\n          editor.selection.setRng(originalSelection);\n        }, 10);\n        unbindEventListeners();\n      };\n      editor.once('touchend', selectionReset);\n      var preventMousedown = function (e) {\n        e.preventDefault();\n        e.stopImmediatePropagation();\n      };\n      editor.on('mousedown', preventMousedown, true);\n      var clearSelectionReset = function () {\n        return unbindEventListeners();\n      };\n      editor.once('longpresscancel', clearSelectionReset);\n      var unbindEventListeners = function () {\n        editor.off('touchend', selectionReset);\n        editor.off('longpresscancel', clearSelectionReset);\n        editor.off('mousedown', preventMousedown);\n      };\n    };\n    var getAnchorSpec = function (editor, e, anchorType) {\n      var anchorSpec = getAnchorSpec$1(editor, e, anchorType);\n      var bubbleYOffset = anchorType === 'point' ? bubbleSize : 0;\n      return __assign({\n        bubble: nu$5(0, bubbleYOffset, bubbleAlignments),\n        layouts: layouts,\n        overrides: {\n          maxWidthFunction: expandable(),\n          maxHeightFunction: expandable$1()\n        }\n      }, anchorSpec);\n    };\n    var show = function (editor, e, items, backstage, contextmenu, anchorType, highlightImmediately) {\n      var anchorSpec = getAnchorSpec(editor, e, anchorType);\n      build(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, true).map(function (menuData) {\n        e.preventDefault();\n        InlineView.showMenuWithinBounds(contextmenu, { anchor: anchorSpec }, {\n          menu: {\n            markers: markers('normal'),\n            highlightImmediately: highlightImmediately\n          },\n          data: menuData,\n          type: 'horizontal'\n        }, function () {\n          return Optional.some(getContextToolbarBounds(editor, backstage.shared, anchorType === 'node' ? 'node' : 'selection'));\n        });\n        editor.fire(hideContextToolbarEvent);\n      });\n    };\n    var initAndShow = function (editor, e, buildMenu, backstage, contextmenu, anchorType) {\n      var detection = detect$1();\n      var isiOS = detection.os.isiOS();\n      var isOSX = detection.os.isOSX();\n      var isAndroid = detection.os.isAndroid();\n      var isTouch = detection.deviceType.isTouch();\n      var shouldHighlightImmediately = function () {\n        return !(isAndroid || isiOS || isOSX && isTouch);\n      };\n      var open = function () {\n        var items = buildMenu();\n        show(editor, e, items, backstage, contextmenu, anchorType, shouldHighlightImmediately());\n      };\n      if ((isOSX || isiOS) && anchorType !== 'node') {\n        var openiOS_1 = function () {\n          setupiOSOverrides(editor);\n          open();\n        };\n        if (isTouchWithinSelection(editor, e)) {\n          openiOS_1();\n        } else {\n          editor.once('selectionchange', openiOS_1);\n          editor.once('touchend', function () {\n            return editor.off('selectionchange', openiOS_1);\n          });\n        }\n      } else {\n        open();\n      }\n    };\n\n    var patchPipeConfig = function (config) {\n      return typeof config === 'string' ? config.split(/[ ,]/) : config;\n    };\n    var shouldNeverUseNative = function (editor) {\n      return editor.getParam('contextmenu_never_use_native', false, 'boolean');\n    };\n    var getMenuItems = function (editor, name, defaultItems) {\n      var contextMenus = editor.ui.registry.getAll().contextMenus;\n      return Optional.from(editor.getParam(name)).map(patchPipeConfig).getOrThunk(function () {\n        return filter$2(patchPipeConfig(defaultItems), function (item) {\n          return has$2(contextMenus, item);\n        });\n      });\n    };\n    var isContextMenuDisabled = function (editor) {\n      return editor.getParam('contextmenu') === false;\n    };\n    var getContextMenu = function (editor) {\n      return getMenuItems(editor, 'contextmenu', 'link linkchecker image imagetools table spellchecker configurepermanentpen');\n    };\n    var getAvoidOverlapSelector = function (editor) {\n      return editor.getParam('contextmenu_avoid_overlap', '', 'string');\n    };\n\n    var isSeparator = function (item) {\n      return isString(item) ? item === '|' : item.type === 'separator';\n    };\n    var separator = { type: 'separator' };\n    var makeContextItem = function (item) {\n      var commonMenuItem = function (item) {\n        return {\n          text: item.text,\n          icon: item.icon,\n          disabled: item.disabled,\n          shortcut: item.shortcut\n        };\n      };\n      if (isString(item)) {\n        return item;\n      } else {\n        switch (item.type) {\n        case 'separator':\n          return separator;\n        case 'submenu':\n          return __assign(__assign({ type: 'nestedmenuitem' }, commonMenuItem(item)), {\n            getSubmenuItems: function () {\n              var items = item.getSubmenuItems();\n              if (isString(items)) {\n                return items;\n              } else {\n                return map$2(items, makeContextItem);\n              }\n            }\n          });\n        default:\n          return __assign(__assign({ type: 'menuitem' }, commonMenuItem(item)), { onAction: noarg(item.onAction) });\n        }\n      }\n    };\n    var addContextMenuGroup = function (xs, groupItems) {\n      if (groupItems.length === 0) {\n        return xs;\n      }\n      var lastMenuItem = last$2(xs).filter(function (item) {\n        return !isSeparator(item);\n      });\n      var before = lastMenuItem.fold(function () {\n        return [];\n      }, function (_) {\n        return [separator];\n      });\n      return xs.concat(before).concat(groupItems).concat([separator]);\n    };\n    var generateContextMenu = function (contextMenus, menuConfig, selectedElement) {\n      var sections = foldl(menuConfig, function (acc, name) {\n        return get$e(contextMenus, name.toLowerCase()).map(function (menu) {\n          var items = menu.update(selectedElement);\n          if (isString(items)) {\n            return addContextMenuGroup(acc, items.split(' '));\n          } else if (items.length > 0) {\n            var allItems = map$2(items, makeContextItem);\n            return addContextMenuGroup(acc, allItems);\n          } else {\n            return acc;\n          }\n        }).getOrThunk(function () {\n          return acc.concat([name]);\n        });\n      }, []);\n      if (sections.length > 0 && isSeparator(sections[sections.length - 1])) {\n        sections.pop();\n      }\n      return sections;\n    };\n    var isNativeOverrideKeyEvent = function (editor, e) {\n      return e.ctrlKey && !shouldNeverUseNative(editor);\n    };\n    var isTriggeredByKeyboard = function (editor, e) {\n      return e.type !== 'longpress' && (e.button !== 2 || e.target === editor.getBody() && e.pointerType === '');\n    };\n    var getSelectedElement = function (editor, e) {\n      return isTriggeredByKeyboard(editor, e) ? editor.selection.getStart(true) : e.target;\n    };\n    var getAnchorType = function (editor, e) {\n      var selector = getAvoidOverlapSelector(editor);\n      var anchorType = isTriggeredByKeyboard(editor, e) ? 'selection' : 'point';\n      if (isNotEmpty(selector)) {\n        var target = getSelectedElement(editor, e);\n        var selectorExists = closest(SugarElement.fromDom(target), selector);\n        return selectorExists ? 'node' : anchorType;\n      } else {\n        return anchorType;\n      }\n    };\n    var setup$5 = function (editor, lazySink, backstage) {\n      var detection = detect$1();\n      var isTouch = detection.deviceType.isTouch;\n      var contextmenu = build$1(InlineView.sketch({\n        dom: { tag: 'div' },\n        lazySink: lazySink,\n        onEscape: function () {\n          return editor.focus();\n        },\n        onShow: function () {\n          return backstage.setContextMenuState(true);\n        },\n        onHide: function () {\n          return backstage.setContextMenuState(false);\n        },\n        fireDismissalEventInstead: {},\n        inlineBehaviours: derive$1([config('dismissContextMenu', [run$1(dismissRequested(), function (comp, _se) {\n              Sandboxing.close(comp);\n              editor.focus();\n            })])])\n      }));\n      var hideContextMenu = function (_e) {\n        return InlineView.hide(contextmenu);\n      };\n      var showContextMenu = function (e) {\n        if (shouldNeverUseNative(editor)) {\n          e.preventDefault();\n        }\n        if (isNativeOverrideKeyEvent(editor, e) || isContextMenuDisabled(editor)) {\n          return;\n        }\n        var anchorType = getAnchorType(editor, e);\n        var buildMenu = function () {\n          var selectedElement = getSelectedElement(editor, e);\n          var registry = editor.ui.registry.getAll();\n          var menuConfig = getContextMenu(editor);\n          return generateContextMenu(registry.contextMenus, menuConfig, selectedElement);\n        };\n        var initAndShow$2 = isTouch() ? initAndShow : initAndShow$1;\n        initAndShow$2(editor, e, buildMenu, backstage, contextmenu, anchorType);\n      };\n      editor.on('init', function () {\n        var hideEvents = 'ResizeEditor ScrollContent ScrollWindow longpresscancel' + (isTouch() ? '' : ' ResizeWindow');\n        editor.on(hideEvents, hideContextMenu);\n        editor.on('longpress contextmenu', showContextMenu);\n      });\n    };\n\n    var adt = Adt.generate([\n      {\n        offset: [\n          'x',\n          'y'\n        ]\n      },\n      {\n        absolute: [\n          'x',\n          'y'\n        ]\n      },\n      {\n        fixed: [\n          'x',\n          'y'\n        ]\n      }\n    ]);\n    var subtract = function (change) {\n      return function (point) {\n        return point.translate(-change.left, -change.top);\n      };\n    };\n    var add = function (change) {\n      return function (point) {\n        return point.translate(change.left, change.top);\n      };\n    };\n    var transform = function (changes) {\n      return function (x, y) {\n        return foldl(changes, function (rest, f) {\n          return f(rest);\n        }, SugarPosition(x, y));\n      };\n    };\n    var asFixed = function (coord, scroll, origin) {\n      return coord.fold(transform([\n        add(origin),\n        subtract(scroll)\n      ]), transform([subtract(scroll)]), transform([]));\n    };\n    var asAbsolute = function (coord, scroll, origin) {\n      return coord.fold(transform([add(origin)]), transform([]), transform([add(scroll)]));\n    };\n    var asOffset = function (coord, scroll, origin) {\n      return coord.fold(transform([]), transform([subtract(origin)]), transform([\n        add(scroll),\n        subtract(origin)\n      ]));\n    };\n    var withinRange = function (coord1, coord2, xRange, yRange, scroll, origin) {\n      var a1 = asAbsolute(coord1, scroll, origin);\n      var a2 = asAbsolute(coord2, scroll, origin);\n      return Math.abs(a1.left - a2.left) <= xRange && Math.abs(a1.top - a2.top) <= yRange;\n    };\n    var getDeltas = function (coord1, coord2, xRange, yRange, scroll, origin) {\n      var a1 = asAbsolute(coord1, scroll, origin);\n      var a2 = asAbsolute(coord2, scroll, origin);\n      var left = Math.abs(a1.left - a2.left);\n      var top = Math.abs(a1.top - a2.top);\n      return SugarPosition(left, top);\n    };\n    var toStyles = function (coord, scroll, origin) {\n      var stylesOpt = coord.fold(function (x, y) {\n        return {\n          position: Optional.some('absolute'),\n          left: Optional.some(x + 'px'),\n          top: Optional.some(y + 'px')\n        };\n      }, function (x, y) {\n        return {\n          position: Optional.some('absolute'),\n          left: Optional.some(x - origin.left + 'px'),\n          top: Optional.some(y - origin.top + 'px')\n        };\n      }, function (x, y) {\n        return {\n          position: Optional.some('fixed'),\n          left: Optional.some(x + 'px'),\n          top: Optional.some(y + 'px')\n        };\n      });\n      return __assign({\n        right: Optional.none(),\n        bottom: Optional.none()\n      }, stylesOpt);\n    };\n    var translate = function (coord, deltaX, deltaY) {\n      return coord.fold(function (x, y) {\n        return offset(x + deltaX, y + deltaY);\n      }, function (x, y) {\n        return absolute(x + deltaX, y + deltaY);\n      }, function (x, y) {\n        return fixed(x + deltaX, y + deltaY);\n      });\n    };\n    var absorb = function (partialCoord, originalCoord, scroll, origin) {\n      var absorbOne = function (stencil, nu) {\n        return function (optX, optY) {\n          var original = stencil(originalCoord, scroll, origin);\n          return nu(optX.getOr(original.left), optY.getOr(original.top));\n        };\n      };\n      return partialCoord.fold(absorbOne(asOffset, offset), absorbOne(asAbsolute, absolute), absorbOne(asFixed, fixed));\n    };\n    var offset = adt.offset;\n    var absolute = adt.absolute;\n    var fixed = adt.fixed;\n\n    var parseAttrToInt = function (element, name) {\n      var value = get$d(element, name);\n      return isUndefined(value) ? NaN : parseInt(value, 10);\n    };\n    var get = function (component, snapsInfo) {\n      var element = component.element;\n      var x = parseAttrToInt(element, snapsInfo.leftAttr);\n      var y = parseAttrToInt(element, snapsInfo.topAttr);\n      return isNaN(x) || isNaN(y) ? Optional.none() : Optional.some(SugarPosition(x, y));\n    };\n    var set = function (component, snapsInfo, pt) {\n      var element = component.element;\n      set$8(element, snapsInfo.leftAttr, pt.left + 'px');\n      set$8(element, snapsInfo.topAttr, pt.top + 'px');\n    };\n    var clear = function (component, snapsInfo) {\n      var element = component.element;\n      remove$7(element, snapsInfo.leftAttr);\n      remove$7(element, snapsInfo.topAttr);\n    };\n\n    var getCoords = function (component, snapInfo, coord, delta) {\n      return get(component, snapInfo).fold(function () {\n        return coord;\n      }, function (fixed$1) {\n        return fixed(fixed$1.left + delta.left, fixed$1.top + delta.top);\n      });\n    };\n    var moveOrSnap = function (component, snapInfo, coord, delta, scroll, origin) {\n      var newCoord = getCoords(component, snapInfo, coord, delta);\n      var snap = snapInfo.mustSnap ? findClosestSnap(component, snapInfo, newCoord, scroll, origin) : findSnap(component, snapInfo, newCoord, scroll, origin);\n      var fixedCoord = asFixed(newCoord, scroll, origin);\n      set(component, snapInfo, fixedCoord);\n      return snap.fold(function () {\n        return {\n          coord: fixed(fixedCoord.left, fixedCoord.top),\n          extra: Optional.none()\n        };\n      }, function (spanned) {\n        return {\n          coord: spanned.output,\n          extra: spanned.extra\n        };\n      });\n    };\n    var stopDrag = function (component, snapInfo) {\n      clear(component, snapInfo);\n    };\n    var findMatchingSnap = function (snaps, newCoord, scroll, origin) {\n      return findMap(snaps, function (snap) {\n        var sensor = snap.sensor;\n        var inRange = withinRange(newCoord, sensor, snap.range.left, snap.range.top, scroll, origin);\n        return inRange ? Optional.some({\n          output: absorb(snap.output, newCoord, scroll, origin),\n          extra: snap.extra\n        }) : Optional.none();\n      });\n    };\n    var findClosestSnap = function (component, snapInfo, newCoord, scroll, origin) {\n      var snaps = snapInfo.getSnapPoints(component);\n      var matchSnap = findMatchingSnap(snaps, newCoord, scroll, origin);\n      return matchSnap.orThunk(function () {\n        var bestSnap = foldl(snaps, function (acc, snap) {\n          var sensor = snap.sensor;\n          var deltas = getDeltas(newCoord, sensor, snap.range.left, snap.range.top, scroll, origin);\n          return acc.deltas.fold(function () {\n            return {\n              deltas: Optional.some(deltas),\n              snap: Optional.some(snap)\n            };\n          }, function (bestDeltas) {\n            var currAvg = (deltas.left + deltas.top) / 2;\n            var bestAvg = (bestDeltas.left + bestDeltas.top) / 2;\n            if (currAvg <= bestAvg) {\n              return {\n                deltas: Optional.some(deltas),\n                snap: Optional.some(snap)\n              };\n            } else {\n              return acc;\n            }\n          });\n        }, {\n          deltas: Optional.none(),\n          snap: Optional.none()\n        });\n        return bestSnap.snap.map(function (snap) {\n          return {\n            output: absorb(snap.output, newCoord, scroll, origin),\n            extra: snap.extra\n          };\n        });\n      });\n    };\n    var findSnap = function (component, snapInfo, newCoord, scroll, origin) {\n      var snaps = snapInfo.getSnapPoints(component);\n      return findMatchingSnap(snaps, newCoord, scroll, origin);\n    };\n    var snapTo$1 = function (snap, scroll, origin) {\n      return {\n        coord: absorb(snap.output, snap.output, scroll, origin),\n        extra: snap.extra\n      };\n    };\n\n    var snapTo = function (component, dragConfig, _state, snap) {\n      var target = dragConfig.getTarget(component.element);\n      if (dragConfig.repositionTarget) {\n        var doc = owner$4(component.element);\n        var scroll_1 = get$9(doc);\n        var origin_1 = getOrigin(target);\n        var snapPin = snapTo$1(snap, scroll_1, origin_1);\n        var styles = toStyles(snapPin.coord, scroll_1, origin_1);\n        setOptions(target, styles);\n      }\n    };\n\n    var DraggingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        snapTo: snapTo\n    });\n\n    var initialAttribute = 'data-initial-z-index';\n    var resetZIndex = function (blocker) {\n      parent(blocker.element).filter(isElement$2).each(function (root) {\n        getOpt(root, initialAttribute).fold(function () {\n          return remove$6(root, 'z-index');\n        }, function (zIndex) {\n          return set$7(root, 'z-index', zIndex);\n        });\n        remove$7(root, initialAttribute);\n      });\n    };\n    var changeZIndex = function (blocker) {\n      parent(blocker.element).filter(isElement$2).each(function (root) {\n        getRaw(root, 'z-index').each(function (zindex) {\n          set$8(root, initialAttribute, zindex);\n        });\n        set$7(root, 'z-index', get$c(blocker.element, 'z-index'));\n      });\n    };\n    var instigate = function (anyComponent, blocker) {\n      anyComponent.getSystem().addToGui(blocker);\n      changeZIndex(blocker);\n    };\n    var discard = function (blocker) {\n      resetZIndex(blocker);\n      blocker.getSystem().removeFromGui(blocker);\n    };\n    var createComponent = function (component, blockerClass, blockerEvents) {\n      return component.getSystem().build(Container.sketch({\n        dom: {\n          styles: {\n            'left': '0px',\n            'top': '0px',\n            'width': '100%',\n            'height': '100%',\n            'position': 'fixed',\n            'z-index': '1000000000000000'\n          },\n          classes: [blockerClass]\n        },\n        events: blockerEvents\n      }));\n    };\n\n    var SnapSchema = optionObjOf('snaps', [\n      required$1('getSnapPoints'),\n      onHandler('onSensor'),\n      required$1('leftAttr'),\n      required$1('topAttr'),\n      defaulted('lazyViewport', win),\n      defaulted('mustSnap', false)\n    ]);\n\n    var schema$6 = [\n      defaulted('useFixed', never),\n      required$1('blockerClass'),\n      defaulted('getTarget', identity$1),\n      defaulted('onDrag', noop),\n      defaulted('repositionTarget', true),\n      defaulted('onDrop', noop),\n      defaultedFunction('getBounds', win),\n      SnapSchema\n    ];\n\n    var getCurrentCoord = function (target) {\n      return lift3(getRaw(target, 'left'), getRaw(target, 'top'), getRaw(target, 'position'), function (left, top, position) {\n        var nu = position === 'fixed' ? fixed : offset;\n        return nu(parseInt(left, 10), parseInt(top, 10));\n      }).getOrThunk(function () {\n        var location = absolute$3(target);\n        return absolute(location.left, location.top);\n      });\n    };\n    var clampCoords = function (component, coords, scroll, origin, startData) {\n      var bounds = startData.bounds;\n      var absoluteCoord = asAbsolute(coords, scroll, origin);\n      var newX = clamp$1(absoluteCoord.left, bounds.x, bounds.x + bounds.width - startData.width);\n      var newY = clamp$1(absoluteCoord.top, bounds.y, bounds.y + bounds.height - startData.height);\n      var newCoords = absolute(newX, newY);\n      return coords.fold(function () {\n        var offset$1 = asOffset(newCoords, scroll, origin);\n        return offset(offset$1.left, offset$1.top);\n      }, constant$1(newCoords), function () {\n        var fixed$1 = asFixed(newCoords, scroll, origin);\n        return fixed(fixed$1.left, fixed$1.top);\n      });\n    };\n    var calcNewCoord = function (component, optSnaps, currentCoord, scroll, origin, delta, startData) {\n      var newCoord = optSnaps.fold(function () {\n        var translated = translate(currentCoord, delta.left, delta.top);\n        var fixedCoord = asFixed(translated, scroll, origin);\n        return fixed(fixedCoord.left, fixedCoord.top);\n      }, function (snapInfo) {\n        var snapping = moveOrSnap(component, snapInfo, currentCoord, delta, scroll, origin);\n        snapping.extra.each(function (extra) {\n          snapInfo.onSensor(component, extra);\n        });\n        return snapping.coord;\n      });\n      return clampCoords(component, newCoord, scroll, origin, startData);\n    };\n    var dragBy = function (component, dragConfig, startData, delta) {\n      var target = dragConfig.getTarget(component.element);\n      if (dragConfig.repositionTarget) {\n        var doc = owner$4(component.element);\n        var scroll_1 = get$9(doc);\n        var origin_1 = getOrigin(target);\n        var currentCoord = getCurrentCoord(target);\n        var newCoord = calcNewCoord(component, dragConfig.snaps, currentCoord, scroll_1, origin_1, delta, startData);\n        var styles = toStyles(newCoord, scroll_1, origin_1);\n        setOptions(target, styles);\n      }\n      dragConfig.onDrag(component, target, delta);\n    };\n\n    var calcStartData = function (dragConfig, comp) {\n      return {\n        bounds: dragConfig.getBounds(),\n        height: getOuter$2(comp.element),\n        width: getOuter$1(comp.element)\n      };\n    };\n    var move = function (component, dragConfig, dragState, dragMode, event) {\n      var delta = dragState.update(dragMode, event);\n      var dragStartData = dragState.getStartData().getOrThunk(function () {\n        return calcStartData(dragConfig, component);\n      });\n      delta.each(function (dlt) {\n        dragBy(component, dragConfig, dragStartData, dlt);\n      });\n    };\n    var stop = function (component, blocker, dragConfig, dragState) {\n      blocker.each(discard);\n      dragConfig.snaps.each(function (snapInfo) {\n        stopDrag(component, snapInfo);\n      });\n      var target = dragConfig.getTarget(component.element);\n      dragState.reset();\n      dragConfig.onDrop(component, target);\n    };\n    var handlers = function (events) {\n      return function (dragConfig, dragState) {\n        var updateStartState = function (comp) {\n          dragState.setStartData(calcStartData(dragConfig, comp));\n        };\n        return derive$2(__spreadArray([run$1(windowScroll(), function (comp) {\n            dragState.getStartData().each(function () {\n              return updateStartState(comp);\n            });\n          })], events(dragConfig, dragState, updateStartState), true));\n      };\n    };\n\n    var init$2 = function (dragApi) {\n      return derive$2([\n        run$1(mousedown(), dragApi.forceDrop),\n        run$1(mouseup(), dragApi.drop),\n        run$1(mousemove(), function (comp, simulatedEvent) {\n          dragApi.move(simulatedEvent.event);\n        }),\n        run$1(mouseout(), dragApi.delayDrop)\n      ]);\n    };\n\n    var getData$1 = function (event) {\n      return Optional.from(SugarPosition(event.x, event.y));\n    };\n    var getDelta$1 = function (old, nu) {\n      return SugarPosition(nu.left - old.left, nu.top - old.top);\n    };\n\n    var MouseData = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getData: getData$1,\n        getDelta: getDelta$1\n    });\n\n    var events$2 = function (dragConfig, dragState, updateStartState) {\n      return [run$1(mousedown(), function (component, simulatedEvent) {\n          var raw = simulatedEvent.event.raw;\n          if (raw.button !== 0) {\n            return;\n          }\n          simulatedEvent.stop();\n          var stop$1 = function () {\n            return stop(component, Optional.some(blocker), dragConfig, dragState);\n          };\n          var delayDrop = DelayedFunction(stop$1, 200);\n          var dragApi = {\n            drop: stop$1,\n            delayDrop: delayDrop.schedule,\n            forceDrop: stop$1,\n            move: function (event) {\n              delayDrop.cancel();\n              move(component, dragConfig, dragState, MouseData, event);\n            }\n          };\n          var blocker = createComponent(component, dragConfig.blockerClass, init$2(dragApi));\n          var start = function () {\n            updateStartState(component);\n            instigate(component, blocker);\n          };\n          start();\n        })];\n    };\n    var schema$5 = __spreadArray(__spreadArray([], schema$6, true), [output$1('dragger', { handlers: handlers(events$2) })], false);\n\n    var init$1 = function (dragApi) {\n      return derive$2([\n        run$1(touchstart(), dragApi.forceDrop),\n        run$1(touchend(), dragApi.drop),\n        run$1(touchcancel(), dragApi.drop),\n        run$1(touchmove(), function (comp, simulatedEvent) {\n          dragApi.move(simulatedEvent.event);\n        })\n      ]);\n    };\n\n    var getDataFrom = function (touches) {\n      var touch = touches[0];\n      return Optional.some(SugarPosition(touch.clientX, touch.clientY));\n    };\n    var getData = function (event) {\n      var raw = event.raw;\n      var touches = raw.touches;\n      return touches.length === 1 ? getDataFrom(touches) : Optional.none();\n    };\n    var getDelta = function (old, nu) {\n      return SugarPosition(nu.left - old.left, nu.top - old.top);\n    };\n\n    var TouchData = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getData: getData,\n        getDelta: getDelta\n    });\n\n    var events$1 = function (dragConfig, dragState, updateStartState) {\n      var blockerSingleton = value$1();\n      var stopBlocking = function (component) {\n        stop(component, blockerSingleton.get(), dragConfig, dragState);\n        blockerSingleton.clear();\n      };\n      return [\n        run$1(touchstart(), function (component, simulatedEvent) {\n          simulatedEvent.stop();\n          var stop = function () {\n            return stopBlocking(component);\n          };\n          var dragApi = {\n            drop: stop,\n            delayDrop: noop,\n            forceDrop: stop,\n            move: function (event) {\n              move(component, dragConfig, dragState, TouchData, event);\n            }\n          };\n          var blocker = createComponent(component, dragConfig.blockerClass, init$1(dragApi));\n          blockerSingleton.set(blocker);\n          var start = function () {\n            updateStartState(component);\n            instigate(component, blocker);\n          };\n          start();\n        }),\n        run$1(touchmove(), function (component, simulatedEvent) {\n          simulatedEvent.stop();\n          move(component, dragConfig, dragState, TouchData, simulatedEvent.event);\n        }),\n        run$1(touchend(), function (component, simulatedEvent) {\n          simulatedEvent.stop();\n          stopBlocking(component);\n        }),\n        run$1(touchcancel(), stopBlocking)\n      ];\n    };\n    var schema$4 = __spreadArray(__spreadArray([], schema$6, true), [output$1('dragger', { handlers: handlers(events$1) })], false);\n\n    var events = function (dragConfig, dragState, updateStartState) {\n      return __spreadArray(__spreadArray([], events$2(dragConfig, dragState, updateStartState), true), events$1(dragConfig, dragState, updateStartState), true);\n    };\n    var schema$3 = __spreadArray(__spreadArray([], schema$6, true), [output$1('dragger', { handlers: handlers(events) })], false);\n\n    var mouse = schema$5;\n    var touch = schema$4;\n    var mouseOrTouch = schema$3;\n\n    var DraggingBranches = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        mouse: mouse,\n        touch: touch,\n        mouseOrTouch: mouseOrTouch\n    });\n\n    var init = function () {\n      var previous = Optional.none();\n      var startData = Optional.none();\n      var reset = function () {\n        previous = Optional.none();\n        startData = Optional.none();\n      };\n      var calculateDelta = function (mode, nu) {\n        var result = previous.map(function (old) {\n          return mode.getDelta(old, nu);\n        });\n        previous = Optional.some(nu);\n        return result;\n      };\n      var update = function (mode, dragEvent) {\n        return mode.getData(dragEvent).bind(function (nuData) {\n          return calculateDelta(mode, nuData);\n        });\n      };\n      var setStartData = function (data) {\n        startData = Optional.some(data);\n      };\n      var getStartData = function () {\n        return startData;\n      };\n      var readState = constant$1({});\n      return nu$8({\n        readState: readState,\n        reset: reset,\n        update: update,\n        getStartData: getStartData,\n        setStartData: setStartData\n      });\n    };\n\n    var DragState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init\n    });\n\n    var Dragging = createModes({\n      branchKey: 'mode',\n      branches: DraggingBranches,\n      name: 'dragging',\n      active: {\n        events: function (dragConfig, dragState) {\n          var dragger = dragConfig.dragger;\n          return dragger.handlers(dragConfig, dragState);\n        }\n      },\n      extra: {\n        snap: function (sConfig) {\n          return {\n            sensor: sConfig.sensor,\n            range: sConfig.range,\n            output: sConfig.output,\n            extra: Optional.from(sConfig.extra)\n          };\n        }\n      },\n      state: DragState,\n      apis: DraggingApis\n    });\n\n    var snapWidth = 40;\n    var snapOffset = snapWidth / 2;\n    var calcSnap = function (selectorOpt, td, x, y, width, height) {\n      return selectorOpt.fold(function () {\n        return Dragging.snap({\n          sensor: absolute(x - snapOffset, y - snapOffset),\n          range: SugarPosition(width, height),\n          output: absolute(Optional.some(x), Optional.some(y)),\n          extra: { td: td }\n        });\n      }, function (selectorHandle) {\n        var sensorLeft = x - snapOffset;\n        var sensorTop = y - snapOffset;\n        var sensorWidth = snapWidth;\n        var sensorHeight = snapWidth;\n        var rect = selectorHandle.element.dom.getBoundingClientRect();\n        return Dragging.snap({\n          sensor: absolute(sensorLeft, sensorTop),\n          range: SugarPosition(sensorWidth, sensorHeight),\n          output: absolute(Optional.some(x - rect.width / 2), Optional.some(y - rect.height / 2)),\n          extra: { td: td }\n        });\n      });\n    };\n    var getSnapsConfig = function (getSnapPoints, cell, onChange) {\n      var isSameCell = function (cellOpt, td) {\n        return cellOpt.exists(function (currentTd) {\n          return eq(currentTd, td);\n        });\n      };\n      return {\n        getSnapPoints: getSnapPoints,\n        leftAttr: 'data-drag-left',\n        topAttr: 'data-drag-top',\n        onSensor: function (component, extra) {\n          var td = extra.td;\n          if (!isSameCell(cell.get(), td)) {\n            cell.set(td);\n            onChange(td);\n          }\n        },\n        mustSnap: true\n      };\n    };\n    var createSelector = function (snaps) {\n      return record(Button.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-selector']\n        },\n        buttonBehaviours: derive$1([\n          Dragging.config({\n            mode: 'mouseOrTouch',\n            blockerClass: 'blocker',\n            snaps: snaps\n          }),\n          Unselecting.config({})\n        ]),\n        eventOrder: {\n          mousedown: [\n            'dragging',\n            'alloy.base.behaviour'\n          ],\n          touchstart: [\n            'dragging',\n            'alloy.base.behaviour'\n          ]\n        }\n      }));\n    };\n    var setup$4 = function (editor, sink) {\n      var tlTds = Cell([]);\n      var brTds = Cell([]);\n      var isVisible = Cell(false);\n      var startCell = value$1();\n      var finishCell = value$1();\n      var getTopLeftSnap = function (td) {\n        var box = absolute$2(td);\n        return calcSnap(memTopLeft.getOpt(sink), td, box.x, box.y, box.width, box.height);\n      };\n      var getTopLeftSnaps = function () {\n        return map$2(tlTds.get(), function (td) {\n          return getTopLeftSnap(td);\n        });\n      };\n      var getBottomRightSnap = function (td) {\n        var box = absolute$2(td);\n        return calcSnap(memBottomRight.getOpt(sink), td, box.right, box.bottom, box.width, box.height);\n      };\n      var getBottomRightSnaps = function () {\n        return map$2(brTds.get(), function (td) {\n          return getBottomRightSnap(td);\n        });\n      };\n      var topLeftSnaps = getSnapsConfig(getTopLeftSnaps, startCell, function (start) {\n        finishCell.get().each(function (finish) {\n          editor.fire('TableSelectorChange', {\n            start: start,\n            finish: finish\n          });\n        });\n      });\n      var bottomRightSnaps = getSnapsConfig(getBottomRightSnaps, finishCell, function (finish) {\n        startCell.get().each(function (start) {\n          editor.fire('TableSelectorChange', {\n            start: start,\n            finish: finish\n          });\n        });\n      });\n      var memTopLeft = createSelector(topLeftSnaps);\n      var memBottomRight = createSelector(bottomRightSnaps);\n      var topLeft = build$1(memTopLeft.asSpec());\n      var bottomRight = build$1(memBottomRight.asSpec());\n      var showOrHideHandle = function (selector, cell, isAbove, isBelow) {\n        var cellRect = cell.dom.getBoundingClientRect();\n        remove$6(selector.element, 'display');\n        var viewportHeight = defaultView(SugarElement.fromDom(editor.getBody())).dom.innerHeight;\n        var aboveViewport = isAbove(cellRect);\n        var belowViewport = isBelow(cellRect, viewportHeight);\n        if (aboveViewport || belowViewport) {\n          set$7(selector.element, 'display', 'none');\n        }\n      };\n      var snapTo = function (selector, cell, getSnapConfig, pos) {\n        var snap = getSnapConfig(cell);\n        Dragging.snapTo(selector, snap);\n        var isAbove = function (rect) {\n          return rect[pos] < 0;\n        };\n        var isBelow = function (rect, viewportHeight) {\n          return rect[pos] > viewportHeight;\n        };\n        showOrHideHandle(selector, cell, isAbove, isBelow);\n      };\n      var snapTopLeft = function (cell) {\n        return snapTo(topLeft, cell, getTopLeftSnap, 'top');\n      };\n      var snapLastTopLeft = function () {\n        return startCell.get().each(snapTopLeft);\n      };\n      var snapBottomRight = function (cell) {\n        return snapTo(bottomRight, cell, getBottomRightSnap, 'bottom');\n      };\n      var snapLastBottomRight = function () {\n        return finishCell.get().each(snapBottomRight);\n      };\n      if (detect$1().deviceType.isTouch()) {\n        editor.on('TableSelectionChange', function (e) {\n          if (!isVisible.get()) {\n            attach(sink, topLeft);\n            attach(sink, bottomRight);\n            isVisible.set(true);\n          }\n          startCell.set(e.start);\n          finishCell.set(e.finish);\n          e.otherCells.each(function (otherCells) {\n            tlTds.set(otherCells.upOrLeftCells);\n            brTds.set(otherCells.downOrRightCells);\n            snapTopLeft(e.start);\n            snapBottomRight(e.finish);\n          });\n        });\n        editor.on('ResizeEditor ResizeWindow ScrollContent', function () {\n          snapLastTopLeft();\n          snapLastBottomRight();\n        });\n        editor.on('TableSelectionClear', function () {\n          if (isVisible.get()) {\n            detach(topLeft);\n            detach(bottomRight);\n            isVisible.set(false);\n          }\n          startCell.clear();\n          finishCell.clear();\n        });\n      }\n    };\n\n    var isHidden = function (elm) {\n      if (elm.nodeType === 1) {\n        if (elm.nodeName === 'BR' || !!elm.getAttribute('data-mce-bogus')) {\n          return true;\n        }\n        if (elm.getAttribute('data-mce-type') === 'bookmark') {\n          return true;\n        }\n      }\n      return false;\n    };\n    var renderElementPath = function (editor, settings, providersBackstage) {\n      if (!settings.delimiter) {\n        settings.delimiter = '\\xBB';\n      }\n      var getDataPath = function (data) {\n        var parts = data || [];\n        var newPathElements = map$2(parts, function (part, index) {\n          return Button.sketch({\n            dom: {\n              tag: 'div',\n              classes: ['tox-statusbar__path-item'],\n              attributes: {\n                'role': 'button',\n                'data-index': index,\n                'tab-index': -1,\n                'aria-level': index + 1\n              },\n              innerHtml: part.name\n            },\n            action: function (_btn) {\n              editor.focus();\n              editor.selection.select(part.element);\n              editor.nodeChanged();\n            },\n            buttonBehaviours: derive$1([\n              DisablingConfigs.button(providersBackstage.isDisabled),\n              receivingConfig()\n            ])\n          });\n        });\n        var divider = {\n          dom: {\n            tag: 'div',\n            classes: ['tox-statusbar__path-divider'],\n            attributes: { 'aria-hidden': true },\n            innerHtml: ' ' + settings.delimiter + ' '\n          }\n        };\n        return foldl(newPathElements.slice(1), function (acc, element) {\n          var newAcc = acc;\n          newAcc.push(divider);\n          newAcc.push(element);\n          return newAcc;\n        }, [newPathElements[0]]);\n      };\n      var updatePath = function (parents) {\n        var newPath = [];\n        var i = parents.length;\n        while (i-- > 0) {\n          var parent_1 = parents[i];\n          if (parent_1.nodeType === 1 && !isHidden(parent_1)) {\n            var args = editor.fire('ResolveName', {\n              name: parent_1.nodeName.toLowerCase(),\n              target: parent_1\n            });\n            if (!args.isDefaultPrevented()) {\n              newPath.push({\n                name: args.name,\n                element: parent_1\n              });\n            }\n            if (args.isPropagationStopped()) {\n              break;\n            }\n          }\n        }\n        return newPath;\n      };\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-statusbar__path'],\n          attributes: { role: 'navigation' }\n        },\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'flow',\n            selector: 'div[role=button]'\n          }),\n          Disabling.config({ disabled: providersBackstage.isDisabled }),\n          receivingConfig(),\n          Tabstopping.config({}),\n          Replacing.config({}),\n          config('elementPathEvents', [runOnAttached(function (comp, _e) {\n              editor.shortcuts.add('alt+F11', 'focus statusbar elementpath', function () {\n                return Keying.focusIn(comp);\n              });\n              editor.on('NodeChange', function (e) {\n                var newPath = updatePath(e.parents);\n                if (newPath.length > 0) {\n                  Replacing.set(comp, getDataPath(newPath));\n                } else {\n                  Replacing.set(comp, []);\n                }\n              });\n            })])\n        ]),\n        components: []\n      };\n    };\n\n    var ResizeTypes;\n    (function (ResizeTypes) {\n      ResizeTypes[ResizeTypes['None'] = 0] = 'None';\n      ResizeTypes[ResizeTypes['Both'] = 1] = 'Both';\n      ResizeTypes[ResizeTypes['Vertical'] = 2] = 'Vertical';\n    }(ResizeTypes || (ResizeTypes = {})));\n    var getDimensions = function (editor, deltas, resizeType, originalHeight, originalWidth) {\n      var dimensions = {};\n      dimensions.height = calcCappedSize(originalHeight + deltas.top, getMinHeightSetting(editor), getMaxHeightSetting(editor));\n      if (resizeType === ResizeTypes.Both) {\n        dimensions.width = calcCappedSize(originalWidth + deltas.left, getMinWidthSetting(editor), getMaxWidthSetting(editor));\n      }\n      return dimensions;\n    };\n    var resize = function (editor, deltas, resizeType) {\n      var container = SugarElement.fromDom(editor.getContainer());\n      var dimensions = getDimensions(editor, deltas, resizeType, get$b(container), get$a(container));\n      each(dimensions, function (val, dim) {\n        return set$7(container, dim, numToPx(val));\n      });\n      fireResizeEditor(editor);\n    };\n\n    var getResizeType = function (editor) {\n      var fallback = !editor.hasPlugin('autoresize');\n      var resize = editor.getParam('resize', fallback);\n      if (resize === false) {\n        return ResizeTypes.None;\n      } else if (resize === 'both') {\n        return ResizeTypes.Both;\n      } else {\n        return ResizeTypes.Vertical;\n      }\n    };\n    var keyboardHandler = function (editor, resizeType, x, y) {\n      var scale = 20;\n      var delta = SugarPosition(x * scale, y * scale);\n      resize(editor, delta, resizeType);\n      return Optional.some(true);\n    };\n    var renderResizeHandler = function (editor, providersBackstage) {\n      var resizeType = getResizeType(editor);\n      if (resizeType === ResizeTypes.None) {\n        return Optional.none();\n      }\n      return Optional.some(render$3('resize-handle', {\n        tag: 'div',\n        classes: ['tox-statusbar__resize-handle'],\n        attributes: { title: providersBackstage.translate('Resize') },\n        behaviours: [\n          Dragging.config({\n            mode: 'mouse',\n            repositionTarget: false,\n            onDrag: function (_comp, _target, delta) {\n              return resize(editor, delta, resizeType);\n            },\n            blockerClass: 'tox-blocker'\n          }),\n          Keying.config({\n            mode: 'special',\n            onLeft: function () {\n              return keyboardHandler(editor, resizeType, -1, 0);\n            },\n            onRight: function () {\n              return keyboardHandler(editor, resizeType, 1, 0);\n            },\n            onUp: function () {\n              return keyboardHandler(editor, resizeType, 0, -1);\n            },\n            onDown: function () {\n              return keyboardHandler(editor, resizeType, 0, 1);\n            }\n          }),\n          Tabstopping.config({}),\n          Focusing.config({})\n        ]\n      }, providersBackstage.icons));\n    };\n\n    var renderWordCount = function (editor, providersBackstage) {\n      var _a;\n      var replaceCountText = function (comp, count, mode) {\n        return Replacing.set(comp, [text(providersBackstage.translate([\n            '{0} ' + mode,\n            count[mode]\n          ]))]);\n      };\n      return Button.sketch({\n        dom: {\n          tag: 'button',\n          classes: ['tox-statusbar__wordcount']\n        },\n        components: [],\n        buttonBehaviours: derive$1([\n          DisablingConfigs.button(providersBackstage.isDisabled),\n          receivingConfig(),\n          Tabstopping.config({}),\n          Replacing.config({}),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: {\n                mode: 'words',\n                count: {\n                  words: 0,\n                  characters: 0\n                }\n              }\n            }\n          }),\n          config('wordcount-events', [\n            runOnExecute$1(function (comp) {\n              var currentVal = Representing.getValue(comp);\n              var newMode = currentVal.mode === 'words' ? 'characters' : 'words';\n              Representing.setValue(comp, {\n                mode: newMode,\n                count: currentVal.count\n              });\n              replaceCountText(comp, currentVal.count, newMode);\n            }),\n            runOnAttached(function (comp) {\n              editor.on('wordCountUpdate', function (e) {\n                var mode = Representing.getValue(comp).mode;\n                Representing.setValue(comp, {\n                  mode: mode,\n                  count: e.wordCount\n                });\n                replaceCountText(comp, e.wordCount, mode);\n              });\n            })\n          ])\n        ]),\n        eventOrder: (_a = {}, _a[execute$5()] = [\n          'disabling',\n          'alloy.base.behaviour',\n          'wordcount-events'\n        ], _a)\n      });\n    };\n\n    var renderStatusbar = function (editor, providersBackstage) {\n      var renderBranding = function () {\n        var label = global$e.translate([\n          'Powered by {0}',\n          'Tiny'\n        ]);\n        var linkHtml = '<a href=\"https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5\" rel=\"noopener\" target=\"_blank\" tabindex=\"-1\" aria-label=\"' + label + '\">' + label + '</a>';\n        return {\n          dom: {\n            tag: 'span',\n            classes: ['tox-statusbar__branding'],\n            innerHtml: linkHtml\n          }\n        };\n      };\n      var getTextComponents = function () {\n        var components = [];\n        if (editor.getParam('elementpath', true, 'boolean')) {\n          components.push(renderElementPath(editor, {}, providersBackstage));\n        }\n        if (editor.hasPlugin('wordcount')) {\n          components.push(renderWordCount(editor, providersBackstage));\n        }\n        if (editor.getParam('branding', true, 'boolean')) {\n          components.push(renderBranding());\n        }\n        if (components.length > 0) {\n          return [{\n              dom: {\n                tag: 'div',\n                classes: ['tox-statusbar__text-container']\n              },\n              components: components\n            }];\n        }\n        return [];\n      };\n      var getComponents = function () {\n        var components = getTextComponents();\n        var resizeHandler = renderResizeHandler(editor, providersBackstage);\n        return components.concat(resizeHandler.toArray());\n      };\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-statusbar']\n        },\n        components: getComponents()\n      };\n    };\n\n    var setup$3 = function (editor) {\n      var _a;\n      var isInline = editor.inline;\n      var mode = isInline ? Inline : Iframe;\n      var header = isStickyToolbar(editor) ? StickyHeader : StaticHeader;\n      var lazyOuterContainer = Optional.none();\n      var platform = detect$1();\n      var isIE = platform.browser.isIE();\n      var platformClasses = isIE ? ['tox-platform-ie'] : [];\n      var isTouch = platform.deviceType.isTouch();\n      var touchPlatformClass = 'tox-platform-touch';\n      var deviceClasses = isTouch ? [touchPlatformClass] : [];\n      var isToolbarBottom = isToolbarLocationBottom(editor);\n      var uiContainer = getUiContainer(editor);\n      var dirAttributes = global$e.isRtl() ? { attributes: { dir: 'rtl' } } : {};\n      var verticalDirAttributes = { attributes: (_a = {}, _a[Attribute] = isToolbarBottom ? AttributeValue.BottomToTop : AttributeValue.TopToBottom, _a) };\n      var lazyHeader = function () {\n        return lazyOuterContainer.bind(OuterContainer.getHeader);\n      };\n      var isHeaderDocked = function () {\n        return header.isDocked(lazyHeader);\n      };\n      var resizeUiMothership = function () {\n        set$7(uiMothership.element, 'width', document.body.clientWidth + 'px');\n      };\n      var makeSinkDefinition = function () {\n        var isGridUiContainer = eq(body(), uiContainer) && get$c(uiContainer, 'display') === 'grid';\n        var sinkSpec = {\n          dom: __assign({\n            tag: 'div',\n            classes: [\n              'tox',\n              'tox-silver-sink',\n              'tox-tinymce-aux'\n            ].concat(platformClasses).concat(deviceClasses)\n          }, dirAttributes),\n          behaviours: derive$1([Positioning.config({\n              useFixed: function () {\n                return isHeaderDocked();\n              }\n            })])\n        };\n        var reactiveWidthSpec = {\n          dom: { styles: { width: document.body.clientWidth + 'px' } },\n          events: derive$2([run$1(windowResize(), resizeUiMothership)])\n        };\n        return deepMerge(sinkSpec, isGridUiContainer ? reactiveWidthSpec : {});\n      };\n      var sink = build$1(makeSinkDefinition());\n      var lazySink = function () {\n        return Result.value(sink);\n      };\n      var memAnchorBar = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-anchorbar']\n        }\n      });\n      var lazyAnchorBar = function () {\n        return lazyOuterContainer.bind(function (container) {\n          return memAnchorBar.getOpt(container);\n        }).getOrDie('Could not find a anchor bar element');\n      };\n      var lazyToolbar = function () {\n        return lazyOuterContainer.bind(function (container) {\n          return OuterContainer.getToolbar(container);\n        }).getOrDie('Could not find more toolbar element');\n      };\n      var lazyThrobber = function () {\n        return lazyOuterContainer.bind(function (container) {\n          return OuterContainer.getThrobber(container);\n        }).getOrDie('Could not find throbber element');\n      };\n      var backstage = init$7(sink, editor, lazyAnchorBar);\n      var partMenubar = OuterContainer.parts.menubar({\n        dom: {\n          tag: 'div',\n          classes: ['tox-menubar']\n        },\n        backstage: backstage,\n        onEscape: function () {\n          editor.focus();\n        }\n      });\n      var toolbarMode = getToolbarMode(editor);\n      var partToolbar = OuterContainer.parts.toolbar(__assign({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar']\n        },\n        getSink: lazySink,\n        providers: backstage.shared.providers,\n        onEscape: function () {\n          editor.focus();\n        },\n        type: toolbarMode,\n        lazyToolbar: lazyToolbar,\n        lazyHeader: function () {\n          return lazyHeader().getOrDie('Could not find header element');\n        }\n      }, verticalDirAttributes));\n      var partMultipleToolbar = OuterContainer.parts['multiple-toolbar']({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar-overlord']\n        },\n        providers: backstage.shared.providers,\n        onEscape: function () {\n          editor.focus();\n        },\n        type: toolbarMode\n      });\n      var partSocket = OuterContainer.parts.socket({\n        dom: {\n          tag: 'div',\n          classes: ['tox-edit-area']\n        }\n      });\n      var partSidebar = OuterContainer.parts.sidebar({\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar']\n        }\n      });\n      var partThrobber = OuterContainer.parts.throbber({\n        dom: {\n          tag: 'div',\n          classes: ['tox-throbber']\n        },\n        backstage: backstage\n      });\n      var sb = editor.getParam('statusbar', true, 'boolean');\n      var statusbar = sb && !isInline ? Optional.some(renderStatusbar(editor, backstage.shared.providers)) : Optional.none();\n      var socketSidebarContainer = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar-wrap']\n        },\n        components: [\n          partSocket,\n          partSidebar\n        ]\n      };\n      var hasMultipleToolbar = isMultipleToolbars(editor);\n      var hasToolbar = isToolbarEnabled(editor);\n      var hasMenubar = isMenubarEnabled(editor);\n      var getPartToolbar = function () {\n        if (hasMultipleToolbar) {\n          return [partMultipleToolbar];\n        } else if (hasToolbar) {\n          return [partToolbar];\n        } else {\n          return [];\n        }\n      };\n      var partHeader = OuterContainer.parts.header({\n        dom: __assign({\n          tag: 'div',\n          classes: ['tox-editor-header']\n        }, verticalDirAttributes),\n        components: flatten([\n          hasMenubar ? [partMenubar] : [],\n          getPartToolbar(),\n          useFixedContainer(editor) ? [] : [memAnchorBar.asSpec()]\n        ]),\n        sticky: isStickyToolbar(editor),\n        editor: editor,\n        sharedBackstage: backstage.shared\n      });\n      var editorComponents = flatten([\n        isToolbarBottom ? [] : [partHeader],\n        isInline ? [] : [socketSidebarContainer],\n        isToolbarBottom ? [partHeader] : []\n      ]);\n      var editorContainer = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-editor-container']\n        },\n        components: editorComponents\n      };\n      var containerComponents = flatten([\n        [editorContainer],\n        isInline ? [] : statusbar.toArray(),\n        [partThrobber]\n      ]);\n      var isHidden = isDistractionFree(editor);\n      var attributes = __assign(__assign({ role: 'application' }, global$e.isRtl() ? { dir: 'rtl' } : {}), isHidden ? { 'aria-hidden': 'true' } : {});\n      var outerContainer = build$1(OuterContainer.sketch({\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox',\n            'tox-tinymce'\n          ].concat(isInline ? ['tox-tinymce-inline'] : []).concat(isToolbarBottom ? ['tox-tinymce--toolbar-bottom'] : []).concat(deviceClasses).concat(platformClasses),\n          styles: __assign({ visibility: 'hidden' }, isHidden ? {\n            opacity: '0',\n            border: '0'\n          } : {}),\n          attributes: attributes\n        },\n        components: containerComponents,\n        behaviours: derive$1([\n          receivingConfig(),\n          Disabling.config({ disableClass: 'tox-tinymce--disabled' }),\n          Keying.config({\n            mode: 'cyclic',\n            selector: '.tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle'\n          })\n        ])\n      }));\n      lazyOuterContainer = Optional.some(outerContainer);\n      editor.shortcuts.add('alt+F9', 'focus menubar', function () {\n        OuterContainer.focusMenubar(outerContainer);\n      });\n      editor.shortcuts.add('alt+F10', 'focus toolbar', function () {\n        OuterContainer.focusToolbar(outerContainer);\n      });\n      editor.addCommand('ToggleToolbarDrawer', function () {\n        OuterContainer.toggleToolbarDrawer(outerContainer);\n      });\n      editor.addQueryStateHandler('ToggleToolbarDrawer', function () {\n        return OuterContainer.isToolbarDrawerToggled(outerContainer);\n      });\n      var mothership = takeover(outerContainer);\n      var uiMothership = takeover(sink);\n      setup$b(editor, mothership, uiMothership);\n      var getUi = function () {\n        var channels = {\n          broadcastAll: uiMothership.broadcast,\n          broadcastOn: uiMothership.broadcastOn,\n          register: noop\n        };\n        return { channels: channels };\n      };\n      var setEditorSize = function () {\n        var parsedHeight = numToPx(getHeightWithFallback(editor));\n        var parsedWidth = numToPx(getWidthWithFallback(editor));\n        if (!editor.inline) {\n          if (isValidValue('div', 'width', parsedWidth)) {\n            set$7(outerContainer.element, 'width', parsedWidth);\n          }\n          if (isValidValue('div', 'height', parsedHeight)) {\n            set$7(outerContainer.element, 'height', parsedHeight);\n          } else {\n            set$7(outerContainer.element, 'height', '200px');\n          }\n        }\n        return parsedHeight;\n      };\n      var renderUI = function () {\n        header.setup(editor, backstage.shared, lazyHeader);\n        setup$6(editor, backstage);\n        setup$5(editor, lazySink, backstage);\n        setup$8(editor);\n        setup$7(editor, lazyThrobber, backstage.shared);\n        map$1(getToolbarGroups(editor), function (toolbarGroupButtonConfig, name) {\n          editor.ui.registry.addGroupToolbarButton(name, toolbarGroupButtonConfig);\n        });\n        var _a = editor.ui.registry.getAll(), buttons = _a.buttons, menuItems = _a.menuItems, contextToolbars = _a.contextToolbars, sidebars = _a.sidebars;\n        var toolbarOpt = getMultipleToolbarsSetting(editor);\n        var rawUiConfig = {\n          menuItems: menuItems,\n          menus: getMenus(editor),\n          menubar: getMenubar(editor),\n          toolbar: toolbarOpt.getOrThunk(function () {\n            return getToolbar(editor);\n          }),\n          allowToolbarGroups: toolbarMode === ToolbarMode.floating,\n          buttons: buttons,\n          sidebar: sidebars\n        };\n        register$7(editor, contextToolbars, sink, { backstage: backstage });\n        setup$4(editor, sink);\n        var elm = editor.getElement();\n        var height = setEditorSize();\n        var uiComponents = {\n          mothership: mothership,\n          uiMothership: uiMothership,\n          outerContainer: outerContainer\n        };\n        var args = {\n          targetNode: elm,\n          height: height\n        };\n        return mode.render(editor, uiComponents, rawUiConfig, backstage, args);\n      };\n      return {\n        mothership: mothership,\n        uiMothership: uiMothership,\n        backstage: backstage,\n        renderUI: renderUI,\n        getUi: getUi\n      };\n    };\n\n    var describedBy = function (describedElement, describeElement) {\n      var describeId = Optional.from(get$d(describedElement, 'id')).fold(function () {\n        var id = generate$6('dialog-describe');\n        set$8(describeElement, 'id', id);\n        return id;\n      }, identity$1);\n      set$8(describedElement, 'aria-describedby', describeId);\n    };\n\n    var labelledBy = function (labelledElement, labelElement) {\n      var labelId = getOpt(labelledElement, 'id').fold(function () {\n        var id = generate$6('dialog-label');\n        set$8(labelElement, 'id', id);\n        return id;\n      }, identity$1);\n      set$8(labelledElement, 'aria-labelledby', labelId);\n    };\n\n    var schema$2 = constant$1([\n      required$1('lazySink'),\n      option('dragBlockClass'),\n      defaultedFunction('getBounds', win),\n      defaulted('useTabstopAt', always),\n      defaulted('eventOrder', {}),\n      field('modalBehaviours', [Keying]),\n      onKeyboardHandler('onExecute'),\n      onStrictKeyboardHandler('onEscape')\n    ]);\n    var basic = { sketch: identity$1 };\n    var parts$2 = constant$1([\n      optional({\n        name: 'draghandle',\n        overrides: function (detail, spec) {\n          return {\n            behaviours: derive$1([Dragging.config({\n                mode: 'mouse',\n                getTarget: function (handle) {\n                  return ancestor(handle, '[role=\"dialog\"]').getOr(handle);\n                },\n                blockerClass: detail.dragBlockClass.getOrDie(new Error('The drag blocker class was not specified for a dialog with a drag handle: \\n' + JSON.stringify(spec, null, 2)).message),\n                getBounds: detail.getDragBounds\n              })])\n          };\n        }\n      }),\n      required({\n        schema: [required$1('dom')],\n        name: 'title'\n      }),\n      required({\n        factory: basic,\n        schema: [required$1('dom')],\n        name: 'close'\n      }),\n      required({\n        factory: basic,\n        schema: [required$1('dom')],\n        name: 'body'\n      }),\n      optional({\n        factory: basic,\n        schema: [required$1('dom')],\n        name: 'footer'\n      }),\n      external$1({\n        factory: {\n          sketch: function (spec, detail) {\n            return __assign(__assign({}, spec), {\n              dom: detail.dom,\n              components: detail.components\n            });\n          }\n        },\n        schema: [\n          defaulted('dom', {\n            tag: 'div',\n            styles: {\n              position: 'fixed',\n              left: '0px',\n              top: '0px',\n              right: '0px',\n              bottom: '0px'\n            }\n          }),\n          defaulted('components', [])\n        ],\n        name: 'blocker'\n      })\n    ]);\n\n    var factory$4 = function (detail, components, spec, externals) {\n      var _a;\n      var dialogComp = value$1();\n      var showDialog = function (dialog) {\n        dialogComp.set(dialog);\n        var sink = detail.lazySink(dialog).getOrDie();\n        var externalBlocker = externals.blocker();\n        var blocker = sink.getSystem().build(__assign(__assign({}, externalBlocker), {\n          components: externalBlocker.components.concat([premade(dialog)]),\n          behaviours: derive$1([\n            Focusing.config({}),\n            config('dialog-blocker-events', [runOnSource(focusin(), function () {\n                Keying.focusIn(dialog);\n              })])\n          ])\n        }));\n        attach(sink, blocker);\n        Keying.focusIn(dialog);\n      };\n      var hideDialog = function (dialog) {\n        dialogComp.clear();\n        parent(dialog.element).each(function (blockerDom) {\n          dialog.getSystem().getByDom(blockerDom).each(function (blocker) {\n            detach(blocker);\n          });\n        });\n      };\n      var getDialogBody = function (dialog) {\n        return getPartOrDie(dialog, detail, 'body');\n      };\n      var getDialogFooter = function (dialog) {\n        return getPartOrDie(dialog, detail, 'footer');\n      };\n      var setBusy = function (dialog, getBusySpec) {\n        Blocking.block(dialog, getBusySpec);\n      };\n      var setIdle = function (dialog) {\n        Blocking.unblock(dialog);\n      };\n      var modalEventsId = generate$6('modal-events');\n      var eventOrder = __assign(__assign({}, detail.eventOrder), (_a = {}, _a[attachedToDom()] = [modalEventsId].concat(detail.eventOrder['alloy.system.attached'] || []), _a));\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        apis: {\n          show: showDialog,\n          hide: hideDialog,\n          getBody: getDialogBody,\n          getFooter: getDialogFooter,\n          setIdle: setIdle,\n          setBusy: setBusy\n        },\n        eventOrder: eventOrder,\n        domModification: {\n          attributes: {\n            'role': 'dialog',\n            'aria-modal': 'true'\n          }\n        },\n        behaviours: augment(detail.modalBehaviours, [\n          Replacing.config({}),\n          Keying.config({\n            mode: 'cyclic',\n            onEnter: detail.onExecute,\n            onEscape: detail.onEscape,\n            useTabstopAt: detail.useTabstopAt\n          }),\n          Blocking.config({ getRoot: dialogComp.get }),\n          config(modalEventsId, [runOnAttached(function (c) {\n              labelledBy(c.element, getPartOrDie(c, detail, 'title').element);\n              describedBy(c.element, getPartOrDie(c, detail, 'body').element);\n            })])\n        ])\n      };\n    };\n    var ModalDialog = composite({\n      name: 'ModalDialog',\n      configFields: schema$2(),\n      partFields: parts$2(),\n      factory: factory$4,\n      apis: {\n        show: function (apis, dialog) {\n          apis.show(dialog);\n        },\n        hide: function (apis, dialog) {\n          apis.hide(dialog);\n        },\n        getBody: function (apis, dialog) {\n          return apis.getBody(dialog);\n        },\n        getFooter: function (apis, dialog) {\n          return apis.getFooter(dialog);\n        },\n        setBusy: function (apis, dialog, getBusySpec) {\n          apis.setBusy(dialog, getBusySpec);\n        },\n        setIdle: function (apis, dialog) {\n          apis.setIdle(dialog);\n        }\n      }\n    });\n\n    var dialogToggleMenuItemSchema = objOf([\n      requiredString('type'),\n      requiredString('name')\n    ].concat(commonMenuItemFields));\n    var dialogToggleMenuItemDataProcessor = boolean;\n\n    var baseFooterButtonFields = [\n      field$1('name', 'name', defaultedThunk(function () {\n        return generate$6('button-name');\n      }), string),\n      optionString('icon'),\n      defaultedStringEnum('align', 'end', [\n        'start',\n        'end'\n      ]),\n      defaultedBoolean('primary', false),\n      defaultedBoolean('disabled', false)\n    ];\n    var dialogFooterButtonFields = __spreadArray(__spreadArray([], baseFooterButtonFields, true), [requiredString('text')], false);\n    var normalFooterButtonFields = __spreadArray([requiredStringEnum('type', [\n        'submit',\n        'cancel',\n        'custom'\n      ])], dialogFooterButtonFields, true);\n    var menuFooterButtonFields = __spreadArray([\n      requiredStringEnum('type', ['menu']),\n      optionString('text'),\n      optionString('tooltip'),\n      optionString('icon'),\n      requiredArrayOf('items', dialogToggleMenuItemSchema)\n    ], baseFooterButtonFields, true);\n    var dialogFooterButtonSchema = choose$1('type', {\n      submit: normalFooterButtonFields,\n      cancel: normalFooterButtonFields,\n      custom: normalFooterButtonFields,\n      menu: menuFooterButtonFields\n    });\n\n    var alertBannerFields = [\n      requiredString('type'),\n      requiredString('text'),\n      requiredStringEnum('level', [\n        'info',\n        'warn',\n        'error',\n        'success'\n      ]),\n      requiredString('icon'),\n      defaulted('url', '')\n    ];\n    var alertBannerSchema = objOf(alertBannerFields);\n\n    var createBarFields = function (itemsField) {\n      return [\n        requiredString('type'),\n        itemsField\n      ];\n    };\n\n    var buttonFields = [\n      requiredString('type'),\n      requiredString('text'),\n      defaultedBoolean('disabled', false),\n      defaultedBoolean('primary', false),\n      field$1('name', 'name', defaultedThunk(function () {\n        return generate$6('button-name');\n      }), string),\n      optionString('icon'),\n      defaultedBoolean('borderless', false)\n    ];\n    var buttonSchema = objOf(buttonFields);\n\n    var checkboxFields = [\n      requiredString('type'),\n      requiredString('name'),\n      requiredString('label'),\n      defaultedBoolean('disabled', false)\n    ];\n    var checkboxSchema = objOf(checkboxFields);\n    var checkboxDataProcessor = boolean;\n\n    var formComponentFields = [\n      requiredString('type'),\n      requiredString('name')\n    ];\n    var formComponentWithLabelFields = formComponentFields.concat([optionString('label')]);\n\n    var collectionFields = formComponentWithLabelFields.concat([defaulted('columns', 'auto')]);\n    var collectionSchema = objOf(collectionFields);\n    var collectionDataProcessor = arrOfObj([\n      requiredString('value'),\n      requiredString('text'),\n      requiredString('icon')\n    ]);\n\n    var colorInputFields = formComponentWithLabelFields;\n    var colorInputSchema = objOf(colorInputFields);\n    var colorInputDataProcessor = string;\n\n    var colorPickerFields = formComponentWithLabelFields;\n    var colorPickerSchema = objOf(colorPickerFields);\n    var colorPickerDataProcessor = string;\n\n    var customEditorFields = formComponentFields.concat([\n      defaultedString('tag', 'textarea'),\n      requiredString('scriptId'),\n      requiredString('scriptUrl'),\n      defaultedPostMsg('settings', undefined)\n    ]);\n    var customEditorFieldsOld = formComponentFields.concat([\n      defaultedString('tag', 'textarea'),\n      requiredFunction('init')\n    ]);\n    var customEditorSchema = valueOf(function (v) {\n      return asRaw('customeditor.old', objOfOnly(customEditorFieldsOld), v).orThunk(function () {\n        return asRaw('customeditor.new', objOfOnly(customEditorFields), v);\n      });\n    });\n    var customEditorDataProcessor = string;\n\n    var dropZoneFields = formComponentWithLabelFields;\n    var dropZoneSchema = objOf(dropZoneFields);\n    var dropZoneDataProcessor = arrOfVal();\n\n    var createGridFields = function (itemsField) {\n      return [\n        requiredString('type'),\n        requiredNumber('columns'),\n        itemsField\n      ];\n    };\n\n    var htmlPanelFields = [\n      requiredString('type'),\n      requiredString('html'),\n      defaultedStringEnum('presets', 'presentation', [\n        'presentation',\n        'document'\n      ])\n    ];\n    var htmlPanelSchema = objOf(htmlPanelFields);\n\n    var iframeFields = formComponentWithLabelFields.concat([defaultedBoolean('sandboxed', true)]);\n    var iframeSchema = objOf(iframeFields);\n    var iframeDataProcessor = string;\n\n    var imageToolsFields = formComponentWithLabelFields.concat([requiredOf('currentState', objOf([\n        required$1('blob'),\n        requiredString('url')\n      ]))]);\n    var imageToolsSchema = objOf(imageToolsFields);\n\n    var inputFields = formComponentWithLabelFields.concat([\n      optionString('inputMode'),\n      optionString('placeholder'),\n      defaultedBoolean('maximized', false),\n      defaultedBoolean('disabled', false)\n    ]);\n    var inputSchema = objOf(inputFields);\n    var inputDataProcessor = string;\n\n    var createLabelFields = function (itemsField) {\n      return [\n        requiredString('type'),\n        requiredString('label'),\n        itemsField\n      ];\n    };\n\n    var listBoxSingleItemFields = [\n      requiredString('text'),\n      requiredString('value')\n    ];\n    var listBoxNestedItemFields = [\n      requiredString('text'),\n      requiredArrayOf('items', thunkOf('items', function () {\n        return listBoxItemSchema;\n      }))\n    ];\n    var listBoxItemSchema = oneOf([\n      objOf(listBoxSingleItemFields),\n      objOf(listBoxNestedItemFields)\n    ]);\n    var listBoxFields = formComponentWithLabelFields.concat([\n      requiredArrayOf('items', listBoxItemSchema),\n      defaultedBoolean('disabled', false)\n    ]);\n    var listBoxSchema = objOf(listBoxFields);\n    var listBoxDataProcessor = string;\n\n    var selectBoxFields = formComponentWithLabelFields.concat([\n      requiredArrayOfObj('items', [\n        requiredString('text'),\n        requiredString('value')\n      ]),\n      defaultedNumber('size', 1),\n      defaultedBoolean('disabled', false)\n    ]);\n    var selectBoxSchema = objOf(selectBoxFields);\n    var selectBoxDataProcessor = string;\n\n    var sizeInputFields = formComponentWithLabelFields.concat([\n      defaultedBoolean('constrain', true),\n      defaultedBoolean('disabled', false)\n    ]);\n    var sizeInputSchema = objOf(sizeInputFields);\n    var sizeInputDataProcessor = objOf([\n      requiredString('width'),\n      requiredString('height')\n    ]);\n\n    var tableFields = [\n      requiredString('type'),\n      requiredArrayOf('header', string),\n      requiredArrayOf('cells', arrOf(string))\n    ];\n    var tableSchema = objOf(tableFields);\n\n    var textAreaFields = formComponentWithLabelFields.concat([\n      optionString('placeholder'),\n      defaultedBoolean('maximized', false),\n      defaultedBoolean('disabled', false)\n    ]);\n    var textAreaSchema = objOf(textAreaFields);\n    var textAreaDataProcessor = string;\n\n    var urlInputFields = formComponentWithLabelFields.concat([\n      defaultedStringEnum('filetype', 'file', [\n        'image',\n        'media',\n        'file'\n      ]),\n      defaulted('disabled', false)\n    ]);\n    var urlInputSchema = objOf(urlInputFields);\n    var urlInputDataProcessor = objOf([\n      requiredString('value'),\n      defaulted('meta', {})\n    ]);\n\n    var createItemsField = function (name) {\n      return field$1('items', 'items', required$2(), arrOf(valueOf(function (v) {\n        return asRaw('Checking item of ' + name, itemSchema, v).fold(function (sErr) {\n          return Result.error(formatError(sErr));\n        }, function (passValue) {\n          return Result.value(passValue);\n        });\n      })));\n    };\n    var itemSchema = valueThunk(function () {\n      return choose$2('type', {\n        alertbanner: alertBannerSchema,\n        bar: objOf(createBarFields(createItemsField('bar'))),\n        button: buttonSchema,\n        checkbox: checkboxSchema,\n        colorinput: colorInputSchema,\n        colorpicker: colorPickerSchema,\n        dropzone: dropZoneSchema,\n        grid: objOf(createGridFields(createItemsField('grid'))),\n        iframe: iframeSchema,\n        input: inputSchema,\n        listbox: listBoxSchema,\n        selectbox: selectBoxSchema,\n        sizeinput: sizeInputSchema,\n        textarea: textAreaSchema,\n        urlinput: urlInputSchema,\n        customeditor: customEditorSchema,\n        htmlpanel: htmlPanelSchema,\n        imagetools: imageToolsSchema,\n        collection: collectionSchema,\n        label: objOf(createLabelFields(createItemsField('label'))),\n        table: tableSchema,\n        panel: panelSchema\n      });\n    });\n    var panelFields = [\n      requiredString('type'),\n      defaulted('classes', []),\n      requiredArrayOf('items', itemSchema)\n    ];\n    var panelSchema = objOf(panelFields);\n\n    var tabFields = [\n      field$1('name', 'name', defaultedThunk(function () {\n        return generate$6('tab-name');\n      }), string),\n      requiredString('title'),\n      requiredArrayOf('items', itemSchema)\n    ];\n    var tabPanelFields = [\n      requiredString('type'),\n      requiredArrayOfObj('tabs', tabFields)\n    ];\n    var tabPanelSchema = objOf(tabPanelFields);\n\n    var dialogButtonFields = dialogFooterButtonFields;\n    var dialogButtonSchema = dialogFooterButtonSchema;\n    var dialogSchema = objOf([\n      requiredString('title'),\n      requiredOf('body', choose$2('type', {\n        panel: panelSchema,\n        tabpanel: tabPanelSchema\n      })),\n      defaultedString('size', 'normal'),\n      requiredArrayOf('buttons', dialogButtonSchema),\n      defaulted('initialData', {}),\n      defaultedFunction('onAction', noop),\n      defaultedFunction('onChange', noop),\n      defaultedFunction('onSubmit', noop),\n      defaultedFunction('onClose', noop),\n      defaultedFunction('onCancel', noop),\n      defaulted('onTabChange', noop)\n    ]);\n    var createDialog = function (spec) {\n      return asRaw('dialog', dialogSchema, spec);\n    };\n\n    var urlDialogButtonSchema = objOf(__spreadArray([requiredStringEnum('type', [\n        'cancel',\n        'custom'\n      ])], dialogButtonFields, true));\n    var urlDialogSchema = objOf([\n      requiredString('title'),\n      requiredString('url'),\n      optionNumber('height'),\n      optionNumber('width'),\n      optionArrayOf('buttons', urlDialogButtonSchema),\n      defaultedFunction('onAction', noop),\n      defaultedFunction('onCancel', noop),\n      defaultedFunction('onClose', noop),\n      defaultedFunction('onMessage', noop)\n    ]);\n    var createUrlDialog = function (spec) {\n      return asRaw('dialog', urlDialogSchema, spec);\n    };\n\n    var getAllObjects = function (obj) {\n      if (isObject(obj)) {\n        return [obj].concat(bind$3(values(obj), getAllObjects));\n      } else if (isArray(obj)) {\n        return bind$3(obj, getAllObjects);\n      } else {\n        return [];\n      }\n    };\n\n    var isNamedItem = function (obj) {\n      return isString(obj.type) && isString(obj.name);\n    };\n    var dataProcessors = {\n      checkbox: checkboxDataProcessor,\n      colorinput: colorInputDataProcessor,\n      colorpicker: colorPickerDataProcessor,\n      dropzone: dropZoneDataProcessor,\n      input: inputDataProcessor,\n      iframe: iframeDataProcessor,\n      sizeinput: sizeInputDataProcessor,\n      selectbox: selectBoxDataProcessor,\n      listbox: listBoxDataProcessor,\n      size: sizeInputDataProcessor,\n      textarea: textAreaDataProcessor,\n      urlinput: urlInputDataProcessor,\n      customeditor: customEditorDataProcessor,\n      collection: collectionDataProcessor,\n      togglemenuitem: dialogToggleMenuItemDataProcessor\n    };\n    var getDataProcessor = function (item) {\n      return Optional.from(dataProcessors[item.type]);\n    };\n    var getNamedItems = function (structure) {\n      return filter$2(getAllObjects(structure), isNamedItem);\n    };\n\n    var createDataValidator = function (structure) {\n      var namedItems = getNamedItems(structure);\n      var fields = bind$3(namedItems, function (item) {\n        return getDataProcessor(item).fold(function () {\n          return [];\n        }, function (schema) {\n          return [requiredOf(item.name, schema)];\n        });\n      });\n      return objOf(fields);\n    };\n\n    var extract = function (structure) {\n      var internalDialog = getOrDie(createDialog(structure));\n      var dataValidator = createDataValidator(structure);\n      var initialData = structure.initialData;\n      return {\n        internalDialog: internalDialog,\n        dataValidator: dataValidator,\n        initialData: initialData\n      };\n    };\n    var DialogManager = {\n      open: function (factory, structure) {\n        var extraction = extract(structure);\n        return factory(extraction.internalDialog, extraction.initialData, extraction.dataValidator);\n      },\n      openUrl: function (factory, structure) {\n        var internalDialog = getOrDie(createUrlDialog(structure));\n        return factory(internalDialog);\n      },\n      redial: function (structure) {\n        return extract(structure);\n      }\n    };\n\n    var toValidValues = function (values) {\n      var errors = [];\n      var result = {};\n      each(values, function (value, name) {\n        value.fold(function () {\n          errors.push(name);\n        }, function (v) {\n          result[name] = v;\n        });\n      });\n      return errors.length > 0 ? Result.error(errors) : Result.value(result);\n    };\n\n    var renderBodyPanel = function (spec, backstage) {\n      var memForm = record(Form.sketch(function (parts) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-form'].concat(spec.classes)\n          },\n          components: map$2(spec.items, function (item) {\n            return interpretInForm(parts, item, backstage);\n          })\n        };\n      }));\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body']\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-content']\n            },\n            components: [memForm.asSpec()]\n          }],\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'acyclic',\n            useTabstopAt: not(isPseudoStop)\n          }),\n          ComposingConfigs.memento(memForm),\n          RepresentingConfigs.memento(memForm, {\n            postprocess: function (formValue) {\n              return toValidValues(formValue).fold(function (err) {\n                console.error(err);\n                return {};\n              }, identity$1);\n            }\n          })\n        ])\n      };\n    };\n\n    var factory$3 = function (detail, _spec) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: detail.components,\n        events: events$a(detail.action),\n        behaviours: augment(detail.tabButtonBehaviours, [\n          Focusing.config({}),\n          Keying.config({\n            mode: 'execution',\n            useSpace: true,\n            useEnter: true\n          }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.value\n            }\n          })\n        ]),\n        domModification: detail.domModification\n      };\n    };\n    var TabButton = single({\n      name: 'TabButton',\n      configFields: [\n        defaulted('uid', undefined),\n        required$1('value'),\n        field$1('dom', 'dom', mergeWithThunk(function () {\n          return {\n            attributes: {\n              'role': 'tab',\n              'id': generate$6('aria'),\n              'aria-selected': 'false'\n            }\n          };\n        }), anyValue()),\n        option('action'),\n        defaulted('domModification', {}),\n        field('tabButtonBehaviours', [\n          Focusing,\n          Keying,\n          Representing\n        ]),\n        required$1('view')\n      ],\n      factory: factory$3\n    });\n\n    var schema$1 = constant$1([\n      required$1('tabs'),\n      required$1('dom'),\n      defaulted('clickToDismiss', false),\n      field('tabbarBehaviours', [\n        Highlighting,\n        Keying\n      ]),\n      markers$1([\n        'tabClass',\n        'selectedClass'\n      ])\n    ]);\n    var tabsPart = group({\n      factory: TabButton,\n      name: 'tabs',\n      unit: 'tab',\n      overrides: function (barDetail) {\n        var dismissTab$1 = function (tabbar, button) {\n          Highlighting.dehighlight(tabbar, button);\n          emitWith(tabbar, dismissTab(), {\n            tabbar: tabbar,\n            button: button\n          });\n        };\n        var changeTab$1 = function (tabbar, button) {\n          Highlighting.highlight(tabbar, button);\n          emitWith(tabbar, changeTab(), {\n            tabbar: tabbar,\n            button: button\n          });\n        };\n        return {\n          action: function (button) {\n            var tabbar = button.getSystem().getByUid(barDetail.uid).getOrDie();\n            var activeButton = Highlighting.isHighlighted(tabbar, button);\n            var response = function () {\n              if (activeButton && barDetail.clickToDismiss) {\n                return dismissTab$1;\n              } else if (!activeButton) {\n                return changeTab$1;\n              } else {\n                return noop;\n              }\n            }();\n            response(tabbar, button);\n          },\n          domModification: { classes: [barDetail.markers.tabClass] }\n        };\n      }\n    });\n    var parts$1 = constant$1([tabsPart]);\n\n    var factory$2 = function (detail, components, _spec, _externals) {\n      return {\n        'uid': detail.uid,\n        'dom': detail.dom,\n        components: components,\n        'debug.sketcher': 'Tabbar',\n        'domModification': { attributes: { role: 'tablist' } },\n        'behaviours': augment(detail.tabbarBehaviours, [\n          Highlighting.config({\n            highlightClass: detail.markers.selectedClass,\n            itemClass: detail.markers.tabClass,\n            onHighlight: function (tabbar, tab) {\n              set$8(tab.element, 'aria-selected', 'true');\n            },\n            onDehighlight: function (tabbar, tab) {\n              set$8(tab.element, 'aria-selected', 'false');\n            }\n          }),\n          Keying.config({\n            mode: 'flow',\n            getInitial: function (tabbar) {\n              return Highlighting.getHighlighted(tabbar).map(function (tab) {\n                return tab.element;\n              });\n            },\n            selector: '.' + detail.markers.tabClass,\n            executeOnMove: true\n          })\n        ])\n      };\n    };\n    var Tabbar = composite({\n      name: 'Tabbar',\n      configFields: schema$1(),\n      partFields: parts$1(),\n      factory: factory$2\n    });\n\n    var factory$1 = function (detail, _spec) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        behaviours: augment(detail.tabviewBehaviours, [Replacing.config({})]),\n        domModification: { attributes: { role: 'tabpanel' } }\n      };\n    };\n    var Tabview = single({\n      name: 'Tabview',\n      configFields: [field('tabviewBehaviours', [Replacing])],\n      factory: factory$1\n    });\n\n    var schema = constant$1([\n      defaulted('selectFirst', true),\n      onHandler('onChangeTab'),\n      onHandler('onDismissTab'),\n      defaulted('tabs', []),\n      field('tabSectionBehaviours', [])\n    ]);\n    var barPart = required({\n      factory: Tabbar,\n      schema: [\n        required$1('dom'),\n        requiredObjOf('markers', [\n          required$1('tabClass'),\n          required$1('selectedClass')\n        ])\n      ],\n      name: 'tabbar',\n      defaults: function (detail) {\n        return { tabs: detail.tabs };\n      }\n    });\n    var viewPart = required({\n      factory: Tabview,\n      name: 'tabview'\n    });\n    var parts = constant$1([\n      barPart,\n      viewPart\n    ]);\n\n    var factory = function (detail, components, _spec, _externals) {\n      var changeTab$1 = function (button) {\n        var tabValue = Representing.getValue(button);\n        getPart(button, detail, 'tabview').each(function (tabview) {\n          var tabWithValue = find$5(detail.tabs, function (t) {\n            return t.value === tabValue;\n          });\n          tabWithValue.each(function (tabData) {\n            var panel = tabData.view();\n            getOpt(button.element, 'id').each(function (id) {\n              set$8(tabview.element, 'aria-labelledby', id);\n            });\n            Replacing.set(tabview, panel);\n            detail.onChangeTab(tabview, button, panel);\n          });\n        });\n      };\n      var changeTabBy = function (section, byPred) {\n        getPart(section, detail, 'tabbar').each(function (tabbar) {\n          byPred(tabbar).each(emitExecute);\n        });\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: get$2(detail.tabSectionBehaviours),\n        events: derive$2(flatten([\n          detail.selectFirst ? [runOnAttached(function (section, _simulatedEvent) {\n              changeTabBy(section, Highlighting.getFirst);\n            })] : [],\n          [\n            run$1(changeTab(), function (section, simulatedEvent) {\n              var button = simulatedEvent.event.button;\n              changeTab$1(button);\n            }),\n            run$1(dismissTab(), function (section, simulatedEvent) {\n              var button = simulatedEvent.event.button;\n              detail.onDismissTab(section, button);\n            })\n          ]\n        ])),\n        apis: {\n          getViewItems: function (section) {\n            return getPart(section, detail, 'tabview').map(function (tabview) {\n              return Replacing.contents(tabview);\n            }).getOr([]);\n          },\n          showTab: function (section, tabKey) {\n            var getTabIfNotActive = function (tabbar) {\n              var candidates = Highlighting.getCandidates(tabbar);\n              var optTab = find$5(candidates, function (c) {\n                return Representing.getValue(c) === tabKey;\n              });\n              return optTab.filter(function (tab) {\n                return !Highlighting.isHighlighted(tabbar, tab);\n              });\n            };\n            changeTabBy(section, getTabIfNotActive);\n          }\n        }\n      };\n    };\n    var TabSection = composite({\n      name: 'TabSection',\n      configFields: schema(),\n      partFields: parts(),\n      factory: factory,\n      apis: {\n        getViewItems: function (apis, component) {\n          return apis.getViewItems(component);\n        },\n        showTab: function (apis, component, tabKey) {\n          apis.showTab(component, tabKey);\n        }\n      }\n    });\n\n    var measureHeights = function (allTabs, tabview, tabviewComp) {\n      return map$2(allTabs, function (_tab, i) {\n        Replacing.set(tabviewComp, allTabs[i].view());\n        var rect = tabview.dom.getBoundingClientRect();\n        Replacing.set(tabviewComp, []);\n        return rect.height;\n      });\n    };\n    var getMaxHeight = function (heights) {\n      return head(sort(heights, function (a, b) {\n        if (a > b) {\n          return -1;\n        } else if (a < b) {\n          return +1;\n        } else {\n          return 0;\n        }\n      }));\n    };\n    var getMaxTabviewHeight = function (dialog, tabview, tablist) {\n      var documentElement$1 = documentElement(dialog).dom;\n      var rootElm = ancestor(dialog, '.tox-dialog-wrap').getOr(dialog);\n      var isFixed = get$c(rootElm, 'position') === 'fixed';\n      var maxHeight;\n      if (isFixed) {\n        maxHeight = Math.max(documentElement$1.clientHeight, window.innerHeight);\n      } else {\n        maxHeight = Math.max(documentElement$1.offsetHeight, documentElement$1.scrollHeight);\n      }\n      var tabviewHeight = get$b(tabview);\n      var isTabListBeside = tabview.dom.offsetLeft >= tablist.dom.offsetLeft + get$a(tablist);\n      var currentTabHeight = isTabListBeside ? Math.max(get$b(tablist), tabviewHeight) : tabviewHeight;\n      var dialogTopMargin = parseInt(get$c(dialog, 'margin-top'), 10) || 0;\n      var dialogBottomMargin = parseInt(get$c(dialog, 'margin-bottom'), 10) || 0;\n      var dialogHeight = get$b(dialog) + dialogTopMargin + dialogBottomMargin;\n      var chromeHeight = dialogHeight - currentTabHeight;\n      return maxHeight - chromeHeight;\n    };\n    var showTab = function (allTabs, comp) {\n      head(allTabs).each(function (tab) {\n        return TabSection.showTab(comp, tab.value);\n      });\n    };\n    var setTabviewHeight = function (tabview, height) {\n      set$7(tabview, 'height', height + 'px');\n      if (!detect$1().browser.isIE()) {\n        set$7(tabview, 'flex-basis', height + 'px');\n      } else {\n        remove$6(tabview, 'flex-basis');\n      }\n    };\n    var updateTabviewHeight = function (dialogBody, tabview, maxTabHeight) {\n      ancestor(dialogBody, '[role=\"dialog\"]').each(function (dialog) {\n        descendant(dialog, '[role=\"tablist\"]').each(function (tablist) {\n          maxTabHeight.get().map(function (height) {\n            set$7(tabview, 'height', '0');\n            set$7(tabview, 'flex-basis', '0');\n            return Math.min(height, getMaxTabviewHeight(dialog, tabview, tablist));\n          }).each(function (height) {\n            setTabviewHeight(tabview, height);\n          });\n        });\n      });\n    };\n    var getTabview = function (dialog) {\n      return descendant(dialog, '[role=\"tabpanel\"]');\n    };\n    var setMode = function (allTabs) {\n      var smartTabHeight = function () {\n        var maxTabHeight = value$1();\n        var extraEvents = [\n          runOnAttached(function (comp) {\n            var dialog = comp.element;\n            getTabview(dialog).each(function (tabview) {\n              set$7(tabview, 'visibility', 'hidden');\n              comp.getSystem().getByDom(tabview).toOptional().each(function (tabviewComp) {\n                var heights = measureHeights(allTabs, tabview, tabviewComp);\n                var maxTabHeightOpt = getMaxHeight(heights);\n                maxTabHeightOpt.fold(maxTabHeight.clear, maxTabHeight.set);\n              });\n              updateTabviewHeight(dialog, tabview, maxTabHeight);\n              remove$6(tabview, 'visibility');\n              showTab(allTabs, comp);\n              global$f.requestAnimationFrame(function () {\n                updateTabviewHeight(dialog, tabview, maxTabHeight);\n              });\n            });\n          }),\n          run$1(windowResize(), function (comp) {\n            var dialog = comp.element;\n            getTabview(dialog).each(function (tabview) {\n              updateTabviewHeight(dialog, tabview, maxTabHeight);\n            });\n          }),\n          run$1(formResizeEvent, function (comp, _se) {\n            var dialog = comp.element;\n            getTabview(dialog).each(function (tabview) {\n              var oldFocus = active(getRootNode(tabview));\n              set$7(tabview, 'visibility', 'hidden');\n              var oldHeight = getRaw(tabview, 'height').map(function (h) {\n                return parseInt(h, 10);\n              });\n              remove$6(tabview, 'height');\n              remove$6(tabview, 'flex-basis');\n              var newHeight = tabview.dom.getBoundingClientRect().height;\n              var hasGrown = oldHeight.forall(function (h) {\n                return newHeight > h;\n              });\n              if (hasGrown) {\n                maxTabHeight.set(newHeight);\n                updateTabviewHeight(dialog, tabview, maxTabHeight);\n              } else {\n                oldHeight.each(function (h) {\n                  setTabviewHeight(tabview, h);\n                });\n              }\n              remove$6(tabview, 'visibility');\n              oldFocus.each(focus$3);\n            });\n          })\n        ];\n        var selectFirst = false;\n        return {\n          extraEvents: extraEvents,\n          selectFirst: selectFirst\n        };\n      }();\n      var naiveTabHeight = function () {\n        var extraEvents = [];\n        var selectFirst = true;\n        return {\n          extraEvents: extraEvents,\n          selectFirst: selectFirst\n        };\n      }();\n      return {\n        smartTabHeight: smartTabHeight,\n        naiveTabHeight: naiveTabHeight\n      };\n    };\n\n    var SendDataToSectionChannel = 'send-data-to-section';\n    var SendDataToViewChannel = 'send-data-to-view';\n    var renderTabPanel = function (spec, backstage) {\n      var storedValue = Cell({});\n      var updateDataWithForm = function (form) {\n        var formData = Representing.getValue(form);\n        var validData = toValidValues(formData).getOr({});\n        var currentData = storedValue.get();\n        var newData = deepMerge(currentData, validData);\n        storedValue.set(newData);\n      };\n      var setDataOnForm = function (form) {\n        var tabData = storedValue.get();\n        Representing.setValue(form, tabData);\n      };\n      var oldTab = Cell(null);\n      var allTabs = map$2(spec.tabs, function (tab) {\n        return {\n          value: tab.name,\n          dom: {\n            tag: 'div',\n            classes: ['tox-dialog__body-nav-item'],\n            innerHtml: backstage.shared.providers.translate(tab.title)\n          },\n          view: function () {\n            return [Form.sketch(function (parts) {\n                return {\n                  dom: {\n                    tag: 'div',\n                    classes: ['tox-form']\n                  },\n                  components: map$2(tab.items, function (item) {\n                    return interpretInForm(parts, item, backstage);\n                  }),\n                  formBehaviours: derive$1([\n                    Keying.config({\n                      mode: 'acyclic',\n                      useTabstopAt: not(isPseudoStop)\n                    }),\n                    config('TabView.form.events', [\n                      runOnAttached(setDataOnForm),\n                      runOnDetached(updateDataWithForm)\n                    ]),\n                    Receiving.config({\n                      channels: wrapAll([\n                        {\n                          key: SendDataToSectionChannel,\n                          value: { onReceive: updateDataWithForm }\n                        },\n                        {\n                          key: SendDataToViewChannel,\n                          value: { onReceive: setDataOnForm }\n                        }\n                      ])\n                    })\n                  ])\n                };\n              })];\n          }\n        };\n      });\n      var tabMode = setMode(allTabs).smartTabHeight;\n      return TabSection.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body']\n        },\n        onChangeTab: function (section, button, _viewItems) {\n          var name = Representing.getValue(button);\n          emitWith(section, formTabChangeEvent, {\n            name: name,\n            oldName: oldTab.get()\n          });\n          oldTab.set(name);\n        },\n        tabs: allTabs,\n        components: [\n          TabSection.parts.tabbar({\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-nav']\n            },\n            components: [Tabbar.parts.tabs({})],\n            markers: {\n              tabClass: 'tox-tab',\n              selectedClass: 'tox-dialog__body-nav-item--active'\n            },\n            tabbarBehaviours: derive$1([Tabstopping.config({})])\n          }),\n          TabSection.parts.tabview({\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-content']\n            }\n          })\n        ],\n        selectFirst: tabMode.selectFirst,\n        tabSectionBehaviours: derive$1([\n          config('tabpanel', tabMode.extraEvents),\n          Keying.config({ mode: 'acyclic' }),\n          Composing.config({\n            find: function (comp) {\n              return head(TabSection.getViewItems(comp));\n            }\n          }),\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (tsection) {\n                tsection.getSystem().broadcastOn([SendDataToSectionChannel], {});\n                return storedValue.get();\n              },\n              setValue: function (tsection, value) {\n                storedValue.set(value);\n                tsection.getSystem().broadcastOn([SendDataToViewChannel], {});\n              }\n            }\n          })\n        ])\n      });\n    };\n\n    var dialogChannel = generate$6('update-dialog');\n    var titleChannel = generate$6('update-title');\n    var bodyChannel = generate$6('update-body');\n    var footerChannel = generate$6('update-footer');\n    var bodySendMessageChannel = generate$6('body-send-message');\n\n    var renderBody = function (spec, id, backstage, ariaAttrs) {\n      var renderComponents = function (incoming) {\n        switch (incoming.body.type) {\n        case 'tabpanel': {\n            return [renderTabPanel(incoming.body, backstage)];\n          }\n        default: {\n            return [renderBodyPanel(incoming.body, backstage)];\n          }\n        }\n      };\n      var updateState = function (_comp, incoming) {\n        return Optional.some({\n          isTabPanel: function () {\n            return incoming.body.type === 'tabpanel';\n          }\n        });\n      };\n      var ariaAttributes = { 'aria-live': 'polite' };\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__content-js'],\n          attributes: __assign(__assign({}, id.map(function (x) {\n            return { id: x };\n          }).getOr({})), ariaAttrs ? ariaAttributes : {})\n        },\n        components: [],\n        behaviours: derive$1([\n          ComposingConfigs.childAt(0),\n          Reflecting.config({\n            channel: bodyChannel,\n            updateState: updateState,\n            renderComponents: renderComponents,\n            initialData: spec\n          })\n        ])\n      };\n    };\n    var renderInlineBody = function (spec, contentId, backstage, ariaAttrs) {\n      return renderBody(spec, Optional.some(contentId), backstage, ariaAttrs);\n    };\n    var renderModalBody = function (spec, backstage) {\n      var bodySpec = renderBody(spec, Optional.none(), backstage, false);\n      return ModalDialog.parts.body(bodySpec);\n    };\n    var renderIframeBody = function (spec) {\n      var bodySpec = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__content-js']\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-iframe']\n            },\n            components: [craft({\n                dom: {\n                  tag: 'iframe',\n                  attributes: { src: spec.url }\n                },\n                behaviours: derive$1([\n                  Tabstopping.config({}),\n                  Focusing.config({})\n                ])\n              })]\n          }],\n        behaviours: derive$1([Keying.config({\n            mode: 'acyclic',\n            useTabstopAt: not(isPseudoStop)\n          })])\n      };\n      return ModalDialog.parts.body(bodySpec);\n    };\n\n    var isTouch = global$9.deviceType.isTouch();\n    var hiddenHeader = function (title, close) {\n      return {\n        dom: {\n          tag: 'div',\n          styles: { display: 'none' },\n          classes: ['tox-dialog__header']\n        },\n        components: [\n          title,\n          close\n        ]\n      };\n    };\n    var pClose = function (onClose, providersBackstage) {\n      return ModalDialog.parts.close(Button.sketch({\n        dom: {\n          tag: 'button',\n          classes: [\n            'tox-button',\n            'tox-button--icon',\n            'tox-button--naked'\n          ],\n          attributes: {\n            'type': 'button',\n            'aria-label': providersBackstage.translate('Close')\n          }\n        },\n        action: onClose,\n        buttonBehaviours: derive$1([Tabstopping.config({})])\n      }));\n    };\n    var pUntitled = function () {\n      return ModalDialog.parts.title({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__title'],\n          innerHtml: '',\n          styles: { display: 'none' }\n        }\n      });\n    };\n    var pBodyMessage = function (message, providersBackstage) {\n      return ModalDialog.parts.body({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body']\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-content']\n            },\n            components: [{ dom: fromHtml('<p>' + providersBackstage.translate(message) + '</p>') }]\n          }]\n      });\n    };\n    var pFooter = function (buttons) {\n      return ModalDialog.parts.footer({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__footer']\n        },\n        components: buttons\n      });\n    };\n    var pFooterGroup = function (startButtons, endButtons) {\n      return [\n        Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-dialog__footer-start']\n          },\n          components: startButtons\n        }),\n        Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-dialog__footer-end']\n          },\n          components: endButtons\n        })\n      ];\n    };\n    var renderDialog$1 = function (spec) {\n      var _a;\n      var dialogClass = 'tox-dialog';\n      var blockerClass = dialogClass + '-wrap';\n      var blockerBackdropClass = blockerClass + '__backdrop';\n      var scrollLockClass = dialogClass + '__disable-scroll';\n      return ModalDialog.sketch({\n        lazySink: spec.lazySink,\n        onEscape: function (comp) {\n          spec.onEscape(comp);\n          return Optional.some(true);\n        },\n        useTabstopAt: function (elem) {\n          return !isPseudoStop(elem);\n        },\n        dom: {\n          tag: 'div',\n          classes: [dialogClass].concat(spec.extraClasses),\n          styles: __assign({ position: 'relative' }, spec.extraStyles)\n        },\n        components: __spreadArray([\n          spec.header,\n          spec.body\n        ], spec.footer.toArray(), true),\n        parts: {\n          blocker: {\n            dom: fromHtml('<div class=\"' + blockerClass + '\"></div>'),\n            components: [{\n                dom: {\n                  tag: 'div',\n                  classes: isTouch ? [\n                    blockerBackdropClass,\n                    blockerBackdropClass + '--opaque'\n                  ] : [blockerBackdropClass]\n                }\n              }]\n          }\n        },\n        dragBlockClass: blockerClass,\n        modalBehaviours: derive$1(__spreadArray([\n          Focusing.config({}),\n          config('dialog-events', spec.dialogEvents.concat([runOnSource(focusin(), function (comp, _se) {\n              Keying.focusIn(comp);\n            })])),\n          config('scroll-lock', [\n            runOnAttached(function () {\n              add$2(body(), scrollLockClass);\n            }),\n            runOnDetached(function () {\n              remove$2(body(), scrollLockClass);\n            })\n          ])\n        ], spec.extraBehaviours, true)),\n        eventOrder: __assign((_a = {}, _a[execute$5()] = ['dialog-events'], _a[attachedToDom()] = [\n          'scroll-lock',\n          'dialog-events',\n          'alloy.base.behaviour'\n        ], _a[detachedFromDom()] = [\n          'alloy.base.behaviour',\n          'dialog-events',\n          'scroll-lock'\n        ], _a), spec.eventOrder)\n      });\n    };\n\n    var renderClose = function (providersBackstage) {\n      return Button.sketch({\n        dom: {\n          tag: 'button',\n          classes: [\n            'tox-button',\n            'tox-button--icon',\n            'tox-button--naked'\n          ],\n          attributes: {\n            'type': 'button',\n            'aria-label': providersBackstage.translate('Close'),\n            'title': providersBackstage.translate('Close')\n          }\n        },\n        components: [render$3('close', {\n            tag: 'div',\n            classes: ['tox-icon']\n          }, providersBackstage.icons)],\n        action: function (comp) {\n          emit(comp, formCancelEvent);\n        }\n      });\n    };\n    var renderTitle = function (spec, id, providersBackstage) {\n      var renderComponents = function (data) {\n        return [text(providersBackstage.translate(data.title))];\n      };\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__title'],\n          attributes: __assign({}, id.map(function (x) {\n            return { id: x };\n          }).getOr({}))\n        },\n        components: renderComponents(spec),\n        behaviours: derive$1([Reflecting.config({\n            channel: titleChannel,\n            renderComponents: renderComponents\n          })])\n      };\n    };\n    var renderDragHandle = function () {\n      return { dom: fromHtml('<div class=\"tox-dialog__draghandle\"></div>') };\n    };\n    var renderInlineHeader = function (spec, titleId, providersBackstage) {\n      return Container.sketch({\n        dom: fromHtml('<div class=\"tox-dialog__header\"></div>'),\n        components: [\n          renderTitle(spec, Optional.some(titleId), providersBackstage),\n          renderDragHandle(),\n          renderClose(providersBackstage)\n        ],\n        containerBehaviours: derive$1([Dragging.config({\n            mode: 'mouse',\n            blockerClass: 'blocker',\n            getTarget: function (handle) {\n              return closest$1(handle, '[role=\"dialog\"]').getOrDie();\n            },\n            snaps: {\n              getSnapPoints: function () {\n                return [];\n              },\n              leftAttr: 'data-drag-left',\n              topAttr: 'data-drag-top'\n            }\n          })])\n      });\n    };\n    var renderModalHeader = function (spec, providersBackstage) {\n      var pTitle = ModalDialog.parts.title(renderTitle(spec, Optional.none(), providersBackstage));\n      var pHandle = ModalDialog.parts.draghandle(renderDragHandle());\n      var pClose = ModalDialog.parts.close(renderClose(providersBackstage));\n      var components = [pTitle].concat(spec.draggable ? [pHandle] : []).concat([pClose]);\n      return Container.sketch({\n        dom: fromHtml('<div class=\"tox-dialog__header\"></div>'),\n        components: components\n      });\n    };\n\n    var getHeader = function (title, backstage) {\n      return renderModalHeader({\n        title: backstage.shared.providers.translate(title),\n        draggable: backstage.dialog.isDraggableModal()\n      }, backstage.shared.providers);\n    };\n    var getBusySpec = function (message, bs, providers) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__busy-spinner'],\n          attributes: { 'aria-label': providers.translate(message) },\n          styles: {\n            left: '0px',\n            right: '0px',\n            bottom: '0px',\n            top: '0px',\n            position: 'absolute'\n          }\n        },\n        behaviours: bs,\n        components: [{ dom: fromHtml('<div class=\"tox-spinner\"><div></div><div></div><div></div></div>') }]\n      };\n    };\n    var getEventExtras = function (lazyDialog, providers, extra) {\n      return {\n        onClose: function () {\n          return extra.closeWindow();\n        },\n        onBlock: function (blockEvent) {\n          ModalDialog.setBusy(lazyDialog(), function (_comp, bs) {\n            return getBusySpec(blockEvent.message, bs, providers);\n          });\n        },\n        onUnblock: function () {\n          ModalDialog.setIdle(lazyDialog());\n        }\n      };\n    };\n    var renderModalDialog = function (spec, initialData, dialogEvents, backstage) {\n      var _a;\n      var updateState = function (_comp, incoming) {\n        return Optional.some(incoming);\n      };\n      return build$1(renderDialog$1(__assign(__assign({}, spec), {\n        lazySink: backstage.shared.getSink,\n        extraBehaviours: __spreadArray([\n          Reflecting.config({\n            channel: dialogChannel,\n            updateState: updateState,\n            initialData: initialData\n          }),\n          RepresentingConfigs.memory({})\n        ], spec.extraBehaviours, true),\n        onEscape: function (comp) {\n          emit(comp, formCancelEvent);\n        },\n        dialogEvents: dialogEvents,\n        eventOrder: (_a = {}, _a[receive()] = [\n          Reflecting.name(),\n          Receiving.name()\n        ], _a[attachedToDom()] = [\n          'scroll-lock',\n          Reflecting.name(),\n          'messages',\n          'dialog-events',\n          'alloy.base.behaviour'\n        ], _a[detachedFromDom()] = [\n          'alloy.base.behaviour',\n          'dialog-events',\n          'messages',\n          Reflecting.name(),\n          'scroll-lock'\n        ], _a)\n      })));\n    };\n    var mapMenuButtons = function (buttons) {\n      var mapItems = function (button) {\n        var items = map$2(button.items, function (item) {\n          var cell = Cell(false);\n          return __assign(__assign({}, item), { storage: cell });\n        });\n        return __assign(__assign({}, button), { items: items });\n      };\n      return map$2(buttons, function (button) {\n        if (button.type === 'menu') {\n          return mapItems(button);\n        }\n        return button;\n      });\n    };\n    var extractCellsToObject = function (buttons) {\n      return foldl(buttons, function (acc, button) {\n        if (button.type === 'menu') {\n          var menuButton = button;\n          return foldl(menuButton.items, function (innerAcc, item) {\n            innerAcc[item.name] = item.storage;\n            return innerAcc;\n          }, acc);\n        }\n        return acc;\n      }, {});\n    };\n\n    var initCommonEvents = function (fireApiEvent, extras) {\n      return [\n        runWithTarget(focusin(), onFocus),\n        fireApiEvent(formCloseEvent, function (_api, spec) {\n          extras.onClose();\n          spec.onClose();\n        }),\n        fireApiEvent(formCancelEvent, function (api, spec, _event, self) {\n          spec.onCancel(api);\n          emit(self, formCloseEvent);\n        }),\n        run$1(formUnblockEvent, function (_c, _se) {\n          return extras.onUnblock();\n        }),\n        run$1(formBlockEvent, function (_c, se) {\n          return extras.onBlock(se.event);\n        })\n      ];\n    };\n    var initUrlDialog = function (getInstanceApi, extras) {\n      var fireApiEvent = function (eventName, f) {\n        return run$1(eventName, function (c, se) {\n          withSpec(c, function (spec, _c) {\n            f(getInstanceApi(), spec, se.event, c);\n          });\n        });\n      };\n      var withSpec = function (c, f) {\n        Reflecting.getState(c).get().each(function (currentDialog) {\n          f(currentDialog, c);\n        });\n      };\n      return __spreadArray(__spreadArray([], initCommonEvents(fireApiEvent, extras), true), [fireApiEvent(formActionEvent, function (api, spec, event) {\n          spec.onAction(api, { name: event.name });\n        })], false);\n    };\n    var initDialog = function (getInstanceApi, extras, getSink) {\n      var fireApiEvent = function (eventName, f) {\n        return run$1(eventName, function (c, se) {\n          withSpec(c, function (spec, _c) {\n            f(getInstanceApi(), spec, se.event, c);\n          });\n        });\n      };\n      var withSpec = function (c, f) {\n        Reflecting.getState(c).get().each(function (currentDialogInit) {\n          f(currentDialogInit.internalDialog, c);\n        });\n      };\n      return __spreadArray(__spreadArray([], initCommonEvents(fireApiEvent, extras), true), [\n        fireApiEvent(formSubmitEvent, function (api, spec) {\n          return spec.onSubmit(api);\n        }),\n        fireApiEvent(formChangeEvent, function (api, spec, event) {\n          spec.onChange(api, { name: event.name });\n        }),\n        fireApiEvent(formActionEvent, function (api, spec, event, component) {\n          var focusIn = function () {\n            return Keying.focusIn(component);\n          };\n          var isDisabled = function (focused) {\n            return has$1(focused, 'disabled') || getOpt(focused, 'aria-disabled').exists(function (val) {\n              return val === 'true';\n            });\n          };\n          var rootNode = getRootNode(component.element);\n          var current = active(rootNode);\n          spec.onAction(api, {\n            name: event.name,\n            value: event.value\n          });\n          active(rootNode).fold(focusIn, function (focused) {\n            if (isDisabled(focused)) {\n              focusIn();\n            } else if (current.exists(function (cur) {\n                return contains(focused, cur) && isDisabled(cur);\n              })) {\n              focusIn();\n            } else {\n              getSink().toOptional().filter(function (sink) {\n                return !contains(sink.element, focused);\n              }).each(focusIn);\n            }\n          });\n        }),\n        fireApiEvent(formTabChangeEvent, function (api, spec, event) {\n          spec.onTabChange(api, {\n            newTabName: event.name,\n            oldTabName: event.oldName\n          });\n        }),\n        runOnDetached(function (component) {\n          var api = getInstanceApi();\n          Representing.setValue(component, api.getData());\n        })\n      ], false);\n    };\n    var SilverDialogEvents = {\n      initUrlDialog: initUrlDialog,\n      initDialog: initDialog\n    };\n\n    var makeButton = function (button, backstage) {\n      return renderFooterButton(button, button.type, backstage);\n    };\n    var lookup = function (compInSystem, footerButtons, buttonName) {\n      return find$5(footerButtons, function (button) {\n        return button.name === buttonName;\n      }).bind(function (memButton) {\n        return memButton.memento.getOpt(compInSystem);\n      });\n    };\n    var renderComponents = function (_data, state) {\n      var footerButtons = state.map(function (s) {\n        return s.footerButtons;\n      }).getOr([]);\n      var buttonGroups = partition$3(footerButtons, function (button) {\n        return button.align === 'start';\n      });\n      var makeGroup = function (edge, buttons) {\n        return Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-dialog__footer-' + edge]\n          },\n          components: map$2(buttons, function (button) {\n            return button.memento.asSpec();\n          })\n        });\n      };\n      var startButtons = makeGroup('start', buttonGroups.pass);\n      var endButtons = makeGroup('end', buttonGroups.fail);\n      return [\n        startButtons,\n        endButtons\n      ];\n    };\n    var renderFooter = function (initSpec, backstage) {\n      var updateState = function (_comp, data) {\n        var footerButtons = map$2(data.buttons, function (button) {\n          var memButton = record(makeButton(button, backstage));\n          return {\n            name: button.name,\n            align: button.align,\n            memento: memButton\n          };\n        });\n        var lookupByName = function (compInSystem, buttonName) {\n          return lookup(compInSystem, footerButtons, buttonName);\n        };\n        return Optional.some({\n          lookupByName: lookupByName,\n          footerButtons: footerButtons\n        });\n      };\n      return {\n        dom: fromHtml('<div class=\"tox-dialog__footer\"></div>'),\n        components: [],\n        behaviours: derive$1([Reflecting.config({\n            channel: footerChannel,\n            initialData: initSpec,\n            updateState: updateState,\n            renderComponents: renderComponents\n          })])\n      };\n    };\n    var renderInlineFooter = function (initSpec, backstage) {\n      return renderFooter(initSpec, backstage);\n    };\n    var renderModalFooter = function (initSpec, backstage) {\n      return ModalDialog.parts.footer(renderFooter(initSpec, backstage));\n    };\n\n    var getCompByName = function (access, name) {\n      var root = access.getRoot();\n      if (root.getSystem().isConnected()) {\n        var form_1 = Composing.getCurrent(access.getFormWrapper()).getOr(access.getFormWrapper());\n        return Form.getField(form_1, name).fold(function () {\n          var footer = access.getFooter();\n          var footerState = Reflecting.getState(footer);\n          return footerState.get().bind(function (f) {\n            return f.lookupByName(form_1, name);\n          });\n        }, function (comp) {\n          return Optional.some(comp);\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n    var validateData$1 = function (access, data) {\n      var root = access.getRoot();\n      return Reflecting.getState(root).get().map(function (dialogState) {\n        return getOrDie(asRaw('data', dialogState.dataValidator, data));\n      }).getOr(data);\n    };\n    var getDialogApi = function (access, doRedial, menuItemStates) {\n      var withRoot = function (f) {\n        var root = access.getRoot();\n        if (root.getSystem().isConnected()) {\n          f(root);\n        }\n      };\n      var getData = function () {\n        var root = access.getRoot();\n        var valueComp = root.getSystem().isConnected() ? access.getFormWrapper() : root;\n        var representedValues = Representing.getValue(valueComp);\n        var menuItemCurrentState = map$1(menuItemStates, function (cell) {\n          return cell.get();\n        });\n        return __assign(__assign({}, representedValues), menuItemCurrentState);\n      };\n      var setData = function (newData) {\n        withRoot(function (_) {\n          var prevData = instanceApi.getData();\n          var mergedData = __assign(__assign({}, prevData), newData);\n          var newInternalData = validateData$1(access, mergedData);\n          var form = access.getFormWrapper();\n          Representing.setValue(form, newInternalData);\n          each(menuItemStates, function (v, k) {\n            if (has$2(mergedData, k)) {\n              v.set(mergedData[k]);\n            }\n          });\n        });\n      };\n      var disable = function (name) {\n        getCompByName(access, name).each(Disabling.disable);\n      };\n      var enable = function (name) {\n        getCompByName(access, name).each(Disabling.enable);\n      };\n      var focus = function (name) {\n        getCompByName(access, name).each(Focusing.focus);\n      };\n      var block = function (message) {\n        if (!isString(message)) {\n          throw new Error('The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument');\n        }\n        withRoot(function (root) {\n          emitWith(root, formBlockEvent, { message: message });\n        });\n      };\n      var unblock = function () {\n        withRoot(function (root) {\n          emit(root, formUnblockEvent);\n        });\n      };\n      var showTab = function (name) {\n        withRoot(function (_) {\n          var body = access.getBody();\n          var bodyState = Reflecting.getState(body);\n          if (bodyState.get().exists(function (b) {\n              return b.isTabPanel();\n            })) {\n            Composing.getCurrent(body).each(function (tabSection) {\n              TabSection.showTab(tabSection, name);\n            });\n          }\n        });\n      };\n      var redial = function (d) {\n        withRoot(function (root) {\n          var dialogInit = doRedial(d);\n          root.getSystem().broadcastOn([dialogChannel], dialogInit);\n          root.getSystem().broadcastOn([titleChannel], dialogInit.internalDialog);\n          root.getSystem().broadcastOn([bodyChannel], dialogInit.internalDialog);\n          root.getSystem().broadcastOn([footerChannel], dialogInit.internalDialog);\n          instanceApi.setData(dialogInit.initialData);\n        });\n      };\n      var close = function () {\n        withRoot(function (root) {\n          emit(root, formCloseEvent);\n        });\n      };\n      var instanceApi = {\n        getData: getData,\n        setData: setData,\n        disable: disable,\n        enable: enable,\n        focus: focus,\n        block: block,\n        unblock: unblock,\n        showTab: showTab,\n        redial: redial,\n        close: close\n      };\n      return instanceApi;\n    };\n\n    var getDialogSizeClasses = function (size) {\n      switch (size) {\n      case 'large':\n        return ['tox-dialog--width-lg'];\n      case 'medium':\n        return ['tox-dialog--width-md'];\n      default:\n        return [];\n      }\n    };\n    var renderDialog = function (dialogInit, extra, backstage) {\n      var header = getHeader(dialogInit.internalDialog.title, backstage);\n      var body = renderModalBody({ body: dialogInit.internalDialog.body }, backstage);\n      var storagedMenuButtons = mapMenuButtons(dialogInit.internalDialog.buttons);\n      var objOfCells = extractCellsToObject(storagedMenuButtons);\n      var footer = renderModalFooter({ buttons: storagedMenuButtons }, backstage);\n      var dialogEvents = SilverDialogEvents.initDialog(function () {\n        return instanceApi;\n      }, getEventExtras(function () {\n        return dialog;\n      }, backstage.shared.providers, extra), backstage.shared.getSink);\n      var dialogSize = getDialogSizeClasses(dialogInit.internalDialog.size);\n      var spec = {\n        header: header,\n        body: body,\n        footer: Optional.some(footer),\n        extraClasses: dialogSize,\n        extraBehaviours: [],\n        extraStyles: {}\n      };\n      var dialog = renderModalDialog(spec, dialogInit, dialogEvents, backstage);\n      var modalAccess = function () {\n        var getForm = function () {\n          var outerForm = ModalDialog.getBody(dialog);\n          return Composing.getCurrent(outerForm).getOr(outerForm);\n        };\n        return {\n          getRoot: constant$1(dialog),\n          getBody: function () {\n            return ModalDialog.getBody(dialog);\n          },\n          getFooter: function () {\n            return ModalDialog.getFooter(dialog);\n          },\n          getFormWrapper: getForm\n        };\n      }();\n      var instanceApi = getDialogApi(modalAccess, extra.redial, objOfCells);\n      return {\n        dialog: dialog,\n        instanceApi: instanceApi\n      };\n    };\n\n    var renderInlineDialog = function (dialogInit, extra, backstage, ariaAttrs) {\n      var _a, _b;\n      var dialogLabelId = generate$6('dialog-label');\n      var dialogContentId = generate$6('dialog-content');\n      var updateState = function (_comp, incoming) {\n        return Optional.some(incoming);\n      };\n      var memHeader = record(renderInlineHeader({\n        title: dialogInit.internalDialog.title,\n        draggable: true\n      }, dialogLabelId, backstage.shared.providers));\n      var memBody = record(renderInlineBody({ body: dialogInit.internalDialog.body }, dialogContentId, backstage, ariaAttrs));\n      var storagedMenuButtons = mapMenuButtons(dialogInit.internalDialog.buttons);\n      var objOfCells = extractCellsToObject(storagedMenuButtons);\n      var memFooter = record(renderInlineFooter({ buttons: storagedMenuButtons }, backstage));\n      var dialogEvents = SilverDialogEvents.initDialog(function () {\n        return instanceApi;\n      }, {\n        onBlock: function (event) {\n          Blocking.block(dialog, function (_comp, bs) {\n            return getBusySpec(event.message, bs, backstage.shared.providers);\n          });\n        },\n        onUnblock: function () {\n          Blocking.unblock(dialog);\n        },\n        onClose: function () {\n          return extra.closeWindow();\n        }\n      }, backstage.shared.getSink);\n      var dialog = build$1({\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-dialog',\n            'tox-dialog-inline'\n          ],\n          attributes: (_a = { role: 'dialog' }, _a['aria-labelledby'] = dialogLabelId, _a['aria-describedby'] = dialogContentId, _a)\n        },\n        eventOrder: (_b = {}, _b[receive()] = [\n          Reflecting.name(),\n          Receiving.name()\n        ], _b[execute$5()] = ['execute-on-form'], _b[attachedToDom()] = [\n          'reflecting',\n          'execute-on-form'\n        ], _b),\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'cyclic',\n            onEscape: function (c) {\n              emit(c, formCloseEvent);\n              return Optional.some(true);\n            },\n            useTabstopAt: function (elem) {\n              return !isPseudoStop(elem) && (name$2(elem) !== 'button' || get$d(elem, 'disabled') !== 'disabled');\n            }\n          }),\n          Reflecting.config({\n            channel: dialogChannel,\n            updateState: updateState,\n            initialData: dialogInit\n          }),\n          Focusing.config({}),\n          config('execute-on-form', dialogEvents.concat([runOnSource(focusin(), function (comp, _se) {\n              Keying.focusIn(comp);\n            })])),\n          Blocking.config({\n            getRoot: function () {\n              return Optional.some(dialog);\n            }\n          }),\n          Replacing.config({}),\n          RepresentingConfigs.memory({})\n        ]),\n        components: [\n          memHeader.asSpec(),\n          memBody.asSpec(),\n          memFooter.asSpec()\n        ]\n      });\n      var instanceApi = getDialogApi({\n        getRoot: constant$1(dialog),\n        getFooter: function () {\n          return memFooter.get(dialog);\n        },\n        getBody: function () {\n          return memBody.get(dialog);\n        },\n        getFormWrapper: function () {\n          var body = memBody.get(dialog);\n          return Composing.getCurrent(body).getOr(body);\n        }\n      }, extra.redial, objOfCells);\n      return {\n        dialog: dialog,\n        instanceApi: instanceApi\n      };\n    };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.URI');\n\n    var getUrlDialogApi = function (root) {\n      var withRoot = function (f) {\n        if (root.getSystem().isConnected()) {\n          f(root);\n        }\n      };\n      var block = function (message) {\n        if (!isString(message)) {\n          throw new Error('The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument');\n        }\n        withRoot(function (root) {\n          emitWith(root, formBlockEvent, { message: message });\n        });\n      };\n      var unblock = function () {\n        withRoot(function (root) {\n          emit(root, formUnblockEvent);\n        });\n      };\n      var close = function () {\n        withRoot(function (root) {\n          emit(root, formCloseEvent);\n        });\n      };\n      var sendMessage = function (data) {\n        withRoot(function (root) {\n          root.getSystem().broadcastOn([bodySendMessageChannel], data);\n        });\n      };\n      return {\n        block: block,\n        unblock: unblock,\n        close: close,\n        sendMessage: sendMessage\n      };\n    };\n\n    var SUPPORTED_MESSAGE_ACTIONS = [\n      'insertContent',\n      'setContent',\n      'execCommand',\n      'close',\n      'block',\n      'unblock'\n    ];\n    var isSupportedMessage = function (data) {\n      return isObject(data) && SUPPORTED_MESSAGE_ACTIONS.indexOf(data.mceAction) !== -1;\n    };\n    var isCustomMessage = function (data) {\n      return !isSupportedMessage(data) && isObject(data) && has$2(data, 'mceAction');\n    };\n    var handleMessage = function (editor, api, data) {\n      switch (data.mceAction) {\n      case 'insertContent':\n        editor.insertContent(data.content);\n        break;\n      case 'setContent':\n        editor.setContent(data.content);\n        break;\n      case 'execCommand':\n        var ui = isBoolean(data.ui) ? data.ui : false;\n        editor.execCommand(data.cmd, ui, data.value);\n        break;\n      case 'close':\n        api.close();\n        break;\n      case 'block':\n        api.block(data.message);\n        break;\n      case 'unblock':\n        api.unblock();\n        break;\n      }\n    };\n    var renderUrlDialog = function (internalDialog, extra, editor, backstage) {\n      var _a;\n      var header = getHeader(internalDialog.title, backstage);\n      var body = renderIframeBody(internalDialog);\n      var footer = internalDialog.buttons.bind(function (buttons) {\n        if (buttons.length === 0) {\n          return Optional.none();\n        } else {\n          return Optional.some(renderModalFooter({ buttons: buttons }, backstage));\n        }\n      });\n      var dialogEvents = SilverDialogEvents.initUrlDialog(function () {\n        return instanceApi;\n      }, getEventExtras(function () {\n        return dialog;\n      }, backstage.shared.providers, extra));\n      var styles = __assign(__assign({}, internalDialog.height.fold(function () {\n        return {};\n      }, function (height) {\n        return {\n          'height': height + 'px',\n          'max-height': height + 'px'\n        };\n      })), internalDialog.width.fold(function () {\n        return {};\n      }, function (width) {\n        return {\n          'width': width + 'px',\n          'max-width': width + 'px'\n        };\n      }));\n      var classes = internalDialog.width.isNone() && internalDialog.height.isNone() ? ['tox-dialog--width-lg'] : [];\n      var iframeUri = new global$1(internalDialog.url, { base_uri: new global$1(window.location.href) });\n      var iframeDomain = iframeUri.protocol + '://' + iframeUri.host + (iframeUri.port ? ':' + iframeUri.port : '');\n      var messageHandlerUnbinder = unbindable();\n      var extraBehaviours = [\n        config('messages', [\n          runOnAttached(function () {\n            var unbind = bind(SugarElement.fromDom(window), 'message', function (e) {\n              if (iframeUri.isSameOrigin(new global$1(e.raw.origin))) {\n                var data = e.raw.data;\n                if (isSupportedMessage(data)) {\n                  handleMessage(editor, instanceApi, data);\n                } else if (isCustomMessage(data)) {\n                  internalDialog.onMessage(instanceApi, data);\n                }\n              }\n            });\n            messageHandlerUnbinder.set(unbind);\n          }),\n          runOnDetached(messageHandlerUnbinder.clear)\n        ]),\n        Receiving.config({\n          channels: (_a = {}, _a[bodySendMessageChannel] = {\n            onReceive: function (comp, data) {\n              descendant(comp.element, 'iframe').each(function (iframeEle) {\n                var iframeWin = iframeEle.dom.contentWindow;\n                iframeWin.postMessage(data, iframeDomain);\n              });\n            }\n          }, _a)\n        })\n      ];\n      var spec = {\n        header: header,\n        body: body,\n        footer: footer,\n        extraClasses: classes,\n        extraBehaviours: extraBehaviours,\n        extraStyles: styles\n      };\n      var dialog = renderModalDialog(spec, internalDialog, dialogEvents, backstage);\n      var instanceApi = getUrlDialogApi(dialog);\n      return {\n        dialog: dialog,\n        instanceApi: instanceApi\n      };\n    };\n\n    var setup$2 = function (extras) {\n      var sharedBackstage = extras.backstage.shared;\n      var open = function (message, callback) {\n        var closeDialog = function () {\n          ModalDialog.hide(alertDialog);\n          callback();\n        };\n        var memFooterClose = record(renderFooterButton({\n          name: 'close-alert',\n          text: 'OK',\n          primary: true,\n          align: 'end',\n          disabled: false,\n          icon: Optional.none()\n        }, 'cancel', extras.backstage));\n        var titleSpec = pUntitled();\n        var closeSpec = pClose(closeDialog, sharedBackstage.providers);\n        var alertDialog = build$1(renderDialog$1({\n          lazySink: function () {\n            return sharedBackstage.getSink();\n          },\n          header: hiddenHeader(titleSpec, closeSpec),\n          body: pBodyMessage(message, sharedBackstage.providers),\n          footer: Optional.some(pFooter(pFooterGroup([], [memFooterClose.asSpec()]))),\n          onEscape: closeDialog,\n          extraClasses: ['tox-alert-dialog'],\n          extraBehaviours: [],\n          extraStyles: {},\n          dialogEvents: [run$1(formCancelEvent, closeDialog)],\n          eventOrder: {}\n        }));\n        ModalDialog.show(alertDialog);\n        var footerCloseButton = memFooterClose.get(alertDialog);\n        Focusing.focus(footerCloseButton);\n      };\n      return { open: open };\n    };\n\n    var setup$1 = function (extras) {\n      var sharedBackstage = extras.backstage.shared;\n      var open = function (message, callback) {\n        var closeDialog = function (state) {\n          ModalDialog.hide(confirmDialog);\n          callback(state);\n        };\n        var memFooterYes = record(renderFooterButton({\n          name: 'yes',\n          text: 'Yes',\n          primary: true,\n          align: 'end',\n          disabled: false,\n          icon: Optional.none()\n        }, 'submit', extras.backstage));\n        var footerNo = renderFooterButton({\n          name: 'no',\n          text: 'No',\n          primary: false,\n          align: 'end',\n          disabled: false,\n          icon: Optional.none()\n        }, 'cancel', extras.backstage);\n        var titleSpec = pUntitled();\n        var closeSpec = pClose(function () {\n          return closeDialog(false);\n        }, sharedBackstage.providers);\n        var confirmDialog = build$1(renderDialog$1({\n          lazySink: function () {\n            return sharedBackstage.getSink();\n          },\n          header: hiddenHeader(titleSpec, closeSpec),\n          body: pBodyMessage(message, sharedBackstage.providers),\n          footer: Optional.some(pFooter(pFooterGroup([], [\n            footerNo,\n            memFooterYes.asSpec()\n          ]))),\n          onEscape: function () {\n            return closeDialog(false);\n          },\n          extraClasses: ['tox-confirm-dialog'],\n          extraBehaviours: [],\n          extraStyles: {},\n          dialogEvents: [\n            run$1(formCancelEvent, function () {\n              return closeDialog(false);\n            }),\n            run$1(formSubmitEvent, function () {\n              return closeDialog(true);\n            })\n          ],\n          eventOrder: {}\n        }));\n        ModalDialog.show(confirmDialog);\n        var footerYesButton = memFooterYes.get(confirmDialog);\n        Focusing.focus(footerYesButton);\n      };\n      return { open: open };\n    };\n\n    var validateData = function (data, validator) {\n      return getOrDie(asRaw('data', validator, data));\n    };\n    var isAlertOrConfirmDialog = function (target) {\n      return closest(target, '.tox-alert-dialog') || closest(target, '.tox-confirm-dialog');\n    };\n    var inlineAdditionalBehaviours = function (editor, isStickyToolbar, isToolbarLocationTop) {\n      if (isStickyToolbar && isToolbarLocationTop) {\n        return [];\n      } else {\n        return [Docking.config({\n            contextual: {\n              lazyContext: function () {\n                return Optional.some(box$1(SugarElement.fromDom(editor.getContentAreaContainer())));\n              },\n              fadeInClass: 'tox-dialog-dock-fadein',\n              fadeOutClass: 'tox-dialog-dock-fadeout',\n              transitionClass: 'tox-dialog-dock-transition'\n            },\n            modes: ['top']\n          })];\n      }\n    };\n    var setup = function (extras) {\n      var backstage = extras.backstage;\n      var editor = extras.editor;\n      var isStickyToolbar$1 = isStickyToolbar(editor);\n      var alertDialog = setup$2(extras);\n      var confirmDialog = setup$1(extras);\n      var open = function (config, params, closeWindow) {\n        if (params !== undefined && params.inline === 'toolbar') {\n          return openInlineDialog(config, backstage.shared.anchors.inlineDialog(), closeWindow, params.ariaAttrs);\n        } else if (params !== undefined && params.inline === 'cursor') {\n          return openInlineDialog(config, backstage.shared.anchors.cursor(), closeWindow, params.ariaAttrs);\n        } else {\n          return openModalDialog(config, closeWindow);\n        }\n      };\n      var openUrl = function (config, closeWindow) {\n        return openModalUrlDialog(config, closeWindow);\n      };\n      var openModalUrlDialog = function (config, closeWindow) {\n        var factory = function (contents) {\n          var dialog = renderUrlDialog(contents, {\n            closeWindow: function () {\n              ModalDialog.hide(dialog.dialog);\n              closeWindow(dialog.instanceApi);\n            }\n          }, editor, backstage);\n          ModalDialog.show(dialog.dialog);\n          return dialog.instanceApi;\n        };\n        return DialogManager.openUrl(factory, config);\n      };\n      var openModalDialog = function (config, closeWindow) {\n        var factory = function (contents, internalInitialData, dataValidator) {\n          var initialData = internalInitialData;\n          var dialogInit = {\n            dataValidator: dataValidator,\n            initialData: initialData,\n            internalDialog: contents\n          };\n          var dialog = renderDialog(dialogInit, {\n            redial: DialogManager.redial,\n            closeWindow: function () {\n              ModalDialog.hide(dialog.dialog);\n              closeWindow(dialog.instanceApi);\n            }\n          }, backstage);\n          ModalDialog.show(dialog.dialog);\n          dialog.instanceApi.setData(initialData);\n          return dialog.instanceApi;\n        };\n        return DialogManager.open(factory, config);\n      };\n      var openInlineDialog = function (config$1, anchor, closeWindow, ariaAttrs) {\n        var factory = function (contents, internalInitialData, dataValidator) {\n          var initialData = validateData(internalInitialData, dataValidator);\n          var inlineDialog = value$1();\n          var isToolbarLocationTop = backstage.shared.header.isPositionedAtTop();\n          var dialogInit = {\n            dataValidator: dataValidator,\n            initialData: initialData,\n            internalDialog: contents\n          };\n          var refreshDocking = function () {\n            return inlineDialog.on(function (dialog) {\n              InlineView.reposition(dialog);\n              Docking.refresh(dialog);\n            });\n          };\n          var dialogUi = renderInlineDialog(dialogInit, {\n            redial: DialogManager.redial,\n            closeWindow: function () {\n              inlineDialog.on(InlineView.hide);\n              editor.off('ResizeEditor', refreshDocking);\n              inlineDialog.clear();\n              closeWindow(dialogUi.instanceApi);\n            }\n          }, backstage, ariaAttrs);\n          var inlineDialogComp = build$1(InlineView.sketch(__assign(__assign({\n            lazySink: backstage.shared.getSink,\n            dom: {\n              tag: 'div',\n              classes: []\n            },\n            fireDismissalEventInstead: {}\n          }, isToolbarLocationTop ? {} : { fireRepositionEventInstead: {} }), {\n            inlineBehaviours: derive$1(__spreadArray([config('window-manager-inline-events', [run$1(dismissRequested(), function (_comp, _se) {\n                  emit(dialogUi.dialog, formCancelEvent);\n                })])], inlineAdditionalBehaviours(editor, isStickyToolbar$1, isToolbarLocationTop), true)),\n            isExtraPart: function (_comp, target) {\n              return isAlertOrConfirmDialog(target);\n            }\n          })));\n          inlineDialog.set(inlineDialogComp);\n          InlineView.showWithin(inlineDialogComp, premade(dialogUi.dialog), { anchor: anchor }, Optional.some(body()));\n          if (!isStickyToolbar$1 || !isToolbarLocationTop) {\n            Docking.refresh(inlineDialogComp);\n            editor.on('ResizeEditor', refreshDocking);\n          }\n          dialogUi.instanceApi.setData(initialData);\n          Keying.focusIn(dialogUi.dialog);\n          return dialogUi.instanceApi;\n        };\n        return DialogManager.open(factory, config$1);\n      };\n      var confirm = function (message, callback) {\n        confirmDialog.open(message, function (state) {\n          callback(state);\n        });\n      };\n      var alert = function (message, callback) {\n        alertDialog.open(message, function () {\n          callback();\n        });\n      };\n      var close = function (instanceApi) {\n        instanceApi.close();\n      };\n      return {\n        open: open,\n        openUrl: openUrl,\n        alert: alert,\n        close: close,\n        confirm: confirm\n      };\n    };\n\n    function Theme () {\n      global$g.add('silver', function (editor) {\n        var _a = setup$3(editor), uiMothership = _a.uiMothership, backstage = _a.backstage, renderUI = _a.renderUI, getUi = _a.getUi;\n        Autocompleter.register(editor, backstage.shared);\n        var windowMgr = setup({\n          editor: editor,\n          backstage: backstage\n        });\n        return {\n          renderUI: renderUI,\n          getWindowManagerImpl: constant$1(windowMgr),\n          getNotificationManagerImpl: function () {\n            return NotificationManagerImpl(editor, { backstage: backstage }, uiMothership);\n          },\n          ui: getUi()\n        };\n      });\n    }\n\n    Theme();\n\n}());\n"]},"metadata":{},"sourceType":"script"}