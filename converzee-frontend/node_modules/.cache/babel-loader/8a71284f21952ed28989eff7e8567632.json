{"ast":null,"code":"import React,{Component}from\"react\";import SideBar from\"./SideBar\";import ToolUtil,{generateIframeContant,getDefaultItems}from\"../../../../utils/ToolUtil\";import Util,{generateFile,parseImgUrl}from\"../../../Util\";import Text from\"./Text\";import Script from\"./Script\";import{ToolLayout,ButtonsGroup}from\"../../../layout/ToolLayout\";import{getPath,GET_PIXEL,SAVE_TOOL,GET_ONE_TOOL}from\"../../../../actions/URLs\";import RequestHandler from\"../../../../actions/RequestHandler\";import{Modal}from\"antd\";import{LayoutSelector}from\"../../../layout/LayoutSelector\";import Code from\"./Code\";import{autoplayVideoModalResponse,autoplayVideoModal}from\"../../../utils/Modal\";import Preview from\"./Preview\";import{ReponsiveImage}from\"../../../comman/PreviewAble\";import Video from\"./Video\";import Image from\"../VideoPopup/Image\";import Icons from\"./Icons\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default class OptinForm extends Component{constructor(){super(...arguments);this.state={video:{url:\"\",videoType:\"youtube\"},toolName:\"\",toolId:\"\",preview:false,_id:null,activeTab:1,image:\"\",toolData:{text:'Click for sound'},STYLE:{elements:[{name:\"background\",text:\"Video Background\",color:\"\"}],switchElement:false,selected:0},CODE:{include:[{type:\"contains\",url:\"\"}],exclude:[{type:\"contains\",url:null}]},icons:\"/asset/play_icon.gif\"};this.loaded=false;this.onVideoChange=switchElement=>{this.setState({STYLE:{switchElement}});};this.onChangeActive=tabIndex=>{const{activeTab}=this.state;if(activeTab!==tabIndex){this.setState({activeTab:tabIndex});}};this.onUpdate=(index,data)=>{switch(index){case 1:this.setState({toolData:{text:data}});break;case 2:this.setState({video:data});break;case 3:this.setState({icons:data});break;case 5:this.setState({image:data});break;default:break;}};this.codeUpdate=data=>{this.setState({CODE:data});};this.renderMain=()=>{const{activeTab,toolData,CODE,video,STYLE,image,icons}=this.state;let component=null;if(!this.loaded)return null;switch(activeTab){case 1:component=/*#__PURE__*/_jsx(Video,{...video,onVideoChange:this.onVideoChange,switchElement:STYLE.switchElement,onChange:this.onUpdate});break;case 2:component=/*#__PURE__*/_jsx(Image,{image:image,case:5,onChange:this.onUpdate});break;case 3:component=/*#__PURE__*/_jsx(Icons,{icons:icons,case:3,onChange:this.onUpdate});break;case 4:component=/*#__PURE__*/_jsx(Text,{text:toolData.text,case:1,onChange:this.onUpdate});break;case 5:component=/*#__PURE__*/_jsx(Script,{});break;default:component=/*#__PURE__*/_jsx(Code,{...CODE,onChange:this.codeUpdate});break;}return component;};this.onClickSave=()=>{if(this.state.CODE.include[0].url!==\"\"){if(this.state.video.url!==\"\"){var pattern=new RegExp('^(https?:\\\\/\\\\/)?'+// protocol\n'((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|'+// domain name\n'((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))'+// OR ip (v4) address\n'(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*'+// port and path\n'(\\\\?[;&a-z\\\\d%_.~+=-]*)?'+// query string\n'(\\\\#[-a-z\\\\d_]*)?$','i');// fragment locator\nif(pattern.test(this.state.video.url)){RequestHandler.PostRequest(SAVE_TOOL,{toolData:autoplayVideoModal(this.state)},(res,err)=>{if(res){const data1=res.data;if(data1.success){if(data1.script){window.gs.setScript(data1.script);}else{Modal.success({content:data1.message});}setTimeout(()=>{this.props.history.push(\"/Campaigns\");},1000);}}});}else{Modal.warning({content:\"Video URL should be url.\"});}}else{Modal.warning({content:\"Please add video url.\"});}}else{Modal.warning({content:\"Should Contain atleast one trigger point\"});}};this.back=()=>{this.props.history.push(\"/Create\");};this.togglePreview=()=>{const{preview}=this.state;this.setState({preview:!preview});};this.renderRight=()=>{const{activeTab,image,video}=this.state;if(activeTab===1&&video.url)return/*#__PURE__*/_jsx(ReponsiveImage,{isVideo:true,url:video.url});if(activeTab===2&&image)return/*#__PURE__*/_jsx(ReponsiveImage,{isImg:true,url:\"https://d257yxqteot439.cloudfront.net/static/contains/\".concat(image)});return activeTab===5?null:/*#__PURE__*/_jsx(ReponsiveImage,{isAs:true,url:\"asset/video_pop_up.png\"});};}componentWillMount(){if(window.gs.ie){const ie=getDefaultItems(window.gs.ie);let{toolData}=this.state;this.state.toolData={...toolData,...ie};window.gs.ie=null;}}componentDidMount(){const id=this.props.match?this.props.match.params?this.props.match.params.id:null:null;if(id){RequestHandler.PostRequest(GET_ONE_TOOL+id,{},(res,err)=>{this.loaded=true;if(res){Util.isRedirected=true;const data=autoplayVideoModalResponse(res);if(data){this.setState(data,()=>{window.gs.navTitle(ToolUtil.getTool(data.toolId)+\"  \"+\"(\"+data.name+\")\");});}}});}else{let toolId=24;this.loaded=true;this.setState({toolId:toolId,toolName:ToolUtil.getTool(toolId),name:Util.CAMPAIGNS_NAME});Util.RedirectWhenCampaignEmpty(this.props);window.gs.navTitle(ToolUtil.getTool(toolId)+\"(\"+Util.CAMPAIGNS_NAME+\")\");}}render(){const{preview,video,toolData,activeTab}=this.state;return/*#__PURE__*/_jsxs(ToolLayout,{children:[preview?/*#__PURE__*/_jsx(Preview,{...this.state,onClose:this.togglePreview}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-10 toolItem\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:activeTab===5?\"col-md-12\":\"col-md-6\",children:this.renderMain()}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6 mt-2\",children:this.renderRight()}),/*#__PURE__*/_jsx(ButtonsGroup,{preview:video.url!=\"\"?()=>{this.setState({preview:!preview});}:null,backUrl:this.back,save:this.onClickSave})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-1 sideBarButtomPanel\",children:/*#__PURE__*/_jsx(SideBar,{layout:toolData.layout,activeTab:activeTab,onChangeActive:this.onChangeActive})})]})]});}}","map":{"version":3,"sources":["/opt/bitnami/apache/htdocs/converzee-frontend/src/components/pages/tools/AutoplayVideo/index.js"],"names":["React","Component","SideBar","ToolUtil","generateIframeContant","getDefaultItems","Util","generateFile","parseImgUrl","Text","Script","ToolLayout","ButtonsGroup","getPath","GET_PIXEL","SAVE_TOOL","GET_ONE_TOOL","RequestHandler","Modal","LayoutSelector","Code","autoplayVideoModalResponse","autoplayVideoModal","Preview","ReponsiveImage","Video","Image","Icons","OptinForm","state","video","url","videoType","toolName","toolId","preview","_id","activeTab","image","toolData","text","STYLE","elements","name","color","switchElement","selected","CODE","include","type","exclude","icons","loaded","onVideoChange","setState","onChangeActive","tabIndex","onUpdate","index","data","codeUpdate","renderMain","component","onClickSave","pattern","RegExp","test","PostRequest","res","err","data1","success","script","window","gs","setScript","content","message","setTimeout","props","history","push","warning","back","togglePreview","renderRight","componentWillMount","ie","componentDidMount","id","match","params","isRedirected","navTitle","getTool","CAMPAIGNS_NAME","RedirectWhenCampaignEmpty","render","layout"],"mappings":"AAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,MAAOC,CAAAA,QAAP,EAAmBC,qBAAnB,CAA0CC,eAA1C,KAAiE,4BAAjE,CACA,MAAOC,CAAAA,IAAP,EAAeC,YAAf,CAA6BC,WAA7B,KAAgD,eAAhD,CACA,MAAOC,CAAAA,IAAP,KAAiB,QAAjB,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,OAASC,UAAT,CAAqBC,YAArB,KAAyC,4BAAzC,CACA,OAASC,OAAT,CAAkBC,SAAlB,CAA6BC,SAA7B,CAAwCC,YAAxC,KAA4D,0BAA5D,CACA,MAAOC,CAAAA,cAAP,KAA2B,oCAA3B,CACA,OAASC,KAAT,KAAsB,MAAtB,CACA,OAASC,cAAT,KAA+B,gCAA/B,CACA,MAAOC,CAAAA,IAAP,KAAiB,QAAjB,CACA,OAASC,0BAAT,CAAqCC,kBAArC,KAA+D,sBAA/D,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,OAASC,cAAT,KAA+B,6BAA/B,CACA,MAAOC,CAAAA,KAAP,KAAkB,SAAlB,CACA,MAAOC,CAAAA,KAAP,KAAkB,qBAAlB,CACA,MAAOC,CAAAA,KAAP,KAAkB,SAAlB,C,wFAEA,cAAe,MAAMC,CAAAA,SAAN,QAAwB3B,CAAAA,SAAU,wCAC/C4B,KAD+C,CACvC,CACNC,KAAK,CAAE,CAAEC,GAAG,CAAE,EAAP,CAAWC,SAAS,CAAE,SAAtB,CADD,CAENC,QAAQ,CAAE,EAFJ,CAGNC,MAAM,CAAE,EAHF,CAINC,OAAO,CAAE,KAJH,CAKNC,GAAG,CAAE,IALC,CAMNC,SAAS,CAAE,CANL,CAONC,KAAK,CAAE,EAPD,CAQNC,QAAQ,CAAE,CACRC,IAAI,CAAE,iBADE,CARJ,CAWNC,KAAK,CAAE,CACHC,QAAQ,CAAE,CAAC,CAAEC,IAAI,CAAE,YAAR,CAAsBH,IAAI,CAAE,kBAA5B,CAAgDI,KAAK,CAAE,EAAvD,CAAD,CADP,CAEHC,aAAa,CAAE,KAFZ,CAGHC,QAAQ,CAAE,CAHP,CAXD,CAgBNC,IAAI,CAAE,CAAEC,OAAO,CAAE,CAAC,CAAEC,IAAI,CAAE,UAAR,CAAoBlB,GAAG,CAAE,EAAzB,CAAD,CAAX,CAA4CmB,OAAO,CAAE,CAAC,CAAED,IAAI,CAAE,UAAR,CAAoBlB,GAAG,CAAE,IAAzB,CAAD,CAArD,CAhBA,CAiBNoB,KAAK,CAAE,sBAjBD,CADuC,MAoB/CC,MApB+C,CAoBtC,KApBsC,MAuD/CC,aAvD+C,CAuD9BR,aAAD,EAAmB,CACjC,KAAKS,QAAL,CAAc,CAAEb,KAAK,CAAE,CAAEI,aAAF,CAAT,CAAd,EACD,CAzD8C,MA2D/CU,cA3D+C,CA2D7BC,QAAD,EAAc,CAC7B,KAAM,CAAEnB,SAAF,EAAgB,KAAKR,KAA3B,CACA,GAAIQ,SAAS,GAAKmB,QAAlB,CAA4B,CAC1B,KAAKF,QAAL,CAAc,CAAEjB,SAAS,CAAEmB,QAAb,CAAd,EACD,CACF,CAhE8C,MAkE7CC,QAlE6C,CAkElC,CAACC,KAAD,CAAQC,IAAR,GAAiB,CACxB,OAAQD,KAAR,EACA,IAAK,EAAL,CACI,KAAKJ,QAAL,CAAc,CAAEf,QAAQ,CAAG,CAAEC,IAAI,CAAEmB,IAAR,CAAb,CAAd,EACA,MACJ,IAAK,EAAL,CACI,KAAKL,QAAL,CAAc,CAAExB,KAAK,CAAE6B,IAAT,CAAd,EACA,MACJ,IAAK,EAAL,CACI,KAAKL,QAAL,CAAc,CAAEH,KAAK,CAAEQ,IAAT,CAAd,EACA,MACJ,IAAK,EAAL,CACI,KAAKL,QAAL,CAAc,CAAEhB,KAAK,CAAEqB,IAAT,CAAd,EACA,MACJ,QACI,MAdJ,CAgBH,CAnF4C,MAqF7CC,UArF6C,CAqF/BD,IAAD,EAAU,CACrB,KAAKL,QAAL,CAAc,CAAEP,IAAI,CAAEY,IAAR,CAAd,EACD,CAvF4C,MAyF/CE,UAzF+C,CAyFlC,IAAM,CACjB,KAAM,CAAExB,SAAF,CAAaE,QAAb,CAAuBQ,IAAvB,CAA6BjB,KAA7B,CAAoCW,KAApC,CAA2CH,KAA3C,CAAkDa,KAAlD,EAA4D,KAAKtB,KAAvE,CACA,GAAIiC,CAAAA,SAAS,CAAG,IAAhB,CACA,GAAI,CAAC,KAAKV,MAAV,CAAkB,MAAO,KAAP,CAClB,OAAQf,SAAR,EACI,IAAK,EAAL,CACIyB,SAAS,cAAG,KAAC,KAAD,KAAWhC,KAAX,CAAkB,aAAa,CAAE,KAAKuB,aAAtC,CAAqD,aAAa,CAAEZ,KAAK,CAACI,aAA1E,CAAyF,QAAQ,CAAE,KAAKY,QAAxG,EAAZ,CACA,MACJ,IAAK,EAAL,CACIK,SAAS,cAAG,KAAC,KAAD,EAAO,KAAK,CAAExB,KAAd,CAAqB,IAAI,CAAE,CAA3B,CAA8B,QAAQ,CAAE,KAAKmB,QAA7C,EAAZ,CACA,MACJ,IAAK,EAAL,CACIK,SAAS,cAAG,KAAC,KAAD,EAAO,KAAK,CAAEX,KAAd,CAAqB,IAAI,CAAE,CAA3B,CAA8B,QAAQ,CAAE,KAAKM,QAA7C,EAAZ,CACA,MACJ,IAAK,EAAL,CACIK,SAAS,cAAG,KAAC,IAAD,EAAM,IAAI,CAAEvB,QAAQ,CAACC,IAArB,CAA2B,IAAI,CAAE,CAAjC,CAAoC,QAAQ,CAAE,KAAKiB,QAAnD,EAAZ,CACA,MACJ,IAAK,EAAL,CACIK,SAAS,cAAG,KAAC,MAAD,IAAZ,CACA,MACJ,QACIA,SAAS,cAAG,KAAC,IAAD,KAAUf,IAAV,CAAgB,QAAQ,CAAE,KAAKa,UAA/B,EAAZ,CACA,MAlBR,CAoBA,MAAOE,CAAAA,SAAP,CACD,CAlH8C,MAoH/CC,WApH+C,CAoHjC,IAAM,CAClB,GAAI,KAAKlC,KAAL,CAAWkB,IAAX,CAAgBC,OAAhB,CAAwB,CAAxB,EAA2BjB,GAA3B,GAAmC,EAAvC,CAA2C,CACzC,GAAG,KAAKF,KAAL,CAAWC,KAAX,CAAiBC,GAAjB,GAAyB,EAA5B,CAAgC,CAC9B,GAAIiC,CAAAA,OAAO,CAAG,GAAIC,CAAAA,MAAJ,CAAW,oBAAqB;AAC5C,kDADuB,CAC6B;AACpD,6BAFuB,CAEQ;AAC/B,iCAHuB,CAGY;AACnC,0BAJuB,CAIK;AAC5B,oBALY,CAKS,GALT,CAAd,CAK6B;AAC7B,GAAGD,OAAO,CAACE,IAAR,CAAa,KAAKrC,KAAL,CAAWC,KAAX,CAAiBC,GAA9B,CAAH,CAAuC,CACrCd,cAAc,CAACkD,WAAf,CAA2BpD,SAA3B,CAAsC,CAAEwB,QAAQ,CAAEjB,kBAAkB,CAAC,KAAKO,KAAN,CAA9B,CAAtC,CAAoF,CAACuC,GAAD,CAAMC,GAAN,GAAc,CAChG,GAAID,GAAJ,CAAS,CACP,KAAME,CAAAA,KAAK,CAAGF,GAAG,CAACT,IAAlB,CACA,GAAIW,KAAK,CAACC,OAAV,CAAmB,CACjB,GAAID,KAAK,CAACE,MAAV,CAAkB,CAChBC,MAAM,CAACC,EAAP,CAAUC,SAAV,CAAoBL,KAAK,CAACE,MAA1B,EACD,CAFD,IAEO,CACLtD,KAAK,CAACqD,OAAN,CAAc,CACZK,OAAO,CAAEN,KAAK,CAACO,OADH,CAAd,EAGD,CACDC,UAAU,CAAC,IAAM,CACf,KAAKC,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,YAAxB,EACD,CAFS,CAEP,IAFO,CAAV,CAGD,CACF,CACF,CAhBD,EAiBD,CAlBD,IAkBO,CACL/D,KAAK,CAACgE,OAAN,CAAc,CACZN,OAAO,CAAE,0BADG,CAAd,EAGD,CACF,CA9BD,IA8BO,CACL1D,KAAK,CAACgE,OAAN,CAAc,CACZN,OAAO,CAAE,uBADG,CAAd,EAGD,CACF,CApCD,IAoCO,CACL1D,KAAK,CAACgE,OAAN,CAAc,CACZN,OAAO,CAAE,0CADG,CAAd,EAGD,CACF,CA9J8C,MAgK/CO,IAhK+C,CAgKxC,IAAM,CACX,KAAKJ,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,SAAxB,EACD,CAlK8C,MAoK/CG,aApK+C,CAoK/B,IAAM,CACpB,KAAM,CAAEjD,OAAF,EAAc,KAAKN,KAAzB,CACA,KAAKyB,QAAL,CAAc,CAAEnB,OAAO,CAAE,CAACA,OAAZ,CAAd,EACD,CAvK8C,MAyK/CkD,WAzK+C,CAyKjC,IAAM,CAClB,KAAM,CAAEhD,SAAF,CAAaC,KAAb,CAAoBR,KAApB,EAA8B,KAAKD,KAAzC,CACA,GAAIQ,SAAS,GAAK,CAAd,EAAmBP,KAAK,CAACC,GAA7B,CAAkC,mBAAO,KAAC,cAAD,EAAgB,OAAO,CAAE,IAAzB,CAA+B,GAAG,CAAED,KAAK,CAACC,GAA1C,EAAP,CAClC,GAAIM,SAAS,GAAK,CAAd,EAAmBC,KAAvB,CAA8B,mBAAO,KAAC,cAAD,EAAgB,KAAK,CAAE,IAAvB,CAA6B,GAAG,iEAA2DA,KAA3D,CAAhC,EAAP,CAC9B,MAAQD,CAAAA,SAAS,GAAK,CAAd,CAAkB,IAAlB,cAAyB,KAAC,cAAD,EAAgB,IAAI,CAAE,IAAtB,CAA4B,GAAG,CAAE,wBAAjC,EAAjC,CACD,CA9K8C,EAsB/CiD,kBAAkB,EAAG,CACnB,GAAIb,MAAM,CAACC,EAAP,CAAUa,EAAd,CAAkB,CAChB,KAAMA,CAAAA,EAAE,CAAGlF,eAAe,CAACoE,MAAM,CAACC,EAAP,CAAUa,EAAX,CAA1B,CACA,GAAI,CAAEhD,QAAF,EAAe,KAAKV,KAAxB,CACA,KAAKA,KAAL,CAAWU,QAAX,CAAsB,CAAE,GAAGA,QAAL,CAAe,GAAGgD,EAAlB,CAAtB,CACAd,MAAM,CAACC,EAAP,CAAUa,EAAV,CAAe,IAAf,CACD,CACF,CAEDC,iBAAiB,EAAG,CAClB,KAAMC,CAAAA,EAAE,CAAG,KAAKV,KAAL,CAAWW,KAAX,CAAoB,KAAKX,KAAL,CAAWW,KAAX,CAAiBC,MAAjB,CAA0B,KAAKZ,KAAL,CAAWW,KAAX,CAAiBC,MAAjB,CAAwBF,EAAlD,CAAuD,IAA3E,CAAmF,IAA9F,CACA,GAAIA,EAAJ,CAAQ,CACNxE,cAAc,CAACkD,WAAf,CAA2BnD,YAAY,CAAGyE,EAA1C,CAA8C,EAA9C,CAAkD,CAACrB,GAAD,CAAMC,GAAN,GAAc,CAC9D,KAAKjB,MAAL,CAAc,IAAd,CACA,GAAIgB,GAAJ,CAAS,CACP9D,IAAI,CAACsF,YAAL,CAAoB,IAApB,CACA,KAAMjC,CAAAA,IAAI,CAAGtC,0BAA0B,CAAC+C,GAAD,CAAvC,CACA,GAAIT,IAAJ,CAAU,CACR,KAAKL,QAAL,CAAcK,IAAd,CAAoB,IAAM,CACxBc,MAAM,CAACC,EAAP,CAAUmB,QAAV,CAAmB1F,QAAQ,CAAC2F,OAAT,CAAiBnC,IAAI,CAACzB,MAAtB,EAAgC,IAAhC,CAAuC,GAAvC,CAA6CyB,IAAI,CAAChB,IAAlD,CAAyD,GAA5E,EACD,CAFD,EAGD,CACF,CACF,CAXD,EAYD,CAbD,IAaO,CACL,GAAIT,CAAAA,MAAM,CAAG,EAAb,CAAiB,KAAKkB,MAAL,CAAc,IAAd,CACjB,KAAKE,QAAL,CAAc,CAAEpB,MAAM,CAAEA,MAAV,CAAkBD,QAAQ,CAAE9B,QAAQ,CAAC2F,OAAT,CAAiB5D,MAAjB,CAA5B,CAAsDS,IAAI,CAAErC,IAAI,CAACyF,cAAjE,CAAd,EACAzF,IAAI,CAAC0F,yBAAL,CAA+B,KAAKjB,KAApC,EACAN,MAAM,CAACC,EAAP,CAAUmB,QAAV,CAAmB1F,QAAQ,CAAC2F,OAAT,CAAiB5D,MAAjB,EAA2B,GAA3B,CAAiC5B,IAAI,CAACyF,cAAtC,CAAuD,GAA1E,EACD,CAEF,CA2HDE,MAAM,EAAG,CACP,KAAM,CAAE9D,OAAF,CAAWL,KAAX,CAAkBS,QAAlB,CAA4BF,SAA5B,EAA2C,KAAKR,KAAtD,CACA,mBACE,MAAC,UAAD,YACGM,OAAO,cAAG,KAAC,OAAD,KAAa,KAAKN,KAAlB,CAAyB,OAAO,CAAE,KAAKuD,aAAvC,EAAH,CAA8D,IADxE,cAEE,aAAK,SAAS,CAAC,KAAf,wBACE,YAAK,SAAS,CAAC,iBAAf,uBACE,aAAK,SAAS,CAAC,KAAf,wBACE,YAAK,SAAS,CAAE/C,SAAS,GAAK,CAAd,CAAkB,WAAlB,CAAgC,UAAhD,UAA6D,KAAKwB,UAAL,EAA7D,EADF,cAEE,YAAK,SAAS,CAAC,eAAf,UAAgC,KAAKwB,WAAL,EAAhC,EAFF,cAGE,KAAC,YAAD,EACC,OAAO,CAAGvD,KAAK,CAACC,GAAN,EAAW,EAAX,CAAgB,IAAM,CAC/B,KAAKuB,QAAL,CAAc,CAAEnB,OAAO,CAAE,CAACA,OAAZ,CAAd,EACD,CAFU,CAEP,IAHJ,CAIA,OAAO,CAAE,KAAKgD,IAJd,CAKA,IAAI,CAAE,KAAKpB,WALX,EAHF,GADF,EADF,cAcE,YAAK,SAAS,CAAC,0BAAf,uBACE,KAAC,OAAD,EAAS,MAAM,CAAExB,QAAQ,CAAC2D,MAA1B,CAAkC,SAAS,CAAE7D,SAA7C,CAAwD,cAAc,CAAE,KAAKkB,cAA7E,EADF,EAdF,GAFF,GADF,CAuBD,CAzM8C","sourcesContent":["import React, { Component } from \"react\";\r\nimport SideBar from \"./SideBar\";\r\nimport ToolUtil, { generateIframeContant, getDefaultItems } from \"../../../../utils/ToolUtil\";\r\nimport Util, { generateFile, parseImgUrl } from \"../../../Util\";\r\nimport Text from \"./Text\";\r\nimport Script from \"./Script\";\r\nimport { ToolLayout, ButtonsGroup } from \"../../../layout/ToolLayout\";\r\nimport { getPath, GET_PIXEL, SAVE_TOOL, GET_ONE_TOOL } from \"../../../../actions/URLs\";\r\nimport RequestHandler from \"../../../../actions/RequestHandler\";\r\nimport { Modal } from \"antd\";\r\nimport { LayoutSelector } from \"../../../layout/LayoutSelector\";\r\nimport Code from \"./Code\";\r\nimport { autoplayVideoModalResponse, autoplayVideoModal } from \"../../../utils/Modal\";\r\nimport Preview from \"./Preview\";\r\nimport { ReponsiveImage } from \"../../../comman/PreviewAble\";\r\nimport Video from \"./Video\";\r\nimport Image from \"../VideoPopup/Image\";\r\nimport Icons from \"./Icons\";\r\n\r\nexport default class OptinForm extends Component {\r\n  state = {\r\n    video: { url: \"\", videoType: \"youtube\" },\r\n    toolName: \"\",\r\n    toolId: \"\",\r\n    preview: false,\r\n    _id: null,\r\n    activeTab: 1,\r\n    image: \"\",\r\n    toolData: {\r\n      text: 'Click for sound',\r\n    },\r\n    STYLE: {\r\n        elements: [{ name: \"background\", text: \"Video Background\", color: \"\" }],\r\n        switchElement: false,\r\n        selected: 0,\r\n    },\r\n    CODE: { include: [{ type: \"contains\", url: \"\" }], exclude: [{ type: \"contains\", url: null }] },\r\n    icons: \"/asset/play_icon.gif\"\r\n  };\r\n  loaded = false;\r\n\r\n  componentWillMount() {\r\n    if (window.gs.ie) {\r\n      const ie = getDefaultItems(window.gs.ie);\r\n      let { toolData } = this.state;\r\n      this.state.toolData = { ...toolData, ...ie };\r\n      window.gs.ie = null;\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const id = this.props.match ? (this.props.match.params ? this.props.match.params.id : null) : null;\r\n    if (id) {\r\n      RequestHandler.PostRequest(GET_ONE_TOOL + id, {}, (res, err) => {\r\n        this.loaded = true;\r\n        if (res) {\r\n          Util.isRedirected = true;\r\n          const data = autoplayVideoModalResponse(res);\r\n          if (data) {\r\n            this.setState(data, () => {\r\n              window.gs.navTitle(ToolUtil.getTool(data.toolId) + \"  \" + \"(\" + data.name + \")\");\r\n            });\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      let toolId = 24; this.loaded = true;\r\n      this.setState({ toolId: toolId, toolName: ToolUtil.getTool(toolId), name: Util.CAMPAIGNS_NAME });\r\n      Util.RedirectWhenCampaignEmpty(this.props);\r\n      window.gs.navTitle(ToolUtil.getTool(toolId) + \"(\" + Util.CAMPAIGNS_NAME + \")\");\r\n    }\r\n\r\n  }\r\n\r\n  onVideoChange = (switchElement) => {\r\n    this.setState({ STYLE: { switchElement } });\r\n  };\r\n\r\n  onChangeActive = (tabIndex) => {\r\n    const { activeTab } = this.state;\r\n    if (activeTab !== tabIndex) {\r\n      this.setState({ activeTab: tabIndex });\r\n    }\r\n  };\r\n\r\n    onUpdate = (index, data) => {\r\n        switch (index) {\r\n        case 1:\r\n            this.setState({ toolData : { text: data} });\r\n            break;\r\n        case 2:\r\n            this.setState({ video: data });\r\n            break;\r\n        case 3:\r\n            this.setState({ icons: data });\r\n            break;\r\n        case 5:\r\n            this.setState({ image: data });\r\n            break;\r\n        default:\r\n            break;\r\n        }\r\n    };\r\n\r\n    codeUpdate = (data) => {\r\n      this.setState({ CODE: data });\r\n    }\r\n\r\n  renderMain = () => {\r\n    const { activeTab, toolData, CODE, video, STYLE, image, icons } = this.state;\r\n    let component = null;\r\n    if (!this.loaded) return null;\r\n    switch (activeTab) {\r\n        case 1:\r\n            component = <Video {...video} onVideoChange={this.onVideoChange} switchElement={STYLE.switchElement} onChange={this.onUpdate}/>;\r\n            break;\r\n        case 2:\r\n            component = <Image image={image} case={5} onChange={this.onUpdate} />;\r\n            break;\r\n        case 3:\r\n            component = <Icons icons={icons} case={3} onChange={this.onUpdate} />;\r\n            break;\r\n        case 4:\r\n            component = <Text text={toolData.text} case={1} onChange={this.onUpdate} />;\r\n            break;\r\n        case 5:\r\n            component = <Script />;\r\n            break;\r\n        default:\r\n            component = <Code {...CODE} onChange={this.codeUpdate} />\r\n            break;\r\n    }\r\n    return component;\r\n  };\r\n\r\n  onClickSave = () => {\r\n    if (this.state.CODE.include[0].url !== \"\") {\r\n      if(this.state.video.url !== \"\") {\r\n        var pattern = new RegExp('^(https?:\\\\/\\\\/)?'+ // protocol\r\n          '((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|'+ // domain name\r\n          '((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))'+ // OR ip (v4) address\r\n          '(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*'+ // port and path\r\n          '(\\\\?[;&a-z\\\\d%_.~+=-]*)?'+ // query string\r\n          '(\\\\#[-a-z\\\\d_]*)?$','i'); // fragment locator\r\n        if(pattern.test(this.state.video.url)) {\r\n          RequestHandler.PostRequest(SAVE_TOOL, { toolData: autoplayVideoModal(this.state) }, (res, err) => {\r\n            if (res) {\r\n              const data1 = res.data;\r\n              if (data1.success) {\r\n                if (data1.script) {\r\n                  window.gs.setScript(data1.script);\r\n                } else {\r\n                  Modal.success({\r\n                    content: data1.message,\r\n                  });\r\n                }\r\n                setTimeout(() => {\r\n                  this.props.history.push(\"/Campaigns\");\r\n                }, 1000);\r\n              }\r\n            }\r\n          });\r\n        } else {\r\n          Modal.warning({\r\n            content: \"Video URL should be url.\",\r\n          });\r\n        }\r\n      } else {\r\n        Modal.warning({\r\n          content: \"Please add video url.\",\r\n        });\r\n      }\r\n    } else {\r\n      Modal.warning({\r\n        content: \"Should Contain atleast one trigger point\",\r\n      });\r\n    }\r\n  };\r\n\r\n  back = () => {\r\n    this.props.history.push(\"/Create\");\r\n  };\r\n\r\n  togglePreview = () => {\r\n    const { preview } = this.state;\r\n    this.setState({ preview: !preview });\r\n  };\r\n\r\n  renderRight = () => {\r\n    const { activeTab, image, video } = this.state;\r\n    if (activeTab === 1 && video.url) return <ReponsiveImage isVideo={true} url={video.url} />;\r\n    if (activeTab === 2 && image) return <ReponsiveImage isImg={true} url={`https://d257yxqteot439.cloudfront.net/static/contains/${image}`} />;\r\n    return (activeTab === 5 ? null : <ReponsiveImage isAs={true} url={\"asset/video_pop_up.png\"} />);\r\n  };\r\n\r\n  render() {\r\n    const { preview, video, toolData, activeTab  } = this.state;\r\n    return (\r\n      <ToolLayout>\r\n        {preview ? <Preview {...this.state} onClose={this.togglePreview} /> : null}\r\n        <div className=\"row\">\r\n          <div className=\"col-10 toolItem\">\r\n            <div className=\"row\">\r\n              <div className={activeTab === 5 ? \"col-md-12\" : \"col-md-6\"}>{this.renderMain()}</div>\r\n              <div className=\"col-md-6 mt-2\">{this.renderRight()}</div>\r\n              <ButtonsGroup   \r\n               preview={ video.url!=\"\" ? () => {\r\n                this.setState({ preview: !preview });\r\n              } : null}\r\n              backUrl={this.back}\r\n              save={this.onClickSave} \r\n            />\r\n            </div>\r\n          </div>\r\n          <div className=\"col-1 sideBarButtomPanel\">\r\n            <SideBar layout={toolData.layout} activeTab={activeTab} onChangeActive={this.onChangeActive} />\r\n          </div>\r\n        </div>\r\n      </ToolLayout>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}