{"ast":null,"code":"(function webpackUniversalModuleDefinition(root, factory) {\n  if (typeof exports === 'object' && typeof module === 'object') module.exports = factory(require(\"jquery\"), require(\"react\"));else if (typeof define === 'function' && define.amd) define([\"jquery\", \"react\"], factory);else if (typeof exports === 'object') exports[\"ReactSummernote\"] = factory(require(\"jquery\"), require(\"react\"));else root[\"ReactSummernote\"] = factory(root[\"$\"], root[\"React\"]);\n})(this, function (__WEBPACK_EXTERNAL_MODULE_4__, __WEBPACK_EXTERNAL_MODULE_11__) {\n  return (\n    /******/\n    function (modules) {\n      // webpackBootstrap\n\n      /******/\n      // The module cache\n\n      /******/\n      var installedModules = {};\n      /******/\n\n      /******/\n      // The require function\n\n      /******/\n\n      function __webpack_require__(moduleId) {\n        /******/\n\n        /******/\n        // Check if module is in cache\n\n        /******/\n        if (installedModules[moduleId]) {\n          /******/\n          return installedModules[moduleId].exports;\n          /******/\n        }\n        /******/\n        // Create a new module (and put it into the cache)\n\n        /******/\n\n\n        var module = installedModules[moduleId] = {\n          /******/\n          i: moduleId,\n\n          /******/\n          l: false,\n\n          /******/\n          exports: {}\n          /******/\n\n        };\n        /******/\n\n        /******/\n        // Execute the module function\n\n        /******/\n\n        modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n        /******/\n\n        /******/\n        // Flag the module as loaded\n\n        /******/\n\n        module.l = true;\n        /******/\n\n        /******/\n        // Return the exports of the module\n\n        /******/\n\n        return module.exports;\n        /******/\n      }\n      /******/\n\n      /******/\n\n      /******/\n      // expose the modules object (__webpack_modules__)\n\n      /******/\n\n\n      __webpack_require__.m = modules;\n      /******/\n\n      /******/\n      // expose the module cache\n\n      /******/\n\n      __webpack_require__.c = installedModules;\n      /******/\n\n      /******/\n      // identity function for calling harmony imports with the correct context\n\n      /******/\n\n      __webpack_require__.i = function (value) {\n        return value;\n      };\n      /******/\n\n      /******/\n      // define getter function for harmony exports\n\n      /******/\n\n\n      __webpack_require__.d = function (exports, name, getter) {\n        /******/\n        if (!__webpack_require__.o(exports, name)) {\n          /******/\n          Object.defineProperty(exports, name, {\n            /******/\n            configurable: false,\n\n            /******/\n            enumerable: true,\n\n            /******/\n            get: getter\n            /******/\n\n          });\n          /******/\n        }\n        /******/\n\n      };\n      /******/\n\n      /******/\n      // getDefaultExport function for compatibility with non-harmony modules\n\n      /******/\n\n\n      __webpack_require__.n = function (module) {\n        /******/\n        var getter = module && module.__esModule ?\n        /******/\n        function getDefault() {\n          return module['default'];\n        } :\n        /******/\n        function getModuleExports() {\n          return module;\n        };\n        /******/\n\n        __webpack_require__.d(getter, 'a', getter);\n        /******/\n\n\n        return getter;\n        /******/\n      };\n      /******/\n\n      /******/\n      // Object.prototype.hasOwnProperty.call\n\n      /******/\n\n\n      __webpack_require__.o = function (object, property) {\n        return Object.prototype.hasOwnProperty.call(object, property);\n      };\n      /******/\n\n      /******/\n      // __webpack_public_path__\n\n      /******/\n\n\n      __webpack_require__.p = \"\";\n      /******/\n\n      /******/\n      // Load entry module and return exports\n\n      /******/\n\n      return __webpack_require__(__webpack_require__.s = 12);\n      /******/\n    }(\n    /************************************************************************/\n\n    /******/\n    [\n    /* 0 */\n\n    /***/\n    function (module, exports) {\n      // shim for using process in browser\n      var process = module.exports = {}; // cached from whatever global is present so that test runners that stub it\n      // don't break things.  But we need to wrap it in a try catch in case it is\n      // wrapped in strict mode code which doesn't define any globals.  It's inside a\n      // function because try/catches deoptimize in certain engines.\n\n      var cachedSetTimeout;\n      var cachedClearTimeout;\n\n      function defaultSetTimout() {\n        throw new Error('setTimeout has not been defined');\n      }\n\n      function defaultClearTimeout() {\n        throw new Error('clearTimeout has not been defined');\n      }\n\n      (function () {\n        try {\n          if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n          } else {\n            cachedSetTimeout = defaultSetTimout;\n          }\n        } catch (e) {\n          cachedSetTimeout = defaultSetTimout;\n        }\n\n        try {\n          if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n          } else {\n            cachedClearTimeout = defaultClearTimeout;\n          }\n        } catch (e) {\n          cachedClearTimeout = defaultClearTimeout;\n        }\n      })();\n\n      function runTimeout(fun) {\n        if (cachedSetTimeout === setTimeout) {\n          //normal enviroments in sane situations\n          return setTimeout(fun, 0);\n        } // if setTimeout wasn't available but was latter defined\n\n\n        if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n          cachedSetTimeout = setTimeout;\n          return setTimeout(fun, 0);\n        }\n\n        try {\n          // when when somebody has screwed with setTimeout but no I.E. maddness\n          return cachedSetTimeout(fun, 0);\n        } catch (e) {\n          try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n          } catch (e) {\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n          }\n        }\n      }\n\n      function runClearTimeout(marker) {\n        if (cachedClearTimeout === clearTimeout) {\n          //normal enviroments in sane situations\n          return clearTimeout(marker);\n        } // if clearTimeout wasn't available but was latter defined\n\n\n        if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n          cachedClearTimeout = clearTimeout;\n          return clearTimeout(marker);\n        }\n\n        try {\n          // when when somebody has screwed with setTimeout but no I.E. maddness\n          return cachedClearTimeout(marker);\n        } catch (e) {\n          try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n          } catch (e) {\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n          }\n        }\n      }\n\n      var queue = [];\n      var draining = false;\n      var currentQueue;\n      var queueIndex = -1;\n\n      function cleanUpNextTick() {\n        if (!draining || !currentQueue) {\n          return;\n        }\n\n        draining = false;\n\n        if (currentQueue.length) {\n          queue = currentQueue.concat(queue);\n        } else {\n          queueIndex = -1;\n        }\n\n        if (queue.length) {\n          drainQueue();\n        }\n      }\n\n      function drainQueue() {\n        if (draining) {\n          return;\n        }\n\n        var timeout = runTimeout(cleanUpNextTick);\n        draining = true;\n        var len = queue.length;\n\n        while (len) {\n          currentQueue = queue;\n          queue = [];\n\n          while (++queueIndex < len) {\n            if (currentQueue) {\n              currentQueue[queueIndex].run();\n            }\n          }\n\n          queueIndex = -1;\n          len = queue.length;\n        }\n\n        currentQueue = null;\n        draining = false;\n        runClearTimeout(timeout);\n      }\n\n      process.nextTick = function (fun) {\n        var args = new Array(arguments.length - 1);\n\n        if (arguments.length > 1) {\n          for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n          }\n        }\n\n        queue.push(new Item(fun, args));\n\n        if (queue.length === 1 && !draining) {\n          runTimeout(drainQueue);\n        }\n      }; // v8 likes predictible objects\n\n\n      function Item(fun, array) {\n        this.fun = fun;\n        this.array = array;\n      }\n\n      Item.prototype.run = function () {\n        this.fun.apply(null, this.array);\n      };\n\n      process.title = 'browser';\n      process.browser = true;\n      process.env = {};\n      process.argv = [];\n      process.version = ''; // empty string to avoid regexp issues\n\n      process.versions = {};\n\n      function noop() {}\n\n      process.on = noop;\n      process.addListener = noop;\n      process.once = noop;\n      process.off = noop;\n      process.removeListener = noop;\n      process.removeAllListeners = noop;\n      process.emit = noop;\n      process.prependListener = noop;\n      process.prependOnceListener = noop;\n\n      process.listeners = function (name) {\n        return [];\n      };\n\n      process.binding = function (name) {\n        throw new Error('process.binding is not supported');\n      };\n\n      process.cwd = function () {\n        return '/';\n      };\n\n      process.chdir = function (dir) {\n        throw new Error('process.chdir is not supported');\n      };\n\n      process.umask = function () {\n        return 0;\n      };\n      /***/\n\n    },\n    /* 1 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      \"use strict\";\n      /**\n       * Copyright (c) 2013-present, Facebook, Inc.\n       * All rights reserved.\n       *\n       * This source code is licensed under the BSD-style license found in the\n       * LICENSE file in the root directory of this source tree. An additional grant\n       * of patent rights can be found in the PATENTS file in the same directory.\n       *\n       * \n       */\n\n      function makeEmptyFunction(arg) {\n        return function () {\n          return arg;\n        };\n      }\n      /**\n       * This function accepts and discards inputs; it has no side effects. This is\n       * primarily useful idiomatically for overridable function endpoints which\n       * always need to be callable, since JS lacks a null-call idiom ala Cocoa.\n       */\n\n\n      var emptyFunction = function emptyFunction() {};\n\n      emptyFunction.thatReturns = makeEmptyFunction;\n      emptyFunction.thatReturnsFalse = makeEmptyFunction(false);\n      emptyFunction.thatReturnsTrue = makeEmptyFunction(true);\n      emptyFunction.thatReturnsNull = makeEmptyFunction(null);\n\n      emptyFunction.thatReturnsThis = function () {\n        return this;\n      };\n\n      emptyFunction.thatReturnsArgument = function (arg) {\n        return arg;\n      };\n\n      module.exports = emptyFunction;\n      /***/\n    },\n    /* 2 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      \"use strict\";\n      /* WEBPACK VAR INJECTION */\n\n      (function (process) {\n        /**\n        * Copyright (c) 2013-present, Facebook, Inc.\n        * All rights reserved.\n        *\n        * This source code is licensed under the BSD-style license found in the\n        * LICENSE file in the root directory of this source tree. An additional grant\n        * of patent rights can be found in the PATENTS file in the same directory.\n        *\n        */\n\n        /**\n         * Use invariant() to assert state which your program assumes to be true.\n         *\n         * Provide sprintf-style format (only %s is supported) and arguments\n         * to provide information about what broke and what you were\n         * expecting.\n         *\n         * The invariant message will be stripped in production, but the invariant\n         * will remain to ensure logic does not differ in production.\n         */\n        var validateFormat = function validateFormat(format) {};\n\n        if (process.env.NODE_ENV !== 'production') {\n          validateFormat = function validateFormat(format) {\n            if (format === undefined) {\n              throw new Error('invariant requires an error message argument');\n            }\n          };\n        }\n\n        function invariant(condition, format, a, b, c, d, e, f) {\n          validateFormat(format);\n\n          if (!condition) {\n            var error;\n\n            if (format === undefined) {\n              error = new Error('Minified exception occurred; use the non-minified dev environment ' + 'for the full error message and additional helpful warnings.');\n            } else {\n              var args = [a, b, c, d, e, f];\n              var argIndex = 0;\n              error = new Error(format.replace(/%s/g, function () {\n                return args[argIndex++];\n              }));\n              error.name = 'Invariant Violation';\n            }\n\n            error.framesToPop = 1; // we don't care about invariant's own frame\n\n            throw error;\n          }\n        }\n\n        module.exports = invariant;\n        /* WEBPACK VAR INJECTION */\n      }).call(exports, __webpack_require__(0));\n      /***/\n    },\n    /* 3 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      \"use strict\";\n      /**\n       * Copyright 2013-present, Facebook, Inc.\n       * All rights reserved.\n       *\n       * This source code is licensed under the BSD-style license found in the\n       * LICENSE file in the root directory of this source tree. An additional grant\n       * of patent rights can be found in the PATENTS file in the same directory.\n       */\n\n      var ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n      module.exports = ReactPropTypesSecret;\n      /***/\n    },\n    /* 4 */\n\n    /***/\n    function (module, exports) {\n      module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n      /***/\n    },\n    /* 5 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      // CodeMirror, copyright (c) by Marijn Haverbeke and others\n      // Distributed under an MIT license: http://codemirror.net/LICENSE\n      // This is CodeMirror (http://codemirror.net), a code editor\n      // implemented in JavaScript on top of the browser's DOM.\n      //\n      // You can find some technical background for some of the code below\n      // at http://marijnhaverbeke.nl/blog/#cm-internals .\n      (function (global, factory) {\n        true ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : global.CodeMirror = factory();\n      })(this, function () {\n        'use strict'; // Kludges for bugs and behavior differences that can't be feature\n        // detected are enabled based on userAgent etc sniffing.\n\n        var userAgent = navigator.userAgent;\n        var platform = navigator.platform;\n        var gecko = /gecko\\/\\d/i.test(userAgent);\n        var ie_upto10 = /MSIE \\d/.test(userAgent);\n        var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\n        var edge = /Edge\\/(\\d+)/.exec(userAgent);\n        var ie = ie_upto10 || ie_11up || edge;\n        var ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\n        var webkit = !edge && /WebKit\\//.test(userAgent);\n        var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\n        var chrome = !edge && /Chrome\\//.test(userAgent);\n        var presto = /Opera\\//.test(userAgent);\n        var safari = /Apple Computer/.test(navigator.vendor);\n        var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\n        var phantom = /PhantomJS/.test(userAgent);\n        var ios = !edge && /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent);\n        var android = /Android/.test(userAgent); // This is woefully incomplete. Suggestions for alternative methods welcome.\n\n        var mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\n        var mac = ios || /Mac/.test(platform);\n        var chromeOS = /\\bCrOS\\b/.test(userAgent);\n        var windows = /win/i.test(platform);\n        var presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\n\n        if (presto_version) {\n          presto_version = Number(presto_version[1]);\n        }\n\n        if (presto_version && presto_version >= 15) {\n          presto = false;\n          webkit = true;\n        } // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\n\n\n        var flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\n        var captureRightClick = gecko || ie && ie_version >= 9;\n\n        function classTest(cls) {\n          return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\");\n        }\n\n        var rmClass = function (node, cls) {\n          var current = node.className;\n          var match = classTest(cls).exec(current);\n\n          if (match) {\n            var after = current.slice(match.index + match[0].length);\n            node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n          }\n        };\n\n        function removeChildren(e) {\n          for (var count = e.childNodes.length; count > 0; --count) {\n            e.removeChild(e.firstChild);\n          }\n\n          return e;\n        }\n\n        function removeChildrenAndAdd(parent, e) {\n          return removeChildren(parent).appendChild(e);\n        }\n\n        function elt(tag, content, className, style) {\n          var e = document.createElement(tag);\n\n          if (className) {\n            e.className = className;\n          }\n\n          if (style) {\n            e.style.cssText = style;\n          }\n\n          if (typeof content == \"string\") {\n            e.appendChild(document.createTextNode(content));\n          } else if (content) {\n            for (var i = 0; i < content.length; ++i) {\n              e.appendChild(content[i]);\n            }\n          }\n\n          return e;\n        } // wrapper for elt, which removes the elt from the accessibility tree\n\n\n        function eltP(tag, content, className, style) {\n          var e = elt(tag, content, className, style);\n          e.setAttribute(\"role\", \"presentation\");\n          return e;\n        }\n\n        var range;\n\n        if (document.createRange) {\n          range = function (node, start, end, endNode) {\n            var r = document.createRange();\n            r.setEnd(endNode || node, end);\n            r.setStart(node, start);\n            return r;\n          };\n        } else {\n          range = function (node, start, end) {\n            var r = document.body.createTextRange();\n\n            try {\n              r.moveToElementText(node.parentNode);\n            } catch (e) {\n              return r;\n            }\n\n            r.collapse(true);\n            r.moveEnd(\"character\", end);\n            r.moveStart(\"character\", start);\n            return r;\n          };\n        }\n\n        function contains(parent, child) {\n          if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n            {\n              child = child.parentNode;\n            }\n\n          if (parent.contains) {\n            return parent.contains(child);\n          }\n\n          do {\n            if (child.nodeType == 11) {\n              child = child.host;\n            }\n\n            if (child == parent) {\n              return true;\n            }\n          } while (child = child.parentNode);\n        }\n\n        function activeElt() {\n          // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n          // IE < 10 will throw when accessed while the page is loading or in an iframe.\n          // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n          var activeElement;\n\n          try {\n            activeElement = document.activeElement;\n          } catch (e) {\n            activeElement = document.body || null;\n          }\n\n          while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement) {\n            activeElement = activeElement.shadowRoot.activeElement;\n          }\n\n          return activeElement;\n        }\n\n        function addClass(node, cls) {\n          var current = node.className;\n\n          if (!classTest(cls).test(current)) {\n            node.className += (current ? \" \" : \"\") + cls;\n          }\n        }\n\n        function joinClasses(a, b) {\n          var as = a.split(\" \");\n\n          for (var i = 0; i < as.length; i++) {\n            if (as[i] && !classTest(as[i]).test(b)) {\n              b += \" \" + as[i];\n            }\n          }\n\n          return b;\n        }\n\n        var selectInput = function (node) {\n          node.select();\n        };\n\n        if (ios) // Mobile Safari apparently has a bug where select() is broken.\n          {\n            selectInput = function (node) {\n              node.selectionStart = 0;\n              node.selectionEnd = node.value.length;\n            };\n          } else if (ie) // Suppress mysterious IE10 errors\n          {\n            selectInput = function (node) {\n              try {\n                node.select();\n              } catch (_e) {}\n            };\n          }\n\n        function bind(f) {\n          var args = Array.prototype.slice.call(arguments, 1);\n          return function () {\n            return f.apply(null, args);\n          };\n        }\n\n        function copyObj(obj, target, overwrite) {\n          if (!target) {\n            target = {};\n          }\n\n          for (var prop in obj) {\n            if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop))) {\n              target[prop] = obj[prop];\n            }\n          }\n\n          return target;\n        } // Counts the column offset in a string, taking tabs into account.\n        // Used mostly to find indentation.\n\n\n        function countColumn(string, end, tabSize, startIndex, startValue) {\n          if (end == null) {\n            end = string.search(/[^\\s\\u00a0]/);\n\n            if (end == -1) {\n              end = string.length;\n            }\n          }\n\n          for (var i = startIndex || 0, n = startValue || 0;;) {\n            var nextTab = string.indexOf(\"\\t\", i);\n\n            if (nextTab < 0 || nextTab >= end) {\n              return n + (end - i);\n            }\n\n            n += nextTab - i;\n            n += tabSize - n % tabSize;\n            i = nextTab + 1;\n          }\n        }\n\n        var Delayed = function () {\n          this.id = null;\n        };\n\n        Delayed.prototype.set = function (ms, f) {\n          clearTimeout(this.id);\n          this.id = setTimeout(f, ms);\n        };\n\n        function indexOf(array, elt) {\n          for (var i = 0; i < array.length; ++i) {\n            if (array[i] == elt) {\n              return i;\n            }\n          }\n\n          return -1;\n        } // Number of pixels added to scroller and sizer to hide scrollbar\n\n\n        var scrollerGap = 30; // Returned or thrown by various protocols to signal 'I'm not\n        // handling this'.\n\n        var Pass = {\n          toString: function () {\n            return \"CodeMirror.Pass\";\n          }\n        }; // Reused option objects for setSelection & friends\n\n        var sel_dontScroll = {\n          scroll: false\n        };\n        var sel_mouse = {\n          origin: \"*mouse\"\n        };\n        var sel_move = {\n          origin: \"+move\"\n        }; // The inverse of countColumn -- find the offset that corresponds to\n        // a particular column.\n\n        function findColumn(string, goal, tabSize) {\n          for (var pos = 0, col = 0;;) {\n            var nextTab = string.indexOf(\"\\t\", pos);\n\n            if (nextTab == -1) {\n              nextTab = string.length;\n            }\n\n            var skipped = nextTab - pos;\n\n            if (nextTab == string.length || col + skipped >= goal) {\n              return pos + Math.min(skipped, goal - col);\n            }\n\n            col += nextTab - pos;\n            col += tabSize - col % tabSize;\n            pos = nextTab + 1;\n\n            if (col >= goal) {\n              return pos;\n            }\n          }\n        }\n\n        var spaceStrs = [\"\"];\n\n        function spaceStr(n) {\n          while (spaceStrs.length <= n) {\n            spaceStrs.push(lst(spaceStrs) + \" \");\n          }\n\n          return spaceStrs[n];\n        }\n\n        function lst(arr) {\n          return arr[arr.length - 1];\n        }\n\n        function map(array, f) {\n          var out = [];\n\n          for (var i = 0; i < array.length; i++) {\n            out[i] = f(array[i], i);\n          }\n\n          return out;\n        }\n\n        function insertSorted(array, value, score) {\n          var pos = 0,\n              priority = score(value);\n\n          while (pos < array.length && score(array[pos]) <= priority) {\n            pos++;\n          }\n\n          array.splice(pos, 0, value);\n        }\n\n        function nothing() {}\n\n        function createObj(base, props) {\n          var inst;\n\n          if (Object.create) {\n            inst = Object.create(base);\n          } else {\n            nothing.prototype = base;\n            inst = new nothing();\n          }\n\n          if (props) {\n            copyObj(props, inst);\n          }\n\n          return inst;\n        }\n\n        var nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\n\n        function isWordCharBasic(ch) {\n          return /\\w/.test(ch) || ch > \"\\x80\" && (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch));\n        }\n\n        function isWordChar(ch, helper) {\n          if (!helper) {\n            return isWordCharBasic(ch);\n          }\n\n          if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) {\n            return true;\n          }\n\n          return helper.test(ch);\n        }\n\n        function isEmpty(obj) {\n          for (var n in obj) {\n            if (obj.hasOwnProperty(n) && obj[n]) {\n              return false;\n            }\n          }\n\n          return true;\n        } // Extending unicode characters. A series of a non-extending char +\n        // any number of extending chars is treated as a single unit as far\n        // as editing and measuring is concerned. This is not fully correct,\n        // since some scripts/fonts/browsers also treat other configurations\n        // of code points as a group.\n\n\n        var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\n\n        function isExtendingChar(ch) {\n          return ch.charCodeAt(0) >= 768 && extendingChars.test(ch);\n        } // Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\n\n\n        function skipExtendingChars(str, pos, dir) {\n          while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) {\n            pos += dir;\n          }\n\n          return pos;\n        } // Returns the value from the range [`from`; `to`] that satisfies\n        // `pred` and is closest to `from`. Assumes that at least `to` satisfies `pred`.\n\n\n        function findFirst(pred, from, to) {\n          for (;;) {\n            if (Math.abs(from - to) <= 1) {\n              return pred(from) ? from : to;\n            }\n\n            var mid = Math.floor((from + to) / 2);\n\n            if (pred(mid)) {\n              to = mid;\n            } else {\n              from = mid;\n            }\n          }\n        } // The display handles the DOM integration, both for input reading\n        // and content drawing. It holds references to DOM nodes and\n        // display-related state.\n\n\n        function Display(place, doc, input) {\n          var d = this;\n          this.input = input; // Covers bottom-right square when both scrollbars are present.\n\n          d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n          d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\"); // Covers bottom of gutter when coverGutterNextToScrollbar is on\n          // and h scrollbar is present.\n\n          d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n          d.gutterFiller.setAttribute(\"cm-not-content\", \"true\"); // Will contain the actual code, positioned to cover the viewport.\n\n          d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\"); // Elements are added to these to represent selection and cursors.\n\n          d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n          d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\"); // A visibility: hidden element used to find the size of things.\n\n          d.measure = elt(\"div\", null, \"CodeMirror-measure\"); // When lines outside of the viewport are measured, they are drawn in this.\n\n          d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\"); // Wraps everything that needs to exist inside the vertically-padded coordinate system\n\n          d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv], null, \"position: relative; outline: none\");\n          var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\"); // Moved around its parent to cover visible view.\n\n          d.mover = elt(\"div\", [lines], null, \"position: relative\"); // Set to the height of the document, allowing scrolling.\n\n          d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n          d.sizerWidth = null; // Behavior of elts with overflow: auto and padding is\n          // inconsistent across browsers. This is used to ensure the\n          // scrollable area is big enough.\n\n          d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\"); // Will contain the gutters, if any.\n\n          d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n          d.lineGutter = null; // Actual scrollable element.\n\n          d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n          d.scroller.setAttribute(\"tabIndex\", \"-1\"); // The element in which the editor lives.\n\n          d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\"); // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n\n          if (ie && ie_version < 8) {\n            d.gutters.style.zIndex = -1;\n            d.scroller.style.paddingRight = 0;\n          }\n\n          if (!webkit && !(gecko && mobile)) {\n            d.scroller.draggable = true;\n          }\n\n          if (place) {\n            if (place.appendChild) {\n              place.appendChild(d.wrapper);\n            } else {\n              place(d.wrapper);\n            }\n          } // Current rendered range (may be bigger than the view window).\n\n\n          d.viewFrom = d.viewTo = doc.first;\n          d.reportedViewFrom = d.reportedViewTo = doc.first; // Information about the rendered lines.\n\n          d.view = [];\n          d.renderedView = null; // Holds info about a single rendered line when it was rendered\n          // for measurement, while not in view.\n\n          d.externalMeasured = null; // Empty space (in pixels) above the view\n\n          d.viewOffset = 0;\n          d.lastWrapHeight = d.lastWrapWidth = 0;\n          d.updateLineNumbers = null;\n          d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n          d.scrollbarsClipped = false; // Used to only resize the line number gutter when necessary (when\n          // the amount of lines crosses a boundary that makes its width change)\n\n          d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null; // Set to true when a non-horizontal-scrolling line widget is\n          // added. As an optimization, line widget aligning is skipped when\n          // this is false.\n\n          d.alignWidgets = false;\n          d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null; // Tracks the maximum line length so that the horizontal scrollbar\n          // can be kept static when scrolling.\n\n          d.maxLine = null;\n          d.maxLineLength = 0;\n          d.maxLineChanged = false; // Used for measuring wheel scrolling granularity\n\n          d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null; // True when shift is held down.\n\n          d.shift = false; // Used to track whether anything happened since the context menu\n          // was opened.\n\n          d.selForContextMenu = null;\n          d.activeTouch = null;\n          input.init(d);\n        } // Find the line object corresponding to the given line number.\n\n\n        function getLine(doc, n) {\n          n -= doc.first;\n\n          if (n < 0 || n >= doc.size) {\n            throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\");\n          }\n\n          var chunk = doc;\n\n          while (!chunk.lines) {\n            for (var i = 0;; ++i) {\n              var child = chunk.children[i],\n                  sz = child.chunkSize();\n\n              if (n < sz) {\n                chunk = child;\n                break;\n              }\n\n              n -= sz;\n            }\n          }\n\n          return chunk.lines[n];\n        } // Get the part of a document between two positions, as an array of\n        // strings.\n\n\n        function getBetween(doc, start, end) {\n          var out = [],\n              n = start.line;\n          doc.iter(start.line, end.line + 1, function (line) {\n            var text = line.text;\n\n            if (n == end.line) {\n              text = text.slice(0, end.ch);\n            }\n\n            if (n == start.line) {\n              text = text.slice(start.ch);\n            }\n\n            out.push(text);\n            ++n;\n          });\n          return out;\n        } // Get the lines between from and to, as array of strings.\n\n\n        function getLines(doc, from, to) {\n          var out = [];\n          doc.iter(from, to, function (line) {\n            out.push(line.text);\n          }); // iter aborts when callback returns truthy value\n\n          return out;\n        } // Update the height of a line, propagating the height change\n        // upwards to parent nodes.\n\n\n        function updateLineHeight(line, height) {\n          var diff = height - line.height;\n\n          if (diff) {\n            for (var n = line; n; n = n.parent) {\n              n.height += diff;\n            }\n          }\n        } // Given a line object, find its line number by walking up through\n        // its parent links.\n\n\n        function lineNo(line) {\n          if (line.parent == null) {\n            return null;\n          }\n\n          var cur = line.parent,\n              no = indexOf(cur.lines, line);\n\n          for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n            for (var i = 0;; ++i) {\n              if (chunk.children[i] == cur) {\n                break;\n              }\n\n              no += chunk.children[i].chunkSize();\n            }\n          }\n\n          return no + cur.first;\n        } // Find the line at the given vertical position, using the height\n        // information in the document tree.\n\n\n        function lineAtHeight(chunk, h) {\n          var n = chunk.first;\n\n          outer: do {\n            for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n              var child = chunk.children[i$1],\n                  ch = child.height;\n\n              if (h < ch) {\n                chunk = child;\n                continue outer;\n              }\n\n              h -= ch;\n              n += child.chunkSize();\n            }\n\n            return n;\n          } while (!chunk.lines);\n\n          var i = 0;\n\n          for (; i < chunk.lines.length; ++i) {\n            var line = chunk.lines[i],\n                lh = line.height;\n\n            if (h < lh) {\n              break;\n            }\n\n            h -= lh;\n          }\n\n          return n + i;\n        }\n\n        function isLine(doc, l) {\n          return l >= doc.first && l < doc.first + doc.size;\n        }\n\n        function lineNumberFor(options, i) {\n          return String(options.lineNumberFormatter(i + options.firstLineNumber));\n        } // A Pos instance represents a position within the text.\n\n\n        function Pos(line, ch, sticky) {\n          if (sticky === void 0) sticky = null;\n\n          if (!(this instanceof Pos)) {\n            return new Pos(line, ch, sticky);\n          }\n\n          this.line = line;\n          this.ch = ch;\n          this.sticky = sticky;\n        } // Compare two positions, return 0 if they are the same, a negative\n        // number when a is less, and a positive number otherwise.\n\n\n        function cmp(a, b) {\n          return a.line - b.line || a.ch - b.ch;\n        }\n\n        function equalCursorPos(a, b) {\n          return a.sticky == b.sticky && cmp(a, b) == 0;\n        }\n\n        function copyPos(x) {\n          return Pos(x.line, x.ch);\n        }\n\n        function maxPos(a, b) {\n          return cmp(a, b) < 0 ? b : a;\n        }\n\n        function minPos(a, b) {\n          return cmp(a, b) < 0 ? a : b;\n        } // Most of the external API clips given positions to make sure they\n        // actually exist within the document.\n\n\n        function clipLine(doc, n) {\n          return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1));\n        }\n\n        function clipPos(doc, pos) {\n          if (pos.line < doc.first) {\n            return Pos(doc.first, 0);\n          }\n\n          var last = doc.first + doc.size - 1;\n\n          if (pos.line > last) {\n            return Pos(last, getLine(doc, last).text.length);\n          }\n\n          return clipToLen(pos, getLine(doc, pos.line).text.length);\n        }\n\n        function clipToLen(pos, linelen) {\n          var ch = pos.ch;\n\n          if (ch == null || ch > linelen) {\n            return Pos(pos.line, linelen);\n          } else if (ch < 0) {\n            return Pos(pos.line, 0);\n          } else {\n            return pos;\n          }\n        }\n\n        function clipPosArray(doc, array) {\n          var out = [];\n\n          for (var i = 0; i < array.length; i++) {\n            out[i] = clipPos(doc, array[i]);\n          }\n\n          return out;\n        } // Optimize some code when these features are not used.\n\n\n        var sawReadOnlySpans = false;\n        var sawCollapsedSpans = false;\n\n        function seeReadOnlySpans() {\n          sawReadOnlySpans = true;\n        }\n\n        function seeCollapsedSpans() {\n          sawCollapsedSpans = true;\n        } // TEXTMARKER SPANS\n\n\n        function MarkedSpan(marker, from, to) {\n          this.marker = marker;\n          this.from = from;\n          this.to = to;\n        } // Search an array of spans for a span matching the given marker.\n\n\n        function getMarkedSpanFor(spans, marker) {\n          if (spans) {\n            for (var i = 0; i < spans.length; ++i) {\n              var span = spans[i];\n\n              if (span.marker == marker) {\n                return span;\n              }\n            }\n          }\n        } // Remove a span from an array, returning undefined if no spans are\n        // left (we don't store arrays for lines without spans).\n\n\n        function removeMarkedSpan(spans, span) {\n          var r;\n\n          for (var i = 0; i < spans.length; ++i) {\n            if (spans[i] != span) {\n              (r || (r = [])).push(spans[i]);\n            }\n          }\n\n          return r;\n        } // Add a span to a line.\n\n\n        function addMarkedSpan(line, span) {\n          line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n          span.marker.attachLine(line);\n        } // Used for the algorithm that adjusts markers for a change in the\n        // document. These functions cut an array of spans at a given\n        // character position, returning an array of remaining chunks (or\n        // undefined if nothing remains).\n\n\n        function markedSpansBefore(old, startCh, isInsert) {\n          var nw;\n\n          if (old) {\n            for (var i = 0; i < old.length; ++i) {\n              var span = old[i],\n                  marker = span.marker;\n              var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n\n              if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n                var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh);\n                (nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n              }\n            }\n          }\n\n          return nw;\n        }\n\n        function markedSpansAfter(old, endCh, isInsert) {\n          var nw;\n\n          if (old) {\n            for (var i = 0; i < old.length; ++i) {\n              var span = old[i],\n                  marker = span.marker;\n              var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n\n              if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n                var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh);\n                (nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh, span.to == null ? null : span.to - endCh));\n              }\n            }\n          }\n\n          return nw;\n        } // Given a change object, compute the new set of marker spans that\n        // cover the line in which the change took place. Removes spans\n        // entirely within the change, reconnects spans belonging to the\n        // same marker that appear on both sides of the change, and cuts off\n        // spans partially within the change. Returns an array of span\n        // arrays with one element for each line in (after) the change.\n\n\n        function stretchSpansOverChange(doc, change) {\n          if (change.full) {\n            return null;\n          }\n\n          var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n          var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n\n          if (!oldFirst && !oldLast) {\n            return null;\n          }\n\n          var startCh = change.from.ch,\n              endCh = change.to.ch,\n              isInsert = cmp(change.from, change.to) == 0; // Get the spans that 'stick out' on both sides\n\n          var first = markedSpansBefore(oldFirst, startCh, isInsert);\n          var last = markedSpansAfter(oldLast, endCh, isInsert); // Next, merge those two ends\n\n          var sameLine = change.text.length == 1,\n              offset = lst(change.text).length + (sameLine ? startCh : 0);\n\n          if (first) {\n            // Fix up .to properties of first\n            for (var i = 0; i < first.length; ++i) {\n              var span = first[i];\n\n              if (span.to == null) {\n                var found = getMarkedSpanFor(last, span.marker);\n\n                if (!found) {\n                  span.to = startCh;\n                } else if (sameLine) {\n                  span.to = found.to == null ? null : found.to + offset;\n                }\n              }\n            }\n          }\n\n          if (last) {\n            // Fix up .from in last (or move them into first in case of sameLine)\n            for (var i$1 = 0; i$1 < last.length; ++i$1) {\n              var span$1 = last[i$1];\n\n              if (span$1.to != null) {\n                span$1.to += offset;\n              }\n\n              if (span$1.from == null) {\n                var found$1 = getMarkedSpanFor(first, span$1.marker);\n\n                if (!found$1) {\n                  span$1.from = offset;\n\n                  if (sameLine) {\n                    (first || (first = [])).push(span$1);\n                  }\n                }\n              } else {\n                span$1.from += offset;\n\n                if (sameLine) {\n                  (first || (first = [])).push(span$1);\n                }\n              }\n            }\n          } // Make sure we didn't create any zero-length spans\n\n\n          if (first) {\n            first = clearEmptySpans(first);\n          }\n\n          if (last && last != first) {\n            last = clearEmptySpans(last);\n          }\n\n          var newMarkers = [first];\n\n          if (!sameLine) {\n            // Fill gap with whole-line-spans\n            var gap = change.text.length - 2,\n                gapMarkers;\n\n            if (gap > 0 && first) {\n              for (var i$2 = 0; i$2 < first.length; ++i$2) {\n                if (first[i$2].to == null) {\n                  (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null));\n                }\n              }\n            }\n\n            for (var i$3 = 0; i$3 < gap; ++i$3) {\n              newMarkers.push(gapMarkers);\n            }\n\n            newMarkers.push(last);\n          }\n\n          return newMarkers;\n        } // Remove spans that are empty and don't have a clearWhenEmpty\n        // option of false.\n\n\n        function clearEmptySpans(spans) {\n          for (var i = 0; i < spans.length; ++i) {\n            var span = spans[i];\n\n            if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false) {\n              spans.splice(i--, 1);\n            }\n          }\n\n          if (!spans.length) {\n            return null;\n          }\n\n          return spans;\n        } // Used to 'clip' out readOnly ranges when making a change.\n\n\n        function removeReadOnlyRanges(doc, from, to) {\n          var markers = null;\n          doc.iter(from.line, to.line + 1, function (line) {\n            if (line.markedSpans) {\n              for (var i = 0; i < line.markedSpans.length; ++i) {\n                var mark = line.markedSpans[i].marker;\n\n                if (mark.readOnly && (!markers || indexOf(markers, mark) == -1)) {\n                  (markers || (markers = [])).push(mark);\n                }\n              }\n            }\n          });\n\n          if (!markers) {\n            return null;\n          }\n\n          var parts = [{\n            from: from,\n            to: to\n          }];\n\n          for (var i = 0; i < markers.length; ++i) {\n            var mk = markers[i],\n                m = mk.find(0);\n\n            for (var j = 0; j < parts.length; ++j) {\n              var p = parts[j];\n\n              if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) {\n                continue;\n              }\n\n              var newParts = [j, 1],\n                  dfrom = cmp(p.from, m.from),\n                  dto = cmp(p.to, m.to);\n\n              if (dfrom < 0 || !mk.inclusiveLeft && !dfrom) {\n                newParts.push({\n                  from: p.from,\n                  to: m.from\n                });\n              }\n\n              if (dto > 0 || !mk.inclusiveRight && !dto) {\n                newParts.push({\n                  from: m.to,\n                  to: p.to\n                });\n              }\n\n              parts.splice.apply(parts, newParts);\n              j += newParts.length - 3;\n            }\n          }\n\n          return parts;\n        } // Connect or disconnect spans from a line.\n\n\n        function detachMarkedSpans(line) {\n          var spans = line.markedSpans;\n\n          if (!spans) {\n            return;\n          }\n\n          for (var i = 0; i < spans.length; ++i) {\n            spans[i].marker.detachLine(line);\n          }\n\n          line.markedSpans = null;\n        }\n\n        function attachMarkedSpans(line, spans) {\n          if (!spans) {\n            return;\n          }\n\n          for (var i = 0; i < spans.length; ++i) {\n            spans[i].marker.attachLine(line);\n          }\n\n          line.markedSpans = spans;\n        } // Helpers used when computing which overlapping collapsed span\n        // counts as the larger one.\n\n\n        function extraLeft(marker) {\n          return marker.inclusiveLeft ? -1 : 0;\n        }\n\n        function extraRight(marker) {\n          return marker.inclusiveRight ? 1 : 0;\n        } // Returns a number indicating which of two overlapping collapsed\n        // spans is larger (and thus includes the other). Falls back to\n        // comparing ids when the spans cover exactly the same range.\n\n\n        function compareCollapsedMarkers(a, b) {\n          var lenDiff = a.lines.length - b.lines.length;\n\n          if (lenDiff != 0) {\n            return lenDiff;\n          }\n\n          var aPos = a.find(),\n              bPos = b.find();\n          var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n\n          if (fromCmp) {\n            return -fromCmp;\n          }\n\n          var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n\n          if (toCmp) {\n            return toCmp;\n          }\n\n          return b.id - a.id;\n        } // Find out whether a line ends or starts in a collapsed span. If\n        // so, return the marker for that span.\n\n\n        function collapsedSpanAtSide(line, start) {\n          var sps = sawCollapsedSpans && line.markedSpans,\n              found;\n\n          if (sps) {\n            for (var sp = void 0, i = 0; i < sps.length; ++i) {\n              sp = sps[i];\n\n              if (sp.marker.collapsed && (start ? sp.from : sp.to) == null && (!found || compareCollapsedMarkers(found, sp.marker) < 0)) {\n                found = sp.marker;\n              }\n            }\n          }\n\n          return found;\n        }\n\n        function collapsedSpanAtStart(line) {\n          return collapsedSpanAtSide(line, true);\n        }\n\n        function collapsedSpanAtEnd(line) {\n          return collapsedSpanAtSide(line, false);\n        } // Test whether there exists a collapsed span that partially\n        // overlaps (covers the start or end, but not both) of a new span.\n        // Such overlap is not allowed.\n\n\n        function conflictingCollapsedRange(doc, lineNo$$1, from, to, marker) {\n          var line = getLine(doc, lineNo$$1);\n          var sps = sawCollapsedSpans && line.markedSpans;\n\n          if (sps) {\n            for (var i = 0; i < sps.length; ++i) {\n              var sp = sps[i];\n\n              if (!sp.marker.collapsed) {\n                continue;\n              }\n\n              var found = sp.marker.find(0);\n              var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n              var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n\n              if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) {\n                continue;\n              }\n\n              if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) || fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0)) {\n                return true;\n              }\n            }\n          }\n        } // A visual line is a line as drawn on the screen. Folding, for\n        // example, can cause multiple logical lines to appear on the same\n        // visual line. This finds the start of the visual line that the\n        // given line is part of (usually that is the line itself).\n\n\n        function visualLine(line) {\n          var merged;\n\n          while (merged = collapsedSpanAtStart(line)) {\n            line = merged.find(-1, true).line;\n          }\n\n          return line;\n        }\n\n        function visualLineEnd(line) {\n          var merged;\n\n          while (merged = collapsedSpanAtEnd(line)) {\n            line = merged.find(1, true).line;\n          }\n\n          return line;\n        } // Returns an array of logical lines that continue the visual line\n        // started by the argument, or undefined if there are no such lines.\n\n\n        function visualLineContinued(line) {\n          var merged, lines;\n\n          while (merged = collapsedSpanAtEnd(line)) {\n            line = merged.find(1, true).line;\n            (lines || (lines = [])).push(line);\n          }\n\n          return lines;\n        } // Get the line number of the start of the visual line that the\n        // given line number is part of.\n\n\n        function visualLineNo(doc, lineN) {\n          var line = getLine(doc, lineN),\n              vis = visualLine(line);\n\n          if (line == vis) {\n            return lineN;\n          }\n\n          return lineNo(vis);\n        } // Get the line number of the start of the next visual line after\n        // the given line.\n\n\n        function visualLineEndNo(doc, lineN) {\n          if (lineN > doc.lastLine()) {\n            return lineN;\n          }\n\n          var line = getLine(doc, lineN),\n              merged;\n\n          if (!lineIsHidden(doc, line)) {\n            return lineN;\n          }\n\n          while (merged = collapsedSpanAtEnd(line)) {\n            line = merged.find(1, true).line;\n          }\n\n          return lineNo(line) + 1;\n        } // Compute whether a line is hidden. Lines count as hidden when they\n        // are part of a visual line that starts with another line, or when\n        // they are entirely covered by collapsed, non-widget span.\n\n\n        function lineIsHidden(doc, line) {\n          var sps = sawCollapsedSpans && line.markedSpans;\n\n          if (sps) {\n            for (var sp = void 0, i = 0; i < sps.length; ++i) {\n              sp = sps[i];\n\n              if (!sp.marker.collapsed) {\n                continue;\n              }\n\n              if (sp.from == null) {\n                return true;\n              }\n\n              if (sp.marker.widgetNode) {\n                continue;\n              }\n\n              if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp)) {\n                return true;\n              }\n            }\n          }\n        }\n\n        function lineIsHiddenInner(doc, line, span) {\n          if (span.to == null) {\n            var end = span.marker.find(1, true);\n            return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker));\n          }\n\n          if (span.marker.inclusiveRight && span.to == line.text.length) {\n            return true;\n          }\n\n          for (var sp = void 0, i = 0; i < line.markedSpans.length; ++i) {\n            sp = line.markedSpans[i];\n\n            if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to && (sp.to == null || sp.to != span.from) && (sp.marker.inclusiveLeft || span.marker.inclusiveRight) && lineIsHiddenInner(doc, line, sp)) {\n              return true;\n            }\n          }\n        } // Find the height above the given line.\n\n\n        function heightAtLine(lineObj) {\n          lineObj = visualLine(lineObj);\n          var h = 0,\n              chunk = lineObj.parent;\n\n          for (var i = 0; i < chunk.lines.length; ++i) {\n            var line = chunk.lines[i];\n\n            if (line == lineObj) {\n              break;\n            } else {\n              h += line.height;\n            }\n          }\n\n          for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n            for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n              var cur = p.children[i$1];\n\n              if (cur == chunk) {\n                break;\n              } else {\n                h += cur.height;\n              }\n            }\n          }\n\n          return h;\n        } // Compute the character length of a line, taking into account\n        // collapsed ranges (see markText) that might hide parts, and join\n        // other lines onto it.\n\n\n        function lineLength(line) {\n          if (line.height == 0) {\n            return 0;\n          }\n\n          var len = line.text.length,\n              merged,\n              cur = line;\n\n          while (merged = collapsedSpanAtStart(cur)) {\n            var found = merged.find(0, true);\n            cur = found.from.line;\n            len += found.from.ch - found.to.ch;\n          }\n\n          cur = line;\n\n          while (merged = collapsedSpanAtEnd(cur)) {\n            var found$1 = merged.find(0, true);\n            len -= cur.text.length - found$1.from.ch;\n            cur = found$1.to.line;\n            len += cur.text.length - found$1.to.ch;\n          }\n\n          return len;\n        } // Find the longest line in the document.\n\n\n        function findMaxLine(cm) {\n          var d = cm.display,\n              doc = cm.doc;\n          d.maxLine = getLine(doc, doc.first);\n          d.maxLineLength = lineLength(d.maxLine);\n          d.maxLineChanged = true;\n          doc.iter(function (line) {\n            var len = lineLength(line);\n\n            if (len > d.maxLineLength) {\n              d.maxLineLength = len;\n              d.maxLine = line;\n            }\n          });\n        } // BIDI HELPERS\n\n\n        function iterateBidiSections(order, from, to, f) {\n          if (!order) {\n            return f(from, to, \"ltr\");\n          }\n\n          var found = false;\n\n          for (var i = 0; i < order.length; ++i) {\n            var part = order[i];\n\n            if (part.from < to && part.to > from || from == to && part.to == from) {\n              f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\");\n              found = true;\n            }\n          }\n\n          if (!found) {\n            f(from, to, \"ltr\");\n          }\n        }\n\n        var bidiOther = null;\n\n        function getBidiPartAt(order, ch, sticky) {\n          var found;\n          bidiOther = null;\n\n          for (var i = 0; i < order.length; ++i) {\n            var cur = order[i];\n\n            if (cur.from < ch && cur.to > ch) {\n              return i;\n            }\n\n            if (cur.to == ch) {\n              if (cur.from != cur.to && sticky == \"before\") {\n                found = i;\n              } else {\n                bidiOther = i;\n              }\n            }\n\n            if (cur.from == ch) {\n              if (cur.from != cur.to && sticky != \"before\") {\n                found = i;\n              } else {\n                bidiOther = i;\n              }\n            }\n          }\n\n          return found != null ? found : bidiOther;\n        } // Bidirectional ordering algorithm\n        // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n        // that this (partially) implements.\n        // One-char codes used for character types:\n        // L (L):   Left-to-Right\n        // R (R):   Right-to-Left\n        // r (AL):  Right-to-Left Arabic\n        // 1 (EN):  European Number\n        // + (ES):  European Number Separator\n        // % (ET):  European Number Terminator\n        // n (AN):  Arabic Number\n        // , (CS):  Common Number Separator\n        // m (NSM): Non-Spacing Mark\n        // b (BN):  Boundary Neutral\n        // s (B):   Paragraph Separator\n        // t (S):   Segment Separator\n        // w (WS):  Whitespace\n        // N (ON):  Other Neutrals\n        // Returns null if characters are ordered as they appear\n        // (left-to-right), or an array of sections ({from, to, level}\n        // objects) in the order in which they occur visually.\n\n\n        var bidiOrdering = function () {\n          // Character types for codepoints 0 to 0xff\n          var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\"; // Character types for codepoints 0x600 to 0x6f9\n\n          var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n\n          function charType(code) {\n            if (code <= 0xf7) {\n              return lowTypes.charAt(code);\n            } else if (0x590 <= code && code <= 0x5f4) {\n              return \"R\";\n            } else if (0x600 <= code && code <= 0x6f9) {\n              return arabicTypes.charAt(code - 0x600);\n            } else if (0x6ee <= code && code <= 0x8ac) {\n              return \"r\";\n            } else if (0x2000 <= code && code <= 0x200b) {\n              return \"w\";\n            } else if (code == 0x200c) {\n              return \"b\";\n            } else {\n              return \"L\";\n            }\n          }\n\n          var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n          var isNeutral = /[stwN]/,\n              isStrong = /[LRr]/,\n              countsAsLeft = /[Lb1n]/,\n              countsAsNum = /[1n]/;\n\n          function BidiSpan(level, from, to) {\n            this.level = level;\n            this.from = from;\n            this.to = to;\n          }\n\n          return function (str, direction) {\n            var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n            if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) {\n              return false;\n            }\n\n            var len = str.length,\n                types = [];\n\n            for (var i = 0; i < len; ++i) {\n              types.push(charType(str.charCodeAt(i)));\n            } // W1. Examine each non-spacing mark (NSM) in the level run, and\n            // change the type of the NSM to the type of the previous\n            // character. If the NSM is at the start of the level run, it will\n            // get the type of sor.\n\n\n            for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n              var type = types[i$1];\n\n              if (type == \"m\") {\n                types[i$1] = prev;\n              } else {\n                prev = type;\n              }\n            } // W2. Search backwards from each instance of a European number\n            // until the first strong type (R, L, AL, or sor) is found. If an\n            // AL is found, change the type of the European number to Arabic\n            // number.\n            // W3. Change all ALs to R.\n\n\n            for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n              var type$1 = types[i$2];\n\n              if (type$1 == \"1\" && cur == \"r\") {\n                types[i$2] = \"n\";\n              } else if (isStrong.test(type$1)) {\n                cur = type$1;\n\n                if (type$1 == \"r\") {\n                  types[i$2] = \"R\";\n                }\n              }\n            } // W4. A single European separator between two European numbers\n            // changes to a European number. A single common separator between\n            // two numbers of the same type changes to that type.\n\n\n            for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n              var type$2 = types[i$3];\n\n              if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3 + 1] == \"1\") {\n                types[i$3] = \"1\";\n              } else if (type$2 == \",\" && prev$1 == types[i$3 + 1] && (prev$1 == \"1\" || prev$1 == \"n\")) {\n                types[i$3] = prev$1;\n              }\n\n              prev$1 = type$2;\n            } // W5. A sequence of European terminators adjacent to European\n            // numbers changes to all European numbers.\n            // W6. Otherwise, separators and terminators change to Other\n            // Neutral.\n\n\n            for (var i$4 = 0; i$4 < len; ++i$4) {\n              var type$3 = types[i$4];\n\n              if (type$3 == \",\") {\n                types[i$4] = \"N\";\n              } else if (type$3 == \"%\") {\n                var end = void 0;\n\n                for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n\n                var replace = i$4 && types[i$4 - 1] == \"!\" || end < len && types[end] == \"1\" ? \"1\" : \"N\";\n\n                for (var j = i$4; j < end; ++j) {\n                  types[j] = replace;\n                }\n\n                i$4 = end - 1;\n              }\n            } // W7. Search backwards from each instance of a European number\n            // until the first strong type (R, L, or sor) is found. If an L is\n            // found, then change the type of the European number to L.\n\n\n            for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n              var type$4 = types[i$5];\n\n              if (cur$1 == \"L\" && type$4 == \"1\") {\n                types[i$5] = \"L\";\n              } else if (isStrong.test(type$4)) {\n                cur$1 = type$4;\n              }\n            } // N1. A sequence of neutrals takes the direction of the\n            // surrounding strong text if the text on both sides has the same\n            // direction. European and Arabic numbers act as if they were R in\n            // terms of their influence on neutrals. Start-of-level-run (sor)\n            // and end-of-level-run (eor) are used at level run boundaries.\n            // N2. Any remaining neutrals take the embedding direction.\n\n\n            for (var i$6 = 0; i$6 < len; ++i$6) {\n              if (isNeutral.test(types[i$6])) {\n                var end$1 = void 0;\n\n                for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n\n                var before = (i$6 ? types[i$6 - 1] : outerType) == \"L\";\n                var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n                var replace$1 = before == after ? before ? \"L\" : \"R\" : outerType;\n\n                for (var j$1 = i$6; j$1 < end$1; ++j$1) {\n                  types[j$1] = replace$1;\n                }\n\n                i$6 = end$1 - 1;\n              }\n            } // Here we depart from the documented algorithm, in order to avoid\n            // building up an actual levels array. Since there are only three\n            // levels (0, 1, 2) in an implementation that doesn't take\n            // explicit embedding into account, we can build up the order on\n            // the fly, without following the level-based algorithm.\n\n\n            var order = [],\n                m;\n\n            for (var i$7 = 0; i$7 < len;) {\n              if (countsAsLeft.test(types[i$7])) {\n                var start = i$7;\n\n                for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n\n                order.push(new BidiSpan(0, start, i$7));\n              } else {\n                var pos = i$7,\n                    at = order.length;\n\n                for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n\n                for (var j$2 = pos; j$2 < i$7;) {\n                  if (countsAsNum.test(types[j$2])) {\n                    if (pos < j$2) {\n                      order.splice(at, 0, new BidiSpan(1, pos, j$2));\n                    }\n\n                    var nstart = j$2;\n\n                    for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n\n                    order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n                    pos = j$2;\n                  } else {\n                    ++j$2;\n                  }\n                }\n\n                if (pos < i$7) {\n                  order.splice(at, 0, new BidiSpan(1, pos, i$7));\n                }\n              }\n            }\n\n            if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n              order[0].from = m[0].length;\n              order.unshift(new BidiSpan(0, 0, m[0].length));\n            }\n\n            if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n              lst(order).to -= m[0].length;\n              order.push(new BidiSpan(0, len - m[0].length, len));\n            }\n\n            return direction == \"rtl\" ? order.reverse() : order;\n          };\n        }(); // Get the bidi ordering for the given line (and cache it). Returns\n        // false for lines that are fully left-to-right, and an array of\n        // BidiSpan objects otherwise.\n\n\n        function getOrder(line, direction) {\n          var order = line.order;\n\n          if (order == null) {\n            order = line.order = bidiOrdering(line.text, direction);\n          }\n\n          return order;\n        }\n\n        function moveCharLogically(line, ch, dir) {\n          var target = skipExtendingChars(line.text, ch + dir, dir);\n          return target < 0 || target > line.text.length ? null : target;\n        }\n\n        function moveLogically(line, start, dir) {\n          var ch = moveCharLogically(line, start.ch, dir);\n          return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\");\n        }\n\n        function endOfLine(visually, cm, lineObj, lineNo, dir) {\n          if (visually) {\n            var order = getOrder(lineObj, cm.doc.direction);\n\n            if (order) {\n              var part = dir < 0 ? lst(order) : order[0];\n              var moveInStorageOrder = dir < 0 == (part.level == 1);\n              var sticky = moveInStorageOrder ? \"after\" : \"before\";\n              var ch; // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n              // it could be that the last bidi part is not on the last visual line,\n              // since visual lines contain content order-consecutive chunks.\n              // Thus, in rtl, we are looking for the first (content-order) character\n              // in the rtl chunk that is on the last line (that is, the same line\n              // as the last (content-order) character).\n\n              if (part.level > 0) {\n                var prep = prepareMeasureForLine(cm, lineObj);\n                ch = dir < 0 ? lineObj.text.length - 1 : 0;\n                var targetTop = measureCharPrepared(cm, prep, ch).top;\n                ch = findFirst(function (ch) {\n                  return measureCharPrepared(cm, prep, ch).top == targetTop;\n                }, dir < 0 == (part.level == 1) ? part.from : part.to - 1, ch);\n\n                if (sticky == \"before\") {\n                  ch = moveCharLogically(lineObj, ch, 1);\n                }\n              } else {\n                ch = dir < 0 ? part.to : part.from;\n              }\n\n              return new Pos(lineNo, ch, sticky);\n            }\n          }\n\n          return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\");\n        }\n\n        function moveVisually(cm, line, start, dir) {\n          var bidi = getOrder(line, cm.doc.direction);\n\n          if (!bidi) {\n            return moveLogically(line, start, dir);\n          }\n\n          if (start.ch >= line.text.length) {\n            start.ch = line.text.length;\n            start.sticky = \"before\";\n          } else if (start.ch <= 0) {\n            start.ch = 0;\n            start.sticky = \"after\";\n          }\n\n          var partPos = getBidiPartAt(bidi, start.ch, start.sticky),\n              part = bidi[partPos];\n\n          if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n            // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n            // nothing interesting happens.\n            return moveLogically(line, start, dir);\n          }\n\n          var mv = function (pos, dir) {\n            return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir);\n          };\n\n          var prep;\n\n          var getWrappedLineExtent = function (ch) {\n            if (!cm.options.lineWrapping) {\n              return {\n                begin: 0,\n                end: line.text.length\n              };\n            }\n\n            prep = prep || prepareMeasureForLine(cm, line);\n            return wrappedLineExtentChar(cm, line, prep, ch);\n          };\n\n          var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n          if (cm.doc.direction == \"rtl\" || part.level == 1) {\n            var moveInStorageOrder = part.level == 1 == dir < 0;\n            var ch = mv(start, moveInStorageOrder ? 1 : -1);\n\n            if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n              // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n              var sticky = moveInStorageOrder ? \"before\" : \"after\";\n              return new Pos(start.line, ch, sticky);\n            }\n          } // Case 3: Could not move within this bidi part in this visual line, so leave\n          // the current bidi part\n\n\n          var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\n            var getRes = function (ch, moveInStorageOrder) {\n              return moveInStorageOrder ? new Pos(start.line, mv(ch, 1), \"before\") : new Pos(start.line, ch, \"after\");\n            };\n\n            for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n              var part = bidi[partPos];\n              var moveInStorageOrder = dir > 0 == (part.level != 1);\n              var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n\n              if (part.from <= ch && ch < part.to) {\n                return getRes(ch, moveInStorageOrder);\n              }\n\n              ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n\n              if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) {\n                return getRes(ch, moveInStorageOrder);\n              }\n            }\n          }; // Case 3a: Look for other bidi parts on the same visual line\n\n\n          var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n\n          if (res) {\n            return res;\n          } // Case 3b: Look for other bidi parts on the next visual line\n\n\n          var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n\n          if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n            res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n\n            if (res) {\n              return res;\n            }\n          } // Case 4: Nowhere to move\n\n\n          return null;\n        } // EVENT HANDLING\n        // Lightweight event framework. on/off also work on DOM nodes,\n        // registering native DOM handlers.\n\n\n        var noHandlers = [];\n\n        var on = function (emitter, type, f) {\n          if (emitter.addEventListener) {\n            emitter.addEventListener(type, f, false);\n          } else if (emitter.attachEvent) {\n            emitter.attachEvent(\"on\" + type, f);\n          } else {\n            var map$$1 = emitter._handlers || (emitter._handlers = {});\n            map$$1[type] = (map$$1[type] || noHandlers).concat(f);\n          }\n        };\n\n        function getHandlers(emitter, type) {\n          return emitter._handlers && emitter._handlers[type] || noHandlers;\n        }\n\n        function off(emitter, type, f) {\n          if (emitter.removeEventListener) {\n            emitter.removeEventListener(type, f, false);\n          } else if (emitter.detachEvent) {\n            emitter.detachEvent(\"on\" + type, f);\n          } else {\n            var map$$1 = emitter._handlers,\n                arr = map$$1 && map$$1[type];\n\n            if (arr) {\n              var index = indexOf(arr, f);\n\n              if (index > -1) {\n                map$$1[type] = arr.slice(0, index).concat(arr.slice(index + 1));\n              }\n            }\n          }\n        }\n\n        function signal(emitter, type\n        /*, values...*/\n        ) {\n          var handlers = getHandlers(emitter, type);\n\n          if (!handlers.length) {\n            return;\n          }\n\n          var args = Array.prototype.slice.call(arguments, 2);\n\n          for (var i = 0; i < handlers.length; ++i) {\n            handlers[i].apply(null, args);\n          }\n        } // The DOM events that CodeMirror handles can be overridden by\n        // registering a (non-DOM) handler on the editor for the event name,\n        // and preventDefault-ing the event in that handler.\n\n\n        function signalDOMEvent(cm, e, override) {\n          if (typeof e == \"string\") {\n            e = {\n              type: e,\n              preventDefault: function () {\n                this.defaultPrevented = true;\n              }\n            };\n          }\n\n          signal(cm, override || e.type, cm, e);\n          return e_defaultPrevented(e) || e.codemirrorIgnore;\n        }\n\n        function signalCursorActivity(cm) {\n          var arr = cm._handlers && cm._handlers.cursorActivity;\n\n          if (!arr) {\n            return;\n          }\n\n          var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n\n          for (var i = 0; i < arr.length; ++i) {\n            if (indexOf(set, arr[i]) == -1) {\n              set.push(arr[i]);\n            }\n          }\n        }\n\n        function hasHandler(emitter, type) {\n          return getHandlers(emitter, type).length > 0;\n        } // Add on and off methods to a constructor's prototype, to make\n        // registering events on such objects more convenient.\n\n\n        function eventMixin(ctor) {\n          ctor.prototype.on = function (type, f) {\n            on(this, type, f);\n          };\n\n          ctor.prototype.off = function (type, f) {\n            off(this, type, f);\n          };\n        } // Due to the fact that we still support jurassic IE versions, some\n        // compatibility wrappers are needed.\n\n\n        function e_preventDefault(e) {\n          if (e.preventDefault) {\n            e.preventDefault();\n          } else {\n            e.returnValue = false;\n          }\n        }\n\n        function e_stopPropagation(e) {\n          if (e.stopPropagation) {\n            e.stopPropagation();\n          } else {\n            e.cancelBubble = true;\n          }\n        }\n\n        function e_defaultPrevented(e) {\n          return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false;\n        }\n\n        function e_stop(e) {\n          e_preventDefault(e);\n          e_stopPropagation(e);\n        }\n\n        function e_target(e) {\n          return e.target || e.srcElement;\n        }\n\n        function e_button(e) {\n          var b = e.which;\n\n          if (b == null) {\n            if (e.button & 1) {\n              b = 1;\n            } else if (e.button & 2) {\n              b = 3;\n            } else if (e.button & 4) {\n              b = 2;\n            }\n          }\n\n          if (mac && e.ctrlKey && b == 1) {\n            b = 3;\n          }\n\n          return b;\n        } // Detect drag-and-drop\n\n\n        var dragAndDrop = function () {\n          // There is *some* kind of drag-and-drop support in IE6-8, but I\n          // couldn't get it to work yet.\n          if (ie && ie_version < 9) {\n            return false;\n          }\n\n          var div = elt('div');\n          return \"draggable\" in div || \"dragDrop\" in div;\n        }();\n\n        var zwspSupported;\n\n        function zeroWidthElement(measure) {\n          if (zwspSupported == null) {\n            var test = elt(\"span\", \"\\u200b\");\n            removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n\n            if (measure.firstChild.offsetHeight != 0) {\n              zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8);\n            }\n          }\n\n          var node = zwspSupported ? elt(\"span\", \"\\u200b\") : elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n          node.setAttribute(\"cm-text\", \"\");\n          return node;\n        } // Feature-detect IE's crummy client rect reporting for bidi text\n\n\n        var badBidiRects;\n\n        function hasBadBidiRects(measure) {\n          if (badBidiRects != null) {\n            return badBidiRects;\n          }\n\n          var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n          var r0 = range(txt, 0, 1).getBoundingClientRect();\n          var r1 = range(txt, 1, 2).getBoundingClientRect();\n          removeChildren(measure);\n\n          if (!r0 || r0.left == r0.right) {\n            return false;\n          } // Safari returns null in some cases (#2780)\n\n\n          return badBidiRects = r1.right - r0.right < 3;\n        } // See if \"\".split is the broken IE version, if so, provide an\n        // alternative way to split lines.\n\n\n        var splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n          var pos = 0,\n              result = [],\n              l = string.length;\n\n          while (pos <= l) {\n            var nl = string.indexOf(\"\\n\", pos);\n\n            if (nl == -1) {\n              nl = string.length;\n            }\n\n            var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n            var rt = line.indexOf(\"\\r\");\n\n            if (rt != -1) {\n              result.push(line.slice(0, rt));\n              pos += rt + 1;\n            } else {\n              result.push(line);\n              pos = nl + 1;\n            }\n          }\n\n          return result;\n        } : function (string) {\n          return string.split(/\\r\\n?|\\n/);\n        };\n        var hasSelection = window.getSelection ? function (te) {\n          try {\n            return te.selectionStart != te.selectionEnd;\n          } catch (e) {\n            return false;\n          }\n        } : function (te) {\n          var range$$1;\n\n          try {\n            range$$1 = te.ownerDocument.selection.createRange();\n          } catch (e) {}\n\n          if (!range$$1 || range$$1.parentElement() != te) {\n            return false;\n          }\n\n          return range$$1.compareEndPoints(\"StartToEnd\", range$$1) != 0;\n        };\n\n        var hasCopyEvent = function () {\n          var e = elt(\"div\");\n\n          if (\"oncopy\" in e) {\n            return true;\n          }\n\n          e.setAttribute(\"oncopy\", \"return;\");\n          return typeof e.oncopy == \"function\";\n        }();\n\n        var badZoomedRects = null;\n\n        function hasBadZoomedRects(measure) {\n          if (badZoomedRects != null) {\n            return badZoomedRects;\n          }\n\n          var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n          var normal = node.getBoundingClientRect();\n          var fromRange = range(node, 0, 1).getBoundingClientRect();\n          return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1;\n        } // Known modes, by name and by MIME\n\n\n        var modes = {};\n        var mimeModes = {}; // Extra arguments are stored as the mode's dependencies, which is\n        // used by (legacy) mechanisms like loadmode.js to automatically\n        // load a mode. (Preferred mechanism is the require/define calls.)\n\n        function defineMode(name, mode) {\n          if (arguments.length > 2) {\n            mode.dependencies = Array.prototype.slice.call(arguments, 2);\n          }\n\n          modes[name] = mode;\n        }\n\n        function defineMIME(mime, spec) {\n          mimeModes[mime] = spec;\n        } // Given a MIME type, a {name, ...options} config object, or a name\n        // string, return a mode config object.\n\n\n        function resolveMode(spec) {\n          if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n            spec = mimeModes[spec];\n          } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n            var found = mimeModes[spec.name];\n\n            if (typeof found == \"string\") {\n              found = {\n                name: found\n              };\n            }\n\n            spec = createObj(found, spec);\n            spec.name = found.name;\n          } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n            return resolveMode(\"application/xml\");\n          } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n            return resolveMode(\"application/json\");\n          }\n\n          if (typeof spec == \"string\") {\n            return {\n              name: spec\n            };\n          } else {\n            return spec || {\n              name: \"null\"\n            };\n          }\n        } // Given a mode spec (anything that resolveMode accepts), find and\n        // initialize an actual mode object.\n\n\n        function getMode(options, spec) {\n          spec = resolveMode(spec);\n          var mfactory = modes[spec.name];\n\n          if (!mfactory) {\n            return getMode(options, \"text/plain\");\n          }\n\n          var modeObj = mfactory(options, spec);\n\n          if (modeExtensions.hasOwnProperty(spec.name)) {\n            var exts = modeExtensions[spec.name];\n\n            for (var prop in exts) {\n              if (!exts.hasOwnProperty(prop)) {\n                continue;\n              }\n\n              if (modeObj.hasOwnProperty(prop)) {\n                modeObj[\"_\" + prop] = modeObj[prop];\n              }\n\n              modeObj[prop] = exts[prop];\n            }\n          }\n\n          modeObj.name = spec.name;\n\n          if (spec.helperType) {\n            modeObj.helperType = spec.helperType;\n          }\n\n          if (spec.modeProps) {\n            for (var prop$1 in spec.modeProps) {\n              modeObj[prop$1] = spec.modeProps[prop$1];\n            }\n          }\n\n          return modeObj;\n        } // This can be used to attach properties to mode objects from\n        // outside the actual mode definition.\n\n\n        var modeExtensions = {};\n\n        function extendMode(mode, properties) {\n          var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : modeExtensions[mode] = {};\n          copyObj(properties, exts);\n        }\n\n        function copyState(mode, state) {\n          if (state === true) {\n            return state;\n          }\n\n          if (mode.copyState) {\n            return mode.copyState(state);\n          }\n\n          var nstate = {};\n\n          for (var n in state) {\n            var val = state[n];\n\n            if (val instanceof Array) {\n              val = val.concat([]);\n            }\n\n            nstate[n] = val;\n          }\n\n          return nstate;\n        } // Given a mode and a state (for that mode), find the inner mode and\n        // state at the position that the state refers to.\n\n\n        function innerMode(mode, state) {\n          var info;\n\n          while (mode.innerMode) {\n            info = mode.innerMode(state);\n\n            if (!info || info.mode == mode) {\n              break;\n            }\n\n            state = info.state;\n            mode = info.mode;\n          }\n\n          return info || {\n            mode: mode,\n            state: state\n          };\n        }\n\n        function startState(mode, a1, a2) {\n          return mode.startState ? mode.startState(a1, a2) : true;\n        } // STRING STREAM\n        // Fed to the mode parsers, provides helper functions to make\n        // parsers more succinct.\n\n\n        var StringStream = function (string, tabSize) {\n          this.pos = this.start = 0;\n          this.string = string;\n          this.tabSize = tabSize || 8;\n          this.lastColumnPos = this.lastColumnValue = 0;\n          this.lineStart = 0;\n        };\n\n        StringStream.prototype.eol = function () {\n          return this.pos >= this.string.length;\n        };\n\n        StringStream.prototype.sol = function () {\n          return this.pos == this.lineStart;\n        };\n\n        StringStream.prototype.peek = function () {\n          return this.string.charAt(this.pos) || undefined;\n        };\n\n        StringStream.prototype.next = function () {\n          if (this.pos < this.string.length) {\n            return this.string.charAt(this.pos++);\n          }\n        };\n\n        StringStream.prototype.eat = function (match) {\n          var ch = this.string.charAt(this.pos);\n          var ok;\n\n          if (typeof match == \"string\") {\n            ok = ch == match;\n          } else {\n            ok = ch && (match.test ? match.test(ch) : match(ch));\n          }\n\n          if (ok) {\n            ++this.pos;\n            return ch;\n          }\n        };\n\n        StringStream.prototype.eatWhile = function (match) {\n          var start = this.pos;\n\n          while (this.eat(match)) {}\n\n          return this.pos > start;\n        };\n\n        StringStream.prototype.eatSpace = function () {\n          var this$1 = this;\n          var start = this.pos;\n\n          while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) {\n            ++this$1.pos;\n          }\n\n          return this.pos > start;\n        };\n\n        StringStream.prototype.skipToEnd = function () {\n          this.pos = this.string.length;\n        };\n\n        StringStream.prototype.skipTo = function (ch) {\n          var found = this.string.indexOf(ch, this.pos);\n\n          if (found > -1) {\n            this.pos = found;\n            return true;\n          }\n        };\n\n        StringStream.prototype.backUp = function (n) {\n          this.pos -= n;\n        };\n\n        StringStream.prototype.column = function () {\n          if (this.lastColumnPos < this.start) {\n            this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n            this.lastColumnPos = this.start;\n          }\n\n          return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0);\n        };\n\n        StringStream.prototype.indentation = function () {\n          return countColumn(this.string, null, this.tabSize) - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0);\n        };\n\n        StringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n          if (typeof pattern == \"string\") {\n            var cased = function (str) {\n              return caseInsensitive ? str.toLowerCase() : str;\n            };\n\n            var substr = this.string.substr(this.pos, pattern.length);\n\n            if (cased(substr) == cased(pattern)) {\n              if (consume !== false) {\n                this.pos += pattern.length;\n              }\n\n              return true;\n            }\n          } else {\n            var match = this.string.slice(this.pos).match(pattern);\n\n            if (match && match.index > 0) {\n              return null;\n            }\n\n            if (match && consume !== false) {\n              this.pos += match[0].length;\n            }\n\n            return match;\n          }\n        };\n\n        StringStream.prototype.current = function () {\n          return this.string.slice(this.start, this.pos);\n        };\n\n        StringStream.prototype.hideFirstChars = function (n, inner) {\n          this.lineStart += n;\n\n          try {\n            return inner();\n          } finally {\n            this.lineStart -= n;\n          }\n        }; // Compute a style array (an array starting with a mode generation\n        // -- for invalidation -- followed by pairs of end positions and\n        // style strings), which is used to highlight the tokens on the\n        // line.\n\n\n        function highlightLine(cm, line, state, forceToEnd) {\n          // A styles array always starts with a number identifying the\n          // mode/overlays that it is based on (for easy invalidation).\n          var st = [cm.state.modeGen],\n              lineClasses = {}; // Compute the base array of styles\n\n          runMode(cm, line.text, cm.doc.mode, state, function (end, style) {\n            return st.push(end, style);\n          }, lineClasses, forceToEnd); // Run overlays, adjust style array.\n\n          var loop = function (o) {\n            var overlay = cm.state.overlays[o],\n                i = 1,\n                at = 0;\n            runMode(cm, line.text, overlay.mode, true, function (end, style) {\n              var start = i; // Ensure there's a token end at the current position, and that i points at it\n\n              while (at < end) {\n                var i_end = st[i];\n\n                if (i_end > end) {\n                  st.splice(i, 1, end, st[i + 1], i_end);\n                }\n\n                i += 2;\n                at = Math.min(end, i_end);\n              }\n\n              if (!style) {\n                return;\n              }\n\n              if (overlay.opaque) {\n                st.splice(start, i - start, end, \"overlay \" + style);\n                i = start + 2;\n              } else {\n                for (; start < i; start += 2) {\n                  var cur = st[start + 1];\n                  st[start + 1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n                }\n              }\n            }, lineClasses);\n          };\n\n          for (var o = 0; o < cm.state.overlays.length; ++o) loop(o);\n\n          return {\n            styles: st,\n            classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null\n          };\n        }\n\n        function getLineStyles(cm, line, updateFrontier) {\n          if (!line.styles || line.styles[0] != cm.state.modeGen) {\n            var state = getStateBefore(cm, lineNo(line));\n            var result = highlightLine(cm, line, line.text.length > cm.options.maxHighlightLength ? copyState(cm.doc.mode, state) : state);\n            line.stateAfter = state;\n            line.styles = result.styles;\n\n            if (result.classes) {\n              line.styleClasses = result.classes;\n            } else if (line.styleClasses) {\n              line.styleClasses = null;\n            }\n\n            if (updateFrontier === cm.doc.frontier) {\n              cm.doc.frontier++;\n            }\n          }\n\n          return line.styles;\n        }\n\n        function getStateBefore(cm, n, precise) {\n          var doc = cm.doc,\n              display = cm.display;\n\n          if (!doc.mode.startState) {\n            return true;\n          }\n\n          var pos = findStartLine(cm, n, precise),\n              state = pos > doc.first && getLine(doc, pos - 1).stateAfter;\n\n          if (!state) {\n            state = startState(doc.mode);\n          } else {\n            state = copyState(doc.mode, state);\n          }\n\n          doc.iter(pos, n, function (line) {\n            processLine(cm, line.text, state);\n            var save = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo;\n            line.stateAfter = save ? copyState(doc.mode, state) : null;\n            ++pos;\n          });\n\n          if (precise) {\n            doc.frontier = pos;\n          }\n\n          return state;\n        } // Lightweight form of highlight -- proceed over this line and\n        // update state, but don't save a style array. Used for lines that\n        // aren't currently visible.\n\n\n        function processLine(cm, text, state, startAt) {\n          var mode = cm.doc.mode;\n          var stream = new StringStream(text, cm.options.tabSize);\n          stream.start = stream.pos = startAt || 0;\n\n          if (text == \"\") {\n            callBlankLine(mode, state);\n          }\n\n          while (!stream.eol()) {\n            readToken(mode, stream, state);\n            stream.start = stream.pos;\n          }\n        }\n\n        function callBlankLine(mode, state) {\n          if (mode.blankLine) {\n            return mode.blankLine(state);\n          }\n\n          if (!mode.innerMode) {\n            return;\n          }\n\n          var inner = innerMode(mode, state);\n\n          if (inner.mode.blankLine) {\n            return inner.mode.blankLine(inner.state);\n          }\n        }\n\n        function readToken(mode, stream, state, inner) {\n          for (var i = 0; i < 10; i++) {\n            if (inner) {\n              inner[0] = innerMode(mode, state).mode;\n            }\n\n            var style = mode.token(stream, state);\n\n            if (stream.pos > stream.start) {\n              return style;\n            }\n          }\n\n          throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\");\n        } // Utility for getTokenAt and getLineTokens\n\n\n        function takeToken(cm, pos, precise, asArray) {\n          var getObj = function (copy) {\n            return {\n              start: stream.start,\n              end: stream.pos,\n              string: stream.current(),\n              type: style || null,\n              state: copy ? copyState(doc.mode, state) : state\n            };\n          };\n\n          var doc = cm.doc,\n              mode = doc.mode,\n              style;\n          pos = clipPos(doc, pos);\n          var line = getLine(doc, pos.line),\n              state = getStateBefore(cm, pos.line, precise);\n          var stream = new StringStream(line.text, cm.options.tabSize),\n              tokens;\n\n          if (asArray) {\n            tokens = [];\n          }\n\n          while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n            stream.start = stream.pos;\n            style = readToken(mode, stream, state);\n\n            if (asArray) {\n              tokens.push(getObj(true));\n            }\n          }\n\n          return asArray ? tokens : getObj();\n        }\n\n        function extractLineClasses(type, output) {\n          if (type) {\n            for (;;) {\n              var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n\n              if (!lineClass) {\n                break;\n              }\n\n              type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n              var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n\n              if (output[prop] == null) {\n                output[prop] = lineClass[2];\n              } else if (!new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\").test(output[prop])) {\n                output[prop] += \" \" + lineClass[2];\n              }\n            }\n          }\n\n          return type;\n        } // Run the given mode's parser over a line, calling f for each token.\n\n\n        function runMode(cm, text, mode, state, f, lineClasses, forceToEnd) {\n          var flattenSpans = mode.flattenSpans;\n\n          if (flattenSpans == null) {\n            flattenSpans = cm.options.flattenSpans;\n          }\n\n          var curStart = 0,\n              curStyle = null;\n          var stream = new StringStream(text, cm.options.tabSize),\n              style;\n          var inner = cm.options.addModeClass && [null];\n\n          if (text == \"\") {\n            extractLineClasses(callBlankLine(mode, state), lineClasses);\n          }\n\n          while (!stream.eol()) {\n            if (stream.pos > cm.options.maxHighlightLength) {\n              flattenSpans = false;\n\n              if (forceToEnd) {\n                processLine(cm, text, state, stream.pos);\n              }\n\n              stream.pos = text.length;\n              style = null;\n            } else {\n              style = extractLineClasses(readToken(mode, stream, state, inner), lineClasses);\n            }\n\n            if (inner) {\n              var mName = inner[0].name;\n\n              if (mName) {\n                style = \"m-\" + (style ? mName + \" \" + style : mName);\n              }\n            }\n\n            if (!flattenSpans || curStyle != style) {\n              while (curStart < stream.start) {\n                curStart = Math.min(stream.start, curStart + 5000);\n                f(curStart, curStyle);\n              }\n\n              curStyle = style;\n            }\n\n            stream.start = stream.pos;\n          }\n\n          while (curStart < stream.pos) {\n            // Webkit seems to refuse to render text nodes longer than 57444\n            // characters, and returns inaccurate measurements in nodes\n            // starting around 5000 chars.\n            var pos = Math.min(stream.pos, curStart + 5000);\n            f(pos, curStyle);\n            curStart = pos;\n          }\n        } // Finds the line to start with when starting a parse. Tries to\n        // find a line with a stateAfter, so that it can start with a\n        // valid state. If that fails, it returns the line with the\n        // smallest indentation, which tends to need the least context to\n        // parse correctly.\n\n\n        function findStartLine(cm, n, precise) {\n          var minindent,\n              minline,\n              doc = cm.doc;\n          var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n\n          for (var search = n; search > lim; --search) {\n            if (search <= doc.first) {\n              return doc.first;\n            }\n\n            var line = getLine(doc, search - 1);\n\n            if (line.stateAfter && (!precise || search <= doc.frontier)) {\n              return search;\n            }\n\n            var indented = countColumn(line.text, null, cm.options.tabSize);\n\n            if (minline == null || minindent > indented) {\n              minline = search - 1;\n              minindent = indented;\n            }\n          }\n\n          return minline;\n        } // LINE DATA STRUCTURE\n        // Line objects. These hold state related to a line, including\n        // highlighting info (the styles array).\n\n\n        var Line = function (text, markedSpans, estimateHeight) {\n          this.text = text;\n          attachMarkedSpans(this, markedSpans);\n          this.height = estimateHeight ? estimateHeight(this) : 1;\n        };\n\n        Line.prototype.lineNo = function () {\n          return lineNo(this);\n        };\n\n        eventMixin(Line); // Change the content (text, markers) of a line. Automatically\n        // invalidates cached information and tries to re-estimate the\n        // line's height.\n\n        function updateLine(line, text, markedSpans, estimateHeight) {\n          line.text = text;\n\n          if (line.stateAfter) {\n            line.stateAfter = null;\n          }\n\n          if (line.styles) {\n            line.styles = null;\n          }\n\n          if (line.order != null) {\n            line.order = null;\n          }\n\n          detachMarkedSpans(line);\n          attachMarkedSpans(line, markedSpans);\n          var estHeight = estimateHeight ? estimateHeight(line) : 1;\n\n          if (estHeight != line.height) {\n            updateLineHeight(line, estHeight);\n          }\n        } // Detach a line from the document tree and its markers.\n\n\n        function cleanUpLine(line) {\n          line.parent = null;\n          detachMarkedSpans(line);\n        } // Convert a style as returned by a mode (either null, or a string\n        // containing one or more styles) to a CSS style. This is cached,\n        // and also looks for line-wide styles.\n\n\n        var styleToClassCache = {};\n        var styleToClassCacheWithMode = {};\n\n        function interpretTokenStyle(style, options) {\n          if (!style || /^\\s*$/.test(style)) {\n            return null;\n          }\n\n          var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n          return cache[style] || (cache[style] = style.replace(/\\S+/g, \"cm-$&\"));\n        } // Render the DOM representation of the text of a line. Also builds\n        // up a 'line map', which points at the DOM nodes that represent\n        // specific stretches of text, and is used by the measuring code.\n        // The returned object contains the DOM node, this map, and\n        // information about line-wide styles that were set by the mode.\n\n\n        function buildLineContent(cm, lineView) {\n          // The padding-right forces the element to have a 'border', which\n          // is needed on Webkit to be able to get line-level bounding\n          // rectangles for it (in measureChar).\n          var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n          var builder = {\n            pre: eltP(\"pre\", [content], \"CodeMirror-line\"),\n            content: content,\n            col: 0,\n            pos: 0,\n            cm: cm,\n            trailingSpace: false,\n            splitSpaces: (ie || webkit) && cm.getOption(\"lineWrapping\")\n          };\n          lineView.measure = {}; // Iterate over the logical lines that make up this visual line.\n\n          for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n            var line = i ? lineView.rest[i - 1] : lineView.line,\n                order = void 0;\n            builder.pos = 0;\n            builder.addToken = buildToken; // Optionally wire in some hacks into the token-rendering\n            // algorithm, to deal with browser quirks.\n\n            if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction))) {\n              builder.addToken = buildTokenBadBidi(builder.addToken, order);\n            }\n\n            builder.map = [];\n            var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n            insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n\n            if (line.styleClasses) {\n              if (line.styleClasses.bgClass) {\n                builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\");\n              }\n\n              if (line.styleClasses.textClass) {\n                builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\");\n              }\n            } // Ensure at least a single node is present, for measuring.\n\n\n            if (builder.map.length == 0) {\n              builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure)));\n            } // Store the map and a cache object for the current logical line\n\n\n            if (i == 0) {\n              lineView.measure.map = builder.map;\n              lineView.measure.cache = {};\n            } else {\n              (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map);\n              (lineView.measure.caches || (lineView.measure.caches = [])).push({});\n            }\n          } // See issue #2901\n\n\n          if (webkit) {\n            var last = builder.content.lastChild;\n\n            if (/\\bcm-tab\\b/.test(last.className) || last.querySelector && last.querySelector(\".cm-tab\")) {\n              builder.content.className = \"cm-tab-wrap-hack\";\n            }\n          }\n\n          signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n\n          if (builder.pre.className) {\n            builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\");\n          }\n\n          return builder;\n        }\n\n        function defaultSpecialCharPlaceholder(ch) {\n          var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n          token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n          token.setAttribute(\"aria-label\", token.title);\n          return token;\n        } // Build up the DOM representation for a single token, and add it to\n        // the line map. Takes care to render special characters separately.\n\n\n        function buildToken(builder, text, style, startStyle, endStyle, title, css) {\n          if (!text) {\n            return;\n          }\n\n          var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n          var special = builder.cm.state.specialChars,\n              mustWrap = false;\n          var content;\n\n          if (!special.test(text)) {\n            builder.col += text.length;\n            content = document.createTextNode(displayText);\n            builder.map.push(builder.pos, builder.pos + text.length, content);\n\n            if (ie && ie_version < 9) {\n              mustWrap = true;\n            }\n\n            builder.pos += text.length;\n          } else {\n            content = document.createDocumentFragment();\n            var pos = 0;\n\n            while (true) {\n              special.lastIndex = pos;\n              var m = special.exec(text);\n              var skipped = m ? m.index - pos : text.length - pos;\n\n              if (skipped) {\n                var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n\n                if (ie && ie_version < 9) {\n                  content.appendChild(elt(\"span\", [txt]));\n                } else {\n                  content.appendChild(txt);\n                }\n\n                builder.map.push(builder.pos, builder.pos + skipped, txt);\n                builder.col += skipped;\n                builder.pos += skipped;\n              }\n\n              if (!m) {\n                break;\n              }\n\n              pos += skipped + 1;\n              var txt$1 = void 0;\n\n              if (m[0] == \"\\t\") {\n                var tabSize = builder.cm.options.tabSize,\n                    tabWidth = tabSize - builder.col % tabSize;\n                txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n                txt$1.setAttribute(\"role\", \"presentation\");\n                txt$1.setAttribute(\"cm-text\", \"\\t\");\n                builder.col += tabWidth;\n              } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n                txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n                txt$1.setAttribute(\"cm-text\", m[0]);\n                builder.col += 1;\n              } else {\n                txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n                txt$1.setAttribute(\"cm-text\", m[0]);\n\n                if (ie && ie_version < 9) {\n                  content.appendChild(elt(\"span\", [txt$1]));\n                } else {\n                  content.appendChild(txt$1);\n                }\n\n                builder.col += 1;\n              }\n\n              builder.map.push(builder.pos, builder.pos + 1, txt$1);\n              builder.pos++;\n            }\n          }\n\n          builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n\n          if (style || startStyle || endStyle || mustWrap || css) {\n            var fullStyle = style || \"\";\n\n            if (startStyle) {\n              fullStyle += startStyle;\n            }\n\n            if (endStyle) {\n              fullStyle += endStyle;\n            }\n\n            var token = elt(\"span\", [content], fullStyle, css);\n\n            if (title) {\n              token.title = title;\n            }\n\n            return builder.content.appendChild(token);\n          }\n\n          builder.content.appendChild(content);\n        }\n\n        function splitSpaces(text, trailingBefore) {\n          if (text.length > 1 && !/  /.test(text)) {\n            return text;\n          }\n\n          var spaceBefore = trailingBefore,\n              result = \"\";\n\n          for (var i = 0; i < text.length; i++) {\n            var ch = text.charAt(i);\n\n            if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32)) {\n              ch = \"\\u00a0\";\n            }\n\n            result += ch;\n            spaceBefore = ch == \" \";\n          }\n\n          return result;\n        } // Work around nonsense dimensions being reported for stretches of\n        // right-to-left text.\n\n\n        function buildTokenBadBidi(inner, order) {\n          return function (builder, text, style, startStyle, endStyle, title, css) {\n            style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n            var start = builder.pos,\n                end = start + text.length;\n\n            for (;;) {\n              // Find the part that overlaps with the start of this text\n              var part = void 0;\n\n              for (var i = 0; i < order.length; i++) {\n                part = order[i];\n\n                if (part.to > start && part.from <= start) {\n                  break;\n                }\n              }\n\n              if (part.to >= end) {\n                return inner(builder, text, style, startStyle, endStyle, title, css);\n              }\n\n              inner(builder, text.slice(0, part.to - start), style, startStyle, null, title, css);\n              startStyle = null;\n              text = text.slice(part.to - start);\n              start = part.to;\n            }\n          };\n        }\n\n        function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n          var widget = !ignoreWidget && marker.widgetNode;\n\n          if (widget) {\n            builder.map.push(builder.pos, builder.pos + size, widget);\n          }\n\n          if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n            if (!widget) {\n              widget = builder.content.appendChild(document.createElement(\"span\"));\n            }\n\n            widget.setAttribute(\"cm-marker\", marker.id);\n          }\n\n          if (widget) {\n            builder.cm.display.input.setUneditable(widget);\n            builder.content.appendChild(widget);\n          }\n\n          builder.pos += size;\n          builder.trailingSpace = false;\n        } // Outputs a number of spans to make up a line, taking highlighting\n        // and marked text into account.\n\n\n        function insertLineContent(line, builder, styles) {\n          var spans = line.markedSpans,\n              allText = line.text,\n              at = 0;\n\n          if (!spans) {\n            for (var i$1 = 1; i$1 < styles.length; i$1 += 2) {\n              builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1 + 1], builder.cm.options));\n            }\n\n            return;\n          }\n\n          var len = allText.length,\n              pos = 0,\n              i = 1,\n              text = \"\",\n              style,\n              css;\n          var nextChange = 0,\n              spanStyle,\n              spanEndStyle,\n              spanStartStyle,\n              title,\n              collapsed;\n\n          for (;;) {\n            if (nextChange == pos) {\n              // Update current marker set\n              spanStyle = spanEndStyle = spanStartStyle = title = css = \"\";\n              collapsed = null;\n              nextChange = Infinity;\n              var foundBookmarks = [],\n                  endStyles = void 0;\n\n              for (var j = 0; j < spans.length; ++j) {\n                var sp = spans[j],\n                    m = sp.marker;\n\n                if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n                  foundBookmarks.push(m);\n                } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n                  if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n                    nextChange = sp.to;\n                    spanEndStyle = \"\";\n                  }\n\n                  if (m.className) {\n                    spanStyle += \" \" + m.className;\n                  }\n\n                  if (m.css) {\n                    css = (css ? css + \";\" : \"\") + m.css;\n                  }\n\n                  if (m.startStyle && sp.from == pos) {\n                    spanStartStyle += \" \" + m.startStyle;\n                  }\n\n                  if (m.endStyle && sp.to == nextChange) {\n                    (endStyles || (endStyles = [])).push(m.endStyle, sp.to);\n                  }\n\n                  if (m.title && !title) {\n                    title = m.title;\n                  }\n\n                  if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0)) {\n                    collapsed = sp;\n                  }\n                } else if (sp.from > pos && nextChange > sp.from) {\n                  nextChange = sp.from;\n                }\n              }\n\n              if (endStyles) {\n                for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2) {\n                  if (endStyles[j$1 + 1] == nextChange) {\n                    spanEndStyle += \" \" + endStyles[j$1];\n                  }\n                }\n              }\n\n              if (!collapsed || collapsed.from == pos) {\n                for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2) {\n                  buildCollapsedSpan(builder, 0, foundBookmarks[j$2]);\n                }\n              }\n\n              if (collapsed && (collapsed.from || 0) == pos) {\n                buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos, collapsed.marker, collapsed.from == null);\n\n                if (collapsed.to == null) {\n                  return;\n                }\n\n                if (collapsed.to == pos) {\n                  collapsed = false;\n                }\n              }\n            }\n\n            if (pos >= len) {\n              break;\n            }\n\n            var upto = Math.min(len, nextChange);\n\n            while (true) {\n              if (text) {\n                var end = pos + text.length;\n\n                if (!collapsed) {\n                  var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n                  builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle, spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", title, css);\n                }\n\n                if (end >= upto) {\n                  text = text.slice(upto - pos);\n                  pos = upto;\n                  break;\n                }\n\n                pos = end;\n                spanStartStyle = \"\";\n              }\n\n              text = allText.slice(at, at = styles[i++]);\n              style = interpretTokenStyle(styles[i++], builder.cm.options);\n            }\n          }\n        } // These objects are used to represent the visible (currently drawn)\n        // part of the document. A LineView may correspond to multiple\n        // logical lines, if those are connected by collapsed ranges.\n\n\n        function LineView(doc, line, lineN) {\n          // The starting line\n          this.line = line; // Continuing lines, if any\n\n          this.rest = visualLineContinued(line); // Number of logical lines in this visual line\n\n          this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n          this.node = this.text = null;\n          this.hidden = lineIsHidden(doc, line);\n        } // Create a range of LineView objects for the given lines.\n\n\n        function buildViewArray(cm, from, to) {\n          var array = [],\n              nextPos;\n\n          for (var pos = from; pos < to; pos = nextPos) {\n            var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n            nextPos = pos + view.size;\n            array.push(view);\n          }\n\n          return array;\n        }\n\n        var operationGroup = null;\n\n        function pushOperation(op) {\n          if (operationGroup) {\n            operationGroup.ops.push(op);\n          } else {\n            op.ownsGroup = operationGroup = {\n              ops: [op],\n              delayedCallbacks: []\n            };\n          }\n        }\n\n        function fireCallbacksForOps(group) {\n          // Calls delayed callbacks and cursorActivity handlers until no\n          // new ones appear\n          var callbacks = group.delayedCallbacks,\n              i = 0;\n\n          do {\n            for (; i < callbacks.length; i++) {\n              callbacks[i].call(null);\n            }\n\n            for (var j = 0; j < group.ops.length; j++) {\n              var op = group.ops[j];\n\n              if (op.cursorActivityHandlers) {\n                while (op.cursorActivityCalled < op.cursorActivityHandlers.length) {\n                  op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm);\n                }\n              }\n            }\n          } while (i < callbacks.length);\n        }\n\n        function finishOperation(op, endCb) {\n          var group = op.ownsGroup;\n\n          if (!group) {\n            return;\n          }\n\n          try {\n            fireCallbacksForOps(group);\n          } finally {\n            operationGroup = null;\n            endCb(group);\n          }\n        }\n\n        var orphanDelayedCallbacks = null; // Often, we want to signal events at a point where we are in the\n        // middle of some work, but don't want the handler to start calling\n        // other methods on the editor, which might be in an inconsistent\n        // state or simply not expect any other events to happen.\n        // signalLater looks whether there are any handlers, and schedules\n        // them to be executed when the last operation ends, or, if no\n        // operation is active, when a timeout fires.\n\n        function signalLater(emitter, type\n        /*, values...*/\n        ) {\n          var arr = getHandlers(emitter, type);\n\n          if (!arr.length) {\n            return;\n          }\n\n          var args = Array.prototype.slice.call(arguments, 2),\n              list;\n\n          if (operationGroup) {\n            list = operationGroup.delayedCallbacks;\n          } else if (orphanDelayedCallbacks) {\n            list = orphanDelayedCallbacks;\n          } else {\n            list = orphanDelayedCallbacks = [];\n            setTimeout(fireOrphanDelayed, 0);\n          }\n\n          var loop = function (i) {\n            list.push(function () {\n              return arr[i].apply(null, args);\n            });\n          };\n\n          for (var i = 0; i < arr.length; ++i) loop(i);\n        }\n\n        function fireOrphanDelayed() {\n          var delayed = orphanDelayedCallbacks;\n          orphanDelayedCallbacks = null;\n\n          for (var i = 0; i < delayed.length; ++i) {\n            delayed[i]();\n          }\n        } // When an aspect of a line changes, a string is added to\n        // lineView.changes. This updates the relevant part of the line's\n        // DOM structure.\n\n\n        function updateLineForChanges(cm, lineView, lineN, dims) {\n          for (var j = 0; j < lineView.changes.length; j++) {\n            var type = lineView.changes[j];\n\n            if (type == \"text\") {\n              updateLineText(cm, lineView);\n            } else if (type == \"gutter\") {\n              updateLineGutter(cm, lineView, lineN, dims);\n            } else if (type == \"class\") {\n              updateLineClasses(cm, lineView);\n            } else if (type == \"widget\") {\n              updateLineWidgets(cm, lineView, dims);\n            }\n          }\n\n          lineView.changes = null;\n        } // Lines with gutter elements, widgets or a background class need to\n        // be wrapped, and have the extra elements added to the wrapper div\n\n\n        function ensureLineWrapped(lineView) {\n          if (lineView.node == lineView.text) {\n            lineView.node = elt(\"div\", null, null, \"position: relative\");\n\n            if (lineView.text.parentNode) {\n              lineView.text.parentNode.replaceChild(lineView.node, lineView.text);\n            }\n\n            lineView.node.appendChild(lineView.text);\n\n            if (ie && ie_version < 8) {\n              lineView.node.style.zIndex = 2;\n            }\n          }\n\n          return lineView.node;\n        }\n\n        function updateLineBackground(cm, lineView) {\n          var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n\n          if (cls) {\n            cls += \" CodeMirror-linebackground\";\n          }\n\n          if (lineView.background) {\n            if (cls) {\n              lineView.background.className = cls;\n            } else {\n              lineView.background.parentNode.removeChild(lineView.background);\n              lineView.background = null;\n            }\n          } else if (cls) {\n            var wrap = ensureLineWrapped(lineView);\n            lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n            cm.display.input.setUneditable(lineView.background);\n          }\n        } // Wrapper around buildLineContent which will reuse the structure\n        // in display.externalMeasured when possible.\n\n\n        function getLineContent(cm, lineView) {\n          var ext = cm.display.externalMeasured;\n\n          if (ext && ext.line == lineView.line) {\n            cm.display.externalMeasured = null;\n            lineView.measure = ext.measure;\n            return ext.built;\n          }\n\n          return buildLineContent(cm, lineView);\n        } // Redraw the line's text. Interacts with the background and text\n        // classes because the mode may output tokens that influence these\n        // classes.\n\n\n        function updateLineText(cm, lineView) {\n          var cls = lineView.text.className;\n          var built = getLineContent(cm, lineView);\n\n          if (lineView.text == lineView.node) {\n            lineView.node = built.pre;\n          }\n\n          lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n          lineView.text = built.pre;\n\n          if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n            lineView.bgClass = built.bgClass;\n            lineView.textClass = built.textClass;\n            updateLineClasses(cm, lineView);\n          } else if (cls) {\n            lineView.text.className = cls;\n          }\n        }\n\n        function updateLineClasses(cm, lineView) {\n          updateLineBackground(cm, lineView);\n\n          if (lineView.line.wrapClass) {\n            ensureLineWrapped(lineView).className = lineView.line.wrapClass;\n          } else if (lineView.node != lineView.text) {\n            lineView.node.className = \"\";\n          }\n\n          var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n          lineView.text.className = textClass || \"\";\n        }\n\n        function updateLineGutter(cm, lineView, lineN, dims) {\n          if (lineView.gutter) {\n            lineView.node.removeChild(lineView.gutter);\n            lineView.gutter = null;\n          }\n\n          if (lineView.gutterBackground) {\n            lineView.node.removeChild(lineView.gutterBackground);\n            lineView.gutterBackground = null;\n          }\n\n          if (lineView.line.gutterClass) {\n            var wrap = ensureLineWrapped(lineView);\n            lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass, \"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + dims.gutterTotalWidth + \"px\");\n            cm.display.input.setUneditable(lineView.gutterBackground);\n            wrap.insertBefore(lineView.gutterBackground, lineView.text);\n          }\n\n          var markers = lineView.line.gutterMarkers;\n\n          if (cm.options.lineNumbers || markers) {\n            var wrap$1 = ensureLineWrapped(lineView);\n            var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", \"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\");\n            cm.display.input.setUneditable(gutterWrap);\n            wrap$1.insertBefore(gutterWrap, lineView.text);\n\n            if (lineView.line.gutterClass) {\n              gutterWrap.className += \" \" + lineView.line.gutterClass;\n            }\n\n            if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"])) {\n              lineView.lineNumber = gutterWrap.appendChild(elt(\"div\", lineNumberFor(cm.options, lineN), \"CodeMirror-linenumber CodeMirror-gutter-elt\", \"left: \" + dims.gutterLeft[\"CodeMirror-linenumbers\"] + \"px; width: \" + cm.display.lineNumInnerWidth + \"px\"));\n            }\n\n            if (markers) {\n              for (var k = 0; k < cm.options.gutters.length; ++k) {\n                var id = cm.options.gutters[k],\n                    found = markers.hasOwnProperty(id) && markers[id];\n\n                if (found) {\n                  gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\", \"left: \" + dims.gutterLeft[id] + \"px; width: \" + dims.gutterWidth[id] + \"px\"));\n                }\n              }\n            }\n          }\n        }\n\n        function updateLineWidgets(cm, lineView, dims) {\n          if (lineView.alignable) {\n            lineView.alignable = null;\n          }\n\n          for (var node = lineView.node.firstChild, next = void 0; node; node = next) {\n            next = node.nextSibling;\n\n            if (node.className == \"CodeMirror-linewidget\") {\n              lineView.node.removeChild(node);\n            }\n          }\n\n          insertLineWidgets(cm, lineView, dims);\n        } // Build a line's DOM representation from scratch\n\n\n        function buildLineElement(cm, lineView, lineN, dims) {\n          var built = getLineContent(cm, lineView);\n          lineView.text = lineView.node = built.pre;\n\n          if (built.bgClass) {\n            lineView.bgClass = built.bgClass;\n          }\n\n          if (built.textClass) {\n            lineView.textClass = built.textClass;\n          }\n\n          updateLineClasses(cm, lineView);\n          updateLineGutter(cm, lineView, lineN, dims);\n          insertLineWidgets(cm, lineView, dims);\n          return lineView.node;\n        } // A lineView may contain multiple logical lines (when merged by\n        // collapsed spans). The widgets for all of them need to be drawn.\n\n\n        function insertLineWidgets(cm, lineView, dims) {\n          insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n\n          if (lineView.rest) {\n            for (var i = 0; i < lineView.rest.length; i++) {\n              insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false);\n            }\n          }\n        }\n\n        function insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n          if (!line.widgets) {\n            return;\n          }\n\n          var wrap = ensureLineWrapped(lineView);\n\n          for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n            var widget = ws[i],\n                node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\");\n\n            if (!widget.handleMouseEvents) {\n              node.setAttribute(\"cm-ignore-events\", \"true\");\n            }\n\n            positionLineWidget(widget, node, lineView, dims);\n            cm.display.input.setUneditable(node);\n\n            if (allowAbove && widget.above) {\n              wrap.insertBefore(node, lineView.gutter || lineView.text);\n            } else {\n              wrap.appendChild(node);\n            }\n\n            signalLater(widget, \"redraw\");\n          }\n        }\n\n        function positionLineWidget(widget, node, lineView, dims) {\n          if (widget.noHScroll) {\n            (lineView.alignable || (lineView.alignable = [])).push(node);\n            var width = dims.wrapperWidth;\n            node.style.left = dims.fixedPos + \"px\";\n\n            if (!widget.coverGutter) {\n              width -= dims.gutterTotalWidth;\n              node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n            }\n\n            node.style.width = width + \"px\";\n          }\n\n          if (widget.coverGutter) {\n            node.style.zIndex = 5;\n            node.style.position = \"relative\";\n\n            if (!widget.noHScroll) {\n              node.style.marginLeft = -dims.gutterTotalWidth + \"px\";\n            }\n          }\n        }\n\n        function widgetHeight(widget) {\n          if (widget.height != null) {\n            return widget.height;\n          }\n\n          var cm = widget.doc.cm;\n\n          if (!cm) {\n            return 0;\n          }\n\n          if (!contains(document.body, widget.node)) {\n            var parentStyle = \"position: relative;\";\n\n            if (widget.coverGutter) {\n              parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\";\n            }\n\n            if (widget.noHScroll) {\n              parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\";\n            }\n\n            removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n          }\n\n          return widget.height = widget.node.parentNode.offsetHeight;\n        } // Return true when the given mouse event happened in a widget\n\n\n        function eventInWidget(display, e) {\n          for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n            if (!n || n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\" || n.parentNode == display.sizer && n != display.mover) {\n              return true;\n            }\n          }\n        } // POSITION MEASUREMENT\n\n\n        function paddingTop(display) {\n          return display.lineSpace.offsetTop;\n        }\n\n        function paddingVert(display) {\n          return display.mover.offsetHeight - display.lineSpace.offsetHeight;\n        }\n\n        function paddingH(display) {\n          if (display.cachedPaddingH) {\n            return display.cachedPaddingH;\n          }\n\n          var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\"));\n          var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n          var data = {\n            left: parseInt(style.paddingLeft),\n            right: parseInt(style.paddingRight)\n          };\n\n          if (!isNaN(data.left) && !isNaN(data.right)) {\n            display.cachedPaddingH = data;\n          }\n\n          return data;\n        }\n\n        function scrollGap(cm) {\n          return scrollerGap - cm.display.nativeBarWidth;\n        }\n\n        function displayWidth(cm) {\n          return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth;\n        }\n\n        function displayHeight(cm) {\n          return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight;\n        } // Ensure the lineView.wrapping.heights array is populated. This is\n        // an array of bottom offsets for the lines that make up a drawn\n        // line. When lineWrapping is on, there might be more than one\n        // height.\n\n\n        function ensureLineHeights(cm, lineView, rect) {\n          var wrapping = cm.options.lineWrapping;\n          var curWidth = wrapping && displayWidth(cm);\n\n          if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n            var heights = lineView.measure.heights = [];\n\n            if (wrapping) {\n              lineView.measure.width = curWidth;\n              var rects = lineView.text.firstChild.getClientRects();\n\n              for (var i = 0; i < rects.length - 1; i++) {\n                var cur = rects[i],\n                    next = rects[i + 1];\n\n                if (Math.abs(cur.bottom - next.bottom) > 2) {\n                  heights.push((cur.bottom + next.top) / 2 - rect.top);\n                }\n              }\n            }\n\n            heights.push(rect.bottom - rect.top);\n          }\n        } // Find a line map (mapping character offsets to text nodes) and a\n        // measurement cache for the given line number. (A line view might\n        // contain multiple lines when collapsed ranges are present.)\n\n\n        function mapFromLineView(lineView, line, lineN) {\n          if (lineView.line == line) {\n            return {\n              map: lineView.measure.map,\n              cache: lineView.measure.cache\n            };\n          }\n\n          for (var i = 0; i < lineView.rest.length; i++) {\n            if (lineView.rest[i] == line) {\n              return {\n                map: lineView.measure.maps[i],\n                cache: lineView.measure.caches[i]\n              };\n            }\n          }\n\n          for (var i$1 = 0; i$1 < lineView.rest.length; i$1++) {\n            if (lineNo(lineView.rest[i$1]) > lineN) {\n              return {\n                map: lineView.measure.maps[i$1],\n                cache: lineView.measure.caches[i$1],\n                before: true\n              };\n            }\n          }\n        } // Render a line into the hidden node display.externalMeasured. Used\n        // when measurement is needed for a line that's not in the viewport.\n\n\n        function updateExternalMeasurement(cm, line) {\n          line = visualLine(line);\n          var lineN = lineNo(line);\n          var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n          view.lineN = lineN;\n          var built = view.built = buildLineContent(cm, view);\n          view.text = built.pre;\n          removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n          return view;\n        } // Get a {top, bottom, left, right} box (in line-local coordinates)\n        // for a given character.\n\n\n        function measureChar(cm, line, ch, bias) {\n          return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias);\n        } // Find a line view that corresponds to the given line number.\n\n\n        function findViewForLine(cm, lineN) {\n          if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo) {\n            return cm.display.view[findViewIndex(cm, lineN)];\n          }\n\n          var ext = cm.display.externalMeasured;\n\n          if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size) {\n            return ext;\n          }\n        } // Measurement can be split in two steps, the set-up work that\n        // applies to the whole line, and the measurement of the actual\n        // character. Functions like coordsChar, that need to do a lot of\n        // measurements in a row, can thus ensure that the set-up work is\n        // only done once.\n\n\n        function prepareMeasureForLine(cm, line) {\n          var lineN = lineNo(line);\n          var view = findViewForLine(cm, lineN);\n\n          if (view && !view.text) {\n            view = null;\n          } else if (view && view.changes) {\n            updateLineForChanges(cm, view, lineN, getDimensions(cm));\n            cm.curOp.forceUpdate = true;\n          }\n\n          if (!view) {\n            view = updateExternalMeasurement(cm, line);\n          }\n\n          var info = mapFromLineView(view, line, lineN);\n          return {\n            line: line,\n            view: view,\n            rect: null,\n            map: info.map,\n            cache: info.cache,\n            before: info.before,\n            hasHeights: false\n          };\n        } // Given a prepared measurement object, measures the position of an\n        // actual character (or fetches it from the cache).\n\n\n        function measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n          if (prepared.before) {\n            ch = -1;\n          }\n\n          var key = ch + (bias || \"\"),\n              found;\n\n          if (prepared.cache.hasOwnProperty(key)) {\n            found = prepared.cache[key];\n          } else {\n            if (!prepared.rect) {\n              prepared.rect = prepared.view.text.getBoundingClientRect();\n            }\n\n            if (!prepared.hasHeights) {\n              ensureLineHeights(cm, prepared.view, prepared.rect);\n              prepared.hasHeights = true;\n            }\n\n            found = measureCharInner(cm, prepared, ch, bias);\n\n            if (!found.bogus) {\n              prepared.cache[key] = found;\n            }\n          }\n\n          return {\n            left: found.left,\n            right: found.right,\n            top: varHeight ? found.rtop : found.top,\n            bottom: varHeight ? found.rbottom : found.bottom\n          };\n        }\n\n        var nullRect = {\n          left: 0,\n          right: 0,\n          top: 0,\n          bottom: 0\n        };\n\n        function nodeAndOffsetInLineMap(map$$1, ch, bias) {\n          var node, start, end, collapse, mStart, mEnd; // First, search the line map for the text node corresponding to,\n          // or closest to, the target character.\n\n          for (var i = 0; i < map$$1.length; i += 3) {\n            mStart = map$$1[i];\n            mEnd = map$$1[i + 1];\n\n            if (ch < mStart) {\n              start = 0;\n              end = 1;\n              collapse = \"left\";\n            } else if (ch < mEnd) {\n              start = ch - mStart;\n              end = start + 1;\n            } else if (i == map$$1.length - 3 || ch == mEnd && map$$1[i + 3] > ch) {\n              end = mEnd - mStart;\n              start = end - 1;\n\n              if (ch >= mEnd) {\n                collapse = \"right\";\n              }\n            }\n\n            if (start != null) {\n              node = map$$1[i + 2];\n\n              if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\")) {\n                collapse = bias;\n              }\n\n              if (bias == \"left\" && start == 0) {\n                while (i && map$$1[i - 2] == map$$1[i - 3] && map$$1[i - 1].insertLeft) {\n                  node = map$$1[(i -= 3) + 2];\n                  collapse = \"left\";\n                }\n              }\n\n              if (bias == \"right\" && start == mEnd - mStart) {\n                while (i < map$$1.length - 3 && map$$1[i + 3] == map$$1[i + 4] && !map$$1[i + 5].insertLeft) {\n                  node = map$$1[(i += 3) + 2];\n                  collapse = \"right\";\n                }\n              }\n\n              break;\n            }\n          }\n\n          return {\n            node: node,\n            start: start,\n            end: end,\n            collapse: collapse,\n            coverStart: mStart,\n            coverEnd: mEnd\n          };\n        }\n\n        function getUsefulRect(rects, bias) {\n          var rect = nullRect;\n\n          if (bias == \"left\") {\n            for (var i = 0; i < rects.length; i++) {\n              if ((rect = rects[i]).left != rect.right) {\n                break;\n              }\n            }\n          } else {\n            for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n              if ((rect = rects[i$1]).left != rect.right) {\n                break;\n              }\n            }\n          }\n\n          return rect;\n        }\n\n        function measureCharInner(cm, prepared, ch, bias) {\n          var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n          var node = place.node,\n              start = place.start,\n              end = place.end,\n              collapse = place.collapse;\n          var rect;\n\n          if (node.nodeType == 3) {\n            // If it is a text node, use a range to retrieve the coordinates.\n            for (var i$1 = 0; i$1 < 4; i$1++) {\n              // Retry a maximum of 4 times when nonsense rectangles are returned\n              while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) {\n                --start;\n              }\n\n              while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) {\n                ++end;\n              }\n\n              if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart) {\n                rect = node.parentNode.getBoundingClientRect();\n              } else {\n                rect = getUsefulRect(range(node, start, end).getClientRects(), bias);\n              }\n\n              if (rect.left || rect.right || start == 0) {\n                break;\n              }\n\n              end = start;\n              start = start - 1;\n              collapse = \"right\";\n            }\n\n            if (ie && ie_version < 11) {\n              rect = maybeUpdateRectForZooming(cm.display.measure, rect);\n            }\n          } else {\n            // If it is a widget, simply get the box for the whole widget.\n            if (start > 0) {\n              collapse = bias = \"right\";\n            }\n\n            var rects;\n\n            if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1) {\n              rect = rects[bias == \"right\" ? rects.length - 1 : 0];\n            } else {\n              rect = node.getBoundingClientRect();\n            }\n          }\n\n          if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n            var rSpan = node.parentNode.getClientRects()[0];\n\n            if (rSpan) {\n              rect = {\n                left: rSpan.left,\n                right: rSpan.left + charWidth(cm.display),\n                top: rSpan.top,\n                bottom: rSpan.bottom\n              };\n            } else {\n              rect = nullRect;\n            }\n          }\n\n          var rtop = rect.top - prepared.rect.top,\n              rbot = rect.bottom - prepared.rect.top;\n          var mid = (rtop + rbot) / 2;\n          var heights = prepared.view.measure.heights;\n          var i = 0;\n\n          for (; i < heights.length - 1; i++) {\n            if (mid < heights[i]) {\n              break;\n            }\n          }\n\n          var top = i ? heights[i - 1] : 0,\n              bot = heights[i];\n          var result = {\n            left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n            right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n            top: top,\n            bottom: bot\n          };\n\n          if (!rect.left && !rect.right) {\n            result.bogus = true;\n          }\n\n          if (!cm.options.singleCursorHeightPerLine) {\n            result.rtop = rtop;\n            result.rbottom = rbot;\n          }\n\n          return result;\n        } // Work around problem with bounding client rects on ranges being\n        // returned incorrectly when zoomed on IE10 and below.\n\n\n        function maybeUpdateRectForZooming(measure, rect) {\n          if (!window.screen || screen.logicalXDPI == null || screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure)) {\n            return rect;\n          }\n\n          var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n          var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n          return {\n            left: rect.left * scaleX,\n            right: rect.right * scaleX,\n            top: rect.top * scaleY,\n            bottom: rect.bottom * scaleY\n          };\n        }\n\n        function clearLineMeasurementCacheFor(lineView) {\n          if (lineView.measure) {\n            lineView.measure.cache = {};\n            lineView.measure.heights = null;\n\n            if (lineView.rest) {\n              for (var i = 0; i < lineView.rest.length; i++) {\n                lineView.measure.caches[i] = {};\n              }\n            }\n          }\n        }\n\n        function clearLineMeasurementCache(cm) {\n          cm.display.externalMeasure = null;\n          removeChildren(cm.display.lineMeasure);\n\n          for (var i = 0; i < cm.display.view.length; i++) {\n            clearLineMeasurementCacheFor(cm.display.view[i]);\n          }\n        }\n\n        function clearCaches(cm) {\n          clearLineMeasurementCache(cm);\n          cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n\n          if (!cm.options.lineWrapping) {\n            cm.display.maxLineChanged = true;\n          }\n\n          cm.display.lineNumChars = null;\n        }\n\n        function pageScrollX() {\n          // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n          // which causes page_Offset and bounding client rects to use\n          // different reference viewports and invalidate our calculations.\n          if (chrome && android) {\n            return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft));\n          }\n\n          return window.pageXOffset || (document.documentElement || document.body).scrollLeft;\n        }\n\n        function pageScrollY() {\n          if (chrome && android) {\n            return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop));\n          }\n\n          return window.pageYOffset || (document.documentElement || document.body).scrollTop;\n        } // Converts a {top, bottom, left, right} box from line-local\n        // coordinates into another coordinate system. Context may be one of\n        // \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n        // or \"page\".\n\n\n        function intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n          if (!includeWidgets && lineObj.widgets) {\n            for (var i = 0; i < lineObj.widgets.length; ++i) {\n              if (lineObj.widgets[i].above) {\n                var size = widgetHeight(lineObj.widgets[i]);\n                rect.top += size;\n                rect.bottom += size;\n              }\n            }\n          }\n\n          if (context == \"line\") {\n            return rect;\n          }\n\n          if (!context) {\n            context = \"local\";\n          }\n\n          var yOff = heightAtLine(lineObj);\n\n          if (context == \"local\") {\n            yOff += paddingTop(cm.display);\n          } else {\n            yOff -= cm.display.viewOffset;\n          }\n\n          if (context == \"page\" || context == \"window\") {\n            var lOff = cm.display.lineSpace.getBoundingClientRect();\n            yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n            var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n            rect.left += xOff;\n            rect.right += xOff;\n          }\n\n          rect.top += yOff;\n          rect.bottom += yOff;\n          return rect;\n        } // Coverts a box from \"div\" coords to another coordinate system.\n        // Context may be \"window\", \"page\", \"div\", or \"local\"./null.\n\n\n        function fromCoordSystem(cm, coords, context) {\n          if (context == \"div\") {\n            return coords;\n          }\n\n          var left = coords.left,\n              top = coords.top; // First move into \"page\" coordinate system\n\n          if (context == \"page\") {\n            left -= pageScrollX();\n            top -= pageScrollY();\n          } else if (context == \"local\" || !context) {\n            var localBox = cm.display.sizer.getBoundingClientRect();\n            left += localBox.left;\n            top += localBox.top;\n          }\n\n          var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n          return {\n            left: left - lineSpaceBox.left,\n            top: top - lineSpaceBox.top\n          };\n        }\n\n        function charCoords(cm, pos, context, lineObj, bias) {\n          if (!lineObj) {\n            lineObj = getLine(cm.doc, pos.line);\n          }\n\n          return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context);\n        } // Returns a box for a given cursor position, which may have an\n        // 'other' property containing the position of the secondary cursor\n        // on a bidi boundary.\n        // A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n        // and after `char - 1` in writing order of `char - 1`\n        // A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n        // and before `char` in writing order of `char`\n        // Examples (upper-case letters are RTL, lower-case are LTR):\n        //     Pos(0, 1, ...)\n        //     before   after\n        // ab     a|b     a|b\n        // aB     a|B     aB|\n        // Ab     |Ab     A|b\n        // AB     B|A     B|A\n        // Every position after the last character on a line is considered to stick\n        // to the last character on the line.\n\n\n        function cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n          lineObj = lineObj || getLine(cm.doc, pos.line);\n\n          if (!preparedMeasure) {\n            preparedMeasure = prepareMeasureForLine(cm, lineObj);\n          }\n\n          function get(ch, right) {\n            var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n\n            if (right) {\n              m.left = m.right;\n            } else {\n              m.right = m.left;\n            }\n\n            return intoCoordSystem(cm, lineObj, m, context);\n          }\n\n          var order = getOrder(lineObj, cm.doc.direction),\n              ch = pos.ch,\n              sticky = pos.sticky;\n\n          if (ch >= lineObj.text.length) {\n            ch = lineObj.text.length;\n            sticky = \"before\";\n          } else if (ch <= 0) {\n            ch = 0;\n            sticky = \"after\";\n          }\n\n          if (!order) {\n            return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\");\n          }\n\n          function getBidi(ch, partPos, invert) {\n            var part = order[partPos],\n                right = part.level % 2 != 0;\n            return get(invert ? ch - 1 : ch, right != invert);\n          }\n\n          var partPos = getBidiPartAt(order, ch, sticky);\n          var other = bidiOther;\n          var val = getBidi(ch, partPos, sticky == \"before\");\n\n          if (other != null) {\n            val.other = getBidi(ch, other, sticky != \"before\");\n          }\n\n          return val;\n        } // Used to cheaply estimate the coordinates for a position. Used for\n        // intermediate scroll updates.\n\n\n        function estimateCoords(cm, pos) {\n          var left = 0;\n          pos = clipPos(cm.doc, pos);\n\n          if (!cm.options.lineWrapping) {\n            left = charWidth(cm.display) * pos.ch;\n          }\n\n          var lineObj = getLine(cm.doc, pos.line);\n          var top = heightAtLine(lineObj) + paddingTop(cm.display);\n          return {\n            left: left,\n            right: left,\n            top: top,\n            bottom: top + lineObj.height\n          };\n        } // Positions returned by coordsChar contain some extra information.\n        // xRel is the relative x position of the input coordinates compared\n        // to the found position (so xRel > 0 means the coordinates are to\n        // the right of the character position, for example). When outside\n        // is true, that means the coordinates lie outside the line's\n        // vertical range.\n\n\n        function PosWithInfo(line, ch, sticky, outside, xRel) {\n          var pos = Pos(line, ch, sticky);\n          pos.xRel = xRel;\n\n          if (outside) {\n            pos.outside = true;\n          }\n\n          return pos;\n        } // Compute the character position closest to the given coordinates.\n        // Input must be lineSpace-local (\"div\" coordinate system).\n\n\n        function coordsChar(cm, x, y) {\n          var doc = cm.doc;\n          y += cm.display.viewOffset;\n\n          if (y < 0) {\n            return PosWithInfo(doc.first, 0, null, true, -1);\n          }\n\n          var lineN = lineAtHeight(doc, y),\n              last = doc.first + doc.size - 1;\n\n          if (lineN > last) {\n            return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, true, 1);\n          }\n\n          if (x < 0) {\n            x = 0;\n          }\n\n          var lineObj = getLine(doc, lineN);\n\n          for (;;) {\n            var found = coordsCharInner(cm, lineObj, lineN, x, y);\n            var merged = collapsedSpanAtEnd(lineObj);\n            var mergedPos = merged && merged.find(0, true);\n\n            if (merged && (found.ch > mergedPos.from.ch || found.ch == mergedPos.from.ch && found.xRel > 0)) {\n              lineN = lineNo(lineObj = mergedPos.to.line);\n            } else {\n              return found;\n            }\n          }\n        }\n\n        function wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n          var measure = function (ch) {\n            return intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, ch), \"line\");\n          };\n\n          var end = lineObj.text.length;\n          var begin = findFirst(function (ch) {\n            return measure(ch - 1).bottom <= y;\n          }, end, 0);\n          end = findFirst(function (ch) {\n            return measure(ch).top > y;\n          }, begin, end);\n          return {\n            begin: begin,\n            end: end\n          };\n        }\n\n        function wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n          var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n          return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop);\n        }\n\n        function coordsCharInner(cm, lineObj, lineNo$$1, x, y) {\n          y -= heightAtLine(lineObj);\n          var begin = 0,\n              end = lineObj.text.length;\n          var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n          var pos;\n          var order = getOrder(lineObj, cm.doc.direction);\n\n          if (order) {\n            if (cm.options.lineWrapping) {\n              var assign;\n              assign = wrappedLineExtent(cm, lineObj, preparedMeasure, y), begin = assign.begin, end = assign.end, assign;\n            }\n\n            pos = new Pos(lineNo$$1, begin);\n            var beginLeft = cursorCoords(cm, pos, \"line\", lineObj, preparedMeasure).left;\n            var dir = beginLeft < x ? 1 : -1;\n            var prevDiff,\n                diff = beginLeft - x,\n                prevPos;\n\n            do {\n              prevDiff = diff;\n              prevPos = pos;\n              pos = moveVisually(cm, lineObj, pos, dir);\n\n              if (pos == null || pos.ch < begin || end <= (pos.sticky == \"before\" ? pos.ch - 1 : pos.ch)) {\n                pos = prevPos;\n                break;\n              }\n\n              diff = cursorCoords(cm, pos, \"line\", lineObj, preparedMeasure).left - x;\n            } while (dir < 0 != diff < 0 && Math.abs(diff) <= Math.abs(prevDiff));\n\n            if (Math.abs(diff) > Math.abs(prevDiff)) {\n              if (diff < 0 == prevDiff < 0) {\n                throw new Error(\"Broke out of infinite loop in coordsCharInner\");\n              }\n\n              pos = prevPos;\n            }\n          } else {\n            var ch = findFirst(function (ch) {\n              var box = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, ch), \"line\");\n\n              if (box.top > y) {\n                // For the cursor stickiness\n                end = Math.min(ch, end);\n                return true;\n              } else if (box.bottom <= y) {\n                return false;\n              } else if (box.left > x) {\n                return true;\n              } else if (box.right < x) {\n                return false;\n              } else {\n                return x - box.left < box.right - x;\n              }\n            }, begin, end);\n            ch = skipExtendingChars(lineObj.text, ch, 1);\n            pos = new Pos(lineNo$$1, ch, ch == end ? \"before\" : \"after\");\n          }\n\n          var coords = cursorCoords(cm, pos, \"line\", lineObj, preparedMeasure);\n\n          if (y < coords.top || coords.bottom < y) {\n            pos.outside = true;\n          }\n\n          pos.xRel = x < coords.left ? -1 : x > coords.right ? 1 : 0;\n          return pos;\n        }\n\n        var measureText; // Compute the default text height.\n\n        function textHeight(display) {\n          if (display.cachedTextHeight != null) {\n            return display.cachedTextHeight;\n          }\n\n          if (measureText == null) {\n            measureText = elt(\"pre\"); // Measure a bunch of lines, for browsers that compute\n            // fractional heights.\n\n            for (var i = 0; i < 49; ++i) {\n              measureText.appendChild(document.createTextNode(\"x\"));\n              measureText.appendChild(elt(\"br\"));\n            }\n\n            measureText.appendChild(document.createTextNode(\"x\"));\n          }\n\n          removeChildrenAndAdd(display.measure, measureText);\n          var height = measureText.offsetHeight / 50;\n\n          if (height > 3) {\n            display.cachedTextHeight = height;\n          }\n\n          removeChildren(display.measure);\n          return height || 1;\n        } // Compute the default character width.\n\n\n        function charWidth(display) {\n          if (display.cachedCharWidth != null) {\n            return display.cachedCharWidth;\n          }\n\n          var anchor = elt(\"span\", \"xxxxxxxxxx\");\n          var pre = elt(\"pre\", [anchor]);\n          removeChildrenAndAdd(display.measure, pre);\n          var rect = anchor.getBoundingClientRect(),\n              width = (rect.right - rect.left) / 10;\n\n          if (width > 2) {\n            display.cachedCharWidth = width;\n          }\n\n          return width || 10;\n        } // Do a bulk-read of the DOM positions and sizes needed to draw the\n        // view, so that we don't interleave reading and writing to the DOM.\n\n\n        function getDimensions(cm) {\n          var d = cm.display,\n              left = {},\n              width = {};\n          var gutterLeft = d.gutters.clientLeft;\n\n          for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n            left[cm.options.gutters[i]] = n.offsetLeft + n.clientLeft + gutterLeft;\n            width[cm.options.gutters[i]] = n.clientWidth;\n          }\n\n          return {\n            fixedPos: compensateForHScroll(d),\n            gutterTotalWidth: d.gutters.offsetWidth,\n            gutterLeft: left,\n            gutterWidth: width,\n            wrapperWidth: d.wrapper.clientWidth\n          };\n        } // Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n        // but using getBoundingClientRect to get a sub-pixel-accurate\n        // result.\n\n\n        function compensateForHScroll(display) {\n          return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left;\n        } // Returns a function that estimates the height of a line, to use as\n        // first approximation until the line becomes visible (and is thus\n        // properly measurable).\n\n\n        function estimateHeight(cm) {\n          var th = textHeight(cm.display),\n              wrapping = cm.options.lineWrapping;\n          var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n          return function (line) {\n            if (lineIsHidden(cm.doc, line)) {\n              return 0;\n            }\n\n            var widgetsHeight = 0;\n\n            if (line.widgets) {\n              for (var i = 0; i < line.widgets.length; i++) {\n                if (line.widgets[i].height) {\n                  widgetsHeight += line.widgets[i].height;\n                }\n              }\n            }\n\n            if (wrapping) {\n              return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th;\n            } else {\n              return widgetsHeight + th;\n            }\n          };\n        }\n\n        function estimateLineHeights(cm) {\n          var doc = cm.doc,\n              est = estimateHeight(cm);\n          doc.iter(function (line) {\n            var estHeight = est(line);\n\n            if (estHeight != line.height) {\n              updateLineHeight(line, estHeight);\n            }\n          });\n        } // Given a mouse event, find the corresponding position. If liberal\n        // is false, it checks whether a gutter or scrollbar was clicked,\n        // and returns null if it was. forRect is used by rectangular\n        // selections, and tries to estimate a character position even for\n        // coordinates beyond the right of the text.\n\n\n        function posFromMouse(cm, e, liberal, forRect) {\n          var display = cm.display;\n\n          if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") {\n            return null;\n          }\n\n          var x,\n              y,\n              space = display.lineSpace.getBoundingClientRect(); // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n\n          try {\n            x = e.clientX - space.left;\n            y = e.clientY - space.top;\n          } catch (e) {\n            return null;\n          }\n\n          var coords = coordsChar(cm, x, y),\n              line;\n\n          if (forRect && coords.xRel == 1 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n            var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n            coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n          }\n\n          return coords;\n        } // Find the view element corresponding to a given line. Return null\n        // when the line isn't visible.\n\n\n        function findViewIndex(cm, n) {\n          if (n >= cm.display.viewTo) {\n            return null;\n          }\n\n          n -= cm.display.viewFrom;\n\n          if (n < 0) {\n            return null;\n          }\n\n          var view = cm.display.view;\n\n          for (var i = 0; i < view.length; i++) {\n            n -= view[i].size;\n\n            if (n < 0) {\n              return i;\n            }\n          }\n        }\n\n        function updateSelection(cm) {\n          cm.display.input.showSelection(cm.display.input.prepareSelection());\n        }\n\n        function prepareSelection(cm, primary) {\n          var doc = cm.doc,\n              result = {};\n          var curFragment = result.cursors = document.createDocumentFragment();\n          var selFragment = result.selection = document.createDocumentFragment();\n\n          for (var i = 0; i < doc.sel.ranges.length; i++) {\n            if (primary === false && i == doc.sel.primIndex) {\n              continue;\n            }\n\n            var range$$1 = doc.sel.ranges[i];\n\n            if (range$$1.from().line >= cm.display.viewTo || range$$1.to().line < cm.display.viewFrom) {\n              continue;\n            }\n\n            var collapsed = range$$1.empty();\n\n            if (collapsed || cm.options.showCursorWhenSelecting) {\n              drawSelectionCursor(cm, range$$1.head, curFragment);\n            }\n\n            if (!collapsed) {\n              drawSelectionRange(cm, range$$1, selFragment);\n            }\n          }\n\n          return result;\n        } // Draws a cursor for the given range\n\n\n        function drawSelectionCursor(cm, head, output) {\n          var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n          var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n          cursor.style.left = pos.left + \"px\";\n          cursor.style.top = pos.top + \"px\";\n          cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n          if (pos.other) {\n            // Secondary cursor, shown when on a 'jump' in bi-directional text\n            var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n            otherCursor.style.display = \"\";\n            otherCursor.style.left = pos.other.left + \"px\";\n            otherCursor.style.top = pos.other.top + \"px\";\n            otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n          }\n        } // Draws the given range as a highlighted selection\n\n\n        function drawSelectionRange(cm, range$$1, output) {\n          var display = cm.display,\n              doc = cm.doc;\n          var fragment = document.createDocumentFragment();\n          var padding = paddingH(cm.display),\n              leftSide = padding.left;\n          var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n\n          function add(left, top, width, bottom) {\n            if (top < 0) {\n              top = 0;\n            }\n\n            top = Math.round(top);\n            bottom = Math.round(bottom);\n            fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", \"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\"));\n          }\n\n          function drawForLine(line, fromArg, toArg) {\n            var lineObj = getLine(doc, line);\n            var lineLen = lineObj.text.length;\n            var start, end;\n\n            function coords(ch, bias) {\n              return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias);\n            }\n\n            iterateBidiSections(getOrder(lineObj, doc.direction), fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir) {\n              var leftPos = coords(from, \"left\"),\n                  rightPos,\n                  left,\n                  right;\n\n              if (from == to) {\n                rightPos = leftPos;\n                left = right = leftPos.left;\n              } else {\n                rightPos = coords(to - 1, \"right\");\n\n                if (dir == \"rtl\") {\n                  var tmp = leftPos;\n                  leftPos = rightPos;\n                  rightPos = tmp;\n                }\n\n                left = leftPos.left;\n                right = rightPos.right;\n              }\n\n              if (fromArg == null && from == 0) {\n                left = leftSide;\n              }\n\n              if (rightPos.top - leftPos.top > 3) {\n                // Different lines, draw top part\n                add(left, leftPos.top, null, leftPos.bottom);\n                left = leftSide;\n\n                if (leftPos.bottom < rightPos.top) {\n                  add(left, leftPos.bottom, null, rightPos.top);\n                }\n              }\n\n              if (toArg == null && to == lineLen) {\n                right = rightSide;\n              }\n\n              if (!start || leftPos.top < start.top || leftPos.top == start.top && leftPos.left < start.left) {\n                start = leftPos;\n              }\n\n              if (!end || rightPos.bottom > end.bottom || rightPos.bottom == end.bottom && rightPos.right > end.right) {\n                end = rightPos;\n              }\n\n              if (left < leftSide + 1) {\n                left = leftSide;\n              }\n\n              add(left, rightPos.top, right - left, rightPos.bottom);\n            });\n            return {\n              start: start,\n              end: end\n            };\n          }\n\n          var sFrom = range$$1.from(),\n              sTo = range$$1.to();\n\n          if (sFrom.line == sTo.line) {\n            drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n          } else {\n            var fromLine = getLine(doc, sFrom.line),\n                toLine = getLine(doc, sTo.line);\n            var singleVLine = visualLine(fromLine) == visualLine(toLine);\n            var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n            var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n\n            if (singleVLine) {\n              if (leftEnd.top < rightStart.top - 2) {\n                add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n                add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n              } else {\n                add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n              }\n            }\n\n            if (leftEnd.bottom < rightStart.top) {\n              add(leftSide, leftEnd.bottom, null, rightStart.top);\n            }\n          }\n\n          output.appendChild(fragment);\n        } // Cursor-blinking\n\n\n        function restartBlink(cm) {\n          if (!cm.state.focused) {\n            return;\n          }\n\n          var display = cm.display;\n          clearInterval(display.blinker);\n          var on = true;\n          display.cursorDiv.style.visibility = \"\";\n\n          if (cm.options.cursorBlinkRate > 0) {\n            display.blinker = setInterval(function () {\n              return display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\";\n            }, cm.options.cursorBlinkRate);\n          } else if (cm.options.cursorBlinkRate < 0) {\n            display.cursorDiv.style.visibility = \"hidden\";\n          }\n        }\n\n        function ensureFocus(cm) {\n          if (!cm.state.focused) {\n            cm.display.input.focus();\n            onFocus(cm);\n          }\n        }\n\n        function delayBlurEvent(cm) {\n          cm.state.delayingBlurEvent = true;\n          setTimeout(function () {\n            if (cm.state.delayingBlurEvent) {\n              cm.state.delayingBlurEvent = false;\n              onBlur(cm);\n            }\n          }, 100);\n        }\n\n        function onFocus(cm, e) {\n          if (cm.state.delayingBlurEvent) {\n            cm.state.delayingBlurEvent = false;\n          }\n\n          if (cm.options.readOnly == \"nocursor\") {\n            return;\n          }\n\n          if (!cm.state.focused) {\n            signal(cm, \"focus\", cm, e);\n            cm.state.focused = true;\n            addClass(cm.display.wrapper, \"CodeMirror-focused\"); // This test prevents this from firing when a context\n            // menu is closed (since the input reset would kill the\n            // select-all detection hack)\n\n            if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n              cm.display.input.reset();\n\n              if (webkit) {\n                setTimeout(function () {\n                  return cm.display.input.reset(true);\n                }, 20);\n              } // Issue #1730\n\n            }\n\n            cm.display.input.receivedFocus();\n          }\n\n          restartBlink(cm);\n        }\n\n        function onBlur(cm, e) {\n          if (cm.state.delayingBlurEvent) {\n            return;\n          }\n\n          if (cm.state.focused) {\n            signal(cm, \"blur\", cm, e);\n            cm.state.focused = false;\n            rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n          }\n\n          clearInterval(cm.display.blinker);\n          setTimeout(function () {\n            if (!cm.state.focused) {\n              cm.display.shift = false;\n            }\n          }, 150);\n        } // Read the actual heights of the rendered lines, and update their\n        // stored heights to match.\n\n\n        function updateHeightsInViewport(cm) {\n          var display = cm.display;\n          var prevBottom = display.lineDiv.offsetTop;\n\n          for (var i = 0; i < display.view.length; i++) {\n            var cur = display.view[i],\n                height = void 0;\n\n            if (cur.hidden) {\n              continue;\n            }\n\n            if (ie && ie_version < 8) {\n              var bot = cur.node.offsetTop + cur.node.offsetHeight;\n              height = bot - prevBottom;\n              prevBottom = bot;\n            } else {\n              var box = cur.node.getBoundingClientRect();\n              height = box.bottom - box.top;\n            }\n\n            var diff = cur.line.height - height;\n\n            if (height < 2) {\n              height = textHeight(display);\n            }\n\n            if (diff > .001 || diff < -.001) {\n              updateLineHeight(cur.line, height);\n              updateWidgetHeight(cur.line);\n\n              if (cur.rest) {\n                for (var j = 0; j < cur.rest.length; j++) {\n                  updateWidgetHeight(cur.rest[j]);\n                }\n              }\n            }\n          }\n        } // Read and store the height of line widgets associated with the\n        // given line.\n\n\n        function updateWidgetHeight(line) {\n          if (line.widgets) {\n            for (var i = 0; i < line.widgets.length; ++i) {\n              line.widgets[i].height = line.widgets[i].node.parentNode.offsetHeight;\n            }\n          }\n        } // Compute the lines that are visible in a given viewport (defaults\n        // the the current scroll position). viewport may contain top,\n        // height, and ensure (see op.scrollToPos) properties.\n\n\n        function visibleLines(display, doc, viewport) {\n          var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n          top = Math.floor(top - paddingTop(display));\n          var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n          var from = lineAtHeight(doc, top),\n              to = lineAtHeight(doc, bottom); // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n          // forces those lines into the viewport (if possible).\n\n          if (viewport && viewport.ensure) {\n            var ensureFrom = viewport.ensure.from.line,\n                ensureTo = viewport.ensure.to.line;\n\n            if (ensureFrom < from) {\n              from = ensureFrom;\n              to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n            } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n              from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n              to = ensureTo;\n            }\n          }\n\n          return {\n            from: from,\n            to: Math.max(to, from + 1)\n          };\n        } // Re-align line numbers and gutter marks to compensate for\n        // horizontal scrolling.\n\n\n        function alignHorizontally(cm) {\n          var display = cm.display,\n              view = display.view;\n\n          if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) {\n            return;\n          }\n\n          var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n          var gutterW = display.gutters.offsetWidth,\n              left = comp + \"px\";\n\n          for (var i = 0; i < view.length; i++) {\n            if (!view[i].hidden) {\n              if (cm.options.fixedGutter) {\n                if (view[i].gutter) {\n                  view[i].gutter.style.left = left;\n                }\n\n                if (view[i].gutterBackground) {\n                  view[i].gutterBackground.style.left = left;\n                }\n              }\n\n              var align = view[i].alignable;\n\n              if (align) {\n                for (var j = 0; j < align.length; j++) {\n                  align[j].style.left = left;\n                }\n              }\n            }\n          }\n\n          if (cm.options.fixedGutter) {\n            display.gutters.style.left = comp + gutterW + \"px\";\n          }\n        } // Used to ensure that the line number gutter is still the right\n        // size for the current document size. Returns true when an update\n        // is needed.\n\n\n        function maybeUpdateLineNumberWidth(cm) {\n          if (!cm.options.lineNumbers) {\n            return false;\n          }\n\n          var doc = cm.doc,\n              last = lineNumberFor(cm.options, doc.first + doc.size - 1),\n              display = cm.display;\n\n          if (last.length != display.lineNumChars) {\n            var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)], \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n            var innerW = test.firstChild.offsetWidth,\n                padding = test.offsetWidth - innerW;\n            display.lineGutter.style.width = \"\";\n            display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n            display.lineNumWidth = display.lineNumInnerWidth + padding;\n            display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n            display.lineGutter.style.width = display.lineNumWidth + \"px\";\n            updateGutterSpace(cm);\n            return true;\n          }\n\n          return false;\n        } // SCROLLING THINGS INTO VIEW\n        // If an editor sits on the top or bottom of the window, partially\n        // scrolled out of view, this ensures that the cursor is visible.\n\n\n        function maybeScrollWindow(cm, rect) {\n          if (signalDOMEvent(cm, \"scrollCursorIntoView\")) {\n            return;\n          }\n\n          var display = cm.display,\n              box = display.sizer.getBoundingClientRect(),\n              doScroll = null;\n\n          if (rect.top + box.top < 0) {\n            doScroll = true;\n          } else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) {\n            doScroll = false;\n          }\n\n          if (doScroll != null && !phantom) {\n            var scrollNode = elt(\"div\", \"\\u200b\", null, \"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + rect.left + \"px; width: \" + Math.max(2, rect.right - rect.left) + \"px;\");\n            cm.display.lineSpace.appendChild(scrollNode);\n            scrollNode.scrollIntoView(doScroll);\n            cm.display.lineSpace.removeChild(scrollNode);\n          }\n        } // Scroll a given position into view (immediately), verifying that\n        // it actually became visible (as line heights are accurately\n        // measured, the position of something may 'drift' during drawing).\n\n\n        function scrollPosIntoView(cm, pos, end, margin) {\n          if (margin == null) {\n            margin = 0;\n          }\n\n          var rect;\n\n          for (var limit = 0; limit < 5; limit++) {\n            var changed = false;\n            var coords = cursorCoords(cm, pos);\n            var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n            rect = {\n              left: Math.min(coords.left, endCoords.left),\n              top: Math.min(coords.top, endCoords.top) - margin,\n              right: Math.max(coords.left, endCoords.left),\n              bottom: Math.max(coords.bottom, endCoords.bottom) + margin\n            };\n            var scrollPos = calculateScrollPos(cm, rect);\n            var startTop = cm.doc.scrollTop,\n                startLeft = cm.doc.scrollLeft;\n\n            if (scrollPos.scrollTop != null) {\n              updateScrollTop(cm, scrollPos.scrollTop);\n\n              if (Math.abs(cm.doc.scrollTop - startTop) > 1) {\n                changed = true;\n              }\n            }\n\n            if (scrollPos.scrollLeft != null) {\n              setScrollLeft(cm, scrollPos.scrollLeft);\n\n              if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) {\n                changed = true;\n              }\n            }\n\n            if (!changed) {\n              break;\n            }\n          }\n\n          return rect;\n        } // Scroll a given set of coordinates into view (immediately).\n\n\n        function scrollIntoView(cm, rect) {\n          var scrollPos = calculateScrollPos(cm, rect);\n\n          if (scrollPos.scrollTop != null) {\n            updateScrollTop(cm, scrollPos.scrollTop);\n          }\n\n          if (scrollPos.scrollLeft != null) {\n            setScrollLeft(cm, scrollPos.scrollLeft);\n          }\n        } // Calculate a new scroll position needed to scroll the given\n        // rectangle into view. Returns an object with scrollTop and\n        // scrollLeft properties. When these are undefined, the\n        // vertical/horizontal position does not need to be adjusted.\n\n\n        function calculateScrollPos(cm, rect) {\n          var display = cm.display,\n              snapMargin = textHeight(cm.display);\n\n          if (rect.top < 0) {\n            rect.top = 0;\n          }\n\n          var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n          var screen = displayHeight(cm),\n              result = {};\n\n          if (rect.bottom - rect.top > screen) {\n            rect.bottom = rect.top + screen;\n          }\n\n          var docBottom = cm.doc.height + paddingVert(display);\n          var atTop = rect.top < snapMargin,\n              atBottom = rect.bottom > docBottom - snapMargin;\n\n          if (rect.top < screentop) {\n            result.scrollTop = atTop ? 0 : rect.top;\n          } else if (rect.bottom > screentop + screen) {\n            var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n\n            if (newTop != screentop) {\n              result.scrollTop = newTop;\n            }\n          }\n\n          var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n          var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0);\n          var tooWide = rect.right - rect.left > screenw;\n\n          if (tooWide) {\n            rect.right = rect.left + screenw;\n          }\n\n          if (rect.left < 10) {\n            result.scrollLeft = 0;\n          } else if (rect.left < screenleft) {\n            result.scrollLeft = Math.max(0, rect.left - (tooWide ? 0 : 10));\n          } else if (rect.right > screenw + screenleft - 3) {\n            result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw;\n          }\n\n          return result;\n        } // Store a relative adjustment to the scroll position in the current\n        // operation (to be applied when the operation finishes).\n\n\n        function addToScrollTop(cm, top) {\n          if (top == null) {\n            return;\n          }\n\n          resolveScrollToPos(cm);\n          cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n        } // Make sure that at the end of the operation the current cursor is\n        // shown.\n\n\n        function ensureCursorVisible(cm) {\n          resolveScrollToPos(cm);\n          var cur = cm.getCursor(),\n              from = cur,\n              to = cur;\n\n          if (!cm.options.lineWrapping) {\n            from = cur.ch ? Pos(cur.line, cur.ch - 1) : cur;\n            to = Pos(cur.line, cur.ch + 1);\n          }\n\n          cm.curOp.scrollToPos = {\n            from: from,\n            to: to,\n            margin: cm.options.cursorScrollMargin\n          };\n        }\n\n        function scrollToCoords(cm, x, y) {\n          if (x != null || y != null) {\n            resolveScrollToPos(cm);\n          }\n\n          if (x != null) {\n            cm.curOp.scrollLeft = x;\n          }\n\n          if (y != null) {\n            cm.curOp.scrollTop = y;\n          }\n        }\n\n        function scrollToRange(cm, range$$1) {\n          resolveScrollToPos(cm);\n          cm.curOp.scrollToPos = range$$1;\n        } // When an operation has its scrollToPos property set, and another\n        // scroll action is applied before the end of the operation, this\n        // 'simulates' scrolling that position into view in a cheap way, so\n        // that the effect of intermediate scroll commands is not ignored.\n\n\n        function resolveScrollToPos(cm) {\n          var range$$1 = cm.curOp.scrollToPos;\n\n          if (range$$1) {\n            cm.curOp.scrollToPos = null;\n            var from = estimateCoords(cm, range$$1.from),\n                to = estimateCoords(cm, range$$1.to);\n            scrollToCoordsRange(cm, from, to, range$$1.margin);\n          }\n        }\n\n        function scrollToCoordsRange(cm, from, to, margin) {\n          var sPos = calculateScrollPos(cm, {\n            left: Math.min(from.left, to.left),\n            top: Math.min(from.top, to.top) - margin,\n            right: Math.max(from.right, to.right),\n            bottom: Math.max(from.bottom, to.bottom) + margin\n          });\n          scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n        } // Sync the scrollable area and scrollbars, ensure the viewport\n        // covers the visible area.\n\n\n        function updateScrollTop(cm, val) {\n          if (Math.abs(cm.doc.scrollTop - val) < 2) {\n            return;\n          }\n\n          if (!gecko) {\n            updateDisplaySimple(cm, {\n              top: val\n            });\n          }\n\n          setScrollTop(cm, val, true);\n\n          if (gecko) {\n            updateDisplaySimple(cm);\n          }\n\n          startWorker(cm, 100);\n        }\n\n        function setScrollTop(cm, val, forceScroll) {\n          val = Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val);\n\n          if (cm.display.scroller.scrollTop == val && !forceScroll) {\n            return;\n          }\n\n          cm.doc.scrollTop = val;\n          cm.display.scrollbars.setScrollTop(val);\n\n          if (cm.display.scroller.scrollTop != val) {\n            cm.display.scroller.scrollTop = val;\n          }\n        } // Sync scroller and scrollbar, ensure the gutter elements are\n        // aligned.\n\n\n        function setScrollLeft(cm, val, isScroller, forceScroll) {\n          val = Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth);\n\n          if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) {\n            return;\n          }\n\n          cm.doc.scrollLeft = val;\n          alignHorizontally(cm);\n\n          if (cm.display.scroller.scrollLeft != val) {\n            cm.display.scroller.scrollLeft = val;\n          }\n\n          cm.display.scrollbars.setScrollLeft(val);\n        } // SCROLLBARS\n        // Prepare DOM reads needed to update the scrollbars. Done in one\n        // shot to minimize update/measure roundtrips.\n\n\n        function measureForScrollbars(cm) {\n          var d = cm.display,\n              gutterW = d.gutters.offsetWidth;\n          var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n          return {\n            clientHeight: d.scroller.clientHeight,\n            viewHeight: d.wrapper.clientHeight,\n            scrollWidth: d.scroller.scrollWidth,\n            clientWidth: d.scroller.clientWidth,\n            viewWidth: d.wrapper.clientWidth,\n            barLeft: cm.options.fixedGutter ? gutterW : 0,\n            docHeight: docH,\n            scrollHeight: docH + scrollGap(cm) + d.barHeight,\n            nativeBarWidth: d.nativeBarWidth,\n            gutterWidth: gutterW\n          };\n        }\n\n        var NativeScrollbars = function (place, scroll, cm) {\n          this.cm = cm;\n          var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n          var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n          place(vert);\n          place(horiz);\n          on(vert, \"scroll\", function () {\n            if (vert.clientHeight) {\n              scroll(vert.scrollTop, \"vertical\");\n            }\n          });\n          on(horiz, \"scroll\", function () {\n            if (horiz.clientWidth) {\n              scroll(horiz.scrollLeft, \"horizontal\");\n            }\n          });\n          this.checkedZeroWidth = false; // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n\n          if (ie && ie_version < 8) {\n            this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\";\n          }\n        };\n\n        NativeScrollbars.prototype.update = function (measure) {\n          var needsH = measure.scrollWidth > measure.clientWidth + 1;\n          var needsV = measure.scrollHeight > measure.clientHeight + 1;\n          var sWidth = measure.nativeBarWidth;\n\n          if (needsV) {\n            this.vert.style.display = \"block\";\n            this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n            var totalHeight = measure.viewHeight - (needsH ? sWidth : 0); // A bug in IE8 can cause this value to be negative, so guard it.\n\n            this.vert.firstChild.style.height = Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n          } else {\n            this.vert.style.display = \"\";\n            this.vert.firstChild.style.height = \"0\";\n          }\n\n          if (needsH) {\n            this.horiz.style.display = \"block\";\n            this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n            this.horiz.style.left = measure.barLeft + \"px\";\n            var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n            this.horiz.firstChild.style.width = Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n          } else {\n            this.horiz.style.display = \"\";\n            this.horiz.firstChild.style.width = \"0\";\n          }\n\n          if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n            if (sWidth == 0) {\n              this.zeroWidthHack();\n            }\n\n            this.checkedZeroWidth = true;\n          }\n\n          return {\n            right: needsV ? sWidth : 0,\n            bottom: needsH ? sWidth : 0\n          };\n        };\n\n        NativeScrollbars.prototype.setScrollLeft = function (pos) {\n          if (this.horiz.scrollLeft != pos) {\n            this.horiz.scrollLeft = pos;\n          }\n\n          if (this.disableHoriz) {\n            this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\");\n          }\n        };\n\n        NativeScrollbars.prototype.setScrollTop = function (pos) {\n          if (this.vert.scrollTop != pos) {\n            this.vert.scrollTop = pos;\n          }\n\n          if (this.disableVert) {\n            this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\");\n          }\n        };\n\n        NativeScrollbars.prototype.zeroWidthHack = function () {\n          var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n          this.horiz.style.height = this.vert.style.width = w;\n          this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\";\n          this.disableHoriz = new Delayed();\n          this.disableVert = new Delayed();\n        };\n\n        NativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n          bar.style.pointerEvents = \"auto\";\n\n          function maybeDisable() {\n            // To find out whether the scrollbar is still visible, we\n            // check whether the element under the pixel in the bottom\n            // right corner of the scrollbar box is the scrollbar box\n            // itself (when the bar is still visible) or its filler child\n            // (when the bar is hidden). If it is still visible, we keep\n            // it enabled, if it's hidden, we disable pointer events.\n            var box = bar.getBoundingClientRect();\n            var elt$$1 = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2) : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n\n            if (elt$$1 != bar) {\n              bar.style.pointerEvents = \"none\";\n            } else {\n              delay.set(1000, maybeDisable);\n            }\n          }\n\n          delay.set(1000, maybeDisable);\n        };\n\n        NativeScrollbars.prototype.clear = function () {\n          var parent = this.horiz.parentNode;\n          parent.removeChild(this.horiz);\n          parent.removeChild(this.vert);\n        };\n\n        var NullScrollbars = function () {};\n\n        NullScrollbars.prototype.update = function () {\n          return {\n            bottom: 0,\n            right: 0\n          };\n        };\n\n        NullScrollbars.prototype.setScrollLeft = function () {};\n\n        NullScrollbars.prototype.setScrollTop = function () {};\n\n        NullScrollbars.prototype.clear = function () {};\n\n        function updateScrollbars(cm, measure) {\n          if (!measure) {\n            measure = measureForScrollbars(cm);\n          }\n\n          var startWidth = cm.display.barWidth,\n              startHeight = cm.display.barHeight;\n          updateScrollbarsInner(cm, measure);\n\n          for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n            if (startWidth != cm.display.barWidth && cm.options.lineWrapping) {\n              updateHeightsInViewport(cm);\n            }\n\n            updateScrollbarsInner(cm, measureForScrollbars(cm));\n            startWidth = cm.display.barWidth;\n            startHeight = cm.display.barHeight;\n          }\n        } // Re-synchronize the fake scrollbars with the actual size of the\n        // content.\n\n\n        function updateScrollbarsInner(cm, measure) {\n          var d = cm.display;\n          var sizes = d.scrollbars.update(measure);\n          d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n          d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n          d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n          if (sizes.right && sizes.bottom) {\n            d.scrollbarFiller.style.display = \"block\";\n            d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n            d.scrollbarFiller.style.width = sizes.right + \"px\";\n          } else {\n            d.scrollbarFiller.style.display = \"\";\n          }\n\n          if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n            d.gutterFiller.style.display = \"block\";\n            d.gutterFiller.style.height = sizes.bottom + \"px\";\n            d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n          } else {\n            d.gutterFiller.style.display = \"\";\n          }\n        }\n\n        var scrollbarModel = {\n          \"native\": NativeScrollbars,\n          \"null\": NullScrollbars\n        };\n\n        function initScrollbars(cm) {\n          if (cm.display.scrollbars) {\n            cm.display.scrollbars.clear();\n\n            if (cm.display.scrollbars.addClass) {\n              rmClass(cm.display.wrapper, cm.display.scrollbars.addClass);\n            }\n          }\n\n          cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n            cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller); // Prevent clicks in the scrollbars from killing focus\n\n            on(node, \"mousedown\", function () {\n              if (cm.state.focused) {\n                setTimeout(function () {\n                  return cm.display.input.focus();\n                }, 0);\n              }\n            });\n            node.setAttribute(\"cm-not-content\", \"true\");\n          }, function (pos, axis) {\n            if (axis == \"horizontal\") {\n              setScrollLeft(cm, pos);\n            } else {\n              updateScrollTop(cm, pos);\n            }\n          }, cm);\n\n          if (cm.display.scrollbars.addClass) {\n            addClass(cm.display.wrapper, cm.display.scrollbars.addClass);\n          }\n        } // Operations are used to wrap a series of changes to the editor\n        // state in such a way that each change won't have to update the\n        // cursor and display (which would be awkward, slow, and\n        // error-prone). Instead, display updates are batched and then all\n        // combined and executed at once.\n\n\n        var nextOpId = 0; // Start a new operation.\n\n        function startOperation(cm) {\n          cm.curOp = {\n            cm: cm,\n            viewChanged: false,\n            // Flag that indicates that lines might need to be redrawn\n            startHeight: cm.doc.height,\n            // Used to detect need to update scrollbar\n            forceUpdate: false,\n            // Used to force a redraw\n            updateInput: null,\n            // Whether to reset the input textarea\n            typing: false,\n            // Whether this reset should be careful to leave existing text (for compositing)\n            changeObjs: null,\n            // Accumulated changes, for firing change events\n            cursorActivityHandlers: null,\n            // Set of handlers to fire cursorActivity on\n            cursorActivityCalled: 0,\n            // Tracks which cursorActivity handlers have been called already\n            selectionChanged: false,\n            // Whether the selection needs to be redrawn\n            updateMaxLine: false,\n            // Set when the widest line needs to be determined anew\n            scrollLeft: null,\n            scrollTop: null,\n            // Intermediate scroll position, not pushed to DOM yet\n            scrollToPos: null,\n            // Used to scroll to a specific position\n            focus: false,\n            id: ++nextOpId // Unique ID\n\n          };\n          pushOperation(cm.curOp);\n        } // Finish an operation, updating the display and signalling delayed events\n\n\n        function endOperation(cm) {\n          var op = cm.curOp;\n          finishOperation(op, function (group) {\n            for (var i = 0; i < group.ops.length; i++) {\n              group.ops[i].cm.curOp = null;\n            }\n\n            endOperations(group);\n          });\n        } // The DOM updates done when an operation finishes are batched so\n        // that the minimum number of relayouts are required.\n\n\n        function endOperations(group) {\n          var ops = group.ops;\n\n          for (var i = 0; i < ops.length; i++) // Read DOM\n          {\n            endOperation_R1(ops[i]);\n          }\n\n          for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n          {\n            endOperation_W1(ops[i$1]);\n          }\n\n          for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n          {\n            endOperation_R2(ops[i$2]);\n          }\n\n          for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n          {\n            endOperation_W2(ops[i$3]);\n          }\n\n          for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n          {\n            endOperation_finish(ops[i$4]);\n          }\n        }\n\n        function endOperation_R1(op) {\n          var cm = op.cm,\n              display = cm.display;\n          maybeClipScrollbars(cm);\n\n          if (op.updateMaxLine) {\n            findMaxLine(cm);\n          }\n\n          op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null || op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom || op.scrollToPos.to.line >= display.viewTo) || display.maxLineChanged && cm.options.lineWrapping;\n          op.update = op.mustUpdate && new DisplayUpdate(cm, op.mustUpdate && {\n            top: op.scrollTop,\n            ensure: op.scrollToPos\n          }, op.forceUpdate);\n        }\n\n        function endOperation_W1(op) {\n          op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n        }\n\n        function endOperation_R2(op) {\n          var cm = op.cm,\n              display = cm.display;\n\n          if (op.updatedDisplay) {\n            updateHeightsInViewport(cm);\n          }\n\n          op.barMeasure = measureForScrollbars(cm); // If the max line changed since it was last measured, measure it,\n          // and ensure the document's width matches it.\n          // updateDisplay_W2 will use these properties to do the actual resizing\n\n          if (display.maxLineChanged && !cm.options.lineWrapping) {\n            op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n            cm.display.sizerWidth = op.adjustWidthTo;\n            op.barMeasure.scrollWidth = Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n            op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n          }\n\n          if (op.updatedDisplay || op.selectionChanged) {\n            op.preparedSelection = display.input.prepareSelection(op.focus);\n          }\n        }\n\n        function endOperation_W2(op) {\n          var cm = op.cm;\n\n          if (op.adjustWidthTo != null) {\n            cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n\n            if (op.maxScrollLeft < cm.doc.scrollLeft) {\n              setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true);\n            }\n\n            cm.display.maxLineChanged = false;\n          }\n\n          var takeFocus = op.focus && op.focus == activeElt() && (!document.hasFocus || document.hasFocus());\n\n          if (op.preparedSelection) {\n            cm.display.input.showSelection(op.preparedSelection, takeFocus);\n          }\n\n          if (op.updatedDisplay || op.startHeight != cm.doc.height) {\n            updateScrollbars(cm, op.barMeasure);\n          }\n\n          if (op.updatedDisplay) {\n            setDocumentHeight(cm, op.barMeasure);\n          }\n\n          if (op.selectionChanged) {\n            restartBlink(cm);\n          }\n\n          if (cm.state.focused && op.updateInput) {\n            cm.display.input.reset(op.typing);\n          }\n\n          if (takeFocus) {\n            ensureFocus(op.cm);\n          }\n        }\n\n        function endOperation_finish(op) {\n          var cm = op.cm,\n              display = cm.display,\n              doc = cm.doc;\n\n          if (op.updatedDisplay) {\n            postUpdateDisplay(cm, op.update);\n          } // Abort mouse wheel delta measurement, when scrolling explicitly\n\n\n          if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos)) {\n            display.wheelStartX = display.wheelStartY = null;\n          } // Propagate the scroll position to the actual DOM scroller\n\n\n          if (op.scrollTop != null) {\n            setScrollTop(cm, op.scrollTop, op.forceScroll);\n          }\n\n          if (op.scrollLeft != null) {\n            setScrollLeft(cm, op.scrollLeft, true, true);\n          } // If we need to scroll a specific position into view, do so.\n\n\n          if (op.scrollToPos) {\n            var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from), clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n            maybeScrollWindow(cm, rect);\n          } // Fire events for markers that are hidden/unidden by editing or\n          // undoing\n\n\n          var hidden = op.maybeHiddenMarkers,\n              unhidden = op.maybeUnhiddenMarkers;\n\n          if (hidden) {\n            for (var i = 0; i < hidden.length; ++i) {\n              if (!hidden[i].lines.length) {\n                signal(hidden[i], \"hide\");\n              }\n            }\n          }\n\n          if (unhidden) {\n            for (var i$1 = 0; i$1 < unhidden.length; ++i$1) {\n              if (unhidden[i$1].lines.length) {\n                signal(unhidden[i$1], \"unhide\");\n              }\n            }\n          }\n\n          if (display.wrapper.offsetHeight) {\n            doc.scrollTop = cm.display.scroller.scrollTop;\n          } // Fire change events, and delayed event handlers\n\n\n          if (op.changeObjs) {\n            signal(cm, \"changes\", cm, op.changeObjs);\n          }\n\n          if (op.update) {\n            op.update.finish();\n          }\n        } // Run the given function in an operation\n\n\n        function runInOp(cm, f) {\n          if (cm.curOp) {\n            return f();\n          }\n\n          startOperation(cm);\n\n          try {\n            return f();\n          } finally {\n            endOperation(cm);\n          }\n        } // Wraps a function in an operation. Returns the wrapped function.\n\n\n        function operation(cm, f) {\n          return function () {\n            if (cm.curOp) {\n              return f.apply(cm, arguments);\n            }\n\n            startOperation(cm);\n\n            try {\n              return f.apply(cm, arguments);\n            } finally {\n              endOperation(cm);\n            }\n          };\n        } // Used to add methods to editor and doc instances, wrapping them in\n        // operations.\n\n\n        function methodOp(f) {\n          return function () {\n            if (this.curOp) {\n              return f.apply(this, arguments);\n            }\n\n            startOperation(this);\n\n            try {\n              return f.apply(this, arguments);\n            } finally {\n              endOperation(this);\n            }\n          };\n        }\n\n        function docMethodOp(f) {\n          return function () {\n            var cm = this.cm;\n\n            if (!cm || cm.curOp) {\n              return f.apply(this, arguments);\n            }\n\n            startOperation(cm);\n\n            try {\n              return f.apply(this, arguments);\n            } finally {\n              endOperation(cm);\n            }\n          };\n        } // Updates the display.view data structure for a given change to the\n        // document. From and to are in pre-change coordinates. Lendiff is\n        // the amount of lines added or subtracted by the change. This is\n        // used for changes that span multiple lines, or change the way\n        // lines are divided into visual lines. regLineChange (below)\n        // registers single-line changes.\n\n\n        function regChange(cm, from, to, lendiff) {\n          if (from == null) {\n            from = cm.doc.first;\n          }\n\n          if (to == null) {\n            to = cm.doc.first + cm.doc.size;\n          }\n\n          if (!lendiff) {\n            lendiff = 0;\n          }\n\n          var display = cm.display;\n\n          if (lendiff && to < display.viewTo && (display.updateLineNumbers == null || display.updateLineNumbers > from)) {\n            display.updateLineNumbers = from;\n          }\n\n          cm.curOp.viewChanged = true;\n\n          if (from >= display.viewTo) {\n            // Change after\n            if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo) {\n              resetView(cm);\n            }\n          } else if (to <= display.viewFrom) {\n            // Change before\n            if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n              resetView(cm);\n            } else {\n              display.viewFrom += lendiff;\n              display.viewTo += lendiff;\n            }\n          } else if (from <= display.viewFrom && to >= display.viewTo) {\n            // Full overlap\n            resetView(cm);\n          } else if (from <= display.viewFrom) {\n            // Top overlap\n            var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n\n            if (cut) {\n              display.view = display.view.slice(cut.index);\n              display.viewFrom = cut.lineN;\n              display.viewTo += lendiff;\n            } else {\n              resetView(cm);\n            }\n          } else if (to >= display.viewTo) {\n            // Bottom overlap\n            var cut$1 = viewCuttingPoint(cm, from, from, -1);\n\n            if (cut$1) {\n              display.view = display.view.slice(0, cut$1.index);\n              display.viewTo = cut$1.lineN;\n            } else {\n              resetView(cm);\n            }\n          } else {\n            // Gap in the middle\n            var cutTop = viewCuttingPoint(cm, from, from, -1);\n            var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n\n            if (cutTop && cutBot) {\n              display.view = display.view.slice(0, cutTop.index).concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN)).concat(display.view.slice(cutBot.index));\n              display.viewTo += lendiff;\n            } else {\n              resetView(cm);\n            }\n          }\n\n          var ext = display.externalMeasured;\n\n          if (ext) {\n            if (to < ext.lineN) {\n              ext.lineN += lendiff;\n            } else if (from < ext.lineN + ext.size) {\n              display.externalMeasured = null;\n            }\n          }\n        } // Register a change to a single line. Type must be one of \"text\",\n        // \"gutter\", \"class\", \"widget\"\n\n\n        function regLineChange(cm, line, type) {\n          cm.curOp.viewChanged = true;\n          var display = cm.display,\n              ext = cm.display.externalMeasured;\n\n          if (ext && line >= ext.lineN && line < ext.lineN + ext.size) {\n            display.externalMeasured = null;\n          }\n\n          if (line < display.viewFrom || line >= display.viewTo) {\n            return;\n          }\n\n          var lineView = display.view[findViewIndex(cm, line)];\n\n          if (lineView.node == null) {\n            return;\n          }\n\n          var arr = lineView.changes || (lineView.changes = []);\n\n          if (indexOf(arr, type) == -1) {\n            arr.push(type);\n          }\n        } // Clear the view.\n\n\n        function resetView(cm) {\n          cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n          cm.display.view = [];\n          cm.display.viewOffset = 0;\n        }\n\n        function viewCuttingPoint(cm, oldN, newN, dir) {\n          var index = findViewIndex(cm, oldN),\n              diff,\n              view = cm.display.view;\n\n          if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size) {\n            return {\n              index: index,\n              lineN: newN\n            };\n          }\n\n          var n = cm.display.viewFrom;\n\n          for (var i = 0; i < index; i++) {\n            n += view[i].size;\n          }\n\n          if (n != oldN) {\n            if (dir > 0) {\n              if (index == view.length - 1) {\n                return null;\n              }\n\n              diff = n + view[index].size - oldN;\n              index++;\n            } else {\n              diff = n - oldN;\n            }\n\n            oldN += diff;\n            newN += diff;\n          }\n\n          while (visualLineNo(cm.doc, newN) != newN) {\n            if (index == (dir < 0 ? 0 : view.length - 1)) {\n              return null;\n            }\n\n            newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n            index += dir;\n          }\n\n          return {\n            index: index,\n            lineN: newN\n          };\n        } // Force the view to cover a given range, adding empty view element\n        // or clipping off existing ones as needed.\n\n\n        function adjustView(cm, from, to) {\n          var display = cm.display,\n              view = display.view;\n\n          if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n            display.view = buildViewArray(cm, from, to);\n            display.viewFrom = from;\n          } else {\n            if (display.viewFrom > from) {\n              display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view);\n            } else if (display.viewFrom < from) {\n              display.view = display.view.slice(findViewIndex(cm, from));\n            }\n\n            display.viewFrom = from;\n\n            if (display.viewTo < to) {\n              display.view = display.view.concat(buildViewArray(cm, display.viewTo, to));\n            } else if (display.viewTo > to) {\n              display.view = display.view.slice(0, findViewIndex(cm, to));\n            }\n          }\n\n          display.viewTo = to;\n        } // Count the number of lines in the view whose DOM representation is\n        // out of date (or nonexistent).\n\n\n        function countDirtyView(cm) {\n          var view = cm.display.view,\n              dirty = 0;\n\n          for (var i = 0; i < view.length; i++) {\n            var lineView = view[i];\n\n            if (!lineView.hidden && (!lineView.node || lineView.changes)) {\n              ++dirty;\n            }\n          }\n\n          return dirty;\n        } // HIGHLIGHT WORKER\n\n\n        function startWorker(cm, time) {\n          if (cm.doc.mode.startState && cm.doc.frontier < cm.display.viewTo) {\n            cm.state.highlight.set(time, bind(highlightWorker, cm));\n          }\n        }\n\n        function highlightWorker(cm) {\n          var doc = cm.doc;\n\n          if (doc.frontier < doc.first) {\n            doc.frontier = doc.first;\n          }\n\n          if (doc.frontier >= cm.display.viewTo) {\n            return;\n          }\n\n          var end = +new Date() + cm.options.workTime;\n          var state = copyState(doc.mode, getStateBefore(cm, doc.frontier));\n          var changedLines = [];\n          doc.iter(doc.frontier, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n            if (doc.frontier >= cm.display.viewFrom) {\n              // Visible\n              var oldStyles = line.styles,\n                  tooLong = line.text.length > cm.options.maxHighlightLength;\n              var highlighted = highlightLine(cm, line, tooLong ? copyState(doc.mode, state) : state, true);\n              line.styles = highlighted.styles;\n              var oldCls = line.styleClasses,\n                  newCls = highlighted.classes;\n\n              if (newCls) {\n                line.styleClasses = newCls;\n              } else if (oldCls) {\n                line.styleClasses = null;\n              }\n\n              var ischange = !oldStyles || oldStyles.length != line.styles.length || oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n\n              for (var i = 0; !ischange && i < oldStyles.length; ++i) {\n                ischange = oldStyles[i] != line.styles[i];\n              }\n\n              if (ischange) {\n                changedLines.push(doc.frontier);\n              }\n\n              line.stateAfter = tooLong ? state : copyState(doc.mode, state);\n            } else {\n              if (line.text.length <= cm.options.maxHighlightLength) {\n                processLine(cm, line.text, state);\n              }\n\n              line.stateAfter = doc.frontier % 5 == 0 ? copyState(doc.mode, state) : null;\n            }\n\n            ++doc.frontier;\n\n            if (+new Date() > end) {\n              startWorker(cm, cm.options.workDelay);\n              return true;\n            }\n          });\n\n          if (changedLines.length) {\n            runInOp(cm, function () {\n              for (var i = 0; i < changedLines.length; i++) {\n                regLineChange(cm, changedLines[i], \"text\");\n              }\n            });\n          }\n        } // DISPLAY DRAWING\n\n\n        var DisplayUpdate = function (cm, viewport, force) {\n          var display = cm.display;\n          this.viewport = viewport; // Store some values that we'll need later (but don't want to force a relayout for)\n\n          this.visible = visibleLines(display, cm.doc, viewport);\n          this.editorIsHidden = !display.wrapper.offsetWidth;\n          this.wrapperHeight = display.wrapper.clientHeight;\n          this.wrapperWidth = display.wrapper.clientWidth;\n          this.oldDisplayWidth = displayWidth(cm);\n          this.force = force;\n          this.dims = getDimensions(cm);\n          this.events = [];\n        };\n\n        DisplayUpdate.prototype.signal = function (emitter, type) {\n          if (hasHandler(emitter, type)) {\n            this.events.push(arguments);\n          }\n        };\n\n        DisplayUpdate.prototype.finish = function () {\n          var this$1 = this;\n\n          for (var i = 0; i < this.events.length; i++) {\n            signal.apply(null, this$1.events[i]);\n          }\n        };\n\n        function maybeClipScrollbars(cm) {\n          var display = cm.display;\n\n          if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n            display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n            display.heightForcer.style.height = scrollGap(cm) + \"px\";\n            display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n            display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n            display.scrollbarsClipped = true;\n          }\n        }\n\n        function selectionSnapshot(cm) {\n          if (cm.hasFocus()) {\n            return null;\n          }\n\n          var active = activeElt();\n\n          if (!active || !contains(cm.display.lineDiv, active)) {\n            return null;\n          }\n\n          var result = {\n            activeElt: active\n          };\n\n          if (window.getSelection) {\n            var sel = window.getSelection();\n\n            if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n              result.anchorNode = sel.anchorNode;\n              result.anchorOffset = sel.anchorOffset;\n              result.focusNode = sel.focusNode;\n              result.focusOffset = sel.focusOffset;\n            }\n          }\n\n          return result;\n        }\n\n        function restoreSelection(snapshot) {\n          if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) {\n            return;\n          }\n\n          snapshot.activeElt.focus();\n\n          if (snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n            var sel = window.getSelection(),\n                range$$1 = document.createRange();\n            range$$1.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n            range$$1.collapse(false);\n            sel.removeAllRanges();\n            sel.addRange(range$$1);\n            sel.extend(snapshot.focusNode, snapshot.focusOffset);\n          }\n        } // Does the actual updating of the line display. Bails out\n        // (returning false) when there is nothing to be done and forced is\n        // false.\n\n\n        function updateDisplayIfNeeded(cm, update) {\n          var display = cm.display,\n              doc = cm.doc;\n\n          if (update.editorIsHidden) {\n            resetView(cm);\n            return false;\n          } // Bail out if the visible area is already rendered and nothing changed.\n\n\n          if (!update.force && update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo && (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) && display.renderedView == display.view && countDirtyView(cm) == 0) {\n            return false;\n          }\n\n          if (maybeUpdateLineNumberWidth(cm)) {\n            resetView(cm);\n            update.dims = getDimensions(cm);\n          } // Compute a suitable new viewport (from & to)\n\n\n          var end = doc.first + doc.size;\n          var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n          var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n\n          if (display.viewFrom < from && from - display.viewFrom < 20) {\n            from = Math.max(doc.first, display.viewFrom);\n          }\n\n          if (display.viewTo > to && display.viewTo - to < 20) {\n            to = Math.min(end, display.viewTo);\n          }\n\n          if (sawCollapsedSpans) {\n            from = visualLineNo(cm.doc, from);\n            to = visualLineEndNo(cm.doc, to);\n          }\n\n          var different = from != display.viewFrom || to != display.viewTo || display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n          adjustView(cm, from, to);\n          display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom)); // Position the mover div to align with the current scroll position\n\n          cm.display.mover.style.top = display.viewOffset + \"px\";\n          var toUpdate = countDirtyView(cm);\n\n          if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view && (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo)) {\n            return false;\n          } // For big changes, we hide the enclosing element during the\n          // update, since that speeds up the operations on most browsers.\n\n\n          var selSnapshot = selectionSnapshot(cm);\n\n          if (toUpdate > 4) {\n            display.lineDiv.style.display = \"none\";\n          }\n\n          patchDisplay(cm, display.updateLineNumbers, update.dims);\n\n          if (toUpdate > 4) {\n            display.lineDiv.style.display = \"\";\n          }\n\n          display.renderedView = display.view; // There might have been a widget with a focused element that got\n          // hidden or updated, if so re-focus it.\n\n          restoreSelection(selSnapshot); // Prevent selection and cursors from interfering with the scroll\n          // width and height.\n\n          removeChildren(display.cursorDiv);\n          removeChildren(display.selectionDiv);\n          display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n          if (different) {\n            display.lastWrapHeight = update.wrapperHeight;\n            display.lastWrapWidth = update.wrapperWidth;\n            startWorker(cm, 400);\n          }\n\n          display.updateLineNumbers = null;\n          return true;\n        }\n\n        function postUpdateDisplay(cm, update) {\n          var viewport = update.viewport;\n\n          for (var first = true;; first = false) {\n            if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n              // Clip forced viewport to actual scrollable area.\n              if (viewport && viewport.top != null) {\n                viewport = {\n                  top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)\n                };\n              } // Updated line heights might result in the drawn area not\n              // actually covering the viewport. Keep looping until it does.\n\n\n              update.visible = visibleLines(cm.display, cm.doc, viewport);\n\n              if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo) {\n                break;\n              }\n            }\n\n            if (!updateDisplayIfNeeded(cm, update)) {\n              break;\n            }\n\n            updateHeightsInViewport(cm);\n            var barMeasure = measureForScrollbars(cm);\n            updateSelection(cm);\n            updateScrollbars(cm, barMeasure);\n            setDocumentHeight(cm, barMeasure);\n          }\n\n          update.signal(cm, \"update\", cm);\n\n          if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n            update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n            cm.display.reportedViewFrom = cm.display.viewFrom;\n            cm.display.reportedViewTo = cm.display.viewTo;\n          }\n        }\n\n        function updateDisplaySimple(cm, viewport) {\n          var update = new DisplayUpdate(cm, viewport);\n\n          if (updateDisplayIfNeeded(cm, update)) {\n            updateHeightsInViewport(cm);\n            postUpdateDisplay(cm, update);\n            var barMeasure = measureForScrollbars(cm);\n            updateSelection(cm);\n            updateScrollbars(cm, barMeasure);\n            setDocumentHeight(cm, barMeasure);\n            update.finish();\n          }\n        } // Sync the actual display DOM structure with display.view, removing\n        // nodes for lines that are no longer in view, and creating the ones\n        // that are not there yet, and updating the ones that are out of\n        // date.\n\n\n        function patchDisplay(cm, updateNumbersFrom, dims) {\n          var display = cm.display,\n              lineNumbers = cm.options.lineNumbers;\n          var container = display.lineDiv,\n              cur = container.firstChild;\n\n          function rm(node) {\n            var next = node.nextSibling; // Works around a throw-scroll bug in OS X Webkit\n\n            if (webkit && mac && cm.display.currentWheelTarget == node) {\n              node.style.display = \"none\";\n            } else {\n              node.parentNode.removeChild(node);\n            }\n\n            return next;\n          }\n\n          var view = display.view,\n              lineN = display.viewFrom; // Loop over the elements in the view, syncing cur (the DOM nodes\n          // in display.lineDiv) with the view as we go.\n\n          for (var i = 0; i < view.length; i++) {\n            var lineView = view[i];\n\n            if (lineView.hidden) {} else if (!lineView.node || lineView.node.parentNode != container) {\n              // Not drawn yet\n              var node = buildLineElement(cm, lineView, lineN, dims);\n              container.insertBefore(node, cur);\n            } else {\n              // Already drawn\n              while (cur != lineView.node) {\n                cur = rm(cur);\n              }\n\n              var updateNumber = lineNumbers && updateNumbersFrom != null && updateNumbersFrom <= lineN && lineView.lineNumber;\n\n              if (lineView.changes) {\n                if (indexOf(lineView.changes, \"gutter\") > -1) {\n                  updateNumber = false;\n                }\n\n                updateLineForChanges(cm, lineView, lineN, dims);\n              }\n\n              if (updateNumber) {\n                removeChildren(lineView.lineNumber);\n                lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n              }\n\n              cur = lineView.node.nextSibling;\n            }\n\n            lineN += lineView.size;\n          }\n\n          while (cur) {\n            cur = rm(cur);\n          }\n        }\n\n        function updateGutterSpace(cm) {\n          var width = cm.display.gutters.offsetWidth;\n          cm.display.sizer.style.marginLeft = width + \"px\";\n        }\n\n        function setDocumentHeight(cm, measure) {\n          cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n          cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n          cm.display.gutters.style.height = measure.docHeight + cm.display.barHeight + scrollGap(cm) + \"px\";\n        } // Rebuild the gutter elements, ensure the margin to the left of the\n        // code matches their width.\n\n\n        function updateGutters(cm) {\n          var gutters = cm.display.gutters,\n              specs = cm.options.gutters;\n          removeChildren(gutters);\n          var i = 0;\n\n          for (; i < specs.length; ++i) {\n            var gutterClass = specs[i];\n            var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + gutterClass));\n\n            if (gutterClass == \"CodeMirror-linenumbers\") {\n              cm.display.lineGutter = gElt;\n              gElt.style.width = (cm.display.lineNumWidth || 1) + \"px\";\n            }\n          }\n\n          gutters.style.display = i ? \"\" : \"none\";\n          updateGutterSpace(cm);\n        } // Make sure the gutters options contains the element\n        // \"CodeMirror-linenumbers\" when the lineNumbers option is true.\n\n\n        function setGuttersForLineNumbers(options) {\n          var found = indexOf(options.gutters, \"CodeMirror-linenumbers\");\n\n          if (found == -1 && options.lineNumbers) {\n            options.gutters = options.gutters.concat([\"CodeMirror-linenumbers\"]);\n          } else if (found > -1 && !options.lineNumbers) {\n            options.gutters = options.gutters.slice(0);\n            options.gutters.splice(found, 1);\n          }\n        } // Since the delta values reported on mouse wheel events are\n        // unstandardized between browsers and even browser versions, and\n        // generally horribly unpredictable, this code starts by measuring\n        // the scroll effect that the first few mouse wheel events have,\n        // and, from that, detects the way it can convert deltas to pixel\n        // offsets afterwards.\n        //\n        // The reason we want to know the amount a wheel event will scroll\n        // is that it gives us a chance to update the display before the\n        // actual scrolling happens, reducing flickering.\n\n\n        var wheelSamples = 0;\n        var wheelPixelsPerUnit = null; // Fill in a browser-detected starting value on browsers where we\n        // know one. These don't have to be accurate -- the result of them\n        // being wrong would just be a slight flicker on the first wheel\n        // scroll (if it is large enough).\n\n        if (ie) {\n          wheelPixelsPerUnit = -.53;\n        } else if (gecko) {\n          wheelPixelsPerUnit = 15;\n        } else if (chrome) {\n          wheelPixelsPerUnit = -.7;\n        } else if (safari) {\n          wheelPixelsPerUnit = -1 / 3;\n        }\n\n        function wheelEventDelta(e) {\n          var dx = e.wheelDeltaX,\n              dy = e.wheelDeltaY;\n\n          if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) {\n            dx = e.detail;\n          }\n\n          if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) {\n            dy = e.detail;\n          } else if (dy == null) {\n            dy = e.wheelDelta;\n          }\n\n          return {\n            x: dx,\n            y: dy\n          };\n        }\n\n        function wheelEventPixels(e) {\n          var delta = wheelEventDelta(e);\n          delta.x *= wheelPixelsPerUnit;\n          delta.y *= wheelPixelsPerUnit;\n          return delta;\n        }\n\n        function onScrollWheel(cm, e) {\n          var delta = wheelEventDelta(e),\n              dx = delta.x,\n              dy = delta.y;\n          var display = cm.display,\n              scroll = display.scroller; // Quit if there's nothing to scroll here\n\n          var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n          var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n\n          if (!(dx && canScrollX || dy && canScrollY)) {\n            return;\n          } // Webkit browsers on OS X abort momentum scrolls when the target\n          // of the scroll event is removed from the scrollable element.\n          // This hack (see related code in patchDisplay) makes sure the\n          // element is kept around.\n\n\n          if (dy && mac && webkit) {\n            outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n              for (var i = 0; i < view.length; i++) {\n                if (view[i].node == cur) {\n                  cm.display.currentWheelTarget = cur;\n                  break outer;\n                }\n              }\n            }\n          } // On some browsers, horizontal scrolling will cause redraws to\n          // happen before the gutter has been realigned, causing it to\n          // wriggle around in a most unseemly way. When we have an\n          // estimated pixels/delta value, we just handle horizontal\n          // scrolling entirely here. It'll be slightly off from native, but\n          // better than glitching out.\n\n\n          if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n            if (dy && canScrollY) {\n              updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit));\n            }\n\n            setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit)); // Only prevent default scrolling if vertical scrolling is\n            // actually possible. Otherwise, it causes vertical scroll\n            // jitter on OSX trackpads when deltaX is small and deltaY\n            // is large (issue #3579)\n\n            if (!dy || dy && canScrollY) {\n              e_preventDefault(e);\n            }\n\n            display.wheelStartX = null; // Abort measurement, if in progress\n\n            return;\n          } // 'Project' the visible viewport to cover the area that is being\n          // scrolled into view (if we know enough to estimate it).\n\n\n          if (dy && wheelPixelsPerUnit != null) {\n            var pixels = dy * wheelPixelsPerUnit;\n            var top = cm.doc.scrollTop,\n                bot = top + display.wrapper.clientHeight;\n\n            if (pixels < 0) {\n              top = Math.max(0, top + pixels - 50);\n            } else {\n              bot = Math.min(cm.doc.height, bot + pixels + 50);\n            }\n\n            updateDisplaySimple(cm, {\n              top: top,\n              bottom: bot\n            });\n          }\n\n          if (wheelSamples < 20) {\n            if (display.wheelStartX == null) {\n              display.wheelStartX = scroll.scrollLeft;\n              display.wheelStartY = scroll.scrollTop;\n              display.wheelDX = dx;\n              display.wheelDY = dy;\n              setTimeout(function () {\n                if (display.wheelStartX == null) {\n                  return;\n                }\n\n                var movedX = scroll.scrollLeft - display.wheelStartX;\n                var movedY = scroll.scrollTop - display.wheelStartY;\n                var sample = movedY && display.wheelDY && movedY / display.wheelDY || movedX && display.wheelDX && movedX / display.wheelDX;\n                display.wheelStartX = display.wheelStartY = null;\n\n                if (!sample) {\n                  return;\n                }\n\n                wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n                ++wheelSamples;\n              }, 200);\n            } else {\n              display.wheelDX += dx;\n              display.wheelDY += dy;\n            }\n          }\n        } // Selection objects are immutable. A new one is created every time\n        // the selection changes. A selection is one or more non-overlapping\n        // (and non-touching) ranges, sorted, and an integer that indicates\n        // which one is the primary selection (the one that's scrolled into\n        // view, that getCursor returns, etc).\n\n\n        var Selection = function (ranges, primIndex) {\n          this.ranges = ranges;\n          this.primIndex = primIndex;\n        };\n\n        Selection.prototype.primary = function () {\n          return this.ranges[this.primIndex];\n        };\n\n        Selection.prototype.equals = function (other) {\n          var this$1 = this;\n\n          if (other == this) {\n            return true;\n          }\n\n          if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) {\n            return false;\n          }\n\n          for (var i = 0; i < this.ranges.length; i++) {\n            var here = this$1.ranges[i],\n                there = other.ranges[i];\n\n            if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) {\n              return false;\n            }\n          }\n\n          return true;\n        };\n\n        Selection.prototype.deepCopy = function () {\n          var this$1 = this;\n          var out = [];\n\n          for (var i = 0; i < this.ranges.length; i++) {\n            out[i] = new Range(copyPos(this$1.ranges[i].anchor), copyPos(this$1.ranges[i].head));\n          }\n\n          return new Selection(out, this.primIndex);\n        };\n\n        Selection.prototype.somethingSelected = function () {\n          var this$1 = this;\n\n          for (var i = 0; i < this.ranges.length; i++) {\n            if (!this$1.ranges[i].empty()) {\n              return true;\n            }\n          }\n\n          return false;\n        };\n\n        Selection.prototype.contains = function (pos, end) {\n          var this$1 = this;\n\n          if (!end) {\n            end = pos;\n          }\n\n          for (var i = 0; i < this.ranges.length; i++) {\n            var range = this$1.ranges[i];\n\n            if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0) {\n              return i;\n            }\n          }\n\n          return -1;\n        };\n\n        var Range = function (anchor, head) {\n          this.anchor = anchor;\n          this.head = head;\n        };\n\n        Range.prototype.from = function () {\n          return minPos(this.anchor, this.head);\n        };\n\n        Range.prototype.to = function () {\n          return maxPos(this.anchor, this.head);\n        };\n\n        Range.prototype.empty = function () {\n          return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch;\n        }; // Take an unsorted, potentially overlapping set of ranges, and\n        // build a selection out of it. 'Consumes' ranges array (modifying\n        // it).\n\n\n        function normalizeSelection(ranges, primIndex) {\n          var prim = ranges[primIndex];\n          ranges.sort(function (a, b) {\n            return cmp(a.from(), b.from());\n          });\n          primIndex = indexOf(ranges, prim);\n\n          for (var i = 1; i < ranges.length; i++) {\n            var cur = ranges[i],\n                prev = ranges[i - 1];\n\n            if (cmp(prev.to(), cur.from()) >= 0) {\n              var from = minPos(prev.from(), cur.from()),\n                  to = maxPos(prev.to(), cur.to());\n              var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n\n              if (i <= primIndex) {\n                --primIndex;\n              }\n\n              ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n            }\n          }\n\n          return new Selection(ranges, primIndex);\n        }\n\n        function simpleSelection(anchor, head) {\n          return new Selection([new Range(anchor, head || anchor)], 0);\n        } // Compute the position of the end of a change (its 'to' property\n        // refers to the pre-change end).\n\n\n        function changeEnd(change) {\n          if (!change.text) {\n            return change.to;\n          }\n\n          return Pos(change.from.line + change.text.length - 1, lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0));\n        } // Adjust a position to refer to the post-change position of the\n        // same text, or the end of the change if the change covers it.\n\n\n        function adjustForChange(pos, change) {\n          if (cmp(pos, change.from) < 0) {\n            return pos;\n          }\n\n          if (cmp(pos, change.to) <= 0) {\n            return changeEnd(change);\n          }\n\n          var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1,\n              ch = pos.ch;\n\n          if (pos.line == change.to.line) {\n            ch += changeEnd(change).ch - change.to.ch;\n          }\n\n          return Pos(line, ch);\n        }\n\n        function computeSelAfterChange(doc, change) {\n          var out = [];\n\n          for (var i = 0; i < doc.sel.ranges.length; i++) {\n            var range = doc.sel.ranges[i];\n            out.push(new Range(adjustForChange(range.anchor, change), adjustForChange(range.head, change)));\n          }\n\n          return normalizeSelection(out, doc.sel.primIndex);\n        }\n\n        function offsetPos(pos, old, nw) {\n          if (pos.line == old.line) {\n            return Pos(nw.line, pos.ch - old.ch + nw.ch);\n          } else {\n            return Pos(nw.line + (pos.line - old.line), pos.ch);\n          }\n        } // Used by replaceSelections to allow moving the selection to the\n        // start or around the replaced test. Hint may be \"start\" or \"around\".\n\n\n        function computeReplacedSel(doc, changes, hint) {\n          var out = [];\n          var oldPrev = Pos(doc.first, 0),\n              newPrev = oldPrev;\n\n          for (var i = 0; i < changes.length; i++) {\n            var change = changes[i];\n            var from = offsetPos(change.from, oldPrev, newPrev);\n            var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n            oldPrev = change.to;\n            newPrev = to;\n\n            if (hint == \"around\") {\n              var range = doc.sel.ranges[i],\n                  inv = cmp(range.head, range.anchor) < 0;\n              out[i] = new Range(inv ? to : from, inv ? from : to);\n            } else {\n              out[i] = new Range(from, from);\n            }\n          }\n\n          return new Selection(out, doc.sel.primIndex);\n        } // Used to get the editor into a consistent state again when options change.\n\n\n        function loadMode(cm) {\n          cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n          resetModeState(cm);\n        }\n\n        function resetModeState(cm) {\n          cm.doc.iter(function (line) {\n            if (line.stateAfter) {\n              line.stateAfter = null;\n            }\n\n            if (line.styles) {\n              line.styles = null;\n            }\n          });\n          cm.doc.frontier = cm.doc.first;\n          startWorker(cm, 100);\n          cm.state.modeGen++;\n\n          if (cm.curOp) {\n            regChange(cm);\n          }\n        } // DOCUMENT DATA STRUCTURE\n        // By default, updates that start and end at the beginning of a line\n        // are treated specially, in order to make the association of line\n        // widgets and marker elements with the text behave more intuitive.\n\n\n        function isWholeLineUpdate(doc, change) {\n          return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" && (!doc.cm || doc.cm.options.wholeLineUpdateBefore);\n        } // Perform a change on the document data structure.\n\n\n        function updateDoc(doc, change, markedSpans, estimateHeight$$1) {\n          function spansFor(n) {\n            return markedSpans ? markedSpans[n] : null;\n          }\n\n          function update(line, text, spans) {\n            updateLine(line, text, spans, estimateHeight$$1);\n            signalLater(line, \"change\", line, change);\n          }\n\n          function linesFor(start, end) {\n            var result = [];\n\n            for (var i = start; i < end; ++i) {\n              result.push(new Line(text[i], spansFor(i), estimateHeight$$1));\n            }\n\n            return result;\n          }\n\n          var from = change.from,\n              to = change.to,\n              text = change.text;\n          var firstLine = getLine(doc, from.line),\n              lastLine = getLine(doc, to.line);\n          var lastText = lst(text),\n              lastSpans = spansFor(text.length - 1),\n              nlines = to.line - from.line; // Adjust the line structure\n\n          if (change.full) {\n            doc.insert(0, linesFor(0, text.length));\n            doc.remove(text.length, doc.size - text.length);\n          } else if (isWholeLineUpdate(doc, change)) {\n            // This is a whole-line replace. Treated specially to make\n            // sure line objects move the way they are supposed to.\n            var added = linesFor(0, text.length - 1);\n            update(lastLine, lastLine.text, lastSpans);\n\n            if (nlines) {\n              doc.remove(from.line, nlines);\n            }\n\n            if (added.length) {\n              doc.insert(from.line, added);\n            }\n          } else if (firstLine == lastLine) {\n            if (text.length == 1) {\n              update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n            } else {\n              var added$1 = linesFor(1, text.length - 1);\n              added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight$$1));\n              update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n              doc.insert(from.line + 1, added$1);\n            }\n          } else if (text.length == 1) {\n            update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n            doc.remove(from.line + 1, nlines);\n          } else {\n            update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n            update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n            var added$2 = linesFor(1, text.length - 1);\n\n            if (nlines > 1) {\n              doc.remove(from.line + 1, nlines - 1);\n            }\n\n            doc.insert(from.line + 1, added$2);\n          }\n\n          signalLater(doc, \"change\", doc, change);\n        } // Call f for all linked documents.\n\n\n        function linkedDocs(doc, f, sharedHistOnly) {\n          function propagate(doc, skip, sharedHist) {\n            if (doc.linked) {\n              for (var i = 0; i < doc.linked.length; ++i) {\n                var rel = doc.linked[i];\n\n                if (rel.doc == skip) {\n                  continue;\n                }\n\n                var shared = sharedHist && rel.sharedHist;\n\n                if (sharedHistOnly && !shared) {\n                  continue;\n                }\n\n                f(rel.doc, shared);\n                propagate(rel.doc, doc, shared);\n              }\n            }\n          }\n\n          propagate(doc, null, true);\n        } // Attach a document to an editor.\n\n\n        function attachDoc(cm, doc) {\n          if (doc.cm) {\n            throw new Error(\"This document is already in use.\");\n          }\n\n          cm.doc = doc;\n          doc.cm = cm;\n          estimateLineHeights(cm);\n          loadMode(cm);\n          setDirectionClass(cm);\n\n          if (!cm.options.lineWrapping) {\n            findMaxLine(cm);\n          }\n\n          cm.options.mode = doc.modeOption;\n          regChange(cm);\n        }\n\n        function setDirectionClass(cm) {\n          (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n        }\n\n        function directionChanged(cm) {\n          runInOp(cm, function () {\n            setDirectionClass(cm);\n            regChange(cm);\n          });\n        }\n\n        function History(startGen) {\n          // Arrays of change events and selections. Doing something adds an\n          // event to done and clears undo. Undoing moves events from done\n          // to undone, redoing moves them in the other direction.\n          this.done = [];\n          this.undone = [];\n          this.undoDepth = Infinity; // Used to track when changes can be merged into a single undo\n          // event\n\n          this.lastModTime = this.lastSelTime = 0;\n          this.lastOp = this.lastSelOp = null;\n          this.lastOrigin = this.lastSelOrigin = null; // Used by the isClean() method\n\n          this.generation = this.maxGeneration = startGen || 1;\n        } // Create a history change event from an updateDoc-style change\n        // object.\n\n\n        function historyChangeFromChange(doc, change) {\n          var histChange = {\n            from: copyPos(change.from),\n            to: changeEnd(change),\n            text: getBetween(doc, change.from, change.to)\n          };\n          attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n          linkedDocs(doc, function (doc) {\n            return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n          }, true);\n          return histChange;\n        } // Pop all selection events off the end of a history array. Stop at\n        // a change event.\n\n\n        function clearSelectionEvents(array) {\n          while (array.length) {\n            var last = lst(array);\n\n            if (last.ranges) {\n              array.pop();\n            } else {\n              break;\n            }\n          }\n        } // Find the top change event in the history. Pop off selection\n        // events that are in the way.\n\n\n        function lastChangeEvent(hist, force) {\n          if (force) {\n            clearSelectionEvents(hist.done);\n            return lst(hist.done);\n          } else if (hist.done.length && !lst(hist.done).ranges) {\n            return lst(hist.done);\n          } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n            hist.done.pop();\n            return lst(hist.done);\n          }\n        } // Register a change in the history. Merges changes that are within\n        // a single operation, or are close together with an origin that\n        // allows merging (starting with \"+\") into a single event.\n\n\n        function addChangeToHistory(doc, change, selAfter, opId) {\n          var hist = doc.history;\n          hist.undone.length = 0;\n          var time = +new Date(),\n              cur;\n          var last;\n\n          if ((hist.lastOp == opId || hist.lastOrigin == change.origin && change.origin && (change.origin.charAt(0) == \"+\" && doc.cm && hist.lastModTime > time - doc.cm.options.historyEventDelay || change.origin.charAt(0) == \"*\")) && (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n            // Merge this change into the last event\n            last = lst(cur.changes);\n\n            if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n              // Optimized case for simple insertion -- don't want to add\n              // new changesets for every character typed\n              last.to = changeEnd(change);\n            } else {\n              // Add new sub-event\n              cur.changes.push(historyChangeFromChange(doc, change));\n            }\n          } else {\n            // Can not be merged, start a new event.\n            var before = lst(hist.done);\n\n            if (!before || !before.ranges) {\n              pushSelectionToHistory(doc.sel, hist.done);\n            }\n\n            cur = {\n              changes: [historyChangeFromChange(doc, change)],\n              generation: hist.generation\n            };\n            hist.done.push(cur);\n\n            while (hist.done.length > hist.undoDepth) {\n              hist.done.shift();\n\n              if (!hist.done[0].ranges) {\n                hist.done.shift();\n              }\n            }\n          }\n\n          hist.done.push(selAfter);\n          hist.generation = ++hist.maxGeneration;\n          hist.lastModTime = hist.lastSelTime = time;\n          hist.lastOp = hist.lastSelOp = opId;\n          hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n          if (!last) {\n            signal(doc, \"historyAdded\");\n          }\n        }\n\n        function selectionEventCanBeMerged(doc, origin, prev, sel) {\n          var ch = origin.charAt(0);\n          return ch == \"*\" || ch == \"+\" && prev.ranges.length == sel.ranges.length && prev.somethingSelected() == sel.somethingSelected() && new Date() - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500);\n        } // Called whenever the selection changes, sets the new selection as\n        // the pending selection in the history, and pushes the old pending\n        // selection into the 'done' array when it was significantly\n        // different (in number of selected ranges, emptiness, or time).\n\n\n        function addSelectionToHistory(doc, sel, opId, options) {\n          var hist = doc.history,\n              origin = options && options.origin; // A new event is started when the previous origin does not match\n          // the current, or the origins don't allow matching. Origins\n          // starting with * are always merged, those starting with + are\n          // merged when similar and close together in time.\n\n          if (opId == hist.lastSelOp || origin && hist.lastSelOrigin == origin && (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin || selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))) {\n            hist.done[hist.done.length - 1] = sel;\n          } else {\n            pushSelectionToHistory(sel, hist.done);\n          }\n\n          hist.lastSelTime = +new Date();\n          hist.lastSelOrigin = origin;\n          hist.lastSelOp = opId;\n\n          if (options && options.clearRedo !== false) {\n            clearSelectionEvents(hist.undone);\n          }\n        }\n\n        function pushSelectionToHistory(sel, dest) {\n          var top = lst(dest);\n\n          if (!(top && top.ranges && top.equals(sel))) {\n            dest.push(sel);\n          }\n        } // Used to store marked span information in the history.\n\n\n        function attachLocalSpans(doc, change, from, to) {\n          var existing = change[\"spans_\" + doc.id],\n              n = 0;\n          doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n            if (line.markedSpans) {\n              (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans;\n            }\n\n            ++n;\n          });\n        } // When un/re-doing restores text containing marked spans, those\n        // that have been explicitly cleared should not be restored.\n\n\n        function removeClearedSpans(spans) {\n          if (!spans) {\n            return null;\n          }\n\n          var out;\n\n          for (var i = 0; i < spans.length; ++i) {\n            if (spans[i].marker.explicitlyCleared) {\n              if (!out) {\n                out = spans.slice(0, i);\n              }\n            } else if (out) {\n              out.push(spans[i]);\n            }\n          }\n\n          return !out ? spans : out.length ? out : null;\n        } // Retrieve and filter the old marked spans stored in a change event.\n\n\n        function getOldSpans(doc, change) {\n          var found = change[\"spans_\" + doc.id];\n\n          if (!found) {\n            return null;\n          }\n\n          var nw = [];\n\n          for (var i = 0; i < change.text.length; ++i) {\n            nw.push(removeClearedSpans(found[i]));\n          }\n\n          return nw;\n        } // Used for un/re-doing changes from the history. Combines the\n        // result of computing the existing spans with the set of spans that\n        // existed in the history (so that deleting around a span and then\n        // undoing brings back the span).\n\n\n        function mergeOldSpans(doc, change) {\n          var old = getOldSpans(doc, change);\n          var stretched = stretchSpansOverChange(doc, change);\n\n          if (!old) {\n            return stretched;\n          }\n\n          if (!stretched) {\n            return old;\n          }\n\n          for (var i = 0; i < old.length; ++i) {\n            var oldCur = old[i],\n                stretchCur = stretched[i];\n\n            if (oldCur && stretchCur) {\n              spans: for (var j = 0; j < stretchCur.length; ++j) {\n                var span = stretchCur[j];\n\n                for (var k = 0; k < oldCur.length; ++k) {\n                  if (oldCur[k].marker == span.marker) {\n                    continue spans;\n                  }\n                }\n\n                oldCur.push(span);\n              }\n            } else if (stretchCur) {\n              old[i] = stretchCur;\n            }\n          }\n\n          return old;\n        } // Used both to provide a JSON-safe object in .getHistory, and, when\n        // detaching a document, to split the history in two\n\n\n        function copyHistoryArray(events, newGroup, instantiateSel) {\n          var copy = [];\n\n          for (var i = 0; i < events.length; ++i) {\n            var event = events[i];\n\n            if (event.ranges) {\n              copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n              continue;\n            }\n\n            var changes = event.changes,\n                newChanges = [];\n            copy.push({\n              changes: newChanges\n            });\n\n            for (var j = 0; j < changes.length; ++j) {\n              var change = changes[j],\n                  m = void 0;\n              newChanges.push({\n                from: change.from,\n                to: change.to,\n                text: change.text\n              });\n\n              if (newGroup) {\n                for (var prop in change) {\n                  if (m = prop.match(/^spans_(\\d+)$/)) {\n                    if (indexOf(newGroup, Number(m[1])) > -1) {\n                      lst(newChanges)[prop] = change[prop];\n                      delete change[prop];\n                    }\n                  }\n                }\n              }\n            }\n          }\n\n          return copy;\n        } // The 'scroll' parameter given to many of these indicated whether\n        // the new cursor position should be scrolled into view after\n        // modifying the selection.\n        // If shift is held or the extend flag is set, extends a range to\n        // include a given position (and optionally a second position).\n        // Otherwise, simply returns the range between the given positions.\n        // Used for cursor motion and such.\n\n\n        function extendRange(doc, range, head, other) {\n          if (doc.cm && doc.cm.display.shift || doc.extend) {\n            var anchor = range.anchor;\n\n            if (other) {\n              var posBefore = cmp(head, anchor) < 0;\n\n              if (posBefore != cmp(other, anchor) < 0) {\n                anchor = head;\n                head = other;\n              } else if (posBefore != cmp(head, other) < 0) {\n                head = other;\n              }\n            }\n\n            return new Range(anchor, head);\n          } else {\n            return new Range(other || head, head);\n          }\n        } // Extend the primary selection range, discard the rest.\n\n\n        function extendSelection(doc, head, other, options) {\n          setSelection(doc, new Selection([extendRange(doc, doc.sel.primary(), head, other)], 0), options);\n        } // Extend all selections (pos is an array of selections with length\n        // equal the number of selections)\n\n\n        function extendSelections(doc, heads, options) {\n          var out = [];\n\n          for (var i = 0; i < doc.sel.ranges.length; i++) {\n            out[i] = extendRange(doc, doc.sel.ranges[i], heads[i], null);\n          }\n\n          var newSel = normalizeSelection(out, doc.sel.primIndex);\n          setSelection(doc, newSel, options);\n        } // Updates a single range in the selection.\n\n\n        function replaceOneSelection(doc, i, range, options) {\n          var ranges = doc.sel.ranges.slice(0);\n          ranges[i] = range;\n          setSelection(doc, normalizeSelection(ranges, doc.sel.primIndex), options);\n        } // Reset the selection to a single range.\n\n\n        function setSimpleSelection(doc, anchor, head, options) {\n          setSelection(doc, simpleSelection(anchor, head), options);\n        } // Give beforeSelectionChange handlers a change to influence a\n        // selection update.\n\n\n        function filterSelectionChange(doc, sel, options) {\n          var obj = {\n            ranges: sel.ranges,\n            update: function (ranges) {\n              var this$1 = this;\n              this.ranges = [];\n\n              for (var i = 0; i < ranges.length; i++) {\n                this$1.ranges[i] = new Range(clipPos(doc, ranges[i].anchor), clipPos(doc, ranges[i].head));\n              }\n            },\n            origin: options && options.origin\n          };\n          signal(doc, \"beforeSelectionChange\", doc, obj);\n\n          if (doc.cm) {\n            signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj);\n          }\n\n          if (obj.ranges != sel.ranges) {\n            return normalizeSelection(obj.ranges, obj.ranges.length - 1);\n          } else {\n            return sel;\n          }\n        }\n\n        function setSelectionReplaceHistory(doc, sel, options) {\n          var done = doc.history.done,\n              last = lst(done);\n\n          if (last && last.ranges) {\n            done[done.length - 1] = sel;\n            setSelectionNoUndo(doc, sel, options);\n          } else {\n            setSelection(doc, sel, options);\n          }\n        } // Set a new selection.\n\n\n        function setSelection(doc, sel, options) {\n          setSelectionNoUndo(doc, sel, options);\n          addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n        }\n\n        function setSelectionNoUndo(doc, sel, options) {\n          if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\")) {\n            sel = filterSelectionChange(doc, sel, options);\n          }\n\n          var bias = options && options.bias || (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n          setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n          if (!(options && options.scroll === false) && doc.cm) {\n            ensureCursorVisible(doc.cm);\n          }\n        }\n\n        function setSelectionInner(doc, sel) {\n          if (sel.equals(doc.sel)) {\n            return;\n          }\n\n          doc.sel = sel;\n\n          if (doc.cm) {\n            doc.cm.curOp.updateInput = doc.cm.curOp.selectionChanged = true;\n            signalCursorActivity(doc.cm);\n          }\n\n          signalLater(doc, \"cursorActivity\", doc);\n        } // Verify that the selection does not partially select any atomic\n        // marked ranges.\n\n\n        function reCheckSelection(doc) {\n          setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n        } // Return a selection that does not partially select any atomic\n        // ranges.\n\n\n        function skipAtomicInSelection(doc, sel, bias, mayClear) {\n          var out;\n\n          for (var i = 0; i < sel.ranges.length; i++) {\n            var range = sel.ranges[i];\n            var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n            var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n            var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n\n            if (out || newAnchor != range.anchor || newHead != range.head) {\n              if (!out) {\n                out = sel.ranges.slice(0, i);\n              }\n\n              out[i] = new Range(newAnchor, newHead);\n            }\n          }\n\n          return out ? normalizeSelection(out, sel.primIndex) : sel;\n        }\n\n        function skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n          var line = getLine(doc, pos.line);\n\n          if (line.markedSpans) {\n            for (var i = 0; i < line.markedSpans.length; ++i) {\n              var sp = line.markedSpans[i],\n                  m = sp.marker;\n\n              if ((sp.from == null || (m.inclusiveLeft ? sp.from <= pos.ch : sp.from < pos.ch)) && (sp.to == null || (m.inclusiveRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n                if (mayClear) {\n                  signal(m, \"beforeCursorEnter\");\n\n                  if (m.explicitlyCleared) {\n                    if (!line.markedSpans) {\n                      break;\n                    } else {\n                      --i;\n                      continue;\n                    }\n                  }\n                }\n\n                if (!m.atomic) {\n                  continue;\n                }\n\n                if (oldPos) {\n                  var near = m.find(dir < 0 ? 1 : -1),\n                      diff = void 0;\n\n                  if (dir < 0 ? m.inclusiveRight : m.inclusiveLeft) {\n                    near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null);\n                  }\n\n                  if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0)) {\n                    return skipAtomicInner(doc, near, pos, dir, mayClear);\n                  }\n                }\n\n                var far = m.find(dir < 0 ? -1 : 1);\n\n                if (dir < 0 ? m.inclusiveLeft : m.inclusiveRight) {\n                  far = movePos(doc, far, dir, far.line == pos.line ? line : null);\n                }\n\n                return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null;\n              }\n            }\n          }\n\n          return pos;\n        } // Ensure a given position is not inside an atomic range.\n\n\n        function skipAtomic(doc, pos, oldPos, bias, mayClear) {\n          var dir = bias || 1;\n          var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) || !mayClear && skipAtomicInner(doc, pos, oldPos, dir, true) || skipAtomicInner(doc, pos, oldPos, -dir, mayClear) || !mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true);\n\n          if (!found) {\n            doc.cantEdit = true;\n            return Pos(doc.first, 0);\n          }\n\n          return found;\n        }\n\n        function movePos(doc, pos, dir, line) {\n          if (dir < 0 && pos.ch == 0) {\n            if (pos.line > doc.first) {\n              return clipPos(doc, Pos(pos.line - 1));\n            } else {\n              return null;\n            }\n          } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n            if (pos.line < doc.first + doc.size - 1) {\n              return Pos(pos.line + 1, 0);\n            } else {\n              return null;\n            }\n          } else {\n            return new Pos(pos.line, pos.ch + dir);\n          }\n        }\n\n        function selectAll(cm) {\n          cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n        } // UPDATING\n        // Allow \"beforeChange\" event handlers to influence a change\n\n\n        function filterChange(doc, change, update) {\n          var obj = {\n            canceled: false,\n            from: change.from,\n            to: change.to,\n            text: change.text,\n            origin: change.origin,\n            cancel: function () {\n              return obj.canceled = true;\n            }\n          };\n\n          if (update) {\n            obj.update = function (from, to, text, origin) {\n              if (from) {\n                obj.from = clipPos(doc, from);\n              }\n\n              if (to) {\n                obj.to = clipPos(doc, to);\n              }\n\n              if (text) {\n                obj.text = text;\n              }\n\n              if (origin !== undefined) {\n                obj.origin = origin;\n              }\n            };\n          }\n\n          signal(doc, \"beforeChange\", doc, obj);\n\n          if (doc.cm) {\n            signal(doc.cm, \"beforeChange\", doc.cm, obj);\n          }\n\n          if (obj.canceled) {\n            return null;\n          }\n\n          return {\n            from: obj.from,\n            to: obj.to,\n            text: obj.text,\n            origin: obj.origin\n          };\n        } // Apply a change to a document, and add it to the document's\n        // history, and propagating it to all linked documents.\n\n\n        function makeChange(doc, change, ignoreReadOnly) {\n          if (doc.cm) {\n            if (!doc.cm.curOp) {\n              return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly);\n            }\n\n            if (doc.cm.state.suppressEdits) {\n              return;\n            }\n          }\n\n          if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n            change = filterChange(doc, change, true);\n\n            if (!change) {\n              return;\n            }\n          } // Possibly split or suppress the update based on the presence\n          // of read-only spans in its range.\n\n\n          var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n\n          if (split) {\n            for (var i = split.length - 1; i >= 0; --i) {\n              makeChangeInner(doc, {\n                from: split[i].from,\n                to: split[i].to,\n                text: i ? [\"\"] : change.text\n              });\n            }\n          } else {\n            makeChangeInner(doc, change);\n          }\n        }\n\n        function makeChangeInner(doc, change) {\n          if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) {\n            return;\n          }\n\n          var selAfter = computeSelAfterChange(doc, change);\n          addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n          makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n          var rebased = [];\n          linkedDocs(doc, function (doc, sharedHist) {\n            if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n              rebaseHist(doc.history, change);\n              rebased.push(doc.history);\n            }\n\n            makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n          });\n        } // Revert a change stored in a document's history.\n\n\n        function makeChangeFromHistory(doc, type, allowSelectionOnly) {\n          if (doc.cm && doc.cm.state.suppressEdits && !allowSelectionOnly) {\n            return;\n          }\n\n          var hist = doc.history,\n              event,\n              selAfter = doc.sel;\n          var source = type == \"undo\" ? hist.done : hist.undone,\n              dest = type == \"undo\" ? hist.undone : hist.done; // Verify that there is a useable event (so that ctrl-z won't\n          // needlessly clear selection events)\n\n          var i = 0;\n\n          for (; i < source.length; i++) {\n            event = source[i];\n\n            if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges) {\n              break;\n            }\n          }\n\n          if (i == source.length) {\n            return;\n          }\n\n          hist.lastOrigin = hist.lastSelOrigin = null;\n\n          for (;;) {\n            event = source.pop();\n\n            if (event.ranges) {\n              pushSelectionToHistory(event, dest);\n\n              if (allowSelectionOnly && !event.equals(doc.sel)) {\n                setSelection(doc, event, {\n                  clearRedo: false\n                });\n                return;\n              }\n\n              selAfter = event;\n            } else {\n              break;\n            }\n          } // Build up a reverse change object to add to the opposite history\n          // stack (redo when undoing, and vice versa).\n\n\n          var antiChanges = [];\n          pushSelectionToHistory(selAfter, dest);\n          dest.push({\n            changes: antiChanges,\n            generation: hist.generation\n          });\n          hist.generation = event.generation || ++hist.maxGeneration;\n          var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n          var loop = function (i) {\n            var change = event.changes[i];\n            change.origin = type;\n\n            if (filter && !filterChange(doc, change, false)) {\n              source.length = 0;\n              return {};\n            }\n\n            antiChanges.push(historyChangeFromChange(doc, change));\n            var after = i ? computeSelAfterChange(doc, change) : lst(source);\n            makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n\n            if (!i && doc.cm) {\n              doc.cm.scrollIntoView({\n                from: change.from,\n                to: changeEnd(change)\n              });\n            }\n\n            var rebased = []; // Propagate to the linked documents\n\n            linkedDocs(doc, function (doc, sharedHist) {\n              if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n                rebaseHist(doc.history, change);\n                rebased.push(doc.history);\n              }\n\n              makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n            });\n          };\n\n          for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n            var returned = loop(i$1);\n            if (returned) return returned.v;\n          }\n        } // Sub-views need their line numbers shifted when text is added\n        // above or below them in the parent document.\n\n\n        function shiftDoc(doc, distance) {\n          if (distance == 0) {\n            return;\n          }\n\n          doc.first += distance;\n          doc.sel = new Selection(map(doc.sel.ranges, function (range) {\n            return new Range(Pos(range.anchor.line + distance, range.anchor.ch), Pos(range.head.line + distance, range.head.ch));\n          }), doc.sel.primIndex);\n\n          if (doc.cm) {\n            regChange(doc.cm, doc.first, doc.first - distance, distance);\n\n            for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++) {\n              regLineChange(doc.cm, l, \"gutter\");\n            }\n          }\n        } // More lower-level change function, handling only a single document\n        // (not linked ones).\n\n\n        function makeChangeSingleDoc(doc, change, selAfter, spans) {\n          if (doc.cm && !doc.cm.curOp) {\n            return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans);\n          }\n\n          if (change.to.line < doc.first) {\n            shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n            return;\n          }\n\n          if (change.from.line > doc.lastLine()) {\n            return;\n          } // Clip the change to the size of this doc\n\n\n          if (change.from.line < doc.first) {\n            var shift = change.text.length - 1 - (doc.first - change.from.line);\n            shiftDoc(doc, shift);\n            change = {\n              from: Pos(doc.first, 0),\n              to: Pos(change.to.line + shift, change.to.ch),\n              text: [lst(change.text)],\n              origin: change.origin\n            };\n          }\n\n          var last = doc.lastLine();\n\n          if (change.to.line > last) {\n            change = {\n              from: change.from,\n              to: Pos(last, getLine(doc, last).text.length),\n              text: [change.text[0]],\n              origin: change.origin\n            };\n          }\n\n          change.removed = getBetween(doc, change.from, change.to);\n\n          if (!selAfter) {\n            selAfter = computeSelAfterChange(doc, change);\n          }\n\n          if (doc.cm) {\n            makeChangeSingleDocInEditor(doc.cm, change, spans);\n          } else {\n            updateDoc(doc, change, spans);\n          }\n\n          setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n        } // Handle the interaction of a change to a document with the editor\n        // that this document is part of.\n\n\n        function makeChangeSingleDocInEditor(cm, change, spans) {\n          var doc = cm.doc,\n              display = cm.display,\n              from = change.from,\n              to = change.to;\n          var recomputeMaxLength = false,\n              checkWidthStart = from.line;\n\n          if (!cm.options.lineWrapping) {\n            checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n            doc.iter(checkWidthStart, to.line + 1, function (line) {\n              if (line == display.maxLine) {\n                recomputeMaxLength = true;\n                return true;\n              }\n            });\n          }\n\n          if (doc.sel.contains(change.from, change.to) > -1) {\n            signalCursorActivity(cm);\n          }\n\n          updateDoc(doc, change, spans, estimateHeight(cm));\n\n          if (!cm.options.lineWrapping) {\n            doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n              var len = lineLength(line);\n\n              if (len > display.maxLineLength) {\n                display.maxLine = line;\n                display.maxLineLength = len;\n                display.maxLineChanged = true;\n                recomputeMaxLength = false;\n              }\n            });\n\n            if (recomputeMaxLength) {\n              cm.curOp.updateMaxLine = true;\n            }\n          } // Adjust frontier, schedule worker\n\n\n          doc.frontier = Math.min(doc.frontier, from.line);\n          startWorker(cm, 400);\n          var lendiff = change.text.length - (to.line - from.line) - 1; // Remember that these lines changed, for updating the display\n\n          if (change.full) {\n            regChange(cm);\n          } else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change)) {\n            regLineChange(cm, from.line, \"text\");\n          } else {\n            regChange(cm, from.line, to.line + 1, lendiff);\n          }\n\n          var changesHandler = hasHandler(cm, \"changes\"),\n              changeHandler = hasHandler(cm, \"change\");\n\n          if (changeHandler || changesHandler) {\n            var obj = {\n              from: from,\n              to: to,\n              text: change.text,\n              removed: change.removed,\n              origin: change.origin\n            };\n\n            if (changeHandler) {\n              signalLater(cm, \"change\", cm, obj);\n            }\n\n            if (changesHandler) {\n              (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj);\n            }\n          }\n\n          cm.display.selForContextMenu = null;\n        }\n\n        function replaceRange(doc, code, from, to, origin) {\n          if (!to) {\n            to = from;\n          }\n\n          if (cmp(to, from) < 0) {\n            var tmp = to;\n            to = from;\n            from = tmp;\n          }\n\n          if (typeof code == \"string\") {\n            code = doc.splitLines(code);\n          }\n\n          makeChange(doc, {\n            from: from,\n            to: to,\n            text: code,\n            origin: origin\n          });\n        } // Rebasing/resetting history to deal with externally-sourced changes\n\n\n        function rebaseHistSelSingle(pos, from, to, diff) {\n          if (to < pos.line) {\n            pos.line += diff;\n          } else if (from < pos.line) {\n            pos.line = from;\n            pos.ch = 0;\n          }\n        } // Tries to rebase an array of history events given a change in the\n        // document. If the change touches the same lines as the event, the\n        // event, and everything 'behind' it, is discarded. If the change is\n        // before the event, the event's positions are updated. Uses a\n        // copy-on-write scheme for the positions, to avoid having to\n        // reallocate them all on every rebase, but also avoid problems with\n        // shared position objects being unsafely updated.\n\n\n        function rebaseHistArray(array, from, to, diff) {\n          for (var i = 0; i < array.length; ++i) {\n            var sub = array[i],\n                ok = true;\n\n            if (sub.ranges) {\n              if (!sub.copied) {\n                sub = array[i] = sub.deepCopy();\n                sub.copied = true;\n              }\n\n              for (var j = 0; j < sub.ranges.length; j++) {\n                rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n                rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n              }\n\n              continue;\n            }\n\n            for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n              var cur = sub.changes[j$1];\n\n              if (to < cur.from.line) {\n                cur.from = Pos(cur.from.line + diff, cur.from.ch);\n                cur.to = Pos(cur.to.line + diff, cur.to.ch);\n              } else if (from <= cur.to.line) {\n                ok = false;\n                break;\n              }\n            }\n\n            if (!ok) {\n              array.splice(0, i + 1);\n              i = 0;\n            }\n          }\n        }\n\n        function rebaseHist(hist, change) {\n          var from = change.from.line,\n              to = change.to.line,\n              diff = change.text.length - (to - from) - 1;\n          rebaseHistArray(hist.done, from, to, diff);\n          rebaseHistArray(hist.undone, from, to, diff);\n        } // Utility for applying a change to a line by handle or number,\n        // returning the number and optionally registering the line as\n        // changed.\n\n\n        function changeLine(doc, handle, changeType, op) {\n          var no = handle,\n              line = handle;\n\n          if (typeof handle == \"number\") {\n            line = getLine(doc, clipLine(doc, handle));\n          } else {\n            no = lineNo(handle);\n          }\n\n          if (no == null) {\n            return null;\n          }\n\n          if (op(line, no) && doc.cm) {\n            regLineChange(doc.cm, no, changeType);\n          }\n\n          return line;\n        } // The document is represented as a BTree consisting of leaves, with\n        // chunk of lines in them, and branches, with up to ten leaves or\n        // other branch nodes below them. The top node is always a branch\n        // node, and is the document object itself (meaning it has\n        // additional methods and properties).\n        //\n        // All nodes have parent links. The tree is used both to go from\n        // line numbers to line objects, and to go from objects to numbers.\n        // It also indexes by height, and is used to convert between height\n        // and line object, and to find the total height of the document.\n        //\n        // See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\n\n        var LeafChunk = function (lines) {\n          var this$1 = this;\n          this.lines = lines;\n          this.parent = null;\n          var height = 0;\n\n          for (var i = 0; i < lines.length; ++i) {\n            lines[i].parent = this$1;\n            height += lines[i].height;\n          }\n\n          this.height = height;\n        };\n\n        LeafChunk.prototype.chunkSize = function () {\n          return this.lines.length;\n        }; // Remove the n lines at offset 'at'.\n\n\n        LeafChunk.prototype.removeInner = function (at, n) {\n          var this$1 = this;\n\n          for (var i = at, e = at + n; i < e; ++i) {\n            var line = this$1.lines[i];\n            this$1.height -= line.height;\n            cleanUpLine(line);\n            signalLater(line, \"delete\");\n          }\n\n          this.lines.splice(at, n);\n        }; // Helper used to collapse a small branch into a single leaf.\n\n\n        LeafChunk.prototype.collapse = function (lines) {\n          lines.push.apply(lines, this.lines);\n        }; // Insert the given array of lines at offset 'at', count them as\n        // having the given height.\n\n\n        LeafChunk.prototype.insertInner = function (at, lines, height) {\n          var this$1 = this;\n          this.height += height;\n          this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n\n          for (var i = 0; i < lines.length; ++i) {\n            lines[i].parent = this$1;\n          }\n        }; // Used to iterate over a part of the tree.\n\n\n        LeafChunk.prototype.iterN = function (at, n, op) {\n          var this$1 = this;\n\n          for (var e = at + n; at < e; ++at) {\n            if (op(this$1.lines[at])) {\n              return true;\n            }\n          }\n        };\n\n        var BranchChunk = function (children) {\n          var this$1 = this;\n          this.children = children;\n          var size = 0,\n              height = 0;\n\n          for (var i = 0; i < children.length; ++i) {\n            var ch = children[i];\n            size += ch.chunkSize();\n            height += ch.height;\n            ch.parent = this$1;\n          }\n\n          this.size = size;\n          this.height = height;\n          this.parent = null;\n        };\n\n        BranchChunk.prototype.chunkSize = function () {\n          return this.size;\n        };\n\n        BranchChunk.prototype.removeInner = function (at, n) {\n          var this$1 = this;\n          this.size -= n;\n\n          for (var i = 0; i < this.children.length; ++i) {\n            var child = this$1.children[i],\n                sz = child.chunkSize();\n\n            if (at < sz) {\n              var rm = Math.min(n, sz - at),\n                  oldHeight = child.height;\n              child.removeInner(at, rm);\n              this$1.height -= oldHeight - child.height;\n\n              if (sz == rm) {\n                this$1.children.splice(i--, 1);\n                child.parent = null;\n              }\n\n              if ((n -= rm) == 0) {\n                break;\n              }\n\n              at = 0;\n            } else {\n              at -= sz;\n            }\n          } // If the result is smaller than 25 lines, ensure that it is a\n          // single leaf node.\n\n\n          if (this.size - n < 25 && (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n            var lines = [];\n            this.collapse(lines);\n            this.children = [new LeafChunk(lines)];\n            this.children[0].parent = this;\n          }\n        };\n\n        BranchChunk.prototype.collapse = function (lines) {\n          var this$1 = this;\n\n          for (var i = 0; i < this.children.length; ++i) {\n            this$1.children[i].collapse(lines);\n          }\n        };\n\n        BranchChunk.prototype.insertInner = function (at, lines, height) {\n          var this$1 = this;\n          this.size += lines.length;\n          this.height += height;\n\n          for (var i = 0; i < this.children.length; ++i) {\n            var child = this$1.children[i],\n                sz = child.chunkSize();\n\n            if (at <= sz) {\n              child.insertInner(at, lines, height);\n\n              if (child.lines && child.lines.length > 50) {\n                // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n                // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n                var remaining = child.lines.length % 25 + 25;\n\n                for (var pos = remaining; pos < child.lines.length;) {\n                  var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n                  child.height -= leaf.height;\n                  this$1.children.splice(++i, 0, leaf);\n                  leaf.parent = this$1;\n                }\n\n                child.lines = child.lines.slice(0, remaining);\n                this$1.maybeSpill();\n              }\n\n              break;\n            }\n\n            at -= sz;\n          }\n        }; // When a node has grown, check whether it should be split.\n\n\n        BranchChunk.prototype.maybeSpill = function () {\n          if (this.children.length <= 10) {\n            return;\n          }\n\n          var me = this;\n\n          do {\n            var spilled = me.children.splice(me.children.length - 5, 5);\n            var sibling = new BranchChunk(spilled);\n\n            if (!me.parent) {\n              // Become the parent node\n              var copy = new BranchChunk(me.children);\n              copy.parent = me;\n              me.children = [copy, sibling];\n              me = copy;\n            } else {\n              me.size -= sibling.size;\n              me.height -= sibling.height;\n              var myIndex = indexOf(me.parent.children, me);\n              me.parent.children.splice(myIndex + 1, 0, sibling);\n            }\n\n            sibling.parent = me.parent;\n          } while (me.children.length > 10);\n\n          me.parent.maybeSpill();\n        };\n\n        BranchChunk.prototype.iterN = function (at, n, op) {\n          var this$1 = this;\n\n          for (var i = 0; i < this.children.length; ++i) {\n            var child = this$1.children[i],\n                sz = child.chunkSize();\n\n            if (at < sz) {\n              var used = Math.min(n, sz - at);\n\n              if (child.iterN(at, used, op)) {\n                return true;\n              }\n\n              if ((n -= used) == 0) {\n                break;\n              }\n\n              at = 0;\n            } else {\n              at -= sz;\n            }\n          }\n        }; // Line widgets are block elements displayed above or below a line.\n\n\n        var LineWidget = function (doc, node, options) {\n          var this$1 = this;\n\n          if (options) {\n            for (var opt in options) {\n              if (options.hasOwnProperty(opt)) {\n                this$1[opt] = options[opt];\n              }\n            }\n          }\n\n          this.doc = doc;\n          this.node = node;\n        };\n\n        LineWidget.prototype.clear = function () {\n          var this$1 = this;\n          var cm = this.doc.cm,\n              ws = this.line.widgets,\n              line = this.line,\n              no = lineNo(line);\n\n          if (no == null || !ws) {\n            return;\n          }\n\n          for (var i = 0; i < ws.length; ++i) {\n            if (ws[i] == this$1) {\n              ws.splice(i--, 1);\n            }\n          }\n\n          if (!ws.length) {\n            line.widgets = null;\n          }\n\n          var height = widgetHeight(this);\n          updateLineHeight(line, Math.max(0, line.height - height));\n\n          if (cm) {\n            runInOp(cm, function () {\n              adjustScrollWhenAboveVisible(cm, line, -height);\n              regLineChange(cm, no, \"widget\");\n            });\n            signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n          }\n        };\n\n        LineWidget.prototype.changed = function () {\n          var this$1 = this;\n          var oldH = this.height,\n              cm = this.doc.cm,\n              line = this.line;\n          this.height = null;\n          var diff = widgetHeight(this) - oldH;\n\n          if (!diff) {\n            return;\n          }\n\n          updateLineHeight(line, line.height + diff);\n\n          if (cm) {\n            runInOp(cm, function () {\n              cm.curOp.forceUpdate = true;\n              adjustScrollWhenAboveVisible(cm, line, diff);\n              signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n            });\n          }\n        };\n\n        eventMixin(LineWidget);\n\n        function adjustScrollWhenAboveVisible(cm, line, diff) {\n          if (heightAtLine(line) < (cm.curOp && cm.curOp.scrollTop || cm.doc.scrollTop)) {\n            addToScrollTop(cm, diff);\n          }\n        }\n\n        function addLineWidget(doc, handle, node, options) {\n          var widget = new LineWidget(doc, node, options);\n          var cm = doc.cm;\n\n          if (cm && widget.noHScroll) {\n            cm.display.alignWidgets = true;\n          }\n\n          changeLine(doc, handle, \"widget\", function (line) {\n            var widgets = line.widgets || (line.widgets = []);\n\n            if (widget.insertAt == null) {\n              widgets.push(widget);\n            } else {\n              widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget);\n            }\n\n            widget.line = line;\n\n            if (cm && !lineIsHidden(doc, line)) {\n              var aboveVisible = heightAtLine(line) < doc.scrollTop;\n              updateLineHeight(line, line.height + widgetHeight(widget));\n\n              if (aboveVisible) {\n                addToScrollTop(cm, widget.height);\n              }\n\n              cm.curOp.forceUpdate = true;\n            }\n\n            return true;\n          });\n          signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle));\n          return widget;\n        } // TEXTMARKERS\n        // Created with markText and setBookmark methods. A TextMarker is a\n        // handle that can be used to clear or find a marked position in the\n        // document. Line objects hold arrays (markedSpans) containing\n        // {from, to, marker} object pointing to such marker objects, and\n        // indicating that such a marker is present on that line. Multiple\n        // lines may point to the same marker when it spans across lines.\n        // The spans will have null for their from/to properties when the\n        // marker continues beyond the start/end of the line. Markers have\n        // links back to the lines they currently touch.\n        // Collapsed markers have unique ids, in order to be able to order\n        // them, which is needed for uniquely determining an outer marker\n        // when they overlap (they may nest, but not partially overlap).\n\n\n        var nextMarkerId = 0;\n\n        var TextMarker = function (doc, type) {\n          this.lines = [];\n          this.type = type;\n          this.doc = doc;\n          this.id = ++nextMarkerId;\n        }; // Clear the marker.\n\n\n        TextMarker.prototype.clear = function () {\n          var this$1 = this;\n\n          if (this.explicitlyCleared) {\n            return;\n          }\n\n          var cm = this.doc.cm,\n              withOp = cm && !cm.curOp;\n\n          if (withOp) {\n            startOperation(cm);\n          }\n\n          if (hasHandler(this, \"clear\")) {\n            var found = this.find();\n\n            if (found) {\n              signalLater(this, \"clear\", found.from, found.to);\n            }\n          }\n\n          var min = null,\n              max = null;\n\n          for (var i = 0; i < this.lines.length; ++i) {\n            var line = this$1.lines[i];\n            var span = getMarkedSpanFor(line.markedSpans, this$1);\n\n            if (cm && !this$1.collapsed) {\n              regLineChange(cm, lineNo(line), \"text\");\n            } else if (cm) {\n              if (span.to != null) {\n                max = lineNo(line);\n              }\n\n              if (span.from != null) {\n                min = lineNo(line);\n              }\n            }\n\n            line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n\n            if (span.from == null && this$1.collapsed && !lineIsHidden(this$1.doc, line) && cm) {\n              updateLineHeight(line, textHeight(cm.display));\n            }\n          }\n\n          if (cm && this.collapsed && !cm.options.lineWrapping) {\n            for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n              var visual = visualLine(this$1.lines[i$1]),\n                  len = lineLength(visual);\n\n              if (len > cm.display.maxLineLength) {\n                cm.display.maxLine = visual;\n                cm.display.maxLineLength = len;\n                cm.display.maxLineChanged = true;\n              }\n            }\n          }\n\n          if (min != null && cm && this.collapsed) {\n            regChange(cm, min, max + 1);\n          }\n\n          this.lines.length = 0;\n          this.explicitlyCleared = true;\n\n          if (this.atomic && this.doc.cantEdit) {\n            this.doc.cantEdit = false;\n\n            if (cm) {\n              reCheckSelection(cm.doc);\n            }\n          }\n\n          if (cm) {\n            signalLater(cm, \"markerCleared\", cm, this, min, max);\n          }\n\n          if (withOp) {\n            endOperation(cm);\n          }\n\n          if (this.parent) {\n            this.parent.clear();\n          }\n        }; // Find the position of the marker in the document. Returns a {from,\n        // to} object by default. Side can be passed to get a specific side\n        // -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n        // Pos objects returned contain a line object, rather than a line\n        // number (used to prevent looking up the same line twice).\n\n\n        TextMarker.prototype.find = function (side, lineObj) {\n          var this$1 = this;\n\n          if (side == null && this.type == \"bookmark\") {\n            side = 1;\n          }\n\n          var from, to;\n\n          for (var i = 0; i < this.lines.length; ++i) {\n            var line = this$1.lines[i];\n            var span = getMarkedSpanFor(line.markedSpans, this$1);\n\n            if (span.from != null) {\n              from = Pos(lineObj ? line : lineNo(line), span.from);\n\n              if (side == -1) {\n                return from;\n              }\n            }\n\n            if (span.to != null) {\n              to = Pos(lineObj ? line : lineNo(line), span.to);\n\n              if (side == 1) {\n                return to;\n              }\n            }\n          }\n\n          return from && {\n            from: from,\n            to: to\n          };\n        }; // Signals that the marker's widget changed, and surrounding layout\n        // should be recomputed.\n\n\n        TextMarker.prototype.changed = function () {\n          var this$1 = this;\n          var pos = this.find(-1, true),\n              widget = this,\n              cm = this.doc.cm;\n\n          if (!pos || !cm) {\n            return;\n          }\n\n          runInOp(cm, function () {\n            var line = pos.line,\n                lineN = lineNo(pos.line);\n            var view = findViewForLine(cm, lineN);\n\n            if (view) {\n              clearLineMeasurementCacheFor(view);\n              cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n            }\n\n            cm.curOp.updateMaxLine = true;\n\n            if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n              var oldHeight = widget.height;\n              widget.height = null;\n              var dHeight = widgetHeight(widget) - oldHeight;\n\n              if (dHeight) {\n                updateLineHeight(line, line.height + dHeight);\n              }\n            }\n\n            signalLater(cm, \"markerChanged\", cm, this$1);\n          });\n        };\n\n        TextMarker.prototype.attachLine = function (line) {\n          if (!this.lines.length && this.doc.cm) {\n            var op = this.doc.cm.curOp;\n\n            if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1) {\n              (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this);\n            }\n          }\n\n          this.lines.push(line);\n        };\n\n        TextMarker.prototype.detachLine = function (line) {\n          this.lines.splice(indexOf(this.lines, line), 1);\n\n          if (!this.lines.length && this.doc.cm) {\n            var op = this.doc.cm.curOp;\n            (op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n          }\n        };\n\n        eventMixin(TextMarker); // Create a marker, wire it up to the right lines, and\n\n        function markText(doc, from, to, options, type) {\n          // Shared markers (across linked documents) are handled separately\n          // (markTextShared will call out to this again, once per\n          // document).\n          if (options && options.shared) {\n            return markTextShared(doc, from, to, options, type);\n          } // Ensure we are in an operation.\n\n\n          if (doc.cm && !doc.cm.curOp) {\n            return operation(doc.cm, markText)(doc, from, to, options, type);\n          }\n\n          var marker = new TextMarker(doc, type),\n              diff = cmp(from, to);\n\n          if (options) {\n            copyObj(options, marker, false);\n          } // Don't connect empty markers unless clearWhenEmpty is false\n\n\n          if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false) {\n            return marker;\n          }\n\n          if (marker.replacedWith) {\n            // Showing up as a widget implies collapsed (widget replaces text)\n            marker.collapsed = true;\n            marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n\n            if (!options.handleMouseEvents) {\n              marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\");\n            }\n\n            if (options.insertLeft) {\n              marker.widgetNode.insertLeft = true;\n            }\n          }\n\n          if (marker.collapsed) {\n            if (conflictingCollapsedRange(doc, from.line, from, to, marker) || from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker)) {\n              throw new Error(\"Inserting collapsed marker partially overlapping an existing one\");\n            }\n\n            seeCollapsedSpans();\n          }\n\n          if (marker.addToHistory) {\n            addChangeToHistory(doc, {\n              from: from,\n              to: to,\n              origin: \"markText\"\n            }, doc.sel, NaN);\n          }\n\n          var curLine = from.line,\n              cm = doc.cm,\n              updateMaxLine;\n          doc.iter(curLine, to.line + 1, function (line) {\n            if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine) {\n              updateMaxLine = true;\n            }\n\n            if (marker.collapsed && curLine != from.line) {\n              updateLineHeight(line, 0);\n            }\n\n            addMarkedSpan(line, new MarkedSpan(marker, curLine == from.line ? from.ch : null, curLine == to.line ? to.ch : null));\n            ++curLine;\n          }); // lineIsHidden depends on the presence of the spans, so needs a second pass\n\n          if (marker.collapsed) {\n            doc.iter(from.line, to.line + 1, function (line) {\n              if (lineIsHidden(doc, line)) {\n                updateLineHeight(line, 0);\n              }\n            });\n          }\n\n          if (marker.clearOnEnter) {\n            on(marker, \"beforeCursorEnter\", function () {\n              return marker.clear();\n            });\n          }\n\n          if (marker.readOnly) {\n            seeReadOnlySpans();\n\n            if (doc.history.done.length || doc.history.undone.length) {\n              doc.clearHistory();\n            }\n          }\n\n          if (marker.collapsed) {\n            marker.id = ++nextMarkerId;\n            marker.atomic = true;\n          }\n\n          if (cm) {\n            // Sync editor state\n            if (updateMaxLine) {\n              cm.curOp.updateMaxLine = true;\n            }\n\n            if (marker.collapsed) {\n              regChange(cm, from.line, to.line + 1);\n            } else if (marker.className || marker.title || marker.startStyle || marker.endStyle || marker.css) {\n              for (var i = from.line; i <= to.line; i++) {\n                regLineChange(cm, i, \"text\");\n              }\n            }\n\n            if (marker.atomic) {\n              reCheckSelection(cm.doc);\n            }\n\n            signalLater(cm, \"markerAdded\", cm, marker);\n          }\n\n          return marker;\n        } // SHARED TEXTMARKERS\n        // A shared marker spans multiple linked documents. It is\n        // implemented as a meta-marker-object controlling multiple normal\n        // markers.\n\n\n        var SharedTextMarker = function (markers, primary) {\n          var this$1 = this;\n          this.markers = markers;\n          this.primary = primary;\n\n          for (var i = 0; i < markers.length; ++i) {\n            markers[i].parent = this$1;\n          }\n        };\n\n        SharedTextMarker.prototype.clear = function () {\n          var this$1 = this;\n\n          if (this.explicitlyCleared) {\n            return;\n          }\n\n          this.explicitlyCleared = true;\n\n          for (var i = 0; i < this.markers.length; ++i) {\n            this$1.markers[i].clear();\n          }\n\n          signalLater(this, \"clear\");\n        };\n\n        SharedTextMarker.prototype.find = function (side, lineObj) {\n          return this.primary.find(side, lineObj);\n        };\n\n        eventMixin(SharedTextMarker);\n\n        function markTextShared(doc, from, to, options, type) {\n          options = copyObj(options);\n          options.shared = false;\n          var markers = [markText(doc, from, to, options, type)],\n              primary = markers[0];\n          var widget = options.widgetNode;\n          linkedDocs(doc, function (doc) {\n            if (widget) {\n              options.widgetNode = widget.cloneNode(true);\n            }\n\n            markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n\n            for (var i = 0; i < doc.linked.length; ++i) {\n              if (doc.linked[i].isParent) {\n                return;\n              }\n            }\n\n            primary = lst(markers);\n          });\n          return new SharedTextMarker(markers, primary);\n        }\n\n        function findSharedMarkers(doc) {\n          return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) {\n            return m.parent;\n          });\n        }\n\n        function copySharedMarkers(doc, markers) {\n          for (var i = 0; i < markers.length; i++) {\n            var marker = markers[i],\n                pos = marker.find();\n            var mFrom = doc.clipPos(pos.from),\n                mTo = doc.clipPos(pos.to);\n\n            if (cmp(mFrom, mTo)) {\n              var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n              marker.markers.push(subMark);\n              subMark.parent = marker;\n            }\n          }\n        }\n\n        function detachSharedMarkers(markers) {\n          var loop = function (i) {\n            var marker = markers[i],\n                linked = [marker.primary.doc];\n            linkedDocs(marker.primary.doc, function (d) {\n              return linked.push(d);\n            });\n\n            for (var j = 0; j < marker.markers.length; j++) {\n              var subMarker = marker.markers[j];\n\n              if (indexOf(linked, subMarker.doc) == -1) {\n                subMarker.parent = null;\n                marker.markers.splice(j--, 1);\n              }\n            }\n          };\n\n          for (var i = 0; i < markers.length; i++) loop(i);\n        }\n\n        var nextDocId = 0;\n\n        var Doc = function (text, mode, firstLine, lineSep, direction) {\n          if (!(this instanceof Doc)) {\n            return new Doc(text, mode, firstLine, lineSep, direction);\n          }\n\n          if (firstLine == null) {\n            firstLine = 0;\n          }\n\n          BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n          this.first = firstLine;\n          this.scrollTop = this.scrollLeft = 0;\n          this.cantEdit = false;\n          this.cleanGeneration = 1;\n          this.frontier = firstLine;\n          var start = Pos(firstLine, 0);\n          this.sel = simpleSelection(start);\n          this.history = new History(null);\n          this.id = ++nextDocId;\n          this.modeOption = mode;\n          this.lineSep = lineSep;\n          this.direction = direction == \"rtl\" ? \"rtl\" : \"ltr\";\n          this.extend = false;\n\n          if (typeof text == \"string\") {\n            text = this.splitLines(text);\n          }\n\n          updateDoc(this, {\n            from: start,\n            to: start,\n            text: text\n          });\n          setSelection(this, simpleSelection(start), sel_dontScroll);\n        };\n\n        Doc.prototype = createObj(BranchChunk.prototype, {\n          constructor: Doc,\n          // Iterate over the document. Supports two forms -- with only one\n          // argument, it calls that for each line in the document. With\n          // three, it iterates over the range given by the first two (with\n          // the second being non-inclusive).\n          iter: function (from, to, op) {\n            if (op) {\n              this.iterN(from - this.first, to - from, op);\n            } else {\n              this.iterN(this.first, this.first + this.size, from);\n            }\n          },\n          // Non-public interface for adding and removing lines.\n          insert: function (at, lines) {\n            var height = 0;\n\n            for (var i = 0; i < lines.length; ++i) {\n              height += lines[i].height;\n            }\n\n            this.insertInner(at - this.first, lines, height);\n          },\n          remove: function (at, n) {\n            this.removeInner(at - this.first, n);\n          },\n          // From here, the methods are part of the public interface. Most\n          // are also available from CodeMirror (editor) instances.\n          getValue: function (lineSep) {\n            var lines = getLines(this, this.first, this.first + this.size);\n\n            if (lineSep === false) {\n              return lines;\n            }\n\n            return lines.join(lineSep || this.lineSeparator());\n          },\n          setValue: docMethodOp(function (code) {\n            var top = Pos(this.first, 0),\n                last = this.first + this.size - 1;\n            makeChange(this, {\n              from: top,\n              to: Pos(last, getLine(this, last).text.length),\n              text: this.splitLines(code),\n              origin: \"setValue\",\n              full: true\n            }, true);\n\n            if (this.cm) {\n              scrollToCoords(this.cm, 0, 0);\n            }\n\n            setSelection(this, simpleSelection(top), sel_dontScroll);\n          }),\n          replaceRange: function (code, from, to, origin) {\n            from = clipPos(this, from);\n            to = to ? clipPos(this, to) : from;\n            replaceRange(this, code, from, to, origin);\n          },\n          getRange: function (from, to, lineSep) {\n            var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n\n            if (lineSep === false) {\n              return lines;\n            }\n\n            return lines.join(lineSep || this.lineSeparator());\n          },\n          getLine: function (line) {\n            var l = this.getLineHandle(line);\n            return l && l.text;\n          },\n          getLineHandle: function (line) {\n            if (isLine(this, line)) {\n              return getLine(this, line);\n            }\n          },\n          getLineNumber: function (line) {\n            return lineNo(line);\n          },\n          getLineHandleVisualStart: function (line) {\n            if (typeof line == \"number\") {\n              line = getLine(this, line);\n            }\n\n            return visualLine(line);\n          },\n          lineCount: function () {\n            return this.size;\n          },\n          firstLine: function () {\n            return this.first;\n          },\n          lastLine: function () {\n            return this.first + this.size - 1;\n          },\n          clipPos: function (pos) {\n            return clipPos(this, pos);\n          },\n          getCursor: function (start) {\n            var range$$1 = this.sel.primary(),\n                pos;\n\n            if (start == null || start == \"head\") {\n              pos = range$$1.head;\n            } else if (start == \"anchor\") {\n              pos = range$$1.anchor;\n            } else if (start == \"end\" || start == \"to\" || start === false) {\n              pos = range$$1.to();\n            } else {\n              pos = range$$1.from();\n            }\n\n            return pos;\n          },\n          listSelections: function () {\n            return this.sel.ranges;\n          },\n          somethingSelected: function () {\n            return this.sel.somethingSelected();\n          },\n          setCursor: docMethodOp(function (line, ch, options) {\n            setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n          }),\n          setSelection: docMethodOp(function (anchor, head, options) {\n            setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n          }),\n          extendSelection: docMethodOp(function (head, other, options) {\n            extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n          }),\n          extendSelections: docMethodOp(function (heads, options) {\n            extendSelections(this, clipPosArray(this, heads), options);\n          }),\n          extendSelectionsBy: docMethodOp(function (f, options) {\n            var heads = map(this.sel.ranges, f);\n            extendSelections(this, clipPosArray(this, heads), options);\n          }),\n          setSelections: docMethodOp(function (ranges, primary, options) {\n            var this$1 = this;\n\n            if (!ranges.length) {\n              return;\n            }\n\n            var out = [];\n\n            for (var i = 0; i < ranges.length; i++) {\n              out[i] = new Range(clipPos(this$1, ranges[i].anchor), clipPos(this$1, ranges[i].head));\n            }\n\n            if (primary == null) {\n              primary = Math.min(ranges.length - 1, this.sel.primIndex);\n            }\n\n            setSelection(this, normalizeSelection(out, primary), options);\n          }),\n          addSelection: docMethodOp(function (anchor, head, options) {\n            var ranges = this.sel.ranges.slice(0);\n            ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n            setSelection(this, normalizeSelection(ranges, ranges.length - 1), options);\n          }),\n          getSelection: function (lineSep) {\n            var this$1 = this;\n            var ranges = this.sel.ranges,\n                lines;\n\n            for (var i = 0; i < ranges.length; i++) {\n              var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n              lines = lines ? lines.concat(sel) : sel;\n            }\n\n            if (lineSep === false) {\n              return lines;\n            } else {\n              return lines.join(lineSep || this.lineSeparator());\n            }\n          },\n          getSelections: function (lineSep) {\n            var this$1 = this;\n            var parts = [],\n                ranges = this.sel.ranges;\n\n            for (var i = 0; i < ranges.length; i++) {\n              var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n\n              if (lineSep !== false) {\n                sel = sel.join(lineSep || this$1.lineSeparator());\n              }\n\n              parts[i] = sel;\n            }\n\n            return parts;\n          },\n          replaceSelection: function (code, collapse, origin) {\n            var dup = [];\n\n            for (var i = 0; i < this.sel.ranges.length; i++) {\n              dup[i] = code;\n            }\n\n            this.replaceSelections(dup, collapse, origin || \"+input\");\n          },\n          replaceSelections: docMethodOp(function (code, collapse, origin) {\n            var this$1 = this;\n            var changes = [],\n                sel = this.sel;\n\n            for (var i = 0; i < sel.ranges.length; i++) {\n              var range$$1 = sel.ranges[i];\n              changes[i] = {\n                from: range$$1.from(),\n                to: range$$1.to(),\n                text: this$1.splitLines(code[i]),\n                origin: origin\n              };\n            }\n\n            var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n\n            for (var i$1 = changes.length - 1; i$1 >= 0; i$1--) {\n              makeChange(this$1, changes[i$1]);\n            }\n\n            if (newSel) {\n              setSelectionReplaceHistory(this, newSel);\n            } else if (this.cm) {\n              ensureCursorVisible(this.cm);\n            }\n          }),\n          undo: docMethodOp(function () {\n            makeChangeFromHistory(this, \"undo\");\n          }),\n          redo: docMethodOp(function () {\n            makeChangeFromHistory(this, \"redo\");\n          }),\n          undoSelection: docMethodOp(function () {\n            makeChangeFromHistory(this, \"undo\", true);\n          }),\n          redoSelection: docMethodOp(function () {\n            makeChangeFromHistory(this, \"redo\", true);\n          }),\n          setExtending: function (val) {\n            this.extend = val;\n          },\n          getExtending: function () {\n            return this.extend;\n          },\n          historySize: function () {\n            var hist = this.history,\n                done = 0,\n                undone = 0;\n\n            for (var i = 0; i < hist.done.length; i++) {\n              if (!hist.done[i].ranges) {\n                ++done;\n              }\n            }\n\n            for (var i$1 = 0; i$1 < hist.undone.length; i$1++) {\n              if (!hist.undone[i$1].ranges) {\n                ++undone;\n              }\n            }\n\n            return {\n              undo: done,\n              redo: undone\n            };\n          },\n          clearHistory: function () {\n            this.history = new History(this.history.maxGeneration);\n          },\n          markClean: function () {\n            this.cleanGeneration = this.changeGeneration(true);\n          },\n          changeGeneration: function (forceSplit) {\n            if (forceSplit) {\n              this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null;\n            }\n\n            return this.history.generation;\n          },\n          isClean: function (gen) {\n            return this.history.generation == (gen || this.cleanGeneration);\n          },\n          getHistory: function () {\n            return {\n              done: copyHistoryArray(this.history.done),\n              undone: copyHistoryArray(this.history.undone)\n            };\n          },\n          setHistory: function (histData) {\n            var hist = this.history = new History(this.history.maxGeneration);\n            hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n            hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n          },\n          setGutterMarker: docMethodOp(function (line, gutterID, value) {\n            return changeLine(this, line, \"gutter\", function (line) {\n              var markers = line.gutterMarkers || (line.gutterMarkers = {});\n              markers[gutterID] = value;\n\n              if (!value && isEmpty(markers)) {\n                line.gutterMarkers = null;\n              }\n\n              return true;\n            });\n          }),\n          clearGutter: docMethodOp(function (gutterID) {\n            var this$1 = this;\n            this.iter(function (line) {\n              if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n                changeLine(this$1, line, \"gutter\", function () {\n                  line.gutterMarkers[gutterID] = null;\n\n                  if (isEmpty(line.gutterMarkers)) {\n                    line.gutterMarkers = null;\n                  }\n\n                  return true;\n                });\n              }\n            });\n          }),\n          lineInfo: function (line) {\n            var n;\n\n            if (typeof line == \"number\") {\n              if (!isLine(this, line)) {\n                return null;\n              }\n\n              n = line;\n              line = getLine(this, line);\n\n              if (!line) {\n                return null;\n              }\n            } else {\n              n = lineNo(line);\n\n              if (n == null) {\n                return null;\n              }\n            }\n\n            return {\n              line: n,\n              handle: line,\n              text: line.text,\n              gutterMarkers: line.gutterMarkers,\n              textClass: line.textClass,\n              bgClass: line.bgClass,\n              wrapClass: line.wrapClass,\n              widgets: line.widgets\n            };\n          },\n          addLineClass: docMethodOp(function (handle, where, cls) {\n            return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n              var prop = where == \"text\" ? \"textClass\" : where == \"background\" ? \"bgClass\" : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n\n              if (!line[prop]) {\n                line[prop] = cls;\n              } else if (classTest(cls).test(line[prop])) {\n                return false;\n              } else {\n                line[prop] += \" \" + cls;\n              }\n\n              return true;\n            });\n          }),\n          removeLineClass: docMethodOp(function (handle, where, cls) {\n            return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n              var prop = where == \"text\" ? \"textClass\" : where == \"background\" ? \"bgClass\" : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n              var cur = line[prop];\n\n              if (!cur) {\n                return false;\n              } else if (cls == null) {\n                line[prop] = null;\n              } else {\n                var found = cur.match(classTest(cls));\n\n                if (!found) {\n                  return false;\n                }\n\n                var end = found.index + found[0].length;\n                line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n              }\n\n              return true;\n            });\n          }),\n          addLineWidget: docMethodOp(function (handle, node, options) {\n            return addLineWidget(this, handle, node, options);\n          }),\n          removeLineWidget: function (widget) {\n            widget.clear();\n          },\n          markText: function (from, to, options) {\n            return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\");\n          },\n          setBookmark: function (pos, options) {\n            var realOpts = {\n              replacedWith: options && (options.nodeType == null ? options.widget : options),\n              insertLeft: options && options.insertLeft,\n              clearWhenEmpty: false,\n              shared: options && options.shared,\n              handleMouseEvents: options && options.handleMouseEvents\n            };\n            pos = clipPos(this, pos);\n            return markText(this, pos, pos, realOpts, \"bookmark\");\n          },\n          findMarksAt: function (pos) {\n            pos = clipPos(this, pos);\n            var markers = [],\n                spans = getLine(this, pos.line).markedSpans;\n\n            if (spans) {\n              for (var i = 0; i < spans.length; ++i) {\n                var span = spans[i];\n\n                if ((span.from == null || span.from <= pos.ch) && (span.to == null || span.to >= pos.ch)) {\n                  markers.push(span.marker.parent || span.marker);\n                }\n              }\n            }\n\n            return markers;\n          },\n          findMarks: function (from, to, filter) {\n            from = clipPos(this, from);\n            to = clipPos(this, to);\n            var found = [],\n                lineNo$$1 = from.line;\n            this.iter(from.line, to.line + 1, function (line) {\n              var spans = line.markedSpans;\n\n              if (spans) {\n                for (var i = 0; i < spans.length; i++) {\n                  var span = spans[i];\n\n                  if (!(span.to != null && lineNo$$1 == from.line && from.ch >= span.to || span.from == null && lineNo$$1 != from.line || span.from != null && lineNo$$1 == to.line && span.from >= to.ch) && (!filter || filter(span.marker))) {\n                    found.push(span.marker.parent || span.marker);\n                  }\n                }\n              }\n\n              ++lineNo$$1;\n            });\n            return found;\n          },\n          getAllMarks: function () {\n            var markers = [];\n            this.iter(function (line) {\n              var sps = line.markedSpans;\n\n              if (sps) {\n                for (var i = 0; i < sps.length; ++i) {\n                  if (sps[i].from != null) {\n                    markers.push(sps[i].marker);\n                  }\n                }\n              }\n            });\n            return markers;\n          },\n          posFromIndex: function (off) {\n            var ch,\n                lineNo$$1 = this.first,\n                sepSize = this.lineSeparator().length;\n            this.iter(function (line) {\n              var sz = line.text.length + sepSize;\n\n              if (sz > off) {\n                ch = off;\n                return true;\n              }\n\n              off -= sz;\n              ++lineNo$$1;\n            });\n            return clipPos(this, Pos(lineNo$$1, ch));\n          },\n          indexFromPos: function (coords) {\n            coords = clipPos(this, coords);\n            var index = coords.ch;\n\n            if (coords.line < this.first || coords.ch < 0) {\n              return 0;\n            }\n\n            var sepSize = this.lineSeparator().length;\n            this.iter(this.first, coords.line, function (line) {\n              // iter aborts when callback returns a truthy value\n              index += line.text.length + sepSize;\n            });\n            return index;\n          },\n          copy: function (copyHistory) {\n            var doc = new Doc(getLines(this, this.first, this.first + this.size), this.modeOption, this.first, this.lineSep, this.direction);\n            doc.scrollTop = this.scrollTop;\n            doc.scrollLeft = this.scrollLeft;\n            doc.sel = this.sel;\n            doc.extend = false;\n\n            if (copyHistory) {\n              doc.history.undoDepth = this.history.undoDepth;\n              doc.setHistory(this.getHistory());\n            }\n\n            return doc;\n          },\n          linkedDoc: function (options) {\n            if (!options) {\n              options = {};\n            }\n\n            var from = this.first,\n                to = this.first + this.size;\n\n            if (options.from != null && options.from > from) {\n              from = options.from;\n            }\n\n            if (options.to != null && options.to < to) {\n              to = options.to;\n            }\n\n            var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n\n            if (options.sharedHist) {\n              copy.history = this.history;\n            }\n\n            (this.linked || (this.linked = [])).push({\n              doc: copy,\n              sharedHist: options.sharedHist\n            });\n            copy.linked = [{\n              doc: this,\n              isParent: true,\n              sharedHist: options.sharedHist\n            }];\n            copySharedMarkers(copy, findSharedMarkers(this));\n            return copy;\n          },\n          unlinkDoc: function (other) {\n            var this$1 = this;\n\n            if (other instanceof CodeMirror$1) {\n              other = other.doc;\n            }\n\n            if (this.linked) {\n              for (var i = 0; i < this.linked.length; ++i) {\n                var link = this$1.linked[i];\n\n                if (link.doc != other) {\n                  continue;\n                }\n\n                this$1.linked.splice(i, 1);\n                other.unlinkDoc(this$1);\n                detachSharedMarkers(findSharedMarkers(this$1));\n                break;\n              }\n            } // If the histories were shared, split them again\n\n\n            if (other.history == this.history) {\n              var splitIds = [other.id];\n              linkedDocs(other, function (doc) {\n                return splitIds.push(doc.id);\n              }, true);\n              other.history = new History(null);\n              other.history.done = copyHistoryArray(this.history.done, splitIds);\n              other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n            }\n          },\n          iterLinkedDocs: function (f) {\n            linkedDocs(this, f);\n          },\n          getMode: function () {\n            return this.mode;\n          },\n          getEditor: function () {\n            return this.cm;\n          },\n          splitLines: function (str) {\n            if (this.lineSep) {\n              return str.split(this.lineSep);\n            }\n\n            return splitLinesAuto(str);\n          },\n          lineSeparator: function () {\n            return this.lineSep || \"\\n\";\n          },\n          setDirection: docMethodOp(function (dir) {\n            if (dir != \"rtl\") {\n              dir = \"ltr\";\n            }\n\n            if (dir == this.direction) {\n              return;\n            }\n\n            this.direction = dir;\n            this.iter(function (line) {\n              return line.order = null;\n            });\n\n            if (this.cm) {\n              directionChanged(this.cm);\n            }\n          })\n        }); // Public alias.\n\n        Doc.prototype.eachLine = Doc.prototype.iter; // Kludge to work around strange IE behavior where it'll sometimes\n        // re-fire a series of drag-related events right after the drop (#1551)\n\n        var lastDrop = 0;\n\n        function onDrop(e) {\n          var cm = this;\n          clearDragCursor(cm);\n\n          if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) {\n            return;\n          }\n\n          e_preventDefault(e);\n\n          if (ie) {\n            lastDrop = +new Date();\n          }\n\n          var pos = posFromMouse(cm, e, true),\n              files = e.dataTransfer.files;\n\n          if (!pos || cm.isReadOnly()) {\n            return;\n          } // Might be a file drop, in which case we simply extract the text\n          // and insert it.\n\n\n          if (files && files.length && window.FileReader && window.File) {\n            var n = files.length,\n                text = Array(n),\n                read = 0;\n\n            var loadFile = function (file, i) {\n              if (cm.options.allowDropFileTypes && indexOf(cm.options.allowDropFileTypes, file.type) == -1) {\n                return;\n              }\n\n              var reader = new FileReader();\n              reader.onload = operation(cm, function () {\n                var content = reader.result;\n\n                if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) {\n                  content = \"\";\n                }\n\n                text[i] = content;\n\n                if (++read == n) {\n                  pos = clipPos(cm.doc, pos);\n                  var change = {\n                    from: pos,\n                    to: pos,\n                    text: cm.doc.splitLines(text.join(cm.doc.lineSeparator())),\n                    origin: \"paste\"\n                  };\n                  makeChange(cm.doc, change);\n                  setSelectionReplaceHistory(cm.doc, simpleSelection(pos, changeEnd(change)));\n                }\n              });\n              reader.readAsText(file);\n            };\n\n            for (var i = 0; i < n; ++i) {\n              loadFile(files[i], i);\n            }\n          } else {\n            // Normal drop\n            // Don't do a replace if the drop happened inside of the selected text.\n            if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n              cm.state.draggingText(e); // Ensure the editor is re-focused\n\n              setTimeout(function () {\n                return cm.display.input.focus();\n              }, 20);\n              return;\n            }\n\n            try {\n              var text$1 = e.dataTransfer.getData(\"Text\");\n\n              if (text$1) {\n                var selected;\n\n                if (cm.state.draggingText && !cm.state.draggingText.copy) {\n                  selected = cm.listSelections();\n                }\n\n                setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n\n                if (selected) {\n                  for (var i$1 = 0; i$1 < selected.length; ++i$1) {\n                    replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\");\n                  }\n                }\n\n                cm.replaceSelection(text$1, \"around\", \"paste\");\n                cm.display.input.focus();\n              }\n            } catch (e) {}\n          }\n        }\n\n        function onDragStart(cm, e) {\n          if (ie && (!cm.state.draggingText || +new Date() - lastDrop < 100)) {\n            e_stop(e);\n            return;\n          }\n\n          if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) {\n            return;\n          }\n\n          e.dataTransfer.setData(\"Text\", cm.getSelection());\n          e.dataTransfer.effectAllowed = \"copyMove\"; // Use dummy image instead of default browsers image.\n          // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n\n          if (e.dataTransfer.setDragImage && !safari) {\n            var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n            img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n\n            if (presto) {\n              img.width = img.height = 1;\n              cm.display.wrapper.appendChild(img); // Force a relayout, or Opera won't use our image for some obscure reason\n\n              img._top = img.offsetTop;\n            }\n\n            e.dataTransfer.setDragImage(img, 0, 0);\n\n            if (presto) {\n              img.parentNode.removeChild(img);\n            }\n          }\n        }\n\n        function onDragOver(cm, e) {\n          var pos = posFromMouse(cm, e);\n\n          if (!pos) {\n            return;\n          }\n\n          var frag = document.createDocumentFragment();\n          drawSelectionCursor(cm, pos, frag);\n\n          if (!cm.display.dragCursor) {\n            cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n            cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n          }\n\n          removeChildrenAndAdd(cm.display.dragCursor, frag);\n        }\n\n        function clearDragCursor(cm) {\n          if (cm.display.dragCursor) {\n            cm.display.lineSpace.removeChild(cm.display.dragCursor);\n            cm.display.dragCursor = null;\n          }\n        } // These must be handled carefully, because naively registering a\n        // handler for each editor will cause the editors to never be\n        // garbage collected.\n\n\n        function forEachCodeMirror(f) {\n          if (!document.body.getElementsByClassName) {\n            return;\n          }\n\n          var byClass = document.body.getElementsByClassName(\"CodeMirror\");\n\n          for (var i = 0; i < byClass.length; i++) {\n            var cm = byClass[i].CodeMirror;\n\n            if (cm) {\n              f(cm);\n            }\n          }\n        }\n\n        var globalsRegistered = false;\n\n        function ensureGlobalHandlers() {\n          if (globalsRegistered) {\n            return;\n          }\n\n          registerGlobalHandlers();\n          globalsRegistered = true;\n        }\n\n        function registerGlobalHandlers() {\n          // When the window resizes, we need to refresh active editors.\n          var resizeTimer;\n          on(window, \"resize\", function () {\n            if (resizeTimer == null) {\n              resizeTimer = setTimeout(function () {\n                resizeTimer = null;\n                forEachCodeMirror(onResize);\n              }, 100);\n            }\n          }); // When the window loses focus, we want to show the editor as blurred\n\n          on(window, \"blur\", function () {\n            return forEachCodeMirror(onBlur);\n          });\n        } // Called when the window resizes\n\n\n        function onResize(cm) {\n          var d = cm.display;\n\n          if (d.lastWrapHeight == d.wrapper.clientHeight && d.lastWrapWidth == d.wrapper.clientWidth) {\n            return;\n          } // Might be a text scaling operation, clear size caches.\n\n\n          d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n          d.scrollbarsClipped = false;\n          cm.setSize();\n        }\n\n        var keyNames = {\n          3: \"Enter\",\n          8: \"Backspace\",\n          9: \"Tab\",\n          13: \"Enter\",\n          16: \"Shift\",\n          17: \"Ctrl\",\n          18: \"Alt\",\n          19: \"Pause\",\n          20: \"CapsLock\",\n          27: \"Esc\",\n          32: \"Space\",\n          33: \"PageUp\",\n          34: \"PageDown\",\n          35: \"End\",\n          36: \"Home\",\n          37: \"Left\",\n          38: \"Up\",\n          39: \"Right\",\n          40: \"Down\",\n          44: \"PrintScrn\",\n          45: \"Insert\",\n          46: \"Delete\",\n          59: \";\",\n          61: \"=\",\n          91: \"Mod\",\n          92: \"Mod\",\n          93: \"Mod\",\n          106: \"*\",\n          107: \"=\",\n          109: \"-\",\n          110: \".\",\n          111: \"/\",\n          127: \"Delete\",\n          173: \"-\",\n          186: \";\",\n          187: \"=\",\n          188: \",\",\n          189: \"-\",\n          190: \".\",\n          191: \"/\",\n          192: \"`\",\n          219: \"[\",\n          220: \"\\\\\",\n          221: \"]\",\n          222: \"'\",\n          63232: \"Up\",\n          63233: \"Down\",\n          63234: \"Left\",\n          63235: \"Right\",\n          63272: \"Delete\",\n          63273: \"Home\",\n          63275: \"End\",\n          63276: \"PageUp\",\n          63277: \"PageDown\",\n          63302: \"Insert\"\n        }; // Number keys\n\n        for (var i = 0; i < 10; i++) {\n          keyNames[i + 48] = keyNames[i + 96] = String(i);\n        } // Alphabetic keys\n\n\n        for (var i$1 = 65; i$1 <= 90; i$1++) {\n          keyNames[i$1] = String.fromCharCode(i$1);\n        } // Function keys\n\n\n        for (var i$2 = 1; i$2 <= 12; i$2++) {\n          keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2;\n        }\n\n        var keyMap = {};\n        keyMap.basic = {\n          \"Left\": \"goCharLeft\",\n          \"Right\": \"goCharRight\",\n          \"Up\": \"goLineUp\",\n          \"Down\": \"goLineDown\",\n          \"End\": \"goLineEnd\",\n          \"Home\": \"goLineStartSmart\",\n          \"PageUp\": \"goPageUp\",\n          \"PageDown\": \"goPageDown\",\n          \"Delete\": \"delCharAfter\",\n          \"Backspace\": \"delCharBefore\",\n          \"Shift-Backspace\": \"delCharBefore\",\n          \"Tab\": \"defaultTab\",\n          \"Shift-Tab\": \"indentAuto\",\n          \"Enter\": \"newlineAndIndent\",\n          \"Insert\": \"toggleOverwrite\",\n          \"Esc\": \"singleSelection\"\n        }; // Note that the save and find-related commands aren't defined by\n        // default. User code or addons can define them. Unknown commands\n        // are simply ignored.\n\n        keyMap.pcDefault = {\n          \"Ctrl-A\": \"selectAll\",\n          \"Ctrl-D\": \"deleteLine\",\n          \"Ctrl-Z\": \"undo\",\n          \"Shift-Ctrl-Z\": \"redo\",\n          \"Ctrl-Y\": \"redo\",\n          \"Ctrl-Home\": \"goDocStart\",\n          \"Ctrl-End\": \"goDocEnd\",\n          \"Ctrl-Up\": \"goLineUp\",\n          \"Ctrl-Down\": \"goLineDown\",\n          \"Ctrl-Left\": \"goGroupLeft\",\n          \"Ctrl-Right\": \"goGroupRight\",\n          \"Alt-Left\": \"goLineStart\",\n          \"Alt-Right\": \"goLineEnd\",\n          \"Ctrl-Backspace\": \"delGroupBefore\",\n          \"Ctrl-Delete\": \"delGroupAfter\",\n          \"Ctrl-S\": \"save\",\n          \"Ctrl-F\": \"find\",\n          \"Ctrl-G\": \"findNext\",\n          \"Shift-Ctrl-G\": \"findPrev\",\n          \"Shift-Ctrl-F\": \"replace\",\n          \"Shift-Ctrl-R\": \"replaceAll\",\n          \"Ctrl-[\": \"indentLess\",\n          \"Ctrl-]\": \"indentMore\",\n          \"Ctrl-U\": \"undoSelection\",\n          \"Shift-Ctrl-U\": \"redoSelection\",\n          \"Alt-U\": \"redoSelection\",\n          fallthrough: \"basic\"\n        }; // Very basic readline/emacs-style bindings, which are standard on Mac.\n\n        keyMap.emacsy = {\n          \"Ctrl-F\": \"goCharRight\",\n          \"Ctrl-B\": \"goCharLeft\",\n          \"Ctrl-P\": \"goLineUp\",\n          \"Ctrl-N\": \"goLineDown\",\n          \"Alt-F\": \"goWordRight\",\n          \"Alt-B\": \"goWordLeft\",\n          \"Ctrl-A\": \"goLineStart\",\n          \"Ctrl-E\": \"goLineEnd\",\n          \"Ctrl-V\": \"goPageDown\",\n          \"Shift-Ctrl-V\": \"goPageUp\",\n          \"Ctrl-D\": \"delCharAfter\",\n          \"Ctrl-H\": \"delCharBefore\",\n          \"Alt-D\": \"delWordAfter\",\n          \"Alt-Backspace\": \"delWordBefore\",\n          \"Ctrl-K\": \"killLine\",\n          \"Ctrl-T\": \"transposeChars\",\n          \"Ctrl-O\": \"openLine\"\n        };\n        keyMap.macDefault = {\n          \"Cmd-A\": \"selectAll\",\n          \"Cmd-D\": \"deleteLine\",\n          \"Cmd-Z\": \"undo\",\n          \"Shift-Cmd-Z\": \"redo\",\n          \"Cmd-Y\": \"redo\",\n          \"Cmd-Home\": \"goDocStart\",\n          \"Cmd-Up\": \"goDocStart\",\n          \"Cmd-End\": \"goDocEnd\",\n          \"Cmd-Down\": \"goDocEnd\",\n          \"Alt-Left\": \"goGroupLeft\",\n          \"Alt-Right\": \"goGroupRight\",\n          \"Cmd-Left\": \"goLineLeft\",\n          \"Cmd-Right\": \"goLineRight\",\n          \"Alt-Backspace\": \"delGroupBefore\",\n          \"Ctrl-Alt-Backspace\": \"delGroupAfter\",\n          \"Alt-Delete\": \"delGroupAfter\",\n          \"Cmd-S\": \"save\",\n          \"Cmd-F\": \"find\",\n          \"Cmd-G\": \"findNext\",\n          \"Shift-Cmd-G\": \"findPrev\",\n          \"Cmd-Alt-F\": \"replace\",\n          \"Shift-Cmd-Alt-F\": \"replaceAll\",\n          \"Cmd-[\": \"indentLess\",\n          \"Cmd-]\": \"indentMore\",\n          \"Cmd-Backspace\": \"delWrappedLineLeft\",\n          \"Cmd-Delete\": \"delWrappedLineRight\",\n          \"Cmd-U\": \"undoSelection\",\n          \"Shift-Cmd-U\": \"redoSelection\",\n          \"Ctrl-Up\": \"goDocStart\",\n          \"Ctrl-Down\": \"goDocEnd\",\n          fallthrough: [\"basic\", \"emacsy\"]\n        };\n        keyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault; // KEYMAP DISPATCH\n\n        function normalizeKeyName(name) {\n          var parts = name.split(/-(?!$)/);\n          name = parts[parts.length - 1];\n          var alt, ctrl, shift, cmd;\n\n          for (var i = 0; i < parts.length - 1; i++) {\n            var mod = parts[i];\n\n            if (/^(cmd|meta|m)$/i.test(mod)) {\n              cmd = true;\n            } else if (/^a(lt)?$/i.test(mod)) {\n              alt = true;\n            } else if (/^(c|ctrl|control)$/i.test(mod)) {\n              ctrl = true;\n            } else if (/^s(hift)?$/i.test(mod)) {\n              shift = true;\n            } else {\n              throw new Error(\"Unrecognized modifier name: \" + mod);\n            }\n          }\n\n          if (alt) {\n            name = \"Alt-\" + name;\n          }\n\n          if (ctrl) {\n            name = \"Ctrl-\" + name;\n          }\n\n          if (cmd) {\n            name = \"Cmd-\" + name;\n          }\n\n          if (shift) {\n            name = \"Shift-\" + name;\n          }\n\n          return name;\n        } // This is a kludge to keep keymaps mostly working as raw objects\n        // (backwards compatibility) while at the same time support features\n        // like normalization and multi-stroke key bindings. It compiles a\n        // new normalized keymap, and then updates the old object to reflect\n        // this.\n\n\n        function normalizeKeyMap(keymap) {\n          var copy = {};\n\n          for (var keyname in keymap) {\n            if (keymap.hasOwnProperty(keyname)) {\n              var value = keymap[keyname];\n\n              if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) {\n                continue;\n              }\n\n              if (value == \"...\") {\n                delete keymap[keyname];\n                continue;\n              }\n\n              var keys = map(keyname.split(\" \"), normalizeKeyName);\n\n              for (var i = 0; i < keys.length; i++) {\n                var val = void 0,\n                    name = void 0;\n\n                if (i == keys.length - 1) {\n                  name = keys.join(\" \");\n                  val = value;\n                } else {\n                  name = keys.slice(0, i + 1).join(\" \");\n                  val = \"...\";\n                }\n\n                var prev = copy[name];\n\n                if (!prev) {\n                  copy[name] = val;\n                } else if (prev != val) {\n                  throw new Error(\"Inconsistent bindings for \" + name);\n                }\n              }\n\n              delete keymap[keyname];\n            }\n          }\n\n          for (var prop in copy) {\n            keymap[prop] = copy[prop];\n          }\n\n          return keymap;\n        }\n\n        function lookupKey(key, map$$1, handle, context) {\n          map$$1 = getKeyMap(map$$1);\n          var found = map$$1.call ? map$$1.call(key, context) : map$$1[key];\n\n          if (found === false) {\n            return \"nothing\";\n          }\n\n          if (found === \"...\") {\n            return \"multi\";\n          }\n\n          if (found != null && handle(found)) {\n            return \"handled\";\n          }\n\n          if (map$$1.fallthrough) {\n            if (Object.prototype.toString.call(map$$1.fallthrough) != \"[object Array]\") {\n              return lookupKey(key, map$$1.fallthrough, handle, context);\n            }\n\n            for (var i = 0; i < map$$1.fallthrough.length; i++) {\n              var result = lookupKey(key, map$$1.fallthrough[i], handle, context);\n\n              if (result) {\n                return result;\n              }\n            }\n          }\n        } // Modifier key presses don't count as 'real' key presses for the\n        // purpose of keymap fallthrough.\n\n\n        function isModifierKey(value) {\n          var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n          return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\";\n        } // Look up the name of a key as indicated by an event object.\n\n\n        function keyName(event, noShift) {\n          if (presto && event.keyCode == 34 && event[\"char\"]) {\n            return false;\n          }\n\n          var base = keyNames[event.keyCode],\n              name = base;\n\n          if (name == null || event.altGraphKey) {\n            return false;\n          }\n\n          if (event.altKey && base != \"Alt\") {\n            name = \"Alt-\" + name;\n          }\n\n          if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") {\n            name = \"Ctrl-\" + name;\n          }\n\n          if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Cmd\") {\n            name = \"Cmd-\" + name;\n          }\n\n          if (!noShift && event.shiftKey && base != \"Shift\") {\n            name = \"Shift-\" + name;\n          }\n\n          return name;\n        }\n\n        function getKeyMap(val) {\n          return typeof val == \"string\" ? keyMap[val] : val;\n        } // Helper for deleting text near the selection(s), used to implement\n        // backspace, delete, and similar functionality.\n\n\n        function deleteNearSelection(cm, compute) {\n          var ranges = cm.doc.sel.ranges,\n              kill = []; // Build up a set of ranges to kill first, merging overlapping\n          // ranges.\n\n          for (var i = 0; i < ranges.length; i++) {\n            var toKill = compute(ranges[i]);\n\n            while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n              var replaced = kill.pop();\n\n              if (cmp(replaced.from, toKill.from) < 0) {\n                toKill.from = replaced.from;\n                break;\n              }\n            }\n\n            kill.push(toKill);\n          } // Next, remove those actual ranges.\n\n\n          runInOp(cm, function () {\n            for (var i = kill.length - 1; i >= 0; i--) {\n              replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\");\n            }\n\n            ensureCursorVisible(cm);\n          });\n        } // Commands are parameter-less actions that can be performed on an\n        // editor, mostly used for keybindings.\n\n\n        var commands = {\n          selectAll: selectAll,\n          singleSelection: function (cm) {\n            return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll);\n          },\n          killLine: function (cm) {\n            return deleteNearSelection(cm, function (range) {\n              if (range.empty()) {\n                var len = getLine(cm.doc, range.head.line).text.length;\n\n                if (range.head.ch == len && range.head.line < cm.lastLine()) {\n                  return {\n                    from: range.head,\n                    to: Pos(range.head.line + 1, 0)\n                  };\n                } else {\n                  return {\n                    from: range.head,\n                    to: Pos(range.head.line, len)\n                  };\n                }\n              } else {\n                return {\n                  from: range.from(),\n                  to: range.to()\n                };\n              }\n            });\n          },\n          deleteLine: function (cm) {\n            return deleteNearSelection(cm, function (range) {\n              return {\n                from: Pos(range.from().line, 0),\n                to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\n              };\n            });\n          },\n          delLineLeft: function (cm) {\n            return deleteNearSelection(cm, function (range) {\n              return {\n                from: Pos(range.from().line, 0),\n                to: range.from()\n              };\n            });\n          },\n          delWrappedLineLeft: function (cm) {\n            return deleteNearSelection(cm, function (range) {\n              var top = cm.charCoords(range.head, \"div\").top + 5;\n              var leftPos = cm.coordsChar({\n                left: 0,\n                top: top\n              }, \"div\");\n              return {\n                from: leftPos,\n                to: range.from()\n              };\n            });\n          },\n          delWrappedLineRight: function (cm) {\n            return deleteNearSelection(cm, function (range) {\n              var top = cm.charCoords(range.head, \"div\").top + 5;\n              var rightPos = cm.coordsChar({\n                left: cm.display.lineDiv.offsetWidth + 100,\n                top: top\n              }, \"div\");\n              return {\n                from: range.from(),\n                to: rightPos\n              };\n            });\n          },\n          undo: function (cm) {\n            return cm.undo();\n          },\n          redo: function (cm) {\n            return cm.redo();\n          },\n          undoSelection: function (cm) {\n            return cm.undoSelection();\n          },\n          redoSelection: function (cm) {\n            return cm.redoSelection();\n          },\n          goDocStart: function (cm) {\n            return cm.extendSelection(Pos(cm.firstLine(), 0));\n          },\n          goDocEnd: function (cm) {\n            return cm.extendSelection(Pos(cm.lastLine()));\n          },\n          goLineStart: function (cm) {\n            return cm.extendSelectionsBy(function (range) {\n              return lineStart(cm, range.head.line);\n            }, {\n              origin: \"+move\",\n              bias: 1\n            });\n          },\n          goLineStartSmart: function (cm) {\n            return cm.extendSelectionsBy(function (range) {\n              return lineStartSmart(cm, range.head);\n            }, {\n              origin: \"+move\",\n              bias: 1\n            });\n          },\n          goLineEnd: function (cm) {\n            return cm.extendSelectionsBy(function (range) {\n              return lineEnd(cm, range.head.line);\n            }, {\n              origin: \"+move\",\n              bias: -1\n            });\n          },\n          goLineRight: function (cm) {\n            return cm.extendSelectionsBy(function (range) {\n              var top = cm.charCoords(range.head, \"div\").top + 5;\n              return cm.coordsChar({\n                left: cm.display.lineDiv.offsetWidth + 100,\n                top: top\n              }, \"div\");\n            }, sel_move);\n          },\n          goLineLeft: function (cm) {\n            return cm.extendSelectionsBy(function (range) {\n              var top = cm.charCoords(range.head, \"div\").top + 5;\n              return cm.coordsChar({\n                left: 0,\n                top: top\n              }, \"div\");\n            }, sel_move);\n          },\n          goLineLeftSmart: function (cm) {\n            return cm.extendSelectionsBy(function (range) {\n              var top = cm.charCoords(range.head, \"div\").top + 5;\n              var pos = cm.coordsChar({\n                left: 0,\n                top: top\n              }, \"div\");\n\n              if (pos.ch < cm.getLine(pos.line).search(/\\S/)) {\n                return lineStartSmart(cm, range.head);\n              }\n\n              return pos;\n            }, sel_move);\n          },\n          goLineUp: function (cm) {\n            return cm.moveV(-1, \"line\");\n          },\n          goLineDown: function (cm) {\n            return cm.moveV(1, \"line\");\n          },\n          goPageUp: function (cm) {\n            return cm.moveV(-1, \"page\");\n          },\n          goPageDown: function (cm) {\n            return cm.moveV(1, \"page\");\n          },\n          goCharLeft: function (cm) {\n            return cm.moveH(-1, \"char\");\n          },\n          goCharRight: function (cm) {\n            return cm.moveH(1, \"char\");\n          },\n          goColumnLeft: function (cm) {\n            return cm.moveH(-1, \"column\");\n          },\n          goColumnRight: function (cm) {\n            return cm.moveH(1, \"column\");\n          },\n          goWordLeft: function (cm) {\n            return cm.moveH(-1, \"word\");\n          },\n          goGroupRight: function (cm) {\n            return cm.moveH(1, \"group\");\n          },\n          goGroupLeft: function (cm) {\n            return cm.moveH(-1, \"group\");\n          },\n          goWordRight: function (cm) {\n            return cm.moveH(1, \"word\");\n          },\n          delCharBefore: function (cm) {\n            return cm.deleteH(-1, \"char\");\n          },\n          delCharAfter: function (cm) {\n            return cm.deleteH(1, \"char\");\n          },\n          delWordBefore: function (cm) {\n            return cm.deleteH(-1, \"word\");\n          },\n          delWordAfter: function (cm) {\n            return cm.deleteH(1, \"word\");\n          },\n          delGroupBefore: function (cm) {\n            return cm.deleteH(-1, \"group\");\n          },\n          delGroupAfter: function (cm) {\n            return cm.deleteH(1, \"group\");\n          },\n          indentAuto: function (cm) {\n            return cm.indentSelection(\"smart\");\n          },\n          indentMore: function (cm) {\n            return cm.indentSelection(\"add\");\n          },\n          indentLess: function (cm) {\n            return cm.indentSelection(\"subtract\");\n          },\n          insertTab: function (cm) {\n            return cm.replaceSelection(\"\\t\");\n          },\n          insertSoftTab: function (cm) {\n            var spaces = [],\n                ranges = cm.listSelections(),\n                tabSize = cm.options.tabSize;\n\n            for (var i = 0; i < ranges.length; i++) {\n              var pos = ranges[i].from();\n              var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n              spaces.push(spaceStr(tabSize - col % tabSize));\n            }\n\n            cm.replaceSelections(spaces);\n          },\n          defaultTab: function (cm) {\n            if (cm.somethingSelected()) {\n              cm.indentSelection(\"add\");\n            } else {\n              cm.execCommand(\"insertTab\");\n            }\n          },\n          // Swap the two chars left and right of each selection's head.\n          // Move cursor behind the two swapped characters afterwards.\n          //\n          // Doesn't consider line feeds a character.\n          // Doesn't scan more than one line above to find a character.\n          // Doesn't do anything on an empty line.\n          // Doesn't do anything with non-empty selections.\n          transposeChars: function (cm) {\n            return runInOp(cm, function () {\n              var ranges = cm.listSelections(),\n                  newSel = [];\n\n              for (var i = 0; i < ranges.length; i++) {\n                if (!ranges[i].empty()) {\n                  continue;\n                }\n\n                var cur = ranges[i].head,\n                    line = getLine(cm.doc, cur.line).text;\n\n                if (line) {\n                  if (cur.ch == line.length) {\n                    cur = new Pos(cur.line, cur.ch - 1);\n                  }\n\n                  if (cur.ch > 0) {\n                    cur = new Pos(cur.line, cur.ch + 1);\n                    cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2), Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n                  } else if (cur.line > cm.doc.first) {\n                    var prev = getLine(cm.doc, cur.line - 1).text;\n\n                    if (prev) {\n                      cur = new Pos(cur.line, 1);\n                      cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() + prev.charAt(prev.length - 1), Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n                    }\n                  }\n                }\n\n                newSel.push(new Range(cur, cur));\n              }\n\n              cm.setSelections(newSel);\n            });\n          },\n          newlineAndIndent: function (cm) {\n            return runInOp(cm, function () {\n              var sels = cm.listSelections();\n\n              for (var i = sels.length - 1; i >= 0; i--) {\n                cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\");\n              }\n\n              sels = cm.listSelections();\n\n              for (var i$1 = 0; i$1 < sels.length; i$1++) {\n                cm.indentLine(sels[i$1].from().line, null, true);\n              }\n\n              ensureCursorVisible(cm);\n            });\n          },\n          openLine: function (cm) {\n            return cm.replaceSelection(\"\\n\", \"start\");\n          },\n          toggleOverwrite: function (cm) {\n            return cm.toggleOverwrite();\n          }\n        };\n\n        function lineStart(cm, lineN) {\n          var line = getLine(cm.doc, lineN);\n          var visual = visualLine(line);\n\n          if (visual != line) {\n            lineN = lineNo(visual);\n          }\n\n          return endOfLine(true, cm, visual, lineN, 1);\n        }\n\n        function lineEnd(cm, lineN) {\n          var line = getLine(cm.doc, lineN);\n          var visual = visualLineEnd(line);\n\n          if (visual != line) {\n            lineN = lineNo(visual);\n          }\n\n          return endOfLine(true, cm, line, lineN, -1);\n        }\n\n        function lineStartSmart(cm, pos) {\n          var start = lineStart(cm, pos.line);\n          var line = getLine(cm.doc, start.line);\n          var order = getOrder(line, cm.doc.direction);\n\n          if (!order || order[0].level == 0) {\n            var firstNonWS = Math.max(0, line.text.search(/\\S/));\n            var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n            return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky);\n          }\n\n          return start;\n        } // Run a handler that was bound to a key.\n\n\n        function doHandleBinding(cm, bound, dropShift) {\n          if (typeof bound == \"string\") {\n            bound = commands[bound];\n\n            if (!bound) {\n              return false;\n            }\n          } // Ensure previous input has been read, so that the handler sees a\n          // consistent view of the document\n\n\n          cm.display.input.ensurePolled();\n          var prevShift = cm.display.shift,\n              done = false;\n\n          try {\n            if (cm.isReadOnly()) {\n              cm.state.suppressEdits = true;\n            }\n\n            if (dropShift) {\n              cm.display.shift = false;\n            }\n\n            done = bound(cm) != Pass;\n          } finally {\n            cm.display.shift = prevShift;\n            cm.state.suppressEdits = false;\n          }\n\n          return done;\n        }\n\n        function lookupKeyForEditor(cm, name, handle) {\n          for (var i = 0; i < cm.state.keyMaps.length; i++) {\n            var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n\n            if (result) {\n              return result;\n            }\n          }\n\n          return cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm) || lookupKey(name, cm.options.keyMap, handle, cm);\n        }\n\n        var stopSeq = new Delayed();\n\n        function dispatchKey(cm, name, e, handle) {\n          var seq = cm.state.keySeq;\n\n          if (seq) {\n            if (isModifierKey(name)) {\n              return \"handled\";\n            }\n\n            stopSeq.set(50, function () {\n              if (cm.state.keySeq == seq) {\n                cm.state.keySeq = null;\n                cm.display.input.reset();\n              }\n            });\n            name = seq + \" \" + name;\n          }\n\n          var result = lookupKeyForEditor(cm, name, handle);\n\n          if (result == \"multi\") {\n            cm.state.keySeq = name;\n          }\n\n          if (result == \"handled\") {\n            signalLater(cm, \"keyHandled\", cm, name, e);\n          }\n\n          if (result == \"handled\" || result == \"multi\") {\n            e_preventDefault(e);\n            restartBlink(cm);\n          }\n\n          if (seq && !result && /\\'$/.test(name)) {\n            e_preventDefault(e);\n            return true;\n          }\n\n          return !!result;\n        } // Handle a key from the keydown event.\n\n\n        function handleKeyBinding(cm, e) {\n          var name = keyName(e, true);\n\n          if (!name) {\n            return false;\n          }\n\n          if (e.shiftKey && !cm.state.keySeq) {\n            // First try to resolve full name (including 'Shift-'). Failing\n            // that, see if there is a cursor-motion command (starting with\n            // 'go') bound to the keyname without 'Shift-'.\n            return dispatchKey(cm, \"Shift-\" + name, e, function (b) {\n              return doHandleBinding(cm, b, true);\n            }) || dispatchKey(cm, name, e, function (b) {\n              if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion) {\n                return doHandleBinding(cm, b);\n              }\n            });\n          } else {\n            return dispatchKey(cm, name, e, function (b) {\n              return doHandleBinding(cm, b);\n            });\n          }\n        } // Handle a key from the keypress event\n\n\n        function handleCharBinding(cm, e, ch) {\n          return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) {\n            return doHandleBinding(cm, b, true);\n          });\n        }\n\n        var lastStoppedKey = null;\n\n        function onKeyDown(e) {\n          var cm = this;\n          cm.curOp.focus = activeElt();\n\n          if (signalDOMEvent(cm, e)) {\n            return;\n          } // IE does strange things with escape.\n\n\n          if (ie && ie_version < 11 && e.keyCode == 27) {\n            e.returnValue = false;\n          }\n\n          var code = e.keyCode;\n          cm.display.shift = code == 16 || e.shiftKey;\n          var handled = handleKeyBinding(cm, e);\n\n          if (presto) {\n            lastStoppedKey = handled ? code : null; // Opera has no cut event... we try to at least catch the key combo\n\n            if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey)) {\n              cm.replaceSelection(\"\", null, \"cut\");\n            }\n          } // Turn mouse into crosshair when Alt is held on Mac.\n\n\n          if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className)) {\n            showCrossHair(cm);\n          }\n        }\n\n        function showCrossHair(cm) {\n          var lineDiv = cm.display.lineDiv;\n          addClass(lineDiv, \"CodeMirror-crosshair\");\n\n          function up(e) {\n            if (e.keyCode == 18 || !e.altKey) {\n              rmClass(lineDiv, \"CodeMirror-crosshair\");\n              off(document, \"keyup\", up);\n              off(document, \"mouseover\", up);\n            }\n          }\n\n          on(document, \"keyup\", up);\n          on(document, \"mouseover\", up);\n        }\n\n        function onKeyUp(e) {\n          if (e.keyCode == 16) {\n            this.doc.sel.shift = false;\n          }\n\n          signalDOMEvent(this, e);\n        }\n\n        function onKeyPress(e) {\n          var cm = this;\n\n          if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) {\n            return;\n          }\n\n          var keyCode = e.keyCode,\n              charCode = e.charCode;\n\n          if (presto && keyCode == lastStoppedKey) {\n            lastStoppedKey = null;\n            e_preventDefault(e);\n            return;\n          }\n\n          if (presto && (!e.which || e.which < 10) && handleKeyBinding(cm, e)) {\n            return;\n          }\n\n          var ch = String.fromCharCode(charCode == null ? keyCode : charCode); // Some browsers fire keypress events for backspace\n\n          if (ch == \"\\x08\") {\n            return;\n          }\n\n          if (handleCharBinding(cm, e, ch)) {\n            return;\n          }\n\n          cm.display.input.onKeyPress(e);\n        } // A mouse down can be a single click, double click, triple click,\n        // start of selection drag, start of text drag, new cursor\n        // (ctrl-click), rectangle drag (alt-drag), or xwin\n        // middle-click-paste. Or it might be a click on something we should\n        // not interfere with, such as a scrollbar or widget.\n\n\n        function onMouseDown(e) {\n          var cm = this,\n              display = cm.display;\n\n          if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) {\n            return;\n          }\n\n          display.input.ensurePolled();\n          display.shift = e.shiftKey;\n\n          if (eventInWidget(display, e)) {\n            if (!webkit) {\n              // Briefly turn off draggability, to allow widgets to do\n              // normal dragging things.\n              display.scroller.draggable = false;\n              setTimeout(function () {\n                return display.scroller.draggable = true;\n              }, 100);\n            }\n\n            return;\n          }\n\n          if (clickInGutter(cm, e)) {\n            return;\n          }\n\n          var start = posFromMouse(cm, e);\n          window.focus();\n\n          switch (e_button(e)) {\n            case 1:\n              // #3261: make sure, that we're not starting a second selection\n              if (cm.state.selectingText) {\n                cm.state.selectingText(e);\n              } else if (start) {\n                leftButtonDown(cm, e, start);\n              } else if (e_target(e) == display.scroller) {\n                e_preventDefault(e);\n              }\n\n              break;\n\n            case 2:\n              if (webkit) {\n                cm.state.lastMiddleDown = +new Date();\n              }\n\n              if (start) {\n                extendSelection(cm.doc, start);\n              }\n\n              setTimeout(function () {\n                return display.input.focus();\n              }, 20);\n              e_preventDefault(e);\n              break;\n\n            case 3:\n              if (captureRightClick) {\n                onContextMenu(cm, e);\n              } else {\n                delayBlurEvent(cm);\n              }\n\n              break;\n          }\n        }\n\n        var lastClick;\n        var lastDoubleClick;\n\n        function leftButtonDown(cm, e, start) {\n          if (ie) {\n            setTimeout(bind(ensureFocus, cm), 0);\n          } else {\n            cm.curOp.focus = activeElt();\n          }\n\n          var now = +new Date(),\n              type;\n\n          if (lastDoubleClick && lastDoubleClick.time > now - 400 && cmp(lastDoubleClick.pos, start) == 0) {\n            type = \"triple\";\n          } else if (lastClick && lastClick.time > now - 400 && cmp(lastClick.pos, start) == 0) {\n            type = \"double\";\n            lastDoubleClick = {\n              time: now,\n              pos: start\n            };\n          } else {\n            type = \"single\";\n            lastClick = {\n              time: now,\n              pos: start\n            };\n          }\n\n          var sel = cm.doc.sel,\n              modifier = mac ? e.metaKey : e.ctrlKey,\n              contained;\n\n          if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() && type == \"single\" && (contained = sel.contains(start)) > -1 && (cmp((contained = sel.ranges[contained]).from(), start) < 0 || start.xRel > 0) && (cmp(contained.to(), start) > 0 || start.xRel < 0)) {\n            leftButtonStartDrag(cm, e, start, modifier);\n          } else {\n            leftButtonSelect(cm, e, start, type, modifier);\n          }\n        } // Start a text drag. When it ends, see if any dragging actually\n        // happen, and treat as a click if it didn't.\n\n\n        function leftButtonStartDrag(cm, e, start, modifier) {\n          var display = cm.display,\n              moved = false;\n          var dragEnd = operation(cm, function (e) {\n            if (webkit) {\n              display.scroller.draggable = false;\n            }\n\n            cm.state.draggingText = false;\n            off(document, \"mouseup\", dragEnd);\n            off(document, \"mousemove\", mouseMove);\n            off(display.scroller, \"dragstart\", dragStart);\n            off(display.scroller, \"drop\", dragEnd);\n\n            if (!moved) {\n              e_preventDefault(e);\n\n              if (!modifier) {\n                extendSelection(cm.doc, start);\n              } // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n\n\n              if (webkit || ie && ie_version == 9) {\n                setTimeout(function () {\n                  document.body.focus();\n                  display.input.focus();\n                }, 20);\n              } else {\n                display.input.focus();\n              }\n            }\n          });\n\n          var mouseMove = function (e2) {\n            moved = moved || Math.abs(e.clientX - e2.clientX) + Math.abs(e.clientY - e2.clientY) >= 10;\n          };\n\n          var dragStart = function () {\n            return moved = true;\n          }; // Let the drag handler handle this.\n\n\n          if (webkit) {\n            display.scroller.draggable = true;\n          }\n\n          cm.state.draggingText = dragEnd;\n          dragEnd.copy = mac ? e.altKey : e.ctrlKey; // IE's approach to draggable\n\n          if (display.scroller.dragDrop) {\n            display.scroller.dragDrop();\n          }\n\n          on(document, \"mouseup\", dragEnd);\n          on(document, \"mousemove\", mouseMove);\n          on(display.scroller, \"dragstart\", dragStart);\n          on(display.scroller, \"drop\", dragEnd);\n          delayBlurEvent(cm);\n          setTimeout(function () {\n            return display.input.focus();\n          }, 20);\n        } // Normal selection, as opposed to text dragging.\n\n\n        function leftButtonSelect(cm, e, start, type, addNew) {\n          var display = cm.display,\n              doc = cm.doc;\n          e_preventDefault(e);\n          var ourRange,\n              ourIndex,\n              startSel = doc.sel,\n              ranges = startSel.ranges;\n\n          if (addNew && !e.shiftKey) {\n            ourIndex = doc.sel.contains(start);\n\n            if (ourIndex > -1) {\n              ourRange = ranges[ourIndex];\n            } else {\n              ourRange = new Range(start, start);\n            }\n          } else {\n            ourRange = doc.sel.primary();\n            ourIndex = doc.sel.primIndex;\n          }\n\n          if (chromeOS ? e.shiftKey && e.metaKey : e.altKey) {\n            type = \"rect\";\n\n            if (!addNew) {\n              ourRange = new Range(start, start);\n            }\n\n            start = posFromMouse(cm, e, true, true);\n            ourIndex = -1;\n          } else if (type == \"double\") {\n            var word = cm.findWordAt(start);\n\n            if (cm.display.shift || doc.extend) {\n              ourRange = extendRange(doc, ourRange, word.anchor, word.head);\n            } else {\n              ourRange = word;\n            }\n          } else if (type == \"triple\") {\n            var line = new Range(Pos(start.line, 0), clipPos(doc, Pos(start.line + 1, 0)));\n\n            if (cm.display.shift || doc.extend) {\n              ourRange = extendRange(doc, ourRange, line.anchor, line.head);\n            } else {\n              ourRange = line;\n            }\n          } else {\n            ourRange = extendRange(doc, ourRange, start);\n          }\n\n          if (!addNew) {\n            ourIndex = 0;\n            setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n            startSel = doc.sel;\n          } else if (ourIndex == -1) {\n            ourIndex = ranges.length;\n            setSelection(doc, normalizeSelection(ranges.concat([ourRange]), ourIndex), {\n              scroll: false,\n              origin: \"*mouse\"\n            });\n          } else if (ranges.length > 1 && ranges[ourIndex].empty() && type == \"single\" && !e.shiftKey) {\n            setSelection(doc, normalizeSelection(ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0), {\n              scroll: false,\n              origin: \"*mouse\"\n            });\n            startSel = doc.sel;\n          } else {\n            replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n          }\n\n          var lastPos = start;\n\n          function extendTo(pos) {\n            if (cmp(lastPos, pos) == 0) {\n              return;\n            }\n\n            lastPos = pos;\n\n            if (type == \"rect\") {\n              var ranges = [],\n                  tabSize = cm.options.tabSize;\n              var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n              var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n              var left = Math.min(startCol, posCol),\n                  right = Math.max(startCol, posCol);\n\n              for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line)); line <= end; line++) {\n                var text = getLine(doc, line).text,\n                    leftPos = findColumn(text, left, tabSize);\n\n                if (left == right) {\n                  ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos)));\n                } else if (text.length > leftPos) {\n                  ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize))));\n                }\n              }\n\n              if (!ranges.length) {\n                ranges.push(new Range(start, start));\n              }\n\n              setSelection(doc, normalizeSelection(startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex), {\n                origin: \"*mouse\",\n                scroll: false\n              });\n              cm.scrollIntoView(pos);\n            } else {\n              var oldRange = ourRange;\n              var anchor = oldRange.anchor,\n                  head = pos;\n\n              if (type != \"single\") {\n                var range$$1;\n\n                if (type == \"double\") {\n                  range$$1 = cm.findWordAt(pos);\n                } else {\n                  range$$1 = new Range(Pos(pos.line, 0), clipPos(doc, Pos(pos.line + 1, 0)));\n                }\n\n                if (cmp(range$$1.anchor, anchor) > 0) {\n                  head = range$$1.head;\n                  anchor = minPos(oldRange.from(), range$$1.anchor);\n                } else {\n                  head = range$$1.anchor;\n                  anchor = maxPos(oldRange.to(), range$$1.head);\n                }\n              }\n\n              var ranges$1 = startSel.ranges.slice(0);\n              ranges$1[ourIndex] = new Range(clipPos(doc, anchor), head);\n              setSelection(doc, normalizeSelection(ranges$1, ourIndex), sel_mouse);\n            }\n          }\n\n          var editorSize = display.wrapper.getBoundingClientRect(); // Used to ensure timeout re-tries don't fire when another extend\n          // happened in the meantime (clearTimeout isn't reliable -- at\n          // least on Chrome, the timeouts still happen even when cleared,\n          // if the clear happens after their scheduled firing time).\n\n          var counter = 0;\n\n          function extend(e) {\n            var curCount = ++counter;\n            var cur = posFromMouse(cm, e, true, type == \"rect\");\n\n            if (!cur) {\n              return;\n            }\n\n            if (cmp(cur, lastPos) != 0) {\n              cm.curOp.focus = activeElt();\n              extendTo(cur);\n              var visible = visibleLines(display, doc);\n\n              if (cur.line >= visible.to || cur.line < visible.from) {\n                setTimeout(operation(cm, function () {\n                  if (counter == curCount) {\n                    extend(e);\n                  }\n                }), 150);\n              }\n            } else {\n              var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n\n              if (outside) {\n                setTimeout(operation(cm, function () {\n                  if (counter != curCount) {\n                    return;\n                  }\n\n                  display.scroller.scrollTop += outside;\n                  extend(e);\n                }), 50);\n              }\n            }\n          }\n\n          function done(e) {\n            cm.state.selectingText = false;\n            counter = Infinity;\n            e_preventDefault(e);\n            display.input.focus();\n            off(document, \"mousemove\", move);\n            off(document, \"mouseup\", up);\n            doc.history.lastSelOrigin = null;\n          }\n\n          var move = operation(cm, function (e) {\n            if (!e_button(e)) {\n              done(e);\n            } else {\n              extend(e);\n            }\n          });\n          var up = operation(cm, done);\n          cm.state.selectingText = up;\n          on(document, \"mousemove\", move);\n          on(document, \"mouseup\", up);\n        } // Determines whether an event happened in the gutter, and fires the\n        // handlers for the corresponding event.\n\n\n        function gutterEvent(cm, e, type, prevent) {\n          var mX, mY;\n\n          try {\n            mX = e.clientX;\n            mY = e.clientY;\n          } catch (e) {\n            return false;\n          }\n\n          if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) {\n            return false;\n          }\n\n          if (prevent) {\n            e_preventDefault(e);\n          }\n\n          var display = cm.display;\n          var lineBox = display.lineDiv.getBoundingClientRect();\n\n          if (mY > lineBox.bottom || !hasHandler(cm, type)) {\n            return e_defaultPrevented(e);\n          }\n\n          mY -= lineBox.top - display.viewOffset;\n\n          for (var i = 0; i < cm.options.gutters.length; ++i) {\n            var g = display.gutters.childNodes[i];\n\n            if (g && g.getBoundingClientRect().right >= mX) {\n              var line = lineAtHeight(cm.doc, mY);\n              var gutter = cm.options.gutters[i];\n              signal(cm, type, cm, line, gutter, e);\n              return e_defaultPrevented(e);\n            }\n          }\n        }\n\n        function clickInGutter(cm, e) {\n          return gutterEvent(cm, e, \"gutterClick\", true);\n        } // CONTEXT MENU HANDLING\n        // To make the context menu work, we need to briefly unhide the\n        // textarea (making it as unobtrusive as possible) to let the\n        // right-click take effect on it.\n\n\n        function onContextMenu(cm, e) {\n          if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) {\n            return;\n          }\n\n          if (signalDOMEvent(cm, e, \"contextmenu\")) {\n            return;\n          }\n\n          cm.display.input.onContextMenu(e);\n        }\n\n        function contextMenuInGutter(cm, e) {\n          if (!hasHandler(cm, \"gutterContextMenu\")) {\n            return false;\n          }\n\n          return gutterEvent(cm, e, \"gutterContextMenu\", false);\n        }\n\n        function themeChanged(cm) {\n          cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") + cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n          clearCaches(cm);\n        }\n\n        var Init = {\n          toString: function () {\n            return \"CodeMirror.Init\";\n          }\n        };\n        var defaults = {};\n        var optionHandlers = {};\n\n        function defineOptions(CodeMirror) {\n          var optionHandlers = CodeMirror.optionHandlers;\n\n          function option(name, deflt, handle, notOnInit) {\n            CodeMirror.defaults[name] = deflt;\n\n            if (handle) {\n              optionHandlers[name] = notOnInit ? function (cm, val, old) {\n                if (old != Init) {\n                  handle(cm, val, old);\n                }\n              } : handle;\n            }\n          }\n\n          CodeMirror.defineOption = option; // Passed to option handlers when there is no old value.\n\n          CodeMirror.Init = Init; // These two are, on init, called from the constructor because they\n          // have to be initialized before the editor can start at all.\n\n          option(\"value\", \"\", function (cm, val) {\n            return cm.setValue(val);\n          }, true);\n          option(\"mode\", null, function (cm, val) {\n            cm.doc.modeOption = val;\n            loadMode(cm);\n          }, true);\n          option(\"indentUnit\", 2, loadMode, true);\n          option(\"indentWithTabs\", false);\n          option(\"smartIndent\", true);\n          option(\"tabSize\", 4, function (cm) {\n            resetModeState(cm);\n            clearCaches(cm);\n            regChange(cm);\n          }, true);\n          option(\"lineSeparator\", null, function (cm, val) {\n            cm.doc.lineSep = val;\n\n            if (!val) {\n              return;\n            }\n\n            var newBreaks = [],\n                lineNo = cm.doc.first;\n            cm.doc.iter(function (line) {\n              for (var pos = 0;;) {\n                var found = line.text.indexOf(val, pos);\n\n                if (found == -1) {\n                  break;\n                }\n\n                pos = found + val.length;\n                newBreaks.push(Pos(lineNo, found));\n              }\n\n              lineNo++;\n            });\n\n            for (var i = newBreaks.length - 1; i >= 0; i--) {\n              replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length));\n            }\n          });\n          option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200f\\u2028\\u2029\\ufeff]/g, function (cm, val, old) {\n            cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n\n            if (old != Init) {\n              cm.refresh();\n            }\n          });\n          option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) {\n            return cm.refresh();\n          }, true);\n          option(\"electricChars\", true);\n          option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n            throw new Error(\"inputStyle can not (yet) be changed in a running editor\"); // FIXME\n          }, true);\n          option(\"spellcheck\", false, function (cm, val) {\n            return cm.getInputField().spellcheck = val;\n          }, true);\n          option(\"rtlMoveVisually\", !windows);\n          option(\"wholeLineUpdateBefore\", true);\n          option(\"theme\", \"default\", function (cm) {\n            themeChanged(cm);\n            guttersChanged(cm);\n          }, true);\n          option(\"keyMap\", \"default\", function (cm, val, old) {\n            var next = getKeyMap(val);\n            var prev = old != Init && getKeyMap(old);\n\n            if (prev && prev.detach) {\n              prev.detach(cm, next);\n            }\n\n            if (next.attach) {\n              next.attach(cm, prev || null);\n            }\n          });\n          option(\"extraKeys\", null);\n          option(\"lineWrapping\", false, wrappingChanged, true);\n          option(\"gutters\", [], function (cm) {\n            setGuttersForLineNumbers(cm.options);\n            guttersChanged(cm);\n          }, true);\n          option(\"fixedGutter\", true, function (cm, val) {\n            cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n            cm.refresh();\n          }, true);\n          option(\"coverGutterNextToScrollbar\", false, function (cm) {\n            return updateScrollbars(cm);\n          }, true);\n          option(\"scrollbarStyle\", \"native\", function (cm) {\n            initScrollbars(cm);\n            updateScrollbars(cm);\n            cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n            cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n          }, true);\n          option(\"lineNumbers\", false, function (cm) {\n            setGuttersForLineNumbers(cm.options);\n            guttersChanged(cm);\n          }, true);\n          option(\"firstLineNumber\", 1, guttersChanged, true);\n          option(\"lineNumberFormatter\", function (integer) {\n            return integer;\n          }, guttersChanged, true);\n          option(\"showCursorWhenSelecting\", false, updateSelection, true);\n          option(\"resetSelectionOnContextMenu\", true);\n          option(\"lineWiseCopyCut\", true);\n          option(\"readOnly\", false, function (cm, val) {\n            if (val == \"nocursor\") {\n              onBlur(cm);\n              cm.display.input.blur();\n              cm.display.disabled = true;\n            } else {\n              cm.display.disabled = false;\n            }\n\n            cm.display.input.readOnlyChanged(val);\n          });\n          option(\"disableInput\", false, function (cm, val) {\n            if (!val) {\n              cm.display.input.reset();\n            }\n          }, true);\n          option(\"dragDrop\", true, dragDropChanged);\n          option(\"allowDropFileTypes\", null);\n          option(\"cursorBlinkRate\", 530);\n          option(\"cursorScrollMargin\", 0);\n          option(\"cursorHeight\", 1, updateSelection, true);\n          option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n          option(\"workTime\", 100);\n          option(\"workDelay\", 100);\n          option(\"flattenSpans\", true, resetModeState, true);\n          option(\"addModeClass\", false, resetModeState, true);\n          option(\"pollInterval\", 100);\n          option(\"undoDepth\", 200, function (cm, val) {\n            return cm.doc.history.undoDepth = val;\n          });\n          option(\"historyEventDelay\", 1250);\n          option(\"viewportMargin\", 10, function (cm) {\n            return cm.refresh();\n          }, true);\n          option(\"maxHighlightLength\", 10000, resetModeState, true);\n          option(\"moveInputWithCursor\", true, function (cm, val) {\n            if (!val) {\n              cm.display.input.resetPosition();\n            }\n          });\n          option(\"tabindex\", null, function (cm, val) {\n            return cm.display.input.getField().tabIndex = val || \"\";\n          });\n          option(\"autofocus\", null);\n          option(\"direction\", \"ltr\", function (cm, val) {\n            return cm.doc.setDirection(val);\n          }, true);\n        }\n\n        function guttersChanged(cm) {\n          updateGutters(cm);\n          regChange(cm);\n          alignHorizontally(cm);\n        }\n\n        function dragDropChanged(cm, value, old) {\n          var wasOn = old && old != Init;\n\n          if (!value != !wasOn) {\n            var funcs = cm.display.dragFunctions;\n            var toggle = value ? on : off;\n            toggle(cm.display.scroller, \"dragstart\", funcs.start);\n            toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n            toggle(cm.display.scroller, \"dragover\", funcs.over);\n            toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n            toggle(cm.display.scroller, \"drop\", funcs.drop);\n          }\n        }\n\n        function wrappingChanged(cm) {\n          if (cm.options.lineWrapping) {\n            addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n            cm.display.sizer.style.minWidth = \"\";\n            cm.display.sizerWidth = null;\n          } else {\n            rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n            findMaxLine(cm);\n          }\n\n          estimateLineHeights(cm);\n          regChange(cm);\n          clearCaches(cm);\n          setTimeout(function () {\n            return updateScrollbars(cm);\n          }, 100);\n        } // A CodeMirror instance represents an editor. This is the object\n        // that user code is usually dealing with.\n\n\n        function CodeMirror$1(place, options) {\n          var this$1 = this;\n\n          if (!(this instanceof CodeMirror$1)) {\n            return new CodeMirror$1(place, options);\n          }\n\n          this.options = options = options ? copyObj(options) : {}; // Determine effective options based on given values and defaults.\n\n          copyObj(defaults, options, false);\n          setGuttersForLineNumbers(options);\n          var doc = options.value;\n\n          if (typeof doc == \"string\") {\n            doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction);\n          }\n\n          this.doc = doc;\n          var input = new CodeMirror$1.inputStyles[options.inputStyle](this);\n          var display = this.display = new Display(place, doc, input);\n          display.wrapper.CodeMirror = this;\n          updateGutters(this);\n          themeChanged(this);\n\n          if (options.lineWrapping) {\n            this.display.wrapper.className += \" CodeMirror-wrap\";\n          }\n\n          initScrollbars(this);\n          this.state = {\n            keyMaps: [],\n            // stores maps added by addKeyMap\n            overlays: [],\n            // highlighting overlays, as added by addOverlay\n            modeGen: 0,\n            // bumped when mode/overlay changes, used to invalidate highlighting info\n            overwrite: false,\n            delayingBlurEvent: false,\n            focused: false,\n            suppressEdits: false,\n            // used to disable editing during key handlers when in readOnly mode\n            pasteIncoming: false,\n            cutIncoming: false,\n            // help recognize paste/cut edits in input.poll\n            selectingText: false,\n            draggingText: false,\n            highlight: new Delayed(),\n            // stores highlight worker timeout\n            keySeq: null,\n            // Unfinished key sequence\n            specialChars: null\n          };\n\n          if (options.autofocus && !mobile) {\n            display.input.focus();\n          } // Override magic textarea content restore that IE sometimes does\n          // on our hidden textarea on reload\n\n\n          if (ie && ie_version < 11) {\n            setTimeout(function () {\n              return this$1.display.input.reset(true);\n            }, 20);\n          }\n\n          registerEventHandlers(this);\n          ensureGlobalHandlers();\n          startOperation(this);\n          this.curOp.forceUpdate = true;\n          attachDoc(this, doc);\n\n          if (options.autofocus && !mobile || this.hasFocus()) {\n            setTimeout(bind(onFocus, this), 20);\n          } else {\n            onBlur(this);\n          }\n\n          for (var opt in optionHandlers) {\n            if (optionHandlers.hasOwnProperty(opt)) {\n              optionHandlers[opt](this$1, options[opt], Init);\n            }\n          }\n\n          maybeUpdateLineNumberWidth(this);\n\n          if (options.finishInit) {\n            options.finishInit(this);\n          }\n\n          for (var i = 0; i < initHooks.length; ++i) {\n            initHooks[i](this$1);\n          }\n\n          endOperation(this); // Suppress optimizelegibility in Webkit, since it breaks text\n          // measuring on line wrapping boundaries.\n\n          if (webkit && options.lineWrapping && getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\") {\n            display.lineDiv.style.textRendering = \"auto\";\n          }\n        } // The default configuration options.\n\n\n        CodeMirror$1.defaults = defaults; // Functions to run when options are changed.\n\n        CodeMirror$1.optionHandlers = optionHandlers; // Attach the necessary event handlers when initializing the editor\n\n        function registerEventHandlers(cm) {\n          var d = cm.display;\n          on(d.scroller, \"mousedown\", operation(cm, onMouseDown)); // Older IE's will not fire a second mousedown for a double click\n\n          if (ie && ie_version < 11) {\n            on(d.scroller, \"dblclick\", operation(cm, function (e) {\n              if (signalDOMEvent(cm, e)) {\n                return;\n              }\n\n              var pos = posFromMouse(cm, e);\n\n              if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) {\n                return;\n              }\n\n              e_preventDefault(e);\n              var word = cm.findWordAt(pos);\n              extendSelection(cm.doc, word.anchor, word.head);\n            }));\n          } else {\n            on(d.scroller, \"dblclick\", function (e) {\n              return signalDOMEvent(cm, e) || e_preventDefault(e);\n            });\n          } // Some browsers fire contextmenu *after* opening the menu, at\n          // which point we can't mess with it anymore. Context menu is\n          // handled in onMouseDown for these browsers.\n\n\n          if (!captureRightClick) {\n            on(d.scroller, \"contextmenu\", function (e) {\n              return onContextMenu(cm, e);\n            });\n          } // Used to suppress mouse event handling when a touch happens\n\n\n          var touchFinished,\n              prevTouch = {\n            end: 0\n          };\n\n          function finishTouch() {\n            if (d.activeTouch) {\n              touchFinished = setTimeout(function () {\n                return d.activeTouch = null;\n              }, 1000);\n              prevTouch = d.activeTouch;\n              prevTouch.end = +new Date();\n            }\n          }\n\n          function isMouseLikeTouchEvent(e) {\n            if (e.touches.length != 1) {\n              return false;\n            }\n\n            var touch = e.touches[0];\n            return touch.radiusX <= 1 && touch.radiusY <= 1;\n          }\n\n          function farAway(touch, other) {\n            if (other.left == null) {\n              return true;\n            }\n\n            var dx = other.left - touch.left,\n                dy = other.top - touch.top;\n            return dx * dx + dy * dy > 20 * 20;\n          }\n\n          on(d.scroller, \"touchstart\", function (e) {\n            if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e)) {\n              d.input.ensurePolled();\n              clearTimeout(touchFinished);\n              var now = +new Date();\n              d.activeTouch = {\n                start: now,\n                moved: false,\n                prev: now - prevTouch.end <= 300 ? prevTouch : null\n              };\n\n              if (e.touches.length == 1) {\n                d.activeTouch.left = e.touches[0].pageX;\n                d.activeTouch.top = e.touches[0].pageY;\n              }\n            }\n          });\n          on(d.scroller, \"touchmove\", function () {\n            if (d.activeTouch) {\n              d.activeTouch.moved = true;\n            }\n          });\n          on(d.scroller, \"touchend\", function (e) {\n            var touch = d.activeTouch;\n\n            if (touch && !eventInWidget(d, e) && touch.left != null && !touch.moved && new Date() - touch.start < 300) {\n              var pos = cm.coordsChar(d.activeTouch, \"page\"),\n                  range;\n\n              if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n                {\n                  range = new Range(pos, pos);\n                } else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n                {\n                  range = cm.findWordAt(pos);\n                } else // Triple tap\n                {\n                  range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0)));\n                }\n\n              cm.setSelection(range.anchor, range.head);\n              cm.focus();\n              e_preventDefault(e);\n            }\n\n            finishTouch();\n          });\n          on(d.scroller, \"touchcancel\", finishTouch); // Sync scrolling between fake scrollbars and real scrollable\n          // area, ensure viewport is updated when scrolling.\n\n          on(d.scroller, \"scroll\", function () {\n            if (d.scroller.clientHeight) {\n              updateScrollTop(cm, d.scroller.scrollTop);\n              setScrollLeft(cm, d.scroller.scrollLeft, true);\n              signal(cm, \"scroll\", cm);\n            }\n          }); // Listen to wheel events in order to try and update the viewport on time.\n\n          on(d.scroller, \"mousewheel\", function (e) {\n            return onScrollWheel(cm, e);\n          });\n          on(d.scroller, \"DOMMouseScroll\", function (e) {\n            return onScrollWheel(cm, e);\n          }); // Prevent wrapper from ever scrolling\n\n          on(d.wrapper, \"scroll\", function () {\n            return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0;\n          });\n          d.dragFunctions = {\n            enter: function (e) {\n              if (!signalDOMEvent(cm, e)) {\n                e_stop(e);\n              }\n            },\n            over: function (e) {\n              if (!signalDOMEvent(cm, e)) {\n                onDragOver(cm, e);\n                e_stop(e);\n              }\n            },\n            start: function (e) {\n              return onDragStart(cm, e);\n            },\n            drop: operation(cm, onDrop),\n            leave: function (e) {\n              if (!signalDOMEvent(cm, e)) {\n                clearDragCursor(cm);\n              }\n            }\n          };\n          var inp = d.input.getField();\n          on(inp, \"keyup\", function (e) {\n            return onKeyUp.call(cm, e);\n          });\n          on(inp, \"keydown\", operation(cm, onKeyDown));\n          on(inp, \"keypress\", operation(cm, onKeyPress));\n          on(inp, \"focus\", function (e) {\n            return onFocus(cm, e);\n          });\n          on(inp, \"blur\", function (e) {\n            return onBlur(cm, e);\n          });\n        }\n\n        var initHooks = [];\n\n        CodeMirror$1.defineInitHook = function (f) {\n          return initHooks.push(f);\n        }; // Indent the given line. The how parameter can be \"smart\",\n        // \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n        // (typically set to true for forced single-line indents), empty\n        // lines are not indented, and places where the mode returns Pass\n        // are left alone.\n\n\n        function indentLine(cm, n, how, aggressive) {\n          var doc = cm.doc,\n              state;\n\n          if (how == null) {\n            how = \"add\";\n          }\n\n          if (how == \"smart\") {\n            // Fall back to \"prev\" when the mode doesn't have an indentation\n            // method.\n            if (!doc.mode.indent) {\n              how = \"prev\";\n            } else {\n              state = getStateBefore(cm, n);\n            }\n          }\n\n          var tabSize = cm.options.tabSize;\n          var line = getLine(doc, n),\n              curSpace = countColumn(line.text, null, tabSize);\n\n          if (line.stateAfter) {\n            line.stateAfter = null;\n          }\n\n          var curSpaceString = line.text.match(/^\\s*/)[0],\n              indentation;\n\n          if (!aggressive && !/\\S/.test(line.text)) {\n            indentation = 0;\n            how = \"not\";\n          } else if (how == \"smart\") {\n            indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n\n            if (indentation == Pass || indentation > 150) {\n              if (!aggressive) {\n                return;\n              }\n\n              how = \"prev\";\n            }\n          }\n\n          if (how == \"prev\") {\n            if (n > doc.first) {\n              indentation = countColumn(getLine(doc, n - 1).text, null, tabSize);\n            } else {\n              indentation = 0;\n            }\n          } else if (how == \"add\") {\n            indentation = curSpace + cm.options.indentUnit;\n          } else if (how == \"subtract\") {\n            indentation = curSpace - cm.options.indentUnit;\n          } else if (typeof how == \"number\") {\n            indentation = curSpace + how;\n          }\n\n          indentation = Math.max(0, indentation);\n          var indentString = \"\",\n              pos = 0;\n\n          if (cm.options.indentWithTabs) {\n            for (var i = Math.floor(indentation / tabSize); i; --i) {\n              pos += tabSize;\n              indentString += \"\\t\";\n            }\n          }\n\n          if (pos < indentation) {\n            indentString += spaceStr(indentation - pos);\n          }\n\n          if (indentString != curSpaceString) {\n            replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n            line.stateAfter = null;\n            return true;\n          } else {\n            // Ensure that, if the cursor was in the whitespace at the start\n            // of the line, it is moved to the end of that space.\n            for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n              var range = doc.sel.ranges[i$1];\n\n              if (range.head.line == n && range.head.ch < curSpaceString.length) {\n                var pos$1 = Pos(n, curSpaceString.length);\n                replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n                break;\n              }\n            }\n          }\n        } // This will be set to a {lineWise: bool, text: [string]} object, so\n        // that, when pasting, we know what kind of selections the copied\n        // text was made out of.\n\n\n        var lastCopied = null;\n\n        function setLastCopied(newLastCopied) {\n          lastCopied = newLastCopied;\n        }\n\n        function applyTextInput(cm, inserted, deleted, sel, origin) {\n          var doc = cm.doc;\n          cm.display.shift = false;\n\n          if (!sel) {\n            sel = doc.sel;\n          }\n\n          var paste = cm.state.pasteIncoming || origin == \"paste\";\n          var textLines = splitLinesAuto(inserted),\n              multiPaste = null; // When pasing N lines into N selections, insert one line per selection\n\n          if (paste && sel.ranges.length > 1) {\n            if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n              if (sel.ranges.length % lastCopied.text.length == 0) {\n                multiPaste = [];\n\n                for (var i = 0; i < lastCopied.text.length; i++) {\n                  multiPaste.push(doc.splitLines(lastCopied.text[i]));\n                }\n              }\n            } else if (textLines.length == sel.ranges.length) {\n              multiPaste = map(textLines, function (l) {\n                return [l];\n              });\n            }\n          }\n\n          var updateInput; // Normal behavior is to insert the new text into every selection\n\n          for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n            var range$$1 = sel.ranges[i$1];\n            var from = range$$1.from(),\n                to = range$$1.to();\n\n            if (range$$1.empty()) {\n              if (deleted && deleted > 0) // Handle deletion\n                {\n                  from = Pos(from.line, from.ch - deleted);\n                } else if (cm.state.overwrite && !paste) // Handle overwrite\n                {\n                  to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length));\n                } else if (lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == inserted) {\n                from = to = Pos(from.line, 0);\n              }\n            }\n\n            updateInput = cm.curOp.updateInput;\n            var changeEvent = {\n              from: from,\n              to: to,\n              text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n              origin: origin || (paste ? \"paste\" : cm.state.cutIncoming ? \"cut\" : \"+input\")\n            };\n            makeChange(cm.doc, changeEvent);\n            signalLater(cm, \"inputRead\", cm, changeEvent);\n          }\n\n          if (inserted && !paste) {\n            triggerElectric(cm, inserted);\n          }\n\n          ensureCursorVisible(cm);\n          cm.curOp.updateInput = updateInput;\n          cm.curOp.typing = true;\n          cm.state.pasteIncoming = cm.state.cutIncoming = false;\n        }\n\n        function handlePaste(e, cm) {\n          var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n\n          if (pasted) {\n            e.preventDefault();\n\n            if (!cm.isReadOnly() && !cm.options.disableInput) {\n              runInOp(cm, function () {\n                return applyTextInput(cm, pasted, 0, null, \"paste\");\n              });\n            }\n\n            return true;\n          }\n        }\n\n        function triggerElectric(cm, inserted) {\n          // When an 'electric' character is inserted, immediately trigger a reindent\n          if (!cm.options.electricChars || !cm.options.smartIndent) {\n            return;\n          }\n\n          var sel = cm.doc.sel;\n\n          for (var i = sel.ranges.length - 1; i >= 0; i--) {\n            var range$$1 = sel.ranges[i];\n\n            if (range$$1.head.ch > 100 || i && sel.ranges[i - 1].head.line == range$$1.head.line) {\n              continue;\n            }\n\n            var mode = cm.getModeAt(range$$1.head);\n            var indented = false;\n\n            if (mode.electricChars) {\n              for (var j = 0; j < mode.electricChars.length; j++) {\n                if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n                  indented = indentLine(cm, range$$1.head.line, \"smart\");\n                  break;\n                }\n              }\n            } else if (mode.electricInput) {\n              if (mode.electricInput.test(getLine(cm.doc, range$$1.head.line).text.slice(0, range$$1.head.ch))) {\n                indented = indentLine(cm, range$$1.head.line, \"smart\");\n              }\n            }\n\n            if (indented) {\n              signalLater(cm, \"electricInput\", cm, range$$1.head.line);\n            }\n          }\n        }\n\n        function copyableRanges(cm) {\n          var text = [],\n              ranges = [];\n\n          for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n            var line = cm.doc.sel.ranges[i].head.line;\n            var lineRange = {\n              anchor: Pos(line, 0),\n              head: Pos(line + 1, 0)\n            };\n            ranges.push(lineRange);\n            text.push(cm.getRange(lineRange.anchor, lineRange.head));\n          }\n\n          return {\n            text: text,\n            ranges: ranges\n          };\n        }\n\n        function disableBrowserMagic(field, spellcheck) {\n          field.setAttribute(\"autocorrect\", \"off\");\n          field.setAttribute(\"autocapitalize\", \"off\");\n          field.setAttribute(\"spellcheck\", !!spellcheck);\n        }\n\n        function hiddenTextarea() {\n          var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\");\n          var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\"); // The textarea is kept positioned near the cursor to prevent the\n          // fact that it'll be scrolled into view on input from scrolling\n          // our fake cursor out of view. On webkit, when wrap=off, paste is\n          // very slow. So make the area wide instead.\n\n          if (webkit) {\n            te.style.width = \"1000px\";\n          } else {\n            te.setAttribute(\"wrap\", \"off\");\n          } // If border: 0; -- iOS fails to open keyboard (issue #1287)\n\n\n          if (ios) {\n            te.style.border = \"1px solid black\";\n          }\n\n          disableBrowserMagic(te);\n          return div;\n        } // The publicly visible API. Note that methodOp(f) means\n        // 'wrap f in an operation, performed on its `this` parameter'.\n        // This is not the complete set of editor methods. Most of the\n        // methods defined on the Doc type are also injected into\n        // CodeMirror.prototype, for backwards compatibility and\n        // convenience.\n\n\n        var addEditorMethods = function (CodeMirror) {\n          var optionHandlers = CodeMirror.optionHandlers;\n          var helpers = CodeMirror.helpers = {};\n          CodeMirror.prototype = {\n            constructor: CodeMirror,\n            focus: function () {\n              window.focus();\n              this.display.input.focus();\n            },\n            setOption: function (option, value) {\n              var options = this.options,\n                  old = options[option];\n\n              if (options[option] == value && option != \"mode\") {\n                return;\n              }\n\n              options[option] = value;\n\n              if (optionHandlers.hasOwnProperty(option)) {\n                operation(this, optionHandlers[option])(this, value, old);\n              }\n\n              signal(this, \"optionChange\", this, option);\n            },\n            getOption: function (option) {\n              return this.options[option];\n            },\n            getDoc: function () {\n              return this.doc;\n            },\n            addKeyMap: function (map$$1, bottom) {\n              this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map$$1));\n            },\n            removeKeyMap: function (map$$1) {\n              var maps = this.state.keyMaps;\n\n              for (var i = 0; i < maps.length; ++i) {\n                if (maps[i] == map$$1 || maps[i].name == map$$1) {\n                  maps.splice(i, 1);\n                  return true;\n                }\n              }\n            },\n            addOverlay: methodOp(function (spec, options) {\n              var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n\n              if (mode.startState) {\n                throw new Error(\"Overlays may not be stateful.\");\n              }\n\n              insertSorted(this.state.overlays, {\n                mode: mode,\n                modeSpec: spec,\n                opaque: options && options.opaque,\n                priority: options && options.priority || 0\n              }, function (overlay) {\n                return overlay.priority;\n              });\n              this.state.modeGen++;\n              regChange(this);\n            }),\n            removeOverlay: methodOp(function (spec) {\n              var this$1 = this;\n              var overlays = this.state.overlays;\n\n              for (var i = 0; i < overlays.length; ++i) {\n                var cur = overlays[i].modeSpec;\n\n                if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n                  overlays.splice(i, 1);\n                  this$1.state.modeGen++;\n                  regChange(this$1);\n                  return;\n                }\n              }\n            }),\n            indentLine: methodOp(function (n, dir, aggressive) {\n              if (typeof dir != \"string\" && typeof dir != \"number\") {\n                if (dir == null) {\n                  dir = this.options.smartIndent ? \"smart\" : \"prev\";\n                } else {\n                  dir = dir ? \"add\" : \"subtract\";\n                }\n              }\n\n              if (isLine(this.doc, n)) {\n                indentLine(this, n, dir, aggressive);\n              }\n            }),\n            indentSelection: methodOp(function (how) {\n              var this$1 = this;\n              var ranges = this.doc.sel.ranges,\n                  end = -1;\n\n              for (var i = 0; i < ranges.length; i++) {\n                var range$$1 = ranges[i];\n\n                if (!range$$1.empty()) {\n                  var from = range$$1.from(),\n                      to = range$$1.to();\n                  var start = Math.max(end, from.line);\n                  end = Math.min(this$1.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n\n                  for (var j = start; j < end; ++j) {\n                    indentLine(this$1, j, how);\n                  }\n\n                  var newRanges = this$1.doc.sel.ranges;\n\n                  if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0) {\n                    replaceOneSelection(this$1.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll);\n                  }\n                } else if (range$$1.head.line > end) {\n                  indentLine(this$1, range$$1.head.line, how, true);\n                  end = range$$1.head.line;\n\n                  if (i == this$1.doc.sel.primIndex) {\n                    ensureCursorVisible(this$1);\n                  }\n                }\n              }\n            }),\n            // Fetch the parser token for a given character. Useful for hacks\n            // that want to inspect the mode state (say, for completion).\n            getTokenAt: function (pos, precise) {\n              return takeToken(this, pos, precise);\n            },\n            getLineTokens: function (line, precise) {\n              return takeToken(this, Pos(line), precise, true);\n            },\n            getTokenTypeAt: function (pos) {\n              pos = clipPos(this.doc, pos);\n              var styles = getLineStyles(this, getLine(this.doc, pos.line));\n              var before = 0,\n                  after = (styles.length - 1) / 2,\n                  ch = pos.ch;\n              var type;\n\n              if (ch == 0) {\n                type = styles[2];\n              } else {\n                for (;;) {\n                  var mid = before + after >> 1;\n\n                  if ((mid ? styles[mid * 2 - 1] : 0) >= ch) {\n                    after = mid;\n                  } else if (styles[mid * 2 + 1] < ch) {\n                    before = mid + 1;\n                  } else {\n                    type = styles[mid * 2 + 2];\n                    break;\n                  }\n                }\n              }\n\n              var cut = type ? type.indexOf(\"overlay \") : -1;\n              return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1);\n            },\n            getModeAt: function (pos) {\n              var mode = this.doc.mode;\n\n              if (!mode.innerMode) {\n                return mode;\n              }\n\n              return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode;\n            },\n            getHelper: function (pos, type) {\n              return this.getHelpers(pos, type)[0];\n            },\n            getHelpers: function (pos, type) {\n              var this$1 = this;\n              var found = [];\n\n              if (!helpers.hasOwnProperty(type)) {\n                return found;\n              }\n\n              var help = helpers[type],\n                  mode = this.getModeAt(pos);\n\n              if (typeof mode[type] == \"string\") {\n                if (help[mode[type]]) {\n                  found.push(help[mode[type]]);\n                }\n              } else if (mode[type]) {\n                for (var i = 0; i < mode[type].length; i++) {\n                  var val = help[mode[type][i]];\n\n                  if (val) {\n                    found.push(val);\n                  }\n                }\n              } else if (mode.helperType && help[mode.helperType]) {\n                found.push(help[mode.helperType]);\n              } else if (help[mode.name]) {\n                found.push(help[mode.name]);\n              }\n\n              for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n                var cur = help._global[i$1];\n\n                if (cur.pred(mode, this$1) && indexOf(found, cur.val) == -1) {\n                  found.push(cur.val);\n                }\n              }\n\n              return found;\n            },\n            getStateAfter: function (line, precise) {\n              var doc = this.doc;\n              line = clipLine(doc, line == null ? doc.first + doc.size - 1 : line);\n              return getStateBefore(this, line + 1, precise);\n            },\n            cursorCoords: function (start, mode) {\n              var pos,\n                  range$$1 = this.doc.sel.primary();\n\n              if (start == null) {\n                pos = range$$1.head;\n              } else if (typeof start == \"object\") {\n                pos = clipPos(this.doc, start);\n              } else {\n                pos = start ? range$$1.from() : range$$1.to();\n              }\n\n              return cursorCoords(this, pos, mode || \"page\");\n            },\n            charCoords: function (pos, mode) {\n              return charCoords(this, clipPos(this.doc, pos), mode || \"page\");\n            },\n            coordsChar: function (coords, mode) {\n              coords = fromCoordSystem(this, coords, mode || \"page\");\n              return coordsChar(this, coords.left, coords.top);\n            },\n            lineAtHeight: function (height, mode) {\n              height = fromCoordSystem(this, {\n                top: height,\n                left: 0\n              }, mode || \"page\").top;\n              return lineAtHeight(this.doc, height + this.display.viewOffset);\n            },\n            heightAtLine: function (line, mode, includeWidgets) {\n              var end = false,\n                  lineObj;\n\n              if (typeof line == \"number\") {\n                var last = this.doc.first + this.doc.size - 1;\n\n                if (line < this.doc.first) {\n                  line = this.doc.first;\n                } else if (line > last) {\n                  line = last;\n                  end = true;\n                }\n\n                lineObj = getLine(this.doc, line);\n              } else {\n                lineObj = line;\n              }\n\n              return intoCoordSystem(this, lineObj, {\n                top: 0,\n                left: 0\n              }, mode || \"page\", includeWidgets || end).top + (end ? this.doc.height - heightAtLine(lineObj) : 0);\n            },\n            defaultTextHeight: function () {\n              return textHeight(this.display);\n            },\n            defaultCharWidth: function () {\n              return charWidth(this.display);\n            },\n            getViewport: function () {\n              return {\n                from: this.display.viewFrom,\n                to: this.display.viewTo\n              };\n            },\n            addWidget: function (pos, node, scroll, vert, horiz) {\n              var display = this.display;\n              pos = cursorCoords(this, clipPos(this.doc, pos));\n              var top = pos.bottom,\n                  left = pos.left;\n              node.style.position = \"absolute\";\n              node.setAttribute(\"cm-ignore-events\", \"true\");\n              this.display.input.setUneditable(node);\n              display.sizer.appendChild(node);\n\n              if (vert == \"over\") {\n                top = pos.top;\n              } else if (vert == \"above\" || vert == \"near\") {\n                var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n                    hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth); // Default to positioning above (if specified and possible); otherwise default to positioning below\n\n                if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight) {\n                  top = pos.top - node.offsetHeight;\n                } else if (pos.bottom + node.offsetHeight <= vspace) {\n                  top = pos.bottom;\n                }\n\n                if (left + node.offsetWidth > hspace) {\n                  left = hspace - node.offsetWidth;\n                }\n              }\n\n              node.style.top = top + \"px\";\n              node.style.left = node.style.right = \"\";\n\n              if (horiz == \"right\") {\n                left = display.sizer.clientWidth - node.offsetWidth;\n                node.style.right = \"0px\";\n              } else {\n                if (horiz == \"left\") {\n                  left = 0;\n                } else if (horiz == \"middle\") {\n                  left = (display.sizer.clientWidth - node.offsetWidth) / 2;\n                }\n\n                node.style.left = left + \"px\";\n              }\n\n              if (scroll) {\n                scrollIntoView(this, {\n                  left: left,\n                  top: top,\n                  right: left + node.offsetWidth,\n                  bottom: top + node.offsetHeight\n                });\n              }\n            },\n            triggerOnKeyDown: methodOp(onKeyDown),\n            triggerOnKeyPress: methodOp(onKeyPress),\n            triggerOnKeyUp: onKeyUp,\n            execCommand: function (cmd) {\n              if (commands.hasOwnProperty(cmd)) {\n                return commands[cmd].call(null, this);\n              }\n            },\n            triggerElectric: methodOp(function (text) {\n              triggerElectric(this, text);\n            }),\n            findPosH: function (from, amount, unit, visually) {\n              var this$1 = this;\n              var dir = 1;\n\n              if (amount < 0) {\n                dir = -1;\n                amount = -amount;\n              }\n\n              var cur = clipPos(this.doc, from);\n\n              for (var i = 0; i < amount; ++i) {\n                cur = findPosH(this$1.doc, cur, dir, unit, visually);\n\n                if (cur.hitSide) {\n                  break;\n                }\n              }\n\n              return cur;\n            },\n            moveH: methodOp(function (dir, unit) {\n              var this$1 = this;\n              this.extendSelectionsBy(function (range$$1) {\n                if (this$1.display.shift || this$1.doc.extend || range$$1.empty()) {\n                  return findPosH(this$1.doc, range$$1.head, dir, unit, this$1.options.rtlMoveVisually);\n                } else {\n                  return dir < 0 ? range$$1.from() : range$$1.to();\n                }\n              }, sel_move);\n            }),\n            deleteH: methodOp(function (dir, unit) {\n              var sel = this.doc.sel,\n                  doc = this.doc;\n\n              if (sel.somethingSelected()) {\n                doc.replaceSelection(\"\", null, \"+delete\");\n              } else {\n                deleteNearSelection(this, function (range$$1) {\n                  var other = findPosH(doc, range$$1.head, dir, unit, false);\n                  return dir < 0 ? {\n                    from: other,\n                    to: range$$1.head\n                  } : {\n                    from: range$$1.head,\n                    to: other\n                  };\n                });\n              }\n            }),\n            findPosV: function (from, amount, unit, goalColumn) {\n              var this$1 = this;\n              var dir = 1,\n                  x = goalColumn;\n\n              if (amount < 0) {\n                dir = -1;\n                amount = -amount;\n              }\n\n              var cur = clipPos(this.doc, from);\n\n              for (var i = 0; i < amount; ++i) {\n                var coords = cursorCoords(this$1, cur, \"div\");\n\n                if (x == null) {\n                  x = coords.left;\n                } else {\n                  coords.left = x;\n                }\n\n                cur = findPosV(this$1, coords, dir, unit);\n\n                if (cur.hitSide) {\n                  break;\n                }\n              }\n\n              return cur;\n            },\n            moveV: methodOp(function (dir, unit) {\n              var this$1 = this;\n              var doc = this.doc,\n                  goals = [];\n              var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n              doc.extendSelectionsBy(function (range$$1) {\n                if (collapse) {\n                  return dir < 0 ? range$$1.from() : range$$1.to();\n                }\n\n                var headPos = cursorCoords(this$1, range$$1.head, \"div\");\n\n                if (range$$1.goalColumn != null) {\n                  headPos.left = range$$1.goalColumn;\n                }\n\n                goals.push(headPos.left);\n                var pos = findPosV(this$1, headPos, dir, unit);\n\n                if (unit == \"page\" && range$$1 == doc.sel.primary()) {\n                  addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top);\n                }\n\n                return pos;\n              }, sel_move);\n\n              if (goals.length) {\n                for (var i = 0; i < doc.sel.ranges.length; i++) {\n                  doc.sel.ranges[i].goalColumn = goals[i];\n                }\n              }\n            }),\n            // Find the word at the given position (as returned by coordsChar).\n            findWordAt: function (pos) {\n              var doc = this.doc,\n                  line = getLine(doc, pos.line).text;\n              var start = pos.ch,\n                  end = pos.ch;\n\n              if (line) {\n                var helper = this.getHelper(pos, \"wordChars\");\n\n                if ((pos.sticky == \"before\" || end == line.length) && start) {\n                  --start;\n                } else {\n                  ++end;\n                }\n\n                var startChar = line.charAt(start);\n                var check = isWordChar(startChar, helper) ? function (ch) {\n                  return isWordChar(ch, helper);\n                } : /\\s/.test(startChar) ? function (ch) {\n                  return /\\s/.test(ch);\n                } : function (ch) {\n                  return !/\\s/.test(ch) && !isWordChar(ch);\n                };\n\n                while (start > 0 && check(line.charAt(start - 1))) {\n                  --start;\n                }\n\n                while (end < line.length && check(line.charAt(end))) {\n                  ++end;\n                }\n              }\n\n              return new Range(Pos(pos.line, start), Pos(pos.line, end));\n            },\n            toggleOverwrite: function (value) {\n              if (value != null && value == this.state.overwrite) {\n                return;\n              }\n\n              if (this.state.overwrite = !this.state.overwrite) {\n                addClass(this.display.cursorDiv, \"CodeMirror-overwrite\");\n              } else {\n                rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\");\n              }\n\n              signal(this, \"overwriteToggle\", this, this.state.overwrite);\n            },\n            hasFocus: function () {\n              return this.display.input.getField() == activeElt();\n            },\n            isReadOnly: function () {\n              return !!(this.options.readOnly || this.doc.cantEdit);\n            },\n            scrollTo: methodOp(function (x, y) {\n              scrollToCoords(this, x, y);\n            }),\n            getScrollInfo: function () {\n              var scroller = this.display.scroller;\n              return {\n                left: scroller.scrollLeft,\n                top: scroller.scrollTop,\n                height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n                width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n                clientHeight: displayHeight(this),\n                clientWidth: displayWidth(this)\n              };\n            },\n            scrollIntoView: methodOp(function (range$$1, margin) {\n              if (range$$1 == null) {\n                range$$1 = {\n                  from: this.doc.sel.primary().head,\n                  to: null\n                };\n\n                if (margin == null) {\n                  margin = this.options.cursorScrollMargin;\n                }\n              } else if (typeof range$$1 == \"number\") {\n                range$$1 = {\n                  from: Pos(range$$1, 0),\n                  to: null\n                };\n              } else if (range$$1.from == null) {\n                range$$1 = {\n                  from: range$$1,\n                  to: null\n                };\n              }\n\n              if (!range$$1.to) {\n                range$$1.to = range$$1.from;\n              }\n\n              range$$1.margin = margin || 0;\n\n              if (range$$1.from.line != null) {\n                scrollToRange(this, range$$1);\n              } else {\n                scrollToCoordsRange(this, range$$1.from, range$$1.to, range$$1.margin);\n              }\n            }),\n            setSize: methodOp(function (width, height) {\n              var this$1 = this;\n\n              var interpret = function (val) {\n                return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val;\n              };\n\n              if (width != null) {\n                this.display.wrapper.style.width = interpret(width);\n              }\n\n              if (height != null) {\n                this.display.wrapper.style.height = interpret(height);\n              }\n\n              if (this.options.lineWrapping) {\n                clearLineMeasurementCache(this);\n              }\n\n              var lineNo$$1 = this.display.viewFrom;\n              this.doc.iter(lineNo$$1, this.display.viewTo, function (line) {\n                if (line.widgets) {\n                  for (var i = 0; i < line.widgets.length; i++) {\n                    if (line.widgets[i].noHScroll) {\n                      regLineChange(this$1, lineNo$$1, \"widget\");\n                      break;\n                    }\n                  }\n                }\n\n                ++lineNo$$1;\n              });\n              this.curOp.forceUpdate = true;\n              signal(this, \"refresh\", this);\n            }),\n            operation: function (f) {\n              return runInOp(this, f);\n            },\n            refresh: methodOp(function () {\n              var oldHeight = this.display.cachedTextHeight;\n              regChange(this);\n              this.curOp.forceUpdate = true;\n              clearCaches(this);\n              scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n              updateGutterSpace(this);\n\n              if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5) {\n                estimateLineHeights(this);\n              }\n\n              signal(this, \"refresh\", this);\n            }),\n            swapDoc: methodOp(function (doc) {\n              var old = this.doc;\n              old.cm = null;\n              attachDoc(this, doc);\n              clearCaches(this);\n              this.display.input.reset();\n              scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n              this.curOp.forceScroll = true;\n              signalLater(this, \"swapDoc\", this, old);\n              return old;\n            }),\n            getInputField: function () {\n              return this.display.input.getField();\n            },\n            getWrapperElement: function () {\n              return this.display.wrapper;\n            },\n            getScrollerElement: function () {\n              return this.display.scroller;\n            },\n            getGutterElement: function () {\n              return this.display.gutters;\n            }\n          };\n          eventMixin(CodeMirror);\n\n          CodeMirror.registerHelper = function (type, name, value) {\n            if (!helpers.hasOwnProperty(type)) {\n              helpers[type] = CodeMirror[type] = {\n                _global: []\n              };\n            }\n\n            helpers[type][name] = value;\n          };\n\n          CodeMirror.registerGlobalHelper = function (type, name, predicate, value) {\n            CodeMirror.registerHelper(type, name, value);\n\n            helpers[type]._global.push({\n              pred: predicate,\n              val: value\n            });\n          };\n        }; // Used for horizontal relative motion. Dir is -1 or 1 (left or\n        // right), unit can be \"char\", \"column\" (like char, but doesn't\n        // cross line boundaries), \"word\" (across next word), or \"group\" (to\n        // the start of next group of word or non-word-non-whitespace\n        // chars). The visually param controls whether, in right-to-left\n        // text, direction 1 means to move towards the next index in the\n        // string, or towards the character to the right of the current\n        // position. The resulting position will have a hitSide=true\n        // property if it reached the end of the document.\n\n\n        function findPosH(doc, pos, dir, unit, visually) {\n          var oldPos = pos;\n          var origDir = dir;\n          var lineObj = getLine(doc, pos.line);\n\n          function findNextLine() {\n            var l = pos.line + dir;\n\n            if (l < doc.first || l >= doc.first + doc.size) {\n              return false;\n            }\n\n            pos = new Pos(l, pos.ch, pos.sticky);\n            return lineObj = getLine(doc, l);\n          }\n\n          function moveOnce(boundToLine) {\n            var next;\n\n            if (visually) {\n              next = moveVisually(doc.cm, lineObj, pos, dir);\n            } else {\n              next = moveLogically(lineObj, pos, dir);\n            }\n\n            if (next == null) {\n              if (!boundToLine && findNextLine()) {\n                pos = endOfLine(visually, doc.cm, lineObj, pos.line, dir);\n              } else {\n                return false;\n              }\n            } else {\n              pos = next;\n            }\n\n            return true;\n          }\n\n          if (unit == \"char\") {\n            moveOnce();\n          } else if (unit == \"column\") {\n            moveOnce(true);\n          } else if (unit == \"word\" || unit == \"group\") {\n            var sawType = null,\n                group = unit == \"group\";\n            var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n\n            for (var first = true;; first = false) {\n              if (dir < 0 && !moveOnce(!first)) {\n                break;\n              }\n\n              var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n              var type = isWordChar(cur, helper) ? \"w\" : group && cur == \"\\n\" ? \"n\" : !group || /\\s/.test(cur) ? null : \"p\";\n\n              if (group && !first && !type) {\n                type = \"s\";\n              }\n\n              if (sawType && sawType != type) {\n                if (dir < 0) {\n                  dir = 1;\n                  moveOnce();\n                  pos.sticky = \"after\";\n                }\n\n                break;\n              }\n\n              if (type) {\n                sawType = type;\n              }\n\n              if (dir > 0 && !moveOnce(!first)) {\n                break;\n              }\n            }\n          }\n\n          var result = skipAtomic(doc, pos, oldPos, origDir, true);\n\n          if (equalCursorPos(oldPos, result)) {\n            result.hitSide = true;\n          }\n\n          return result;\n        } // For relative vertical movement. Dir may be -1 or 1. Unit can be\n        // \"page\" or \"line\". The resulting position will have a hitSide=true\n        // property if it reached the end of the document.\n\n\n        function findPosV(cm, pos, dir, unit) {\n          var doc = cm.doc,\n              x = pos.left,\n              y;\n\n          if (unit == \"page\") {\n            var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n            var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n            y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n          } else if (unit == \"line\") {\n            y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n          }\n\n          var target;\n\n          for (;;) {\n            target = coordsChar(cm, x, y);\n\n            if (!target.outside) {\n              break;\n            }\n\n            if (dir < 0 ? y <= 0 : y >= doc.height) {\n              target.hitSide = true;\n              break;\n            }\n\n            y += dir * 5;\n          }\n\n          return target;\n        } // CONTENTEDITABLE INPUT STYLE\n\n\n        var ContentEditableInput = function (cm) {\n          this.cm = cm;\n          this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n          this.polling = new Delayed();\n          this.composing = null;\n          this.gracePeriod = false;\n          this.readDOMTimeout = null;\n        };\n\n        ContentEditableInput.prototype.init = function (display) {\n          var this$1 = this;\n          var input = this,\n              cm = input.cm;\n          var div = input.div = display.lineDiv;\n          disableBrowserMagic(div, cm.options.spellcheck);\n          on(div, \"paste\", function (e) {\n            if (signalDOMEvent(cm, e) || handlePaste(e, cm)) {\n              return;\n            } // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n\n\n            if (ie_version <= 11) {\n              setTimeout(operation(cm, function () {\n                return this$1.updateFromDOM();\n              }), 20);\n            }\n          });\n          on(div, \"compositionstart\", function (e) {\n            this$1.composing = {\n              data: e.data,\n              done: false\n            };\n          });\n          on(div, \"compositionupdate\", function (e) {\n            if (!this$1.composing) {\n              this$1.composing = {\n                data: e.data,\n                done: false\n              };\n            }\n          });\n          on(div, \"compositionend\", function (e) {\n            if (this$1.composing) {\n              if (e.data != this$1.composing.data) {\n                this$1.readFromDOMSoon();\n              }\n\n              this$1.composing.done = true;\n            }\n          });\n          on(div, \"touchstart\", function () {\n            return input.forceCompositionEnd();\n          });\n          on(div, \"input\", function () {\n            if (!this$1.composing) {\n              this$1.readFromDOMSoon();\n            }\n          });\n\n          function onCopyCut(e) {\n            if (signalDOMEvent(cm, e)) {\n              return;\n            }\n\n            if (cm.somethingSelected()) {\n              setLastCopied({\n                lineWise: false,\n                text: cm.getSelections()\n              });\n\n              if (e.type == \"cut\") {\n                cm.replaceSelection(\"\", null, \"cut\");\n              }\n            } else if (!cm.options.lineWiseCopyCut) {\n              return;\n            } else {\n              var ranges = copyableRanges(cm);\n              setLastCopied({\n                lineWise: true,\n                text: ranges.text\n              });\n\n              if (e.type == \"cut\") {\n                cm.operation(function () {\n                  cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n                  cm.replaceSelection(\"\", null, \"cut\");\n                });\n              }\n            }\n\n            if (e.clipboardData) {\n              e.clipboardData.clearData();\n              var content = lastCopied.text.join(\"\\n\"); // iOS exposes the clipboard API, but seems to discard content inserted into it\n\n              e.clipboardData.setData(\"Text\", content);\n\n              if (e.clipboardData.getData(\"Text\") == content) {\n                e.preventDefault();\n                return;\n              }\n            } // Old-fashioned briefly-focus-a-textarea hack\n\n\n            var kludge = hiddenTextarea(),\n                te = kludge.firstChild;\n            cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n            te.value = lastCopied.text.join(\"\\n\");\n            var hadFocus = document.activeElement;\n            selectInput(te);\n            setTimeout(function () {\n              cm.display.lineSpace.removeChild(kludge);\n              hadFocus.focus();\n\n              if (hadFocus == div) {\n                input.showPrimarySelection();\n              }\n            }, 50);\n          }\n\n          on(div, \"copy\", onCopyCut);\n          on(div, \"cut\", onCopyCut);\n        };\n\n        ContentEditableInput.prototype.prepareSelection = function () {\n          var result = prepareSelection(this.cm, false);\n          result.focus = this.cm.state.focused;\n          return result;\n        };\n\n        ContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n          if (!info || !this.cm.display.view.length) {\n            return;\n          }\n\n          if (info.focus || takeFocus) {\n            this.showPrimarySelection();\n          }\n\n          this.showMultipleSelections(info);\n        };\n\n        ContentEditableInput.prototype.showPrimarySelection = function () {\n          var sel = window.getSelection(),\n              cm = this.cm,\n              prim = cm.doc.sel.primary();\n          var from = prim.from(),\n              to = prim.to();\n\n          if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n            sel.removeAllRanges();\n            return;\n          }\n\n          var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n          var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n\n          if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad && cmp(minPos(curAnchor, curFocus), from) == 0 && cmp(maxPos(curAnchor, curFocus), to) == 0) {\n            return;\n          }\n\n          var view = cm.display.view;\n          var start = from.line >= cm.display.viewFrom && posToDOM(cm, from) || {\n            node: view[0].measure.map[2],\n            offset: 0\n          };\n          var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n\n          if (!end) {\n            var measure = view[view.length - 1].measure;\n            var map$$1 = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n            end = {\n              node: map$$1[map$$1.length - 1],\n              offset: map$$1[map$$1.length - 2] - map$$1[map$$1.length - 3]\n            };\n          }\n\n          if (!start || !end) {\n            sel.removeAllRanges();\n            return;\n          }\n\n          var old = sel.rangeCount && sel.getRangeAt(0),\n              rng;\n\n          try {\n            rng = range(start.node, start.offset, end.offset, end.node);\n          } catch (e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n\n\n          if (rng) {\n            if (!gecko && cm.state.focused) {\n              sel.collapse(start.node, start.offset);\n\n              if (!rng.collapsed) {\n                sel.removeAllRanges();\n                sel.addRange(rng);\n              }\n            } else {\n              sel.removeAllRanges();\n              sel.addRange(rng);\n            }\n\n            if (old && sel.anchorNode == null) {\n              sel.addRange(old);\n            } else if (gecko) {\n              this.startGracePeriod();\n            }\n          }\n\n          this.rememberSelection();\n        };\n\n        ContentEditableInput.prototype.startGracePeriod = function () {\n          var this$1 = this;\n          clearTimeout(this.gracePeriod);\n          this.gracePeriod = setTimeout(function () {\n            this$1.gracePeriod = false;\n\n            if (this$1.selectionChanged()) {\n              this$1.cm.operation(function () {\n                return this$1.cm.curOp.selectionChanged = true;\n              });\n            }\n          }, 20);\n        };\n\n        ContentEditableInput.prototype.showMultipleSelections = function (info) {\n          removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n          removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n        };\n\n        ContentEditableInput.prototype.rememberSelection = function () {\n          var sel = window.getSelection();\n          this.lastAnchorNode = sel.anchorNode;\n          this.lastAnchorOffset = sel.anchorOffset;\n          this.lastFocusNode = sel.focusNode;\n          this.lastFocusOffset = sel.focusOffset;\n        };\n\n        ContentEditableInput.prototype.selectionInEditor = function () {\n          var sel = window.getSelection();\n\n          if (!sel.rangeCount) {\n            return false;\n          }\n\n          var node = sel.getRangeAt(0).commonAncestorContainer;\n          return contains(this.div, node);\n        };\n\n        ContentEditableInput.prototype.focus = function () {\n          if (this.cm.options.readOnly != \"nocursor\") {\n            if (!this.selectionInEditor()) {\n              this.showSelection(this.prepareSelection(), true);\n            }\n\n            this.div.focus();\n          }\n        };\n\n        ContentEditableInput.prototype.blur = function () {\n          this.div.blur();\n        };\n\n        ContentEditableInput.prototype.getField = function () {\n          return this.div;\n        };\n\n        ContentEditableInput.prototype.supportsTouch = function () {\n          return true;\n        };\n\n        ContentEditableInput.prototype.receivedFocus = function () {\n          var input = this;\n\n          if (this.selectionInEditor()) {\n            this.pollSelection();\n          } else {\n            runInOp(this.cm, function () {\n              return input.cm.curOp.selectionChanged = true;\n            });\n          }\n\n          function poll() {\n            if (input.cm.state.focused) {\n              input.pollSelection();\n              input.polling.set(input.cm.options.pollInterval, poll);\n            }\n          }\n\n          this.polling.set(this.cm.options.pollInterval, poll);\n        };\n\n        ContentEditableInput.prototype.selectionChanged = function () {\n          var sel = window.getSelection();\n          return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset || sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset;\n        };\n\n        ContentEditableInput.prototype.pollSelection = function () {\n          if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) {\n            return;\n          }\n\n          var sel = window.getSelection(),\n              cm = this.cm; // On Android Chrome (version 56, at least), backspacing into an\n          // uneditable block element will put the cursor in that element,\n          // and then, because it's not editable, hide the virtual keyboard.\n          // Because Android doesn't allow us to actually detect backspace\n          // presses in a sane way, this code checks for when that happens\n          // and simulates a backspace press in this case.\n\n          if (android && chrome && this.cm.options.gutters.length && isInGutter(sel.anchorNode)) {\n            this.cm.triggerOnKeyDown({\n              type: \"keydown\",\n              keyCode: 8,\n              preventDefault: Math.abs\n            });\n            this.blur();\n            this.focus();\n            return;\n          }\n\n          if (this.composing) {\n            return;\n          }\n\n          this.rememberSelection();\n          var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n          var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n\n          if (anchor && head) {\n            runInOp(cm, function () {\n              setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n\n              if (anchor.bad || head.bad) {\n                cm.curOp.selectionChanged = true;\n              }\n            });\n          }\n        };\n\n        ContentEditableInput.prototype.pollContent = function () {\n          if (this.readDOMTimeout != null) {\n            clearTimeout(this.readDOMTimeout);\n            this.readDOMTimeout = null;\n          }\n\n          var cm = this.cm,\n              display = cm.display,\n              sel = cm.doc.sel.primary();\n          var from = sel.from(),\n              to = sel.to();\n\n          if (from.ch == 0 && from.line > cm.firstLine()) {\n            from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length);\n          }\n\n          if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine()) {\n            to = Pos(to.line + 1, 0);\n          }\n\n          if (from.line < display.viewFrom || to.line > display.viewTo - 1) {\n            return false;\n          }\n\n          var fromIndex, fromLine, fromNode;\n\n          if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n            fromLine = lineNo(display.view[0].line);\n            fromNode = display.view[0].node;\n          } else {\n            fromLine = lineNo(display.view[fromIndex].line);\n            fromNode = display.view[fromIndex - 1].node.nextSibling;\n          }\n\n          var toIndex = findViewIndex(cm, to.line);\n          var toLine, toNode;\n\n          if (toIndex == display.view.length - 1) {\n            toLine = display.viewTo - 1;\n            toNode = display.lineDiv.lastChild;\n          } else {\n            toLine = lineNo(display.view[toIndex + 1].line) - 1;\n            toNode = display.view[toIndex + 1].node.previousSibling;\n          }\n\n          if (!fromNode) {\n            return false;\n          }\n\n          var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n          var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n\n          while (newText.length > 1 && oldText.length > 1) {\n            if (lst(newText) == lst(oldText)) {\n              newText.pop();\n              oldText.pop();\n              toLine--;\n            } else if (newText[0] == oldText[0]) {\n              newText.shift();\n              oldText.shift();\n              fromLine++;\n            } else {\n              break;\n            }\n          }\n\n          var cutFront = 0,\n              cutEnd = 0;\n          var newTop = newText[0],\n              oldTop = oldText[0],\n              maxCutFront = Math.min(newTop.length, oldTop.length);\n\n          while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront)) {\n            ++cutFront;\n          }\n\n          var newBot = lst(newText),\n              oldBot = lst(oldText);\n          var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0), oldBot.length - (oldText.length == 1 ? cutFront : 0));\n\n          while (cutEnd < maxCutEnd && newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n            ++cutEnd;\n          } // Try to move start of change to start of selection if ambiguous\n\n\n          if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n            while (cutFront && cutFront > from.ch && newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n              cutFront--;\n              cutEnd++;\n            }\n          }\n\n          newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n          newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n          var chFrom = Pos(fromLine, cutFront);\n          var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n\n          if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n            replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n            return true;\n          }\n        };\n\n        ContentEditableInput.prototype.ensurePolled = function () {\n          this.forceCompositionEnd();\n        };\n\n        ContentEditableInput.prototype.reset = function () {\n          this.forceCompositionEnd();\n        };\n\n        ContentEditableInput.prototype.forceCompositionEnd = function () {\n          if (!this.composing) {\n            return;\n          }\n\n          clearTimeout(this.readDOMTimeout);\n          this.composing = null;\n          this.updateFromDOM();\n          this.div.blur();\n          this.div.focus();\n        };\n\n        ContentEditableInput.prototype.readFromDOMSoon = function () {\n          var this$1 = this;\n\n          if (this.readDOMTimeout != null) {\n            return;\n          }\n\n          this.readDOMTimeout = setTimeout(function () {\n            this$1.readDOMTimeout = null;\n\n            if (this$1.composing) {\n              if (this$1.composing.done) {\n                this$1.composing = null;\n              } else {\n                return;\n              }\n            }\n\n            this$1.updateFromDOM();\n          }, 80);\n        };\n\n        ContentEditableInput.prototype.updateFromDOM = function () {\n          var this$1 = this;\n\n          if (this.cm.isReadOnly() || !this.pollContent()) {\n            runInOp(this.cm, function () {\n              return regChange(this$1.cm);\n            });\n          }\n        };\n\n        ContentEditableInput.prototype.setUneditable = function (node) {\n          node.contentEditable = \"false\";\n        };\n\n        ContentEditableInput.prototype.onKeyPress = function (e) {\n          if (e.charCode == 0) {\n            return;\n          }\n\n          e.preventDefault();\n\n          if (!this.cm.isReadOnly()) {\n            operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0);\n          }\n        };\n\n        ContentEditableInput.prototype.readOnlyChanged = function (val) {\n          this.div.contentEditable = String(val != \"nocursor\");\n        };\n\n        ContentEditableInput.prototype.onContextMenu = function () {};\n\n        ContentEditableInput.prototype.resetPosition = function () {};\n\n        ContentEditableInput.prototype.needsContentAttribute = true;\n\n        function posToDOM(cm, pos) {\n          var view = findViewForLine(cm, pos.line);\n\n          if (!view || view.hidden) {\n            return null;\n          }\n\n          var line = getLine(cm.doc, pos.line);\n          var info = mapFromLineView(view, line, pos.line);\n          var order = getOrder(line, cm.doc.direction),\n              side = \"left\";\n\n          if (order) {\n            var partPos = getBidiPartAt(order, pos.ch);\n            side = partPos % 2 ? \"right\" : \"left\";\n          }\n\n          var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n          result.offset = result.collapse == \"right\" ? result.end : result.start;\n          return result;\n        }\n\n        function isInGutter(node) {\n          for (var scan = node; scan; scan = scan.parentNode) {\n            if (/CodeMirror-gutter-wrapper/.test(scan.className)) {\n              return true;\n            }\n          }\n\n          return false;\n        }\n\n        function badPos(pos, bad) {\n          if (bad) {\n            pos.bad = true;\n          }\n\n          return pos;\n        }\n\n        function domTextBetween(cm, from, to, fromLine, toLine) {\n          var text = \"\",\n              closing = false,\n              lineSep = cm.doc.lineSeparator();\n\n          function recognizeMarker(id) {\n            return function (marker) {\n              return marker.id == id;\n            };\n          }\n\n          function close() {\n            if (closing) {\n              text += lineSep;\n              closing = false;\n            }\n          }\n\n          function addText(str) {\n            if (str) {\n              close();\n              text += str;\n            }\n          }\n\n          function walk(node) {\n            if (node.nodeType == 1) {\n              var cmText = node.getAttribute(\"cm-text\");\n\n              if (cmText != null) {\n                addText(cmText || node.textContent.replace(/\\u200b/g, \"\"));\n                return;\n              }\n\n              var markerID = node.getAttribute(\"cm-marker\"),\n                  range$$1;\n\n              if (markerID) {\n                var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n\n                if (found.length && (range$$1 = found[0].find())) {\n                  addText(getBetween(cm.doc, range$$1.from, range$$1.to).join(lineSep));\n                }\n\n                return;\n              }\n\n              if (node.getAttribute(\"contenteditable\") == \"false\") {\n                return;\n              }\n\n              var isBlock = /^(pre|div|p)$/i.test(node.nodeName);\n\n              if (isBlock) {\n                close();\n              }\n\n              for (var i = 0; i < node.childNodes.length; i++) {\n                walk(node.childNodes[i]);\n              }\n\n              if (isBlock) {\n                closing = true;\n              }\n            } else if (node.nodeType == 3) {\n              addText(node.nodeValue);\n            }\n          }\n\n          for (;;) {\n            walk(from);\n\n            if (from == to) {\n              break;\n            }\n\n            from = from.nextSibling;\n          }\n\n          return text;\n        }\n\n        function domToPos(cm, node, offset) {\n          var lineNode;\n\n          if (node == cm.display.lineDiv) {\n            lineNode = cm.display.lineDiv.childNodes[offset];\n\n            if (!lineNode) {\n              return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true);\n            }\n\n            node = null;\n            offset = 0;\n          } else {\n            for (lineNode = node;; lineNode = lineNode.parentNode) {\n              if (!lineNode || lineNode == cm.display.lineDiv) {\n                return null;\n              }\n\n              if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) {\n                break;\n              }\n            }\n          }\n\n          for (var i = 0; i < cm.display.view.length; i++) {\n            var lineView = cm.display.view[i];\n\n            if (lineView.node == lineNode) {\n              return locateNodeInLineView(lineView, node, offset);\n            }\n          }\n        }\n\n        function locateNodeInLineView(lineView, node, offset) {\n          var wrapper = lineView.text.firstChild,\n              bad = false;\n\n          if (!node || !contains(wrapper, node)) {\n            return badPos(Pos(lineNo(lineView.line), 0), true);\n          }\n\n          if (node == wrapper) {\n            bad = true;\n            node = wrapper.childNodes[offset];\n            offset = 0;\n\n            if (!node) {\n              var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n              return badPos(Pos(lineNo(line), line.text.length), bad);\n            }\n          }\n\n          var textNode = node.nodeType == 3 ? node : null,\n              topNode = node;\n\n          if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n            textNode = node.firstChild;\n\n            if (offset) {\n              offset = textNode.nodeValue.length;\n            }\n          }\n\n          while (topNode.parentNode != wrapper) {\n            topNode = topNode.parentNode;\n          }\n\n          var measure = lineView.measure,\n              maps = measure.maps;\n\n          function find(textNode, topNode, offset) {\n            for (var i = -1; i < (maps ? maps.length : 0); i++) {\n              var map$$1 = i < 0 ? measure.map : maps[i];\n\n              for (var j = 0; j < map$$1.length; j += 3) {\n                var curNode = map$$1[j + 2];\n\n                if (curNode == textNode || curNode == topNode) {\n                  var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n                  var ch = map$$1[j] + offset;\n\n                  if (offset < 0 || curNode != textNode) {\n                    ch = map$$1[j + (offset ? 1 : 0)];\n                  }\n\n                  return Pos(line, ch);\n                }\n              }\n            }\n          }\n\n          var found = find(textNode, topNode, offset);\n\n          if (found) {\n            return badPos(found, bad);\n          } // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n\n\n          for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n            found = find(after, after.firstChild, 0);\n\n            if (found) {\n              return badPos(Pos(found.line, found.ch - dist), bad);\n            } else {\n              dist += after.textContent.length;\n            }\n          }\n\n          for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n            found = find(before, before.firstChild, -1);\n\n            if (found) {\n              return badPos(Pos(found.line, found.ch + dist$1), bad);\n            } else {\n              dist$1 += before.textContent.length;\n            }\n          }\n        } // TEXTAREA INPUT STYLE\n\n\n        var TextareaInput = function (cm) {\n          this.cm = cm; // See input.poll and input.reset\n\n          this.prevInput = \"\"; // Flag that indicates whether we expect input to appear real soon\n          // now (after some event like 'keypress' or 'input') and are\n          // polling intensively.\n\n          this.pollingFast = false; // Self-resetting timeout for the poller\n\n          this.polling = new Delayed(); // Tracks when input.reset has punted to just putting a short\n          // string into the textarea instead of the full selection.\n\n          this.inaccurateSelection = false; // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n\n          this.hasSelection = false;\n          this.composing = null;\n        };\n\n        TextareaInput.prototype.init = function (display) {\n          var this$1 = this;\n          var input = this,\n              cm = this.cm; // Wraps and hides input textarea\n\n          var div = this.wrapper = hiddenTextarea(); // The semihidden textarea that is focused when the editor is\n          // focused, and receives input.\n\n          var te = this.textarea = div.firstChild;\n          display.wrapper.insertBefore(div, display.wrapper.firstChild); // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n\n          if (ios) {\n            te.style.width = \"0px\";\n          }\n\n          on(te, \"input\", function () {\n            if (ie && ie_version >= 9 && this$1.hasSelection) {\n              this$1.hasSelection = null;\n            }\n\n            input.poll();\n          });\n          on(te, \"paste\", function (e) {\n            if (signalDOMEvent(cm, e) || handlePaste(e, cm)) {\n              return;\n            }\n\n            cm.state.pasteIncoming = true;\n            input.fastPoll();\n          });\n\n          function prepareCopyCut(e) {\n            if (signalDOMEvent(cm, e)) {\n              return;\n            }\n\n            if (cm.somethingSelected()) {\n              setLastCopied({\n                lineWise: false,\n                text: cm.getSelections()\n              });\n\n              if (input.inaccurateSelection) {\n                input.prevInput = \"\";\n                input.inaccurateSelection = false;\n                te.value = lastCopied.text.join(\"\\n\");\n                selectInput(te);\n              }\n            } else if (!cm.options.lineWiseCopyCut) {\n              return;\n            } else {\n              var ranges = copyableRanges(cm);\n              setLastCopied({\n                lineWise: true,\n                text: ranges.text\n              });\n\n              if (e.type == \"cut\") {\n                cm.setSelections(ranges.ranges, null, sel_dontScroll);\n              } else {\n                input.prevInput = \"\";\n                te.value = ranges.text.join(\"\\n\");\n                selectInput(te);\n              }\n            }\n\n            if (e.type == \"cut\") {\n              cm.state.cutIncoming = true;\n            }\n          }\n\n          on(te, \"cut\", prepareCopyCut);\n          on(te, \"copy\", prepareCopyCut);\n          on(display.scroller, \"paste\", function (e) {\n            if (eventInWidget(display, e) || signalDOMEvent(cm, e)) {\n              return;\n            }\n\n            cm.state.pasteIncoming = true;\n            input.focus();\n          }); // Prevent normal selection in the editor (we handle our own)\n\n          on(display.lineSpace, \"selectstart\", function (e) {\n            if (!eventInWidget(display, e)) {\n              e_preventDefault(e);\n            }\n          });\n          on(te, \"compositionstart\", function () {\n            var start = cm.getCursor(\"from\");\n\n            if (input.composing) {\n              input.composing.range.clear();\n            }\n\n            input.composing = {\n              start: start,\n              range: cm.markText(start, cm.getCursor(\"to\"), {\n                className: \"CodeMirror-composing\"\n              })\n            };\n          });\n          on(te, \"compositionend\", function () {\n            if (input.composing) {\n              input.poll();\n              input.composing.range.clear();\n              input.composing = null;\n            }\n          });\n        };\n\n        TextareaInput.prototype.prepareSelection = function () {\n          // Redraw the selection and/or cursor\n          var cm = this.cm,\n              display = cm.display,\n              doc = cm.doc;\n          var result = prepareSelection(cm); // Move the hidden textarea near the cursor to prevent scrolling artifacts\n\n          if (cm.options.moveInputWithCursor) {\n            var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n            var wrapOff = display.wrapper.getBoundingClientRect(),\n                lineOff = display.lineDiv.getBoundingClientRect();\n            result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10, headPos.top + lineOff.top - wrapOff.top));\n            result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10, headPos.left + lineOff.left - wrapOff.left));\n          }\n\n          return result;\n        };\n\n        TextareaInput.prototype.showSelection = function (drawn) {\n          var cm = this.cm,\n              display = cm.display;\n          removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n          removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n\n          if (drawn.teTop != null) {\n            this.wrapper.style.top = drawn.teTop + \"px\";\n            this.wrapper.style.left = drawn.teLeft + \"px\";\n          }\n        }; // Reset the input to correspond to the selection (or to be empty,\n        // when not typing and nothing is selected)\n\n\n        TextareaInput.prototype.reset = function (typing) {\n          if (this.contextMenuPending || this.composing) {\n            return;\n          }\n\n          var minimal,\n              selected,\n              cm = this.cm,\n              doc = cm.doc;\n\n          if (cm.somethingSelected()) {\n            this.prevInput = \"\";\n            var range$$1 = doc.sel.primary();\n            minimal = hasCopyEvent && (range$$1.to().line - range$$1.from().line > 100 || (selected = cm.getSelection()).length > 1000);\n            var content = minimal ? \"-\" : selected || cm.getSelection();\n            this.textarea.value = content;\n\n            if (cm.state.focused) {\n              selectInput(this.textarea);\n            }\n\n            if (ie && ie_version >= 9) {\n              this.hasSelection = content;\n            }\n          } else if (!typing) {\n            this.prevInput = this.textarea.value = \"\";\n\n            if (ie && ie_version >= 9) {\n              this.hasSelection = null;\n            }\n          }\n\n          this.inaccurateSelection = minimal;\n        };\n\n        TextareaInput.prototype.getField = function () {\n          return this.textarea;\n        };\n\n        TextareaInput.prototype.supportsTouch = function () {\n          return false;\n        };\n\n        TextareaInput.prototype.focus = function () {\n          if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n            try {\n              this.textarea.focus();\n            } catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n\n          }\n        };\n\n        TextareaInput.prototype.blur = function () {\n          this.textarea.blur();\n        };\n\n        TextareaInput.prototype.resetPosition = function () {\n          this.wrapper.style.top = this.wrapper.style.left = 0;\n        };\n\n        TextareaInput.prototype.receivedFocus = function () {\n          this.slowPoll();\n        }; // Poll for input changes, using the normal rate of polling. This\n        // runs as long as the editor is focused.\n\n\n        TextareaInput.prototype.slowPoll = function () {\n          var this$1 = this;\n\n          if (this.pollingFast) {\n            return;\n          }\n\n          this.polling.set(this.cm.options.pollInterval, function () {\n            this$1.poll();\n\n            if (this$1.cm.state.focused) {\n              this$1.slowPoll();\n            }\n          });\n        }; // When an event has just come in that is likely to add or change\n        // something in the input textarea, we poll faster, to ensure that\n        // the change appears on the screen quickly.\n\n\n        TextareaInput.prototype.fastPoll = function () {\n          var missed = false,\n              input = this;\n          input.pollingFast = true;\n\n          function p() {\n            var changed = input.poll();\n\n            if (!changed && !missed) {\n              missed = true;\n              input.polling.set(60, p);\n            } else {\n              input.pollingFast = false;\n              input.slowPoll();\n            }\n          }\n\n          input.polling.set(20, p);\n        }; // Read input from the textarea, and update the document to match.\n        // When something is selected, it is present in the textarea, and\n        // selected (unless it is huge, in which case a placeholder is\n        // used). When nothing is selected, the cursor sits after previously\n        // seen text (can be empty), which is stored in prevInput (we must\n        // not reset the textarea when typing, because that breaks IME).\n\n\n        TextareaInput.prototype.poll = function () {\n          var this$1 = this;\n          var cm = this.cm,\n              input = this.textarea,\n              prevInput = this.prevInput; // Since this is called a *lot*, try to bail out as cheaply as\n          // possible when it is clear that nothing happened. hasSelection\n          // will be the case when there is a lot of text in the textarea,\n          // in which case reading its value would be expensive.\n\n          if (this.contextMenuPending || !cm.state.focused || hasSelection(input) && !prevInput && !this.composing || cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq) {\n            return false;\n          }\n\n          var text = input.value; // If nothing changed, bail.\n\n          if (text == prevInput && !cm.somethingSelected()) {\n            return false;\n          } // Work around nonsensical selection resetting in IE9/10, and\n          // inexplicable appearance of private area unicode characters on\n          // some key combos in Mac (#2689).\n\n\n          if (ie && ie_version >= 9 && this.hasSelection === text || mac && /[\\uf700-\\uf7ff]/.test(text)) {\n            cm.display.input.reset();\n            return false;\n          }\n\n          if (cm.doc.sel == cm.display.selForContextMenu) {\n            var first = text.charCodeAt(0);\n\n            if (first == 0x200b && !prevInput) {\n              prevInput = \"\\u200b\";\n            }\n\n            if (first == 0x21da) {\n              this.reset();\n              return this.cm.execCommand(\"undo\");\n            }\n          } // Find the part of the input that is actually new\n\n\n          var same = 0,\n              l = Math.min(prevInput.length, text.length);\n\n          while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) {\n            ++same;\n          }\n\n          runInOp(cm, function () {\n            applyTextInput(cm, text.slice(same), prevInput.length - same, null, this$1.composing ? \"*compose\" : null); // Don't leave long text in the textarea, since it makes further polling slow\n\n            if (text.length > 1000 || text.indexOf(\"\\n\") > -1) {\n              input.value = this$1.prevInput = \"\";\n            } else {\n              this$1.prevInput = text;\n            }\n\n            if (this$1.composing) {\n              this$1.composing.range.clear();\n              this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"), {\n                className: \"CodeMirror-composing\"\n              });\n            }\n          });\n          return true;\n        };\n\n        TextareaInput.prototype.ensurePolled = function () {\n          if (this.pollingFast && this.poll()) {\n            this.pollingFast = false;\n          }\n        };\n\n        TextareaInput.prototype.onKeyPress = function () {\n          if (ie && ie_version >= 9) {\n            this.hasSelection = null;\n          }\n\n          this.fastPoll();\n        };\n\n        TextareaInput.prototype.onContextMenu = function (e) {\n          var input = this,\n              cm = input.cm,\n              display = cm.display,\n              te = input.textarea;\n          var pos = posFromMouse(cm, e),\n              scrollPos = display.scroller.scrollTop;\n\n          if (!pos || presto) {\n            return;\n          } // Opera is difficult.\n          // Reset the current text selection only if the click is done outside of the selection\n          // and 'resetSelectionOnContextMenu' option is true.\n\n\n          var reset = cm.options.resetSelectionOnContextMenu;\n\n          if (reset && cm.doc.sel.contains(pos) == -1) {\n            operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll);\n          }\n\n          var oldCSS = te.style.cssText,\n              oldWrapperCSS = input.wrapper.style.cssText;\n          input.wrapper.style.cssText = \"position: absolute\";\n          var wrapperBox = input.wrapper.getBoundingClientRect();\n          te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n          var oldScrollY;\n\n          if (webkit) {\n            oldScrollY = window.scrollY;\n          } // Work around Chrome issue (#2712)\n\n\n          display.input.focus();\n\n          if (webkit) {\n            window.scrollTo(null, oldScrollY);\n          }\n\n          display.input.reset(); // Adds \"Select all\" to context menu in FF\n\n          if (!cm.somethingSelected()) {\n            te.value = input.prevInput = \" \";\n          }\n\n          input.contextMenuPending = true;\n          display.selForContextMenu = cm.doc.sel;\n          clearTimeout(display.detectingSelectAll); // Select-all will be greyed out if there's nothing to select, so\n          // this adds a zero-width space so that we can later check whether\n          // it got selected.\n\n          function prepareSelectAllHack() {\n            if (te.selectionStart != null) {\n              var selected = cm.somethingSelected();\n              var extval = \"\\u200b\" + (selected ? te.value : \"\");\n              te.value = \"\\u21da\"; // Used to catch context-menu undo\n\n              te.value = extval;\n              input.prevInput = selected ? \"\" : \"\\u200b\";\n              te.selectionStart = 1;\n              te.selectionEnd = extval.length; // Re-set this, in case some other handler touched the\n              // selection in the meantime.\n\n              display.selForContextMenu = cm.doc.sel;\n            }\n          }\n\n          function rehide() {\n            input.contextMenuPending = false;\n            input.wrapper.style.cssText = oldWrapperCSS;\n            te.style.cssText = oldCSS;\n\n            if (ie && ie_version < 9) {\n              display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos);\n            } // Try to detect the user choosing select-all\n\n\n            if (te.selectionStart != null) {\n              if (!ie || ie && ie_version < 9) {\n                prepareSelectAllHack();\n              }\n\n              var i = 0,\n                  poll = function () {\n                if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 && te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\n                  operation(cm, selectAll)(cm);\n                } else if (i++ < 10) {\n                  display.detectingSelectAll = setTimeout(poll, 500);\n                } else {\n                  display.selForContextMenu = null;\n                  display.input.reset();\n                }\n              };\n\n              display.detectingSelectAll = setTimeout(poll, 200);\n            }\n          }\n\n          if (ie && ie_version >= 9) {\n            prepareSelectAllHack();\n          }\n\n          if (captureRightClick) {\n            e_stop(e);\n\n            var mouseup = function () {\n              off(window, \"mouseup\", mouseup);\n              setTimeout(rehide, 20);\n            };\n\n            on(window, \"mouseup\", mouseup);\n          } else {\n            setTimeout(rehide, 50);\n          }\n        };\n\n        TextareaInput.prototype.readOnlyChanged = function (val) {\n          if (!val) {\n            this.reset();\n          }\n        };\n\n        TextareaInput.prototype.setUneditable = function () {};\n\n        TextareaInput.prototype.needsContentAttribute = false;\n\n        function fromTextArea(textarea, options) {\n          options = options ? copyObj(options) : {};\n          options.value = textarea.value;\n\n          if (!options.tabindex && textarea.tabIndex) {\n            options.tabindex = textarea.tabIndex;\n          }\n\n          if (!options.placeholder && textarea.placeholder) {\n            options.placeholder = textarea.placeholder;\n          } // Set autofocus to true if this textarea is focused, or if it has\n          // autofocus and no other element is focused.\n\n\n          if (options.autofocus == null) {\n            var hasFocus = activeElt();\n            options.autofocus = hasFocus == textarea || textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n          }\n\n          function save() {\n            textarea.value = cm.getValue();\n          }\n\n          var realSubmit;\n\n          if (textarea.form) {\n            on(textarea.form, \"submit\", save); // Deplorable hack to make the submit method do the right thing.\n\n            if (!options.leaveSubmitMethodAlone) {\n              var form = textarea.form;\n              realSubmit = form.submit;\n\n              try {\n                var wrappedSubmit = form.submit = function () {\n                  save();\n                  form.submit = realSubmit;\n                  form.submit();\n                  form.submit = wrappedSubmit;\n                };\n              } catch (e) {}\n            }\n          }\n\n          options.finishInit = function (cm) {\n            cm.save = save;\n\n            cm.getTextArea = function () {\n              return textarea;\n            };\n\n            cm.toTextArea = function () {\n              cm.toTextArea = isNaN; // Prevent this from being ran twice\n\n              save();\n              textarea.parentNode.removeChild(cm.getWrapperElement());\n              textarea.style.display = \"\";\n\n              if (textarea.form) {\n                off(textarea.form, \"submit\", save);\n\n                if (typeof textarea.form.submit == \"function\") {\n                  textarea.form.submit = realSubmit;\n                }\n              }\n            };\n          };\n\n          textarea.style.display = \"none\";\n          var cm = CodeMirror$1(function (node) {\n            return textarea.parentNode.insertBefore(node, textarea.nextSibling);\n          }, options);\n          return cm;\n        }\n\n        function addLegacyProps(CodeMirror) {\n          CodeMirror.off = off;\n          CodeMirror.on = on;\n          CodeMirror.wheelEventPixels = wheelEventPixels;\n          CodeMirror.Doc = Doc;\n          CodeMirror.splitLines = splitLinesAuto;\n          CodeMirror.countColumn = countColumn;\n          CodeMirror.findColumn = findColumn;\n          CodeMirror.isWordChar = isWordCharBasic;\n          CodeMirror.Pass = Pass;\n          CodeMirror.signal = signal;\n          CodeMirror.Line = Line;\n          CodeMirror.changeEnd = changeEnd;\n          CodeMirror.scrollbarModel = scrollbarModel;\n          CodeMirror.Pos = Pos;\n          CodeMirror.cmpPos = cmp;\n          CodeMirror.modes = modes;\n          CodeMirror.mimeModes = mimeModes;\n          CodeMirror.resolveMode = resolveMode;\n          CodeMirror.getMode = getMode;\n          CodeMirror.modeExtensions = modeExtensions;\n          CodeMirror.extendMode = extendMode;\n          CodeMirror.copyState = copyState;\n          CodeMirror.startState = startState;\n          CodeMirror.innerMode = innerMode;\n          CodeMirror.commands = commands;\n          CodeMirror.keyMap = keyMap;\n          CodeMirror.keyName = keyName;\n          CodeMirror.isModifierKey = isModifierKey;\n          CodeMirror.lookupKey = lookupKey;\n          CodeMirror.normalizeKeyMap = normalizeKeyMap;\n          CodeMirror.StringStream = StringStream;\n          CodeMirror.SharedTextMarker = SharedTextMarker;\n          CodeMirror.TextMarker = TextMarker;\n          CodeMirror.LineWidget = LineWidget;\n          CodeMirror.e_preventDefault = e_preventDefault;\n          CodeMirror.e_stopPropagation = e_stopPropagation;\n          CodeMirror.e_stop = e_stop;\n          CodeMirror.addClass = addClass;\n          CodeMirror.contains = contains;\n          CodeMirror.rmClass = rmClass;\n          CodeMirror.keyNames = keyNames;\n        } // EDITOR CONSTRUCTOR\n\n\n        defineOptions(CodeMirror$1);\n        addEditorMethods(CodeMirror$1); // Set up methods on CodeMirror's prototype to redirect to the editor's document.\n\n        var dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\n\n        for (var prop in Doc.prototype) {\n          if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0) {\n            CodeMirror$1.prototype[prop] = function (method) {\n              return function () {\n                return method.apply(this.doc, arguments);\n              };\n            }(Doc.prototype[prop]);\n          }\n        }\n\n        eventMixin(Doc); // INPUT HANDLING\n\n        CodeMirror$1.inputStyles = {\n          \"textarea\": TextareaInput,\n          \"contenteditable\": ContentEditableInput\n        }; // MODE DEFINITION AND QUERYING\n        // Extra arguments are stored as the mode's dependencies, which is\n        // used by (legacy) mechanisms like loadmode.js to automatically\n        // load a mode. (Preferred mechanism is the require/define calls.)\n\n        CodeMirror$1.defineMode = function (name\n        /*, mode, …*/\n        ) {\n          if (!CodeMirror$1.defaults.mode && name != \"null\") {\n            CodeMirror$1.defaults.mode = name;\n          }\n\n          defineMode.apply(this, arguments);\n        };\n\n        CodeMirror$1.defineMIME = defineMIME; // Minimal default mode.\n\n        CodeMirror$1.defineMode(\"null\", function () {\n          return {\n            token: function (stream) {\n              return stream.skipToEnd();\n            }\n          };\n        });\n        CodeMirror$1.defineMIME(\"text/plain\", \"null\"); // EXTENSIONS\n\n        CodeMirror$1.defineExtension = function (name, func) {\n          CodeMirror$1.prototype[name] = func;\n        };\n\n        CodeMirror$1.defineDocExtension = function (name, func) {\n          Doc.prototype[name] = func;\n        };\n\n        CodeMirror$1.fromTextArea = fromTextArea;\n        addLegacyProps(CodeMirror$1);\n        CodeMirror$1.version = \"5.26.0\";\n        return CodeMirror$1;\n      });\n      /***/\n\n    },\n    /* 6 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      \"use strict\";\n      /* WEBPACK VAR INJECTION */\n\n      (function (process) {\n        /**\n        * Copyright 2014-2015, Facebook, Inc.\n        * All rights reserved.\n        *\n        * This source code is licensed under the BSD-style license found in the\n        * LICENSE file in the root directory of this source tree. An additional grant\n        * of patent rights can be found in the PATENTS file in the same directory.\n        *\n        */\n        var emptyFunction = __webpack_require__(1);\n        /**\n         * Similar to invariant but only logs a warning if the condition is not met.\n         * This can be used to log issues in development environments in critical\n         * paths. Removing the logging code for production environments will keep the\n         * same logic and follow the same code paths.\n         */\n\n\n        var warning = emptyFunction;\n\n        if (process.env.NODE_ENV !== 'production') {\n          (function () {\n            var printWarning = function printWarning(format) {\n              for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n                args[_key - 1] = arguments[_key];\n              }\n\n              var argIndex = 0;\n              var message = 'Warning: ' + format.replace(/%s/g, function () {\n                return args[argIndex++];\n              });\n\n              if (typeof console !== 'undefined') {\n                console.error(message);\n              }\n\n              try {\n                // --- Welcome to debugging React ---\n                // This error was thrown as a convenience so that you can use this stack\n                // to find the callsite that caused this warning to fire.\n                throw new Error(message);\n              } catch (x) {}\n            };\n\n            warning = function warning(condition, format) {\n              if (format === undefined) {\n                throw new Error('`warning(condition, format, ...args)` requires a warning ' + 'message argument');\n              }\n\n              if (format.indexOf('Failed Composite propType: ') === 0) {\n                return; // Ignore CompositeComponent proptype check.\n              }\n\n              if (!condition) {\n                for (var _len2 = arguments.length, args = Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n                  args[_key2 - 2] = arguments[_key2];\n                }\n\n                printWarning.apply(undefined, [format].concat(args));\n              }\n            };\n          })();\n        }\n\n        module.exports = warning;\n        /* WEBPACK VAR INJECTION */\n      }).call(exports, __webpack_require__(0));\n      /***/\n    },\n    /* 7 */\n\n    /***/\n    function (module, exports) {// removed by extract-text-webpack-plugin\n\n      /***/\n    },\n    /* 8 */\n\n    /***/\n    function (module, exports) {// removed by extract-text-webpack-plugin\n\n      /***/\n    },\n    /* 9 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      /* WEBPACK VAR INJECTION */\n      (function (process) {\n        /**\n        * Copyright 2013-present, Facebook, Inc.\n        * All rights reserved.\n        *\n        * This source code is licensed under the BSD-style license found in the\n        * LICENSE file in the root directory of this source tree. An additional grant\n        * of patent rights can be found in the PATENTS file in the same directory.\n        */\n        if (process.env.NODE_ENV !== 'production') {\n          var REACT_ELEMENT_TYPE = typeof Symbol === 'function' && Symbol.for && Symbol.for('react.element') || 0xeac7;\n\n          var isValidElement = function (object) {\n            return typeof object === 'object' && object !== null && object.$$typeof === REACT_ELEMENT_TYPE;\n          }; // By explicitly using `prop-types` you are opting into new development behavior.\n          // http://fb.me/prop-types-in-prod\n\n\n          var throwOnDirectAccess = true;\n          module.exports = __webpack_require__(15)(isValidElement, throwOnDirectAccess);\n        } else {\n          // By explicitly using `prop-types` you are opting into new production behavior.\n          // http://fb.me/prop-types-in-prod\n          module.exports = __webpack_require__(14)();\n        }\n        /* WEBPACK VAR INJECTION */\n\n      }).call(exports, __webpack_require__(0));\n      /***/\n    },\n    /* 10 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;\n      /**\n      * Super simple wysiwyg editor v0.8.3\n      * http://summernote.org/\n      *\n      * summernote.js\n      * Copyright 2013-2016 Alan Hong. and other contributors\n      * summernote may be freely distributed under the MIT license./\n      *\n      * Date: 2017-04-01T13:43Z\n      */\n\n\n      (function (factory) {\n        /* global define */\n        if (true) {\n          // AMD. Register as an anonymous module.\n          !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(4)], __WEBPACK_AMD_DEFINE_FACTORY__ = factory, __WEBPACK_AMD_DEFINE_RESULT__ = typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? __WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__) : __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n        } else if (typeof module === 'object' && module.exports) {\n          // Node/CommonJS\n          module.exports = factory(require('jquery'));\n        } else {\n          // Browser globals\n          factory(window.jQuery);\n        }\n      })(function ($) {\n        'use strict';\n        /**\n         * @class core.func\n         *\n         * func utils (for high-order func's arg)\n         *\n         * @singleton\n         * @alternateClassName func\n         */\n\n        var func = function () {\n          var eq = function (itemA) {\n            return function (itemB) {\n              return itemA === itemB;\n            };\n          };\n\n          var eq2 = function (itemA, itemB) {\n            return itemA === itemB;\n          };\n\n          var peq2 = function (propName) {\n            return function (itemA, itemB) {\n              return itemA[propName] === itemB[propName];\n            };\n          };\n\n          var ok = function () {\n            return true;\n          };\n\n          var fail = function () {\n            return false;\n          };\n\n          var not = function (f) {\n            return function () {\n              return !f.apply(f, arguments);\n            };\n          };\n\n          var and = function (fA, fB) {\n            return function (item) {\n              return fA(item) && fB(item);\n            };\n          };\n\n          var self = function (a) {\n            return a;\n          };\n\n          var invoke = function (obj, method) {\n            return function () {\n              return obj[method].apply(obj, arguments);\n            };\n          };\n\n          var idCounter = 0;\n          /**\n           * generate a globally-unique id\n           *\n           * @param {String} [prefix]\n           */\n\n          var uniqueId = function (prefix) {\n            var id = ++idCounter + '';\n            return prefix ? prefix + id : id;\n          };\n          /**\n           * returns bnd (bounds) from rect\n           *\n           * - IE Compatibility Issue: http://goo.gl/sRLOAo\n           * - Scroll Issue: http://goo.gl/sNjUc\n           *\n           * @param {Rect} rect\n           * @return {Object} bounds\n           * @return {Number} bounds.top\n           * @return {Number} bounds.left\n           * @return {Number} bounds.width\n           * @return {Number} bounds.height\n           */\n\n\n          var rect2bnd = function (rect) {\n            var $document = $(document);\n            return {\n              top: rect.top + $document.scrollTop(),\n              left: rect.left + $document.scrollLeft(),\n              width: rect.right - rect.left,\n              height: rect.bottom - rect.top\n            };\n          };\n          /**\n           * returns a copy of the object where the keys have become the values and the values the keys.\n           * @param {Object} obj\n           * @return {Object}\n           */\n\n\n          var invertObject = function (obj) {\n            var inverted = {};\n\n            for (var key in obj) {\n              if (obj.hasOwnProperty(key)) {\n                inverted[obj[key]] = key;\n              }\n            }\n\n            return inverted;\n          };\n          /**\n           * @param {String} namespace\n           * @param {String} [prefix]\n           * @return {String}\n           */\n\n\n          var namespaceToCamel = function (namespace, prefix) {\n            prefix = prefix || '';\n            return prefix + namespace.split('.').map(function (name) {\n              return name.substring(0, 1).toUpperCase() + name.substring(1);\n            }).join('');\n          };\n          /**\n           * Returns a function, that, as long as it continues to be invoked, will not\n           * be triggered. The function will be called after it stops being called for\n           * N milliseconds. If `immediate` is passed, trigger the function on the\n           * leading edge, instead of the trailing.\n           * @param {Function} func\n           * @param {Number} wait\n           * @param {Boolean} immediate\n           * @return {Function}\n           */\n\n\n          var debounce = function (func, wait, immediate) {\n            var timeout;\n            return function () {\n              var context = this,\n                  args = arguments;\n\n              var later = function () {\n                timeout = null;\n\n                if (!immediate) {\n                  func.apply(context, args);\n                }\n              };\n\n              var callNow = immediate && !timeout;\n              clearTimeout(timeout);\n              timeout = setTimeout(later, wait);\n\n              if (callNow) {\n                func.apply(context, args);\n              }\n            };\n          };\n\n          return {\n            eq: eq,\n            eq2: eq2,\n            peq2: peq2,\n            ok: ok,\n            fail: fail,\n            self: self,\n            not: not,\n            and: and,\n            invoke: invoke,\n            uniqueId: uniqueId,\n            rect2bnd: rect2bnd,\n            invertObject: invertObject,\n            namespaceToCamel: namespaceToCamel,\n            debounce: debounce\n          };\n        }();\n        /**\n         * @class core.list\n         *\n         * list utils\n         *\n         * @singleton\n         * @alternateClassName list\n         */\n\n\n        var list = function () {\n          /**\n           * returns the first item of an array.\n           *\n           * @param {Array} array\n           */\n          var head = function (array) {\n            return array[0];\n          };\n          /**\n           * returns the last item of an array.\n           *\n           * @param {Array} array\n           */\n\n\n          var last = function (array) {\n            return array[array.length - 1];\n          };\n          /**\n           * returns everything but the last entry of the array.\n           *\n           * @param {Array} array\n           */\n\n\n          var initial = function (array) {\n            return array.slice(0, array.length - 1);\n          };\n          /**\n           * returns the rest of the items in an array.\n           *\n           * @param {Array} array\n           */\n\n\n          var tail = function (array) {\n            return array.slice(1);\n          };\n          /**\n           * returns item of array\n           */\n\n\n          var find = function (array, pred) {\n            for (var idx = 0, len = array.length; idx < len; idx++) {\n              var item = array[idx];\n\n              if (pred(item)) {\n                return item;\n              }\n            }\n          };\n          /**\n           * returns true if all of the values in the array pass the predicate truth test.\n           */\n\n\n          var all = function (array, pred) {\n            for (var idx = 0, len = array.length; idx < len; idx++) {\n              if (!pred(array[idx])) {\n                return false;\n              }\n            }\n\n            return true;\n          };\n          /**\n           * returns index of item\n           */\n\n\n          var indexOf = function (array, item) {\n            return $.inArray(item, array);\n          };\n          /**\n           * returns true if the value is present in the list.\n           */\n\n\n          var contains = function (array, item) {\n            return indexOf(array, item) !== -1;\n          };\n          /**\n           * get sum from a list\n           *\n           * @param {Array} array - array\n           * @param {Function} fn - iterator\n           */\n\n\n          var sum = function (array, fn) {\n            fn = fn || func.self;\n            return array.reduce(function (memo, v) {\n              return memo + fn(v);\n            }, 0);\n          };\n          /**\n           * returns a copy of the collection with array type.\n           * @param {Collection} collection - collection eg) node.childNodes, ...\n           */\n\n\n          var from = function (collection) {\n            var result = [],\n                idx = -1,\n                length = collection.length;\n\n            while (++idx < length) {\n              result[idx] = collection[idx];\n            }\n\n            return result;\n          };\n          /**\n           * returns whether list is empty or not\n           */\n\n\n          var isEmpty = function (array) {\n            return !array || !array.length;\n          };\n          /**\n           * cluster elements by predicate function.\n           *\n           * @param {Array} array - array\n           * @param {Function} fn - predicate function for cluster rule\n           * @param {Array[]}\n           */\n\n\n          var clusterBy = function (array, fn) {\n            if (!array.length) {\n              return [];\n            }\n\n            var aTail = tail(array);\n            return aTail.reduce(function (memo, v) {\n              var aLast = last(memo);\n\n              if (fn(last(aLast), v)) {\n                aLast[aLast.length] = v;\n              } else {\n                memo[memo.length] = [v];\n              }\n\n              return memo;\n            }, [[head(array)]]);\n          };\n          /**\n           * returns a copy of the array with all false values removed\n           *\n           * @param {Array} array - array\n           * @param {Function} fn - predicate function for cluster rule\n           */\n\n\n          var compact = function (array) {\n            var aResult = [];\n\n            for (var idx = 0, len = array.length; idx < len; idx++) {\n              if (array[idx]) {\n                aResult.push(array[idx]);\n              }\n            }\n\n            return aResult;\n          };\n          /**\n           * produces a duplicate-free version of the array\n           *\n           * @param {Array} array\n           */\n\n\n          var unique = function (array) {\n            var results = [];\n\n            for (var idx = 0, len = array.length; idx < len; idx++) {\n              if (!contains(results, array[idx])) {\n                results.push(array[idx]);\n              }\n            }\n\n            return results;\n          };\n          /**\n           * returns next item.\n           * @param {Array} array\n           */\n\n\n          var next = function (array, item) {\n            var idx = indexOf(array, item);\n\n            if (idx === -1) {\n              return null;\n            }\n\n            return array[idx + 1];\n          };\n          /**\n           * returns prev item.\n           * @param {Array} array\n           */\n\n\n          var prev = function (array, item) {\n            var idx = indexOf(array, item);\n\n            if (idx === -1) {\n              return null;\n            }\n\n            return array[idx - 1];\n          };\n\n          return {\n            head: head,\n            last: last,\n            initial: initial,\n            tail: tail,\n            prev: prev,\n            next: next,\n            find: find,\n            contains: contains,\n            all: all,\n            sum: sum,\n            from: from,\n            isEmpty: isEmpty,\n            clusterBy: clusterBy,\n            compact: compact,\n            unique: unique\n          };\n        }();\n\n        var isSupportAmd = \"function\" === 'function' && __webpack_require__(16);\n        /**\n         * returns whether font is installed or not.\n         *\n         * @param {String} fontName\n         * @return {Boolean}\n         */\n\n\n        var isFontInstalled = function (fontName) {\n          var testFontName = fontName === 'Comic Sans MS' ? 'Courier New' : 'Comic Sans MS';\n          var $tester = $('<div>').css({\n            position: 'absolute',\n            left: '-9999px',\n            top: '-9999px',\n            fontSize: '200px'\n          }).text('mmmmmmmmmwwwwwww').appendTo(document.body);\n          var originalWidth = $tester.css('fontFamily', testFontName).width();\n          var width = $tester.css('fontFamily', fontName + ',' + testFontName).width();\n          $tester.remove();\n          return originalWidth !== width;\n        };\n\n        var userAgent = navigator.userAgent;\n        var isMSIE = /MSIE|Trident/i.test(userAgent);\n        var browserVersion;\n\n        if (isMSIE) {\n          var matches = /MSIE (\\d+[.]\\d+)/.exec(userAgent);\n\n          if (matches) {\n            browserVersion = parseFloat(matches[1]);\n          }\n\n          matches = /Trident\\/.*rv:([0-9]{1,}[\\.0-9]{0,})/.exec(userAgent);\n\n          if (matches) {\n            browserVersion = parseFloat(matches[1]);\n          }\n        }\n\n        var isEdge = /Edge\\/\\d+/.test(userAgent);\n        var hasCodeMirror = !!window.CodeMirror;\n\n        if (!hasCodeMirror && isSupportAmd && \"function\" !== 'undefined') {\n          if (true) {\n            try {\n              // If CodeMirror can't be resolved, `require.resolve` will throw an\n              // exception and `hasCodeMirror` won't be set to `true`.\n\n              /*require.resolve*/\n              5;\n              hasCodeMirror = true;\n            } catch (e) {// Do nothing.\n            }\n          } else if (typeof eval('require').specified !== 'undefined') {\n            hasCodeMirror = eval('require').specified('codemirror');\n          }\n        }\n        /**\n         * @class core.agent\n         *\n         * Object which check platform and agent\n         *\n         * @singleton\n         * @alternateClassName agent\n         */\n\n\n        var agent = {\n          isMac: navigator.appVersion.indexOf('Mac') > -1,\n          isMSIE: isMSIE,\n          isEdge: isEdge,\n          isFF: !isEdge && /firefox/i.test(userAgent),\n          isPhantom: /PhantomJS/i.test(userAgent),\n          isWebkit: !isEdge && /webkit/i.test(userAgent),\n          isChrome: !isEdge && /chrome/i.test(userAgent),\n          isSafari: !isEdge && /safari/i.test(userAgent),\n          browserVersion: browserVersion,\n          jqueryVersion: parseFloat($.fn.jquery),\n          isSupportAmd: isSupportAmd,\n          hasCodeMirror: hasCodeMirror,\n          isFontInstalled: isFontInstalled,\n          isW3CRangeSupport: !!document.createRange\n        };\n        var NBSP_CHAR = String.fromCharCode(160);\n        var ZERO_WIDTH_NBSP_CHAR = '\\ufeff';\n        /**\n         * @class core.dom\n         *\n         * Dom functions\n         *\n         * @singleton\n         * @alternateClassName dom\n         */\n\n        var dom = function () {\n          /**\n           * @method isEditable\n           *\n           * returns whether node is `note-editable` or not.\n           *\n           * @param {Node} node\n           * @return {Boolean}\n           */\n          var isEditable = function (node) {\n            return node && $(node).hasClass('note-editable');\n          };\n          /**\n           * @method isControlSizing\n           *\n           * returns whether node is `note-control-sizing` or not.\n           *\n           * @param {Node} node\n           * @return {Boolean}\n           */\n\n\n          var isControlSizing = function (node) {\n            return node && $(node).hasClass('note-control-sizing');\n          };\n          /**\n           * @method makePredByNodeName\n           *\n           * returns predicate which judge whether nodeName is same\n           *\n           * @param {String} nodeName\n           * @return {Function}\n           */\n\n\n          var makePredByNodeName = function (nodeName) {\n            nodeName = nodeName.toUpperCase();\n            return function (node) {\n              return node && node.nodeName.toUpperCase() === nodeName;\n            };\n          };\n          /**\n           * @method isText\n           *\n           *\n           *\n           * @param {Node} node\n           * @return {Boolean} true if node's type is text(3)\n           */\n\n\n          var isText = function (node) {\n            return node && node.nodeType === 3;\n          };\n          /**\n           * @method isElement\n           *\n           *\n           *\n           * @param {Node} node\n           * @return {Boolean} true if node's type is element(1)\n           */\n\n\n          var isElement = function (node) {\n            return node && node.nodeType === 1;\n          };\n          /**\n           * ex) br, col, embed, hr, img, input, ...\n           * @see http://www.w3.org/html/wg/drafts/html/master/syntax.html#void-elements\n           */\n\n\n          var isVoid = function (node) {\n            return node && /^BR|^IMG|^HR|^IFRAME|^BUTTON/.test(node.nodeName.toUpperCase());\n          };\n\n          var isPara = function (node) {\n            if (isEditable(node)) {\n              return false;\n            } // Chrome(v31.0), FF(v25.0.1) use DIV for paragraph\n\n\n            return node && /^DIV|^P|^LI|^H[1-7]/.test(node.nodeName.toUpperCase());\n          };\n\n          var isHeading = function (node) {\n            return node && /^H[1-7]/.test(node.nodeName.toUpperCase());\n          };\n\n          var isPre = makePredByNodeName('PRE');\n          var isLi = makePredByNodeName('LI');\n\n          var isPurePara = function (node) {\n            return isPara(node) && !isLi(node);\n          };\n\n          var isTable = makePredByNodeName('TABLE');\n          var isData = makePredByNodeName('DATA');\n\n          var isInline = function (node) {\n            return !isBodyContainer(node) && !isList(node) && !isHr(node) && !isPara(node) && !isTable(node) && !isBlockquote(node) && !isData(node);\n          };\n\n          var isList = function (node) {\n            return node && /^UL|^OL/.test(node.nodeName.toUpperCase());\n          };\n\n          var isHr = makePredByNodeName('HR');\n\n          var isCell = function (node) {\n            return node && /^TD|^TH/.test(node.nodeName.toUpperCase());\n          };\n\n          var isBlockquote = makePredByNodeName('BLOCKQUOTE');\n\n          var isBodyContainer = function (node) {\n            return isCell(node) || isBlockquote(node) || isEditable(node);\n          };\n\n          var isAnchor = makePredByNodeName('A');\n\n          var isParaInline = function (node) {\n            return isInline(node) && !!ancestor(node, isPara);\n          };\n\n          var isBodyInline = function (node) {\n            return isInline(node) && !ancestor(node, isPara);\n          };\n\n          var isBody = makePredByNodeName('BODY');\n          /**\n           * returns whether nodeB is closest sibling of nodeA\n           *\n           * @param {Node} nodeA\n           * @param {Node} nodeB\n           * @return {Boolean}\n           */\n\n          var isClosestSibling = function (nodeA, nodeB) {\n            return nodeA.nextSibling === nodeB || nodeA.previousSibling === nodeB;\n          };\n          /**\n           * returns array of closest siblings with node\n           *\n           * @param {Node} node\n           * @param {function} [pred] - predicate function\n           * @return {Node[]}\n           */\n\n\n          var withClosestSiblings = function (node, pred) {\n            pred = pred || func.ok;\n            var siblings = [];\n\n            if (node.previousSibling && pred(node.previousSibling)) {\n              siblings.push(node.previousSibling);\n            }\n\n            siblings.push(node);\n\n            if (node.nextSibling && pred(node.nextSibling)) {\n              siblings.push(node.nextSibling);\n            }\n\n            return siblings;\n          };\n          /**\n           * blank HTML for cursor position\n           * - [workaround] old IE only works with &nbsp;\n           * - [workaround] IE11 and other browser works with bogus br\n           */\n\n\n          var blankHTML = agent.isMSIE && agent.browserVersion < 11 ? '&nbsp;' : '<br>';\n          /**\n           * @method nodeLength\n           *\n           * returns #text's text size or element's childNodes size\n           *\n           * @param {Node} node\n           */\n\n          var nodeLength = function (node) {\n            if (isText(node)) {\n              return node.nodeValue.length;\n            }\n\n            if (node) {\n              return node.childNodes.length;\n            }\n\n            return 0;\n          };\n          /**\n           * returns whether node is empty or not.\n           *\n           * @param {Node} node\n           * @return {Boolean}\n           */\n\n\n          var isEmpty = function (node) {\n            var len = nodeLength(node);\n\n            if (len === 0) {\n              return true;\n            } else if (!isText(node) && len === 1 && node.innerHTML === blankHTML) {\n              // ex) <p><br></p>, <span><br></span>\n              return true;\n            } else if (list.all(node.childNodes, isText) && node.innerHTML === '') {\n              // ex) <p></p>, <span></span>\n              return true;\n            }\n\n            return false;\n          };\n          /**\n           * padding blankHTML if node is empty (for cursor position)\n           */\n\n\n          var paddingBlankHTML = function (node) {\n            if (!isVoid(node) && !nodeLength(node)) {\n              node.innerHTML = blankHTML;\n            }\n          };\n          /**\n           * find nearest ancestor predicate hit\n           *\n           * @param {Node} node\n           * @param {Function} pred - predicate function\n           */\n\n\n          var ancestor = function (node, pred) {\n            while (node) {\n              if (pred(node)) {\n                return node;\n              }\n\n              if (isEditable(node)) {\n                break;\n              }\n\n              node = node.parentNode;\n            }\n\n            return null;\n          };\n          /**\n           * find nearest ancestor only single child blood line and predicate hit\n           *\n           * @param {Node} node\n           * @param {Function} pred - predicate function\n           */\n\n\n          var singleChildAncestor = function (node, pred) {\n            node = node.parentNode;\n\n            while (node) {\n              if (nodeLength(node) !== 1) {\n                break;\n              }\n\n              if (pred(node)) {\n                return node;\n              }\n\n              if (isEditable(node)) {\n                break;\n              }\n\n              node = node.parentNode;\n            }\n\n            return null;\n          };\n          /**\n           * returns new array of ancestor nodes (until predicate hit).\n           *\n           * @param {Node} node\n           * @param {Function} [optional] pred - predicate function\n           */\n\n\n          var listAncestor = function (node, pred) {\n            pred = pred || func.fail;\n            var ancestors = [];\n            ancestor(node, function (el) {\n              if (!isEditable(el)) {\n                ancestors.push(el);\n              }\n\n              return pred(el);\n            });\n            return ancestors;\n          };\n          /**\n           * find farthest ancestor predicate hit\n           */\n\n\n          var lastAncestor = function (node, pred) {\n            var ancestors = listAncestor(node);\n            return list.last(ancestors.filter(pred));\n          };\n          /**\n           * returns common ancestor node between two nodes.\n           *\n           * @param {Node} nodeA\n           * @param {Node} nodeB\n           */\n\n\n          var commonAncestor = function (nodeA, nodeB) {\n            var ancestors = listAncestor(nodeA);\n\n            for (var n = nodeB; n; n = n.parentNode) {\n              if ($.inArray(n, ancestors) > -1) {\n                return n;\n              }\n            }\n\n            return null; // difference document area\n          };\n          /**\n           * listing all previous siblings (until predicate hit).\n           *\n           * @param {Node} node\n           * @param {Function} [optional] pred - predicate function\n           */\n\n\n          var listPrev = function (node, pred) {\n            pred = pred || func.fail;\n            var nodes = [];\n\n            while (node) {\n              if (pred(node)) {\n                break;\n              }\n\n              nodes.push(node);\n              node = node.previousSibling;\n            }\n\n            return nodes;\n          };\n          /**\n           * listing next siblings (until predicate hit).\n           *\n           * @param {Node} node\n           * @param {Function} [pred] - predicate function\n           */\n\n\n          var listNext = function (node, pred) {\n            pred = pred || func.fail;\n            var nodes = [];\n\n            while (node) {\n              if (pred(node)) {\n                break;\n              }\n\n              nodes.push(node);\n              node = node.nextSibling;\n            }\n\n            return nodes;\n          };\n          /**\n           * listing descendant nodes\n           *\n           * @param {Node} node\n           * @param {Function} [pred] - predicate function\n           */\n\n\n          var listDescendant = function (node, pred) {\n            var descendants = [];\n            pred = pred || func.ok; // start DFS(depth first search) with node\n\n            (function fnWalk(current) {\n              if (node !== current && pred(current)) {\n                descendants.push(current);\n              }\n\n              for (var idx = 0, len = current.childNodes.length; idx < len; idx++) {\n                fnWalk(current.childNodes[idx]);\n              }\n            })(node);\n\n            return descendants;\n          };\n          /**\n           * wrap node with new tag.\n           *\n           * @param {Node} node\n           * @param {Node} tagName of wrapper\n           * @return {Node} - wrapper\n           */\n\n\n          var wrap = function (node, wrapperName) {\n            var parent = node.parentNode;\n            var wrapper = $('<' + wrapperName + '>')[0];\n            parent.insertBefore(wrapper, node);\n            wrapper.appendChild(node);\n            return wrapper;\n          };\n          /**\n           * insert node after preceding\n           *\n           * @param {Node} node\n           * @param {Node} preceding - predicate function\n           */\n\n\n          var insertAfter = function (node, preceding) {\n            var next = preceding.nextSibling,\n                parent = preceding.parentNode;\n\n            if (next) {\n              parent.insertBefore(node, next);\n            } else {\n              parent.appendChild(node);\n            }\n\n            return node;\n          };\n          /**\n           * append elements.\n           *\n           * @param {Node} node\n           * @param {Collection} aChild\n           */\n\n\n          var appendChildNodes = function (node, aChild) {\n            $.each(aChild, function (idx, child) {\n              node.appendChild(child);\n            });\n            return node;\n          };\n          /**\n           * returns whether boundaryPoint is left edge or not.\n           *\n           * @param {BoundaryPoint} point\n           * @return {Boolean}\n           */\n\n\n          var isLeftEdgePoint = function (point) {\n            return point.offset === 0;\n          };\n          /**\n           * returns whether boundaryPoint is right edge or not.\n           *\n           * @param {BoundaryPoint} point\n           * @return {Boolean}\n           */\n\n\n          var isRightEdgePoint = function (point) {\n            return point.offset === nodeLength(point.node);\n          };\n          /**\n           * returns whether boundaryPoint is edge or not.\n           *\n           * @param {BoundaryPoint} point\n           * @return {Boolean}\n           */\n\n\n          var isEdgePoint = function (point) {\n            return isLeftEdgePoint(point) || isRightEdgePoint(point);\n          };\n          /**\n           * returns whether node is left edge of ancestor or not.\n           *\n           * @param {Node} node\n           * @param {Node} ancestor\n           * @return {Boolean}\n           */\n\n\n          var isLeftEdgeOf = function (node, ancestor) {\n            while (node && node !== ancestor) {\n              if (position(node) !== 0) {\n                return false;\n              }\n\n              node = node.parentNode;\n            }\n\n            return true;\n          };\n          /**\n           * returns whether node is right edge of ancestor or not.\n           *\n           * @param {Node} node\n           * @param {Node} ancestor\n           * @return {Boolean}\n           */\n\n\n          var isRightEdgeOf = function (node, ancestor) {\n            if (!ancestor) {\n              return false;\n            }\n\n            while (node && node !== ancestor) {\n              if (position(node) !== nodeLength(node.parentNode) - 1) {\n                return false;\n              }\n\n              node = node.parentNode;\n            }\n\n            return true;\n          };\n          /**\n           * returns whether point is left edge of ancestor or not.\n           * @param {BoundaryPoint} point\n           * @param {Node} ancestor\n           * @return {Boolean}\n           */\n\n\n          var isLeftEdgePointOf = function (point, ancestor) {\n            return isLeftEdgePoint(point) && isLeftEdgeOf(point.node, ancestor);\n          };\n          /**\n           * returns whether point is right edge of ancestor or not.\n           * @param {BoundaryPoint} point\n           * @param {Node} ancestor\n           * @return {Boolean}\n           */\n\n\n          var isRightEdgePointOf = function (point, ancestor) {\n            return isRightEdgePoint(point) && isRightEdgeOf(point.node, ancestor);\n          };\n          /**\n           * returns offset from parent.\n           *\n           * @param {Node} node\n           */\n\n\n          var position = function (node) {\n            var offset = 0;\n\n            while (node = node.previousSibling) {\n              offset += 1;\n            }\n\n            return offset;\n          };\n\n          var hasChildren = function (node) {\n            return !!(node && node.childNodes && node.childNodes.length);\n          };\n          /**\n           * returns previous boundaryPoint\n           *\n           * @param {BoundaryPoint} point\n           * @param {Boolean} isSkipInnerOffset\n           * @return {BoundaryPoint}\n           */\n\n\n          var prevPoint = function (point, isSkipInnerOffset) {\n            var node, offset;\n\n            if (point.offset === 0) {\n              if (isEditable(point.node)) {\n                return null;\n              }\n\n              node = point.node.parentNode;\n              offset = position(point.node);\n            } else if (hasChildren(point.node)) {\n              node = point.node.childNodes[point.offset - 1];\n              offset = nodeLength(node);\n            } else {\n              node = point.node;\n              offset = isSkipInnerOffset ? 0 : point.offset - 1;\n            }\n\n            return {\n              node: node,\n              offset: offset\n            };\n          };\n          /**\n           * returns next boundaryPoint\n           *\n           * @param {BoundaryPoint} point\n           * @param {Boolean} isSkipInnerOffset\n           * @return {BoundaryPoint}\n           */\n\n\n          var nextPoint = function (point, isSkipInnerOffset) {\n            var node, offset;\n\n            if (nodeLength(point.node) === point.offset) {\n              if (isEditable(point.node)) {\n                return null;\n              }\n\n              node = point.node.parentNode;\n              offset = position(point.node) + 1;\n            } else if (hasChildren(point.node)) {\n              node = point.node.childNodes[point.offset];\n              offset = 0;\n            } else {\n              node = point.node;\n              offset = isSkipInnerOffset ? nodeLength(point.node) : point.offset + 1;\n            }\n\n            return {\n              node: node,\n              offset: offset\n            };\n          };\n          /**\n           * returns whether pointA and pointB is same or not.\n           *\n           * @param {BoundaryPoint} pointA\n           * @param {BoundaryPoint} pointB\n           * @return {Boolean}\n           */\n\n\n          var isSamePoint = function (pointA, pointB) {\n            return pointA.node === pointB.node && pointA.offset === pointB.offset;\n          };\n          /**\n           * returns whether point is visible (can set cursor) or not.\n           *\n           * @param {BoundaryPoint} point\n           * @return {Boolean}\n           */\n\n\n          var isVisiblePoint = function (point) {\n            if (isText(point.node) || !hasChildren(point.node) || isEmpty(point.node)) {\n              return true;\n            }\n\n            var leftNode = point.node.childNodes[point.offset - 1];\n            var rightNode = point.node.childNodes[point.offset];\n\n            if ((!leftNode || isVoid(leftNode)) && (!rightNode || isVoid(rightNode))) {\n              return true;\n            }\n\n            return false;\n          };\n          /**\n           * @method prevPointUtil\n           *\n           * @param {BoundaryPoint} point\n           * @param {Function} pred\n           * @return {BoundaryPoint}\n           */\n\n\n          var prevPointUntil = function (point, pred) {\n            while (point) {\n              if (pred(point)) {\n                return point;\n              }\n\n              point = prevPoint(point);\n            }\n\n            return null;\n          };\n          /**\n           * @method nextPointUntil\n           *\n           * @param {BoundaryPoint} point\n           * @param {Function} pred\n           * @return {BoundaryPoint}\n           */\n\n\n          var nextPointUntil = function (point, pred) {\n            while (point) {\n              if (pred(point)) {\n                return point;\n              }\n\n              point = nextPoint(point);\n            }\n\n            return null;\n          };\n          /**\n           * returns whether point has character or not.\n           *\n           * @param {Point} point\n           * @return {Boolean}\n           */\n\n\n          var isCharPoint = function (point) {\n            if (!isText(point.node)) {\n              return false;\n            }\n\n            var ch = point.node.nodeValue.charAt(point.offset - 1);\n            return ch && ch !== ' ' && ch !== NBSP_CHAR;\n          };\n          /**\n           * @method walkPoint\n           *\n           * @param {BoundaryPoint} startPoint\n           * @param {BoundaryPoint} endPoint\n           * @param {Function} handler\n           * @param {Boolean} isSkipInnerOffset\n           */\n\n\n          var walkPoint = function (startPoint, endPoint, handler, isSkipInnerOffset) {\n            var point = startPoint;\n\n            while (point) {\n              handler(point);\n\n              if (isSamePoint(point, endPoint)) {\n                break;\n              }\n\n              var isSkipOffset = isSkipInnerOffset && startPoint.node !== point.node && endPoint.node !== point.node;\n              point = nextPoint(point, isSkipOffset);\n            }\n          };\n          /**\n           * @method makeOffsetPath\n           *\n           * return offsetPath(array of offset) from ancestor\n           *\n           * @param {Node} ancestor - ancestor node\n           * @param {Node} node\n           */\n\n\n          var makeOffsetPath = function (ancestor, node) {\n            var ancestors = listAncestor(node, func.eq(ancestor));\n            return ancestors.map(position).reverse();\n          };\n          /**\n           * @method fromOffsetPath\n           *\n           * return element from offsetPath(array of offset)\n           *\n           * @param {Node} ancestor - ancestor node\n           * @param {array} offsets - offsetPath\n           */\n\n\n          var fromOffsetPath = function (ancestor, offsets) {\n            var current = ancestor;\n\n            for (var i = 0, len = offsets.length; i < len; i++) {\n              if (current.childNodes.length <= offsets[i]) {\n                current = current.childNodes[current.childNodes.length - 1];\n              } else {\n                current = current.childNodes[offsets[i]];\n              }\n            }\n\n            return current;\n          };\n          /**\n           * @method splitNode\n           *\n           * split element or #text\n           *\n           * @param {BoundaryPoint} point\n           * @param {Object} [options]\n           * @param {Boolean} [options.isSkipPaddingBlankHTML] - default: false\n           * @param {Boolean} [options.isNotSplitEdgePoint] - default: false\n           * @return {Node} right node of boundaryPoint\n           */\n\n\n          var splitNode = function (point, options) {\n            var isSkipPaddingBlankHTML = options && options.isSkipPaddingBlankHTML;\n            var isNotSplitEdgePoint = options && options.isNotSplitEdgePoint; // edge case\n\n            if (isEdgePoint(point) && (isText(point.node) || isNotSplitEdgePoint)) {\n              if (isLeftEdgePoint(point)) {\n                return point.node;\n              } else if (isRightEdgePoint(point)) {\n                return point.node.nextSibling;\n              }\n            } // split #text\n\n\n            if (isText(point.node)) {\n              return point.node.splitText(point.offset);\n            } else {\n              var childNode = point.node.childNodes[point.offset];\n              var clone = insertAfter(point.node.cloneNode(false), point.node);\n              appendChildNodes(clone, listNext(childNode));\n\n              if (!isSkipPaddingBlankHTML) {\n                paddingBlankHTML(point.node);\n                paddingBlankHTML(clone);\n              }\n\n              return clone;\n            }\n          };\n          /**\n           * @method splitTree\n           *\n           * split tree by point\n           *\n           * @param {Node} root - split root\n           * @param {BoundaryPoint} point\n           * @param {Object} [options]\n           * @param {Boolean} [options.isSkipPaddingBlankHTML] - default: false\n           * @param {Boolean} [options.isNotSplitEdgePoint] - default: false\n           * @return {Node} right node of boundaryPoint\n           */\n\n\n          var splitTree = function (root, point, options) {\n            // ex) [#text, <span>, <p>]\n            var ancestors = listAncestor(point.node, func.eq(root));\n\n            if (!ancestors.length) {\n              return null;\n            } else if (ancestors.length === 1) {\n              return splitNode(point, options);\n            }\n\n            return ancestors.reduce(function (node, parent) {\n              if (node === point.node) {\n                node = splitNode(point, options);\n              }\n\n              return splitNode({\n                node: parent,\n                offset: node ? dom.position(node) : nodeLength(parent)\n              }, options);\n            });\n          };\n          /**\n           * split point\n           *\n           * @param {Point} point\n           * @param {Boolean} isInline\n           * @return {Object}\n           */\n\n\n          var splitPoint = function (point, isInline) {\n            // find splitRoot, container\n            //  - inline: splitRoot is a child of paragraph\n            //  - block: splitRoot is a child of bodyContainer\n            var pred = isInline ? isPara : isBodyContainer;\n            var ancestors = listAncestor(point.node, pred);\n            var topAncestor = list.last(ancestors) || point.node;\n            var splitRoot, container;\n\n            if (pred(topAncestor)) {\n              splitRoot = ancestors[ancestors.length - 2];\n              container = topAncestor;\n            } else {\n              splitRoot = topAncestor;\n              container = splitRoot.parentNode;\n            } // if splitRoot is exists, split with splitTree\n\n\n            var pivot = splitRoot && splitTree(splitRoot, point, {\n              isSkipPaddingBlankHTML: isInline,\n              isNotSplitEdgePoint: isInline\n            }); // if container is point.node, find pivot with point.offset\n\n            if (!pivot && container === point.node) {\n              pivot = point.node.childNodes[point.offset];\n            }\n\n            return {\n              rightNode: pivot,\n              container: container\n            };\n          };\n\n          var create = function (nodeName) {\n            return document.createElement(nodeName);\n          };\n\n          var createText = function (text) {\n            return document.createTextNode(text);\n          };\n          /**\n           * @method remove\n           *\n           * remove node, (isRemoveChild: remove child or not)\n           *\n           * @param {Node} node\n           * @param {Boolean} isRemoveChild\n           */\n\n\n          var remove = function (node, isRemoveChild) {\n            if (!node || !node.parentNode) {\n              return;\n            }\n\n            if (node.removeNode) {\n              return node.removeNode(isRemoveChild);\n            }\n\n            var parent = node.parentNode;\n\n            if (!isRemoveChild) {\n              var nodes = [];\n              var i, len;\n\n              for (i = 0, len = node.childNodes.length; i < len; i++) {\n                nodes.push(node.childNodes[i]);\n              }\n\n              for (i = 0, len = nodes.length; i < len; i++) {\n                parent.insertBefore(nodes[i], node);\n              }\n            }\n\n            parent.removeChild(node);\n          };\n          /**\n           * @method removeWhile\n           *\n           * @param {Node} node\n           * @param {Function} pred\n           */\n\n\n          var removeWhile = function (node, pred) {\n            while (node) {\n              if (isEditable(node) || !pred(node)) {\n                break;\n              }\n\n              var parent = node.parentNode;\n              remove(node);\n              node = parent;\n            }\n          };\n          /**\n           * @method replace\n           *\n           * replace node with provided nodeName\n           *\n           * @param {Node} node\n           * @param {String} nodeName\n           * @return {Node} - new node\n           */\n\n\n          var replace = function (node, nodeName) {\n            if (node.nodeName.toUpperCase() === nodeName.toUpperCase()) {\n              return node;\n            }\n\n            var newNode = create(nodeName);\n\n            if (node.style.cssText) {\n              newNode.style.cssText = node.style.cssText;\n            }\n\n            appendChildNodes(newNode, list.from(node.childNodes));\n            insertAfter(newNode, node);\n            remove(node);\n            return newNode;\n          };\n\n          var isTextarea = makePredByNodeName('TEXTAREA');\n          /**\n           * @param {jQuery} $node\n           * @param {Boolean} [stripLinebreaks] - default: false\n           */\n\n          var value = function ($node, stripLinebreaks) {\n            var val = isTextarea($node[0]) ? $node.val() : $node.html();\n\n            if (stripLinebreaks) {\n              return val.replace(/[\\n\\r]/g, '');\n            }\n\n            return val;\n          };\n          /**\n           * @method html\n           *\n           * get the HTML contents of node\n           *\n           * @param {jQuery} $node\n           * @param {Boolean} [isNewlineOnBlock]\n           */\n\n\n          var html = function ($node, isNewlineOnBlock) {\n            var markup = value($node);\n\n            if (isNewlineOnBlock) {\n              var regexTag = /<(\\/?)(\\b(?!!)[^>\\s]*)(.*?)(\\s*\\/?>)/g;\n              markup = markup.replace(regexTag, function (match, endSlash, name) {\n                name = name.toUpperCase();\n                var isEndOfInlineContainer = /^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(name) && !!endSlash;\n                var isBlockNode = /^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(name);\n                return match + (isEndOfInlineContainer || isBlockNode ? '\\n' : '');\n              });\n              markup = $.trim(markup);\n            }\n\n            return markup;\n          };\n\n          var posFromPlaceholder = function (placeholder) {\n            var $placeholder = $(placeholder);\n            var pos = $placeholder.offset();\n            var height = $placeholder.outerHeight(true); // include margin\n\n            return {\n              left: pos.left,\n              top: pos.top + height\n            };\n          };\n\n          var attachEvents = function ($node, events) {\n            Object.keys(events).forEach(function (key) {\n              $node.on(key, events[key]);\n            });\n          };\n\n          var detachEvents = function ($node, events) {\n            Object.keys(events).forEach(function (key) {\n              $node.off(key, events[key]);\n            });\n          };\n\n          return {\n            /** @property {String} NBSP_CHAR */\n            NBSP_CHAR: NBSP_CHAR,\n\n            /** @property {String} ZERO_WIDTH_NBSP_CHAR */\n            ZERO_WIDTH_NBSP_CHAR: ZERO_WIDTH_NBSP_CHAR,\n\n            /** @property {String} blank */\n            blank: blankHTML,\n\n            /** @property {String} emptyPara */\n            emptyPara: '<p>' + blankHTML + '</p>',\n            makePredByNodeName: makePredByNodeName,\n            isEditable: isEditable,\n            isControlSizing: isControlSizing,\n            isText: isText,\n            isElement: isElement,\n            isVoid: isVoid,\n            isPara: isPara,\n            isPurePara: isPurePara,\n            isHeading: isHeading,\n            isInline: isInline,\n            isBlock: func.not(isInline),\n            isBodyInline: isBodyInline,\n            isBody: isBody,\n            isParaInline: isParaInline,\n            isPre: isPre,\n            isList: isList,\n            isTable: isTable,\n            isData: isData,\n            isCell: isCell,\n            isBlockquote: isBlockquote,\n            isBodyContainer: isBodyContainer,\n            isAnchor: isAnchor,\n            isDiv: makePredByNodeName('DIV'),\n            isLi: isLi,\n            isBR: makePredByNodeName('BR'),\n            isSpan: makePredByNodeName('SPAN'),\n            isB: makePredByNodeName('B'),\n            isU: makePredByNodeName('U'),\n            isS: makePredByNodeName('S'),\n            isI: makePredByNodeName('I'),\n            isImg: makePredByNodeName('IMG'),\n            isTextarea: isTextarea,\n            isEmpty: isEmpty,\n            isEmptyAnchor: func.and(isAnchor, isEmpty),\n            isClosestSibling: isClosestSibling,\n            withClosestSiblings: withClosestSiblings,\n            nodeLength: nodeLength,\n            isLeftEdgePoint: isLeftEdgePoint,\n            isRightEdgePoint: isRightEdgePoint,\n            isEdgePoint: isEdgePoint,\n            isLeftEdgeOf: isLeftEdgeOf,\n            isRightEdgeOf: isRightEdgeOf,\n            isLeftEdgePointOf: isLeftEdgePointOf,\n            isRightEdgePointOf: isRightEdgePointOf,\n            prevPoint: prevPoint,\n            nextPoint: nextPoint,\n            isSamePoint: isSamePoint,\n            isVisiblePoint: isVisiblePoint,\n            prevPointUntil: prevPointUntil,\n            nextPointUntil: nextPointUntil,\n            isCharPoint: isCharPoint,\n            walkPoint: walkPoint,\n            ancestor: ancestor,\n            singleChildAncestor: singleChildAncestor,\n            listAncestor: listAncestor,\n            lastAncestor: lastAncestor,\n            listNext: listNext,\n            listPrev: listPrev,\n            listDescendant: listDescendant,\n            commonAncestor: commonAncestor,\n            wrap: wrap,\n            insertAfter: insertAfter,\n            appendChildNodes: appendChildNodes,\n            position: position,\n            hasChildren: hasChildren,\n            makeOffsetPath: makeOffsetPath,\n            fromOffsetPath: fromOffsetPath,\n            splitTree: splitTree,\n            splitPoint: splitPoint,\n            create: create,\n            createText: createText,\n            remove: remove,\n            removeWhile: removeWhile,\n            replace: replace,\n            html: html,\n            value: value,\n            posFromPlaceholder: posFromPlaceholder,\n            attachEvents: attachEvents,\n            detachEvents: detachEvents\n          };\n        }();\n        /**\n         * @param {jQuery} $note\n         * @param {Object} options\n         * @return {Context}\n         */\n\n\n        var Context = function ($note, options) {\n          var self = this;\n          var ui = $.summernote.ui;\n          this.memos = {};\n          this.modules = {};\n          this.layoutInfo = {};\n          this.options = options;\n          /**\n           * create layout and initialize modules and other resources\n           */\n\n          this.initialize = function () {\n            this.layoutInfo = ui.createLayout($note, options);\n\n            this._initialize();\n\n            $note.hide();\n            return this;\n          };\n          /**\n           * destroy modules and other resources and remove layout\n           */\n\n\n          this.destroy = function () {\n            this._destroy();\n\n            $note.removeData('summernote');\n            ui.removeLayout($note, this.layoutInfo);\n          };\n          /**\n           * destory modules and other resources and initialize it again\n           */\n\n\n          this.reset = function () {\n            var disabled = self.isDisabled();\n            this.code(dom.emptyPara);\n\n            this._destroy();\n\n            this._initialize();\n\n            if (disabled) {\n              self.disable();\n            }\n          };\n\n          this._initialize = function () {\n            // add optional buttons\n            var buttons = $.extend({}, this.options.buttons);\n            Object.keys(buttons).forEach(function (key) {\n              self.memo('button.' + key, buttons[key]);\n            });\n            var modules = $.extend({}, this.options.modules, $.summernote.plugins || {}); // add and initialize modules\n\n            Object.keys(modules).forEach(function (key) {\n              self.module(key, modules[key], true);\n            });\n            Object.keys(this.modules).forEach(function (key) {\n              self.initializeModule(key);\n            });\n          };\n\n          this._destroy = function () {\n            // destroy modules with reversed order\n            Object.keys(this.modules).reverse().forEach(function (key) {\n              self.removeModule(key);\n            });\n            Object.keys(this.memos).forEach(function (key) {\n              self.removeMemo(key);\n            }); // trigger custom onDestroy callback\n\n            this.triggerEvent('destroy', this);\n          };\n\n          this.code = function (html) {\n            var isActivated = this.invoke('codeview.isActivated');\n\n            if (html === undefined) {\n              this.invoke('codeview.sync');\n              return isActivated ? this.layoutInfo.codable.val() : this.layoutInfo.editable.html();\n            } else {\n              if (isActivated) {\n                this.layoutInfo.codable.val(html);\n              } else {\n                this.layoutInfo.editable.html(html);\n              }\n\n              $note.val(html);\n              this.triggerEvent('change', html);\n            }\n          };\n\n          this.isDisabled = function () {\n            return this.layoutInfo.editable.attr('contenteditable') === 'false';\n          };\n\n          this.enable = function () {\n            this.layoutInfo.editable.attr('contenteditable', true);\n            this.invoke('toolbar.activate', true);\n          };\n\n          this.disable = function () {\n            // close codeview if codeview is opend\n            if (this.invoke('codeview.isActivated')) {\n              this.invoke('codeview.deactivate');\n            }\n\n            this.layoutInfo.editable.attr('contenteditable', false);\n            this.invoke('toolbar.deactivate', true);\n          };\n\n          this.triggerEvent = function () {\n            var namespace = list.head(arguments);\n            var args = list.tail(list.from(arguments));\n            var callback = this.options.callbacks[func.namespaceToCamel(namespace, 'on')];\n\n            if (callback) {\n              callback.apply($note[0], args);\n            }\n\n            $note.trigger('summernote.' + namespace, args);\n          };\n\n          this.initializeModule = function (key) {\n            var module = this.modules[key];\n            module.shouldInitialize = module.shouldInitialize || func.ok;\n\n            if (!module.shouldInitialize()) {\n              return;\n            } // initialize module\n\n\n            if (module.initialize) {\n              module.initialize();\n            } // attach events\n\n\n            if (module.events) {\n              dom.attachEvents($note, module.events);\n            }\n          };\n\n          this.module = function (key, ModuleClass, withoutIntialize) {\n            if (arguments.length === 1) {\n              return this.modules[key];\n            }\n\n            this.modules[key] = new ModuleClass(this);\n\n            if (!withoutIntialize) {\n              this.initializeModule(key);\n            }\n          };\n\n          this.removeModule = function (key) {\n            var module = this.modules[key];\n\n            if (module.shouldInitialize()) {\n              if (module.events) {\n                dom.detachEvents($note, module.events);\n              }\n\n              if (module.destroy) {\n                module.destroy();\n              }\n            }\n\n            delete this.modules[key];\n          };\n\n          this.memo = function (key, obj) {\n            if (arguments.length === 1) {\n              return this.memos[key];\n            }\n\n            this.memos[key] = obj;\n          };\n\n          this.removeMemo = function (key) {\n            if (this.memos[key] && this.memos[key].destroy) {\n              this.memos[key].destroy();\n            }\n\n            delete this.memos[key];\n          };\n\n          this.createInvokeHandler = function (namespace, value) {\n            return function (event) {\n              event.preventDefault();\n              self.invoke(namespace, value || $(event.target).closest('[data-value]').data('value'));\n            };\n          };\n\n          this.invoke = function () {\n            var namespace = list.head(arguments);\n            var args = list.tail(list.from(arguments));\n            var splits = namespace.split('.');\n            var hasSeparator = splits.length > 1;\n            var moduleName = hasSeparator && list.head(splits);\n            var methodName = hasSeparator ? list.last(splits) : list.head(splits);\n            var module = this.modules[moduleName || 'editor'];\n\n            if (!moduleName && this[methodName]) {\n              return this[methodName].apply(this, args);\n            } else if (module && module[methodName] && module.shouldInitialize()) {\n              return module[methodName].apply(module, args);\n            }\n          };\n\n          return this.initialize();\n        };\n\n        $.fn.extend({\n          /**\n           * Summernote API\n           *\n           * @param {Object|String}\n           * @return {this}\n           */\n          summernote: function () {\n            var type = $.type(list.head(arguments));\n            var isExternalAPICalled = type === 'string';\n            var hasInitOptions = type === 'object';\n            var options = hasInitOptions ? list.head(arguments) : {};\n            options = $.extend({}, $.summernote.options, options);\n            options.langInfo = $.extend(true, {}, $.summernote.lang['en-US'], $.summernote.lang[options.lang]);\n            options.icons = $.extend(true, {}, $.summernote.options.icons, options.icons);\n            this.each(function (idx, note) {\n              var $note = $(note);\n\n              if (!$note.data('summernote')) {\n                var context = new Context($note, options);\n                $note.data('summernote', context);\n                $note.data('summernote').triggerEvent('init', context.layoutInfo);\n              }\n            });\n            var $note = this.first();\n\n            if ($note.length) {\n              var context = $note.data('summernote');\n\n              if (isExternalAPICalled) {\n                return context.invoke.apply(context, list.from(arguments));\n              } else if (options.focus) {\n                context.invoke('editor.focus');\n              }\n            }\n\n            return this;\n          }\n        });\n\n        var Renderer = function (markup, children, options, callback) {\n          this.render = function ($parent) {\n            var $node = $(markup);\n\n            if (options && options.contents) {\n              $node.html(options.contents);\n            }\n\n            if (options && options.className) {\n              $node.addClass(options.className);\n            }\n\n            if (options && options.data) {\n              $.each(options.data, function (k, v) {\n                $node.attr('data-' + k, v);\n              });\n            }\n\n            if (options && options.click) {\n              $node.on('click', options.click);\n            }\n\n            if (children) {\n              var $container = $node.find('.note-children-container');\n              children.forEach(function (child) {\n                child.render($container.length ? $container : $node);\n              });\n            }\n\n            if (callback) {\n              callback($node, options);\n            }\n\n            if (options && options.callback) {\n              options.callback($node);\n            }\n\n            if ($parent) {\n              $parent.append($node);\n            }\n\n            return $node;\n          };\n        };\n\n        var renderer = {\n          create: function (markup, callback) {\n            return function () {\n              var children = $.isArray(arguments[0]) ? arguments[0] : [];\n              var options = typeof arguments[1] === 'object' ? arguments[1] : arguments[0];\n\n              if (options && options.children) {\n                children = options.children;\n              }\n\n              return new Renderer(markup, children, options, callback);\n            };\n          }\n        };\n        var editor = renderer.create('<div class=\"note-editor note-frame panel panel-default\"/>');\n        var toolbar = renderer.create('<div class=\"note-toolbar panel-heading\"/>');\n        var editingArea = renderer.create('<div class=\"note-editing-area\"/>');\n        var codable = renderer.create('<textarea class=\"note-codable\"/>');\n        var editable = renderer.create('<div class=\"note-editable panel-body\" contentEditable=\"true\"/>');\n        var statusbar = renderer.create(['<div class=\"note-statusbar\">', '  <div class=\"note-resizebar\">', '    <div class=\"note-icon-bar\"/>', '    <div class=\"note-icon-bar\"/>', '    <div class=\"note-icon-bar\"/>', '  </div>', '</div>'].join(''));\n        var airEditor = renderer.create('<div class=\"note-editor\"/>');\n        var airEditable = renderer.create('<div class=\"note-editable\" contentEditable=\"true\"/>');\n        var buttonGroup = renderer.create('<div class=\"note-btn-group btn-group\">');\n        var button = renderer.create('<button type=\"button\" class=\"note-btn btn btn-default btn-sm\" tabindex=\"-1\">', function ($node, options) {\n          if (options && options.tooltip) {\n            $node.attr({\n              title: options.tooltip\n            }).tooltip({\n              container: 'body',\n              trigger: 'hover',\n              placement: 'bottom'\n            });\n          }\n        });\n        var dropdown = renderer.create('<div class=\"dropdown-menu\">', function ($node, options) {\n          var markup = $.isArray(options.items) ? options.items.map(function (item) {\n            var value = typeof item === 'string' ? item : item.value || '';\n            var content = options.template ? options.template(item) : item;\n            return '<li><a href=\"#\" data-value=\"' + value + '\">' + content + '</a></li>';\n          }).join('') : options.items;\n          $node.html(markup);\n        });\n        var dropdownCheck = renderer.create('<div class=\"dropdown-menu note-check\">', function ($node, options) {\n          var markup = $.isArray(options.items) ? options.items.map(function (item) {\n            var value = typeof item === 'string' ? item : item.value || '';\n            var content = options.template ? options.template(item) : item;\n            return '<li><a href=\"#\" data-value=\"' + value + '\">' + icon(options.checkClassName) + ' ' + content + '</a></li>';\n          }).join('') : options.items;\n          $node.html(markup);\n        });\n        var palette = renderer.create('<div class=\"note-color-palette\"/>', function ($node, options) {\n          var contents = [];\n\n          for (var row = 0, rowSize = options.colors.length; row < rowSize; row++) {\n            var eventName = options.eventName;\n            var colors = options.colors[row];\n            var buttons = [];\n\n            for (var col = 0, colSize = colors.length; col < colSize; col++) {\n              var color = colors[col];\n              buttons.push(['<button type=\"button\" class=\"note-color-btn\"', 'style=\"background-color:', color, '\" ', 'data-event=\"', eventName, '\" ', 'data-value=\"', color, '\" ', 'title=\"', color, '\" ', 'data-toggle=\"button\" tabindex=\"-1\"></button>'].join(''));\n            }\n\n            contents.push('<div class=\"note-color-row\">' + buttons.join('') + '</div>');\n          }\n\n          $node.html(contents.join(''));\n          $node.find('.note-color-btn').tooltip({\n            container: 'body',\n            trigger: 'hover',\n            placement: 'bottom'\n          });\n        });\n        var dialog = renderer.create('<div class=\"modal\" aria-hidden=\"false\" tabindex=\"-1\"/>', function ($node, options) {\n          if (options.fade) {\n            $node.addClass('fade');\n          }\n\n          $node.html(['<div class=\"modal-dialog\">', '  <div class=\"modal-content\">', options.title ? '    <div class=\"modal-header\">' + '      <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>' + '      <h4 class=\"modal-title\">' + options.title + '</h4>' + '    </div>' : '', '    <div class=\"modal-body\">' + options.body + '</div>', options.footer ? '    <div class=\"modal-footer\">' + options.footer + '</div>' : '', '  </div>', '</div>'].join(''));\n        });\n        var popover = renderer.create(['<div class=\"note-popover popover in\">', '  <div class=\"arrow\"/>', '  <div class=\"popover-content note-children-container\"/>', '</div>'].join(''), function ($node, options) {\n          var direction = typeof options.direction !== 'undefined' ? options.direction : 'bottom';\n          $node.addClass(direction);\n\n          if (options.hideArrow) {\n            $node.find('.arrow').hide();\n          }\n        });\n\n        var icon = function (iconClassName, tagName) {\n          tagName = tagName || 'i';\n          return '<' + tagName + ' class=\"' + iconClassName + '\"/>';\n        };\n\n        var ui = {\n          editor: editor,\n          toolbar: toolbar,\n          editingArea: editingArea,\n          codable: codable,\n          editable: editable,\n          statusbar: statusbar,\n          airEditor: airEditor,\n          airEditable: airEditable,\n          buttonGroup: buttonGroup,\n          button: button,\n          dropdown: dropdown,\n          dropdownCheck: dropdownCheck,\n          palette: palette,\n          dialog: dialog,\n          popover: popover,\n          icon: icon,\n          toggleBtn: function ($btn, isEnable) {\n            $btn.toggleClass('disabled', !isEnable);\n            $btn.attr('disabled', !isEnable);\n          },\n          toggleBtnActive: function ($btn, isActive) {\n            $btn.toggleClass('active', isActive);\n          },\n          onDialogShown: function ($dialog, handler) {\n            $dialog.one('shown.bs.modal', handler);\n          },\n          onDialogHidden: function ($dialog, handler) {\n            $dialog.one('hidden.bs.modal', handler);\n          },\n          showDialog: function ($dialog) {\n            $dialog.modal('show');\n          },\n          hideDialog: function ($dialog) {\n            $dialog.modal('hide');\n          },\n          createLayout: function ($note, options) {\n            var $editor = (options.airMode ? ui.airEditor([ui.editingArea([ui.airEditable()])]) : ui.editor([ui.toolbar(), ui.editingArea([ui.codable(), ui.editable()]), ui.statusbar()])).render();\n            $editor.insertAfter($note);\n            return {\n              note: $note,\n              editor: $editor,\n              toolbar: $editor.find('.note-toolbar'),\n              editingArea: $editor.find('.note-editing-area'),\n              editable: $editor.find('.note-editable'),\n              codable: $editor.find('.note-codable'),\n              statusbar: $editor.find('.note-statusbar')\n            };\n          },\n          removeLayout: function ($note, layoutInfo) {\n            $note.html(layoutInfo.editable.html());\n            layoutInfo.editor.remove();\n            $note.show();\n          }\n        };\n        $.summernote = $.summernote || {\n          lang: {}\n        };\n        $.extend($.summernote.lang, {\n          'en-US': {\n            font: {\n              bold: 'Bold',\n              italic: 'Italic',\n              underline: 'Underline',\n              clear: 'Remove Font Style',\n              height: 'Line Height',\n              name: 'Font Family',\n              strikethrough: 'Strikethrough',\n              subscript: 'Subscript',\n              superscript: 'Superscript',\n              size: 'Font Size'\n            },\n            image: {\n              image: 'Picture',\n              insert: 'Insert Image',\n              resizeFull: 'Resize Full',\n              resizeHalf: 'Resize Half',\n              resizeQuarter: 'Resize Quarter',\n              floatLeft: 'Float Left',\n              floatRight: 'Float Right',\n              floatNone: 'Float None',\n              shapeRounded: 'Shape: Rounded',\n              shapeCircle: 'Shape: Circle',\n              shapeThumbnail: 'Shape: Thumbnail',\n              shapeNone: 'Shape: None',\n              dragImageHere: 'Drag image or text here',\n              dropImage: 'Drop image or Text',\n              selectFromFiles: 'Select from files',\n              maximumFileSize: 'Maximum file size',\n              maximumFileSizeError: 'Maximum file size exceeded.',\n              url: 'Image URL',\n              remove: 'Remove Image'\n            },\n            video: {\n              video: 'Video',\n              videoLink: 'Video Link',\n              insert: 'Insert Video',\n              url: 'Video URL?',\n              providers: '(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)'\n            },\n            link: {\n              link: 'Link',\n              insert: 'Insert Link',\n              unlink: 'Unlink',\n              edit: 'Edit',\n              textToDisplay: 'Text to display',\n              url: 'To what URL should this link go?',\n              openInNewWindow: 'Open in new window'\n            },\n            table: {\n              table: 'Table'\n            },\n            hr: {\n              insert: 'Insert Horizontal Rule'\n            },\n            style: {\n              style: 'Style',\n              p: 'Normal',\n              blockquote: 'Quote',\n              pre: 'Code',\n              h1: 'Header 1',\n              h2: 'Header 2',\n              h3: 'Header 3',\n              h4: 'Header 4',\n              h5: 'Header 5',\n              h6: 'Header 6'\n            },\n            lists: {\n              unordered: 'Unordered list',\n              ordered: 'Ordered list'\n            },\n            options: {\n              help: 'Help',\n              fullscreen: 'Full Screen',\n              codeview: 'Code View'\n            },\n            paragraph: {\n              paragraph: 'Paragraph',\n              outdent: 'Outdent',\n              indent: 'Indent',\n              left: 'Align left',\n              center: 'Align center',\n              right: 'Align right',\n              justify: 'Justify full'\n            },\n            color: {\n              recent: 'Recent Color',\n              more: 'More Color',\n              background: 'Background Color',\n              foreground: 'Foreground Color',\n              transparent: 'Transparent',\n              setTransparent: 'Set transparent',\n              reset: 'Reset',\n              resetToDefault: 'Reset to default'\n            },\n            shortcut: {\n              shortcuts: 'Keyboard shortcuts',\n              close: 'Close',\n              textFormatting: 'Text formatting',\n              action: 'Action',\n              paragraphFormatting: 'Paragraph formatting',\n              documentStyle: 'Document Style',\n              extraKeys: 'Extra keys'\n            },\n            help: {\n              'insertParagraph': 'Insert Paragraph',\n              'undo': 'Undoes the last command',\n              'redo': 'Redoes the last command',\n              'tab': 'Tab',\n              'untab': 'Untab',\n              'bold': 'Set a bold style',\n              'italic': 'Set a italic style',\n              'underline': 'Set a underline style',\n              'strikethrough': 'Set a strikethrough style',\n              'removeFormat': 'Clean a style',\n              'justifyLeft': 'Set left align',\n              'justifyCenter': 'Set center align',\n              'justifyRight': 'Set right align',\n              'justifyFull': 'Set full align',\n              'insertUnorderedList': 'Toggle unordered list',\n              'insertOrderedList': 'Toggle ordered list',\n              'outdent': 'Outdent on current paragraph',\n              'indent': 'Indent on current paragraph',\n              'formatPara': 'Change current block\\'s format as a paragraph(P tag)',\n              'formatH1': 'Change current block\\'s format as H1',\n              'formatH2': 'Change current block\\'s format as H2',\n              'formatH3': 'Change current block\\'s format as H3',\n              'formatH4': 'Change current block\\'s format as H4',\n              'formatH5': 'Change current block\\'s format as H5',\n              'formatH6': 'Change current block\\'s format as H6',\n              'insertHorizontalRule': 'Insert horizontal rule',\n              'linkDialog.show': 'Show Link Dialog'\n            },\n            history: {\n              undo: 'Undo',\n              redo: 'Redo'\n            },\n            specialChar: {\n              specialChar: 'SPECIAL CHARACTERS',\n              select: 'Select Special characters'\n            }\n          }\n        });\n        /**\n         * @class core.key\n         *\n         * Object for keycodes.\n         *\n         * @singleton\n         * @alternateClassName key\n         */\n\n        var key = function () {\n          var keyMap = {\n            'BACKSPACE': 8,\n            'TAB': 9,\n            'ENTER': 13,\n            'SPACE': 32,\n            // Arrow\n            'LEFT': 37,\n            'UP': 38,\n            'RIGHT': 39,\n            'DOWN': 40,\n            // Number: 0-9\n            'NUM0': 48,\n            'NUM1': 49,\n            'NUM2': 50,\n            'NUM3': 51,\n            'NUM4': 52,\n            'NUM5': 53,\n            'NUM6': 54,\n            'NUM7': 55,\n            'NUM8': 56,\n            // Alphabet: a-z\n            'B': 66,\n            'E': 69,\n            'I': 73,\n            'J': 74,\n            'K': 75,\n            'L': 76,\n            'R': 82,\n            'S': 83,\n            'U': 85,\n            'V': 86,\n            'Y': 89,\n            'Z': 90,\n            'SLASH': 191,\n            'LEFTBRACKET': 219,\n            'BACKSLASH': 220,\n            'RIGHTBRACKET': 221\n          };\n          return {\n            /**\n             * @method isEdit\n             *\n             * @param {Number} keyCode\n             * @return {Boolean}\n             */\n            isEdit: function (keyCode) {\n              return list.contains([keyMap.BACKSPACE, keyMap.TAB, keyMap.ENTER, keyMap.SPACE], keyCode);\n            },\n\n            /**\n             * @method isMove\n             *\n             * @param {Number} keyCode\n             * @return {Boolean}\n             */\n            isMove: function (keyCode) {\n              return list.contains([keyMap.LEFT, keyMap.UP, keyMap.RIGHT, keyMap.DOWN], keyCode);\n            },\n\n            /**\n             * @property {Object} nameFromCode\n             * @property {String} nameFromCode.8 \"BACKSPACE\"\n             */\n            nameFromCode: func.invertObject(keyMap),\n            code: keyMap\n          };\n        }();\n\n        var range = function () {\n          /**\n           * return boundaryPoint from TextRange, inspired by Andy Na's HuskyRange.js\n           *\n           * @param {TextRange} textRange\n           * @param {Boolean} isStart\n           * @return {BoundaryPoint}\n           *\n           * @see http://msdn.microsoft.com/en-us/library/ie/ms535872(v=vs.85).aspx\n           */\n          var textRangeToPoint = function (textRange, isStart) {\n            var container = textRange.parentElement(),\n                offset;\n            var tester = document.body.createTextRange(),\n                prevContainer;\n            var childNodes = list.from(container.childNodes);\n\n            for (offset = 0; offset < childNodes.length; offset++) {\n              if (dom.isText(childNodes[offset])) {\n                continue;\n              }\n\n              tester.moveToElementText(childNodes[offset]);\n\n              if (tester.compareEndPoints('StartToStart', textRange) >= 0) {\n                break;\n              }\n\n              prevContainer = childNodes[offset];\n            }\n\n            if (offset !== 0 && dom.isText(childNodes[offset - 1])) {\n              var textRangeStart = document.body.createTextRange(),\n                  curTextNode = null;\n              textRangeStart.moveToElementText(prevContainer || container);\n              textRangeStart.collapse(!prevContainer);\n              curTextNode = prevContainer ? prevContainer.nextSibling : container.firstChild;\n              var pointTester = textRange.duplicate();\n              pointTester.setEndPoint('StartToStart', textRangeStart);\n              var textCount = pointTester.text.replace(/[\\r\\n]/g, '').length;\n\n              while (textCount > curTextNode.nodeValue.length && curTextNode.nextSibling) {\n                textCount -= curTextNode.nodeValue.length;\n                curTextNode = curTextNode.nextSibling;\n              }\n              /* jshint ignore:start */\n\n\n              var dummy = curTextNode.nodeValue; // enforce IE to re-reference curTextNode, hack\n\n              /* jshint ignore:end */\n\n              if (isStart && curTextNode.nextSibling && dom.isText(curTextNode.nextSibling) && textCount === curTextNode.nodeValue.length) {\n                textCount -= curTextNode.nodeValue.length;\n                curTextNode = curTextNode.nextSibling;\n              }\n\n              container = curTextNode;\n              offset = textCount;\n            }\n\n            return {\n              cont: container,\n              offset: offset\n            };\n          };\n          /**\n           * return TextRange from boundary point (inspired by google closure-library)\n           * @param {BoundaryPoint} point\n           * @return {TextRange}\n           */\n\n\n          var pointToTextRange = function (point) {\n            var textRangeInfo = function (container, offset) {\n              var node, isCollapseToStart;\n\n              if (dom.isText(container)) {\n                var prevTextNodes = dom.listPrev(container, func.not(dom.isText));\n                var prevContainer = list.last(prevTextNodes).previousSibling;\n                node = prevContainer || container.parentNode;\n                offset += list.sum(list.tail(prevTextNodes), dom.nodeLength);\n                isCollapseToStart = !prevContainer;\n              } else {\n                node = container.childNodes[offset] || container;\n\n                if (dom.isText(node)) {\n                  return textRangeInfo(node, 0);\n                }\n\n                offset = 0;\n                isCollapseToStart = false;\n              }\n\n              return {\n                node: node,\n                collapseToStart: isCollapseToStart,\n                offset: offset\n              };\n            };\n\n            var textRange = document.body.createTextRange();\n            var info = textRangeInfo(point.node, point.offset);\n            textRange.moveToElementText(info.node);\n            textRange.collapse(info.collapseToStart);\n            textRange.moveStart('character', info.offset);\n            return textRange;\n          };\n          /**\n           * Wrapped Range\n           *\n           * @constructor\n           * @param {Node} sc - start container\n           * @param {Number} so - start offset\n           * @param {Node} ec - end container\n           * @param {Number} eo - end offset\n           */\n\n\n          var WrappedRange = function (sc, so, ec, eo) {\n            this.sc = sc;\n            this.so = so;\n            this.ec = ec;\n            this.eo = eo; // nativeRange: get nativeRange from sc, so, ec, eo\n\n            var nativeRange = function () {\n              if (agent.isW3CRangeSupport) {\n                var w3cRange = document.createRange();\n                w3cRange.setStart(sc, so);\n                w3cRange.setEnd(ec, eo);\n                return w3cRange;\n              } else {\n                var textRange = pointToTextRange({\n                  node: sc,\n                  offset: so\n                });\n                textRange.setEndPoint('EndToEnd', pointToTextRange({\n                  node: ec,\n                  offset: eo\n                }));\n                return textRange;\n              }\n            };\n\n            this.getPoints = function () {\n              return {\n                sc: sc,\n                so: so,\n                ec: ec,\n                eo: eo\n              };\n            };\n\n            this.getStartPoint = function () {\n              return {\n                node: sc,\n                offset: so\n              };\n            };\n\n            this.getEndPoint = function () {\n              return {\n                node: ec,\n                offset: eo\n              };\n            };\n            /**\n             * select update visible range\n             */\n\n\n            this.select = function () {\n              var nativeRng = nativeRange();\n\n              if (agent.isW3CRangeSupport) {\n                var selection = document.getSelection();\n\n                if (selection.rangeCount > 0) {\n                  selection.removeAllRanges();\n                }\n\n                selection.addRange(nativeRng);\n              } else {\n                nativeRng.select();\n              }\n\n              return this;\n            };\n            /**\n             * Moves the scrollbar to start container(sc) of current range\n             *\n             * @return {WrappedRange}\n             */\n\n\n            this.scrollIntoView = function (container) {\n              var height = $(container).height();\n\n              if (container.scrollTop + height < this.sc.offsetTop) {\n                container.scrollTop += Math.abs(container.scrollTop + height - this.sc.offsetTop);\n              }\n\n              return this;\n            };\n            /**\n             * @return {WrappedRange}\n             */\n\n\n            this.normalize = function () {\n              /**\n               * @param {BoundaryPoint} point\n               * @param {Boolean} isLeftToRight\n               * @return {BoundaryPoint}\n               */\n              var getVisiblePoint = function (point, isLeftToRight) {\n                if (dom.isVisiblePoint(point) && !dom.isEdgePoint(point) || dom.isVisiblePoint(point) && dom.isRightEdgePoint(point) && !isLeftToRight || dom.isVisiblePoint(point) && dom.isLeftEdgePoint(point) && isLeftToRight || dom.isVisiblePoint(point) && dom.isBlock(point.node) && dom.isEmpty(point.node)) {\n                  return point;\n                } // point on block's edge\n\n\n                var block = dom.ancestor(point.node, dom.isBlock);\n\n                if ((dom.isLeftEdgePointOf(point, block) || dom.isVoid(dom.prevPoint(point).node)) && !isLeftToRight || (dom.isRightEdgePointOf(point, block) || dom.isVoid(dom.nextPoint(point).node)) && isLeftToRight) {\n                  // returns point already on visible point\n                  if (dom.isVisiblePoint(point)) {\n                    return point;\n                  } // reverse direction \n\n\n                  isLeftToRight = !isLeftToRight;\n                }\n\n                var nextPoint = isLeftToRight ? dom.nextPointUntil(dom.nextPoint(point), dom.isVisiblePoint) : dom.prevPointUntil(dom.prevPoint(point), dom.isVisiblePoint);\n                return nextPoint || point;\n              };\n\n              var endPoint = getVisiblePoint(this.getEndPoint(), false);\n              var startPoint = this.isCollapsed() ? endPoint : getVisiblePoint(this.getStartPoint(), true);\n              return new WrappedRange(startPoint.node, startPoint.offset, endPoint.node, endPoint.offset);\n            };\n            /**\n             * returns matched nodes on range\n             *\n             * @param {Function} [pred] - predicate function\n             * @param {Object} [options]\n             * @param {Boolean} [options.includeAncestor]\n             * @param {Boolean} [options.fullyContains]\n             * @return {Node[]}\n             */\n\n\n            this.nodes = function (pred, options) {\n              pred = pred || func.ok;\n              var includeAncestor = options && options.includeAncestor;\n              var fullyContains = options && options.fullyContains; // TODO compare points and sort\n\n              var startPoint = this.getStartPoint();\n              var endPoint = this.getEndPoint();\n              var nodes = [];\n              var leftEdgeNodes = [];\n              dom.walkPoint(startPoint, endPoint, function (point) {\n                if (dom.isEditable(point.node)) {\n                  return;\n                }\n\n                var node;\n\n                if (fullyContains) {\n                  if (dom.isLeftEdgePoint(point)) {\n                    leftEdgeNodes.push(point.node);\n                  }\n\n                  if (dom.isRightEdgePoint(point) && list.contains(leftEdgeNodes, point.node)) {\n                    node = point.node;\n                  }\n                } else if (includeAncestor) {\n                  node = dom.ancestor(point.node, pred);\n                } else {\n                  node = point.node;\n                }\n\n                if (node && pred(node)) {\n                  nodes.push(node);\n                }\n              }, true);\n              return list.unique(nodes);\n            };\n            /**\n             * returns commonAncestor of range\n             * @return {Element} - commonAncestor\n             */\n\n\n            this.commonAncestor = function () {\n              return dom.commonAncestor(sc, ec);\n            };\n            /**\n             * returns expanded range by pred\n             *\n             * @param {Function} pred - predicate function\n             * @return {WrappedRange}\n             */\n\n\n            this.expand = function (pred) {\n              var startAncestor = dom.ancestor(sc, pred);\n              var endAncestor = dom.ancestor(ec, pred);\n\n              if (!startAncestor && !endAncestor) {\n                return new WrappedRange(sc, so, ec, eo);\n              }\n\n              var boundaryPoints = this.getPoints();\n\n              if (startAncestor) {\n                boundaryPoints.sc = startAncestor;\n                boundaryPoints.so = 0;\n              }\n\n              if (endAncestor) {\n                boundaryPoints.ec = endAncestor;\n                boundaryPoints.eo = dom.nodeLength(endAncestor);\n              }\n\n              return new WrappedRange(boundaryPoints.sc, boundaryPoints.so, boundaryPoints.ec, boundaryPoints.eo);\n            };\n            /**\n             * @param {Boolean} isCollapseToStart\n             * @return {WrappedRange}\n             */\n\n\n            this.collapse = function (isCollapseToStart) {\n              if (isCollapseToStart) {\n                return new WrappedRange(sc, so, sc, so);\n              } else {\n                return new WrappedRange(ec, eo, ec, eo);\n              }\n            };\n            /**\n             * splitText on range\n             */\n\n\n            this.splitText = function () {\n              var isSameContainer = sc === ec;\n              var boundaryPoints = this.getPoints();\n\n              if (dom.isText(ec) && !dom.isEdgePoint(this.getEndPoint())) {\n                ec.splitText(eo);\n              }\n\n              if (dom.isText(sc) && !dom.isEdgePoint(this.getStartPoint())) {\n                boundaryPoints.sc = sc.splitText(so);\n                boundaryPoints.so = 0;\n\n                if (isSameContainer) {\n                  boundaryPoints.ec = boundaryPoints.sc;\n                  boundaryPoints.eo = eo - so;\n                }\n              }\n\n              return new WrappedRange(boundaryPoints.sc, boundaryPoints.so, boundaryPoints.ec, boundaryPoints.eo);\n            };\n            /**\n             * delete contents on range\n             * @return {WrappedRange}\n             */\n\n\n            this.deleteContents = function () {\n              if (this.isCollapsed()) {\n                return this;\n              }\n\n              var rng = this.splitText();\n              var nodes = rng.nodes(null, {\n                fullyContains: true\n              }); // find new cursor point\n\n              var point = dom.prevPointUntil(rng.getStartPoint(), function (point) {\n                return !list.contains(nodes, point.node);\n              });\n              var emptyParents = [];\n              $.each(nodes, function (idx, node) {\n                // find empty parents\n                var parent = node.parentNode;\n\n                if (point.node !== parent && dom.nodeLength(parent) === 1) {\n                  emptyParents.push(parent);\n                }\n\n                dom.remove(node, false);\n              }); // remove empty parents\n\n              $.each(emptyParents, function (idx, node) {\n                dom.remove(node, false);\n              });\n              return new WrappedRange(point.node, point.offset, point.node, point.offset).normalize();\n            };\n            /**\n             * makeIsOn: return isOn(pred) function\n             */\n\n\n            var makeIsOn = function (pred) {\n              return function () {\n                var ancestor = dom.ancestor(sc, pred);\n                return !!ancestor && ancestor === dom.ancestor(ec, pred);\n              };\n            }; // isOnEditable: judge whether range is on editable or not\n\n\n            this.isOnEditable = makeIsOn(dom.isEditable); // isOnList: judge whether range is on list node or not\n\n            this.isOnList = makeIsOn(dom.isList); // isOnAnchor: judge whether range is on anchor node or not\n\n            this.isOnAnchor = makeIsOn(dom.isAnchor); // isOnCell: judge whether range is on cell node or not\n\n            this.isOnCell = makeIsOn(dom.isCell); // isOnData: judge whether range is on data node or not\n\n            this.isOnData = makeIsOn(dom.isData);\n            /**\n             * @param {Function} pred\n             * @return {Boolean}\n             */\n\n            this.isLeftEdgeOf = function (pred) {\n              if (!dom.isLeftEdgePoint(this.getStartPoint())) {\n                return false;\n              }\n\n              var node = dom.ancestor(this.sc, pred);\n              return node && dom.isLeftEdgeOf(this.sc, node);\n            };\n            /**\n             * returns whether range was collapsed or not\n             */\n\n\n            this.isCollapsed = function () {\n              return sc === ec && so === eo;\n            };\n            /**\n             * wrap inline nodes which children of body with paragraph\n             *\n             * @return {WrappedRange}\n             */\n\n\n            this.wrapBodyInlineWithPara = function () {\n              if (dom.isBodyContainer(sc) && dom.isEmpty(sc)) {\n                sc.innerHTML = dom.emptyPara;\n                return new WrappedRange(sc.firstChild, 0, sc.firstChild, 0);\n              }\n              /**\n               * [workaround] firefox often create range on not visible point. so normalize here.\n               *  - firefox: |<p>text</p>|\n               *  - chrome: <p>|text|</p>\n               */\n\n\n              var rng = this.normalize();\n\n              if (dom.isParaInline(sc) || dom.isPara(sc)) {\n                return rng;\n              } // find inline top ancestor\n\n\n              var topAncestor;\n\n              if (dom.isInline(rng.sc)) {\n                var ancestors = dom.listAncestor(rng.sc, func.not(dom.isInline));\n                topAncestor = list.last(ancestors);\n\n                if (!dom.isInline(topAncestor)) {\n                  topAncestor = ancestors[ancestors.length - 2] || rng.sc.childNodes[rng.so];\n                }\n              } else {\n                topAncestor = rng.sc.childNodes[rng.so > 0 ? rng.so - 1 : 0];\n              } // siblings not in paragraph\n\n\n              var inlineSiblings = dom.listPrev(topAncestor, dom.isParaInline).reverse();\n              inlineSiblings = inlineSiblings.concat(dom.listNext(topAncestor.nextSibling, dom.isParaInline)); // wrap with paragraph\n\n              if (inlineSiblings.length) {\n                var para = dom.wrap(list.head(inlineSiblings), 'p');\n                dom.appendChildNodes(para, list.tail(inlineSiblings));\n              }\n\n              return this.normalize();\n            };\n            /**\n             * insert node at current cursor\n             *\n             * @param {Node} node\n             * @return {Node}\n             */\n\n\n            this.insertNode = function (node) {\n              var rng = this.wrapBodyInlineWithPara().deleteContents();\n              var info = dom.splitPoint(rng.getStartPoint(), dom.isInline(node));\n\n              if (info.rightNode) {\n                info.rightNode.parentNode.insertBefore(node, info.rightNode);\n              } else {\n                info.container.appendChild(node);\n              }\n\n              return node;\n            };\n            /**\n             * insert html at current cursor\n             */\n\n\n            this.pasteHTML = function (markup) {\n              var contentsContainer = $('<div></div>').html(markup)[0];\n              var childNodes = list.from(contentsContainer.childNodes);\n              var rng = this.wrapBodyInlineWithPara().deleteContents();\n              return childNodes.reverse().map(function (childNode) {\n                return rng.insertNode(childNode);\n              }).reverse();\n            };\n            /**\n             * returns text in range\n             *\n             * @return {String}\n             */\n\n\n            this.toString = function () {\n              var nativeRng = nativeRange();\n              return agent.isW3CRangeSupport ? nativeRng.toString() : nativeRng.text;\n            };\n            /**\n             * returns range for word before cursor\n             *\n             * @param {Boolean} [findAfter] - find after cursor, default: false\n             * @return {WrappedRange}\n             */\n\n\n            this.getWordRange = function (findAfter) {\n              var endPoint = this.getEndPoint();\n\n              if (!dom.isCharPoint(endPoint)) {\n                return this;\n              }\n\n              var startPoint = dom.prevPointUntil(endPoint, function (point) {\n                return !dom.isCharPoint(point);\n              });\n\n              if (findAfter) {\n                endPoint = dom.nextPointUntil(endPoint, function (point) {\n                  return !dom.isCharPoint(point);\n                });\n              }\n\n              return new WrappedRange(startPoint.node, startPoint.offset, endPoint.node, endPoint.offset);\n            };\n            /**\n             * create offsetPath bookmark\n             *\n             * @param {Node} editable\n             */\n\n\n            this.bookmark = function (editable) {\n              return {\n                s: {\n                  path: dom.makeOffsetPath(editable, sc),\n                  offset: so\n                },\n                e: {\n                  path: dom.makeOffsetPath(editable, ec),\n                  offset: eo\n                }\n              };\n            };\n            /**\n             * create offsetPath bookmark base on paragraph\n             *\n             * @param {Node[]} paras\n             */\n\n\n            this.paraBookmark = function (paras) {\n              return {\n                s: {\n                  path: list.tail(dom.makeOffsetPath(list.head(paras), sc)),\n                  offset: so\n                },\n                e: {\n                  path: list.tail(dom.makeOffsetPath(list.last(paras), ec)),\n                  offset: eo\n                }\n              };\n            };\n            /**\n             * getClientRects\n             * @return {Rect[]}\n             */\n\n\n            this.getClientRects = function () {\n              var nativeRng = nativeRange();\n              return nativeRng.getClientRects();\n            };\n          };\n          /**\n           * @class core.range\n           *\n           * Data structure\n           *  * BoundaryPoint: a point of dom tree\n           *  * BoundaryPoints: two boundaryPoints corresponding to the start and the end of the Range\n           *\n           * See to http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Position\n           *\n           * @singleton\n           * @alternateClassName range\n           */\n\n\n          return {\n            /**\n             * create Range Object From arguments or Browser Selection\n             *\n             * @param {Node} sc - start container\n             * @param {Number} so - start offset\n             * @param {Node} ec - end container\n             * @param {Number} eo - end offset\n             * @return {WrappedRange}\n             */\n            create: function (sc, so, ec, eo) {\n              if (arguments.length === 4) {\n                return new WrappedRange(sc, so, ec, eo);\n              } else if (arguments.length === 2) {\n                //collapsed\n                ec = sc;\n                eo = so;\n                return new WrappedRange(sc, so, ec, eo);\n              } else {\n                var wrappedRange = this.createFromSelection();\n\n                if (!wrappedRange && arguments.length === 1) {\n                  wrappedRange = this.createFromNode(arguments[0]);\n                  return wrappedRange.collapse(dom.emptyPara === arguments[0].innerHTML);\n                }\n\n                return wrappedRange;\n              }\n            },\n            createFromSelection: function () {\n              var sc, so, ec, eo;\n\n              if (agent.isW3CRangeSupport) {\n                var selection = document.getSelection();\n\n                if (!selection || selection.rangeCount === 0) {\n                  return null;\n                } else if (dom.isBody(selection.anchorNode)) {\n                  // Firefox: returns entire body as range on initialization.\n                  // We won't never need it.\n                  return null;\n                }\n\n                var nativeRng = selection.getRangeAt(0);\n                sc = nativeRng.startContainer;\n                so = nativeRng.startOffset;\n                ec = nativeRng.endContainer;\n                eo = nativeRng.endOffset;\n              } else {\n                // IE8: TextRange\n                var textRange = document.selection.createRange();\n                var textRangeEnd = textRange.duplicate();\n                textRangeEnd.collapse(false);\n                var textRangeStart = textRange;\n                textRangeStart.collapse(true);\n                var startPoint = textRangeToPoint(textRangeStart, true),\n                    endPoint = textRangeToPoint(textRangeEnd, false); // same visible point case: range was collapsed.\n\n                if (dom.isText(startPoint.node) && dom.isLeftEdgePoint(startPoint) && dom.isTextNode(endPoint.node) && dom.isRightEdgePoint(endPoint) && endPoint.node.nextSibling === startPoint.node) {\n                  startPoint = endPoint;\n                }\n\n                sc = startPoint.cont;\n                so = startPoint.offset;\n                ec = endPoint.cont;\n                eo = endPoint.offset;\n              }\n\n              return new WrappedRange(sc, so, ec, eo);\n            },\n\n            /**\n             * @method \n             * \n             * create WrappedRange from node\n             *\n             * @param {Node} node\n             * @return {WrappedRange}\n             */\n            createFromNode: function (node) {\n              var sc = node;\n              var so = 0;\n              var ec = node;\n              var eo = dom.nodeLength(ec); // browsers can't target a picture or void node\n\n              if (dom.isVoid(sc)) {\n                so = dom.listPrev(sc).length - 1;\n                sc = sc.parentNode;\n              }\n\n              if (dom.isBR(ec)) {\n                eo = dom.listPrev(ec).length - 1;\n                ec = ec.parentNode;\n              } else if (dom.isVoid(ec)) {\n                eo = dom.listPrev(ec).length;\n                ec = ec.parentNode;\n              }\n\n              return this.create(sc, so, ec, eo);\n            },\n\n            /**\n             * create WrappedRange from node after position\n             *\n             * @param {Node} node\n             * @return {WrappedRange}\n             */\n            createFromNodeBefore: function (node) {\n              return this.createFromNode(node).collapse(true);\n            },\n\n            /**\n             * create WrappedRange from node after position\n             *\n             * @param {Node} node\n             * @return {WrappedRange}\n             */\n            createFromNodeAfter: function (node) {\n              return this.createFromNode(node).collapse();\n            },\n\n            /**\n             * @method \n             * \n             * create WrappedRange from bookmark\n             *\n             * @param {Node} editable\n             * @param {Object} bookmark\n             * @return {WrappedRange}\n             */\n            createFromBookmark: function (editable, bookmark) {\n              var sc = dom.fromOffsetPath(editable, bookmark.s.path);\n              var so = bookmark.s.offset;\n              var ec = dom.fromOffsetPath(editable, bookmark.e.path);\n              var eo = bookmark.e.offset;\n              return new WrappedRange(sc, so, ec, eo);\n            },\n\n            /**\n             * @method \n             *\n             * create WrappedRange from paraBookmark\n             *\n             * @param {Object} bookmark\n             * @param {Node[]} paras\n             * @return {WrappedRange}\n             */\n            createFromParaBookmark: function (bookmark, paras) {\n              var so = bookmark.s.offset;\n              var eo = bookmark.e.offset;\n              var sc = dom.fromOffsetPath(list.head(paras), bookmark.s.path);\n              var ec = dom.fromOffsetPath(list.last(paras), bookmark.e.path);\n              return new WrappedRange(sc, so, ec, eo);\n            }\n          };\n        }();\n        /**\n         * @class core.async\n         *\n         * Async functions which returns `Promise`\n         *\n         * @singleton\n         * @alternateClassName async\n         */\n\n\n        var async = function () {\n          /**\n           * @method readFileAsDataURL\n           *\n           * read contents of file as representing URL\n           *\n           * @param {File} file\n           * @return {Promise} - then: dataUrl\n           */\n          var readFileAsDataURL = function (file) {\n            return $.Deferred(function (deferred) {\n              $.extend(new FileReader(), {\n                onload: function (e) {\n                  var dataURL = e.target.result;\n                  deferred.resolve(dataURL);\n                },\n                onerror: function () {\n                  deferred.reject(this);\n                }\n              }).readAsDataURL(file);\n            }).promise();\n          };\n          /**\n           * @method createImage\n           *\n           * create `<image>` from url string\n           *\n           * @param {String} url\n           * @return {Promise} - then: $image\n           */\n\n\n          var createImage = function (url) {\n            return $.Deferred(function (deferred) {\n              var $img = $('<img>');\n              $img.one('load', function () {\n                $img.off('error abort');\n                deferred.resolve($img);\n              }).one('error abort', function () {\n                $img.off('load').detach();\n                deferred.reject($img);\n              }).css({\n                display: 'none'\n              }).appendTo(document.body).attr('src', url);\n            }).promise();\n          };\n\n          return {\n            readFileAsDataURL: readFileAsDataURL,\n            createImage: createImage\n          };\n        }();\n        /**\n         * @class editing.History\n         *\n         * Editor History\n         *\n         */\n\n\n        var History = function ($editable) {\n          var stack = [],\n              stackOffset = -1;\n          var editable = $editable[0];\n\n          var makeSnapshot = function () {\n            var rng = range.create(editable);\n            var emptyBookmark = {\n              s: {\n                path: [],\n                offset: 0\n              },\n              e: {\n                path: [],\n                offset: 0\n              }\n            };\n            return {\n              contents: $editable.html(),\n              bookmark: rng ? rng.bookmark(editable) : emptyBookmark\n            };\n          };\n\n          var applySnapshot = function (snapshot) {\n            if (snapshot.contents !== null) {\n              $editable.html(snapshot.contents);\n            }\n\n            if (snapshot.bookmark !== null) {\n              range.createFromBookmark(editable, snapshot.bookmark).select();\n            }\n          };\n          /**\n          * @method rewind\n          * Rewinds the history stack back to the first snapshot taken.\n          * Leaves the stack intact, so that \"Redo\" can still be used.\n          */\n\n\n          this.rewind = function () {\n            // Create snap shot if not yet recorded\n            if ($editable.html() !== stack[stackOffset].contents) {\n              this.recordUndo();\n            } // Return to the first available snapshot.\n\n\n            stackOffset = 0; // Apply that snapshot.\n\n            applySnapshot(stack[stackOffset]);\n          };\n          /**\n          * @method reset\n          * Resets the history stack completely; reverting to an empty editor.\n          */\n\n\n          this.reset = function () {\n            // Clear the stack.\n            stack = []; // Restore stackOffset to its original value.\n\n            stackOffset = -1; // Clear the editable area.\n\n            $editable.html(''); // Record our first snapshot (of nothing).\n\n            this.recordUndo();\n          };\n          /**\n           * undo\n           */\n\n\n          this.undo = function () {\n            // Create snap shot if not yet recorded\n            if ($editable.html() !== stack[stackOffset].contents) {\n              this.recordUndo();\n            }\n\n            if (0 < stackOffset) {\n              stackOffset--;\n              applySnapshot(stack[stackOffset]);\n            }\n          };\n          /**\n           * redo\n           */\n\n\n          this.redo = function () {\n            if (stack.length - 1 > stackOffset) {\n              stackOffset++;\n              applySnapshot(stack[stackOffset]);\n            }\n          };\n          /**\n           * recorded undo\n           */\n\n\n          this.recordUndo = function () {\n            stackOffset++; // Wash out stack after stackOffset\n\n            if (stack.length > stackOffset) {\n              stack = stack.slice(0, stackOffset);\n            } // Create new snapshot and push it to the end\n\n\n            stack.push(makeSnapshot());\n          };\n        };\n        /**\n         * @class editing.Style\n         *\n         * Style\n         *\n         */\n\n\n        var Style = function () {\n          /**\n           * @method jQueryCSS\n           *\n           * [workaround] for old jQuery\n           * passing an array of style properties to .css()\n           * will result in an object of property-value pairs.\n           * (compability with version < 1.9)\n           *\n           * @private\n           * @param  {jQuery} $obj\n           * @param  {Array} propertyNames - An array of one or more CSS properties.\n           * @return {Object}\n           */\n          var jQueryCSS = function ($obj, propertyNames) {\n            if (agent.jqueryVersion < 1.9) {\n              var result = {};\n              $.each(propertyNames, function (idx, propertyName) {\n                result[propertyName] = $obj.css(propertyName);\n              });\n              return result;\n            }\n\n            return $obj.css.call($obj, propertyNames);\n          };\n          /**\n           * returns style object from node\n           *\n           * @param {jQuery} $node\n           * @return {Object}\n           */\n\n\n          this.fromNode = function ($node) {\n            var properties = ['font-family', 'font-size', 'text-align', 'list-style-type', 'line-height'];\n            var styleInfo = jQueryCSS($node, properties) || {};\n            styleInfo['font-size'] = parseInt(styleInfo['font-size'], 10);\n            return styleInfo;\n          };\n          /**\n           * paragraph level style\n           *\n           * @param {WrappedRange} rng\n           * @param {Object} styleInfo\n           */\n\n\n          this.stylePara = function (rng, styleInfo) {\n            $.each(rng.nodes(dom.isPara, {\n              includeAncestor: true\n            }), function (idx, para) {\n              $(para).css(styleInfo);\n            });\n          };\n          /**\n           * insert and returns styleNodes on range.\n           *\n           * @param {WrappedRange} rng\n           * @param {Object} [options] - options for styleNodes\n           * @param {String} [options.nodeName] - default: `SPAN`\n           * @param {Boolean} [options.expandClosestSibling] - default: `false`\n           * @param {Boolean} [options.onlyPartialContains] - default: `false`\n           * @return {Node[]}\n           */\n\n\n          this.styleNodes = function (rng, options) {\n            rng = rng.splitText();\n            var nodeName = options && options.nodeName || 'SPAN';\n            var expandClosestSibling = !!(options && options.expandClosestSibling);\n            var onlyPartialContains = !!(options && options.onlyPartialContains);\n\n            if (rng.isCollapsed()) {\n              return [rng.insertNode(dom.create(nodeName))];\n            }\n\n            var pred = dom.makePredByNodeName(nodeName);\n            var nodes = rng.nodes(dom.isText, {\n              fullyContains: true\n            }).map(function (text) {\n              return dom.singleChildAncestor(text, pred) || dom.wrap(text, nodeName);\n            });\n\n            if (expandClosestSibling) {\n              if (onlyPartialContains) {\n                var nodesInRange = rng.nodes(); // compose with partial contains predication\n\n                pred = func.and(pred, function (node) {\n                  return list.contains(nodesInRange, node);\n                });\n              }\n\n              return nodes.map(function (node) {\n                var siblings = dom.withClosestSiblings(node, pred);\n                var head = list.head(siblings);\n                var tails = list.tail(siblings);\n                $.each(tails, function (idx, elem) {\n                  dom.appendChildNodes(head, elem.childNodes);\n                  dom.remove(elem);\n                });\n                return list.head(siblings);\n              });\n            } else {\n              return nodes;\n            }\n          };\n          /**\n           * get current style on cursor\n           *\n           * @param {WrappedRange} rng\n           * @return {Object} - object contains style properties.\n           */\n\n\n          this.current = function (rng) {\n            var $cont = $(!dom.isElement(rng.sc) ? rng.sc.parentNode : rng.sc);\n            var styleInfo = this.fromNode($cont); // document.queryCommandState for toggle state\n            // [workaround] prevent Firefox nsresult: \"0x80004005 (NS_ERROR_FAILURE)\"\n\n            try {\n              styleInfo = $.extend(styleInfo, {\n                'font-bold': document.queryCommandState('bold') ? 'bold' : 'normal',\n                'font-italic': document.queryCommandState('italic') ? 'italic' : 'normal',\n                'font-underline': document.queryCommandState('underline') ? 'underline' : 'normal',\n                'font-subscript': document.queryCommandState('subscript') ? 'subscript' : 'normal',\n                'font-superscript': document.queryCommandState('superscript') ? 'superscript' : 'normal',\n                'font-strikethrough': document.queryCommandState('strikethrough') ? 'strikethrough' : 'normal'\n              });\n            } catch (e) {} // list-style-type to list-style(unordered, ordered)\n\n\n            if (!rng.isOnList()) {\n              styleInfo['list-style'] = 'none';\n            } else {\n              var orderedTypes = ['circle', 'disc', 'disc-leading-zero', 'square'];\n              var isUnordered = $.inArray(styleInfo['list-style-type'], orderedTypes) > -1;\n              styleInfo['list-style'] = isUnordered ? 'unordered' : 'ordered';\n            }\n\n            var para = dom.ancestor(rng.sc, dom.isPara);\n\n            if (para && para.style['line-height']) {\n              styleInfo['line-height'] = para.style.lineHeight;\n            } else {\n              var lineHeight = parseInt(styleInfo['line-height'], 10) / parseInt(styleInfo['font-size'], 10);\n              styleInfo['line-height'] = lineHeight.toFixed(1);\n            }\n\n            styleInfo.anchor = rng.isOnAnchor() && dom.ancestor(rng.sc, dom.isAnchor);\n            styleInfo.ancestors = dom.listAncestor(rng.sc, dom.isEditable);\n            styleInfo.range = rng;\n            return styleInfo;\n          };\n        };\n        /**\n         * @class editing.Bullet\n         *\n         * @alternateClassName Bullet\n         */\n\n\n        var Bullet = function () {\n          var self = this;\n          /**\n           * toggle ordered list\n           */\n\n          this.insertOrderedList = function (editable) {\n            this.toggleList('OL', editable);\n          };\n          /**\n           * toggle unordered list\n           */\n\n\n          this.insertUnorderedList = function (editable) {\n            this.toggleList('UL', editable);\n          };\n          /**\n           * indent\n           */\n\n\n          this.indent = function (editable) {\n            var self = this;\n            var rng = range.create(editable).wrapBodyInlineWithPara();\n            var paras = rng.nodes(dom.isPara, {\n              includeAncestor: true\n            });\n            var clustereds = list.clusterBy(paras, func.peq2('parentNode'));\n            $.each(clustereds, function (idx, paras) {\n              var head = list.head(paras);\n\n              if (dom.isLi(head)) {\n                self.wrapList(paras, head.parentNode.nodeName);\n              } else {\n                $.each(paras, function (idx, para) {\n                  $(para).css('marginLeft', function (idx, val) {\n                    return (parseInt(val, 10) || 0) + 25;\n                  });\n                });\n              }\n            });\n            rng.select();\n          };\n          /**\n           * outdent\n           */\n\n\n          this.outdent = function (editable) {\n            var self = this;\n            var rng = range.create(editable).wrapBodyInlineWithPara();\n            var paras = rng.nodes(dom.isPara, {\n              includeAncestor: true\n            });\n            var clustereds = list.clusterBy(paras, func.peq2('parentNode'));\n            $.each(clustereds, function (idx, paras) {\n              var head = list.head(paras);\n\n              if (dom.isLi(head)) {\n                self.releaseList([paras]);\n              } else {\n                $.each(paras, function (idx, para) {\n                  $(para).css('marginLeft', function (idx, val) {\n                    val = parseInt(val, 10) || 0;\n                    return val > 25 ? val - 25 : '';\n                  });\n                });\n              }\n            });\n            rng.select();\n          };\n          /**\n           * toggle list\n           *\n           * @param {String} listName - OL or UL\n           */\n\n\n          this.toggleList = function (listName, editable) {\n            var rng = range.create(editable).wrapBodyInlineWithPara();\n            var paras = rng.nodes(dom.isPara, {\n              includeAncestor: true\n            });\n            var bookmark = rng.paraBookmark(paras);\n            var clustereds = list.clusterBy(paras, func.peq2('parentNode')); // paragraph to list\n\n            if (list.find(paras, dom.isPurePara)) {\n              var wrappedParas = [];\n              $.each(clustereds, function (idx, paras) {\n                wrappedParas = wrappedParas.concat(self.wrapList(paras, listName));\n              });\n              paras = wrappedParas; // list to paragraph or change list style\n            } else {\n              var diffLists = rng.nodes(dom.isList, {\n                includeAncestor: true\n              }).filter(function (listNode) {\n                return !$.nodeName(listNode, listName);\n              });\n\n              if (diffLists.length) {\n                $.each(diffLists, function (idx, listNode) {\n                  dom.replace(listNode, listName);\n                });\n              } else {\n                paras = this.releaseList(clustereds, true);\n              }\n            }\n\n            range.createFromParaBookmark(bookmark, paras).select();\n          };\n          /**\n           * @param {Node[]} paras\n           * @param {String} listName\n           * @return {Node[]}\n           */\n\n\n          this.wrapList = function (paras, listName) {\n            var head = list.head(paras);\n            var last = list.last(paras);\n            var prevList = dom.isList(head.previousSibling) && head.previousSibling;\n            var nextList = dom.isList(last.nextSibling) && last.nextSibling;\n            var listNode = prevList || dom.insertAfter(dom.create(listName || 'UL'), last); // P to LI\n\n            paras = paras.map(function (para) {\n              return dom.isPurePara(para) ? dom.replace(para, 'LI') : para;\n            }); // append to list(<ul>, <ol>)\n\n            dom.appendChildNodes(listNode, paras);\n\n            if (nextList) {\n              dom.appendChildNodes(listNode, list.from(nextList.childNodes));\n              dom.remove(nextList);\n            }\n\n            return paras;\n          };\n          /**\n           * @method releaseList\n           *\n           * @param {Array[]} clustereds\n           * @param {Boolean} isEscapseToBody\n           * @return {Node[]}\n           */\n\n\n          this.releaseList = function (clustereds, isEscapseToBody) {\n            var releasedParas = [];\n            $.each(clustereds, function (idx, paras) {\n              var head = list.head(paras);\n              var last = list.last(paras);\n              var headList = isEscapseToBody ? dom.lastAncestor(head, dom.isList) : head.parentNode;\n              var lastList = headList.childNodes.length > 1 ? dom.splitTree(headList, {\n                node: last.parentNode,\n                offset: dom.position(last) + 1\n              }, {\n                isSkipPaddingBlankHTML: true\n              }) : null;\n              var middleList = dom.splitTree(headList, {\n                node: head.parentNode,\n                offset: dom.position(head)\n              }, {\n                isSkipPaddingBlankHTML: true\n              });\n              paras = isEscapseToBody ? dom.listDescendant(middleList, dom.isLi) : list.from(middleList.childNodes).filter(dom.isLi); // LI to P\n\n              if (isEscapseToBody || !dom.isList(headList.parentNode)) {\n                paras = paras.map(function (para) {\n                  return dom.replace(para, 'P');\n                });\n              }\n\n              $.each(list.from(paras).reverse(), function (idx, para) {\n                dom.insertAfter(para, headList);\n              }); // remove empty lists\n\n              var rootLists = list.compact([headList, middleList, lastList]);\n              $.each(rootLists, function (idx, rootList) {\n                var listNodes = [rootList].concat(dom.listDescendant(rootList, dom.isList));\n                $.each(listNodes.reverse(), function (idx, listNode) {\n                  if (!dom.nodeLength(listNode)) {\n                    dom.remove(listNode, true);\n                  }\n                });\n              });\n              releasedParas = releasedParas.concat(paras);\n            });\n            return releasedParas;\n          };\n        };\n        /**\n         * @class editing.Typing\n         *\n         * Typing\n         *\n         */\n\n\n        var Typing = function () {\n          // a Bullet instance to toggle lists off\n          var bullet = new Bullet();\n          /**\n           * insert tab\n           *\n           * @param {WrappedRange} rng\n           * @param {Number} tabsize\n           */\n\n          this.insertTab = function (rng, tabsize) {\n            var tab = dom.createText(new Array(tabsize + 1).join(dom.NBSP_CHAR));\n            rng = rng.deleteContents();\n            rng.insertNode(tab, true);\n            rng = range.create(tab, tabsize);\n            rng.select();\n          };\n          /**\n           * insert paragraph\n           */\n\n\n          this.insertParagraph = function (editable) {\n            var rng = range.create(editable); // deleteContents on range.\n\n            rng = rng.deleteContents(); // Wrap range if it needs to be wrapped by paragraph\n\n            rng = rng.wrapBodyInlineWithPara(); // finding paragraph\n\n            var splitRoot = dom.ancestor(rng.sc, dom.isPara);\n            var nextPara; // on paragraph: split paragraph\n\n            if (splitRoot) {\n              // if it is an empty line with li\n              if (dom.isEmpty(splitRoot) && dom.isLi(splitRoot)) {\n                // toogle UL/OL and escape\n                bullet.toggleList(splitRoot.parentNode.nodeName);\n                return; // if it is an empty line with para on blockquote\n              } else if (dom.isEmpty(splitRoot) && dom.isPara(splitRoot) && dom.isBlockquote(splitRoot.parentNode)) {\n                // escape blockquote\n                dom.insertAfter(splitRoot, splitRoot.parentNode);\n                nextPara = splitRoot; // if new line has content (not a line break)\n              } else {\n                nextPara = dom.splitTree(splitRoot, rng.getStartPoint());\n                var emptyAnchors = dom.listDescendant(splitRoot, dom.isEmptyAnchor);\n                emptyAnchors = emptyAnchors.concat(dom.listDescendant(nextPara, dom.isEmptyAnchor));\n                $.each(emptyAnchors, function (idx, anchor) {\n                  dom.remove(anchor);\n                }); // replace empty heading or pre with P tag\n\n                if ((dom.isHeading(nextPara) || dom.isPre(nextPara)) && dom.isEmpty(nextPara)) {\n                  nextPara = dom.replace(nextPara, 'p');\n                }\n              } // no paragraph: insert empty paragraph\n\n            } else {\n              var next = rng.sc.childNodes[rng.so];\n              nextPara = $(dom.emptyPara)[0];\n\n              if (next) {\n                rng.sc.insertBefore(nextPara, next);\n              } else {\n                rng.sc.appendChild(nextPara);\n              }\n            }\n\n            range.create(nextPara, 0).normalize().select().scrollIntoView(editable);\n          };\n        };\n        /**\n         * @class editing.Table\n         *\n         * Table\n         *\n         */\n\n\n        var Table = function () {\n          /**\n           * handle tab key\n           *\n           * @param {WrappedRange} rng\n           * @param {Boolean} isShift\n           */\n          this.tab = function (rng, isShift) {\n            var cell = dom.ancestor(rng.commonAncestor(), dom.isCell);\n            var table = dom.ancestor(cell, dom.isTable);\n            var cells = dom.listDescendant(table, dom.isCell);\n            var nextCell = list[isShift ? 'prev' : 'next'](cells, cell);\n\n            if (nextCell) {\n              range.create(nextCell, 0).select();\n            }\n          };\n          /**\n           * create empty table element\n           *\n           * @param {Number} rowCount\n           * @param {Number} colCount\n           * @return {Node}\n           */\n\n\n          this.createTable = function (colCount, rowCount, options) {\n            var tds = [],\n                tdHTML;\n\n            for (var idxCol = 0; idxCol < colCount; idxCol++) {\n              tds.push('<td>' + dom.blank + '</td>');\n            }\n\n            tdHTML = tds.join('');\n            var trs = [],\n                trHTML;\n\n            for (var idxRow = 0; idxRow < rowCount; idxRow++) {\n              trs.push('<tr>' + tdHTML + '</tr>');\n            }\n\n            trHTML = trs.join('');\n            var $table = $('<table>' + trHTML + '</table>');\n\n            if (options && options.tableClassName) {\n              $table.addClass(options.tableClassName);\n            }\n\n            return $table[0];\n          };\n        };\n\n        var KEY_BOGUS = 'bogus';\n        /**\n         * @class Editor\n         */\n\n        var Editor = function (context) {\n          var self = this;\n          var $note = context.layoutInfo.note;\n          var $editor = context.layoutInfo.editor;\n          var $editable = context.layoutInfo.editable;\n          var options = context.options;\n          var lang = options.langInfo;\n          var editable = $editable[0];\n          var lastRange = null;\n          var style = new Style();\n          var table = new Table();\n          var typing = new Typing();\n          var bullet = new Bullet();\n          var history = new History($editable);\n\n          this.initialize = function () {\n            // bind custom events\n            $editable.on('keydown', function (event) {\n              if (event.keyCode === key.code.ENTER) {\n                context.triggerEvent('enter', event);\n              }\n\n              context.triggerEvent('keydown', event);\n\n              if (!event.isDefaultPrevented()) {\n                if (options.shortcuts) {\n                  self.handleKeyMap(event);\n                } else {\n                  self.preventDefaultEditableShortCuts(event);\n                }\n              }\n            }).on('keyup', function (event) {\n              context.triggerEvent('keyup', event);\n            }).on('focus', function (event) {\n              context.triggerEvent('focus', event);\n            }).on('blur', function (event) {\n              context.triggerEvent('blur', event);\n            }).on('mousedown', function (event) {\n              context.triggerEvent('mousedown', event);\n            }).on('mouseup', function (event) {\n              context.triggerEvent('mouseup', event);\n            }).on('scroll', function (event) {\n              context.triggerEvent('scroll', event);\n            }).on('paste', function (event) {\n              context.triggerEvent('paste', event);\n            }); // init content before set event\n\n            $editable.html(dom.html($note) || dom.emptyPara); // [workaround] IE doesn't have input events for contentEditable\n            // - see: https://goo.gl/4bfIvA\n\n            var changeEventName = agent.isMSIE ? 'DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted' : 'input';\n            $editable.on(changeEventName, func.debounce(function () {\n              context.triggerEvent('change', $editable.html());\n            }, 250));\n            $editor.on('focusin', function (event) {\n              context.triggerEvent('focusin', event);\n            }).on('focusout', function (event) {\n              context.triggerEvent('focusout', event);\n            });\n\n            if (!options.airMode) {\n              if (options.width) {\n                $editor.outerWidth(options.width);\n              }\n\n              if (options.height) {\n                $editable.outerHeight(options.height);\n              }\n\n              if (options.maxHeight) {\n                $editable.css('max-height', options.maxHeight);\n              }\n\n              if (options.minHeight) {\n                $editable.css('min-height', options.minHeight);\n              }\n            }\n\n            history.recordUndo();\n          };\n\n          this.destroy = function () {\n            $editable.off();\n          };\n\n          this.handleKeyMap = function (event) {\n            var keyMap = options.keyMap[agent.isMac ? 'mac' : 'pc'];\n            var keys = [];\n\n            if (event.metaKey) {\n              keys.push('CMD');\n            }\n\n            if (event.ctrlKey && !event.altKey) {\n              keys.push('CTRL');\n            }\n\n            if (event.shiftKey) {\n              keys.push('SHIFT');\n            }\n\n            var keyName = key.nameFromCode[event.keyCode];\n\n            if (keyName) {\n              keys.push(keyName);\n            }\n\n            var eventName = keyMap[keys.join('+')];\n\n            if (eventName) {\n              event.preventDefault();\n              context.invoke(eventName);\n            } else if (key.isEdit(event.keyCode)) {\n              this.afterCommand();\n            }\n          };\n\n          this.preventDefaultEditableShortCuts = function (event) {\n            // B(Bold, 66) / I(Italic, 73) / U(Underline, 85)\n            if ((event.ctrlKey || event.metaKey) && list.contains([66, 73, 85], event.keyCode)) {\n              event.preventDefault();\n            }\n          };\n          /**\n           * create range\n           * @return {WrappedRange}\n           */\n\n\n          this.createRange = function () {\n            this.focus();\n            return range.create(editable);\n          };\n          /**\n           * saveRange\n           *\n           * save current range\n           *\n           * @param {Boolean} [thenCollapse=false]\n           */\n\n\n          this.saveRange = function (thenCollapse) {\n            lastRange = this.createRange();\n\n            if (thenCollapse) {\n              lastRange.collapse().select();\n            }\n          };\n          /**\n           * restoreRange\n           *\n           * restore lately range\n           */\n\n\n          this.restoreRange = function () {\n            if (lastRange) {\n              lastRange.select();\n              this.focus();\n            }\n          };\n\n          this.saveTarget = function (node) {\n            $editable.data('target', node);\n          };\n\n          this.clearTarget = function () {\n            $editable.removeData('target');\n          };\n\n          this.restoreTarget = function () {\n            return $editable.data('target');\n          };\n          /**\n           * currentStyle\n           *\n           * current style\n           * @return {Object|Boolean} unfocus\n           */\n\n\n          this.currentStyle = function () {\n            var rng = range.create();\n\n            if (rng) {\n              rng = rng.normalize();\n            }\n\n            return rng ? style.current(rng) : style.fromNode($editable);\n          };\n          /**\n           * style from node\n           *\n           * @param {jQuery} $node\n           * @return {Object}\n           */\n\n\n          this.styleFromNode = function ($node) {\n            return style.fromNode($node);\n          };\n          /**\n           * undo\n           */\n\n\n          this.undo = function () {\n            context.triggerEvent('before.command', $editable.html());\n            history.undo();\n            context.triggerEvent('change', $editable.html());\n          };\n\n          context.memo('help.undo', lang.help.undo);\n          /**\n           * redo\n           */\n\n          this.redo = function () {\n            context.triggerEvent('before.command', $editable.html());\n            history.redo();\n            context.triggerEvent('change', $editable.html());\n          };\n\n          context.memo('help.redo', lang.help.redo);\n          /**\n           * before command\n           */\n\n          var beforeCommand = this.beforeCommand = function () {\n            context.triggerEvent('before.command', $editable.html()); // keep focus on editable before command execution\n\n            self.focus();\n          };\n          /**\n           * after command\n           * @param {Boolean} isPreventTrigger\n           */\n\n\n          var afterCommand = this.afterCommand = function (isPreventTrigger) {\n            history.recordUndo();\n\n            if (!isPreventTrigger) {\n              context.triggerEvent('change', $editable.html());\n            }\n          };\n          /* jshint ignore:start */\n          // native commands(with execCommand), generate function for execCommand\n\n\n          var commands = ['bold', 'italic', 'underline', 'strikethrough', 'superscript', 'subscript', 'justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull', 'formatBlock', 'removeFormat', 'backColor', 'foreColor', 'fontName'];\n\n          for (var idx = 0, len = commands.length; idx < len; idx++) {\n            this[commands[idx]] = function (sCmd) {\n              return function (value) {\n                beforeCommand();\n                document.execCommand(sCmd, false, value);\n                afterCommand(true);\n              };\n            }(commands[idx]);\n\n            context.memo('help.' + commands[idx], lang.help[commands[idx]]);\n          }\n          /* jshint ignore:end */\n\n          /**\n           * handle tab key\n           */\n\n\n          this.tab = function () {\n            var rng = this.createRange();\n\n            if (rng.isCollapsed() && rng.isOnCell()) {\n              table.tab(rng);\n            } else {\n              beforeCommand();\n              typing.insertTab(rng, options.tabSize);\n              afterCommand();\n            }\n          };\n\n          context.memo('help.tab', lang.help.tab);\n          /**\n           * handle shift+tab key\n           */\n\n          this.untab = function () {\n            var rng = this.createRange();\n\n            if (rng.isCollapsed() && rng.isOnCell()) {\n              table.tab(rng, true);\n            }\n          };\n\n          context.memo('help.untab', lang.help.untab);\n          /**\n           * run given function between beforeCommand and afterCommand\n           */\n\n          this.wrapCommand = function (fn) {\n            return function () {\n              beforeCommand();\n              fn.apply(self, arguments);\n              afterCommand();\n            };\n          };\n          /**\n           * insert paragraph\n           */\n\n\n          this.insertParagraph = this.wrapCommand(function () {\n            typing.insertParagraph(editable);\n          });\n          context.memo('help.insertParagraph', lang.help.insertParagraph);\n          this.insertOrderedList = this.wrapCommand(function () {\n            bullet.insertOrderedList(editable);\n          });\n          context.memo('help.insertOrderedList', lang.help.insertOrderedList);\n          this.insertUnorderedList = this.wrapCommand(function () {\n            bullet.insertUnorderedList(editable);\n          });\n          context.memo('help.insertUnorderedList', lang.help.insertUnorderedList);\n          this.indent = this.wrapCommand(function () {\n            bullet.indent(editable);\n          });\n          context.memo('help.indent', lang.help.indent);\n          this.outdent = this.wrapCommand(function () {\n            bullet.outdent(editable);\n          });\n          context.memo('help.outdent', lang.help.outdent);\n          /**\n           * insert image\n           *\n           * @param {String} src\n           * @param {String|Function} param\n           * @return {Promise}\n           */\n\n          this.insertImage = function (src, param) {\n            return async.createImage(src, param).then(function ($image) {\n              beforeCommand();\n\n              if (typeof param === 'function') {\n                param($image);\n              } else {\n                if (typeof param === 'string') {\n                  $image.attr('data-filename', param);\n                }\n\n                $image.css('width', Math.min($editable.width(), $image.width()));\n              }\n\n              $image.show();\n              range.create(editable).insertNode($image[0]);\n              range.createFromNodeAfter($image[0]).select();\n              afterCommand();\n            }).fail(function (e) {\n              context.triggerEvent('image.upload.error', e);\n            });\n          };\n          /**\n           * insertImages\n           * @param {File[]} files\n           */\n\n\n          this.insertImages = function (files) {\n            $.each(files, function (idx, file) {\n              var filename = file.name;\n\n              if (options.maximumImageFileSize && options.maximumImageFileSize < file.size) {\n                context.triggerEvent('image.upload.error', lang.image.maximumFileSizeError);\n              } else {\n                async.readFileAsDataURL(file).then(function (dataURL) {\n                  return self.insertImage(dataURL, filename);\n                }).fail(function () {\n                  context.triggerEvent('image.upload.error');\n                });\n              }\n            });\n          };\n          /**\n           * insertImagesOrCallback\n           * @param {File[]} files\n           */\n\n\n          this.insertImagesOrCallback = function (files) {\n            var callbacks = options.callbacks; // If onImageUpload options setted\n\n            if (callbacks.onImageUpload) {\n              context.triggerEvent('image.upload', files); // else insert Image as dataURL\n            } else {\n              this.insertImages(files);\n            }\n          };\n          /**\n           * insertNode\n           * insert node\n           * @param {Node} node\n           */\n\n\n          this.insertNode = this.wrapCommand(function (node) {\n            var rng = this.createRange();\n            rng.insertNode(node);\n            range.createFromNodeAfter(node).select();\n          });\n          /**\n           * insert text\n           * @param {String} text\n           */\n\n          this.insertText = this.wrapCommand(function (text) {\n            var rng = this.createRange();\n            var textNode = rng.insertNode(dom.createText(text));\n            range.create(textNode, dom.nodeLength(textNode)).select();\n          });\n          /**\n           * return selected plain text\n           * @return {String} text\n           */\n\n          this.getSelectedText = function () {\n            var rng = this.createRange(); // if range on anchor, expand range with anchor\n\n            if (rng.isOnAnchor()) {\n              rng = range.createFromNode(dom.ancestor(rng.sc, dom.isAnchor));\n            }\n\n            return rng.toString();\n          };\n          /**\n           * paste HTML\n           * @param {String} markup\n           */\n\n\n          this.pasteHTML = this.wrapCommand(function (markup) {\n            var contents = this.createRange().pasteHTML(markup);\n            range.createFromNodeAfter(list.last(contents)).select();\n          });\n          /**\n           * formatBlock\n           *\n           * @param {String} tagName\n           */\n\n          this.formatBlock = this.wrapCommand(function (tagName) {\n            // [workaround] for MSIE, IE need `<`\n            tagName = agent.isMSIE ? '<' + tagName + '>' : tagName;\n            document.execCommand('FormatBlock', false, tagName);\n          });\n\n          this.formatPara = function () {\n            this.formatBlock('P');\n          };\n\n          context.memo('help.formatPara', lang.help.formatPara);\n          /* jshint ignore:start */\n\n          for (var idx = 1; idx <= 6; idx++) {\n            this['formatH' + idx] = function (idx) {\n              return function () {\n                this.formatBlock('H' + idx);\n              };\n            }(idx);\n\n            context.memo('help.formatH' + idx, lang.help['formatH' + idx]);\n          }\n\n          ;\n          /* jshint ignore:end */\n\n          /**\n           * fontSize\n           *\n           * @param {String} value - px\n           */\n\n          this.fontSize = function (value) {\n            var rng = this.createRange();\n\n            if (rng && rng.isCollapsed()) {\n              var spans = style.styleNodes(rng);\n              var firstSpan = list.head(spans);\n              $(spans).css({\n                'font-size': value + 'px'\n              }); // [workaround] added styled bogus span for style\n              //  - also bogus character needed for cursor position\n\n              if (firstSpan && !dom.nodeLength(firstSpan)) {\n                firstSpan.innerHTML = dom.ZERO_WIDTH_NBSP_CHAR;\n                range.createFromNodeAfter(firstSpan.firstChild).select();\n                $editable.data(KEY_BOGUS, firstSpan);\n              }\n            } else {\n              beforeCommand();\n              $(style.styleNodes(rng)).css({\n                'font-size': value + 'px'\n              });\n              afterCommand();\n            }\n          };\n          /**\n           * insert horizontal rule\n           */\n\n\n          this.insertHorizontalRule = this.wrapCommand(function () {\n            var hrNode = this.createRange().insertNode(dom.create('HR'));\n\n            if (hrNode.nextSibling) {\n              range.create(hrNode.nextSibling, 0).normalize().select();\n            }\n          });\n          context.memo('help.insertHorizontalRule', lang.help.insertHorizontalRule);\n          /**\n           * remove bogus node and character\n           */\n\n          this.removeBogus = function () {\n            var bogusNode = $editable.data(KEY_BOGUS);\n\n            if (!bogusNode) {\n              return;\n            }\n\n            var textNode = list.find(list.from(bogusNode.childNodes), dom.isText);\n            var bogusCharIdx = textNode.nodeValue.indexOf(dom.ZERO_WIDTH_NBSP_CHAR);\n\n            if (bogusCharIdx !== -1) {\n              textNode.deleteData(bogusCharIdx, 1);\n            }\n\n            if (dom.isEmpty(bogusNode)) {\n              dom.remove(bogusNode);\n            }\n\n            $editable.removeData(KEY_BOGUS);\n          };\n          /**\n           * lineHeight\n           * @param {String} value\n           */\n\n\n          this.lineHeight = this.wrapCommand(function (value) {\n            style.stylePara(this.createRange(), {\n              lineHeight: value\n            });\n          });\n          /**\n           * unlink\n           *\n           * @type command\n           */\n\n          this.unlink = function () {\n            var rng = this.createRange();\n\n            if (rng.isOnAnchor()) {\n              var anchor = dom.ancestor(rng.sc, dom.isAnchor);\n              rng = range.createFromNode(anchor);\n              rng.select();\n              beforeCommand();\n              document.execCommand('unlink');\n              afterCommand();\n            }\n          };\n          /**\n           * create link (command)\n           *\n           * @param {Object} linkInfo\n           */\n\n\n          this.createLink = this.wrapCommand(function (linkInfo) {\n            var linkUrl = linkInfo.url;\n            var linkText = linkInfo.text;\n            var isNewWindow = linkInfo.isNewWindow;\n            var rng = linkInfo.range || this.createRange();\n            var isTextChanged = rng.toString() !== linkText; // handle spaced urls from input\n\n            if (typeof linkUrl === 'string') {\n              linkUrl = linkUrl.trim();\n            }\n\n            if (options.onCreateLink) {\n              linkUrl = options.onCreateLink(linkUrl);\n            } else {\n              // if url doesn't match an URL schema, set http:// as default\n              linkUrl = /^[A-Za-z][A-Za-z0-9+-.]*\\:[\\/\\/]?/.test(linkUrl) ? linkUrl : 'http://' + linkUrl;\n            }\n\n            var anchors = [];\n\n            if (isTextChanged) {\n              rng = rng.deleteContents();\n              var anchor = rng.insertNode($('<A>' + linkText + '</A>')[0]);\n              anchors.push(anchor);\n            } else {\n              anchors = style.styleNodes(rng, {\n                nodeName: 'A',\n                expandClosestSibling: true,\n                onlyPartialContains: true\n              });\n            }\n\n            $.each(anchors, function (idx, anchor) {\n              $(anchor).attr('href', linkUrl);\n\n              if (isNewWindow) {\n                $(anchor).attr('target', '_blank');\n              } else {\n                $(anchor).removeAttr('target');\n              }\n            });\n            var startRange = range.createFromNodeBefore(list.head(anchors));\n            var startPoint = startRange.getStartPoint();\n            var endRange = range.createFromNodeAfter(list.last(anchors));\n            var endPoint = endRange.getEndPoint();\n            range.create(startPoint.node, startPoint.offset, endPoint.node, endPoint.offset).select();\n          });\n          /**\n           * returns link info\n           *\n           * @return {Object}\n           * @return {WrappedRange} return.range\n           * @return {String} return.text\n           * @return {Boolean} [return.isNewWindow=true]\n           * @return {String} [return.url=\"\"]\n           */\n\n          this.getLinkInfo = function () {\n            var rng = this.createRange().expand(dom.isAnchor); // Get the first anchor on range(for edit).\n\n            var $anchor = $(list.head(rng.nodes(dom.isAnchor)));\n            return {\n              range: rng,\n              text: rng.toString(),\n              isNewWindow: $anchor.length ? $anchor.attr('target') === '_blank' : false,\n              url: $anchor.length ? $anchor.attr('href') : ''\n            };\n          };\n          /**\n           * setting color\n           *\n           * @param {Object} sObjColor  color code\n           * @param {String} sObjColor.foreColor foreground color\n           * @param {String} sObjColor.backColor background color\n           */\n\n\n          this.color = this.wrapCommand(function (colorInfo) {\n            var foreColor = colorInfo.foreColor;\n            var backColor = colorInfo.backColor;\n\n            if (foreColor) {\n              document.execCommand('foreColor', false, foreColor);\n            }\n\n            if (backColor) {\n              document.execCommand('backColor', false, backColor);\n            }\n          });\n          /**\n           * insert Table\n           *\n           * @param {String} dimension of table (ex : \"5x5\")\n           */\n\n          this.insertTable = this.wrapCommand(function (dim) {\n            var dimension = dim.split('x');\n            var rng = this.createRange().deleteContents();\n            rng.insertNode(table.createTable(dimension[0], dimension[1], options));\n          });\n          /**\n           * float me\n           *\n           * @param {String} value\n           */\n\n          this.floatMe = this.wrapCommand(function (value) {\n            var $target = $(this.restoreTarget());\n            $target.css('float', value);\n          });\n          /**\n           * resize overlay element\n           * @param {String} value\n           */\n\n          this.resize = this.wrapCommand(function (value) {\n            var $target = $(this.restoreTarget());\n            $target.css({\n              width: value * 100 + '%',\n              height: ''\n            });\n          });\n          /**\n           * @param {Position} pos\n           * @param {jQuery} $target - target element\n           * @param {Boolean} [bKeepRatio] - keep ratio\n           */\n\n          this.resizeTo = function (pos, $target, bKeepRatio) {\n            var imageSize;\n\n            if (bKeepRatio) {\n              var newRatio = pos.y / pos.x;\n              var ratio = $target.data('ratio');\n              imageSize = {\n                width: ratio > newRatio ? pos.x : pos.y / ratio,\n                height: ratio > newRatio ? pos.x * ratio : pos.y\n              };\n            } else {\n              imageSize = {\n                width: pos.x,\n                height: pos.y\n              };\n            }\n\n            $target.css(imageSize);\n          };\n          /**\n           * remove media object\n           */\n\n\n          this.removeMedia = this.wrapCommand(function () {\n            var $target = $(this.restoreTarget()).detach();\n            context.triggerEvent('media.delete', $target, $editable);\n          });\n          /**\n           * returns whether editable area has focus or not.\n           */\n\n          this.hasFocus = function () {\n            return $editable.is(':focus');\n          };\n          /**\n           * set focus\n           */\n\n\n          this.focus = function () {\n            // [workaround] Screen will move when page is scolled in IE.\n            //  - do focus when not focused\n            if (!this.hasFocus()) {\n              $editable.focus();\n            }\n          };\n          /**\n           * returns whether contents is empty or not.\n           * @return {Boolean}\n           */\n\n\n          this.isEmpty = function () {\n            return dom.isEmpty($editable[0]) || dom.emptyPara === $editable.html();\n          };\n          /**\n           * Removes all contents and restores the editable instance to an _emptyPara_.\n           */\n\n\n          this.empty = function () {\n            context.invoke('code', dom.emptyPara);\n          };\n        };\n\n        var Clipboard = function (context) {\n          var self = this;\n          var $editable = context.layoutInfo.editable;\n          this.events = {\n            'summernote.keydown': function (we, e) {\n              if (self.needKeydownHook()) {\n                if ((e.ctrlKey || e.metaKey) && e.keyCode === key.code.V) {\n                  context.invoke('editor.saveRange');\n                  self.$paste.focus();\n                  setTimeout(function () {\n                    self.pasteByHook();\n                  }, 0);\n                }\n              }\n            }\n          };\n\n          this.needKeydownHook = function () {\n            return agent.isMSIE && agent.browserVersion > 10 || agent.isFF;\n          };\n\n          this.initialize = function () {\n            // [workaround] getting image from clipboard\n            //  - IE11 and Firefox: CTRL+v hook\n            //  - Webkit: event.clipboardData\n            if (this.needKeydownHook()) {\n              this.$paste = $('<div tabindex=\"-1\" />').attr('contenteditable', true).css({\n                position: 'absolute',\n                left: -100000,\n                opacity: 0\n              });\n              $editable.before(this.$paste);\n              this.$paste.on('paste', function (event) {\n                context.triggerEvent('paste', event);\n              });\n            } else {\n              $editable.on('paste', this.pasteByEvent);\n            }\n          };\n\n          this.destroy = function () {\n            if (this.needKeydownHook()) {\n              this.$paste.remove();\n              this.$paste = null;\n            }\n          };\n\n          this.pasteByHook = function () {\n            var node = this.$paste[0].firstChild;\n\n            if (dom.isImg(node)) {\n              var dataURI = node.src;\n              var decodedData = atob(dataURI.split(',')[1]);\n              var array = new Uint8Array(decodedData.length);\n\n              for (var i = 0; i < decodedData.length; i++) {\n                array[i] = decodedData.charCodeAt(i);\n              }\n\n              var blob = new Blob([array], {\n                type: 'image/png'\n              });\n              blob.name = 'clipboard.png';\n              context.invoke('editor.restoreRange');\n              context.invoke('editor.focus');\n              context.invoke('editor.insertImagesOrCallback', [blob]);\n            } else {\n              var pasteContent = $('<div />').html(this.$paste.html()).html();\n              context.invoke('editor.restoreRange');\n              context.invoke('editor.focus');\n\n              if (pasteContent) {\n                context.invoke('editor.pasteHTML', pasteContent);\n              }\n            }\n\n            this.$paste.empty();\n          };\n          /**\n           * paste by clipboard event\n           *\n           * @param {Event} event\n           */\n\n\n          this.pasteByEvent = function (event) {\n            var clipboardData = event.originalEvent.clipboardData;\n\n            if (clipboardData && clipboardData.items && clipboardData.items.length) {\n              var item = list.head(clipboardData.items);\n\n              if (item.kind === 'file' && item.type.indexOf('image/') !== -1) {\n                context.invoke('editor.insertImagesOrCallback', [item.getAsFile()]);\n              }\n\n              context.invoke('editor.afterCommand');\n            }\n          };\n        };\n\n        var Dropzone = function (context) {\n          var $document = $(document);\n          var $editor = context.layoutInfo.editor;\n          var $editable = context.layoutInfo.editable;\n          var options = context.options;\n          var lang = options.langInfo;\n          var documentEventHandlers = {};\n          var $dropzone = $(['<div class=\"note-dropzone\">', '  <div class=\"note-dropzone-message\"/>', '</div>'].join('')).prependTo($editor);\n\n          var detachDocumentEvent = function () {\n            Object.keys(documentEventHandlers).forEach(function (key) {\n              $document.off(key.substr(2).toLowerCase(), documentEventHandlers[key]);\n            });\n            documentEventHandlers = {};\n          };\n          /**\n           * attach Drag and Drop Events\n           */\n\n\n          this.initialize = function () {\n            if (options.disableDragAndDrop) {\n              // prevent default drop event\n              documentEventHandlers.onDrop = function (e) {\n                e.preventDefault();\n              };\n\n              $document.on('drop', documentEventHandlers.onDrop);\n            } else {\n              this.attachDragAndDropEvent();\n            }\n          };\n          /**\n           * attach Drag and Drop Events\n           */\n\n\n          this.attachDragAndDropEvent = function () {\n            var collection = $(),\n                $dropzoneMessage = $dropzone.find('.note-dropzone-message');\n\n            documentEventHandlers.onDragenter = function (e) {\n              var isCodeview = context.invoke('codeview.isActivated');\n              var hasEditorSize = $editor.width() > 0 && $editor.height() > 0;\n\n              if (!isCodeview && !collection.length && hasEditorSize) {\n                $editor.addClass('dragover');\n                $dropzone.width($editor.width());\n                $dropzone.height($editor.height());\n                $dropzoneMessage.text(lang.image.dragImageHere);\n              }\n\n              collection = collection.add(e.target);\n            };\n\n            documentEventHandlers.onDragleave = function (e) {\n              collection = collection.not(e.target);\n\n              if (!collection.length) {\n                $editor.removeClass('dragover');\n              }\n            };\n\n            documentEventHandlers.onDrop = function () {\n              collection = $();\n              $editor.removeClass('dragover');\n            }; // show dropzone on dragenter when dragging a object to document\n            // -but only if the editor is visible, i.e. has a positive width and height\n\n\n            $document.on('dragenter', documentEventHandlers.onDragenter).on('dragleave', documentEventHandlers.onDragleave).on('drop', documentEventHandlers.onDrop); // change dropzone's message on hover.\n\n            $dropzone.on('dragenter', function () {\n              $dropzone.addClass('hover');\n              $dropzoneMessage.text(lang.image.dropImage);\n            }).on('dragleave', function () {\n              $dropzone.removeClass('hover');\n              $dropzoneMessage.text(lang.image.dragImageHere);\n            }); // attach dropImage\n\n            $dropzone.on('drop', function (event) {\n              var dataTransfer = event.originalEvent.dataTransfer;\n\n              if (dataTransfer && dataTransfer.files && dataTransfer.files.length) {\n                event.preventDefault();\n                $editable.focus();\n                context.invoke('editor.insertImagesOrCallback', dataTransfer.files);\n              } else {\n                $.each(dataTransfer.types, function (idx, type) {\n                  var content = dataTransfer.getData(type);\n\n                  if (type.toLowerCase().indexOf('text') > -1) {\n                    context.invoke('editor.pasteHTML', content);\n                  } else {\n                    $(content).each(function () {\n                      context.invoke('editor.insertNode', this);\n                    });\n                  }\n                });\n              }\n            }).on('dragover', false); // prevent default dragover event\n          };\n\n          this.destroy = function () {\n            detachDocumentEvent();\n          };\n        };\n\n        var CodeMirror;\n\n        if (agent.hasCodeMirror) {\n          if (agent.isSupportAmd) {\n            new Promise(function (resolve) {\n              resolve();\n            }).then(function () {\n              var __WEBPACK_AMD_REQUIRE_ARRAY__ = [__webpack_require__(5)];\n              (function (cm) {\n                CodeMirror = cm;\n              }).apply(null, __WEBPACK_AMD_REQUIRE_ARRAY__);\n            }).catch(__webpack_require__.oe);\n          } else {\n            CodeMirror = window.CodeMirror;\n          }\n        }\n        /**\n         * @class Codeview\n         */\n\n\n        var Codeview = function (context) {\n          var $editor = context.layoutInfo.editor;\n          var $editable = context.layoutInfo.editable;\n          var $codable = context.layoutInfo.codable;\n          var options = context.options;\n\n          this.sync = function () {\n            var isCodeview = this.isActivated();\n\n            if (isCodeview && agent.hasCodeMirror) {\n              $codable.data('cmEditor').save();\n            }\n          };\n          /**\n           * @return {Boolean}\n           */\n\n\n          this.isActivated = function () {\n            return $editor.hasClass('codeview');\n          };\n          /**\n           * toggle codeview\n           */\n\n\n          this.toggle = function () {\n            if (this.isActivated()) {\n              this.deactivate();\n            } else {\n              this.activate();\n            }\n\n            context.triggerEvent('codeview.toggled');\n          };\n          /**\n           * activate code view\n           */\n\n\n          this.activate = function () {\n            $codable.val(dom.html($editable, options.prettifyHtml));\n            $codable.height($editable.height());\n            context.invoke('toolbar.updateCodeview', true);\n            $editor.addClass('codeview');\n            $codable.focus(); // activate CodeMirror as codable\n\n            if (agent.hasCodeMirror) {\n              var cmEditor = CodeMirror.fromTextArea($codable[0], options.codemirror); // CodeMirror TernServer\n\n              if (options.codemirror.tern) {\n                var server = new CodeMirror.TernServer(options.codemirror.tern);\n                cmEditor.ternServer = server;\n                cmEditor.on('cursorActivity', function (cm) {\n                  server.updateArgHints(cm);\n                });\n              } // CodeMirror hasn't Padding.\n\n\n              cmEditor.setSize(null, $editable.outerHeight());\n              $codable.data('cmEditor', cmEditor);\n            }\n          };\n          /**\n           * deactivate code view\n           */\n\n\n          this.deactivate = function () {\n            // deactivate CodeMirror as codable\n            if (agent.hasCodeMirror) {\n              var cmEditor = $codable.data('cmEditor');\n              $codable.val(cmEditor.getValue());\n              cmEditor.toTextArea();\n            }\n\n            var value = dom.value($codable, options.prettifyHtml) || dom.emptyPara;\n            var isChange = $editable.html() !== value;\n            $editable.html(value);\n            $editable.height(options.height ? $codable.height() : 'auto');\n            $editor.removeClass('codeview');\n\n            if (isChange) {\n              context.triggerEvent('change', $editable.html(), $editable);\n            }\n\n            $editable.focus();\n            context.invoke('toolbar.updateCodeview', false);\n          };\n\n          this.destroy = function () {\n            if (this.isActivated()) {\n              this.deactivate();\n            }\n          };\n        };\n\n        var EDITABLE_PADDING = 24;\n\n        var Statusbar = function (context) {\n          var $document = $(document);\n          var $statusbar = context.layoutInfo.statusbar;\n          var $editable = context.layoutInfo.editable;\n          var options = context.options;\n\n          this.initialize = function () {\n            if (options.airMode || options.disableResizeEditor) {\n              this.destroy();\n              return;\n            }\n\n            $statusbar.on('mousedown', function (event) {\n              event.preventDefault();\n              event.stopPropagation();\n              var editableTop = $editable.offset().top - $document.scrollTop();\n              $document.on('mousemove', function (event) {\n                var height = event.clientY - (editableTop + EDITABLE_PADDING);\n                height = options.minheight > 0 ? Math.max(height, options.minheight) : height;\n                height = options.maxHeight > 0 ? Math.min(height, options.maxHeight) : height;\n                $editable.height(height);\n              }).one('mouseup', function () {\n                $document.off('mousemove');\n              });\n            });\n          };\n\n          this.destroy = function () {\n            $statusbar.off();\n            $statusbar.remove();\n          };\n        };\n\n        var Fullscreen = function (context) {\n          var $editor = context.layoutInfo.editor;\n          var $toolbar = context.layoutInfo.toolbar;\n          var $editable = context.layoutInfo.editable;\n          var $codable = context.layoutInfo.codable;\n          var $window = $(window);\n          var $scrollbar = $('html, body');\n          /**\n           * toggle fullscreen\n           */\n\n          this.toggle = function () {\n            var resize = function (size) {\n              $editable.css('height', size.h);\n              $codable.css('height', size.h);\n\n              if ($codable.data('cmeditor')) {\n                $codable.data('cmeditor').setsize(null, size.h);\n              }\n            };\n\n            $editor.toggleClass('fullscreen');\n\n            if (this.isFullscreen()) {\n              $editable.data('orgHeight', $editable.css('height'));\n              $window.on('resize', function () {\n                resize({\n                  h: $window.height() - $toolbar.outerHeight()\n                });\n              }).trigger('resize');\n              $scrollbar.css('overflow', 'hidden');\n            } else {\n              $window.off('resize');\n              resize({\n                h: $editable.data('orgHeight')\n              });\n              $scrollbar.css('overflow', 'visible');\n            }\n\n            context.invoke('toolbar.updateFullscreen', this.isFullscreen());\n          };\n\n          this.isFullscreen = function () {\n            return $editor.hasClass('fullscreen');\n          };\n        };\n\n        var Handle = function (context) {\n          var self = this;\n          var $document = $(document);\n          var $editingArea = context.layoutInfo.editingArea;\n          var options = context.options;\n          this.events = {\n            'summernote.mousedown': function (we, e) {\n              if (self.update(e.target)) {\n                e.preventDefault();\n              }\n            },\n            'summernote.keyup summernote.scroll summernote.change summernote.dialog.shown': function () {\n              self.update();\n            }\n          };\n\n          this.initialize = function () {\n            this.$handle = $(['<div class=\"note-handle\">', '<div class=\"note-control-selection\">', '<div class=\"note-control-selection-bg\"></div>', '<div class=\"note-control-holder note-control-nw\"></div>', '<div class=\"note-control-holder note-control-ne\"></div>', '<div class=\"note-control-holder note-control-sw\"></div>', '<div class=\"', options.disableResizeImage ? 'note-control-holder' : 'note-control-sizing', ' note-control-se\"></div>', options.disableResizeImage ? '' : '<div class=\"note-control-selection-info\"></div>', '</div>', '</div>'].join('')).prependTo($editingArea);\n            this.$handle.on('mousedown', function (event) {\n              if (dom.isControlSizing(event.target)) {\n                event.preventDefault();\n                event.stopPropagation();\n                var $target = self.$handle.find('.note-control-selection').data('target'),\n                    posStart = $target.offset(),\n                    scrollTop = $document.scrollTop();\n                $document.on('mousemove', function (event) {\n                  context.invoke('editor.resizeTo', {\n                    x: event.clientX - posStart.left,\n                    y: event.clientY - (posStart.top - scrollTop)\n                  }, $target, !event.shiftKey);\n                  self.update($target[0]);\n                }).one('mouseup', function (e) {\n                  e.preventDefault();\n                  $document.off('mousemove');\n                  context.invoke('editor.afterCommand');\n                });\n\n                if (!$target.data('ratio')) {\n                  // original ratio.\n                  $target.data('ratio', $target.height() / $target.width());\n                }\n              }\n            });\n          };\n\n          this.destroy = function () {\n            this.$handle.remove();\n          };\n\n          this.update = function (target) {\n            var isImage = dom.isImg(target);\n            var $selection = this.$handle.find('.note-control-selection');\n            context.invoke('imagePopover.update', target);\n\n            if (isImage) {\n              var $image = $(target);\n              var pos = $image.position(); // include margin\n\n              var imageSize = {\n                w: $image.outerWidth(true),\n                h: $image.outerHeight(true)\n              };\n              $selection.css({\n                display: 'block',\n                left: pos.left,\n                top: pos.top,\n                width: imageSize.w,\n                height: imageSize.h\n              }).data('target', $image); // save current image element.\n\n              var sizingText = imageSize.w + 'x' + imageSize.h;\n              $selection.find('.note-control-selection-info').text(sizingText);\n              context.invoke('editor.saveTarget', target);\n            } else {\n              this.hide();\n            }\n\n            return isImage;\n          };\n          /**\n           * hide\n           *\n           * @param {jQuery} $handle\n           */\n\n\n          this.hide = function () {\n            context.invoke('editor.clearTarget');\n            this.$handle.children().hide();\n          };\n        };\n\n        var AutoLink = function (context) {\n          var self = this;\n          var defaultScheme = 'http://';\n          var linkPattern = /^([A-Za-z][A-Za-z0-9+-.]*\\:[\\/\\/]?|mailto:[A-Z0-9._%+-]+@)?(www\\.)?(.+)$/i;\n          this.events = {\n            'summernote.keyup': function (we, e) {\n              if (!e.isDefaultPrevented()) {\n                self.handleKeyup(e);\n              }\n            },\n            'summernote.keydown': function (we, e) {\n              self.handleKeydown(e);\n            }\n          };\n\n          this.initialize = function () {\n            this.lastWordRange = null;\n          };\n\n          this.destroy = function () {\n            this.lastWordRange = null;\n          };\n\n          this.replace = function () {\n            if (!this.lastWordRange) {\n              return;\n            }\n\n            var keyword = this.lastWordRange.toString();\n            var match = keyword.match(linkPattern);\n\n            if (match && (match[1] || match[2])) {\n              var link = match[1] ? keyword : defaultScheme + keyword;\n              var node = $('<a />').html(keyword).attr('href', link)[0];\n              this.lastWordRange.insertNode(node);\n              this.lastWordRange = null;\n              context.invoke('editor.focus');\n            }\n          };\n\n          this.handleKeydown = function (e) {\n            if (list.contains([key.code.ENTER, key.code.SPACE], e.keyCode)) {\n              var wordRange = context.invoke('editor.createRange').getWordRange();\n              this.lastWordRange = wordRange;\n            }\n          };\n\n          this.handleKeyup = function (e) {\n            if (list.contains([key.code.ENTER, key.code.SPACE], e.keyCode)) {\n              this.replace();\n            }\n          };\n        };\n        /**\n         * textarea auto sync.\n         */\n\n\n        var AutoSync = function (context) {\n          var $note = context.layoutInfo.note;\n          this.events = {\n            'summernote.change': function () {\n              $note.val(context.invoke('code'));\n            }\n          };\n\n          this.shouldInitialize = function () {\n            return dom.isTextarea($note[0]);\n          };\n        };\n\n        var Placeholder = function (context) {\n          var self = this;\n          var $editingArea = context.layoutInfo.editingArea;\n          var options = context.options;\n          this.events = {\n            'summernote.init summernote.change': function () {\n              self.update();\n            },\n            'summernote.codeview.toggled': function () {\n              self.update();\n            }\n          };\n\n          this.shouldInitialize = function () {\n            return !!options.placeholder;\n          };\n\n          this.initialize = function () {\n            this.$placeholder = $('<div class=\"note-placeholder\">');\n            this.$placeholder.on('click', function () {\n              context.invoke('focus');\n            }).text(options.placeholder).prependTo($editingArea);\n          };\n\n          this.destroy = function () {\n            this.$placeholder.remove();\n          };\n\n          this.update = function () {\n            var isShow = !context.invoke('codeview.isActivated') && context.invoke('editor.isEmpty');\n            this.$placeholder.toggle(isShow);\n          };\n        };\n\n        var Buttons = function (context) {\n          var self = this;\n          var ui = $.summernote.ui;\n          var $toolbar = context.layoutInfo.toolbar;\n          var options = context.options;\n          var lang = options.langInfo;\n          var invertedKeyMap = func.invertObject(options.keyMap[agent.isMac ? 'mac' : 'pc']);\n\n          var representShortcut = this.representShortcut = function (editorMethod) {\n            var shortcut = invertedKeyMap[editorMethod];\n\n            if (!options.shortcuts || !shortcut) {\n              return '';\n            }\n\n            if (agent.isMac) {\n              shortcut = shortcut.replace('CMD', '⌘').replace('SHIFT', '⇧');\n            }\n\n            shortcut = shortcut.replace('BACKSLASH', '\\\\').replace('SLASH', '/').replace('LEFTBRACKET', '[').replace('RIGHTBRACKET', ']');\n            return ' (' + shortcut + ')';\n          };\n\n          this.initialize = function () {\n            this.addToolbarButtons();\n            this.addImagePopoverButtons();\n            this.addLinkPopoverButtons();\n            this.fontInstalledMap = {};\n          };\n\n          this.destroy = function () {\n            delete this.fontInstalledMap;\n          };\n\n          this.isFontInstalled = function (name) {\n            if (!self.fontInstalledMap.hasOwnProperty(name)) {\n              self.fontInstalledMap[name] = agent.isFontInstalled(name) || list.contains(options.fontNamesIgnoreCheck, name);\n            }\n\n            return self.fontInstalledMap[name];\n          };\n\n          this.addToolbarButtons = function () {\n            context.memo('button.style', function () {\n              return ui.buttonGroup([ui.button({\n                className: 'dropdown-toggle',\n                contents: ui.icon(options.icons.magic) + ' ' + ui.icon(options.icons.caret, 'span'),\n                tooltip: lang.style.style,\n                data: {\n                  toggle: 'dropdown'\n                }\n              }), ui.dropdown({\n                className: 'dropdown-style',\n                items: context.options.styleTags,\n                template: function (item) {\n                  if (typeof item === 'string') {\n                    item = {\n                      tag: item,\n                      title: lang.style.hasOwnProperty(item) ? lang.style[item] : item\n                    };\n                  }\n\n                  var tag = item.tag;\n                  var title = item.title;\n                  var style = item.style ? ' style=\"' + item.style + '\" ' : '';\n                  var className = item.className ? ' class=\"' + item.className + '\"' : '';\n                  return '<' + tag + style + className + '>' + title + '</' + tag + '>';\n                },\n                click: context.createInvokeHandler('editor.formatBlock')\n              })]).render();\n            });\n            context.memo('button.bold', function () {\n              return ui.button({\n                className: 'note-btn-bold',\n                contents: ui.icon(options.icons.bold),\n                tooltip: lang.font.bold + representShortcut('bold'),\n                click: context.createInvokeHandler('editor.bold')\n              }).render();\n            });\n            context.memo('button.italic', function () {\n              return ui.button({\n                className: 'note-btn-italic',\n                contents: ui.icon(options.icons.italic),\n                tooltip: lang.font.italic + representShortcut('italic'),\n                click: context.createInvokeHandler('editor.italic')\n              }).render();\n            });\n            context.memo('button.underline', function () {\n              return ui.button({\n                className: 'note-btn-underline',\n                contents: ui.icon(options.icons.underline),\n                tooltip: lang.font.underline + representShortcut('underline'),\n                click: context.createInvokeHandler('editor.underline')\n              }).render();\n            });\n            context.memo('button.clear', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.eraser),\n                tooltip: lang.font.clear + representShortcut('removeFormat'),\n                click: context.createInvokeHandler('editor.removeFormat')\n              }).render();\n            });\n            context.memo('button.strikethrough', function () {\n              return ui.button({\n                className: 'note-btn-strikethrough',\n                contents: ui.icon(options.icons.strikethrough),\n                tooltip: lang.font.strikethrough + representShortcut('strikethrough'),\n                click: context.createInvokeHandler('editor.strikethrough')\n              }).render();\n            });\n            context.memo('button.superscript', function () {\n              return ui.button({\n                className: 'note-btn-superscript',\n                contents: ui.icon(options.icons.superscript),\n                tooltip: lang.font.superscript,\n                click: context.createInvokeHandler('editor.superscript')\n              }).render();\n            });\n            context.memo('button.subscript', function () {\n              return ui.button({\n                className: 'note-btn-subscript',\n                contents: ui.icon(options.icons.subscript),\n                tooltip: lang.font.subscript,\n                click: context.createInvokeHandler('editor.subscript')\n              }).render();\n            });\n            context.memo('button.fontname', function () {\n              return ui.buttonGroup([ui.button({\n                className: 'dropdown-toggle',\n                contents: '<span class=\"note-current-fontname\"/> ' + ui.icon(options.icons.caret, 'span'),\n                tooltip: lang.font.name,\n                data: {\n                  toggle: 'dropdown'\n                }\n              }), ui.dropdownCheck({\n                className: 'dropdown-fontname',\n                checkClassName: options.icons.menuCheck,\n                items: options.fontNames.filter(self.isFontInstalled),\n                template: function (item) {\n                  return '<span style=\"font-family:' + item + '\">' + item + '</span>';\n                },\n                click: context.createInvokeHandler('editor.fontName')\n              })]).render();\n            });\n            context.memo('button.fontsize', function () {\n              return ui.buttonGroup([ui.button({\n                className: 'dropdown-toggle',\n                contents: '<span class=\"note-current-fontsize\"/>' + ui.icon(options.icons.caret, 'span'),\n                tooltip: lang.font.size,\n                data: {\n                  toggle: 'dropdown'\n                }\n              }), ui.dropdownCheck({\n                className: 'dropdown-fontsize',\n                checkClassName: options.icons.menuCheck,\n                items: options.fontSizes,\n                click: context.createInvokeHandler('editor.fontSize')\n              })]).render();\n            });\n            context.memo('button.color', function () {\n              return ui.buttonGroup({\n                className: 'note-color',\n                children: [ui.button({\n                  className: 'note-current-color-button',\n                  contents: ui.icon(options.icons.font + ' note-recent-color'),\n                  tooltip: lang.color.recent,\n                  click: function (e) {\n                    var $button = $(e.currentTarget);\n                    context.invoke('editor.color', {\n                      backColor: $button.attr('data-backColor'),\n                      foreColor: $button.attr('data-foreColor')\n                    });\n                  },\n                  callback: function ($button) {\n                    var $recentColor = $button.find('.note-recent-color');\n                    $recentColor.css('background-color', '#FFFF00');\n                    $button.attr('data-backColor', '#FFFF00');\n                  }\n                }), ui.button({\n                  className: 'dropdown-toggle',\n                  contents: ui.icon(options.icons.caret, 'span'),\n                  tooltip: lang.color.more,\n                  data: {\n                    toggle: 'dropdown'\n                  }\n                }), ui.dropdown({\n                  items: ['<li>', '<div class=\"btn-group\">', '  <div class=\"note-palette-title\">' + lang.color.background + '</div>', '  <div>', '    <button type=\"button\" class=\"note-color-reset btn btn-default\" data-event=\"backColor\" data-value=\"inherit\">', lang.color.transparent, '    </button>', '  </div>', '  <div class=\"note-holder\" data-event=\"backColor\"/>', '</div>', '<div class=\"btn-group\">', '  <div class=\"note-palette-title\">' + lang.color.foreground + '</div>', '  <div>', '    <button type=\"button\" class=\"note-color-reset btn btn-default\" data-event=\"removeFormat\" data-value=\"foreColor\">', lang.color.resetToDefault, '    </button>', '  </div>', '  <div class=\"note-holder\" data-event=\"foreColor\"/>', '</div>', '</li>'].join(''),\n                  callback: function ($dropdown) {\n                    $dropdown.find('.note-holder').each(function () {\n                      var $holder = $(this);\n                      $holder.append(ui.palette({\n                        colors: options.colors,\n                        eventName: $holder.data('event')\n                      }).render());\n                    });\n                  },\n                  click: function (event) {\n                    var $button = $(event.target);\n                    var eventName = $button.data('event');\n                    var value = $button.data('value');\n\n                    if (eventName && value) {\n                      var key = eventName === 'backColor' ? 'background-color' : 'color';\n                      var $color = $button.closest('.note-color').find('.note-recent-color');\n                      var $currentButton = $button.closest('.note-color').find('.note-current-color-button');\n                      $color.css(key, value);\n                      $currentButton.attr('data-' + eventName, value);\n                      context.invoke('editor.' + eventName, value);\n                    }\n                  }\n                })]\n              }).render();\n            });\n            context.memo('button.ul', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.unorderedlist),\n                tooltip: lang.lists.unordered + representShortcut('insertUnorderedList'),\n                click: context.createInvokeHandler('editor.insertUnorderedList')\n              }).render();\n            });\n            context.memo('button.ol', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.orderedlist),\n                tooltip: lang.lists.ordered + representShortcut('insertOrderedList'),\n                click: context.createInvokeHandler('editor.insertOrderedList')\n              }).render();\n            });\n            var justifyLeft = ui.button({\n              contents: ui.icon(options.icons.alignLeft),\n              tooltip: lang.paragraph.left + representShortcut('justifyLeft'),\n              click: context.createInvokeHandler('editor.justifyLeft')\n            });\n            var justifyCenter = ui.button({\n              contents: ui.icon(options.icons.alignCenter),\n              tooltip: lang.paragraph.center + representShortcut('justifyCenter'),\n              click: context.createInvokeHandler('editor.justifyCenter')\n            });\n            var justifyRight = ui.button({\n              contents: ui.icon(options.icons.alignRight),\n              tooltip: lang.paragraph.right + representShortcut('justifyRight'),\n              click: context.createInvokeHandler('editor.justifyRight')\n            });\n            var justifyFull = ui.button({\n              contents: ui.icon(options.icons.alignJustify),\n              tooltip: lang.paragraph.justify + representShortcut('justifyFull'),\n              click: context.createInvokeHandler('editor.justifyFull')\n            });\n            var outdent = ui.button({\n              contents: ui.icon(options.icons.outdent),\n              tooltip: lang.paragraph.outdent + representShortcut('outdent'),\n              click: context.createInvokeHandler('editor.outdent')\n            });\n            var indent = ui.button({\n              contents: ui.icon(options.icons.indent),\n              tooltip: lang.paragraph.indent + representShortcut('indent'),\n              click: context.createInvokeHandler('editor.indent')\n            });\n            context.memo('button.justifyLeft', func.invoke(justifyLeft, 'render'));\n            context.memo('button.justifyCenter', func.invoke(justifyCenter, 'render'));\n            context.memo('button.justifyRight', func.invoke(justifyRight, 'render'));\n            context.memo('button.justifyFull', func.invoke(justifyFull, 'render'));\n            context.memo('button.outdent', func.invoke(outdent, 'render'));\n            context.memo('button.indent', func.invoke(indent, 'render'));\n            context.memo('button.paragraph', function () {\n              return ui.buttonGroup([ui.button({\n                className: 'dropdown-toggle',\n                contents: ui.icon(options.icons.alignLeft) + ' ' + ui.icon(options.icons.caret, 'span'),\n                tooltip: lang.paragraph.paragraph,\n                data: {\n                  toggle: 'dropdown'\n                }\n              }), ui.dropdown([ui.buttonGroup({\n                className: 'note-align',\n                children: [justifyLeft, justifyCenter, justifyRight, justifyFull]\n              }), ui.buttonGroup({\n                className: 'note-list',\n                children: [outdent, indent]\n              })])]).render();\n            });\n            context.memo('button.height', function () {\n              return ui.buttonGroup([ui.button({\n                className: 'dropdown-toggle',\n                contents: ui.icon(options.icons.textHeight) + ' ' + ui.icon(options.icons.caret, 'span'),\n                tooltip: lang.font.height,\n                data: {\n                  toggle: 'dropdown'\n                }\n              }), ui.dropdownCheck({\n                items: options.lineHeights,\n                checkClassName: options.icons.menuCheck,\n                className: 'dropdown-line-height',\n                click: context.createInvokeHandler('editor.lineHeight')\n              })]).render();\n            });\n            context.memo('button.table', function () {\n              return ui.buttonGroup([ui.button({\n                className: 'dropdown-toggle',\n                contents: ui.icon(options.icons.table) + ' ' + ui.icon(options.icons.caret, 'span'),\n                tooltip: lang.table.table,\n                data: {\n                  toggle: 'dropdown'\n                }\n              }), ui.dropdown({\n                className: 'note-table',\n                items: ['<div class=\"note-dimension-picker\">', '  <div class=\"note-dimension-picker-mousecatcher\" data-event=\"insertTable\" data-value=\"1x1\"/>', '  <div class=\"note-dimension-picker-highlighted\"/>', '  <div class=\"note-dimension-picker-unhighlighted\"/>', '</div>', '<div class=\"note-dimension-display\">1 x 1</div>'].join('')\n              })], {\n                callback: function ($node) {\n                  var $catcher = $node.find('.note-dimension-picker-mousecatcher');\n                  $catcher.css({\n                    width: options.insertTableMaxSize.col + 'em',\n                    height: options.insertTableMaxSize.row + 'em'\n                  }).mousedown(context.createInvokeHandler('editor.insertTable')).on('mousemove', self.tableMoveHandler);\n                }\n              }).render();\n            });\n            context.memo('button.link', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.link),\n                tooltip: lang.link.link + representShortcut('linkDialog.show'),\n                click: context.createInvokeHandler('linkDialog.show')\n              }).render();\n            });\n            context.memo('button.picture', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.picture),\n                tooltip: lang.image.image,\n                click: context.createInvokeHandler('imageDialog.show')\n              }).render();\n            });\n            context.memo('button.video', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.video),\n                tooltip: lang.video.video,\n                click: context.createInvokeHandler('videoDialog.show')\n              }).render();\n            });\n            context.memo('button.hr', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.minus),\n                tooltip: lang.hr.insert + representShortcut('insertHorizontalRule'),\n                click: context.createInvokeHandler('editor.insertHorizontalRule')\n              }).render();\n            });\n            context.memo('button.fullscreen', function () {\n              return ui.button({\n                className: 'btn-fullscreen',\n                contents: ui.icon(options.icons.arrowsAlt),\n                tooltip: lang.options.fullscreen,\n                click: context.createInvokeHandler('fullscreen.toggle')\n              }).render();\n            });\n            context.memo('button.codeview', function () {\n              return ui.button({\n                className: 'btn-codeview',\n                contents: ui.icon(options.icons.code),\n                tooltip: lang.options.codeview,\n                click: context.createInvokeHandler('codeview.toggle')\n              }).render();\n            });\n            context.memo('button.redo', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.redo),\n                tooltip: lang.history.redo + representShortcut('redo'),\n                click: context.createInvokeHandler('editor.redo')\n              }).render();\n            });\n            context.memo('button.undo', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.undo),\n                tooltip: lang.history.undo + representShortcut('undo'),\n                click: context.createInvokeHandler('editor.undo')\n              }).render();\n            });\n            context.memo('button.help', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.question),\n                tooltip: lang.options.help,\n                click: context.createInvokeHandler('helpDialog.show')\n              }).render();\n            });\n          };\n          /**\n           * image : [\n           *   ['imagesize', ['imageSize100', 'imageSize50', 'imageSize25']],\n           *   ['float', ['floatLeft', 'floatRight', 'floatNone' ]],\n           *   ['remove', ['removeMedia']]\n           * ],\n           */\n\n\n          this.addImagePopoverButtons = function () {\n            // Image Size Buttons\n            context.memo('button.imageSize100', function () {\n              return ui.button({\n                contents: '<span class=\"note-fontsize-10\">100%</span>',\n                tooltip: lang.image.resizeFull,\n                click: context.createInvokeHandler('editor.resize', '1')\n              }).render();\n            });\n            context.memo('button.imageSize50', function () {\n              return ui.button({\n                contents: '<span class=\"note-fontsize-10\">50%</span>',\n                tooltip: lang.image.resizeHalf,\n                click: context.createInvokeHandler('editor.resize', '0.5')\n              }).render();\n            });\n            context.memo('button.imageSize25', function () {\n              return ui.button({\n                contents: '<span class=\"note-fontsize-10\">25%</span>',\n                tooltip: lang.image.resizeQuarter,\n                click: context.createInvokeHandler('editor.resize', '0.25')\n              }).render();\n            }); // Float Buttons\n\n            context.memo('button.floatLeft', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.alignLeft),\n                tooltip: lang.image.floatLeft,\n                click: context.createInvokeHandler('editor.floatMe', 'left')\n              }).render();\n            });\n            context.memo('button.floatRight', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.alignRight),\n                tooltip: lang.image.floatRight,\n                click: context.createInvokeHandler('editor.floatMe', 'right')\n              }).render();\n            });\n            context.memo('button.floatNone', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.alignJustify),\n                tooltip: lang.image.floatNone,\n                click: context.createInvokeHandler('editor.floatMe', 'none')\n              }).render();\n            }); // Remove Buttons\n\n            context.memo('button.removeMedia', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.trash),\n                tooltip: lang.image.remove,\n                click: context.createInvokeHandler('editor.removeMedia')\n              }).render();\n            });\n          };\n\n          this.addLinkPopoverButtons = function () {\n            context.memo('button.linkDialogShow', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.link),\n                tooltip: lang.link.edit,\n                click: context.createInvokeHandler('linkDialog.show')\n              }).render();\n            });\n            context.memo('button.unlink', function () {\n              return ui.button({\n                contents: ui.icon(options.icons.unlink),\n                tooltip: lang.link.unlink,\n                click: context.createInvokeHandler('editor.unlink')\n              }).render();\n            });\n          };\n\n          this.build = function ($container, groups) {\n            for (var groupIdx = 0, groupLen = groups.length; groupIdx < groupLen; groupIdx++) {\n              var group = groups[groupIdx];\n              var groupName = group[0];\n              var buttons = group[1];\n              var $group = ui.buttonGroup({\n                className: 'note-' + groupName\n              }).render();\n\n              for (var idx = 0, len = buttons.length; idx < len; idx++) {\n                var button = context.memo('button.' + buttons[idx]);\n\n                if (button) {\n                  $group.append(typeof button === 'function' ? button(context) : button);\n                }\n              }\n\n              $group.appendTo($container);\n            }\n          };\n\n          this.updateCurrentStyle = function () {\n            var styleInfo = context.invoke('editor.currentStyle');\n            this.updateBtnStates({\n              '.note-btn-bold': function () {\n                return styleInfo['font-bold'] === 'bold';\n              },\n              '.note-btn-italic': function () {\n                return styleInfo['font-italic'] === 'italic';\n              },\n              '.note-btn-underline': function () {\n                return styleInfo['font-underline'] === 'underline';\n              },\n              '.note-btn-subscript': function () {\n                return styleInfo['font-subscript'] === 'subscript';\n              },\n              '.note-btn-superscript': function () {\n                return styleInfo['font-superscript'] === 'superscript';\n              },\n              '.note-btn-strikethrough': function () {\n                return styleInfo['font-strikethrough'] === 'strikethrough';\n              }\n            });\n\n            if (styleInfo['font-family']) {\n              var fontNames = styleInfo['font-family'].split(',').map(function (name) {\n                return name.replace(/[\\'\\\"]/g, '').replace(/\\s+$/, '').replace(/^\\s+/, '');\n              });\n              var fontName = list.find(fontNames, self.isFontInstalled);\n              $toolbar.find('.dropdown-fontname li a').each(function () {\n                // always compare string to avoid creating another func.\n                var isChecked = $(this).data('value') + '' === fontName + '';\n                this.className = isChecked ? 'checked' : '';\n              });\n              $toolbar.find('.note-current-fontname').text(fontName);\n            }\n\n            if (styleInfo['font-size']) {\n              var fontSize = styleInfo['font-size'];\n              $toolbar.find('.dropdown-fontsize li a').each(function () {\n                // always compare with string to avoid creating another func.\n                var isChecked = $(this).data('value') + '' === fontSize + '';\n                this.className = isChecked ? 'checked' : '';\n              });\n              $toolbar.find('.note-current-fontsize').text(fontSize);\n            }\n\n            if (styleInfo['line-height']) {\n              var lineHeight = styleInfo['line-height'];\n              $toolbar.find('.dropdown-line-height li a').each(function () {\n                // always compare with string to avoid creating another func.\n                var isChecked = $(this).data('value') + '' === lineHeight + '';\n                this.className = isChecked ? 'checked' : '';\n              });\n            }\n          };\n\n          this.updateBtnStates = function (infos) {\n            $.each(infos, function (selector, pred) {\n              ui.toggleBtnActive($toolbar.find(selector), pred());\n            });\n          };\n\n          this.tableMoveHandler = function (event) {\n            var PX_PER_EM = 18;\n            var $picker = $(event.target.parentNode); // target is mousecatcher\n\n            var $dimensionDisplay = $picker.next();\n            var $catcher = $picker.find('.note-dimension-picker-mousecatcher');\n            var $highlighted = $picker.find('.note-dimension-picker-highlighted');\n            var $unhighlighted = $picker.find('.note-dimension-picker-unhighlighted');\n            var posOffset; // HTML5 with jQuery - e.offsetX is undefined in Firefox\n\n            if (event.offsetX === undefined) {\n              var posCatcher = $(event.target).offset();\n              posOffset = {\n                x: event.pageX - posCatcher.left,\n                y: event.pageY - posCatcher.top\n              };\n            } else {\n              posOffset = {\n                x: event.offsetX,\n                y: event.offsetY\n              };\n            }\n\n            var dim = {\n              c: Math.ceil(posOffset.x / PX_PER_EM) || 1,\n              r: Math.ceil(posOffset.y / PX_PER_EM) || 1\n            };\n            $highlighted.css({\n              width: dim.c + 'em',\n              height: dim.r + 'em'\n            });\n            $catcher.data('value', dim.c + 'x' + dim.r);\n\n            if (3 < dim.c && dim.c < options.insertTableMaxSize.col) {\n              $unhighlighted.css({\n                width: dim.c + 1 + 'em'\n              });\n            }\n\n            if (3 < dim.r && dim.r < options.insertTableMaxSize.row) {\n              $unhighlighted.css({\n                height: dim.r + 1 + 'em'\n              });\n            }\n\n            $dimensionDisplay.html(dim.c + ' x ' + dim.r);\n          };\n        };\n\n        var Toolbar = function (context) {\n          var ui = $.summernote.ui;\n          var $note = context.layoutInfo.note;\n          var $toolbar = context.layoutInfo.toolbar;\n          var options = context.options;\n\n          this.shouldInitialize = function () {\n            return !options.airMode;\n          };\n\n          this.initialize = function () {\n            options.toolbar = options.toolbar || [];\n\n            if (!options.toolbar.length) {\n              $toolbar.hide();\n            } else {\n              context.invoke('buttons.build', $toolbar, options.toolbar);\n            }\n\n            if (options.toolbarContainer) {\n              $toolbar.appendTo(options.toolbarContainer);\n            }\n\n            $note.on('summernote.keyup summernote.mouseup summernote.change', function () {\n              context.invoke('buttons.updateCurrentStyle');\n            });\n            context.invoke('buttons.updateCurrentStyle');\n          };\n\n          this.destroy = function () {\n            $toolbar.children().remove();\n          };\n\n          this.updateFullscreen = function (isFullscreen) {\n            ui.toggleBtnActive($toolbar.find('.btn-fullscreen'), isFullscreen);\n          };\n\n          this.updateCodeview = function (isCodeview) {\n            ui.toggleBtnActive($toolbar.find('.btn-codeview'), isCodeview);\n\n            if (isCodeview) {\n              this.deactivate();\n            } else {\n              this.activate();\n            }\n          };\n\n          this.activate = function (isIncludeCodeview) {\n            var $btn = $toolbar.find('button');\n\n            if (!isIncludeCodeview) {\n              $btn = $btn.not('.btn-codeview');\n            }\n\n            ui.toggleBtn($btn, true);\n          };\n\n          this.deactivate = function (isIncludeCodeview) {\n            var $btn = $toolbar.find('button');\n\n            if (!isIncludeCodeview) {\n              $btn = $btn.not('.btn-codeview');\n            }\n\n            ui.toggleBtn($btn, false);\n          };\n        };\n\n        var LinkDialog = function (context) {\n          var self = this;\n          var ui = $.summernote.ui;\n          var $editor = context.layoutInfo.editor;\n          var options = context.options;\n          var lang = options.langInfo;\n\n          this.initialize = function () {\n            var $container = options.dialogsInBody ? $(document.body) : $editor;\n            var body = '<div class=\"form-group\">' + '<label>' + lang.link.textToDisplay + '</label>' + '<input class=\"note-link-text form-control\" type=\"text\" />' + '</div>' + '<div class=\"form-group\">' + '<label>' + lang.link.url + '</label>' + '<input class=\"note-link-url form-control\" type=\"text\" value=\"http://\" />' + '</div>' + (!options.disableLinkTarget ? '<div class=\"checkbox\">' + '<label>' + '<input type=\"checkbox\" checked> ' + lang.link.openInNewWindow + '</label>' + '</div>' : '');\n            var footer = '<button href=\"#\" class=\"btn btn-primary note-link-btn disabled\" disabled>' + lang.link.insert + '</button>';\n            this.$dialog = ui.dialog({\n              className: 'link-dialog',\n              title: lang.link.insert,\n              fade: options.dialogsFade,\n              body: body,\n              footer: footer\n            }).render().appendTo($container);\n          };\n\n          this.destroy = function () {\n            ui.hideDialog(this.$dialog);\n            this.$dialog.remove();\n          };\n\n          this.bindEnterKey = function ($input, $btn) {\n            $input.on('keypress', function (event) {\n              if (event.keyCode === key.code.ENTER) {\n                $btn.trigger('click');\n              }\n            });\n          };\n          /**\n           * toggle update button\n           */\n\n\n          this.toggleLinkBtn = function ($linkBtn, $linkText, $linkUrl) {\n            ui.toggleBtn($linkBtn, $linkText.val() && $linkUrl.val());\n          };\n          /**\n           * Show link dialog and set event handlers on dialog controls.\n           *\n           * @param {Object} linkInfo\n           * @return {Promise}\n           */\n\n\n          this.showLinkDialog = function (linkInfo) {\n            return $.Deferred(function (deferred) {\n              var $linkText = self.$dialog.find('.note-link-text'),\n                  $linkUrl = self.$dialog.find('.note-link-url'),\n                  $linkBtn = self.$dialog.find('.note-link-btn'),\n                  $openInNewWindow = self.$dialog.find('input[type=checkbox]');\n              ui.onDialogShown(self.$dialog, function () {\n                context.triggerEvent('dialog.shown'); // if no url was given, copy text to url\n\n                if (!linkInfo.url) {\n                  linkInfo.url = linkInfo.text;\n                }\n\n                $linkText.val(linkInfo.text);\n\n                var handleLinkTextUpdate = function () {\n                  self.toggleLinkBtn($linkBtn, $linkText, $linkUrl); // if linktext was modified by keyup,\n                  // stop cloning text from linkUrl\n\n                  linkInfo.text = $linkText.val();\n                };\n\n                $linkText.on('input', handleLinkTextUpdate).on('paste', function () {\n                  setTimeout(handleLinkTextUpdate, 0);\n                });\n\n                var handleLinkUrlUpdate = function () {\n                  self.toggleLinkBtn($linkBtn, $linkText, $linkUrl); // display same link on `Text to display` input\n                  // when create a new link\n\n                  if (!linkInfo.text) {\n                    $linkText.val($linkUrl.val());\n                  }\n                };\n\n                $linkUrl.on('input', handleLinkUrlUpdate).on('paste', function () {\n                  setTimeout(handleLinkUrlUpdate, 0);\n                }).val(linkInfo.url).trigger('focus');\n                self.toggleLinkBtn($linkBtn, $linkText, $linkUrl);\n                self.bindEnterKey($linkUrl, $linkBtn);\n                self.bindEnterKey($linkText, $linkBtn);\n                $openInNewWindow.prop('checked', linkInfo.isNewWindow);\n                $linkBtn.one('click', function (event) {\n                  event.preventDefault();\n                  deferred.resolve({\n                    range: linkInfo.range,\n                    url: $linkUrl.val(),\n                    text: $linkText.val(),\n                    isNewWindow: $openInNewWindow.is(':checked')\n                  });\n                  self.$dialog.modal('hide');\n                });\n              });\n              ui.onDialogHidden(self.$dialog, function () {\n                // detach events\n                $linkText.off('input paste keypress');\n                $linkUrl.off('input paste keypress');\n                $linkBtn.off('click');\n\n                if (deferred.state() === 'pending') {\n                  deferred.reject();\n                }\n              });\n              ui.showDialog(self.$dialog);\n            }).promise();\n          };\n          /**\n           * @param {Object} layoutInfo\n           */\n\n\n          this.show = function () {\n            var linkInfo = context.invoke('editor.getLinkInfo');\n            context.invoke('editor.saveRange');\n            this.showLinkDialog(linkInfo).then(function (linkInfo) {\n              context.invoke('editor.restoreRange');\n              context.invoke('editor.createLink', linkInfo);\n            }).fail(function () {\n              context.invoke('editor.restoreRange');\n            });\n          };\n\n          context.memo('help.linkDialog.show', options.langInfo.help['linkDialog.show']);\n        };\n\n        var LinkPopover = function (context) {\n          var self = this;\n          var ui = $.summernote.ui;\n          var options = context.options;\n          this.events = {\n            'summernote.keyup summernote.mouseup summernote.change summernote.scroll': function () {\n              self.update();\n            },\n            'summernote.dialog.shown': function () {\n              self.hide();\n            }\n          };\n\n          this.shouldInitialize = function () {\n            return !list.isEmpty(options.popover.link);\n          };\n\n          this.initialize = function () {\n            this.$popover = ui.popover({\n              className: 'note-link-popover',\n              callback: function ($node) {\n                var $content = $node.find('.popover-content');\n                $content.prepend('<span><a target=\"_blank\"></a>&nbsp;</span>');\n              }\n            }).render().appendTo('body');\n            var $content = this.$popover.find('.popover-content');\n            context.invoke('buttons.build', $content, options.popover.link);\n          };\n\n          this.destroy = function () {\n            this.$popover.remove();\n          };\n\n          this.update = function () {\n            // Prevent focusing on editable when invoke('code') is executed\n            if (!context.invoke('editor.hasFocus')) {\n              this.hide();\n              return;\n            }\n\n            var rng = context.invoke('editor.createRange');\n\n            if (rng.isCollapsed() && rng.isOnAnchor()) {\n              var anchor = dom.ancestor(rng.sc, dom.isAnchor);\n              var href = $(anchor).attr('href');\n              this.$popover.find('a').attr('href', href).html(href);\n              var pos = dom.posFromPlaceholder(anchor);\n              this.$popover.css({\n                display: 'block',\n                left: pos.left,\n                top: pos.top\n              });\n            } else {\n              this.hide();\n            }\n          };\n\n          this.hide = function () {\n            this.$popover.hide();\n          };\n        };\n\n        var ImageDialog = function (context) {\n          var self = this;\n          var ui = $.summernote.ui;\n          var $editor = context.layoutInfo.editor;\n          var options = context.options;\n          var lang = options.langInfo;\n\n          this.initialize = function () {\n            var $container = options.dialogsInBody ? $(document.body) : $editor;\n            var imageLimitation = '';\n\n            if (options.maximumImageFileSize) {\n              var unit = Math.floor(Math.log(options.maximumImageFileSize) / Math.log(1024));\n              var readableSize = (options.maximumImageFileSize / Math.pow(1024, unit)).toFixed(2) * 1 + ' ' + ' KMGTP'[unit] + 'B';\n              imageLimitation = '<small>' + lang.image.maximumFileSize + ' : ' + readableSize + '</small>';\n            }\n\n            var body = '<div class=\"form-group note-group-select-from-files\">' + '<label>' + lang.image.selectFromFiles + '</label>' + '<input class=\"note-image-input form-control\" type=\"file\" name=\"files\" accept=\"image/*\" multiple=\"multiple\" />' + imageLimitation + '</div>' + '<div class=\"form-group note-group-image-url\" style=\"overflow:auto;\">' + '<label>' + lang.image.url + '</label>' + '<input class=\"note-image-url form-control col-md-12\" type=\"text\" />' + '</div>';\n            var footer = '<button href=\"#\" class=\"btn btn-primary note-image-btn disabled\" disabled>' + lang.image.insert + '</button>';\n            this.$dialog = ui.dialog({\n              title: lang.image.insert,\n              fade: options.dialogsFade,\n              body: body,\n              footer: footer\n            }).render().appendTo($container);\n          };\n\n          this.destroy = function () {\n            ui.hideDialog(this.$dialog);\n            this.$dialog.remove();\n          };\n\n          this.bindEnterKey = function ($input, $btn) {\n            $input.on('keypress', function (event) {\n              if (event.keyCode === key.code.ENTER) {\n                $btn.trigger('click');\n              }\n            });\n          };\n\n          this.show = function () {\n            context.invoke('editor.saveRange');\n            this.showImageDialog().then(function (data) {\n              // [workaround] hide dialog before restore range for IE range focus\n              ui.hideDialog(self.$dialog);\n              context.invoke('editor.restoreRange');\n\n              if (typeof data === 'string') {\n                // image url\n                context.invoke('editor.insertImage', data);\n              } else {\n                // array of files\n                context.invoke('editor.insertImagesOrCallback', data);\n              }\n            }).fail(function () {\n              context.invoke('editor.restoreRange');\n            });\n          };\n          /**\n           * show image dialog\n           *\n           * @param {jQuery} $dialog\n           * @return {Promise}\n           */\n\n\n          this.showImageDialog = function () {\n            return $.Deferred(function (deferred) {\n              var $imageInput = self.$dialog.find('.note-image-input'),\n                  $imageUrl = self.$dialog.find('.note-image-url'),\n                  $imageBtn = self.$dialog.find('.note-image-btn');\n              ui.onDialogShown(self.$dialog, function () {\n                context.triggerEvent('dialog.shown'); // Cloning imageInput to clear element.\n\n                $imageInput.replaceWith($imageInput.clone().on('change', function () {\n                  deferred.resolve(this.files || this.value);\n                }).val(''));\n                $imageBtn.click(function (event) {\n                  event.preventDefault();\n                  deferred.resolve($imageUrl.val());\n                });\n                $imageUrl.on('keyup paste', function () {\n                  var url = $imageUrl.val();\n                  ui.toggleBtn($imageBtn, url);\n                }).val('').trigger('focus');\n                self.bindEnterKey($imageUrl, $imageBtn);\n              });\n              ui.onDialogHidden(self.$dialog, function () {\n                $imageInput.off('change');\n                $imageUrl.off('keyup paste keypress');\n                $imageBtn.off('click');\n\n                if (deferred.state() === 'pending') {\n                  deferred.reject();\n                }\n              });\n              ui.showDialog(self.$dialog);\n            });\n          };\n        };\n\n        var ImagePopover = function (context) {\n          var ui = $.summernote.ui;\n          var options = context.options;\n\n          this.shouldInitialize = function () {\n            return !list.isEmpty(options.popover.image);\n          };\n\n          this.initialize = function () {\n            this.$popover = ui.popover({\n              className: 'note-image-popover'\n            }).render().appendTo('body');\n            var $content = this.$popover.find('.popover-content');\n            context.invoke('buttons.build', $content, options.popover.image);\n          };\n\n          this.destroy = function () {\n            this.$popover.remove();\n          };\n\n          this.update = function (target) {\n            if (dom.isImg(target)) {\n              var pos = dom.posFromPlaceholder(target);\n              this.$popover.css({\n                display: 'block',\n                left: pos.left,\n                top: pos.top\n              });\n            } else {\n              this.hide();\n            }\n          };\n\n          this.hide = function () {\n            this.$popover.hide();\n          };\n        };\n\n        var VideoDialog = function (context) {\n          var self = this;\n          var ui = $.summernote.ui;\n          var $editor = context.layoutInfo.editor;\n          var options = context.options;\n          var lang = options.langInfo;\n\n          this.initialize = function () {\n            var $container = options.dialogsInBody ? $(document.body) : $editor;\n            var body = '<div class=\"form-group row-fluid\">' + '<label>' + lang.video.url + ' <small class=\"text-muted\">' + lang.video.providers + '</small></label>' + '<input class=\"note-video-url form-control span12\" type=\"text\" />' + '</div>';\n            var footer = '<button href=\"#\" class=\"btn btn-primary note-video-btn disabled\" disabled>' + lang.video.insert + '</button>';\n            this.$dialog = ui.dialog({\n              title: lang.video.insert,\n              fade: options.dialogsFade,\n              body: body,\n              footer: footer\n            }).render().appendTo($container);\n          };\n\n          this.destroy = function () {\n            ui.hideDialog(this.$dialog);\n            this.$dialog.remove();\n          };\n\n          this.bindEnterKey = function ($input, $btn) {\n            $input.on('keypress', function (event) {\n              if (event.keyCode === key.code.ENTER) {\n                $btn.trigger('click');\n              }\n            });\n          };\n\n          this.createVideoNode = function (url) {\n            // video url patterns(youtube, instagram, vimeo, dailymotion, youku, mp4, ogg, webm)\n            var ytRegExp = /^(?:https?:\\/\\/)?(?:www\\.)?(?:youtu\\.be\\/|youtube\\.com\\/(?:embed\\/|v\\/|watch\\?v=|watch\\?.+&v=))((\\w|-){11})(?:\\S+)?$/;\n            var ytMatch = url.match(ytRegExp);\n            var igRegExp = /(?:www\\.|\\/\\/)instagram\\.com\\/p\\/(.[a-zA-Z0-9_-]*)/;\n            var igMatch = url.match(igRegExp);\n            var vRegExp = /\\/\\/vine\\.co\\/v\\/([a-zA-Z0-9]+)/;\n            var vMatch = url.match(vRegExp);\n            var vimRegExp = /\\/\\/(player\\.)?vimeo\\.com\\/([a-z]*\\/)*([0-9]{6,11})[?]?.*/;\n            var vimMatch = url.match(vimRegExp);\n            var dmRegExp = /.+dailymotion.com\\/(video|hub)\\/([^_]+)[^#]*(#video=([^_&]+))?/;\n            var dmMatch = url.match(dmRegExp);\n            var youkuRegExp = /\\/\\/v\\.youku\\.com\\/v_show\\/id_(\\w+)=*\\.html/;\n            var youkuMatch = url.match(youkuRegExp);\n            var mp4RegExp = /^.+.(mp4|m4v)$/;\n            var mp4Match = url.match(mp4RegExp);\n            var oggRegExp = /^.+.(ogg|ogv)$/;\n            var oggMatch = url.match(oggRegExp);\n            var webmRegExp = /^.+.(webm)$/;\n            var webmMatch = url.match(webmRegExp);\n            var $video;\n\n            if (ytMatch && ytMatch[1].length === 11) {\n              var youtubeId = ytMatch[1];\n              $video = $('<iframe>').attr('frameborder', 0).attr('src', '//www.youtube.com/embed/' + youtubeId).attr('width', '640').attr('height', '360');\n            } else if (igMatch && igMatch[0].length) {\n              $video = $('<iframe>').attr('frameborder', 0).attr('src', 'https://instagram.com/p/' + igMatch[1] + '/embed/').attr('width', '612').attr('height', '710').attr('scrolling', 'no').attr('allowtransparency', 'true');\n            } else if (vMatch && vMatch[0].length) {\n              $video = $('<iframe>').attr('frameborder', 0).attr('src', vMatch[0] + '/embed/simple').attr('width', '600').attr('height', '600').attr('class', 'vine-embed');\n            } else if (vimMatch && vimMatch[3].length) {\n              $video = $('<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>').attr('frameborder', 0).attr('src', '//player.vimeo.com/video/' + vimMatch[3]).attr('width', '640').attr('height', '360');\n            } else if (dmMatch && dmMatch[2].length) {\n              $video = $('<iframe>').attr('frameborder', 0).attr('src', '//www.dailymotion.com/embed/video/' + dmMatch[2]).attr('width', '640').attr('height', '360');\n            } else if (youkuMatch && youkuMatch[1].length) {\n              $video = $('<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>').attr('frameborder', 0).attr('height', '498').attr('width', '510').attr('src', '//player.youku.com/embed/' + youkuMatch[1]);\n            } else if (mp4Match || oggMatch || webmMatch) {\n              $video = $('<video controls>').attr('src', url).attr('width', '640').attr('height', '360');\n            } else {\n              // this is not a known video link. Now what, Cat? Now what?\n              return false;\n            }\n\n            $video.addClass('note-video-clip');\n            return $video[0];\n          };\n\n          this.show = function () {\n            var text = context.invoke('editor.getSelectedText');\n            context.invoke('editor.saveRange');\n            this.showVideoDialog(text).then(function (url) {\n              // [workaround] hide dialog before restore range for IE range focus\n              ui.hideDialog(self.$dialog);\n              context.invoke('editor.restoreRange'); // build node\n\n              var $node = self.createVideoNode(url);\n\n              if ($node) {\n                // insert video node\n                context.invoke('editor.insertNode', $node);\n              }\n            }).fail(function () {\n              context.invoke('editor.restoreRange');\n            });\n          };\n          /**\n           * show image dialog\n           *\n           * @param {jQuery} $dialog\n           * @return {Promise}\n           */\n\n\n          this.showVideoDialog = function (text) {\n            return $.Deferred(function (deferred) {\n              var $videoUrl = self.$dialog.find('.note-video-url'),\n                  $videoBtn = self.$dialog.find('.note-video-btn');\n              ui.onDialogShown(self.$dialog, function () {\n                context.triggerEvent('dialog.shown');\n                $videoUrl.val(text).on('input', function () {\n                  ui.toggleBtn($videoBtn, $videoUrl.val());\n                }).trigger('focus');\n                $videoBtn.click(function (event) {\n                  event.preventDefault();\n                  deferred.resolve($videoUrl.val());\n                });\n                self.bindEnterKey($videoUrl, $videoBtn);\n              });\n              ui.onDialogHidden(self.$dialog, function () {\n                $videoUrl.off('input');\n                $videoBtn.off('click');\n\n                if (deferred.state() === 'pending') {\n                  deferred.reject();\n                }\n              });\n              ui.showDialog(self.$dialog);\n            });\n          };\n        };\n\n        var HelpDialog = function (context) {\n          var self = this;\n          var ui = $.summernote.ui;\n          var $editor = context.layoutInfo.editor;\n          var options = context.options;\n          var lang = options.langInfo;\n\n          this.createShortCutList = function () {\n            var keyMap = options.keyMap[agent.isMac ? 'mac' : 'pc'];\n            return Object.keys(keyMap).map(function (key) {\n              var command = keyMap[key];\n              var $row = $('<div><div class=\"help-list-item\"/></div>');\n              $row.append($('<label><kbd>' + key + '</kdb></label>').css({\n                'width': 180,\n                'margin-right': 10\n              })).append($('<span/>').html(context.memo('help.' + command) || command));\n              return $row.html();\n            }).join('');\n          };\n\n          this.initialize = function () {\n            var $container = options.dialogsInBody ? $(document.body) : $editor;\n            var body = ['<p class=\"text-center\">', '<a href=\"http://summernote.org/\" target=\"_blank\">Summernote 0.8.3</a> · ', '<a href=\"https://github.com/summernote/summernote\" target=\"_blank\">Project</a> · ', '<a href=\"https://github.com/summernote/summernote/issues\" target=\"_blank\">Issues</a>', '</p>'].join('');\n            this.$dialog = ui.dialog({\n              title: lang.options.help,\n              fade: options.dialogsFade,\n              body: this.createShortCutList(),\n              footer: body,\n              callback: function ($node) {\n                $node.find('.modal-body').css({\n                  'max-height': 300,\n                  'overflow': 'scroll'\n                });\n              }\n            }).render().appendTo($container);\n          };\n\n          this.destroy = function () {\n            ui.hideDialog(this.$dialog);\n            this.$dialog.remove();\n          };\n          /**\n           * show help dialog\n           *\n           * @return {Promise}\n           */\n\n\n          this.showHelpDialog = function () {\n            return $.Deferred(function (deferred) {\n              ui.onDialogShown(self.$dialog, function () {\n                context.triggerEvent('dialog.shown');\n                deferred.resolve();\n              });\n              ui.showDialog(self.$dialog);\n            }).promise();\n          };\n\n          this.show = function () {\n            context.invoke('editor.saveRange');\n            this.showHelpDialog().then(function () {\n              context.invoke('editor.restoreRange');\n            });\n          };\n        };\n\n        var AirPopover = function (context) {\n          var self = this;\n          var ui = $.summernote.ui;\n          var options = context.options;\n          var AIR_MODE_POPOVER_X_OFFSET = 20;\n          this.events = {\n            'summernote.keyup summernote.mouseup summernote.scroll': function () {\n              self.update();\n            },\n            'summernote.change summernote.dialog.shown': function () {\n              self.hide();\n            },\n            'summernote.focusout': function (we, e) {\n              // [workaround] Firefox doesn't support relatedTarget on focusout\n              //  - Ignore hide action on focus out in FF.\n              if (agent.isFF) {\n                return;\n              }\n\n              if (!e.relatedTarget || !dom.ancestor(e.relatedTarget, func.eq(self.$popover[0]))) {\n                self.hide();\n              }\n            }\n          };\n\n          this.shouldInitialize = function () {\n            return options.airMode && !list.isEmpty(options.popover.air);\n          };\n\n          this.initialize = function () {\n            this.$popover = ui.popover({\n              className: 'note-air-popover'\n            }).render().appendTo('body');\n            var $content = this.$popover.find('.popover-content');\n            context.invoke('buttons.build', $content, options.popover.air);\n          };\n\n          this.destroy = function () {\n            this.$popover.remove();\n          };\n\n          this.update = function () {\n            var styleInfo = context.invoke('editor.currentStyle');\n\n            if (styleInfo.range && !styleInfo.range.isCollapsed()) {\n              var rect = list.last(styleInfo.range.getClientRects());\n\n              if (rect) {\n                var bnd = func.rect2bnd(rect);\n                this.$popover.css({\n                  display: 'block',\n                  left: Math.max(bnd.left + bnd.width / 2, 0) - AIR_MODE_POPOVER_X_OFFSET,\n                  top: bnd.top + bnd.height\n                });\n              }\n            } else {\n              this.hide();\n            }\n          };\n\n          this.hide = function () {\n            this.$popover.hide();\n          };\n        };\n\n        var HintPopover = function (context) {\n          var self = this;\n          var ui = $.summernote.ui;\n          var POPOVER_DIST = 5;\n          var hint = context.options.hint || [];\n          var direction = context.options.hintDirection || 'bottom';\n          var hints = $.isArray(hint) ? hint : [hint];\n          this.events = {\n            'summernote.keyup': function (we, e) {\n              if (!e.isDefaultPrevented()) {\n                self.handleKeyup(e);\n              }\n            },\n            'summernote.keydown': function (we, e) {\n              self.handleKeydown(e);\n            },\n            'summernote.dialog.shown': function () {\n              self.hide();\n            }\n          };\n\n          this.shouldInitialize = function () {\n            return hints.length > 0;\n          };\n\n          this.initialize = function () {\n            this.lastWordRange = null;\n            this.$popover = ui.popover({\n              className: 'note-hint-popover',\n              hideArrow: true,\n              direction: ''\n            }).render().appendTo('body');\n            this.$popover.hide();\n            this.$content = this.$popover.find('.popover-content');\n            this.$content.on('click', '.note-hint-item', function () {\n              self.$content.find('.active').removeClass('active');\n              $(this).addClass('active');\n              self.replace();\n            });\n          };\n\n          this.destroy = function () {\n            this.$popover.remove();\n          };\n\n          this.selectItem = function ($item) {\n            this.$content.find('.active').removeClass('active');\n            $item.addClass('active');\n            this.$content[0].scrollTop = $item[0].offsetTop - this.$content.innerHeight() / 2;\n          };\n\n          this.moveDown = function () {\n            var $current = this.$content.find('.note-hint-item.active');\n            var $next = $current.next();\n\n            if ($next.length) {\n              this.selectItem($next);\n            } else {\n              var $nextGroup = $current.parent().next();\n\n              if (!$nextGroup.length) {\n                $nextGroup = this.$content.find('.note-hint-group').first();\n              }\n\n              this.selectItem($nextGroup.find('.note-hint-item').first());\n            }\n          };\n\n          this.moveUp = function () {\n            var $current = this.$content.find('.note-hint-item.active');\n            var $prev = $current.prev();\n\n            if ($prev.length) {\n              this.selectItem($prev);\n            } else {\n              var $prevGroup = $current.parent().prev();\n\n              if (!$prevGroup.length) {\n                $prevGroup = this.$content.find('.note-hint-group').last();\n              }\n\n              this.selectItem($prevGroup.find('.note-hint-item').last());\n            }\n          };\n\n          this.replace = function () {\n            var $item = this.$content.find('.note-hint-item.active');\n\n            if ($item.length) {\n              var node = this.nodeFromItem($item);\n              this.lastWordRange.insertNode(node);\n              range.createFromNode(node).collapse().select();\n              this.lastWordRange = null;\n              this.hide();\n              context.invoke('editor.focus');\n            }\n          };\n\n          this.nodeFromItem = function ($item) {\n            var hint = hints[$item.data('index')];\n            var item = $item.data('item');\n            var node = hint.content ? hint.content(item) : item;\n\n            if (typeof node === 'string') {\n              node = dom.createText(node);\n            }\n\n            return node;\n          };\n\n          this.createItemTemplates = function (hintIdx, items) {\n            var hint = hints[hintIdx];\n            return items.map(function (item, idx) {\n              var $item = $('<div class=\"note-hint-item\"/>');\n              $item.append(hint.template ? hint.template(item) : item + '');\n              $item.data({\n                'index': hintIdx,\n                'item': item\n              });\n\n              if (hintIdx === 0 && idx === 0) {\n                $item.addClass('active');\n              }\n\n              return $item;\n            });\n          };\n\n          this.handleKeydown = function (e) {\n            if (!this.$popover.is(':visible')) {\n              return;\n            }\n\n            if (e.keyCode === key.code.ENTER) {\n              e.preventDefault();\n              this.replace();\n            } else if (e.keyCode === key.code.UP) {\n              e.preventDefault();\n              this.moveUp();\n            } else if (e.keyCode === key.code.DOWN) {\n              e.preventDefault();\n              this.moveDown();\n            }\n          };\n\n          this.searchKeyword = function (index, keyword, callback) {\n            var hint = hints[index];\n\n            if (hint && hint.match.test(keyword) && hint.search) {\n              var matches = hint.match.exec(keyword);\n              hint.search(matches[1], callback);\n            } else {\n              callback();\n            }\n          };\n\n          this.createGroup = function (idx, keyword) {\n            var $group = $('<div class=\"note-hint-group note-hint-group-' + idx + '\"/>');\n            this.searchKeyword(idx, keyword, function (items) {\n              items = items || [];\n\n              if (items.length) {\n                $group.html(self.createItemTemplates(idx, items));\n                self.show();\n              }\n            });\n            return $group;\n          };\n\n          this.handleKeyup = function (e) {\n            if (list.contains([key.code.ENTER, key.code.UP, key.code.DOWN], e.keyCode)) {\n              if (e.keyCode === key.code.ENTER) {\n                if (this.$popover.is(':visible')) {\n                  return;\n                }\n              }\n            } else {\n              var wordRange = context.invoke('editor.createRange').getWordRange();\n              var keyword = wordRange.toString();\n\n              if (hints.length && keyword) {\n                this.$content.empty();\n                var bnd = func.rect2bnd(list.last(wordRange.getClientRects()));\n\n                if (bnd) {\n                  this.$popover.hide();\n                  this.lastWordRange = wordRange;\n                  hints.forEach(function (hint, idx) {\n                    if (hint.match.test(keyword)) {\n                      self.createGroup(idx, keyword).appendTo(self.$content);\n                    }\n                  }); // set position for popover after group is created\n\n                  if (direction === 'top') {\n                    this.$popover.css({\n                      left: bnd.left,\n                      top: bnd.top - this.$popover.outerHeight() - POPOVER_DIST\n                    });\n                  } else {\n                    this.$popover.css({\n                      left: bnd.left,\n                      top: bnd.top + bnd.height + POPOVER_DIST\n                    });\n                  }\n                }\n              } else {\n                this.hide();\n              }\n            }\n          };\n\n          this.show = function () {\n            this.$popover.show();\n          };\n\n          this.hide = function () {\n            this.$popover.hide();\n          };\n        };\n\n        $.summernote = $.extend($.summernote, {\n          version: '0.8.3',\n          ui: ui,\n          dom: dom,\n          plugins: {},\n          options: {\n            modules: {\n              'editor': Editor,\n              'clipboard': Clipboard,\n              'dropzone': Dropzone,\n              'codeview': Codeview,\n              'statusbar': Statusbar,\n              'fullscreen': Fullscreen,\n              'handle': Handle,\n              // FIXME: HintPopover must be front of autolink\n              //  - Script error about range when Enter key is pressed on hint popover\n              'hintPopover': HintPopover,\n              'autoLink': AutoLink,\n              'autoSync': AutoSync,\n              'placeholder': Placeholder,\n              'buttons': Buttons,\n              'toolbar': Toolbar,\n              'linkDialog': LinkDialog,\n              'linkPopover': LinkPopover,\n              'imageDialog': ImageDialog,\n              'imagePopover': ImagePopover,\n              'videoDialog': VideoDialog,\n              'helpDialog': HelpDialog,\n              'airPopover': AirPopover\n            },\n            buttons: {},\n            lang: 'en-US',\n            // toolbar\n            toolbar: [['style', ['style']], ['font', ['bold', 'underline', 'clear']], ['fontname', ['fontname']], ['color', ['color']], ['para', ['ul', 'ol', 'paragraph']], ['table', ['table']], ['insert', ['link', 'picture', 'video']], ['view', ['fullscreen', 'codeview', 'help']]],\n            // popover\n            popover: {\n              image: [['imagesize', ['imageSize100', 'imageSize50', 'imageSize25']], ['float', ['floatLeft', 'floatRight', 'floatNone']], ['remove', ['removeMedia']]],\n              link: [['link', ['linkDialogShow', 'unlink']]],\n              air: [['color', ['color']], ['font', ['bold', 'underline', 'clear']], ['para', ['ul', 'paragraph']], ['table', ['table']], ['insert', ['link', 'picture']]]\n            },\n            // air mode: inline editor\n            airMode: false,\n            width: null,\n            height: null,\n            focus: false,\n            tabSize: 4,\n            styleWithSpan: true,\n            shortcuts: true,\n            textareaAutoSync: true,\n            direction: null,\n            styleTags: ['p', 'blockquote', 'pre', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'],\n            fontNames: ['Arial', 'Arial Black', 'Comic Sans MS', 'Courier New', 'Helvetica Neue', 'Helvetica', 'Impact', 'Lucida Grande', 'Tahoma', 'Times New Roman', 'Verdana'],\n            fontSizes: ['8', '9', '10', '11', '12', '14', '18', '24', '36'],\n            // pallete colors(n x n)\n            colors: [['#000000', '#424242', '#636363', '#9C9C94', '#CEC6CE', '#EFEFEF', '#F7F7F7', '#FFFFFF'], ['#FF0000', '#FF9C00', '#FFFF00', '#00FF00', '#00FFFF', '#0000FF', '#9C00FF', '#FF00FF'], ['#F7C6CE', '#FFE7CE', '#FFEFC6', '#D6EFD6', '#CEDEE7', '#CEE7F7', '#D6D6E7', '#E7D6DE'], ['#E79C9C', '#FFC69C', '#FFE79C', '#B5D6A5', '#A5C6CE', '#9CC6EF', '#B5A5D6', '#D6A5BD'], ['#E76363', '#F7AD6B', '#FFD663', '#94BD7B', '#73A5AD', '#6BADDE', '#8C7BC6', '#C67BA5'], ['#CE0000', '#E79439', '#EFC631', '#6BA54A', '#4A7B8C', '#3984C6', '#634AA5', '#A54A7B'], ['#9C0000', '#B56308', '#BD9400', '#397B21', '#104A5A', '#085294', '#311873', '#731842'], ['#630000', '#7B3900', '#846300', '#295218', '#083139', '#003163', '#21104A', '#4A1031']],\n            lineHeights: ['1.0', '1.2', '1.4', '1.5', '1.6', '1.8', '2.0', '3.0'],\n            tableClassName: 'table table-bordered',\n            insertTableMaxSize: {\n              col: 10,\n              row: 10\n            },\n            dialogsInBody: false,\n            dialogsFade: false,\n            maximumImageFileSize: null,\n            callbacks: {\n              onInit: null,\n              onFocus: null,\n              onBlur: null,\n              onEnter: null,\n              onKeyup: null,\n              onKeydown: null,\n              onImageUpload: null,\n              onImageUploadError: null\n            },\n            codemirror: {\n              mode: 'text/html',\n              htmlMode: true,\n              lineNumbers: true\n            },\n            keyMap: {\n              pc: {\n                'ENTER': 'insertParagraph',\n                'CTRL+Z': 'undo',\n                'CTRL+Y': 'redo',\n                'TAB': 'tab',\n                'SHIFT+TAB': 'untab',\n                'CTRL+B': 'bold',\n                'CTRL+I': 'italic',\n                'CTRL+U': 'underline',\n                'CTRL+SHIFT+S': 'strikethrough',\n                'CTRL+BACKSLASH': 'removeFormat',\n                'CTRL+SHIFT+L': 'justifyLeft',\n                'CTRL+SHIFT+E': 'justifyCenter',\n                'CTRL+SHIFT+R': 'justifyRight',\n                'CTRL+SHIFT+J': 'justifyFull',\n                'CTRL+SHIFT+NUM7': 'insertUnorderedList',\n                'CTRL+SHIFT+NUM8': 'insertOrderedList',\n                'CTRL+LEFTBRACKET': 'outdent',\n                'CTRL+RIGHTBRACKET': 'indent',\n                'CTRL+NUM0': 'formatPara',\n                'CTRL+NUM1': 'formatH1',\n                'CTRL+NUM2': 'formatH2',\n                'CTRL+NUM3': 'formatH3',\n                'CTRL+NUM4': 'formatH4',\n                'CTRL+NUM5': 'formatH5',\n                'CTRL+NUM6': 'formatH6',\n                'CTRL+ENTER': 'insertHorizontalRule',\n                'CTRL+K': 'linkDialog.show'\n              },\n              mac: {\n                'ENTER': 'insertParagraph',\n                'CMD+Z': 'undo',\n                'CMD+SHIFT+Z': 'redo',\n                'TAB': 'tab',\n                'SHIFT+TAB': 'untab',\n                'CMD+B': 'bold',\n                'CMD+I': 'italic',\n                'CMD+U': 'underline',\n                'CMD+SHIFT+S': 'strikethrough',\n                'CMD+BACKSLASH': 'removeFormat',\n                'CMD+SHIFT+L': 'justifyLeft',\n                'CMD+SHIFT+E': 'justifyCenter',\n                'CMD+SHIFT+R': 'justifyRight',\n                'CMD+SHIFT+J': 'justifyFull',\n                'CMD+SHIFT+NUM7': 'insertUnorderedList',\n                'CMD+SHIFT+NUM8': 'insertOrderedList',\n                'CMD+LEFTBRACKET': 'outdent',\n                'CMD+RIGHTBRACKET': 'indent',\n                'CMD+NUM0': 'formatPara',\n                'CMD+NUM1': 'formatH1',\n                'CMD+NUM2': 'formatH2',\n                'CMD+NUM3': 'formatH3',\n                'CMD+NUM4': 'formatH4',\n                'CMD+NUM5': 'formatH5',\n                'CMD+NUM6': 'formatH6',\n                'CMD+ENTER': 'insertHorizontalRule',\n                'CMD+K': 'linkDialog.show'\n              }\n            },\n            icons: {\n              'align': 'note-icon-align',\n              'alignCenter': 'note-icon-align-center',\n              'alignJustify': 'note-icon-align-justify',\n              'alignLeft': 'note-icon-align-left',\n              'alignRight': 'note-icon-align-right',\n              'indent': 'note-icon-align-indent',\n              'outdent': 'note-icon-align-outdent',\n              'arrowsAlt': 'note-icon-arrows-alt',\n              'bold': 'note-icon-bold',\n              'caret': 'note-icon-caret',\n              'circle': 'note-icon-circle',\n              'close': 'note-icon-close',\n              'code': 'note-icon-code',\n              'eraser': 'note-icon-eraser',\n              'font': 'note-icon-font',\n              'frame': 'note-icon-frame',\n              'italic': 'note-icon-italic',\n              'link': 'note-icon-link',\n              'unlink': 'note-icon-chain-broken',\n              'magic': 'note-icon-magic',\n              'menuCheck': 'note-icon-check',\n              'minus': 'note-icon-minus',\n              'orderedlist': 'note-icon-orderedlist',\n              'pencil': 'note-icon-pencil',\n              'picture': 'note-icon-picture',\n              'question': 'note-icon-question',\n              'redo': 'note-icon-redo',\n              'square': 'note-icon-square',\n              'strikethrough': 'note-icon-strikethrough',\n              'subscript': 'note-icon-subscript',\n              'superscript': 'note-icon-superscript',\n              'table': 'note-icon-table',\n              'textHeight': 'note-icon-text-height',\n              'trash': 'note-icon-trash',\n              'underline': 'note-icon-underline',\n              'undo': 'note-icon-undo',\n              'unorderedlist': 'note-icon-unorderedlist',\n              'video': 'note-icon-video'\n            }\n          }\n        });\n      });\n      /***/\n\n    },\n    /* 11 */\n\n    /***/\n    function (module, exports) {\n      module.exports = __WEBPACK_EXTERNAL_MODULE_11__;\n      /***/\n    },\n    /* 12 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      \"use strict\";\n      /* WEBPACK VAR INJECTION */\n\n      (function ($) {\n        Object.defineProperty(exports, \"__esModule\", {\n          value: true\n        });\n\n        var _createClass = function () {\n          function defineProperties(target, props) {\n            for (var i = 0; i < props.length; i++) {\n              var descriptor = props[i];\n              descriptor.enumerable = descriptor.enumerable || false;\n              descriptor.configurable = true;\n              if (\"value\" in descriptor) descriptor.writable = true;\n              Object.defineProperty(target, descriptor.key, descriptor);\n            }\n          }\n\n          return function (Constructor, protoProps, staticProps) {\n            if (protoProps) defineProperties(Constructor.prototype, protoProps);\n            if (staticProps) defineProperties(Constructor, staticProps);\n            return Constructor;\n          };\n        }();\n\n        __webpack_require__(10);\n\n        __webpack_require__(8);\n\n        __webpack_require__(7);\n\n        var _react = __webpack_require__(11);\n\n        var _react2 = _interopRequireDefault(_react);\n\n        var _propTypes = __webpack_require__(9);\n\n        var _propTypes2 = _interopRequireDefault(_propTypes);\n\n        function _interopRequireDefault(obj) {\n          return obj && obj.__esModule ? obj : {\n            default: obj\n          };\n        }\n\n        function _classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function _possibleConstructorReturn(self, call) {\n          if (!self) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n        }\n\n        function _inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              enumerable: false,\n              writable: true,\n              configurable: true\n            }\n          });\n          if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n        }\n        /* global $ */\n\n\n        var randomUid = function randomUid() {\n          return Math.floor(Math.random() * 100000);\n        };\n\n        var ReactSummernote = function (_Component) {\n          _inherits(ReactSummernote, _Component);\n\n          function ReactSummernote(props) {\n            _classCallCheck(this, ReactSummernote);\n\n            var _this = _possibleConstructorReturn(this, (ReactSummernote.__proto__ || Object.getPrototypeOf(ReactSummernote)).call(this, props));\n\n            _this.uid = 'react-summernote-' + randomUid();\n            _this.editor = {};\n            _this.noteEditable = null;\n            _this.notePlaceholder = null;\n            _this.onInit = _this.onInit.bind(_this);\n            _this.onImageUpload = _this.onImageUpload.bind(_this);\n            _this.focus = _this.focus.bind(_this);\n            _this.isEmpty = _this.isEmpty.bind(_this);\n            _this.reset = _this.reset.bind(_this);\n            _this.replace = _this.replace.bind(_this);\n            _this.disable = _this.disable.bind(_this);\n            _this.enable = _this.enable.bind(_this);\n            _this.toggleState = _this.toggleState.bind(_this);\n            _this.insertImage = _this.insertImage.bind(_this);\n            _this.insertNode = _this.insertNode.bind(_this);\n            _this.insertText = _this.insertText.bind(_this);\n            ReactSummernote.focus = _this.focus.bind(_this);\n            ReactSummernote.isEmpty = _this.isEmpty.bind(_this);\n            ReactSummernote.reset = _this.reset.bind(_this);\n            ReactSummernote.replace = _this.replace.bind(_this);\n            ReactSummernote.disable = _this.disable.bind(_this);\n            ReactSummernote.enable = _this.enable.bind(_this);\n            ReactSummernote.toggleState = _this.toggleState.bind(_this);\n            ReactSummernote.insertImage = _this.insertImage.bind(_this);\n            ReactSummernote.insertNode = _this.insertNode.bind(_this);\n            ReactSummernote.insertText = _this.insertText.bind(_this);\n            return _this;\n          }\n\n          _createClass(ReactSummernote, [{\n            key: 'componentDidMount',\n            value: function componentDidMount() {\n              var options = this.props.options || {};\n              options.callbacks = this.callbacks;\n              this.editor = $('#' + this.uid);\n              this.editor.summernote(options);\n            }\n          }, {\n            key: 'componentWillReceiveProps',\n            value: function componentWillReceiveProps(nextProps) {\n              var props = this.props;\n\n              if (typeof nextProps.value === 'string' && props.value !== nextProps.value) {\n                this.replace(nextProps.value);\n              }\n\n              if (typeof nextProps.disabled === 'boolean' && props.disabled !== nextProps.disabled) {\n                this.toggleState(nextProps.disabled);\n              }\n            }\n          }, {\n            key: 'shouldComponentUpdate',\n            value: function shouldComponentUpdate() {\n              return false;\n            }\n          }, {\n            key: 'componentWillUnmount',\n            value: function componentWillUnmount() {\n              if (this.editor.summernote) {\n                this.editor.summernote('destroy');\n              }\n            }\n          }, {\n            key: 'onInit',\n            value: function onInit() {\n              var _props = this.props,\n                  disabled = _props.disabled,\n                  onInit = _props.onInit;\n              var $container = this.editor.parent();\n              this.noteEditable = $container.find('.note-editable');\n              this.notePlaceholder = $container.find('.note-placeholder');\n\n              if (typeof disabled === 'boolean') {\n                this.toggleState(disabled);\n              }\n\n              if (typeof onInit === 'function') {\n                onInit({\n                  summernote: this.editor.summernote,\n                  focus: this.focus,\n                  isEmpty: this.isEmpty,\n                  reset: this.reset,\n                  replace: this.replace,\n                  disable: this.disable,\n                  enable: this.enable,\n                  insertImage: this.insertImage,\n                  insertNode: this.insertNode,\n                  insertText: this.insertText\n                });\n              }\n            }\n          }, {\n            key: 'onImageUpload',\n            value: function onImageUpload(images) {\n              var onImageUpload = this.props.onImageUpload;\n\n              if (typeof onImageUpload === 'function') {\n                onImageUpload(images, this.insertImage);\n              }\n            }\n          }, {\n            key: 'focus',\n            value: function focus() {\n              this.editor.summernote('focus');\n            }\n          }, {\n            key: 'isEmpty',\n            value: function isEmpty() {\n              return this.editor.summernote('isEmpty');\n            }\n          }, {\n            key: 'reset',\n            value: function reset() {\n              this.editor.summernote('reset');\n            }\n          }, {\n            key: 'replace',\n            value: function replace(content) {\n              var noteEditable = this.noteEditable,\n                  notePlaceholder = this.notePlaceholder;\n              var prevContent = noteEditable.html();\n              var contentLength = content.length;\n\n              if (prevContent !== content) {\n                if (this.isEmpty() && contentLength > 0) {\n                  notePlaceholder.hide();\n                } else if (contentLength === 0) {\n                  notePlaceholder.show();\n                }\n\n                noteEditable.html(content);\n              }\n            }\n          }, {\n            key: 'disable',\n            value: function disable() {\n              this.editor.summernote('disable');\n            }\n          }, {\n            key: 'enable',\n            value: function enable() {\n              this.editor.summernote('enable');\n            }\n          }, {\n            key: 'toggleState',\n            value: function toggleState(disabled) {\n              if (disabled) {\n                this.disable();\n              } else {\n                this.enable();\n              }\n            }\n          }, {\n            key: 'insertImage',\n            value: function insertImage(url, filenameOrCallback) {\n              this.editor.summernote('insertImage', url, filenameOrCallback);\n            }\n          }, {\n            key: 'insertNode',\n            value: function insertNode(node) {\n              this.editor.summernote('insertNode', node);\n            }\n          }, {\n            key: 'insertText',\n            value: function insertText(text) {\n              this.editor.summernote('insertText', text);\n            }\n          }, {\n            key: 'render',\n            value: function render() {\n              var _props2 = this.props,\n                  value = _props2.value,\n                  defaultValue = _props2.defaultValue,\n                  className = _props2.className;\n              var html = value || defaultValue;\n              return _react2.default.createElement('div', {\n                className: className\n              }, _react2.default.createElement('div', {\n                id: this.uid,\n                dangerouslySetInnerHTML: {\n                  __html: html\n                }\n              }));\n            }\n          }, {\n            key: 'callbacks',\n            get: function get() {\n              var props = this.props;\n              return {\n                onInit: this.onInit,\n                onEnter: props.onEnter,\n                onFocus: props.onFocus,\n                onBlur: props.onBlur,\n                onKeyup: props.onKeyUp,\n                onKeydown: props.onKeyDown,\n                onPaste: props.onPaste,\n                onChange: props.onChange,\n                onImageUpload: this.onImageUpload\n              };\n            }\n          }]);\n\n          return ReactSummernote;\n        }(_react.Component);\n\n        ReactSummernote.propTypes = {\n          value: _propTypes2.default.string,\n          defaultValue: _propTypes2.default.string,\n          className: _propTypes2.default.string,\n          options: _propTypes2.default.object,\n          disabled: _propTypes2.default.bool,\n          onInit: _propTypes2.default.func,\n          onEnter: _propTypes2.default.func,\n          onFocus: _propTypes2.default.func,\n          onBlur: _propTypes2.default.func,\n          onKeyUp: _propTypes2.default.func,\n          onKeyDown: _propTypes2.default.func,\n          onPaste: _propTypes2.default.func,\n          onChange: _propTypes2.default.func,\n          onImageUpload: _propTypes2.default.func\n        };\n        exports.default = ReactSummernote;\n        /* WEBPACK VAR INJECTION */\n      }).call(exports, __webpack_require__(4));\n      /***/\n    },\n    /* 13 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      \"use strict\";\n      /* WEBPACK VAR INJECTION */\n\n      (function (process) {\n        /**\n        * Copyright 2013-present, Facebook, Inc.\n        * All rights reserved.\n        *\n        * This source code is licensed under the BSD-style license found in the\n        * LICENSE file in the root directory of this source tree. An additional grant\n        * of patent rights can be found in the PATENTS file in the same directory.\n        */\n        if (process.env.NODE_ENV !== 'production') {\n          var invariant = __webpack_require__(2);\n\n          var warning = __webpack_require__(6);\n\n          var ReactPropTypesSecret = __webpack_require__(3);\n\n          var loggedTypeFailures = {};\n        }\n        /**\n         * Assert that the values match with the type specs.\n         * Error messages are memorized and will only be shown once.\n         *\n         * @param {object} typeSpecs Map of name to a ReactPropType\n         * @param {object} values Runtime values that need to be type-checked\n         * @param {string} location e.g. \"prop\", \"context\", \"child context\"\n         * @param {string} componentName Name of the component for error messages.\n         * @param {?Function} getStack Returns the component stack.\n         * @private\n         */\n\n\n        function checkPropTypes(typeSpecs, values, location, componentName, getStack) {\n          if (process.env.NODE_ENV !== 'production') {\n            for (var typeSpecName in typeSpecs) {\n              if (typeSpecs.hasOwnProperty(typeSpecName)) {\n                var error; // Prop type validation may throw. In case they do, we don't want to\n                // fail the render phase where it didn't fail before. So we log it.\n                // After these have been cleaned up, we'll let them throw.\n\n                try {\n                  // This is intentionally an invariant that gets caught. It's the same\n                  // behavior as without this statement except with a better message.\n                  invariant(typeof typeSpecs[typeSpecName] === 'function', '%s: %s type `%s` is invalid; it must be a function, usually from ' + 'React.PropTypes.', componentName || 'React class', location, typeSpecName);\n                  error = typeSpecs[typeSpecName](values, typeSpecName, componentName, location, null, ReactPropTypesSecret);\n                } catch (ex) {\n                  error = ex;\n                }\n\n                warning(!error || error instanceof Error, '%s: type specification of %s `%s` is invalid; the type checker ' + 'function must return `null` or an `Error` but returned a %s. ' + 'You may have forgotten to pass an argument to the type checker ' + 'creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and ' + 'shape all require an argument).', componentName || 'React class', location, typeSpecName, typeof error);\n\n                if (error instanceof Error && !(error.message in loggedTypeFailures)) {\n                  // Only monitor this failure once because there tends to be a lot of the\n                  // same error.\n                  loggedTypeFailures[error.message] = true;\n                  var stack = getStack ? getStack() : '';\n                  warning(false, 'Failed %s type: %s%s', location, error.message, stack != null ? stack : '');\n                }\n              }\n            }\n          }\n        }\n\n        module.exports = checkPropTypes;\n        /* WEBPACK VAR INJECTION */\n      }).call(exports, __webpack_require__(0));\n      /***/\n    },\n    /* 14 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      \"use strict\";\n      /**\n       * Copyright 2013-present, Facebook, Inc.\n       * All rights reserved.\n       *\n       * This source code is licensed under the BSD-style license found in the\n       * LICENSE file in the root directory of this source tree. An additional grant\n       * of patent rights can be found in the PATENTS file in the same directory.\n       */\n\n      var emptyFunction = __webpack_require__(1);\n\n      var invariant = __webpack_require__(2);\n\n      var ReactPropTypesSecret = __webpack_require__(3);\n\n      module.exports = function () {\n        function shim(props, propName, componentName, location, propFullName, secret) {\n          if (secret === ReactPropTypesSecret) {\n            // It is still safe when called from React.\n            return;\n          }\n\n          invariant(false, 'Calling PropTypes validators directly is not supported by the `prop-types` package. ' + 'Use PropTypes.checkPropTypes() to call them. ' + 'Read more at http://fb.me/use-check-prop-types');\n        }\n\n        ;\n        shim.isRequired = shim;\n\n        function getShim() {\n          return shim;\n        }\n\n        ; // Important!\n        // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n\n        var ReactPropTypes = {\n          array: shim,\n          bool: shim,\n          func: shim,\n          number: shim,\n          object: shim,\n          string: shim,\n          symbol: shim,\n          any: shim,\n          arrayOf: getShim,\n          element: shim,\n          instanceOf: getShim,\n          node: shim,\n          objectOf: getShim,\n          oneOf: getShim,\n          oneOfType: getShim,\n          shape: getShim\n        };\n        ReactPropTypes.checkPropTypes = emptyFunction;\n        ReactPropTypes.PropTypes = ReactPropTypes;\n        return ReactPropTypes;\n      };\n      /***/\n\n    },\n    /* 15 */\n\n    /***/\n    function (module, exports, __webpack_require__) {\n      \"use strict\";\n      /* WEBPACK VAR INJECTION */\n\n      (function (process) {\n        /**\n        * Copyright 2013-present, Facebook, Inc.\n        * All rights reserved.\n        *\n        * This source code is licensed under the BSD-style license found in the\n        * LICENSE file in the root directory of this source tree. An additional grant\n        * of patent rights can be found in the PATENTS file in the same directory.\n        */\n        var emptyFunction = __webpack_require__(1);\n\n        var invariant = __webpack_require__(2);\n\n        var warning = __webpack_require__(6);\n\n        var ReactPropTypesSecret = __webpack_require__(3);\n\n        var checkPropTypes = __webpack_require__(13);\n\n        module.exports = function (isValidElement, throwOnDirectAccess) {\n          /* global Symbol */\n          var ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\n          var FAUX_ITERATOR_SYMBOL = '@@iterator'; // Before Symbol spec.\n\n          /**\n           * Returns the iterator method function contained on the iterable object.\n           *\n           * Be sure to invoke the function with the iterable as context:\n           *\n           *     var iteratorFn = getIteratorFn(myIterable);\n           *     if (iteratorFn) {\n           *       var iterator = iteratorFn.call(myIterable);\n           *       ...\n           *     }\n           *\n           * @param {?object} maybeIterable\n           * @return {?function}\n           */\n\n          function getIteratorFn(maybeIterable) {\n            var iteratorFn = maybeIterable && (ITERATOR_SYMBOL && maybeIterable[ITERATOR_SYMBOL] || maybeIterable[FAUX_ITERATOR_SYMBOL]);\n\n            if (typeof iteratorFn === 'function') {\n              return iteratorFn;\n            }\n          }\n          /**\n           * Collection of methods that allow declaration and validation of props that are\n           * supplied to React components. Example usage:\n           *\n           *   var Props = require('ReactPropTypes');\n           *   var MyArticle = React.createClass({\n           *     propTypes: {\n           *       // An optional string prop named \"description\".\n           *       description: Props.string,\n           *\n           *       // A required enum prop named \"category\".\n           *       category: Props.oneOf(['News','Photos']).isRequired,\n           *\n           *       // A prop named \"dialog\" that requires an instance of Dialog.\n           *       dialog: Props.instanceOf(Dialog).isRequired\n           *     },\n           *     render: function() { ... }\n           *   });\n           *\n           * A more formal specification of how these methods are used:\n           *\n           *   type := array|bool|func|object|number|string|oneOf([...])|instanceOf(...)\n           *   decl := ReactPropTypes.{type}(.isRequired)?\n           *\n           * Each and every declaration produces a function with the same signature. This\n           * allows the creation of custom validation functions. For example:\n           *\n           *  var MyLink = React.createClass({\n           *    propTypes: {\n           *      // An optional string or URI prop named \"href\".\n           *      href: function(props, propName, componentName) {\n           *        var propValue = props[propName];\n           *        if (propValue != null && typeof propValue !== 'string' &&\n           *            !(propValue instanceof URI)) {\n           *          return new Error(\n           *            'Expected a string or an URI for ' + propName + ' in ' +\n           *            componentName\n           *          );\n           *        }\n           *      }\n           *    },\n           *    render: function() {...}\n           *  });\n           *\n           * @internal\n           */\n\n\n          var ANONYMOUS = '<<anonymous>>'; // Important!\n          // Keep this list in sync with production version in `./factoryWithThrowingShims.js`.\n\n          var ReactPropTypes = {\n            array: createPrimitiveTypeChecker('array'),\n            bool: createPrimitiveTypeChecker('boolean'),\n            func: createPrimitiveTypeChecker('function'),\n            number: createPrimitiveTypeChecker('number'),\n            object: createPrimitiveTypeChecker('object'),\n            string: createPrimitiveTypeChecker('string'),\n            symbol: createPrimitiveTypeChecker('symbol'),\n            any: createAnyTypeChecker(),\n            arrayOf: createArrayOfTypeChecker,\n            element: createElementTypeChecker(),\n            instanceOf: createInstanceTypeChecker,\n            node: createNodeChecker(),\n            objectOf: createObjectOfTypeChecker,\n            oneOf: createEnumTypeChecker,\n            oneOfType: createUnionTypeChecker,\n            shape: createShapeTypeChecker\n          };\n          /**\n           * inlined Object.is polyfill to avoid requiring consumers ship their own\n           * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n           */\n\n          /*eslint-disable no-self-compare*/\n\n          function is(x, y) {\n            // SameValue algorithm\n            if (x === y) {\n              // Steps 1-5, 7-10\n              // Steps 6.b-6.e: +0 != -0\n              return x !== 0 || 1 / x === 1 / y;\n            } else {\n              // Step 6.a: NaN == NaN\n              return x !== x && y !== y;\n            }\n          }\n          /*eslint-enable no-self-compare*/\n\n          /**\n           * We use an Error-like object for backward compatibility as people may call\n           * PropTypes directly and inspect their output. However, we don't use real\n           * Errors anymore. We don't inspect their stack anyway, and creating them\n           * is prohibitively expensive if they are created too often, such as what\n           * happens in oneOfType() for any type before the one that matched.\n           */\n\n\n          function PropTypeError(message) {\n            this.message = message;\n            this.stack = '';\n          } // Make `instanceof Error` still work for returned errors.\n\n\n          PropTypeError.prototype = Error.prototype;\n\n          function createChainableTypeChecker(validate) {\n            if (process.env.NODE_ENV !== 'production') {\n              var manualPropTypeCallCache = {};\n              var manualPropTypeWarningCount = 0;\n            }\n\n            function checkType(isRequired, props, propName, componentName, location, propFullName, secret) {\n              componentName = componentName || ANONYMOUS;\n              propFullName = propFullName || propName;\n\n              if (secret !== ReactPropTypesSecret) {\n                if (throwOnDirectAccess) {\n                  // New behavior only for users of `prop-types` package\n                  invariant(false, 'Calling PropTypes validators directly is not supported by the `prop-types` package. ' + 'Use `PropTypes.checkPropTypes()` to call them. ' + 'Read more at http://fb.me/use-check-prop-types');\n                } else if (process.env.NODE_ENV !== 'production' && typeof console !== 'undefined') {\n                  // Old behavior for people using React.PropTypes\n                  var cacheKey = componentName + ':' + propName;\n\n                  if (!manualPropTypeCallCache[cacheKey] && // Avoid spamming the console because they are often not actionable except for lib authors\n                  manualPropTypeWarningCount < 3) {\n                    warning(false, 'You are manually calling a React.PropTypes validation ' + 'function for the `%s` prop on `%s`. This is deprecated ' + 'and will throw in the standalone `prop-types` package. ' + 'You may be seeing this warning due to a third-party PropTypes ' + 'library. See https://fb.me/react-warning-dont-call-proptypes ' + 'for details.', propFullName, componentName);\n                    manualPropTypeCallCache[cacheKey] = true;\n                    manualPropTypeWarningCount++;\n                  }\n                }\n              }\n\n              if (props[propName] == null) {\n                if (isRequired) {\n                  if (props[propName] === null) {\n                    return new PropTypeError('The ' + location + ' `' + propFullName + '` is marked as required ' + ('in `' + componentName + '`, but its value is `null`.'));\n                  }\n\n                  return new PropTypeError('The ' + location + ' `' + propFullName + '` is marked as required in ' + ('`' + componentName + '`, but its value is `undefined`.'));\n                }\n\n                return null;\n              } else {\n                return validate(props, propName, componentName, location, propFullName);\n              }\n            }\n\n            var chainedCheckType = checkType.bind(null, false);\n            chainedCheckType.isRequired = checkType.bind(null, true);\n            return chainedCheckType;\n          }\n\n          function createPrimitiveTypeChecker(expectedType) {\n            function validate(props, propName, componentName, location, propFullName, secret) {\n              var propValue = props[propName];\n              var propType = getPropType(propValue);\n\n              if (propType !== expectedType) {\n                // `propValue` being instance of, say, date/regexp, pass the 'object'\n                // check, but we can offer a more precise error message here rather than\n                // 'of type `object`'.\n                var preciseType = getPreciseType(propValue);\n                return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + preciseType + '` supplied to `' + componentName + '`, expected ') + ('`' + expectedType + '`.'));\n              }\n\n              return null;\n            }\n\n            return createChainableTypeChecker(validate);\n          }\n\n          function createAnyTypeChecker() {\n            return createChainableTypeChecker(emptyFunction.thatReturnsNull);\n          }\n\n          function createArrayOfTypeChecker(typeChecker) {\n            function validate(props, propName, componentName, location, propFullName) {\n              if (typeof typeChecker !== 'function') {\n                return new PropTypeError('Property `' + propFullName + '` of component `' + componentName + '` has invalid PropType notation inside arrayOf.');\n              }\n\n              var propValue = props[propName];\n\n              if (!Array.isArray(propValue)) {\n                var propType = getPropType(propValue);\n                return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected an array.'));\n              }\n\n              for (var i = 0; i < propValue.length; i++) {\n                var error = typeChecker(propValue, i, componentName, location, propFullName + '[' + i + ']', ReactPropTypesSecret);\n\n                if (error instanceof Error) {\n                  return error;\n                }\n              }\n\n              return null;\n            }\n\n            return createChainableTypeChecker(validate);\n          }\n\n          function createElementTypeChecker() {\n            function validate(props, propName, componentName, location, propFullName) {\n              var propValue = props[propName];\n\n              if (!isValidElement(propValue)) {\n                var propType = getPropType(propValue);\n                return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected a single ReactElement.'));\n              }\n\n              return null;\n            }\n\n            return createChainableTypeChecker(validate);\n          }\n\n          function createInstanceTypeChecker(expectedClass) {\n            function validate(props, propName, componentName, location, propFullName) {\n              if (!(props[propName] instanceof expectedClass)) {\n                var expectedClassName = expectedClass.name || ANONYMOUS;\n                var actualClassName = getClassName(props[propName]);\n                return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + actualClassName + '` supplied to `' + componentName + '`, expected ') + ('instance of `' + expectedClassName + '`.'));\n              }\n\n              return null;\n            }\n\n            return createChainableTypeChecker(validate);\n          }\n\n          function createEnumTypeChecker(expectedValues) {\n            if (!Array.isArray(expectedValues)) {\n              process.env.NODE_ENV !== 'production' ? warning(false, 'Invalid argument supplied to oneOf, expected an instance of array.') : void 0;\n              return emptyFunction.thatReturnsNull;\n            }\n\n            function validate(props, propName, componentName, location, propFullName) {\n              var propValue = props[propName];\n\n              for (var i = 0; i < expectedValues.length; i++) {\n                if (is(propValue, expectedValues[i])) {\n                  return null;\n                }\n              }\n\n              var valuesString = JSON.stringify(expectedValues);\n              return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of value `' + propValue + '` ' + ('supplied to `' + componentName + '`, expected one of ' + valuesString + '.'));\n            }\n\n            return createChainableTypeChecker(validate);\n          }\n\n          function createObjectOfTypeChecker(typeChecker) {\n            function validate(props, propName, componentName, location, propFullName) {\n              if (typeof typeChecker !== 'function') {\n                return new PropTypeError('Property `' + propFullName + '` of component `' + componentName + '` has invalid PropType notation inside objectOf.');\n              }\n\n              var propValue = props[propName];\n              var propType = getPropType(propValue);\n\n              if (propType !== 'object') {\n                return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected an object.'));\n              }\n\n              for (var key in propValue) {\n                if (propValue.hasOwnProperty(key)) {\n                  var error = typeChecker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);\n\n                  if (error instanceof Error) {\n                    return error;\n                  }\n                }\n              }\n\n              return null;\n            }\n\n            return createChainableTypeChecker(validate);\n          }\n\n          function createUnionTypeChecker(arrayOfTypeCheckers) {\n            if (!Array.isArray(arrayOfTypeCheckers)) {\n              process.env.NODE_ENV !== 'production' ? warning(false, 'Invalid argument supplied to oneOfType, expected an instance of array.') : void 0;\n              return emptyFunction.thatReturnsNull;\n            }\n\n            for (var i = 0; i < arrayOfTypeCheckers.length; i++) {\n              var checker = arrayOfTypeCheckers[i];\n\n              if (typeof checker !== 'function') {\n                warning(false, 'Invalid argument supplid to oneOfType. Expected an array of check functions, but ' + 'received %s at index %s.', getPostfixForTypeWarning(checker), i);\n                return emptyFunction.thatReturnsNull;\n              }\n            }\n\n            function validate(props, propName, componentName, location, propFullName) {\n              for (var i = 0; i < arrayOfTypeCheckers.length; i++) {\n                var checker = arrayOfTypeCheckers[i];\n\n                if (checker(props, propName, componentName, location, propFullName, ReactPropTypesSecret) == null) {\n                  return null;\n                }\n              }\n\n              return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` supplied to ' + ('`' + componentName + '`.'));\n            }\n\n            return createChainableTypeChecker(validate);\n          }\n\n          function createNodeChecker() {\n            function validate(props, propName, componentName, location, propFullName) {\n              if (!isNode(props[propName])) {\n                return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` supplied to ' + ('`' + componentName + '`, expected a ReactNode.'));\n              }\n\n              return null;\n            }\n\n            return createChainableTypeChecker(validate);\n          }\n\n          function createShapeTypeChecker(shapeTypes) {\n            function validate(props, propName, componentName, location, propFullName) {\n              var propValue = props[propName];\n              var propType = getPropType(propValue);\n\n              if (propType !== 'object') {\n                return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type `' + propType + '` ' + ('supplied to `' + componentName + '`, expected `object`.'));\n              }\n\n              for (var key in shapeTypes) {\n                var checker = shapeTypes[key];\n\n                if (!checker) {\n                  continue;\n                }\n\n                var error = checker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);\n\n                if (error) {\n                  return error;\n                }\n              }\n\n              return null;\n            }\n\n            return createChainableTypeChecker(validate);\n          }\n\n          function isNode(propValue) {\n            switch (typeof propValue) {\n              case 'number':\n              case 'string':\n              case 'undefined':\n                return true;\n\n              case 'boolean':\n                return !propValue;\n\n              case 'object':\n                if (Array.isArray(propValue)) {\n                  return propValue.every(isNode);\n                }\n\n                if (propValue === null || isValidElement(propValue)) {\n                  return true;\n                }\n\n                var iteratorFn = getIteratorFn(propValue);\n\n                if (iteratorFn) {\n                  var iterator = iteratorFn.call(propValue);\n                  var step;\n\n                  if (iteratorFn !== propValue.entries) {\n                    while (!(step = iterator.next()).done) {\n                      if (!isNode(step.value)) {\n                        return false;\n                      }\n                    }\n                  } else {\n                    // Iterator will provide entry [k,v] tuples rather than values.\n                    while (!(step = iterator.next()).done) {\n                      var entry = step.value;\n\n                      if (entry) {\n                        if (!isNode(entry[1])) {\n                          return false;\n                        }\n                      }\n                    }\n                  }\n                } else {\n                  return false;\n                }\n\n                return true;\n\n              default:\n                return false;\n            }\n          }\n\n          function isSymbol(propType, propValue) {\n            // Native Symbol.\n            if (propType === 'symbol') {\n              return true;\n            } // 19.4.3.5 Symbol.prototype[@@toStringTag] === 'Symbol'\n\n\n            if (propValue['@@toStringTag'] === 'Symbol') {\n              return true;\n            } // Fallback for non-spec compliant Symbols which are polyfilled.\n\n\n            if (typeof Symbol === 'function' && propValue instanceof Symbol) {\n              return true;\n            }\n\n            return false;\n          } // Equivalent of `typeof` but with special handling for array and regexp.\n\n\n          function getPropType(propValue) {\n            var propType = typeof propValue;\n\n            if (Array.isArray(propValue)) {\n              return 'array';\n            }\n\n            if (propValue instanceof RegExp) {\n              // Old webkits (at least until Android 4.0) return 'function' rather than\n              // 'object' for typeof a RegExp. We'll normalize this here so that /bla/\n              // passes PropTypes.object.\n              return 'object';\n            }\n\n            if (isSymbol(propType, propValue)) {\n              return 'symbol';\n            }\n\n            return propType;\n          } // This handles more types than `getPropType`. Only used for error messages.\n          // See `createPrimitiveTypeChecker`.\n\n\n          function getPreciseType(propValue) {\n            if (typeof propValue === 'undefined' || propValue === null) {\n              return '' + propValue;\n            }\n\n            var propType = getPropType(propValue);\n\n            if (propType === 'object') {\n              if (propValue instanceof Date) {\n                return 'date';\n              } else if (propValue instanceof RegExp) {\n                return 'regexp';\n              }\n            }\n\n            return propType;\n          } // Returns a string that is postfixed to a warning about an invalid type.\n          // For example, \"undefined\" or \"of type array\"\n\n\n          function getPostfixForTypeWarning(value) {\n            var type = getPreciseType(value);\n\n            switch (type) {\n              case 'array':\n              case 'object':\n                return 'an ' + type;\n\n              case 'boolean':\n              case 'date':\n              case 'regexp':\n                return 'a ' + type;\n\n              default:\n                return type;\n            }\n          } // Returns class name of the object, if any.\n\n\n          function getClassName(propValue) {\n            if (!propValue.constructor || !propValue.constructor.name) {\n              return ANONYMOUS;\n            }\n\n            return propValue.constructor.name;\n          }\n\n          ReactPropTypes.checkPropTypes = checkPropTypes;\n          ReactPropTypes.PropTypes = ReactPropTypes;\n          return ReactPropTypes;\n        };\n        /* WEBPACK VAR INJECTION */\n\n      }).call(exports, __webpack_require__(0));\n      /***/\n    },\n    /* 16 */\n\n    /***/\n    function (module, exports) {\n      /* WEBPACK VAR INJECTION */\n      (function (__webpack_amd_options__) {\n        /* globals __webpack_amd_options__ */\n        module.exports = __webpack_amd_options__;\n        /* WEBPACK VAR INJECTION */\n      }).call(exports, {});\n      /***/\n    }\n    /******/\n    ])\n  );\n});","map":{"version":3,"sources":["/opt/bitnami/apache/htdocs/converzee-frontend/node_modules/react-summernote/dist/react-summernote.js"],"names":["webpackUniversalModuleDefinition","root","factory","exports","module","require","define","amd","__WEBPACK_EXTERNAL_MODULE_4__","__WEBPACK_EXTERNAL_MODULE_11__","modules","installedModules","__webpack_require__","moduleId","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","process","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","setTimeout","e","clearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","nextTick","args","Array","arguments","push","Item","array","apply","title","browser","env","argv","version","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","makeEmptyFunction","arg","emptyFunction","thatReturns","thatReturnsFalse","thatReturnsTrue","thatReturnsNull","thatReturnsThis","thatReturnsArgument","validateFormat","format","NODE_ENV","undefined","invariant","condition","a","b","f","error","argIndex","replace","framesToPop","ReactPropTypesSecret","global","CodeMirror","userAgent","navigator","platform","gecko","test","ie_upto10","ie_11up","exec","edge","ie","ie_version","document","documentMode","webkit","qtwebkit","chrome","presto","safari","vendor","mac_geMountainLion","phantom","ios","android","mobile","mac","chromeOS","windows","presto_version","match","Number","flipCtrlCmd","captureRightClick","classTest","cls","RegExp","rmClass","node","current","className","after","slice","index","removeChildren","count","childNodes","removeChild","firstChild","removeChildrenAndAdd","parent","appendChild","elt","tag","content","style","createElement","cssText","createTextNode","eltP","setAttribute","range","createRange","start","end","endNode","r","setEnd","setStart","body","createTextRange","moveToElementText","parentNode","collapse","moveEnd","moveStart","contains","child","nodeType","host","activeElt","activeElement","shadowRoot","addClass","joinClasses","as","split","selectInput","select","selectionStart","selectionEnd","_e","bind","copyObj","obj","target","overwrite","prop","countColumn","string","tabSize","startIndex","startValue","search","nextTab","indexOf","Delayed","id","set","ms","scrollerGap","Pass","toString","sel_dontScroll","scroll","sel_mouse","origin","sel_move","findColumn","goal","pos","col","skipped","Math","min","spaceStrs","spaceStr","lst","arr","map","out","insertSorted","score","priority","splice","nothing","createObj","base","props","inst","create","nonASCIISingleCaseWordChar","isWordCharBasic","ch","toUpperCase","toLowerCase","isWordChar","helper","source","isEmpty","extendingChars","isExtendingChar","charCodeAt","skipExtendingChars","str","charAt","findFirst","pred","from","to","abs","mid","floor","Display","place","doc","input","scrollbarFiller","gutterFiller","lineDiv","selectionDiv","cursorDiv","measure","lineMeasure","lineSpace","lines","mover","sizer","sizerWidth","heightForcer","gutters","lineGutter","scroller","wrapper","zIndex","paddingRight","draggable","viewFrom","viewTo","first","reportedViewFrom","reportedViewTo","view","renderedView","externalMeasured","viewOffset","lastWrapHeight","lastWrapWidth","updateLineNumbers","nativeBarWidth","barHeight","barWidth","scrollbarsClipped","lineNumWidth","lineNumInnerWidth","lineNumChars","alignWidgets","cachedCharWidth","cachedTextHeight","cachedPaddingH","maxLine","maxLineLength","maxLineChanged","wheelDX","wheelDY","wheelStartX","wheelStartY","shift","selForContextMenu","activeTouch","init","getLine","size","chunk","children","sz","chunkSize","getBetween","line","iter","text","getLines","updateLineHeight","height","diff","lineNo","cur","no","lineAtHeight","h","outer","i$1","lh","isLine","lineNumberFor","options","String","lineNumberFormatter","firstLineNumber","Pos","sticky","cmp","equalCursorPos","copyPos","x","maxPos","minPos","clipLine","max","clipPos","last","clipToLen","linelen","clipPosArray","sawReadOnlySpans","sawCollapsedSpans","seeReadOnlySpans","seeCollapsedSpans","MarkedSpan","getMarkedSpanFor","spans","span","removeMarkedSpan","addMarkedSpan","markedSpans","attachLine","markedSpansBefore","old","startCh","isInsert","nw","startsBefore","inclusiveLeft","type","insertLeft","endsAfter","inclusiveRight","markedSpansAfter","endCh","stretchSpansOverChange","change","full","oldFirst","oldLast","sameLine","offset","found","span$1","found$1","clearEmptySpans","newMarkers","gap","gapMarkers","i$2","i$3","clearWhenEmpty","removeReadOnlyRanges","markers","mark","readOnly","parts","mk","find","j","newParts","dfrom","dto","detachMarkedSpans","detachLine","attachMarkedSpans","extraLeft","extraRight","compareCollapsedMarkers","lenDiff","aPos","bPos","fromCmp","toCmp","collapsedSpanAtSide","sps","sp","collapsed","collapsedSpanAtStart","collapsedSpanAtEnd","conflictingCollapsedRange","lineNo$$1","visualLine","merged","visualLineEnd","visualLineContinued","visualLineNo","lineN","vis","visualLineEndNo","lastLine","lineIsHidden","widgetNode","lineIsHiddenInner","heightAtLine","lineObj","lineLength","findMaxLine","cm","display","iterateBidiSections","order","part","level","bidiOther","getBidiPartAt","bidiOrdering","lowTypes","arabicTypes","charType","code","bidiRE","isNeutral","isStrong","countsAsLeft","countsAsNum","BidiSpan","direction","outerType","types","prev","type$1","prev$1","type$2","i$4","type$3","i$5","cur$1","type$4","i$6","end$1","before","replace$1","j$1","i$7","at","j$2","nstart","unshift","reverse","getOrder","moveCharLogically","moveLogically","endOfLine","visually","moveInStorageOrder","prep","prepareMeasureForLine","targetTop","measureCharPrepared","top","moveVisually","bidi","partPos","mv","getWrappedLineExtent","lineWrapping","begin","wrappedLineExtentChar","wrappedLineExtent","searchInVisualLine","getRes","res","nextCh","noHandlers","emitter","addEventListener","attachEvent","map$$1","_handlers","getHandlers","removeEventListener","detachEvent","signal","handlers","signalDOMEvent","override","preventDefault","defaultPrevented","e_defaultPrevented","codemirrorIgnore","signalCursorActivity","cursorActivity","curOp","cursorActivityHandlers","hasHandler","eventMixin","ctor","e_preventDefault","returnValue","e_stopPropagation","stopPropagation","cancelBubble","e_stop","e_target","srcElement","e_button","which","button","ctrlKey","dragAndDrop","div","zwspSupported","zeroWidthElement","offsetHeight","offsetWidth","badBidiRects","hasBadBidiRects","txt","r0","getBoundingClientRect","r1","left","right","splitLinesAuto","result","nl","rt","hasSelection","window","getSelection","te","range$$1","ownerDocument","selection","parentElement","compareEndPoints","hasCopyEvent","oncopy","badZoomedRects","hasBadZoomedRects","normal","fromRange","modes","mimeModes","defineMode","mode","dependencies","defineMIME","mime","spec","resolveMode","getMode","mfactory","modeObj","modeExtensions","exts","helperType","modeProps","prop$1","extendMode","properties","copyState","state","nstate","val","innerMode","info","startState","a1","a2","StringStream","lastColumnPos","lastColumnValue","lineStart","eol","sol","peek","next","eat","ok","eatWhile","eatSpace","this$1","skipToEnd","skipTo","backUp","column","indentation","pattern","consume","caseInsensitive","cased","substr","hideFirstChars","inner","highlightLine","forceToEnd","st","modeGen","lineClasses","runMode","loop","overlay","overlays","i_end","opaque","styles","classes","bgClass","textClass","getLineStyles","updateFrontier","getStateBefore","maxHighlightLength","stateAfter","styleClasses","frontier","precise","findStartLine","processLine","save","startAt","stream","callBlankLine","readToken","blankLine","token","takeToken","asArray","getObj","copy","tokens","extractLineClasses","output","lineClass","flattenSpans","curStart","curStyle","addModeClass","mName","minindent","minline","lim","indented","Line","estimateHeight","updateLine","estHeight","cleanUpLine","styleToClassCache","styleToClassCacheWithMode","interpretTokenStyle","cache","buildLineContent","lineView","builder","pre","trailingSpace","splitSpaces","getOption","rest","addToken","buildToken","buildTokenBadBidi","allowFrontierUpdate","insertLineContent","maps","caches","lastChild","querySelector","defaultSpecialCharPlaceholder","startStyle","endStyle","css","displayText","special","specialChars","mustWrap","createDocumentFragment","lastIndex","txt$1","tabWidth","specialCharPlaceholder","fullStyle","trailingBefore","spaceBefore","buildCollapsedSpan","ignoreWidget","widget","needsContentAttribute","setUneditable","allText","nextChange","spanStyle","spanEndStyle","spanStartStyle","Infinity","foundBookmarks","endStyles","upto","tokenText","LineView","hidden","buildViewArray","nextPos","operationGroup","pushOperation","op","ops","ownsGroup","delayedCallbacks","fireCallbacksForOps","group","callbacks","cursorActivityCalled","finishOperation","endCb","orphanDelayedCallbacks","signalLater","list","fireOrphanDelayed","delayed","updateLineForChanges","dims","changes","updateLineText","updateLineGutter","updateLineClasses","updateLineWidgets","ensureLineWrapped","replaceChild","updateLineBackground","background","wrap","insertBefore","getLineContent","ext","built","wrapClass","gutter","gutterBackground","gutterClass","fixedGutter","fixedPos","gutterTotalWidth","gutterMarkers","lineNumbers","wrap$1","gutterWrap","lineNumber","gutterLeft","k","gutterWidth","alignable","nextSibling","insertLineWidgets","buildLineElement","insertLineWidgetsFor","allowAbove","widgets","ws","handleMouseEvents","positionLineWidget","above","noHScroll","width","wrapperWidth","coverGutter","paddingLeft","position","marginLeft","widgetHeight","parentStyle","clientWidth","eventInWidget","getAttribute","paddingTop","offsetTop","paddingVert","paddingH","getComputedStyle","currentStyle","data","parseInt","isNaN","scrollGap","displayWidth","displayHeight","clientHeight","ensureLineHeights","rect","wrapping","curWidth","heights","rects","getClientRects","bottom","mapFromLineView","updateExternalMeasurement","measureChar","bias","findViewForLine","findViewIndex","getDimensions","forceUpdate","hasHeights","prepared","varHeight","key","measureCharInner","bogus","rtop","rbottom","nullRect","nodeAndOffsetInLineMap","mStart","mEnd","coverStart","coverEnd","getUsefulRect","maybeUpdateRectForZooming","rSpan","charWidth","rbot","bot","singleCursorHeightPerLine","screen","logicalXDPI","deviceXDPI","scaleX","scaleY","logicalYDPI","deviceYDPI","clearLineMeasurementCacheFor","clearLineMeasurementCache","externalMeasure","clearCaches","pageScrollX","pageXOffset","documentElement","scrollLeft","pageScrollY","marginTop","pageYOffset","scrollTop","intoCoordSystem","context","includeWidgets","yOff","lOff","xOff","fromCoordSystem","coords","localBox","lineSpaceBox","charCoords","cursorCoords","preparedMeasure","getBidi","invert","other","estimateCoords","PosWithInfo","outside","xRel","coordsChar","y","coordsCharInner","mergedPos","assign","beginLeft","prevDiff","prevPos","box","measureText","textHeight","anchor","clientLeft","offsetLeft","compensateForHScroll","th","perLine","widgetsHeight","ceil","estimateLineHeights","est","posFromMouse","liberal","forRect","space","clientX","clientY","colDiff","round","updateSelection","showSelection","prepareSelection","primary","curFragment","cursors","selFragment","sel","ranges","primIndex","empty","showCursorWhenSelecting","drawSelectionCursor","head","drawSelectionRange","cursor","cursorHeight","otherCursor","fragment","padding","leftSide","rightSide","add","drawForLine","fromArg","toArg","lineLen","leftPos","rightPos","tmp","sFrom","sTo","fromLine","toLine","singleVLine","leftEnd","rightStart","restartBlink","focused","clearInterval","blinker","visibility","cursorBlinkRate","setInterval","ensureFocus","focus","onFocus","delayBlurEvent","delayingBlurEvent","onBlur","reset","receivedFocus","updateHeightsInViewport","prevBottom","updateWidgetHeight","visibleLines","viewport","ensure","ensureFrom","ensureTo","alignHorizontally","comp","gutterW","align","maybeUpdateLineNumberWidth","innerW","updateGutterSpace","maybeScrollWindow","doScroll","innerHeight","scrollNode","scrollIntoView","scrollPosIntoView","margin","limit","changed","endCoords","scrollPos","calculateScrollPos","startTop","startLeft","updateScrollTop","setScrollLeft","snapMargin","screentop","docBottom","atTop","atBottom","newTop","screenleft","screenw","tooWide","addToScrollTop","resolveScrollToPos","ensureCursorVisible","getCursor","scrollToPos","cursorScrollMargin","scrollToCoords","scrollToRange","scrollToCoordsRange","sPos","updateDisplaySimple","setScrollTop","startWorker","forceScroll","scrollHeight","scrollbars","isScroller","scrollWidth","measureForScrollbars","docH","viewHeight","viewWidth","barLeft","docHeight","NativeScrollbars","vert","horiz","checkedZeroWidth","minHeight","minWidth","update","needsH","needsV","sWidth","totalHeight","totalWidth","zeroWidthHack","disableHoriz","enableZeroWidthBar","disableVert","w","pointerEvents","bar","delay","maybeDisable","elt$$1","elementFromPoint","clear","NullScrollbars","updateScrollbars","startWidth","startHeight","updateScrollbarsInner","sizes","paddingBottom","borderBottom","coverGutterNextToScrollbar","scrollbarModel","initScrollbars","scrollbarStyle","axis","nextOpId","startOperation","viewChanged","updateInput","typing","changeObjs","selectionChanged","updateMaxLine","endOperation","endOperations","endOperation_R1","endOperation_W1","endOperation_R2","endOperation_W2","endOperation_finish","maybeClipScrollbars","mustUpdate","DisplayUpdate","updatedDisplay","updateDisplayIfNeeded","barMeasure","adjustWidthTo","maxScrollLeft","preparedSelection","takeFocus","hasFocus","setDocumentHeight","postUpdateDisplay","maybeHiddenMarkers","unhidden","maybeUnhiddenMarkers","finish","runInOp","operation","methodOp","docMethodOp","regChange","lendiff","resetView","cut","viewCuttingPoint","cut$1","cutTop","cutBot","regLineChange","oldN","newN","adjustView","countDirtyView","dirty","time","highlight","highlightWorker","Date","workTime","changedLines","oldStyles","tooLong","highlighted","oldCls","newCls","ischange","workDelay","force","visible","editorIsHidden","wrapperHeight","oldDisplayWidth","events","marginBottom","borderRightWidth","selectionSnapshot","active","anchorNode","extend","anchorOffset","focusNode","focusOffset","restoreSelection","snapshot","removeAllRanges","addRange","viewportMargin","different","toUpdate","selSnapshot","patchDisplay","updateNumbersFrom","container","rm","currentWheelTarget","updateNumber","updateGutters","specs","gElt","setGuttersForLineNumbers","wheelSamples","wheelPixelsPerUnit","wheelEventDelta","dx","wheelDeltaX","dy","wheelDeltaY","detail","HORIZONTAL_AXIS","VERTICAL_AXIS","wheelDelta","wheelEventPixels","delta","onScrollWheel","canScrollX","canScrollY","pixels","movedX","movedY","sample","Selection","equals","here","there","deepCopy","Range","somethingSelected","normalizeSelection","prim","sort","inv","simpleSelection","changeEnd","adjustForChange","computeSelAfterChange","offsetPos","computeReplacedSel","hint","oldPrev","newPrev","loadMode","modeOption","resetModeState","isWholeLineUpdate","wholeLineUpdateBefore","updateDoc","estimateHeight$$1","spansFor","linesFor","firstLine","lastText","lastSpans","nlines","insert","remove","added","added$1","added$2","linkedDocs","sharedHistOnly","propagate","skip","sharedHist","linked","rel","shared","attachDoc","setDirectionClass","directionChanged","History","startGen","done","undone","undoDepth","lastModTime","lastSelTime","lastOp","lastSelOp","lastOrigin","lastSelOrigin","generation","maxGeneration","historyChangeFromChange","histChange","attachLocalSpans","clearSelectionEvents","pop","lastChangeEvent","hist","addChangeToHistory","selAfter","opId","history","historyEventDelay","pushSelectionToHistory","selectionEventCanBeMerged","addSelectionToHistory","clearRedo","dest","existing","removeClearedSpans","explicitlyCleared","getOldSpans","mergeOldSpans","stretched","oldCur","stretchCur","copyHistoryArray","newGroup","instantiateSel","event","newChanges","extendRange","posBefore","extendSelection","setSelection","extendSelections","heads","newSel","replaceOneSelection","setSimpleSelection","filterSelectionChange","setSelectionReplaceHistory","setSelectionNoUndo","NaN","setSelectionInner","skipAtomicInSelection","reCheckSelection","mayClear","newAnchor","skipAtomic","newHead","skipAtomicInner","oldPos","atomic","near","movePos","far","cantEdit","selectAll","filterChange","canceled","cancel","makeChange","ignoreReadOnly","suppressEdits","makeChangeInner","makeChangeSingleDoc","rebased","rebaseHist","makeChangeFromHistory","allowSelectionOnly","antiChanges","filter","returned","v","shiftDoc","distance","removed","makeChangeSingleDocInEditor","recomputeMaxLength","checkWidthStart","changesHandler","changeHandler","replaceRange","splitLines","rebaseHistSelSingle","rebaseHistArray","sub","copied","changeLine","handle","changeType","LeafChunk","removeInner","insertInner","iterN","BranchChunk","oldHeight","remaining","leaf","maybeSpill","me","spilled","sibling","myIndex","used","LineWidget","opt","adjustScrollWhenAboveVisible","oldH","addLineWidget","insertAt","aboveVisible","nextMarkerId","TextMarker","withOp","visual","side","dHeight","markText","markTextShared","replacedWith","addToHistory","curLine","clearOnEnter","clearHistory","SharedTextMarker","cloneNode","isParent","findSharedMarkers","findMarks","copySharedMarkers","mFrom","mTo","subMark","detachSharedMarkers","subMarker","nextDocId","Doc","lineSep","cleanGeneration","constructor","getValue","join","lineSeparator","setValue","getRange","getLineHandle","getLineNumber","getLineHandleVisualStart","lineCount","listSelections","setCursor","extendSelectionsBy","setSelections","addSelection","getSelections","replaceSelection","dup","replaceSelections","undo","redo","undoSelection","redoSelection","setExtending","getExtending","historySize","markClean","changeGeneration","forceSplit","isClean","gen","getHistory","setHistory","histData","setGutterMarker","gutterID","clearGutter","lineInfo","addLineClass","where","removeLineClass","removeLineWidget","setBookmark","realOpts","findMarksAt","getAllMarks","posFromIndex","sepSize","indexFromPos","copyHistory","linkedDoc","unlinkDoc","CodeMirror$1","link","splitIds","iterLinkedDocs","getEditor","setDirection","eachLine","lastDrop","onDrop","clearDragCursor","files","dataTransfer","isReadOnly","FileReader","File","read","loadFile","file","allowDropFileTypes","reader","onload","readAsText","draggingText","text$1","getData","selected","onDragStart","setData","effectAllowed","setDragImage","img","src","_top","onDragOver","frag","dragCursor","forEachCodeMirror","getElementsByClassName","byClass","globalsRegistered","ensureGlobalHandlers","registerGlobalHandlers","resizeTimer","onResize","setSize","keyNames","fromCharCode","keyMap","basic","pcDefault","fallthrough","emacsy","macDefault","normalizeKeyName","alt","ctrl","cmd","mod","normalizeKeyMap","keymap","keyname","keys","lookupKey","getKeyMap","isModifierKey","keyCode","keyName","noShift","altGraphKey","altKey","metaKey","shiftKey","deleteNearSelection","compute","kill","toKill","replaced","commands","singleSelection","killLine","deleteLine","delLineLeft","delWrappedLineLeft","delWrappedLineRight","goDocStart","goDocEnd","goLineStart","goLineStartSmart","lineStartSmart","goLineEnd","lineEnd","goLineRight","goLineLeft","goLineLeftSmart","goLineUp","moveV","goLineDown","goPageUp","goPageDown","goCharLeft","moveH","goCharRight","goColumnLeft","goColumnRight","goWordLeft","goGroupRight","goGroupLeft","goWordRight","delCharBefore","deleteH","delCharAfter","delWordBefore","delWordAfter","delGroupBefore","delGroupAfter","indentAuto","indentSelection","indentMore","indentLess","insertTab","insertSoftTab","spaces","defaultTab","execCommand","transposeChars","newlineAndIndent","sels","indentLine","openLine","toggleOverwrite","firstNonWS","inWS","doHandleBinding","bound","dropShift","ensurePolled","prevShift","lookupKeyForEditor","keyMaps","extraKeys","stopSeq","dispatchKey","seq","keySeq","handleKeyBinding","motion","handleCharBinding","lastStoppedKey","onKeyDown","handled","showCrossHair","up","onKeyUp","onKeyPress","charCode","onMouseDown","supportsTouch","clickInGutter","selectingText","leftButtonDown","lastMiddleDown","onContextMenu","lastClick","lastDoubleClick","now","modifier","contained","dragDrop","leftButtonStartDrag","leftButtonSelect","moved","dragEnd","mouseMove","dragStart","e2","addNew","ourRange","ourIndex","startSel","word","findWordAt","lastPos","extendTo","startCol","posCol","oldRange","ranges$1","editorSize","counter","curCount","move","gutterEvent","prevent","mX","mY","lineBox","g","contextMenuInGutter","themeChanged","theme","Init","defaults","optionHandlers","defineOptions","option","deflt","notOnInit","defineOption","newBreaks","refresh","getInputField","spellcheck","guttersChanged","detach","attach","wrappingChanged","integer","blur","disabled","readOnlyChanged","dragDropChanged","resetPosition","getField","tabIndex","wasOn","funcs","dragFunctions","toggle","enter","over","leave","drop","inputStyles","inputStyle","pasteIncoming","cutIncoming","autofocus","registerEventHandlers","finishInit","initHooks","textRendering","touchFinished","prevTouch","finishTouch","isMouseLikeTouchEvent","touches","touch","radiusX","radiusY","farAway","pageX","pageY","inp","defineInitHook","how","aggressive","indent","curSpace","curSpaceString","indentUnit","indentString","indentWithTabs","pos$1","lastCopied","setLastCopied","newLastCopied","applyTextInput","inserted","deleted","paste","textLines","multiPaste","lineWise","changeEvent","triggerElectric","handlePaste","pasted","clipboardData","disableInput","electricChars","smartIndent","getModeAt","electricInput","copyableRanges","lineRange","disableBrowserMagic","field","hiddenTextarea","border","addEditorMethods","helpers","setOption","getDoc","addKeyMap","removeKeyMap","addOverlay","modeSpec","removeOverlay","newRanges","getTokenAt","getLineTokens","getTokenTypeAt","getHelper","getHelpers","help","_global","getStateAfter","defaultTextHeight","defaultCharWidth","getViewport","addWidget","vspace","hspace","triggerOnKeyDown","triggerOnKeyPress","triggerOnKeyUp","findPosH","amount","unit","hitSide","rtlMoveVisually","findPosV","goalColumn","goals","headPos","startChar","check","scrollTo","getScrollInfo","interpret","swapDoc","getWrapperElement","getScrollerElement","getGutterElement","registerHelper","registerGlobalHelper","predicate","origDir","findNextLine","moveOnce","boundToLine","sawType","pageSize","moveAmount","ContentEditableInput","lastAnchorNode","lastAnchorOffset","lastFocusNode","lastFocusOffset","polling","composing","gracePeriod","readDOMTimeout","updateFromDOM","readFromDOMSoon","forceCompositionEnd","onCopyCut","lineWiseCopyCut","clearData","kludge","hadFocus","showPrimarySelection","showMultipleSelections","curAnchor","domToPos","curFocus","bad","posToDOM","rangeCount","getRangeAt","rng","startGracePeriod","rememberSelection","selectionInEditor","commonAncestorContainer","pollSelection","poll","pollInterval","isInGutter","pollContent","fromIndex","fromNode","toIndex","toNode","previousSibling","newText","domTextBetween","oldText","cutFront","cutEnd","oldTop","maxCutFront","newBot","oldBot","maxCutEnd","chFrom","chTo","contentEditable","scan","badPos","closing","recognizeMarker","close","addText","walk","cmText","textContent","markerID","isBlock","nodeName","nodeValue","lineNode","locateNodeInLineView","textNode","topNode","curNode","dist","dist$1","TextareaInput","prevInput","pollingFast","inaccurateSelection","textarea","fastPoll","prepareCopyCut","moveInputWithCursor","wrapOff","lineOff","teTop","teLeft","drawn","contextMenuPending","minimal","slowPoll","missed","same","resetSelectionOnContextMenu","oldCSS","oldWrapperCSS","wrapperBox","oldScrollY","scrollY","detectingSelectAll","prepareSelectAllHack","extval","rehide","mouseup","fromTextArea","tabindex","placeholder","realSubmit","form","leaveSubmitMethodAlone","submit","wrappedSubmit","getTextArea","toTextArea","addLegacyProps","cmpPos","dontDelegate","method","defineExtension","func","defineDocExtension","warning","printWarning","_len","_key","message","console","_len2","_key2","REACT_ELEMENT_TYPE","Symbol","for","isValidElement","$$typeof","throwOnDirectAccess","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","jQuery","$","eq","itemA","itemB","eq2","peq2","propName","fail","not","and","fA","fB","item","self","invoke","idCounter","uniqueId","prefix","rect2bnd","$document","invertObject","inverted","namespaceToCamel","namespace","substring","debounce","wait","immediate","later","callNow","initial","tail","idx","all","inArray","sum","fn","reduce","memo","collection","clusterBy","aTail","aLast","compact","aResult","unique","results","isSupportAmd","isFontInstalled","fontName","testFontName","$tester","fontSize","appendTo","originalWidth","isMSIE","browserVersion","matches","parseFloat","isEdge","hasCodeMirror","eval","specified","agent","isMac","appVersion","isFF","isPhantom","isWebkit","isChrome","isSafari","jqueryVersion","jquery","isW3CRangeSupport","NBSP_CHAR","ZERO_WIDTH_NBSP_CHAR","dom","isEditable","hasClass","isControlSizing","makePredByNodeName","isText","isElement","isVoid","isPara","isHeading","isPre","isLi","isPurePara","isTable","isData","isInline","isBodyContainer","isList","isHr","isBlockquote","isCell","isAnchor","isParaInline","ancestor","isBodyInline","isBody","isClosestSibling","nodeA","nodeB","withClosestSiblings","siblings","blankHTML","nodeLength","innerHTML","paddingBlankHTML","singleChildAncestor","listAncestor","ancestors","el","lastAncestor","commonAncestor","listPrev","nodes","listNext","listDescendant","descendants","fnWalk","wrapperName","insertAfter","preceding","appendChildNodes","aChild","each","isLeftEdgePoint","point","isRightEdgePoint","isEdgePoint","isLeftEdgeOf","isRightEdgeOf","isLeftEdgePointOf","isRightEdgePointOf","hasChildren","prevPoint","isSkipInnerOffset","nextPoint","isSamePoint","pointA","pointB","isVisiblePoint","leftNode","rightNode","prevPointUntil","nextPointUntil","isCharPoint","walkPoint","startPoint","endPoint","handler","isSkipOffset","makeOffsetPath","fromOffsetPath","offsets","splitNode","isSkipPaddingBlankHTML","isNotSplitEdgePoint","splitText","childNode","clone","splitTree","splitPoint","topAncestor","splitRoot","pivot","createText","isRemoveChild","removeNode","removeWhile","newNode","isTextarea","$node","stripLinebreaks","html","isNewlineOnBlock","markup","regexTag","endSlash","isEndOfInlineContainer","isBlockNode","trim","posFromPlaceholder","$placeholder","outerHeight","attachEvents","forEach","detachEvents","blank","emptyPara","isDiv","isBR","isSpan","isB","isU","isS","isI","isImg","isEmptyAnchor","Context","$note","ui","summernote","memos","layoutInfo","initialize","createLayout","_initialize","hide","destroy","_destroy","removeData","removeLayout","isDisabled","disable","buttons","plugins","initializeModule","removeModule","removeMemo","triggerEvent","isActivated","codable","editable","attr","enable","callback","trigger","shouldInitialize","ModuleClass","withoutIntialize","createInvokeHandler","closest","splits","hasSeparator","moduleName","methodName","isExternalAPICalled","hasInitOptions","langInfo","lang","icons","note","Renderer","render","$parent","contents","click","$container","append","renderer","isArray","editor","toolbar","editingArea","statusbar","airEditor","airEditable","buttonGroup","tooltip","placement","dropdown","items","template","dropdownCheck","icon","checkClassName","palette","row","rowSize","colors","eventName","colSize","color","dialog","fade","footer","popover","hideArrow","iconClassName","tagName","toggleBtn","$btn","isEnable","toggleClass","toggleBtnActive","isActive","onDialogShown","$dialog","one","onDialogHidden","showDialog","modal","hideDialog","$editor","airMode","show","font","bold","italic","underline","strikethrough","subscript","superscript","image","resizeFull","resizeHalf","resizeQuarter","floatLeft","floatRight","floatNone","shapeRounded","shapeCircle","shapeThumbnail","shapeNone","dragImageHere","dropImage","selectFromFiles","maximumFileSize","maximumFileSizeError","url","video","videoLink","providers","unlink","edit","textToDisplay","openInNewWindow","table","hr","blockquote","h1","h2","h3","h4","h5","h6","lists","unordered","ordered","fullscreen","codeview","paragraph","outdent","center","justify","recent","more","foreground","transparent","setTransparent","resetToDefault","shortcut","shortcuts","textFormatting","action","paragraphFormatting","documentStyle","specialChar","isEdit","BACKSPACE","TAB","ENTER","SPACE","isMove","LEFT","UP","RIGHT","DOWN","nameFromCode","textRangeToPoint","textRange","isStart","tester","prevContainer","textRangeStart","curTextNode","pointTester","duplicate","setEndPoint","textCount","dummy","cont","pointToTextRange","textRangeInfo","isCollapseToStart","prevTextNodes","collapseToStart","WrappedRange","sc","so","ec","eo","nativeRange","w3cRange","getPoints","getStartPoint","getEndPoint","nativeRng","normalize","getVisiblePoint","isLeftToRight","block","isCollapsed","includeAncestor","fullyContains","leftEdgeNodes","expand","startAncestor","endAncestor","boundaryPoints","isSameContainer","deleteContents","emptyParents","makeIsOn","isOnEditable","isOnList","isOnAnchor","isOnCell","isOnData","wrapBodyInlineWithPara","inlineSiblings","para","insertNode","pasteHTML","contentsContainer","getWordRange","findAfter","bookmark","path","paraBookmark","paras","wrappedRange","createFromSelection","createFromNode","startContainer","startOffset","endContainer","endOffset","textRangeEnd","isTextNode","createFromNodeBefore","createFromNodeAfter","createFromBookmark","createFromParaBookmark","async","readFileAsDataURL","Deferred","deferred","dataURL","resolve","onerror","reject","readAsDataURL","promise","createImage","$img","$editable","stack","stackOffset","makeSnapshot","emptyBookmark","applySnapshot","rewind","recordUndo","Style","jQueryCSS","$obj","propertyNames","propertyName","styleInfo","stylePara","styleNodes","expandClosestSibling","onlyPartialContains","nodesInRange","tails","elem","$cont","queryCommandState","orderedTypes","isUnordered","lineHeight","toFixed","Bullet","insertOrderedList","toggleList","insertUnorderedList","clustereds","wrapList","releaseList","listName","wrappedParas","diffLists","listNode","prevList","nextList","isEscapseToBody","releasedParas","headList","lastList","middleList","rootLists","rootList","listNodes","Typing","bullet","tabsize","tab","insertParagraph","nextPara","emptyAnchors","Table","isShift","cell","cells","nextCell","createTable","colCount","rowCount","tds","tdHTML","idxCol","trs","trHTML","idxRow","$table","tableClassName","KEY_BOGUS","Editor","lastRange","isDefaultPrevented","handleKeyMap","preventDefaultEditableShortCuts","changeEventName","outerWidth","maxHeight","afterCommand","saveRange","thenCollapse","restoreRange","saveTarget","clearTarget","restoreTarget","styleFromNode","beforeCommand","isPreventTrigger","sCmd","untab","wrapCommand","insertImage","param","then","$image","insertImages","filename","maximumImageFileSize","insertImagesOrCallback","onImageUpload","insertText","getSelectedText","formatBlock","formatPara","firstSpan","insertHorizontalRule","hrNode","removeBogus","bogusNode","bogusCharIdx","deleteData","createLink","linkInfo","linkUrl","linkText","isNewWindow","isTextChanged","onCreateLink","anchors","removeAttr","startRange","endRange","getLinkInfo","$anchor","colorInfo","foreColor","backColor","insertTable","dim","dimension","floatMe","$target","resize","resizeTo","bKeepRatio","imageSize","newRatio","ratio","removeMedia","is","Clipboard","we","needKeydownHook","V","$paste","pasteByHook","opacity","pasteByEvent","dataURI","decodedData","atob","Uint8Array","blob","Blob","pasteContent","originalEvent","kind","getAsFile","Dropzone","documentEventHandlers","$dropzone","prependTo","detachDocumentEvent","disableDragAndDrop","attachDragAndDropEvent","$dropzoneMessage","onDragenter","isCodeview","hasEditorSize","onDragleave","removeClass","Promise","__WEBPACK_AMD_REQUIRE_ARRAY__","catch","oe","Codeview","$codable","sync","deactivate","activate","prettifyHtml","cmEditor","codemirror","tern","server","TernServer","ternServer","updateArgHints","isChange","EDITABLE_PADDING","Statusbar","$statusbar","disableResizeEditor","editableTop","minheight","Fullscreen","$toolbar","$window","$scrollbar","setsize","isFullscreen","Handle","$editingArea","$handle","disableResizeImage","posStart","isImage","$selection","sizingText","AutoLink","defaultScheme","linkPattern","handleKeyup","handleKeydown","lastWordRange","keyword","wordRange","AutoSync","Placeholder","isShow","Buttons","invertedKeyMap","representShortcut","editorMethod","addToolbarButtons","addImagePopoverButtons","addLinkPopoverButtons","fontInstalledMap","fontNamesIgnoreCheck","magic","caret","styleTags","eraser","menuCheck","fontNames","fontSizes","$button","currentTarget","$recentColor","$dropdown","$holder","$color","$currentButton","unorderedlist","orderedlist","justifyLeft","alignLeft","justifyCenter","alignCenter","justifyRight","alignRight","justifyFull","alignJustify","lineHeights","$catcher","insertTableMaxSize","mousedown","tableMoveHandler","picture","minus","arrowsAlt","question","trash","build","groups","groupIdx","groupLen","groupName","$group","updateCurrentStyle","updateBtnStates","isChecked","infos","selector","PX_PER_EM","$picker","$dimensionDisplay","$highlighted","$unhighlighted","posOffset","offsetX","posCatcher","offsetY","Toolbar","toolbarContainer","updateFullscreen","updateCodeview","isIncludeCodeview","LinkDialog","dialogsInBody","disableLinkTarget","dialogsFade","bindEnterKey","$input","toggleLinkBtn","$linkBtn","$linkText","$linkUrl","showLinkDialog","$openInNewWindow","handleLinkTextUpdate","handleLinkUrlUpdate","LinkPopover","$popover","$content","prepend","href","ImageDialog","imageLimitation","log","readableSize","pow","showImageDialog","$imageInput","$imageUrl","$imageBtn","replaceWith","ImagePopover","VideoDialog","createVideoNode","ytRegExp","ytMatch","igRegExp","igMatch","vRegExp","vMatch","vimRegExp","vimMatch","dmRegExp","dmMatch","youkuRegExp","youkuMatch","mp4RegExp","mp4Match","oggRegExp","oggMatch","webmRegExp","webmMatch","$video","youtubeId","showVideoDialog","$videoUrl","$videoBtn","HelpDialog","createShortCutList","command","$row","showHelpDialog","AirPopover","AIR_MODE_POPOVER_X_OFFSET","relatedTarget","air","bnd","HintPopover","POPOVER_DIST","hintDirection","hints","selectItem","$item","moveDown","$current","$next","$nextGroup","moveUp","$prev","$prevGroup","nodeFromItem","createItemTemplates","hintIdx","searchKeyword","createGroup","styleWithSpan","textareaAutoSync","onInit","onEnter","onKeyup","onKeydown","onImageUploadError","htmlMode","pc","_createClass","defineProperties","descriptor","writable","Constructor","protoProps","staticProps","_react","_react2","_interopRequireDefault","_propTypes","_propTypes2","default","_classCallCheck","instance","TypeError","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","setPrototypeOf","__proto__","randomUid","random","ReactSummernote","_Component","_this","getPrototypeOf","uid","noteEditable","notePlaceholder","toggleState","componentDidMount","componentWillReceiveProps","nextProps","shouldComponentUpdate","componentWillUnmount","_props","images","prevContent","contentLength","filenameOrCallback","_props2","defaultValue","dangerouslySetInnerHTML","__html","onPaste","onChange","Component","propTypes","bool","loggedTypeFailures","checkPropTypes","typeSpecs","values","location","componentName","getStack","typeSpecName","ex","shim","propFullName","secret","isRequired","getShim","ReactPropTypes","number","symbol","any","arrayOf","element","instanceOf","objectOf","oneOf","oneOfType","shape","PropTypes","ITERATOR_SYMBOL","iterator","FAUX_ITERATOR_SYMBOL","getIteratorFn","maybeIterable","iteratorFn","ANONYMOUS","createPrimitiveTypeChecker","createAnyTypeChecker","createArrayOfTypeChecker","createElementTypeChecker","createInstanceTypeChecker","createNodeChecker","createObjectOfTypeChecker","createEnumTypeChecker","createUnionTypeChecker","createShapeTypeChecker","PropTypeError","createChainableTypeChecker","validate","manualPropTypeCallCache","manualPropTypeWarningCount","checkType","cacheKey","chainedCheckType","expectedType","propValue","propType","getPropType","preciseType","getPreciseType","typeChecker","expectedClass","expectedClassName","actualClassName","getClassName","expectedValues","valuesString","JSON","stringify","arrayOfTypeCheckers","checker","getPostfixForTypeWarning","isNode","shapeTypes","every","step","entries","entry","isSymbol","__webpack_amd_options__"],"mappings":"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","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"), require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"jquery\", \"react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ReactSummernote\"] = factory(require(\"jquery\"), require(\"react\"));\n\telse\n\t\troot[\"ReactSummernote\"] = factory(root[\"$\"], root[\"React\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_4__, __WEBPACK_EXTERNAL_MODULE_11__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 12);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports) {\n\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/**\n * Copyright (c) 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * \n */\n\nfunction makeEmptyFunction(arg) {\n  return function () {\n    return arg;\n  };\n}\n\n/**\n * This function accepts and discards inputs; it has no side effects. This is\n * primarily useful idiomatically for overridable function endpoints which\n * always need to be callable, since JS lacks a null-call idiom ala Cocoa.\n */\nvar emptyFunction = function emptyFunction() {};\n\nemptyFunction.thatReturns = makeEmptyFunction;\nemptyFunction.thatReturnsFalse = makeEmptyFunction(false);\nemptyFunction.thatReturnsTrue = makeEmptyFunction(true);\nemptyFunction.thatReturnsNull = makeEmptyFunction(null);\nemptyFunction.thatReturnsThis = function () {\n  return this;\n};\nemptyFunction.thatReturnsArgument = function (arg) {\n  return arg;\n};\n\nmodule.exports = emptyFunction;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(process) {/**\n * Copyright (c) 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n */\n\n\n\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\n\nvar validateFormat = function validateFormat(format) {};\n\nif (process.env.NODE_ENV !== 'production') {\n  validateFormat = function validateFormat(format) {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  };\n}\n\nfunction invariant(condition, format, a, b, c, d, e, f) {\n  validateFormat(format);\n\n  if (!condition) {\n    var error;\n    if (format === undefined) {\n      error = new Error('Minified exception occurred; use the non-minified dev environment ' + 'for the full error message and additional helpful warnings.');\n    } else {\n      var args = [a, b, c, d, e, f];\n      var argIndex = 0;\n      error = new Error(format.replace(/%s/g, function () {\n        return args[argIndex++];\n      }));\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1; // we don't care about invariant's own frame\n    throw error;\n  }\n}\n\nmodule.exports = invariant;\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * Copyright 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n// This is CodeMirror (http://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function (global, factory) {\n\t true ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.CodeMirror = factory());\n}(this, (function () { 'use strict';\n\n// Kludges for bugs and behavior differences that can't be feature\n// detected are enabled based on userAgent etc sniffing.\nvar userAgent = navigator.userAgent;\nvar platform = navigator.platform;\n\nvar gecko = /gecko\\/\\d/i.test(userAgent);\nvar ie_upto10 = /MSIE \\d/.test(userAgent);\nvar ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\nvar edge = /Edge\\/(\\d+)/.exec(userAgent);\nvar ie = ie_upto10 || ie_11up || edge;\nvar ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\nvar webkit = !edge && /WebKit\\//.test(userAgent);\nvar qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\nvar chrome = !edge && /Chrome\\//.test(userAgent);\nvar presto = /Opera\\//.test(userAgent);\nvar safari = /Apple Computer/.test(navigator.vendor);\nvar mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\nvar phantom = /PhantomJS/.test(userAgent);\n\nvar ios = !edge && /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent);\nvar android = /Android/.test(userAgent);\n// This is woefully incomplete. Suggestions for alternative methods welcome.\nvar mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\nvar mac = ios || /Mac/.test(platform);\nvar chromeOS = /\\bCrOS\\b/.test(userAgent);\nvar windows = /win/i.test(platform);\n\nvar presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\nif (presto_version) { presto_version = Number(presto_version[1]); }\nif (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n// Some browsers use the wrong event properties to signal cmd/ctrl on OS X\nvar flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\nvar captureRightClick = gecko || (ie && ie_version >= 9);\n\nfunction classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\n\nvar rmClass = function(node, cls) {\n  var current = node.className;\n  var match = classTest(cls).exec(current);\n  if (match) {\n    var after = current.slice(match.index + match[0].length);\n    node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n  }\n};\n\nfunction removeChildren(e) {\n  for (var count = e.childNodes.length; count > 0; --count)\n    { e.removeChild(e.firstChild); }\n  return e\n}\n\nfunction removeChildrenAndAdd(parent, e) {\n  return removeChildren(parent).appendChild(e)\n}\n\nfunction elt(tag, content, className, style) {\n  var e = document.createElement(tag);\n  if (className) { e.className = className; }\n  if (style) { e.style.cssText = style; }\n  if (typeof content == \"string\") { e.appendChild(document.createTextNode(content)); }\n  else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]); } }\n  return e\n}\n// wrapper for elt, which removes the elt from the accessibility tree\nfunction eltP(tag, content, className, style) {\n  var e = elt(tag, content, className, style);\n  e.setAttribute(\"role\", \"presentation\");\n  return e\n}\n\nvar range;\nif (document.createRange) { range = function(node, start, end, endNode) {\n  var r = document.createRange();\n  r.setEnd(endNode || node, end);\n  r.setStart(node, start);\n  return r\n}; }\nelse { range = function(node, start, end) {\n  var r = document.body.createTextRange();\n  try { r.moveToElementText(node.parentNode); }\n  catch(e) { return r }\n  r.collapse(true);\n  r.moveEnd(\"character\", end);\n  r.moveStart(\"character\", start);\n  return r\n}; }\n\nfunction contains(parent, child) {\n  if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n    { child = child.parentNode; }\n  if (parent.contains)\n    { return parent.contains(child) }\n  do {\n    if (child.nodeType == 11) { child = child.host; }\n    if (child == parent) { return true }\n  } while (child = child.parentNode)\n}\n\nfunction activeElt() {\n  // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n  // IE < 10 will throw when accessed while the page is loading or in an iframe.\n  // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n  var activeElement;\n  try {\n    activeElement = document.activeElement;\n  } catch(e) {\n    activeElement = document.body || null;\n  }\n  while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\n    { activeElement = activeElement.shadowRoot.activeElement; }\n  return activeElement\n}\n\nfunction addClass(node, cls) {\n  var current = node.className;\n  if (!classTest(cls).test(current)) { node.className += (current ? \" \" : \"\") + cls; }\n}\nfunction joinClasses(a, b) {\n  var as = a.split(\" \");\n  for (var i = 0; i < as.length; i++)\n    { if (as[i] && !classTest(as[i]).test(b)) { b += \" \" + as[i]; } }\n  return b\n}\n\nvar selectInput = function(node) { node.select(); };\nif (ios) // Mobile Safari apparently has a bug where select() is broken.\n  { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; }; }\nelse if (ie) // Suppress mysterious IE10 errors\n  { selectInput = function(node) { try { node.select(); } catch(_e) {} }; }\n\nfunction bind(f) {\n  var args = Array.prototype.slice.call(arguments, 1);\n  return function(){return f.apply(null, args)}\n}\n\nfunction copyObj(obj, target, overwrite) {\n  if (!target) { target = {}; }\n  for (var prop in obj)\n    { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n      { target[prop] = obj[prop]; } }\n  return target\n}\n\n// Counts the column offset in a string, taking tabs into account.\n// Used mostly to find indentation.\nfunction countColumn(string, end, tabSize, startIndex, startValue) {\n  if (end == null) {\n    end = string.search(/[^\\s\\u00a0]/);\n    if (end == -1) { end = string.length; }\n  }\n  for (var i = startIndex || 0, n = startValue || 0;;) {\n    var nextTab = string.indexOf(\"\\t\", i);\n    if (nextTab < 0 || nextTab >= end)\n      { return n + (end - i) }\n    n += nextTab - i;\n    n += tabSize - (n % tabSize);\n    i = nextTab + 1;\n  }\n}\n\nvar Delayed = function() {this.id = null;};\nDelayed.prototype.set = function (ms, f) {\n  clearTimeout(this.id);\n  this.id = setTimeout(f, ms);\n};\n\nfunction indexOf(array, elt) {\n  for (var i = 0; i < array.length; ++i)\n    { if (array[i] == elt) { return i } }\n  return -1\n}\n\n// Number of pixels added to scroller and sizer to hide scrollbar\nvar scrollerGap = 30;\n\n// Returned or thrown by various protocols to signal 'I'm not\n// handling this'.\nvar Pass = {toString: function(){return \"CodeMirror.Pass\"}};\n\n// Reused option objects for setSelection & friends\nvar sel_dontScroll = {scroll: false};\nvar sel_mouse = {origin: \"*mouse\"};\nvar sel_move = {origin: \"+move\"};\n\n// The inverse of countColumn -- find the offset that corresponds to\n// a particular column.\nfunction findColumn(string, goal, tabSize) {\n  for (var pos = 0, col = 0;;) {\n    var nextTab = string.indexOf(\"\\t\", pos);\n    if (nextTab == -1) { nextTab = string.length; }\n    var skipped = nextTab - pos;\n    if (nextTab == string.length || col + skipped >= goal)\n      { return pos + Math.min(skipped, goal - col) }\n    col += nextTab - pos;\n    col += tabSize - (col % tabSize);\n    pos = nextTab + 1;\n    if (col >= goal) { return pos }\n  }\n}\n\nvar spaceStrs = [\"\"];\nfunction spaceStr(n) {\n  while (spaceStrs.length <= n)\n    { spaceStrs.push(lst(spaceStrs) + \" \"); }\n  return spaceStrs[n]\n}\n\nfunction lst(arr) { return arr[arr.length-1] }\n\nfunction map(array, f) {\n  var out = [];\n  for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i); }\n  return out\n}\n\nfunction insertSorted(array, value, score) {\n  var pos = 0, priority = score(value);\n  while (pos < array.length && score(array[pos]) <= priority) { pos++; }\n  array.splice(pos, 0, value);\n}\n\nfunction nothing() {}\n\nfunction createObj(base, props) {\n  var inst;\n  if (Object.create) {\n    inst = Object.create(base);\n  } else {\n    nothing.prototype = base;\n    inst = new nothing();\n  }\n  if (props) { copyObj(props, inst); }\n  return inst\n}\n\nvar nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\nfunction isWordCharBasic(ch) {\n  return /\\w/.test(ch) || ch > \"\\x80\" &&\n    (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\n}\nfunction isWordChar(ch, helper) {\n  if (!helper) { return isWordCharBasic(ch) }\n  if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) { return true }\n  return helper.test(ch)\n}\n\nfunction isEmpty(obj) {\n  for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\n  return true\n}\n\n// Extending unicode characters. A series of a non-extending char +\n// any number of extending chars is treated as a single unit as far\n// as editing and measuring is concerned. This is not fully correct,\n// since some scripts/fonts/browsers also treat other configurations\n// of code points as a group.\nvar extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\nfunction isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\n\n// Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\nfunction skipExtendingChars(str, pos, dir) {\n  while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir; }\n  return pos\n}\n\n// Returns the value from the range [`from`; `to`] that satisfies\n// `pred` and is closest to `from`. Assumes that at least `to` satisfies `pred`.\nfunction findFirst(pred, from, to) {\n  for (;;) {\n    if (Math.abs(from - to) <= 1) { return pred(from) ? from : to }\n    var mid = Math.floor((from + to) / 2);\n    if (pred(mid)) { to = mid; }\n    else { from = mid; }\n  }\n}\n\n// The display handles the DOM integration, both for input reading\n// and content drawing. It holds references to DOM nodes and\n// display-related state.\n\nfunction Display(place, doc, input) {\n  var d = this;\n  this.input = input;\n\n  // Covers bottom-right square when both scrollbars are present.\n  d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n  d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\");\n  // Covers bottom of gutter when coverGutterNextToScrollbar is on\n  // and h scrollbar is present.\n  d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n  d.gutterFiller.setAttribute(\"cm-not-content\", \"true\");\n  // Will contain the actual code, positioned to cover the viewport.\n  d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\");\n  // Elements are added to these to represent selection and cursors.\n  d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n  d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n  // A visibility: hidden element used to find the size of things.\n  d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n  // When lines outside of the viewport are measured, they are drawn in this.\n  d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n  // Wraps everything that needs to exist inside the vertically-padded coordinate system\n  d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                    null, \"position: relative; outline: none\");\n  var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\");\n  // Moved around its parent to cover visible view.\n  d.mover = elt(\"div\", [lines], null, \"position: relative\");\n  // Set to the height of the document, allowing scrolling.\n  d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n  d.sizerWidth = null;\n  // Behavior of elts with overflow: auto and padding is\n  // inconsistent across browsers. This is used to ensure the\n  // scrollable area is big enough.\n  d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\");\n  // Will contain the gutters, if any.\n  d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n  d.lineGutter = null;\n  // Actual scrollable element.\n  d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n  d.scroller.setAttribute(\"tabIndex\", \"-1\");\n  // The element in which the editor lives.\n  d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n\n  // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n  if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n  if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true; }\n\n  if (place) {\n    if (place.appendChild) { place.appendChild(d.wrapper); }\n    else { place(d.wrapper); }\n  }\n\n  // Current rendered range (may be bigger than the view window).\n  d.viewFrom = d.viewTo = doc.first;\n  d.reportedViewFrom = d.reportedViewTo = doc.first;\n  // Information about the rendered lines.\n  d.view = [];\n  d.renderedView = null;\n  // Holds info about a single rendered line when it was rendered\n  // for measurement, while not in view.\n  d.externalMeasured = null;\n  // Empty space (in pixels) above the view\n  d.viewOffset = 0;\n  d.lastWrapHeight = d.lastWrapWidth = 0;\n  d.updateLineNumbers = null;\n\n  d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n  d.scrollbarsClipped = false;\n\n  // Used to only resize the line number gutter when necessary (when\n  // the amount of lines crosses a boundary that makes its width change)\n  d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n  // Set to true when a non-horizontal-scrolling line widget is\n  // added. As an optimization, line widget aligning is skipped when\n  // this is false.\n  d.alignWidgets = false;\n\n  d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n  // Tracks the maximum line length so that the horizontal scrollbar\n  // can be kept static when scrolling.\n  d.maxLine = null;\n  d.maxLineLength = 0;\n  d.maxLineChanged = false;\n\n  // Used for measuring wheel scrolling granularity\n  d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n  // True when shift is held down.\n  d.shift = false;\n\n  // Used to track whether anything happened since the context menu\n  // was opened.\n  d.selForContextMenu = null;\n\n  d.activeTouch = null;\n\n  input.init(d);\n}\n\n// Find the line object corresponding to the given line number.\nfunction getLine(doc, n) {\n  n -= doc.first;\n  if (n < 0 || n >= doc.size) { throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\") }\n  var chunk = doc;\n  while (!chunk.lines) {\n    for (var i = 0;; ++i) {\n      var child = chunk.children[i], sz = child.chunkSize();\n      if (n < sz) { chunk = child; break }\n      n -= sz;\n    }\n  }\n  return chunk.lines[n]\n}\n\n// Get the part of a document between two positions, as an array of\n// strings.\nfunction getBetween(doc, start, end) {\n  var out = [], n = start.line;\n  doc.iter(start.line, end.line + 1, function (line) {\n    var text = line.text;\n    if (n == end.line) { text = text.slice(0, end.ch); }\n    if (n == start.line) { text = text.slice(start.ch); }\n    out.push(text);\n    ++n;\n  });\n  return out\n}\n// Get the lines between from and to, as array of strings.\nfunction getLines(doc, from, to) {\n  var out = [];\n  doc.iter(from, to, function (line) { out.push(line.text); }); // iter aborts when callback returns truthy value\n  return out\n}\n\n// Update the height of a line, propagating the height change\n// upwards to parent nodes.\nfunction updateLineHeight(line, height) {\n  var diff = height - line.height;\n  if (diff) { for (var n = line; n; n = n.parent) { n.height += diff; } }\n}\n\n// Given a line object, find its line number by walking up through\n// its parent links.\nfunction lineNo(line) {\n  if (line.parent == null) { return null }\n  var cur = line.parent, no = indexOf(cur.lines, line);\n  for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n    for (var i = 0;; ++i) {\n      if (chunk.children[i] == cur) { break }\n      no += chunk.children[i].chunkSize();\n    }\n  }\n  return no + cur.first\n}\n\n// Find the line at the given vertical position, using the height\n// information in the document tree.\nfunction lineAtHeight(chunk, h) {\n  var n = chunk.first;\n  outer: do {\n    for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n      var child = chunk.children[i$1], ch = child.height;\n      if (h < ch) { chunk = child; continue outer }\n      h -= ch;\n      n += child.chunkSize();\n    }\n    return n\n  } while (!chunk.lines)\n  var i = 0;\n  for (; i < chunk.lines.length; ++i) {\n    var line = chunk.lines[i], lh = line.height;\n    if (h < lh) { break }\n    h -= lh;\n  }\n  return n + i\n}\n\nfunction isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\n\nfunction lineNumberFor(options, i) {\n  return String(options.lineNumberFormatter(i + options.firstLineNumber))\n}\n\n// A Pos instance represents a position within the text.\nfunction Pos(line, ch, sticky) {\n  if ( sticky === void 0 ) sticky = null;\n\n  if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\n  this.line = line;\n  this.ch = ch;\n  this.sticky = sticky;\n}\n\n// Compare two positions, return 0 if they are the same, a negative\n// number when a is less, and a positive number otherwise.\nfunction cmp(a, b) { return a.line - b.line || a.ch - b.ch }\n\nfunction equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\n\nfunction copyPos(x) {return Pos(x.line, x.ch)}\nfunction maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\nfunction minPos(a, b) { return cmp(a, b) < 0 ? a : b }\n\n// Most of the external API clips given positions to make sure they\n// actually exist within the document.\nfunction clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\nfunction clipPos(doc, pos) {\n  if (pos.line < doc.first) { return Pos(doc.first, 0) }\n  var last = doc.first + doc.size - 1;\n  if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\n  return clipToLen(pos, getLine(doc, pos.line).text.length)\n}\nfunction clipToLen(pos, linelen) {\n  var ch = pos.ch;\n  if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\n  else if (ch < 0) { return Pos(pos.line, 0) }\n  else { return pos }\n}\nfunction clipPosArray(doc, array) {\n  var out = [];\n  for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]); }\n  return out\n}\n\n// Optimize some code when these features are not used.\nvar sawReadOnlySpans = false;\nvar sawCollapsedSpans = false;\n\nfunction seeReadOnlySpans() {\n  sawReadOnlySpans = true;\n}\n\nfunction seeCollapsedSpans() {\n  sawCollapsedSpans = true;\n}\n\n// TEXTMARKER SPANS\n\nfunction MarkedSpan(marker, from, to) {\n  this.marker = marker;\n  this.from = from; this.to = to;\n}\n\n// Search an array of spans for a span matching the given marker.\nfunction getMarkedSpanFor(spans, marker) {\n  if (spans) { for (var i = 0; i < spans.length; ++i) {\n    var span = spans[i];\n    if (span.marker == marker) { return span }\n  } }\n}\n// Remove a span from an array, returning undefined if no spans are\n// left (we don't store arrays for lines without spans).\nfunction removeMarkedSpan(spans, span) {\n  var r;\n  for (var i = 0; i < spans.length; ++i)\n    { if (spans[i] != span) { (r || (r = [])).push(spans[i]); } }\n  return r\n}\n// Add a span to a line.\nfunction addMarkedSpan(line, span) {\n  line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n  span.marker.attachLine(line);\n}\n\n// Used for the algorithm that adjusts markers for a change in the\n// document. These functions cut an array of spans at a given\n// character position, returning an array of remaining chunks (or\n// undefined if nothing remains).\nfunction markedSpansBefore(old, startCh, isInsert) {\n  var nw;\n  if (old) { for (var i = 0; i < old.length; ++i) {\n    var span = old[i], marker = span.marker;\n    var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n    if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh);(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n    }\n  } }\n  return nw\n}\nfunction markedSpansAfter(old, endCh, isInsert) {\n  var nw;\n  if (old) { for (var i = 0; i < old.length; ++i) {\n    var span = old[i], marker = span.marker;\n    var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n    if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh);(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                            span.to == null ? null : span.to - endCh));\n    }\n  } }\n  return nw\n}\n\n// Given a change object, compute the new set of marker spans that\n// cover the line in which the change took place. Removes spans\n// entirely within the change, reconnects spans belonging to the\n// same marker that appear on both sides of the change, and cuts off\n// spans partially within the change. Returns an array of span\n// arrays with one element for each line in (after) the change.\nfunction stretchSpansOverChange(doc, change) {\n  if (change.full) { return null }\n  var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n  var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n  if (!oldFirst && !oldLast) { return null }\n\n  var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n  // Get the spans that 'stick out' on both sides\n  var first = markedSpansBefore(oldFirst, startCh, isInsert);\n  var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n  // Next, merge those two ends\n  var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n  if (first) {\n    // Fix up .to properties of first\n    for (var i = 0; i < first.length; ++i) {\n      var span = first[i];\n      if (span.to == null) {\n        var found = getMarkedSpanFor(last, span.marker);\n        if (!found) { span.to = startCh; }\n        else if (sameLine) { span.to = found.to == null ? null : found.to + offset; }\n      }\n    }\n  }\n  if (last) {\n    // Fix up .from in last (or move them into first in case of sameLine)\n    for (var i$1 = 0; i$1 < last.length; ++i$1) {\n      var span$1 = last[i$1];\n      if (span$1.to != null) { span$1.to += offset; }\n      if (span$1.from == null) {\n        var found$1 = getMarkedSpanFor(first, span$1.marker);\n        if (!found$1) {\n          span$1.from = offset;\n          if (sameLine) { (first || (first = [])).push(span$1); }\n        }\n      } else {\n        span$1.from += offset;\n        if (sameLine) { (first || (first = [])).push(span$1); }\n      }\n    }\n  }\n  // Make sure we didn't create any zero-length spans\n  if (first) { first = clearEmptySpans(first); }\n  if (last && last != first) { last = clearEmptySpans(last); }\n\n  var newMarkers = [first];\n  if (!sameLine) {\n    // Fill gap with whole-line-spans\n    var gap = change.text.length - 2, gapMarkers;\n    if (gap > 0 && first)\n      { for (var i$2 = 0; i$2 < first.length; ++i$2)\n        { if (first[i$2].to == null)\n          { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)); } } }\n    for (var i$3 = 0; i$3 < gap; ++i$3)\n      { newMarkers.push(gapMarkers); }\n    newMarkers.push(last);\n  }\n  return newMarkers\n}\n\n// Remove spans that are empty and don't have a clearWhenEmpty\n// option of false.\nfunction clearEmptySpans(spans) {\n  for (var i = 0; i < spans.length; ++i) {\n    var span = spans[i];\n    if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n      { spans.splice(i--, 1); }\n  }\n  if (!spans.length) { return null }\n  return spans\n}\n\n// Used to 'clip' out readOnly ranges when making a change.\nfunction removeReadOnlyRanges(doc, from, to) {\n  var markers = null;\n  doc.iter(from.line, to.line + 1, function (line) {\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n      var mark = line.markedSpans[i].marker;\n      if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n        { (markers || (markers = [])).push(mark); }\n    } }\n  });\n  if (!markers) { return null }\n  var parts = [{from: from, to: to}];\n  for (var i = 0; i < markers.length; ++i) {\n    var mk = markers[i], m = mk.find(0);\n    for (var j = 0; j < parts.length; ++j) {\n      var p = parts[j];\n      if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\n      var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n      if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n        { newParts.push({from: p.from, to: m.from}); }\n      if (dto > 0 || !mk.inclusiveRight && !dto)\n        { newParts.push({from: m.to, to: p.to}); }\n      parts.splice.apply(parts, newParts);\n      j += newParts.length - 3;\n    }\n  }\n  return parts\n}\n\n// Connect or disconnect spans from a line.\nfunction detachMarkedSpans(line) {\n  var spans = line.markedSpans;\n  if (!spans) { return }\n  for (var i = 0; i < spans.length; ++i)\n    { spans[i].marker.detachLine(line); }\n  line.markedSpans = null;\n}\nfunction attachMarkedSpans(line, spans) {\n  if (!spans) { return }\n  for (var i = 0; i < spans.length; ++i)\n    { spans[i].marker.attachLine(line); }\n  line.markedSpans = spans;\n}\n\n// Helpers used when computing which overlapping collapsed span\n// counts as the larger one.\nfunction extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\nfunction extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\n\n// Returns a number indicating which of two overlapping collapsed\n// spans is larger (and thus includes the other). Falls back to\n// comparing ids when the spans cover exactly the same range.\nfunction compareCollapsedMarkers(a, b) {\n  var lenDiff = a.lines.length - b.lines.length;\n  if (lenDiff != 0) { return lenDiff }\n  var aPos = a.find(), bPos = b.find();\n  var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n  if (fromCmp) { return -fromCmp }\n  var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n  if (toCmp) { return toCmp }\n  return b.id - a.id\n}\n\n// Find out whether a line ends or starts in a collapsed span. If\n// so, return the marker for that span.\nfunction collapsedSpanAtSide(line, start) {\n  var sps = sawCollapsedSpans && line.markedSpans, found;\n  if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n    sp = sps[i];\n    if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n        (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n      { found = sp.marker; }\n  } }\n  return found\n}\nfunction collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\nfunction collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\n\n// Test whether there exists a collapsed span that partially\n// overlaps (covers the start or end, but not both) of a new span.\n// Such overlap is not allowed.\nfunction conflictingCollapsedRange(doc, lineNo$$1, from, to, marker) {\n  var line = getLine(doc, lineNo$$1);\n  var sps = sawCollapsedSpans && line.markedSpans;\n  if (sps) { for (var i = 0; i < sps.length; ++i) {\n    var sp = sps[i];\n    if (!sp.marker.collapsed) { continue }\n    var found = sp.marker.find(0);\n    var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n    var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n    if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\n    if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\n        fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\n      { return true }\n  } }\n}\n\n// A visual line is a line as drawn on the screen. Folding, for\n// example, can cause multiple logical lines to appear on the same\n// visual line. This finds the start of the visual line that the\n// given line is part of (usually that is the line itself).\nfunction visualLine(line) {\n  var merged;\n  while (merged = collapsedSpanAtStart(line))\n    { line = merged.find(-1, true).line; }\n  return line\n}\n\nfunction visualLineEnd(line) {\n  var merged;\n  while (merged = collapsedSpanAtEnd(line))\n    { line = merged.find(1, true).line; }\n  return line\n}\n\n// Returns an array of logical lines that continue the visual line\n// started by the argument, or undefined if there are no such lines.\nfunction visualLineContinued(line) {\n  var merged, lines;\n  while (merged = collapsedSpanAtEnd(line)) {\n    line = merged.find(1, true).line\n    ;(lines || (lines = [])).push(line);\n  }\n  return lines\n}\n\n// Get the line number of the start of the visual line that the\n// given line number is part of.\nfunction visualLineNo(doc, lineN) {\n  var line = getLine(doc, lineN), vis = visualLine(line);\n  if (line == vis) { return lineN }\n  return lineNo(vis)\n}\n\n// Get the line number of the start of the next visual line after\n// the given line.\nfunction visualLineEndNo(doc, lineN) {\n  if (lineN > doc.lastLine()) { return lineN }\n  var line = getLine(doc, lineN), merged;\n  if (!lineIsHidden(doc, line)) { return lineN }\n  while (merged = collapsedSpanAtEnd(line))\n    { line = merged.find(1, true).line; }\n  return lineNo(line) + 1\n}\n\n// Compute whether a line is hidden. Lines count as hidden when they\n// are part of a visual line that starts with another line, or when\n// they are entirely covered by collapsed, non-widget span.\nfunction lineIsHidden(doc, line) {\n  var sps = sawCollapsedSpans && line.markedSpans;\n  if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n    sp = sps[i];\n    if (!sp.marker.collapsed) { continue }\n    if (sp.from == null) { return true }\n    if (sp.marker.widgetNode) { continue }\n    if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n      { return true }\n  } }\n}\nfunction lineIsHiddenInner(doc, line, span) {\n  if (span.to == null) {\n    var end = span.marker.find(1, true);\n    return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\n  }\n  if (span.marker.inclusiveRight && span.to == line.text.length)\n    { return true }\n  for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\n    sp = line.markedSpans[i];\n    if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n        (sp.to == null || sp.to != span.from) &&\n        (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n        lineIsHiddenInner(doc, line, sp)) { return true }\n  }\n}\n\n// Find the height above the given line.\nfunction heightAtLine(lineObj) {\n  lineObj = visualLine(lineObj);\n\n  var h = 0, chunk = lineObj.parent;\n  for (var i = 0; i < chunk.lines.length; ++i) {\n    var line = chunk.lines[i];\n    if (line == lineObj) { break }\n    else { h += line.height; }\n  }\n  for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n    for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n      var cur = p.children[i$1];\n      if (cur == chunk) { break }\n      else { h += cur.height; }\n    }\n  }\n  return h\n}\n\n// Compute the character length of a line, taking into account\n// collapsed ranges (see markText) that might hide parts, and join\n// other lines onto it.\nfunction lineLength(line) {\n  if (line.height == 0) { return 0 }\n  var len = line.text.length, merged, cur = line;\n  while (merged = collapsedSpanAtStart(cur)) {\n    var found = merged.find(0, true);\n    cur = found.from.line;\n    len += found.from.ch - found.to.ch;\n  }\n  cur = line;\n  while (merged = collapsedSpanAtEnd(cur)) {\n    var found$1 = merged.find(0, true);\n    len -= cur.text.length - found$1.from.ch;\n    cur = found$1.to.line;\n    len += cur.text.length - found$1.to.ch;\n  }\n  return len\n}\n\n// Find the longest line in the document.\nfunction findMaxLine(cm) {\n  var d = cm.display, doc = cm.doc;\n  d.maxLine = getLine(doc, doc.first);\n  d.maxLineLength = lineLength(d.maxLine);\n  d.maxLineChanged = true;\n  doc.iter(function (line) {\n    var len = lineLength(line);\n    if (len > d.maxLineLength) {\n      d.maxLineLength = len;\n      d.maxLine = line;\n    }\n  });\n}\n\n// BIDI HELPERS\n\nfunction iterateBidiSections(order, from, to, f) {\n  if (!order) { return f(from, to, \"ltr\") }\n  var found = false;\n  for (var i = 0; i < order.length; ++i) {\n    var part = order[i];\n    if (part.from < to && part.to > from || from == to && part.to == from) {\n      f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\");\n      found = true;\n    }\n  }\n  if (!found) { f(from, to, \"ltr\"); }\n}\n\nvar bidiOther = null;\nfunction getBidiPartAt(order, ch, sticky) {\n  var found;\n  bidiOther = null;\n  for (var i = 0; i < order.length; ++i) {\n    var cur = order[i];\n    if (cur.from < ch && cur.to > ch) { return i }\n    if (cur.to == ch) {\n      if (cur.from != cur.to && sticky == \"before\") { found = i; }\n      else { bidiOther = i; }\n    }\n    if (cur.from == ch) {\n      if (cur.from != cur.to && sticky != \"before\") { found = i; }\n      else { bidiOther = i; }\n    }\n  }\n  return found != null ? found : bidiOther\n}\n\n// Bidirectional ordering algorithm\n// See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n// that this (partially) implements.\n\n// One-char codes used for character types:\n// L (L):   Left-to-Right\n// R (R):   Right-to-Left\n// r (AL):  Right-to-Left Arabic\n// 1 (EN):  European Number\n// + (ES):  European Number Separator\n// % (ET):  European Number Terminator\n// n (AN):  Arabic Number\n// , (CS):  Common Number Separator\n// m (NSM): Non-Spacing Mark\n// b (BN):  Boundary Neutral\n// s (B):   Paragraph Separator\n// t (S):   Segment Separator\n// w (WS):  Whitespace\n// N (ON):  Other Neutrals\n\n// Returns null if characters are ordered as they appear\n// (left-to-right), or an array of sections ({from, to, level}\n// objects) in the order in which they occur visually.\nvar bidiOrdering = (function() {\n  // Character types for codepoints 0 to 0xff\n  var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n  // Character types for codepoints 0x600 to 0x6f9\n  var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n  function charType(code) {\n    if (code <= 0xf7) { return lowTypes.charAt(code) }\n    else if (0x590 <= code && code <= 0x5f4) { return \"R\" }\n    else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\n    else if (0x6ee <= code && code <= 0x8ac) { return \"r\" }\n    else if (0x2000 <= code && code <= 0x200b) { return \"w\" }\n    else if (code == 0x200c) { return \"b\" }\n    else { return \"L\" }\n  }\n\n  var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n  var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n\n  function BidiSpan(level, from, to) {\n    this.level = level;\n    this.from = from; this.to = to;\n  }\n\n  return function(str, direction) {\n    var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n    if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) { return false }\n    var len = str.length, types = [];\n    for (var i = 0; i < len; ++i)\n      { types.push(charType(str.charCodeAt(i))); }\n\n    // W1. Examine each non-spacing mark (NSM) in the level run, and\n    // change the type of the NSM to the type of the previous\n    // character. If the NSM is at the start of the level run, it will\n    // get the type of sor.\n    for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n      var type = types[i$1];\n      if (type == \"m\") { types[i$1] = prev; }\n      else { prev = type; }\n    }\n\n    // W2. Search backwards from each instance of a European number\n    // until the first strong type (R, L, AL, or sor) is found. If an\n    // AL is found, change the type of the European number to Arabic\n    // number.\n    // W3. Change all ALs to R.\n    for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n      var type$1 = types[i$2];\n      if (type$1 == \"1\" && cur == \"r\") { types[i$2] = \"n\"; }\n      else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == \"r\") { types[i$2] = \"R\"; } }\n    }\n\n    // W4. A single European separator between two European numbers\n    // changes to a European number. A single common separator between\n    // two numbers of the same type changes to that type.\n    for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n      var type$2 = types[i$3];\n      if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3+1] == \"1\") { types[i$3] = \"1\"; }\n      else if (type$2 == \",\" && prev$1 == types[i$3+1] &&\n               (prev$1 == \"1\" || prev$1 == \"n\")) { types[i$3] = prev$1; }\n      prev$1 = type$2;\n    }\n\n    // W5. A sequence of European terminators adjacent to European\n    // numbers changes to all European numbers.\n    // W6. Otherwise, separators and terminators change to Other\n    // Neutral.\n    for (var i$4 = 0; i$4 < len; ++i$4) {\n      var type$3 = types[i$4];\n      if (type$3 == \",\") { types[i$4] = \"N\"; }\n      else if (type$3 == \"%\") {\n        var end = (void 0);\n        for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n        var replace = (i$4 && types[i$4-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n        for (var j = i$4; j < end; ++j) { types[j] = replace; }\n        i$4 = end - 1;\n      }\n    }\n\n    // W7. Search backwards from each instance of a European number\n    // until the first strong type (R, L, or sor) is found. If an L is\n    // found, then change the type of the European number to L.\n    for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n      var type$4 = types[i$5];\n      if (cur$1 == \"L\" && type$4 == \"1\") { types[i$5] = \"L\"; }\n      else if (isStrong.test(type$4)) { cur$1 = type$4; }\n    }\n\n    // N1. A sequence of neutrals takes the direction of the\n    // surrounding strong text if the text on both sides has the same\n    // direction. European and Arabic numbers act as if they were R in\n    // terms of their influence on neutrals. Start-of-level-run (sor)\n    // and end-of-level-run (eor) are used at level run boundaries.\n    // N2. Any remaining neutrals take the embedding direction.\n    for (var i$6 = 0; i$6 < len; ++i$6) {\n      if (isNeutral.test(types[i$6])) {\n        var end$1 = (void 0);\n        for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n        var before = (i$6 ? types[i$6-1] : outerType) == \"L\";\n        var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n        var replace$1 = before == after ? (before ? \"L\" : \"R\") : outerType;\n        for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1; }\n        i$6 = end$1 - 1;\n      }\n    }\n\n    // Here we depart from the documented algorithm, in order to avoid\n    // building up an actual levels array. Since there are only three\n    // levels (0, 1, 2) in an implementation that doesn't take\n    // explicit embedding into account, we can build up the order on\n    // the fly, without following the level-based algorithm.\n    var order = [], m;\n    for (var i$7 = 0; i$7 < len;) {\n      if (countsAsLeft.test(types[i$7])) {\n        var start = i$7;\n        for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n        order.push(new BidiSpan(0, start, i$7));\n      } else {\n        var pos = i$7, at = order.length;\n        for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n        for (var j$2 = pos; j$2 < i$7;) {\n          if (countsAsNum.test(types[j$2])) {\n            if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)); }\n            var nstart = j$2;\n            for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n            order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n            pos = j$2;\n          } else { ++j$2; }\n        }\n        if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)); }\n      }\n    }\n    if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n      order[0].from = m[0].length;\n      order.unshift(new BidiSpan(0, 0, m[0].length));\n    }\n    if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n      lst(order).to -= m[0].length;\n      order.push(new BidiSpan(0, len - m[0].length, len));\n    }\n\n    return direction == \"rtl\" ? order.reverse() : order\n  }\n})();\n\n// Get the bidi ordering for the given line (and cache it). Returns\n// false for lines that are fully left-to-right, and an array of\n// BidiSpan objects otherwise.\nfunction getOrder(line, direction) {\n  var order = line.order;\n  if (order == null) { order = line.order = bidiOrdering(line.text, direction); }\n  return order\n}\n\nfunction moveCharLogically(line, ch, dir) {\n  var target = skipExtendingChars(line.text, ch + dir, dir);\n  return target < 0 || target > line.text.length ? null : target\n}\n\nfunction moveLogically(line, start, dir) {\n  var ch = moveCharLogically(line, start.ch, dir);\n  return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\")\n}\n\nfunction endOfLine(visually, cm, lineObj, lineNo, dir) {\n  if (visually) {\n    var order = getOrder(lineObj, cm.doc.direction);\n    if (order) {\n      var part = dir < 0 ? lst(order) : order[0];\n      var moveInStorageOrder = (dir < 0) == (part.level == 1);\n      var sticky = moveInStorageOrder ? \"after\" : \"before\";\n      var ch;\n      // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n      // it could be that the last bidi part is not on the last visual line,\n      // since visual lines contain content order-consecutive chunks.\n      // Thus, in rtl, we are looking for the first (content-order) character\n      // in the rtl chunk that is on the last line (that is, the same line\n      // as the last (content-order) character).\n      if (part.level > 0) {\n        var prep = prepareMeasureForLine(cm, lineObj);\n        ch = dir < 0 ? lineObj.text.length - 1 : 0;\n        var targetTop = measureCharPrepared(cm, prep, ch).top;\n        ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch);\n        if (sticky == \"before\") { ch = moveCharLogically(lineObj, ch, 1); }\n      } else { ch = dir < 0 ? part.to : part.from; }\n      return new Pos(lineNo, ch, sticky)\n    }\n  }\n  return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\")\n}\n\nfunction moveVisually(cm, line, start, dir) {\n  var bidi = getOrder(line, cm.doc.direction);\n  if (!bidi) { return moveLogically(line, start, dir) }\n  if (start.ch >= line.text.length) {\n    start.ch = line.text.length;\n    start.sticky = \"before\";\n  } else if (start.ch <= 0) {\n    start.ch = 0;\n    start.sticky = \"after\";\n  }\n  var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos];\n  if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n    // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n    // nothing interesting happens.\n    return moveLogically(line, start, dir)\n  }\n\n  var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); };\n  var prep;\n  var getWrappedLineExtent = function (ch) {\n    if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\n    prep = prep || prepareMeasureForLine(cm, line);\n    return wrappedLineExtentChar(cm, line, prep, ch)\n  };\n  var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n  if (cm.doc.direction == \"rtl\" || part.level == 1) {\n    var moveInStorageOrder = (part.level == 1) == (dir < 0);\n    var ch = mv(start, moveInStorageOrder ? 1 : -1);\n    if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n      // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n      var sticky = moveInStorageOrder ? \"before\" : \"after\";\n      return new Pos(start.line, ch, sticky)\n    }\n  }\n\n  // Case 3: Could not move within this bidi part in this visual line, so leave\n  // the current bidi part\n\n  var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\n    var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\n      ? new Pos(start.line, mv(ch, 1), \"before\")\n      : new Pos(start.line, ch, \"after\"); };\n\n    for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n      var part = bidi[partPos];\n      var moveInStorageOrder = (dir > 0) == (part.level != 1);\n      var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n      if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\n      ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n      if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\n    }\n  };\n\n  // Case 3a: Look for other bidi parts on the same visual line\n  var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n  if (res) { return res }\n\n  // Case 3b: Look for other bidi parts on the next visual line\n  var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n  if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n    res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n    if (res) { return res }\n  }\n\n  // Case 4: Nowhere to move\n  return null\n}\n\n// EVENT HANDLING\n\n// Lightweight event framework. on/off also work on DOM nodes,\n// registering native DOM handlers.\n\nvar noHandlers = [];\n\nvar on = function(emitter, type, f) {\n  if (emitter.addEventListener) {\n    emitter.addEventListener(type, f, false);\n  } else if (emitter.attachEvent) {\n    emitter.attachEvent(\"on\" + type, f);\n  } else {\n    var map$$1 = emitter._handlers || (emitter._handlers = {});\n    map$$1[type] = (map$$1[type] || noHandlers).concat(f);\n  }\n};\n\nfunction getHandlers(emitter, type) {\n  return emitter._handlers && emitter._handlers[type] || noHandlers\n}\n\nfunction off(emitter, type, f) {\n  if (emitter.removeEventListener) {\n    emitter.removeEventListener(type, f, false);\n  } else if (emitter.detachEvent) {\n    emitter.detachEvent(\"on\" + type, f);\n  } else {\n    var map$$1 = emitter._handlers, arr = map$$1 && map$$1[type];\n    if (arr) {\n      var index = indexOf(arr, f);\n      if (index > -1)\n        { map$$1[type] = arr.slice(0, index).concat(arr.slice(index + 1)); }\n    }\n  }\n}\n\nfunction signal(emitter, type /*, values...*/) {\n  var handlers = getHandlers(emitter, type);\n  if (!handlers.length) { return }\n  var args = Array.prototype.slice.call(arguments, 2);\n  for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args); }\n}\n\n// The DOM events that CodeMirror handles can be overridden by\n// registering a (non-DOM) handler on the editor for the event name,\n// and preventDefault-ing the event in that handler.\nfunction signalDOMEvent(cm, e, override) {\n  if (typeof e == \"string\")\n    { e = {type: e, preventDefault: function() { this.defaultPrevented = true; }}; }\n  signal(cm, override || e.type, cm, e);\n  return e_defaultPrevented(e) || e.codemirrorIgnore\n}\n\nfunction signalCursorActivity(cm) {\n  var arr = cm._handlers && cm._handlers.cursorActivity;\n  if (!arr) { return }\n  var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n  for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\n    { set.push(arr[i]); } }\n}\n\nfunction hasHandler(emitter, type) {\n  return getHandlers(emitter, type).length > 0\n}\n\n// Add on and off methods to a constructor's prototype, to make\n// registering events on such objects more convenient.\nfunction eventMixin(ctor) {\n  ctor.prototype.on = function(type, f) {on(this, type, f);};\n  ctor.prototype.off = function(type, f) {off(this, type, f);};\n}\n\n// Due to the fact that we still support jurassic IE versions, some\n// compatibility wrappers are needed.\n\nfunction e_preventDefault(e) {\n  if (e.preventDefault) { e.preventDefault(); }\n  else { e.returnValue = false; }\n}\nfunction e_stopPropagation(e) {\n  if (e.stopPropagation) { e.stopPropagation(); }\n  else { e.cancelBubble = true; }\n}\nfunction e_defaultPrevented(e) {\n  return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\n}\nfunction e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\n\nfunction e_target(e) {return e.target || e.srcElement}\nfunction e_button(e) {\n  var b = e.which;\n  if (b == null) {\n    if (e.button & 1) { b = 1; }\n    else if (e.button & 2) { b = 3; }\n    else if (e.button & 4) { b = 2; }\n  }\n  if (mac && e.ctrlKey && b == 1) { b = 3; }\n  return b\n}\n\n// Detect drag-and-drop\nvar dragAndDrop = function() {\n  // There is *some* kind of drag-and-drop support in IE6-8, but I\n  // couldn't get it to work yet.\n  if (ie && ie_version < 9) { return false }\n  var div = elt('div');\n  return \"draggable\" in div || \"dragDrop\" in div\n}();\n\nvar zwspSupported;\nfunction zeroWidthElement(measure) {\n  if (zwspSupported == null) {\n    var test = elt(\"span\", \"\\u200b\");\n    removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n    if (measure.firstChild.offsetHeight != 0)\n      { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8); }\n  }\n  var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\n    elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n  node.setAttribute(\"cm-text\", \"\");\n  return node\n}\n\n// Feature-detect IE's crummy client rect reporting for bidi text\nvar badBidiRects;\nfunction hasBadBidiRects(measure) {\n  if (badBidiRects != null) { return badBidiRects }\n  var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n  var r0 = range(txt, 0, 1).getBoundingClientRect();\n  var r1 = range(txt, 1, 2).getBoundingClientRect();\n  removeChildren(measure);\n  if (!r0 || r0.left == r0.right) { return false } // Safari returns null in some cases (#2780)\n  return badBidiRects = (r1.right - r0.right < 3)\n}\n\n// See if \"\".split is the broken IE version, if so, provide an\n// alternative way to split lines.\nvar splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n  var pos = 0, result = [], l = string.length;\n  while (pos <= l) {\n    var nl = string.indexOf(\"\\n\", pos);\n    if (nl == -1) { nl = string.length; }\n    var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n    var rt = line.indexOf(\"\\r\");\n    if (rt != -1) {\n      result.push(line.slice(0, rt));\n      pos += rt + 1;\n    } else {\n      result.push(line);\n      pos = nl + 1;\n    }\n  }\n  return result\n} : function (string) { return string.split(/\\r\\n?|\\n/); };\n\nvar hasSelection = window.getSelection ? function (te) {\n  try { return te.selectionStart != te.selectionEnd }\n  catch(e) { return false }\n} : function (te) {\n  var range$$1;\n  try {range$$1 = te.ownerDocument.selection.createRange();}\n  catch(e) {}\n  if (!range$$1 || range$$1.parentElement() != te) { return false }\n  return range$$1.compareEndPoints(\"StartToEnd\", range$$1) != 0\n};\n\nvar hasCopyEvent = (function () {\n  var e = elt(\"div\");\n  if (\"oncopy\" in e) { return true }\n  e.setAttribute(\"oncopy\", \"return;\");\n  return typeof e.oncopy == \"function\"\n})();\n\nvar badZoomedRects = null;\nfunction hasBadZoomedRects(measure) {\n  if (badZoomedRects != null) { return badZoomedRects }\n  var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n  var normal = node.getBoundingClientRect();\n  var fromRange = range(node, 0, 1).getBoundingClientRect();\n  return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\n}\n\n// Known modes, by name and by MIME\nvar modes = {};\nvar mimeModes = {};\n\n// Extra arguments are stored as the mode's dependencies, which is\n// used by (legacy) mechanisms like loadmode.js to automatically\n// load a mode. (Preferred mechanism is the require/define calls.)\nfunction defineMode(name, mode) {\n  if (arguments.length > 2)\n    { mode.dependencies = Array.prototype.slice.call(arguments, 2); }\n  modes[name] = mode;\n}\n\nfunction defineMIME(mime, spec) {\n  mimeModes[mime] = spec;\n}\n\n// Given a MIME type, a {name, ...options} config object, or a name\n// string, return a mode config object.\nfunction resolveMode(spec) {\n  if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n    spec = mimeModes[spec];\n  } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n    var found = mimeModes[spec.name];\n    if (typeof found == \"string\") { found = {name: found}; }\n    spec = createObj(found, spec);\n    spec.name = found.name;\n  } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n    return resolveMode(\"application/xml\")\n  } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n    return resolveMode(\"application/json\")\n  }\n  if (typeof spec == \"string\") { return {name: spec} }\n  else { return spec || {name: \"null\"} }\n}\n\n// Given a mode spec (anything that resolveMode accepts), find and\n// initialize an actual mode object.\nfunction getMode(options, spec) {\n  spec = resolveMode(spec);\n  var mfactory = modes[spec.name];\n  if (!mfactory) { return getMode(options, \"text/plain\") }\n  var modeObj = mfactory(options, spec);\n  if (modeExtensions.hasOwnProperty(spec.name)) {\n    var exts = modeExtensions[spec.name];\n    for (var prop in exts) {\n      if (!exts.hasOwnProperty(prop)) { continue }\n      if (modeObj.hasOwnProperty(prop)) { modeObj[\"_\" + prop] = modeObj[prop]; }\n      modeObj[prop] = exts[prop];\n    }\n  }\n  modeObj.name = spec.name;\n  if (spec.helperType) { modeObj.helperType = spec.helperType; }\n  if (spec.modeProps) { for (var prop$1 in spec.modeProps)\n    { modeObj[prop$1] = spec.modeProps[prop$1]; } }\n\n  return modeObj\n}\n\n// This can be used to attach properties to mode objects from\n// outside the actual mode definition.\nvar modeExtensions = {};\nfunction extendMode(mode, properties) {\n  var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n  copyObj(properties, exts);\n}\n\nfunction copyState(mode, state) {\n  if (state === true) { return state }\n  if (mode.copyState) { return mode.copyState(state) }\n  var nstate = {};\n  for (var n in state) {\n    var val = state[n];\n    if (val instanceof Array) { val = val.concat([]); }\n    nstate[n] = val;\n  }\n  return nstate\n}\n\n// Given a mode and a state (for that mode), find the inner mode and\n// state at the position that the state refers to.\nfunction innerMode(mode, state) {\n  var info;\n  while (mode.innerMode) {\n    info = mode.innerMode(state);\n    if (!info || info.mode == mode) { break }\n    state = info.state;\n    mode = info.mode;\n  }\n  return info || {mode: mode, state: state}\n}\n\nfunction startState(mode, a1, a2) {\n  return mode.startState ? mode.startState(a1, a2) : true\n}\n\n// STRING STREAM\n\n// Fed to the mode parsers, provides helper functions to make\n// parsers more succinct.\n\nvar StringStream = function(string, tabSize) {\n  this.pos = this.start = 0;\n  this.string = string;\n  this.tabSize = tabSize || 8;\n  this.lastColumnPos = this.lastColumnValue = 0;\n  this.lineStart = 0;\n};\n\nStringStream.prototype.eol = function () {return this.pos >= this.string.length};\nStringStream.prototype.sol = function () {return this.pos == this.lineStart};\nStringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\nStringStream.prototype.next = function () {\n  if (this.pos < this.string.length)\n    { return this.string.charAt(this.pos++) }\n};\nStringStream.prototype.eat = function (match) {\n  var ch = this.string.charAt(this.pos);\n  var ok;\n  if (typeof match == \"string\") { ok = ch == match; }\n  else { ok = ch && (match.test ? match.test(ch) : match(ch)); }\n  if (ok) {++this.pos; return ch}\n};\nStringStream.prototype.eatWhile = function (match) {\n  var start = this.pos;\n  while (this.eat(match)){}\n  return this.pos > start\n};\nStringStream.prototype.eatSpace = function () {\n    var this$1 = this;\n\n  var start = this.pos;\n  while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this$1.pos; }\n  return this.pos > start\n};\nStringStream.prototype.skipToEnd = function () {this.pos = this.string.length;};\nStringStream.prototype.skipTo = function (ch) {\n  var found = this.string.indexOf(ch, this.pos);\n  if (found > -1) {this.pos = found; return true}\n};\nStringStream.prototype.backUp = function (n) {this.pos -= n;};\nStringStream.prototype.column = function () {\n  if (this.lastColumnPos < this.start) {\n    this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n    this.lastColumnPos = this.start;\n  }\n  return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n};\nStringStream.prototype.indentation = function () {\n  return countColumn(this.string, null, this.tabSize) -\n    (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n};\nStringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n  if (typeof pattern == \"string\") {\n    var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; };\n    var substr = this.string.substr(this.pos, pattern.length);\n    if (cased(substr) == cased(pattern)) {\n      if (consume !== false) { this.pos += pattern.length; }\n      return true\n    }\n  } else {\n    var match = this.string.slice(this.pos).match(pattern);\n    if (match && match.index > 0) { return null }\n    if (match && consume !== false) { this.pos += match[0].length; }\n    return match\n  }\n};\nStringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\nStringStream.prototype.hideFirstChars = function (n, inner) {\n  this.lineStart += n;\n  try { return inner() }\n  finally { this.lineStart -= n; }\n};\n\n// Compute a style array (an array starting with a mode generation\n// -- for invalidation -- followed by pairs of end positions and\n// style strings), which is used to highlight the tokens on the\n// line.\nfunction highlightLine(cm, line, state, forceToEnd) {\n  // A styles array always starts with a number identifying the\n  // mode/overlays that it is based on (for easy invalidation).\n  var st = [cm.state.modeGen], lineClasses = {};\n  // Compute the base array of styles\n  runMode(cm, line.text, cm.doc.mode, state, function (end, style) { return st.push(end, style); },\n    lineClasses, forceToEnd);\n\n  // Run overlays, adjust style array.\n  var loop = function ( o ) {\n    var overlay = cm.state.overlays[o], i = 1, at = 0;\n    runMode(cm, line.text, overlay.mode, true, function (end, style) {\n      var start = i;\n      // Ensure there's a token end at the current position, and that i points at it\n      while (at < end) {\n        var i_end = st[i];\n        if (i_end > end)\n          { st.splice(i, 1, end, st[i+1], i_end); }\n        i += 2;\n        at = Math.min(end, i_end);\n      }\n      if (!style) { return }\n      if (overlay.opaque) {\n        st.splice(start, i - start, end, \"overlay \" + style);\n        i = start + 2;\n      } else {\n        for (; start < i; start += 2) {\n          var cur = st[start+1];\n          st[start+1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n        }\n      }\n    }, lineClasses);\n  };\n\n  for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\n\n  return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\n}\n\nfunction getLineStyles(cm, line, updateFrontier) {\n  if (!line.styles || line.styles[0] != cm.state.modeGen) {\n    var state = getStateBefore(cm, lineNo(line));\n    var result = highlightLine(cm, line, line.text.length > cm.options.maxHighlightLength ? copyState(cm.doc.mode, state) : state);\n    line.stateAfter = state;\n    line.styles = result.styles;\n    if (result.classes) { line.styleClasses = result.classes; }\n    else if (line.styleClasses) { line.styleClasses = null; }\n    if (updateFrontier === cm.doc.frontier) { cm.doc.frontier++; }\n  }\n  return line.styles\n}\n\nfunction getStateBefore(cm, n, precise) {\n  var doc = cm.doc, display = cm.display;\n  if (!doc.mode.startState) { return true }\n  var pos = findStartLine(cm, n, precise), state = pos > doc.first && getLine(doc, pos-1).stateAfter;\n  if (!state) { state = startState(doc.mode); }\n  else { state = copyState(doc.mode, state); }\n  doc.iter(pos, n, function (line) {\n    processLine(cm, line.text, state);\n    var save = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo;\n    line.stateAfter = save ? copyState(doc.mode, state) : null;\n    ++pos;\n  });\n  if (precise) { doc.frontier = pos; }\n  return state\n}\n\n// Lightweight form of highlight -- proceed over this line and\n// update state, but don't save a style array. Used for lines that\n// aren't currently visible.\nfunction processLine(cm, text, state, startAt) {\n  var mode = cm.doc.mode;\n  var stream = new StringStream(text, cm.options.tabSize);\n  stream.start = stream.pos = startAt || 0;\n  if (text == \"\") { callBlankLine(mode, state); }\n  while (!stream.eol()) {\n    readToken(mode, stream, state);\n    stream.start = stream.pos;\n  }\n}\n\nfunction callBlankLine(mode, state) {\n  if (mode.blankLine) { return mode.blankLine(state) }\n  if (!mode.innerMode) { return }\n  var inner = innerMode(mode, state);\n  if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\n}\n\nfunction readToken(mode, stream, state, inner) {\n  for (var i = 0; i < 10; i++) {\n    if (inner) { inner[0] = innerMode(mode, state).mode; }\n    var style = mode.token(stream, state);\n    if (stream.pos > stream.start) { return style }\n  }\n  throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\")\n}\n\n// Utility for getTokenAt and getLineTokens\nfunction takeToken(cm, pos, precise, asArray) {\n  var getObj = function (copy) { return ({\n    start: stream.start, end: stream.pos,\n    string: stream.current(),\n    type: style || null,\n    state: copy ? copyState(doc.mode, state) : state\n  }); };\n\n  var doc = cm.doc, mode = doc.mode, style;\n  pos = clipPos(doc, pos);\n  var line = getLine(doc, pos.line), state = getStateBefore(cm, pos.line, precise);\n  var stream = new StringStream(line.text, cm.options.tabSize), tokens;\n  if (asArray) { tokens = []; }\n  while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n    stream.start = stream.pos;\n    style = readToken(mode, stream, state);\n    if (asArray) { tokens.push(getObj(true)); }\n  }\n  return asArray ? tokens : getObj()\n}\n\nfunction extractLineClasses(type, output) {\n  if (type) { for (;;) {\n    var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n    if (!lineClass) { break }\n    type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n    var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n    if (output[prop] == null)\n      { output[prop] = lineClass[2]; }\n    else if (!(new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\")).test(output[prop]))\n      { output[prop] += \" \" + lineClass[2]; }\n  } }\n  return type\n}\n\n// Run the given mode's parser over a line, calling f for each token.\nfunction runMode(cm, text, mode, state, f, lineClasses, forceToEnd) {\n  var flattenSpans = mode.flattenSpans;\n  if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans; }\n  var curStart = 0, curStyle = null;\n  var stream = new StringStream(text, cm.options.tabSize), style;\n  var inner = cm.options.addModeClass && [null];\n  if (text == \"\") { extractLineClasses(callBlankLine(mode, state), lineClasses); }\n  while (!stream.eol()) {\n    if (stream.pos > cm.options.maxHighlightLength) {\n      flattenSpans = false;\n      if (forceToEnd) { processLine(cm, text, state, stream.pos); }\n      stream.pos = text.length;\n      style = null;\n    } else {\n      style = extractLineClasses(readToken(mode, stream, state, inner), lineClasses);\n    }\n    if (inner) {\n      var mName = inner[0].name;\n      if (mName) { style = \"m-\" + (style ? mName + \" \" + style : mName); }\n    }\n    if (!flattenSpans || curStyle != style) {\n      while (curStart < stream.start) {\n        curStart = Math.min(stream.start, curStart + 5000);\n        f(curStart, curStyle);\n      }\n      curStyle = style;\n    }\n    stream.start = stream.pos;\n  }\n  while (curStart < stream.pos) {\n    // Webkit seems to refuse to render text nodes longer than 57444\n    // characters, and returns inaccurate measurements in nodes\n    // starting around 5000 chars.\n    var pos = Math.min(stream.pos, curStart + 5000);\n    f(pos, curStyle);\n    curStart = pos;\n  }\n}\n\n// Finds the line to start with when starting a parse. Tries to\n// find a line with a stateAfter, so that it can start with a\n// valid state. If that fails, it returns the line with the\n// smallest indentation, which tends to need the least context to\n// parse correctly.\nfunction findStartLine(cm, n, precise) {\n  var minindent, minline, doc = cm.doc;\n  var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n  for (var search = n; search > lim; --search) {\n    if (search <= doc.first) { return doc.first }\n    var line = getLine(doc, search - 1);\n    if (line.stateAfter && (!precise || search <= doc.frontier)) { return search }\n    var indented = countColumn(line.text, null, cm.options.tabSize);\n    if (minline == null || minindent > indented) {\n      minline = search - 1;\n      minindent = indented;\n    }\n  }\n  return minline\n}\n\n// LINE DATA STRUCTURE\n\n// Line objects. These hold state related to a line, including\n// highlighting info (the styles array).\nvar Line = function(text, markedSpans, estimateHeight) {\n  this.text = text;\n  attachMarkedSpans(this, markedSpans);\n  this.height = estimateHeight ? estimateHeight(this) : 1;\n};\n\nLine.prototype.lineNo = function () { return lineNo(this) };\neventMixin(Line);\n\n// Change the content (text, markers) of a line. Automatically\n// invalidates cached information and tries to re-estimate the\n// line's height.\nfunction updateLine(line, text, markedSpans, estimateHeight) {\n  line.text = text;\n  if (line.stateAfter) { line.stateAfter = null; }\n  if (line.styles) { line.styles = null; }\n  if (line.order != null) { line.order = null; }\n  detachMarkedSpans(line);\n  attachMarkedSpans(line, markedSpans);\n  var estHeight = estimateHeight ? estimateHeight(line) : 1;\n  if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n}\n\n// Detach a line from the document tree and its markers.\nfunction cleanUpLine(line) {\n  line.parent = null;\n  detachMarkedSpans(line);\n}\n\n// Convert a style as returned by a mode (either null, or a string\n// containing one or more styles) to a CSS style. This is cached,\n// and also looks for line-wide styles.\nvar styleToClassCache = {};\nvar styleToClassCacheWithMode = {};\nfunction interpretTokenStyle(style, options) {\n  if (!style || /^\\s*$/.test(style)) { return null }\n  var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n  return cache[style] ||\n    (cache[style] = style.replace(/\\S+/g, \"cm-$&\"))\n}\n\n// Render the DOM representation of the text of a line. Also builds\n// up a 'line map', which points at the DOM nodes that represent\n// specific stretches of text, and is used by the measuring code.\n// The returned object contains the DOM node, this map, and\n// information about line-wide styles that were set by the mode.\nfunction buildLineContent(cm, lineView) {\n  // The padding-right forces the element to have a 'border', which\n  // is needed on Webkit to be able to get line-level bounding\n  // rectangles for it (in measureChar).\n  var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n  var builder = {pre: eltP(\"pre\", [content], \"CodeMirror-line\"), content: content,\n                 col: 0, pos: 0, cm: cm,\n                 trailingSpace: false,\n                 splitSpaces: (ie || webkit) && cm.getOption(\"lineWrapping\")};\n  lineView.measure = {};\n\n  // Iterate over the logical lines that make up this visual line.\n  for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n    var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0);\n    builder.pos = 0;\n    builder.addToken = buildToken;\n    // Optionally wire in some hacks into the token-rendering\n    // algorithm, to deal with browser quirks.\n    if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\n      { builder.addToken = buildTokenBadBidi(builder.addToken, order); }\n    builder.map = [];\n    var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n    insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n    if (line.styleClasses) {\n      if (line.styleClasses.bgClass)\n        { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\"); }\n      if (line.styleClasses.textClass)\n        { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\"); }\n    }\n\n    // Ensure at least a single node is present, for measuring.\n    if (builder.map.length == 0)\n      { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))); }\n\n    // Store the map and a cache object for the current logical line\n    if (i == 0) {\n      lineView.measure.map = builder.map;\n      lineView.measure.cache = {};\n    } else {\n      (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\n      ;(lineView.measure.caches || (lineView.measure.caches = [])).push({});\n    }\n  }\n\n  // See issue #2901\n  if (webkit) {\n    var last = builder.content.lastChild;\n    if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(\".cm-tab\")))\n      { builder.content.className = \"cm-tab-wrap-hack\"; }\n  }\n\n  signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n  if (builder.pre.className)\n    { builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\"); }\n\n  return builder\n}\n\nfunction defaultSpecialCharPlaceholder(ch) {\n  var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n  token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n  token.setAttribute(\"aria-label\", token.title);\n  return token\n}\n\n// Build up the DOM representation for a single token, and add it to\n// the line map. Takes care to render special characters separately.\nfunction buildToken(builder, text, style, startStyle, endStyle, title, css) {\n  if (!text) { return }\n  var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n  var special = builder.cm.state.specialChars, mustWrap = false;\n  var content;\n  if (!special.test(text)) {\n    builder.col += text.length;\n    content = document.createTextNode(displayText);\n    builder.map.push(builder.pos, builder.pos + text.length, content);\n    if (ie && ie_version < 9) { mustWrap = true; }\n    builder.pos += text.length;\n  } else {\n    content = document.createDocumentFragment();\n    var pos = 0;\n    while (true) {\n      special.lastIndex = pos;\n      var m = special.exec(text);\n      var skipped = m ? m.index - pos : text.length - pos;\n      if (skipped) {\n        var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n        if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt])); }\n        else { content.appendChild(txt); }\n        builder.map.push(builder.pos, builder.pos + skipped, txt);\n        builder.col += skipped;\n        builder.pos += skipped;\n      }\n      if (!m) { break }\n      pos += skipped + 1;\n      var txt$1 = (void 0);\n      if (m[0] == \"\\t\") {\n        var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n        txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n        txt$1.setAttribute(\"role\", \"presentation\");\n        txt$1.setAttribute(\"cm-text\", \"\\t\");\n        builder.col += tabWidth;\n      } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n        txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n        txt$1.setAttribute(\"cm-text\", m[0]);\n        builder.col += 1;\n      } else {\n        txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n        txt$1.setAttribute(\"cm-text\", m[0]);\n        if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt$1])); }\n        else { content.appendChild(txt$1); }\n        builder.col += 1;\n      }\n      builder.map.push(builder.pos, builder.pos + 1, txt$1);\n      builder.pos++;\n    }\n  }\n  builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n  if (style || startStyle || endStyle || mustWrap || css) {\n    var fullStyle = style || \"\";\n    if (startStyle) { fullStyle += startStyle; }\n    if (endStyle) { fullStyle += endStyle; }\n    var token = elt(\"span\", [content], fullStyle, css);\n    if (title) { token.title = title; }\n    return builder.content.appendChild(token)\n  }\n  builder.content.appendChild(content);\n}\n\nfunction splitSpaces(text, trailingBefore) {\n  if (text.length > 1 && !/  /.test(text)) { return text }\n  var spaceBefore = trailingBefore, result = \"\";\n  for (var i = 0; i < text.length; i++) {\n    var ch = text.charAt(i);\n    if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\n      { ch = \"\\u00a0\"; }\n    result += ch;\n    spaceBefore = ch == \" \";\n  }\n  return result\n}\n\n// Work around nonsense dimensions being reported for stretches of\n// right-to-left text.\nfunction buildTokenBadBidi(inner, order) {\n  return function (builder, text, style, startStyle, endStyle, title, css) {\n    style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n    var start = builder.pos, end = start + text.length;\n    for (;;) {\n      // Find the part that overlaps with the start of this text\n      var part = (void 0);\n      for (var i = 0; i < order.length; i++) {\n        part = order[i];\n        if (part.to > start && part.from <= start) { break }\n      }\n      if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, title, css) }\n      inner(builder, text.slice(0, part.to - start), style, startStyle, null, title, css);\n      startStyle = null;\n      text = text.slice(part.to - start);\n      start = part.to;\n    }\n  }\n}\n\nfunction buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n  var widget = !ignoreWidget && marker.widgetNode;\n  if (widget) { builder.map.push(builder.pos, builder.pos + size, widget); }\n  if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n    if (!widget)\n      { widget = builder.content.appendChild(document.createElement(\"span\")); }\n    widget.setAttribute(\"cm-marker\", marker.id);\n  }\n  if (widget) {\n    builder.cm.display.input.setUneditable(widget);\n    builder.content.appendChild(widget);\n  }\n  builder.pos += size;\n  builder.trailingSpace = false;\n}\n\n// Outputs a number of spans to make up a line, taking highlighting\n// and marked text into account.\nfunction insertLineContent(line, builder, styles) {\n  var spans = line.markedSpans, allText = line.text, at = 0;\n  if (!spans) {\n    for (var i$1 = 1; i$1 < styles.length; i$1+=2)\n      { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)); }\n    return\n  }\n\n  var len = allText.length, pos = 0, i = 1, text = \"\", style, css;\n  var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, title, collapsed;\n  for (;;) {\n    if (nextChange == pos) { // Update current marker set\n      spanStyle = spanEndStyle = spanStartStyle = title = css = \"\";\n      collapsed = null; nextChange = Infinity;\n      var foundBookmarks = [], endStyles = (void 0);\n      for (var j = 0; j < spans.length; ++j) {\n        var sp = spans[j], m = sp.marker;\n        if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n          foundBookmarks.push(m);\n        } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n          if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n            nextChange = sp.to;\n            spanEndStyle = \"\";\n          }\n          if (m.className) { spanStyle += \" \" + m.className; }\n          if (m.css) { css = (css ? css + \";\" : \"\") + m.css; }\n          if (m.startStyle && sp.from == pos) { spanStartStyle += \" \" + m.startStyle; }\n          if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to); }\n          if (m.title && !title) { title = m.title; }\n          if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n            { collapsed = sp; }\n        } else if (sp.from > pos && nextChange > sp.from) {\n          nextChange = sp.from;\n        }\n      }\n      if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\n        { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += \" \" + endStyles[j$1]; } } }\n\n      if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\n        { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]); } }\n      if (collapsed && (collapsed.from || 0) == pos) {\n        buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                           collapsed.marker, collapsed.from == null);\n        if (collapsed.to == null) { return }\n        if (collapsed.to == pos) { collapsed = false; }\n      }\n    }\n    if (pos >= len) { break }\n\n    var upto = Math.min(len, nextChange);\n    while (true) {\n      if (text) {\n        var end = pos + text.length;\n        if (!collapsed) {\n          var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n          builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                           spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", title, css);\n        }\n        if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\n        pos = end;\n        spanStartStyle = \"\";\n      }\n      text = allText.slice(at, at = styles[i++]);\n      style = interpretTokenStyle(styles[i++], builder.cm.options);\n    }\n  }\n}\n\n\n// These objects are used to represent the visible (currently drawn)\n// part of the document. A LineView may correspond to multiple\n// logical lines, if those are connected by collapsed ranges.\nfunction LineView(doc, line, lineN) {\n  // The starting line\n  this.line = line;\n  // Continuing lines, if any\n  this.rest = visualLineContinued(line);\n  // Number of logical lines in this visual line\n  this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n  this.node = this.text = null;\n  this.hidden = lineIsHidden(doc, line);\n}\n\n// Create a range of LineView objects for the given lines.\nfunction buildViewArray(cm, from, to) {\n  var array = [], nextPos;\n  for (var pos = from; pos < to; pos = nextPos) {\n    var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n    nextPos = pos + view.size;\n    array.push(view);\n  }\n  return array\n}\n\nvar operationGroup = null;\n\nfunction pushOperation(op) {\n  if (operationGroup) {\n    operationGroup.ops.push(op);\n  } else {\n    op.ownsGroup = operationGroup = {\n      ops: [op],\n      delayedCallbacks: []\n    };\n  }\n}\n\nfunction fireCallbacksForOps(group) {\n  // Calls delayed callbacks and cursorActivity handlers until no\n  // new ones appear\n  var callbacks = group.delayedCallbacks, i = 0;\n  do {\n    for (; i < callbacks.length; i++)\n      { callbacks[i].call(null); }\n    for (var j = 0; j < group.ops.length; j++) {\n      var op = group.ops[j];\n      if (op.cursorActivityHandlers)\n        { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n          { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm); } }\n    }\n  } while (i < callbacks.length)\n}\n\nfunction finishOperation(op, endCb) {\n  var group = op.ownsGroup;\n  if (!group) { return }\n\n  try { fireCallbacksForOps(group); }\n  finally {\n    operationGroup = null;\n    endCb(group);\n  }\n}\n\nvar orphanDelayedCallbacks = null;\n\n// Often, we want to signal events at a point where we are in the\n// middle of some work, but don't want the handler to start calling\n// other methods on the editor, which might be in an inconsistent\n// state or simply not expect any other events to happen.\n// signalLater looks whether there are any handlers, and schedules\n// them to be executed when the last operation ends, or, if no\n// operation is active, when a timeout fires.\nfunction signalLater(emitter, type /*, values...*/) {\n  var arr = getHandlers(emitter, type);\n  if (!arr.length) { return }\n  var args = Array.prototype.slice.call(arguments, 2), list;\n  if (operationGroup) {\n    list = operationGroup.delayedCallbacks;\n  } else if (orphanDelayedCallbacks) {\n    list = orphanDelayedCallbacks;\n  } else {\n    list = orphanDelayedCallbacks = [];\n    setTimeout(fireOrphanDelayed, 0);\n  }\n  var loop = function ( i ) {\n    list.push(function () { return arr[i].apply(null, args); });\n  };\n\n  for (var i = 0; i < arr.length; ++i)\n    loop( i );\n}\n\nfunction fireOrphanDelayed() {\n  var delayed = orphanDelayedCallbacks;\n  orphanDelayedCallbacks = null;\n  for (var i = 0; i < delayed.length; ++i) { delayed[i](); }\n}\n\n// When an aspect of a line changes, a string is added to\n// lineView.changes. This updates the relevant part of the line's\n// DOM structure.\nfunction updateLineForChanges(cm, lineView, lineN, dims) {\n  for (var j = 0; j < lineView.changes.length; j++) {\n    var type = lineView.changes[j];\n    if (type == \"text\") { updateLineText(cm, lineView); }\n    else if (type == \"gutter\") { updateLineGutter(cm, lineView, lineN, dims); }\n    else if (type == \"class\") { updateLineClasses(cm, lineView); }\n    else if (type == \"widget\") { updateLineWidgets(cm, lineView, dims); }\n  }\n  lineView.changes = null;\n}\n\n// Lines with gutter elements, widgets or a background class need to\n// be wrapped, and have the extra elements added to the wrapper div\nfunction ensureLineWrapped(lineView) {\n  if (lineView.node == lineView.text) {\n    lineView.node = elt(\"div\", null, null, \"position: relative\");\n    if (lineView.text.parentNode)\n      { lineView.text.parentNode.replaceChild(lineView.node, lineView.text); }\n    lineView.node.appendChild(lineView.text);\n    if (ie && ie_version < 8) { lineView.node.style.zIndex = 2; }\n  }\n  return lineView.node\n}\n\nfunction updateLineBackground(cm, lineView) {\n  var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n  if (cls) { cls += \" CodeMirror-linebackground\"; }\n  if (lineView.background) {\n    if (cls) { lineView.background.className = cls; }\n    else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n  } else if (cls) {\n    var wrap = ensureLineWrapped(lineView);\n    lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n    cm.display.input.setUneditable(lineView.background);\n  }\n}\n\n// Wrapper around buildLineContent which will reuse the structure\n// in display.externalMeasured when possible.\nfunction getLineContent(cm, lineView) {\n  var ext = cm.display.externalMeasured;\n  if (ext && ext.line == lineView.line) {\n    cm.display.externalMeasured = null;\n    lineView.measure = ext.measure;\n    return ext.built\n  }\n  return buildLineContent(cm, lineView)\n}\n\n// Redraw the line's text. Interacts with the background and text\n// classes because the mode may output tokens that influence these\n// classes.\nfunction updateLineText(cm, lineView) {\n  var cls = lineView.text.className;\n  var built = getLineContent(cm, lineView);\n  if (lineView.text == lineView.node) { lineView.node = built.pre; }\n  lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n  lineView.text = built.pre;\n  if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n    lineView.bgClass = built.bgClass;\n    lineView.textClass = built.textClass;\n    updateLineClasses(cm, lineView);\n  } else if (cls) {\n    lineView.text.className = cls;\n  }\n}\n\nfunction updateLineClasses(cm, lineView) {\n  updateLineBackground(cm, lineView);\n  if (lineView.line.wrapClass)\n    { ensureLineWrapped(lineView).className = lineView.line.wrapClass; }\n  else if (lineView.node != lineView.text)\n    { lineView.node.className = \"\"; }\n  var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n  lineView.text.className = textClass || \"\";\n}\n\nfunction updateLineGutter(cm, lineView, lineN, dims) {\n  if (lineView.gutter) {\n    lineView.node.removeChild(lineView.gutter);\n    lineView.gutter = null;\n  }\n  if (lineView.gutterBackground) {\n    lineView.node.removeChild(lineView.gutterBackground);\n    lineView.gutterBackground = null;\n  }\n  if (lineView.line.gutterClass) {\n    var wrap = ensureLineWrapped(lineView);\n    lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\n                                    (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + (dims.gutterTotalWidth) + \"px\"));\n    cm.display.input.setUneditable(lineView.gutterBackground);\n    wrap.insertBefore(lineView.gutterBackground, lineView.text);\n  }\n  var markers = lineView.line.gutterMarkers;\n  if (cm.options.lineNumbers || markers) {\n    var wrap$1 = ensureLineWrapped(lineView);\n    var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"));\n    cm.display.input.setUneditable(gutterWrap);\n    wrap$1.insertBefore(gutterWrap, lineView.text);\n    if (lineView.line.gutterClass)\n      { gutterWrap.className += \" \" + lineView.line.gutterClass; }\n    if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n      { lineView.lineNumber = gutterWrap.appendChild(\n        elt(\"div\", lineNumberFor(cm.options, lineN),\n            \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n            (\"left: \" + (dims.gutterLeft[\"CodeMirror-linenumbers\"]) + \"px; width: \" + (cm.display.lineNumInnerWidth) + \"px\"))); }\n    if (markers) { for (var k = 0; k < cm.options.gutters.length; ++k) {\n      var id = cm.options.gutters[k], found = markers.hasOwnProperty(id) && markers[id];\n      if (found)\n        { gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\",\n                                   (\"left: \" + (dims.gutterLeft[id]) + \"px; width: \" + (dims.gutterWidth[id]) + \"px\"))); }\n    } }\n  }\n}\n\nfunction updateLineWidgets(cm, lineView, dims) {\n  if (lineView.alignable) { lineView.alignable = null; }\n  for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\n    next = node.nextSibling;\n    if (node.className == \"CodeMirror-linewidget\")\n      { lineView.node.removeChild(node); }\n  }\n  insertLineWidgets(cm, lineView, dims);\n}\n\n// Build a line's DOM representation from scratch\nfunction buildLineElement(cm, lineView, lineN, dims) {\n  var built = getLineContent(cm, lineView);\n  lineView.text = lineView.node = built.pre;\n  if (built.bgClass) { lineView.bgClass = built.bgClass; }\n  if (built.textClass) { lineView.textClass = built.textClass; }\n\n  updateLineClasses(cm, lineView);\n  updateLineGutter(cm, lineView, lineN, dims);\n  insertLineWidgets(cm, lineView, dims);\n  return lineView.node\n}\n\n// A lineView may contain multiple logical lines (when merged by\n// collapsed spans). The widgets for all of them need to be drawn.\nfunction insertLineWidgets(cm, lineView, dims) {\n  insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n  if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n    { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false); } }\n}\n\nfunction insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n  if (!line.widgets) { return }\n  var wrap = ensureLineWrapped(lineView);\n  for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n    var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\");\n    if (!widget.handleMouseEvents) { node.setAttribute(\"cm-ignore-events\", \"true\"); }\n    positionLineWidget(widget, node, lineView, dims);\n    cm.display.input.setUneditable(node);\n    if (allowAbove && widget.above)\n      { wrap.insertBefore(node, lineView.gutter || lineView.text); }\n    else\n      { wrap.appendChild(node); }\n    signalLater(widget, \"redraw\");\n  }\n}\n\nfunction positionLineWidget(widget, node, lineView, dims) {\n  if (widget.noHScroll) {\n    (lineView.alignable || (lineView.alignable = [])).push(node);\n    var width = dims.wrapperWidth;\n    node.style.left = dims.fixedPos + \"px\";\n    if (!widget.coverGutter) {\n      width -= dims.gutterTotalWidth;\n      node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n    }\n    node.style.width = width + \"px\";\n  }\n  if (widget.coverGutter) {\n    node.style.zIndex = 5;\n    node.style.position = \"relative\";\n    if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + \"px\"; }\n  }\n}\n\nfunction widgetHeight(widget) {\n  if (widget.height != null) { return widget.height }\n  var cm = widget.doc.cm;\n  if (!cm) { return 0 }\n  if (!contains(document.body, widget.node)) {\n    var parentStyle = \"position: relative;\";\n    if (widget.coverGutter)\n      { parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\"; }\n    if (widget.noHScroll)\n      { parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\"; }\n    removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n  }\n  return widget.height = widget.node.parentNode.offsetHeight\n}\n\n// Return true when the given mouse event happened in a widget\nfunction eventInWidget(display, e) {\n  for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n    if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\n        (n.parentNode == display.sizer && n != display.mover))\n      { return true }\n  }\n}\n\n// POSITION MEASUREMENT\n\nfunction paddingTop(display) {return display.lineSpace.offsetTop}\nfunction paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\nfunction paddingH(display) {\n  if (display.cachedPaddingH) { return display.cachedPaddingH }\n  var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\"));\n  var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n  var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n  if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data; }\n  return data\n}\n\nfunction scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\nfunction displayWidth(cm) {\n  return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\n}\nfunction displayHeight(cm) {\n  return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\n}\n\n// Ensure the lineView.wrapping.heights array is populated. This is\n// an array of bottom offsets for the lines that make up a drawn\n// line. When lineWrapping is on, there might be more than one\n// height.\nfunction ensureLineHeights(cm, lineView, rect) {\n  var wrapping = cm.options.lineWrapping;\n  var curWidth = wrapping && displayWidth(cm);\n  if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n    var heights = lineView.measure.heights = [];\n    if (wrapping) {\n      lineView.measure.width = curWidth;\n      var rects = lineView.text.firstChild.getClientRects();\n      for (var i = 0; i < rects.length - 1; i++) {\n        var cur = rects[i], next = rects[i + 1];\n        if (Math.abs(cur.bottom - next.bottom) > 2)\n          { heights.push((cur.bottom + next.top) / 2 - rect.top); }\n      }\n    }\n    heights.push(rect.bottom - rect.top);\n  }\n}\n\n// Find a line map (mapping character offsets to text nodes) and a\n// measurement cache for the given line number. (A line view might\n// contain multiple lines when collapsed ranges are present.)\nfunction mapFromLineView(lineView, line, lineN) {\n  if (lineView.line == line)\n    { return {map: lineView.measure.map, cache: lineView.measure.cache} }\n  for (var i = 0; i < lineView.rest.length; i++)\n    { if (lineView.rest[i] == line)\n      { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\n  for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\n    { if (lineNo(lineView.rest[i$1]) > lineN)\n      { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\n}\n\n// Render a line into the hidden node display.externalMeasured. Used\n// when measurement is needed for a line that's not in the viewport.\nfunction updateExternalMeasurement(cm, line) {\n  line = visualLine(line);\n  var lineN = lineNo(line);\n  var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n  view.lineN = lineN;\n  var built = view.built = buildLineContent(cm, view);\n  view.text = built.pre;\n  removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n  return view\n}\n\n// Get a {top, bottom, left, right} box (in line-local coordinates)\n// for a given character.\nfunction measureChar(cm, line, ch, bias) {\n  return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\n}\n\n// Find a line view that corresponds to the given line number.\nfunction findViewForLine(cm, lineN) {\n  if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n    { return cm.display.view[findViewIndex(cm, lineN)] }\n  var ext = cm.display.externalMeasured;\n  if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n    { return ext }\n}\n\n// Measurement can be split in two steps, the set-up work that\n// applies to the whole line, and the measurement of the actual\n// character. Functions like coordsChar, that need to do a lot of\n// measurements in a row, can thus ensure that the set-up work is\n// only done once.\nfunction prepareMeasureForLine(cm, line) {\n  var lineN = lineNo(line);\n  var view = findViewForLine(cm, lineN);\n  if (view && !view.text) {\n    view = null;\n  } else if (view && view.changes) {\n    updateLineForChanges(cm, view, lineN, getDimensions(cm));\n    cm.curOp.forceUpdate = true;\n  }\n  if (!view)\n    { view = updateExternalMeasurement(cm, line); }\n\n  var info = mapFromLineView(view, line, lineN);\n  return {\n    line: line, view: view, rect: null,\n    map: info.map, cache: info.cache, before: info.before,\n    hasHeights: false\n  }\n}\n\n// Given a prepared measurement object, measures the position of an\n// actual character (or fetches it from the cache).\nfunction measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n  if (prepared.before) { ch = -1; }\n  var key = ch + (bias || \"\"), found;\n  if (prepared.cache.hasOwnProperty(key)) {\n    found = prepared.cache[key];\n  } else {\n    if (!prepared.rect)\n      { prepared.rect = prepared.view.text.getBoundingClientRect(); }\n    if (!prepared.hasHeights) {\n      ensureLineHeights(cm, prepared.view, prepared.rect);\n      prepared.hasHeights = true;\n    }\n    found = measureCharInner(cm, prepared, ch, bias);\n    if (!found.bogus) { prepared.cache[key] = found; }\n  }\n  return {left: found.left, right: found.right,\n          top: varHeight ? found.rtop : found.top,\n          bottom: varHeight ? found.rbottom : found.bottom}\n}\n\nvar nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\nfunction nodeAndOffsetInLineMap(map$$1, ch, bias) {\n  var node, start, end, collapse, mStart, mEnd;\n  // First, search the line map for the text node corresponding to,\n  // or closest to, the target character.\n  for (var i = 0; i < map$$1.length; i += 3) {\n    mStart = map$$1[i];\n    mEnd = map$$1[i + 1];\n    if (ch < mStart) {\n      start = 0; end = 1;\n      collapse = \"left\";\n    } else if (ch < mEnd) {\n      start = ch - mStart;\n      end = start + 1;\n    } else if (i == map$$1.length - 3 || ch == mEnd && map$$1[i + 3] > ch) {\n      end = mEnd - mStart;\n      start = end - 1;\n      if (ch >= mEnd) { collapse = \"right\"; }\n    }\n    if (start != null) {\n      node = map$$1[i + 2];\n      if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n        { collapse = bias; }\n      if (bias == \"left\" && start == 0)\n        { while (i && map$$1[i - 2] == map$$1[i - 3] && map$$1[i - 1].insertLeft) {\n          node = map$$1[(i -= 3) + 2];\n          collapse = \"left\";\n        } }\n      if (bias == \"right\" && start == mEnd - mStart)\n        { while (i < map$$1.length - 3 && map$$1[i + 3] == map$$1[i + 4] && !map$$1[i + 5].insertLeft) {\n          node = map$$1[(i += 3) + 2];\n          collapse = \"right\";\n        } }\n      break\n    }\n  }\n  return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\n}\n\nfunction getUsefulRect(rects, bias) {\n  var rect = nullRect;\n  if (bias == \"left\") { for (var i = 0; i < rects.length; i++) {\n    if ((rect = rects[i]).left != rect.right) { break }\n  } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n    if ((rect = rects[i$1]).left != rect.right) { break }\n  } }\n  return rect\n}\n\nfunction measureCharInner(cm, prepared, ch, bias) {\n  var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n  var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\n\n  var rect;\n  if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n    for (var i$1 = 0; i$1 < 4; i$1++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n      while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start; }\n      while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end; }\n      if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\n        { rect = node.parentNode.getBoundingClientRect(); }\n      else\n        { rect = getUsefulRect(range(node, start, end).getClientRects(), bias); }\n      if (rect.left || rect.right || start == 0) { break }\n      end = start;\n      start = start - 1;\n      collapse = \"right\";\n    }\n    if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect); }\n  } else { // If it is a widget, simply get the box for the whole widget.\n    if (start > 0) { collapse = bias = \"right\"; }\n    var rects;\n    if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n      { rect = rects[bias == \"right\" ? rects.length - 1 : 0]; }\n    else\n      { rect = node.getBoundingClientRect(); }\n  }\n  if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n    var rSpan = node.parentNode.getClientRects()[0];\n    if (rSpan)\n      { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom}; }\n    else\n      { rect = nullRect; }\n  }\n\n  var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n  var mid = (rtop + rbot) / 2;\n  var heights = prepared.view.measure.heights;\n  var i = 0;\n  for (; i < heights.length - 1; i++)\n    { if (mid < heights[i]) { break } }\n  var top = i ? heights[i - 1] : 0, bot = heights[i];\n  var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                top: top, bottom: bot};\n  if (!rect.left && !rect.right) { result.bogus = true; }\n  if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n  return result\n}\n\n// Work around problem with bounding client rects on ranges being\n// returned incorrectly when zoomed on IE10 and below.\nfunction maybeUpdateRectForZooming(measure, rect) {\n  if (!window.screen || screen.logicalXDPI == null ||\n      screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n    { return rect }\n  var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n  var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n  return {left: rect.left * scaleX, right: rect.right * scaleX,\n          top: rect.top * scaleY, bottom: rect.bottom * scaleY}\n}\n\nfunction clearLineMeasurementCacheFor(lineView) {\n  if (lineView.measure) {\n    lineView.measure.cache = {};\n    lineView.measure.heights = null;\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n      { lineView.measure.caches[i] = {}; } }\n  }\n}\n\nfunction clearLineMeasurementCache(cm) {\n  cm.display.externalMeasure = null;\n  removeChildren(cm.display.lineMeasure);\n  for (var i = 0; i < cm.display.view.length; i++)\n    { clearLineMeasurementCacheFor(cm.display.view[i]); }\n}\n\nfunction clearCaches(cm) {\n  clearLineMeasurementCache(cm);\n  cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n  if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true; }\n  cm.display.lineNumChars = null;\n}\n\nfunction pageScrollX() {\n  // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n  // which causes page_Offset and bounding client rects to use\n  // different reference viewports and invalidate our calculations.\n  if (chrome && android) { return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft)) }\n  return window.pageXOffset || (document.documentElement || document.body).scrollLeft\n}\nfunction pageScrollY() {\n  if (chrome && android) { return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop)) }\n  return window.pageYOffset || (document.documentElement || document.body).scrollTop\n}\n\n// Converts a {top, bottom, left, right} box from line-local\n// coordinates into another coordinate system. Context may be one of\n// \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n// or \"page\".\nfunction intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n  if (!includeWidgets && lineObj.widgets) { for (var i = 0; i < lineObj.widgets.length; ++i) { if (lineObj.widgets[i].above) {\n    var size = widgetHeight(lineObj.widgets[i]);\n    rect.top += size; rect.bottom += size;\n  } } }\n  if (context == \"line\") { return rect }\n  if (!context) { context = \"local\"; }\n  var yOff = heightAtLine(lineObj);\n  if (context == \"local\") { yOff += paddingTop(cm.display); }\n  else { yOff -= cm.display.viewOffset; }\n  if (context == \"page\" || context == \"window\") {\n    var lOff = cm.display.lineSpace.getBoundingClientRect();\n    yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n    var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n    rect.left += xOff; rect.right += xOff;\n  }\n  rect.top += yOff; rect.bottom += yOff;\n  return rect\n}\n\n// Coverts a box from \"div\" coords to another coordinate system.\n// Context may be \"window\", \"page\", \"div\", or \"local\"./null.\nfunction fromCoordSystem(cm, coords, context) {\n  if (context == \"div\") { return coords }\n  var left = coords.left, top = coords.top;\n  // First move into \"page\" coordinate system\n  if (context == \"page\") {\n    left -= pageScrollX();\n    top -= pageScrollY();\n  } else if (context == \"local\" || !context) {\n    var localBox = cm.display.sizer.getBoundingClientRect();\n    left += localBox.left;\n    top += localBox.top;\n  }\n\n  var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n  return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\n}\n\nfunction charCoords(cm, pos, context, lineObj, bias) {\n  if (!lineObj) { lineObj = getLine(cm.doc, pos.line); }\n  return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\n}\n\n// Returns a box for a given cursor position, which may have an\n// 'other' property containing the position of the secondary cursor\n// on a bidi boundary.\n// A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n// and after `char - 1` in writing order of `char - 1`\n// A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n// and before `char` in writing order of `char`\n// Examples (upper-case letters are RTL, lower-case are LTR):\n//     Pos(0, 1, ...)\n//     before   after\n// ab     a|b     a|b\n// aB     a|B     aB|\n// Ab     |Ab     A|b\n// AB     B|A     B|A\n// Every position after the last character on a line is considered to stick\n// to the last character on the line.\nfunction cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n  lineObj = lineObj || getLine(cm.doc, pos.line);\n  if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n  function get(ch, right) {\n    var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n    if (right) { m.left = m.right; } else { m.right = m.left; }\n    return intoCoordSystem(cm, lineObj, m, context)\n  }\n  var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky;\n  if (ch >= lineObj.text.length) {\n    ch = lineObj.text.length;\n    sticky = \"before\";\n  } else if (ch <= 0) {\n    ch = 0;\n    sticky = \"after\";\n  }\n  if (!order) { return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\") }\n\n  function getBidi(ch, partPos, invert) {\n    var part = order[partPos], right = (part.level % 2) != 0;\n    return get(invert ? ch - 1 : ch, right != invert)\n  }\n  var partPos = getBidiPartAt(order, ch, sticky);\n  var other = bidiOther;\n  var val = getBidi(ch, partPos, sticky == \"before\");\n  if (other != null) { val.other = getBidi(ch, other, sticky != \"before\"); }\n  return val\n}\n\n// Used to cheaply estimate the coordinates for a position. Used for\n// intermediate scroll updates.\nfunction estimateCoords(cm, pos) {\n  var left = 0;\n  pos = clipPos(cm.doc, pos);\n  if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch; }\n  var lineObj = getLine(cm.doc, pos.line);\n  var top = heightAtLine(lineObj) + paddingTop(cm.display);\n  return {left: left, right: left, top: top, bottom: top + lineObj.height}\n}\n\n// Positions returned by coordsChar contain some extra information.\n// xRel is the relative x position of the input coordinates compared\n// to the found position (so xRel > 0 means the coordinates are to\n// the right of the character position, for example). When outside\n// is true, that means the coordinates lie outside the line's\n// vertical range.\nfunction PosWithInfo(line, ch, sticky, outside, xRel) {\n  var pos = Pos(line, ch, sticky);\n  pos.xRel = xRel;\n  if (outside) { pos.outside = true; }\n  return pos\n}\n\n// Compute the character position closest to the given coordinates.\n// Input must be lineSpace-local (\"div\" coordinate system).\nfunction coordsChar(cm, x, y) {\n  var doc = cm.doc;\n  y += cm.display.viewOffset;\n  if (y < 0) { return PosWithInfo(doc.first, 0, null, true, -1) }\n  var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n  if (lineN > last)\n    { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, true, 1) }\n  if (x < 0) { x = 0; }\n\n  var lineObj = getLine(doc, lineN);\n  for (;;) {\n    var found = coordsCharInner(cm, lineObj, lineN, x, y);\n    var merged = collapsedSpanAtEnd(lineObj);\n    var mergedPos = merged && merged.find(0, true);\n    if (merged && (found.ch > mergedPos.from.ch || found.ch == mergedPos.from.ch && found.xRel > 0))\n      { lineN = lineNo(lineObj = mergedPos.to.line); }\n    else\n      { return found }\n  }\n}\n\nfunction wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n  var measure = function (ch) { return intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, ch), \"line\"); };\n  var end = lineObj.text.length;\n  var begin = findFirst(function (ch) { return measure(ch - 1).bottom <= y; }, end, 0);\n  end = findFirst(function (ch) { return measure(ch).top > y; }, begin, end);\n  return {begin: begin, end: end}\n}\n\nfunction wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n  var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n  return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\n}\n\nfunction coordsCharInner(cm, lineObj, lineNo$$1, x, y) {\n  y -= heightAtLine(lineObj);\n  var begin = 0, end = lineObj.text.length;\n  var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n  var pos;\n  var order = getOrder(lineObj, cm.doc.direction);\n  if (order) {\n    if (cm.options.lineWrapping) {\n      var assign;\n      ((assign = wrappedLineExtent(cm, lineObj, preparedMeasure, y), begin = assign.begin, end = assign.end, assign));\n    }\n    pos = new Pos(lineNo$$1, begin);\n    var beginLeft = cursorCoords(cm, pos, \"line\", lineObj, preparedMeasure).left;\n    var dir = beginLeft < x ? 1 : -1;\n    var prevDiff, diff = beginLeft - x, prevPos;\n    do {\n      prevDiff = diff;\n      prevPos = pos;\n      pos = moveVisually(cm, lineObj, pos, dir);\n      if (pos == null || pos.ch < begin || end <= (pos.sticky == \"before\" ? pos.ch - 1 : pos.ch)) {\n        pos = prevPos;\n        break\n      }\n      diff = cursorCoords(cm, pos, \"line\", lineObj, preparedMeasure).left - x;\n    } while ((dir < 0) != (diff < 0) && (Math.abs(diff) <= Math.abs(prevDiff)))\n    if (Math.abs(diff) > Math.abs(prevDiff)) {\n      if ((diff < 0) == (prevDiff < 0)) { throw new Error(\"Broke out of infinite loop in coordsCharInner\") }\n      pos = prevPos;\n    }\n  } else {\n    var ch = findFirst(function (ch) {\n      var box = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, ch), \"line\");\n      if (box.top > y) {\n        // For the cursor stickiness\n        end = Math.min(ch, end);\n        return true\n      }\n      else if (box.bottom <= y) { return false }\n      else if (box.left > x) { return true }\n      else if (box.right < x) { return false }\n      else { return (x - box.left < box.right - x) }\n    }, begin, end);\n    ch = skipExtendingChars(lineObj.text, ch, 1);\n    pos = new Pos(lineNo$$1, ch, ch == end ? \"before\" : \"after\");\n  }\n  var coords = cursorCoords(cm, pos, \"line\", lineObj, preparedMeasure);\n  if (y < coords.top || coords.bottom < y) { pos.outside = true; }\n  pos.xRel = x < coords.left ? -1 : (x > coords.right ? 1 : 0);\n  return pos\n}\n\nvar measureText;\n// Compute the default text height.\nfunction textHeight(display) {\n  if (display.cachedTextHeight != null) { return display.cachedTextHeight }\n  if (measureText == null) {\n    measureText = elt(\"pre\");\n    // Measure a bunch of lines, for browsers that compute\n    // fractional heights.\n    for (var i = 0; i < 49; ++i) {\n      measureText.appendChild(document.createTextNode(\"x\"));\n      measureText.appendChild(elt(\"br\"));\n    }\n    measureText.appendChild(document.createTextNode(\"x\"));\n  }\n  removeChildrenAndAdd(display.measure, measureText);\n  var height = measureText.offsetHeight / 50;\n  if (height > 3) { display.cachedTextHeight = height; }\n  removeChildren(display.measure);\n  return height || 1\n}\n\n// Compute the default character width.\nfunction charWidth(display) {\n  if (display.cachedCharWidth != null) { return display.cachedCharWidth }\n  var anchor = elt(\"span\", \"xxxxxxxxxx\");\n  var pre = elt(\"pre\", [anchor]);\n  removeChildrenAndAdd(display.measure, pre);\n  var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n  if (width > 2) { display.cachedCharWidth = width; }\n  return width || 10\n}\n\n// Do a bulk-read of the DOM positions and sizes needed to draw the\n// view, so that we don't interleave reading and writing to the DOM.\nfunction getDimensions(cm) {\n  var d = cm.display, left = {}, width = {};\n  var gutterLeft = d.gutters.clientLeft;\n  for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n    left[cm.options.gutters[i]] = n.offsetLeft + n.clientLeft + gutterLeft;\n    width[cm.options.gutters[i]] = n.clientWidth;\n  }\n  return {fixedPos: compensateForHScroll(d),\n          gutterTotalWidth: d.gutters.offsetWidth,\n          gutterLeft: left,\n          gutterWidth: width,\n          wrapperWidth: d.wrapper.clientWidth}\n}\n\n// Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n// but using getBoundingClientRect to get a sub-pixel-accurate\n// result.\nfunction compensateForHScroll(display) {\n  return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\n}\n\n// Returns a function that estimates the height of a line, to use as\n// first approximation until the line becomes visible (and is thus\n// properly measurable).\nfunction estimateHeight(cm) {\n  var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n  var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n  return function (line) {\n    if (lineIsHidden(cm.doc, line)) { return 0 }\n\n    var widgetsHeight = 0;\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\n      if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height; }\n    } }\n\n    if (wrapping)\n      { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\n    else\n      { return widgetsHeight + th }\n  }\n}\n\nfunction estimateLineHeights(cm) {\n  var doc = cm.doc, est = estimateHeight(cm);\n  doc.iter(function (line) {\n    var estHeight = est(line);\n    if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n  });\n}\n\n// Given a mouse event, find the corresponding position. If liberal\n// is false, it checks whether a gutter or scrollbar was clicked,\n// and returns null if it was. forRect is used by rectangular\n// selections, and tries to estimate a character position even for\n// coordinates beyond the right of the text.\nfunction posFromMouse(cm, e, liberal, forRect) {\n  var display = cm.display;\n  if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") { return null }\n\n  var x, y, space = display.lineSpace.getBoundingClientRect();\n  // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n  try { x = e.clientX - space.left; y = e.clientY - space.top; }\n  catch (e) { return null }\n  var coords = coordsChar(cm, x, y), line;\n  if (forRect && coords.xRel == 1 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n    var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n    coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n  }\n  return coords\n}\n\n// Find the view element corresponding to a given line. Return null\n// when the line isn't visible.\nfunction findViewIndex(cm, n) {\n  if (n >= cm.display.viewTo) { return null }\n  n -= cm.display.viewFrom;\n  if (n < 0) { return null }\n  var view = cm.display.view;\n  for (var i = 0; i < view.length; i++) {\n    n -= view[i].size;\n    if (n < 0) { return i }\n  }\n}\n\nfunction updateSelection(cm) {\n  cm.display.input.showSelection(cm.display.input.prepareSelection());\n}\n\nfunction prepareSelection(cm, primary) {\n  var doc = cm.doc, result = {};\n  var curFragment = result.cursors = document.createDocumentFragment();\n  var selFragment = result.selection = document.createDocumentFragment();\n\n  for (var i = 0; i < doc.sel.ranges.length; i++) {\n    if (primary === false && i == doc.sel.primIndex) { continue }\n    var range$$1 = doc.sel.ranges[i];\n    if (range$$1.from().line >= cm.display.viewTo || range$$1.to().line < cm.display.viewFrom) { continue }\n    var collapsed = range$$1.empty();\n    if (collapsed || cm.options.showCursorWhenSelecting)\n      { drawSelectionCursor(cm, range$$1.head, curFragment); }\n    if (!collapsed)\n      { drawSelectionRange(cm, range$$1, selFragment); }\n  }\n  return result\n}\n\n// Draws a cursor for the given range\nfunction drawSelectionCursor(cm, head, output) {\n  var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n  var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n  cursor.style.left = pos.left + \"px\";\n  cursor.style.top = pos.top + \"px\";\n  cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n  if (pos.other) {\n    // Secondary cursor, shown when on a 'jump' in bi-directional text\n    var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n    otherCursor.style.display = \"\";\n    otherCursor.style.left = pos.other.left + \"px\";\n    otherCursor.style.top = pos.other.top + \"px\";\n    otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n  }\n}\n\n// Draws the given range as a highlighted selection\nfunction drawSelectionRange(cm, range$$1, output) {\n  var display = cm.display, doc = cm.doc;\n  var fragment = document.createDocumentFragment();\n  var padding = paddingH(cm.display), leftSide = padding.left;\n  var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n\n  function add(left, top, width, bottom) {\n    if (top < 0) { top = 0; }\n    top = Math.round(top);\n    bottom = Math.round(bottom);\n    fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", (\"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\")));\n  }\n\n  function drawForLine(line, fromArg, toArg) {\n    var lineObj = getLine(doc, line);\n    var lineLen = lineObj.text.length;\n    var start, end;\n    function coords(ch, bias) {\n      return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias)\n    }\n\n    iterateBidiSections(getOrder(lineObj, doc.direction), fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir) {\n      var leftPos = coords(from, \"left\"), rightPos, left, right;\n      if (from == to) {\n        rightPos = leftPos;\n        left = right = leftPos.left;\n      } else {\n        rightPos = coords(to - 1, \"right\");\n        if (dir == \"rtl\") { var tmp = leftPos; leftPos = rightPos; rightPos = tmp; }\n        left = leftPos.left;\n        right = rightPos.right;\n      }\n      if (fromArg == null && from == 0) { left = leftSide; }\n      if (rightPos.top - leftPos.top > 3) { // Different lines, draw top part\n        add(left, leftPos.top, null, leftPos.bottom);\n        left = leftSide;\n        if (leftPos.bottom < rightPos.top) { add(left, leftPos.bottom, null, rightPos.top); }\n      }\n      if (toArg == null && to == lineLen) { right = rightSide; }\n      if (!start || leftPos.top < start.top || leftPos.top == start.top && leftPos.left < start.left)\n        { start = leftPos; }\n      if (!end || rightPos.bottom > end.bottom || rightPos.bottom == end.bottom && rightPos.right > end.right)\n        { end = rightPos; }\n      if (left < leftSide + 1) { left = leftSide; }\n      add(left, rightPos.top, right - left, rightPos.bottom);\n    });\n    return {start: start, end: end}\n  }\n\n  var sFrom = range$$1.from(), sTo = range$$1.to();\n  if (sFrom.line == sTo.line) {\n    drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n  } else {\n    var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n    var singleVLine = visualLine(fromLine) == visualLine(toLine);\n    var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n    var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n    if (singleVLine) {\n      if (leftEnd.top < rightStart.top - 2) {\n        add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n        add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n      } else {\n        add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n      }\n    }\n    if (leftEnd.bottom < rightStart.top)\n      { add(leftSide, leftEnd.bottom, null, rightStart.top); }\n  }\n\n  output.appendChild(fragment);\n}\n\n// Cursor-blinking\nfunction restartBlink(cm) {\n  if (!cm.state.focused) { return }\n  var display = cm.display;\n  clearInterval(display.blinker);\n  var on = true;\n  display.cursorDiv.style.visibility = \"\";\n  if (cm.options.cursorBlinkRate > 0)\n    { display.blinker = setInterval(function () { return display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\"; },\n      cm.options.cursorBlinkRate); }\n  else if (cm.options.cursorBlinkRate < 0)\n    { display.cursorDiv.style.visibility = \"hidden\"; }\n}\n\nfunction ensureFocus(cm) {\n  if (!cm.state.focused) { cm.display.input.focus(); onFocus(cm); }\n}\n\nfunction delayBlurEvent(cm) {\n  cm.state.delayingBlurEvent = true;\n  setTimeout(function () { if (cm.state.delayingBlurEvent) {\n    cm.state.delayingBlurEvent = false;\n    onBlur(cm);\n  } }, 100);\n}\n\nfunction onFocus(cm, e) {\n  if (cm.state.delayingBlurEvent) { cm.state.delayingBlurEvent = false; }\n\n  if (cm.options.readOnly == \"nocursor\") { return }\n  if (!cm.state.focused) {\n    signal(cm, \"focus\", cm, e);\n    cm.state.focused = true;\n    addClass(cm.display.wrapper, \"CodeMirror-focused\");\n    // This test prevents this from firing when a context\n    // menu is closed (since the input reset would kill the\n    // select-all detection hack)\n    if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n      cm.display.input.reset();\n      if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20); } // Issue #1730\n    }\n    cm.display.input.receivedFocus();\n  }\n  restartBlink(cm);\n}\nfunction onBlur(cm, e) {\n  if (cm.state.delayingBlurEvent) { return }\n\n  if (cm.state.focused) {\n    signal(cm, \"blur\", cm, e);\n    cm.state.focused = false;\n    rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n  }\n  clearInterval(cm.display.blinker);\n  setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false; } }, 150);\n}\n\n// Read the actual heights of the rendered lines, and update their\n// stored heights to match.\nfunction updateHeightsInViewport(cm) {\n  var display = cm.display;\n  var prevBottom = display.lineDiv.offsetTop;\n  for (var i = 0; i < display.view.length; i++) {\n    var cur = display.view[i], height = (void 0);\n    if (cur.hidden) { continue }\n    if (ie && ie_version < 8) {\n      var bot = cur.node.offsetTop + cur.node.offsetHeight;\n      height = bot - prevBottom;\n      prevBottom = bot;\n    } else {\n      var box = cur.node.getBoundingClientRect();\n      height = box.bottom - box.top;\n    }\n    var diff = cur.line.height - height;\n    if (height < 2) { height = textHeight(display); }\n    if (diff > .001 || diff < -.001) {\n      updateLineHeight(cur.line, height);\n      updateWidgetHeight(cur.line);\n      if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\n        { updateWidgetHeight(cur.rest[j]); } }\n    }\n  }\n}\n\n// Read and store the height of line widgets associated with the\n// given line.\nfunction updateWidgetHeight(line) {\n  if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i)\n    { line.widgets[i].height = line.widgets[i].node.parentNode.offsetHeight; } }\n}\n\n// Compute the lines that are visible in a given viewport (defaults\n// the the current scroll position). viewport may contain top,\n// height, and ensure (see op.scrollToPos) properties.\nfunction visibleLines(display, doc, viewport) {\n  var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n  top = Math.floor(top - paddingTop(display));\n  var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n  var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n  // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n  // forces those lines into the viewport (if possible).\n  if (viewport && viewport.ensure) {\n    var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n    if (ensureFrom < from) {\n      from = ensureFrom;\n      to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n    } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n      from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n      to = ensureTo;\n    }\n  }\n  return {from: from, to: Math.max(to, from + 1)}\n}\n\n// Re-align line numbers and gutter marks to compensate for\n// horizontal scrolling.\nfunction alignHorizontally(cm) {\n  var display = cm.display, view = display.view;\n  if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\n  var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n  var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n  for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\n    if (cm.options.fixedGutter) {\n      if (view[i].gutter)\n        { view[i].gutter.style.left = left; }\n      if (view[i].gutterBackground)\n        { view[i].gutterBackground.style.left = left; }\n    }\n    var align = view[i].alignable;\n    if (align) { for (var j = 0; j < align.length; j++)\n      { align[j].style.left = left; } }\n  } }\n  if (cm.options.fixedGutter)\n    { display.gutters.style.left = (comp + gutterW) + \"px\"; }\n}\n\n// Used to ensure that the line number gutter is still the right\n// size for the current document size. Returns true when an update\n// is needed.\nfunction maybeUpdateLineNumberWidth(cm) {\n  if (!cm.options.lineNumbers) { return false }\n  var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n  if (last.length != display.lineNumChars) {\n    var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                               \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n    var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n    display.lineGutter.style.width = \"\";\n    display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n    display.lineNumWidth = display.lineNumInnerWidth + padding;\n    display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n    display.lineGutter.style.width = display.lineNumWidth + \"px\";\n    updateGutterSpace(cm);\n    return true\n  }\n  return false\n}\n\n// SCROLLING THINGS INTO VIEW\n\n// If an editor sits on the top or bottom of the window, partially\n// scrolled out of view, this ensures that the cursor is visible.\nfunction maybeScrollWindow(cm, rect) {\n  if (signalDOMEvent(cm, \"scrollCursorIntoView\")) { return }\n\n  var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n  if (rect.top + box.top < 0) { doScroll = true; }\n  else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) { doScroll = false; }\n  if (doScroll != null && !phantom) {\n    var scrollNode = elt(\"div\", \"\\u200b\", null, (\"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + (rect.left) + \"px; width: \" + (Math.max(2, rect.right - rect.left)) + \"px;\"));\n    cm.display.lineSpace.appendChild(scrollNode);\n    scrollNode.scrollIntoView(doScroll);\n    cm.display.lineSpace.removeChild(scrollNode);\n  }\n}\n\n// Scroll a given position into view (immediately), verifying that\n// it actually became visible (as line heights are accurately\n// measured, the position of something may 'drift' during drawing).\nfunction scrollPosIntoView(cm, pos, end, margin) {\n  if (margin == null) { margin = 0; }\n  var rect;\n  for (var limit = 0; limit < 5; limit++) {\n    var changed = false;\n    var coords = cursorCoords(cm, pos);\n    var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n    rect = {left: Math.min(coords.left, endCoords.left),\n            top: Math.min(coords.top, endCoords.top) - margin,\n            right: Math.max(coords.left, endCoords.left),\n            bottom: Math.max(coords.bottom, endCoords.bottom) + margin};\n    var scrollPos = calculateScrollPos(cm, rect);\n    var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n    if (scrollPos.scrollTop != null) {\n      updateScrollTop(cm, scrollPos.scrollTop);\n      if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true; }\n    }\n    if (scrollPos.scrollLeft != null) {\n      setScrollLeft(cm, scrollPos.scrollLeft);\n      if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true; }\n    }\n    if (!changed) { break }\n  }\n  return rect\n}\n\n// Scroll a given set of coordinates into view (immediately).\nfunction scrollIntoView(cm, rect) {\n  var scrollPos = calculateScrollPos(cm, rect);\n  if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop); }\n  if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft); }\n}\n\n// Calculate a new scroll position needed to scroll the given\n// rectangle into view. Returns an object with scrollTop and\n// scrollLeft properties. When these are undefined, the\n// vertical/horizontal position does not need to be adjusted.\nfunction calculateScrollPos(cm, rect) {\n  var display = cm.display, snapMargin = textHeight(cm.display);\n  if (rect.top < 0) { rect.top = 0; }\n  var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n  var screen = displayHeight(cm), result = {};\n  if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen; }\n  var docBottom = cm.doc.height + paddingVert(display);\n  var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin;\n  if (rect.top < screentop) {\n    result.scrollTop = atTop ? 0 : rect.top;\n  } else if (rect.bottom > screentop + screen) {\n    var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n    if (newTop != screentop) { result.scrollTop = newTop; }\n  }\n\n  var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n  var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0);\n  var tooWide = rect.right - rect.left > screenw;\n  if (tooWide) { rect.right = rect.left + screenw; }\n  if (rect.left < 10)\n    { result.scrollLeft = 0; }\n  else if (rect.left < screenleft)\n    { result.scrollLeft = Math.max(0, rect.left - (tooWide ? 0 : 10)); }\n  else if (rect.right > screenw + screenleft - 3)\n    { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw; }\n  return result\n}\n\n// Store a relative adjustment to the scroll position in the current\n// operation (to be applied when the operation finishes).\nfunction addToScrollTop(cm, top) {\n  if (top == null) { return }\n  resolveScrollToPos(cm);\n  cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n}\n\n// Make sure that at the end of the operation the current cursor is\n// shown.\nfunction ensureCursorVisible(cm) {\n  resolveScrollToPos(cm);\n  var cur = cm.getCursor(), from = cur, to = cur;\n  if (!cm.options.lineWrapping) {\n    from = cur.ch ? Pos(cur.line, cur.ch - 1) : cur;\n    to = Pos(cur.line, cur.ch + 1);\n  }\n  cm.curOp.scrollToPos = {from: from, to: to, margin: cm.options.cursorScrollMargin};\n}\n\nfunction scrollToCoords(cm, x, y) {\n  if (x != null || y != null) { resolveScrollToPos(cm); }\n  if (x != null) { cm.curOp.scrollLeft = x; }\n  if (y != null) { cm.curOp.scrollTop = y; }\n}\n\nfunction scrollToRange(cm, range$$1) {\n  resolveScrollToPos(cm);\n  cm.curOp.scrollToPos = range$$1;\n}\n\n// When an operation has its scrollToPos property set, and another\n// scroll action is applied before the end of the operation, this\n// 'simulates' scrolling that position into view in a cheap way, so\n// that the effect of intermediate scroll commands is not ignored.\nfunction resolveScrollToPos(cm) {\n  var range$$1 = cm.curOp.scrollToPos;\n  if (range$$1) {\n    cm.curOp.scrollToPos = null;\n    var from = estimateCoords(cm, range$$1.from), to = estimateCoords(cm, range$$1.to);\n    scrollToCoordsRange(cm, from, to, range$$1.margin);\n  }\n}\n\nfunction scrollToCoordsRange(cm, from, to, margin) {\n  var sPos = calculateScrollPos(cm, {\n    left: Math.min(from.left, to.left),\n    top: Math.min(from.top, to.top) - margin,\n    right: Math.max(from.right, to.right),\n    bottom: Math.max(from.bottom, to.bottom) + margin\n  });\n  scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n}\n\n// Sync the scrollable area and scrollbars, ensure the viewport\n// covers the visible area.\nfunction updateScrollTop(cm, val) {\n  if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\n  if (!gecko) { updateDisplaySimple(cm, {top: val}); }\n  setScrollTop(cm, val, true);\n  if (gecko) { updateDisplaySimple(cm); }\n  startWorker(cm, 100);\n}\n\nfunction setScrollTop(cm, val, forceScroll) {\n  val = Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val);\n  if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\n  cm.doc.scrollTop = val;\n  cm.display.scrollbars.setScrollTop(val);\n  if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val; }\n}\n\n// Sync scroller and scrollbar, ensure the gutter elements are\n// aligned.\nfunction setScrollLeft(cm, val, isScroller, forceScroll) {\n  val = Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth);\n  if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\n  cm.doc.scrollLeft = val;\n  alignHorizontally(cm);\n  if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val; }\n  cm.display.scrollbars.setScrollLeft(val);\n}\n\n// SCROLLBARS\n\n// Prepare DOM reads needed to update the scrollbars. Done in one\n// shot to minimize update/measure roundtrips.\nfunction measureForScrollbars(cm) {\n  var d = cm.display, gutterW = d.gutters.offsetWidth;\n  var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n  return {\n    clientHeight: d.scroller.clientHeight,\n    viewHeight: d.wrapper.clientHeight,\n    scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\n    viewWidth: d.wrapper.clientWidth,\n    barLeft: cm.options.fixedGutter ? gutterW : 0,\n    docHeight: docH,\n    scrollHeight: docH + scrollGap(cm) + d.barHeight,\n    nativeBarWidth: d.nativeBarWidth,\n    gutterWidth: gutterW\n  }\n}\n\nvar NativeScrollbars = function(place, scroll, cm) {\n  this.cm = cm;\n  var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n  var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n  place(vert); place(horiz);\n\n  on(vert, \"scroll\", function () {\n    if (vert.clientHeight) { scroll(vert.scrollTop, \"vertical\"); }\n  });\n  on(horiz, \"scroll\", function () {\n    if (horiz.clientWidth) { scroll(horiz.scrollLeft, \"horizontal\"); }\n  });\n\n  this.checkedZeroWidth = false;\n  // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n  if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\"; }\n};\n\nNativeScrollbars.prototype.update = function (measure) {\n  var needsH = measure.scrollWidth > measure.clientWidth + 1;\n  var needsV = measure.scrollHeight > measure.clientHeight + 1;\n  var sWidth = measure.nativeBarWidth;\n\n  if (needsV) {\n    this.vert.style.display = \"block\";\n    this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n    var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\n    // A bug in IE8 can cause this value to be negative, so guard it.\n    this.vert.firstChild.style.height =\n      Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n  } else {\n    this.vert.style.display = \"\";\n    this.vert.firstChild.style.height = \"0\";\n  }\n\n  if (needsH) {\n    this.horiz.style.display = \"block\";\n    this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n    this.horiz.style.left = measure.barLeft + \"px\";\n    var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n    this.horiz.firstChild.style.width =\n      Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n  } else {\n    this.horiz.style.display = \"\";\n    this.horiz.firstChild.style.width = \"0\";\n  }\n\n  if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n    if (sWidth == 0) { this.zeroWidthHack(); }\n    this.checkedZeroWidth = true;\n  }\n\n  return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\n};\n\nNativeScrollbars.prototype.setScrollLeft = function (pos) {\n  if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos; }\n  if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\"); }\n};\n\nNativeScrollbars.prototype.setScrollTop = function (pos) {\n  if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos; }\n  if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\"); }\n};\n\nNativeScrollbars.prototype.zeroWidthHack = function () {\n  var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n  this.horiz.style.height = this.vert.style.width = w;\n  this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\";\n  this.disableHoriz = new Delayed;\n  this.disableVert = new Delayed;\n};\n\nNativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n  bar.style.pointerEvents = \"auto\";\n  function maybeDisable() {\n    // To find out whether the scrollbar is still visible, we\n    // check whether the element under the pixel in the bottom\n    // right corner of the scrollbar box is the scrollbar box\n    // itself (when the bar is still visible) or its filler child\n    // (when the bar is hidden). If it is still visible, we keep\n    // it enabled, if it's hidden, we disable pointer events.\n    var box = bar.getBoundingClientRect();\n    var elt$$1 = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\n        : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n    if (elt$$1 != bar) { bar.style.pointerEvents = \"none\"; }\n    else { delay.set(1000, maybeDisable); }\n  }\n  delay.set(1000, maybeDisable);\n};\n\nNativeScrollbars.prototype.clear = function () {\n  var parent = this.horiz.parentNode;\n  parent.removeChild(this.horiz);\n  parent.removeChild(this.vert);\n};\n\nvar NullScrollbars = function () {};\n\nNullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\nNullScrollbars.prototype.setScrollLeft = function () {};\nNullScrollbars.prototype.setScrollTop = function () {};\nNullScrollbars.prototype.clear = function () {};\n\nfunction updateScrollbars(cm, measure) {\n  if (!measure) { measure = measureForScrollbars(cm); }\n  var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\n  updateScrollbarsInner(cm, measure);\n  for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n    if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\n      { updateHeightsInViewport(cm); }\n    updateScrollbarsInner(cm, measureForScrollbars(cm));\n    startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\n  }\n}\n\n// Re-synchronize the fake scrollbars with the actual size of the\n// content.\nfunction updateScrollbarsInner(cm, measure) {\n  var d = cm.display;\n  var sizes = d.scrollbars.update(measure);\n\n  d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n  d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n  d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n  if (sizes.right && sizes.bottom) {\n    d.scrollbarFiller.style.display = \"block\";\n    d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n    d.scrollbarFiller.style.width = sizes.right + \"px\";\n  } else { d.scrollbarFiller.style.display = \"\"; }\n  if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n    d.gutterFiller.style.display = \"block\";\n    d.gutterFiller.style.height = sizes.bottom + \"px\";\n    d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n  } else { d.gutterFiller.style.display = \"\"; }\n}\n\nvar scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars};\n\nfunction initScrollbars(cm) {\n  if (cm.display.scrollbars) {\n    cm.display.scrollbars.clear();\n    if (cm.display.scrollbars.addClass)\n      { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n  }\n\n  cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n    cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\n    // Prevent clicks in the scrollbars from killing focus\n    on(node, \"mousedown\", function () {\n      if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0); }\n    });\n    node.setAttribute(\"cm-not-content\", \"true\");\n  }, function (pos, axis) {\n    if (axis == \"horizontal\") { setScrollLeft(cm, pos); }\n    else { updateScrollTop(cm, pos); }\n  }, cm);\n  if (cm.display.scrollbars.addClass)\n    { addClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n}\n\n// Operations are used to wrap a series of changes to the editor\n// state in such a way that each change won't have to update the\n// cursor and display (which would be awkward, slow, and\n// error-prone). Instead, display updates are batched and then all\n// combined and executed at once.\n\nvar nextOpId = 0;\n// Start a new operation.\nfunction startOperation(cm) {\n  cm.curOp = {\n    cm: cm,\n    viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n    startHeight: cm.doc.height, // Used to detect need to update scrollbar\n    forceUpdate: false,      // Used to force a redraw\n    updateInput: null,       // Whether to reset the input textarea\n    typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n    changeObjs: null,        // Accumulated changes, for firing change events\n    cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n    cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n    selectionChanged: false, // Whether the selection needs to be redrawn\n    updateMaxLine: false,    // Set when the widest line needs to be determined anew\n    scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n    scrollToPos: null,       // Used to scroll to a specific position\n    focus: false,\n    id: ++nextOpId           // Unique ID\n  };\n  pushOperation(cm.curOp);\n}\n\n// Finish an operation, updating the display and signalling delayed events\nfunction endOperation(cm) {\n  var op = cm.curOp;\n  finishOperation(op, function (group) {\n    for (var i = 0; i < group.ops.length; i++)\n      { group.ops[i].cm.curOp = null; }\n    endOperations(group);\n  });\n}\n\n// The DOM updates done when an operation finishes are batched so\n// that the minimum number of relayouts are required.\nfunction endOperations(group) {\n  var ops = group.ops;\n  for (var i = 0; i < ops.length; i++) // Read DOM\n    { endOperation_R1(ops[i]); }\n  for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n    { endOperation_W1(ops[i$1]); }\n  for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n    { endOperation_R2(ops[i$2]); }\n  for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n    { endOperation_W2(ops[i$3]); }\n  for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n    { endOperation_finish(ops[i$4]); }\n}\n\nfunction endOperation_R1(op) {\n  var cm = op.cm, display = cm.display;\n  maybeClipScrollbars(cm);\n  if (op.updateMaxLine) { findMaxLine(cm); }\n\n  op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n    op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                       op.scrollToPos.to.line >= display.viewTo) ||\n    display.maxLineChanged && cm.options.lineWrapping;\n  op.update = op.mustUpdate &&\n    new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n}\n\nfunction endOperation_W1(op) {\n  op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n}\n\nfunction endOperation_R2(op) {\n  var cm = op.cm, display = cm.display;\n  if (op.updatedDisplay) { updateHeightsInViewport(cm); }\n\n  op.barMeasure = measureForScrollbars(cm);\n\n  // If the max line changed since it was last measured, measure it,\n  // and ensure the document's width matches it.\n  // updateDisplay_W2 will use these properties to do the actual resizing\n  if (display.maxLineChanged && !cm.options.lineWrapping) {\n    op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n    cm.display.sizerWidth = op.adjustWidthTo;\n    op.barMeasure.scrollWidth =\n      Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n    op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n  }\n\n  if (op.updatedDisplay || op.selectionChanged)\n    { op.preparedSelection = display.input.prepareSelection(op.focus); }\n}\n\nfunction endOperation_W2(op) {\n  var cm = op.cm;\n\n  if (op.adjustWidthTo != null) {\n    cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n    if (op.maxScrollLeft < cm.doc.scrollLeft)\n      { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true); }\n    cm.display.maxLineChanged = false;\n  }\n\n  var takeFocus = op.focus && op.focus == activeElt() && (!document.hasFocus || document.hasFocus());\n  if (op.preparedSelection)\n    { cm.display.input.showSelection(op.preparedSelection, takeFocus); }\n  if (op.updatedDisplay || op.startHeight != cm.doc.height)\n    { updateScrollbars(cm, op.barMeasure); }\n  if (op.updatedDisplay)\n    { setDocumentHeight(cm, op.barMeasure); }\n\n  if (op.selectionChanged) { restartBlink(cm); }\n\n  if (cm.state.focused && op.updateInput)\n    { cm.display.input.reset(op.typing); }\n  if (takeFocus) { ensureFocus(op.cm); }\n}\n\nfunction endOperation_finish(op) {\n  var cm = op.cm, display = cm.display, doc = cm.doc;\n\n  if (op.updatedDisplay) { postUpdateDisplay(cm, op.update); }\n\n  // Abort mouse wheel delta measurement, when scrolling explicitly\n  if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n    { display.wheelStartX = display.wheelStartY = null; }\n\n  // Propagate the scroll position to the actual DOM scroller\n  if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll); }\n\n  if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true); }\n  // If we need to scroll a specific position into view, do so.\n  if (op.scrollToPos) {\n    var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                 clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n    maybeScrollWindow(cm, rect);\n  }\n\n  // Fire events for markers that are hidden/unidden by editing or\n  // undoing\n  var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n  if (hidden) { for (var i = 0; i < hidden.length; ++i)\n    { if (!hidden[i].lines.length) { signal(hidden[i], \"hide\"); } } }\n  if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\n    { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], \"unhide\"); } } }\n\n  if (display.wrapper.offsetHeight)\n    { doc.scrollTop = cm.display.scroller.scrollTop; }\n\n  // Fire change events, and delayed event handlers\n  if (op.changeObjs)\n    { signal(cm, \"changes\", cm, op.changeObjs); }\n  if (op.update)\n    { op.update.finish(); }\n}\n\n// Run the given function in an operation\nfunction runInOp(cm, f) {\n  if (cm.curOp) { return f() }\n  startOperation(cm);\n  try { return f() }\n  finally { endOperation(cm); }\n}\n// Wraps a function in an operation. Returns the wrapped function.\nfunction operation(cm, f) {\n  return function() {\n    if (cm.curOp) { return f.apply(cm, arguments) }\n    startOperation(cm);\n    try { return f.apply(cm, arguments) }\n    finally { endOperation(cm); }\n  }\n}\n// Used to add methods to editor and doc instances, wrapping them in\n// operations.\nfunction methodOp(f) {\n  return function() {\n    if (this.curOp) { return f.apply(this, arguments) }\n    startOperation(this);\n    try { return f.apply(this, arguments) }\n    finally { endOperation(this); }\n  }\n}\nfunction docMethodOp(f) {\n  return function() {\n    var cm = this.cm;\n    if (!cm || cm.curOp) { return f.apply(this, arguments) }\n    startOperation(cm);\n    try { return f.apply(this, arguments) }\n    finally { endOperation(cm); }\n  }\n}\n\n// Updates the display.view data structure for a given change to the\n// document. From and to are in pre-change coordinates. Lendiff is\n// the amount of lines added or subtracted by the change. This is\n// used for changes that span multiple lines, or change the way\n// lines are divided into visual lines. regLineChange (below)\n// registers single-line changes.\nfunction regChange(cm, from, to, lendiff) {\n  if (from == null) { from = cm.doc.first; }\n  if (to == null) { to = cm.doc.first + cm.doc.size; }\n  if (!lendiff) { lendiff = 0; }\n\n  var display = cm.display;\n  if (lendiff && to < display.viewTo &&\n      (display.updateLineNumbers == null || display.updateLineNumbers > from))\n    { display.updateLineNumbers = from; }\n\n  cm.curOp.viewChanged = true;\n\n  if (from >= display.viewTo) { // Change after\n    if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n      { resetView(cm); }\n  } else if (to <= display.viewFrom) { // Change before\n    if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n      resetView(cm);\n    } else {\n      display.viewFrom += lendiff;\n      display.viewTo += lendiff;\n    }\n  } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n    resetView(cm);\n  } else if (from <= display.viewFrom) { // Top overlap\n    var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n    if (cut) {\n      display.view = display.view.slice(cut.index);\n      display.viewFrom = cut.lineN;\n      display.viewTo += lendiff;\n    } else {\n      resetView(cm);\n    }\n  } else if (to >= display.viewTo) { // Bottom overlap\n    var cut$1 = viewCuttingPoint(cm, from, from, -1);\n    if (cut$1) {\n      display.view = display.view.slice(0, cut$1.index);\n      display.viewTo = cut$1.lineN;\n    } else {\n      resetView(cm);\n    }\n  } else { // Gap in the middle\n    var cutTop = viewCuttingPoint(cm, from, from, -1);\n    var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n    if (cutTop && cutBot) {\n      display.view = display.view.slice(0, cutTop.index)\n        .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n        .concat(display.view.slice(cutBot.index));\n      display.viewTo += lendiff;\n    } else {\n      resetView(cm);\n    }\n  }\n\n  var ext = display.externalMeasured;\n  if (ext) {\n    if (to < ext.lineN)\n      { ext.lineN += lendiff; }\n    else if (from < ext.lineN + ext.size)\n      { display.externalMeasured = null; }\n  }\n}\n\n// Register a change to a single line. Type must be one of \"text\",\n// \"gutter\", \"class\", \"widget\"\nfunction regLineChange(cm, line, type) {\n  cm.curOp.viewChanged = true;\n  var display = cm.display, ext = cm.display.externalMeasured;\n  if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n    { display.externalMeasured = null; }\n\n  if (line < display.viewFrom || line >= display.viewTo) { return }\n  var lineView = display.view[findViewIndex(cm, line)];\n  if (lineView.node == null) { return }\n  var arr = lineView.changes || (lineView.changes = []);\n  if (indexOf(arr, type) == -1) { arr.push(type); }\n}\n\n// Clear the view.\nfunction resetView(cm) {\n  cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n  cm.display.view = [];\n  cm.display.viewOffset = 0;\n}\n\nfunction viewCuttingPoint(cm, oldN, newN, dir) {\n  var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n  if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n    { return {index: index, lineN: newN} }\n  var n = cm.display.viewFrom;\n  for (var i = 0; i < index; i++)\n    { n += view[i].size; }\n  if (n != oldN) {\n    if (dir > 0) {\n      if (index == view.length - 1) { return null }\n      diff = (n + view[index].size) - oldN;\n      index++;\n    } else {\n      diff = n - oldN;\n    }\n    oldN += diff; newN += diff;\n  }\n  while (visualLineNo(cm.doc, newN) != newN) {\n    if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\n    newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n    index += dir;\n  }\n  return {index: index, lineN: newN}\n}\n\n// Force the view to cover a given range, adding empty view element\n// or clipping off existing ones as needed.\nfunction adjustView(cm, from, to) {\n  var display = cm.display, view = display.view;\n  if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n    display.view = buildViewArray(cm, from, to);\n    display.viewFrom = from;\n  } else {\n    if (display.viewFrom > from)\n      { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view); }\n    else if (display.viewFrom < from)\n      { display.view = display.view.slice(findViewIndex(cm, from)); }\n    display.viewFrom = from;\n    if (display.viewTo < to)\n      { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)); }\n    else if (display.viewTo > to)\n      { display.view = display.view.slice(0, findViewIndex(cm, to)); }\n  }\n  display.viewTo = to;\n}\n\n// Count the number of lines in the view whose DOM representation is\n// out of date (or nonexistent).\nfunction countDirtyView(cm) {\n  var view = cm.display.view, dirty = 0;\n  for (var i = 0; i < view.length; i++) {\n    var lineView = view[i];\n    if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty; }\n  }\n  return dirty\n}\n\n// HIGHLIGHT WORKER\n\nfunction startWorker(cm, time) {\n  if (cm.doc.mode.startState && cm.doc.frontier < cm.display.viewTo)\n    { cm.state.highlight.set(time, bind(highlightWorker, cm)); }\n}\n\nfunction highlightWorker(cm) {\n  var doc = cm.doc;\n  if (doc.frontier < doc.first) { doc.frontier = doc.first; }\n  if (doc.frontier >= cm.display.viewTo) { return }\n  var end = +new Date + cm.options.workTime;\n  var state = copyState(doc.mode, getStateBefore(cm, doc.frontier));\n  var changedLines = [];\n\n  doc.iter(doc.frontier, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n    if (doc.frontier >= cm.display.viewFrom) { // Visible\n      var oldStyles = line.styles, tooLong = line.text.length > cm.options.maxHighlightLength;\n      var highlighted = highlightLine(cm, line, tooLong ? copyState(doc.mode, state) : state, true);\n      line.styles = highlighted.styles;\n      var oldCls = line.styleClasses, newCls = highlighted.classes;\n      if (newCls) { line.styleClasses = newCls; }\n      else if (oldCls) { line.styleClasses = null; }\n      var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n        oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n      for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i]; }\n      if (ischange) { changedLines.push(doc.frontier); }\n      line.stateAfter = tooLong ? state : copyState(doc.mode, state);\n    } else {\n      if (line.text.length <= cm.options.maxHighlightLength)\n        { processLine(cm, line.text, state); }\n      line.stateAfter = doc.frontier % 5 == 0 ? copyState(doc.mode, state) : null;\n    }\n    ++doc.frontier;\n    if (+new Date > end) {\n      startWorker(cm, cm.options.workDelay);\n      return true\n    }\n  });\n  if (changedLines.length) { runInOp(cm, function () {\n    for (var i = 0; i < changedLines.length; i++)\n      { regLineChange(cm, changedLines[i], \"text\"); }\n  }); }\n}\n\n// DISPLAY DRAWING\n\nvar DisplayUpdate = function(cm, viewport, force) {\n  var display = cm.display;\n\n  this.viewport = viewport;\n  // Store some values that we'll need later (but don't want to force a relayout for)\n  this.visible = visibleLines(display, cm.doc, viewport);\n  this.editorIsHidden = !display.wrapper.offsetWidth;\n  this.wrapperHeight = display.wrapper.clientHeight;\n  this.wrapperWidth = display.wrapper.clientWidth;\n  this.oldDisplayWidth = displayWidth(cm);\n  this.force = force;\n  this.dims = getDimensions(cm);\n  this.events = [];\n};\n\nDisplayUpdate.prototype.signal = function (emitter, type) {\n  if (hasHandler(emitter, type))\n    { this.events.push(arguments); }\n};\nDisplayUpdate.prototype.finish = function () {\n    var this$1 = this;\n\n  for (var i = 0; i < this.events.length; i++)\n    { signal.apply(null, this$1.events[i]); }\n};\n\nfunction maybeClipScrollbars(cm) {\n  var display = cm.display;\n  if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n    display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n    display.heightForcer.style.height = scrollGap(cm) + \"px\";\n    display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n    display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n    display.scrollbarsClipped = true;\n  }\n}\n\nfunction selectionSnapshot(cm) {\n  if (cm.hasFocus()) { return null }\n  var active = activeElt();\n  if (!active || !contains(cm.display.lineDiv, active)) { return null }\n  var result = {activeElt: active};\n  if (window.getSelection) {\n    var sel = window.getSelection();\n    if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n      result.anchorNode = sel.anchorNode;\n      result.anchorOffset = sel.anchorOffset;\n      result.focusNode = sel.focusNode;\n      result.focusOffset = sel.focusOffset;\n    }\n  }\n  return result\n}\n\nfunction restoreSelection(snapshot) {\n  if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) { return }\n  snapshot.activeElt.focus();\n  if (snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n    var sel = window.getSelection(), range$$1 = document.createRange();\n    range$$1.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n    range$$1.collapse(false);\n    sel.removeAllRanges();\n    sel.addRange(range$$1);\n    sel.extend(snapshot.focusNode, snapshot.focusOffset);\n  }\n}\n\n// Does the actual updating of the line display. Bails out\n// (returning false) when there is nothing to be done and forced is\n// false.\nfunction updateDisplayIfNeeded(cm, update) {\n  var display = cm.display, doc = cm.doc;\n\n  if (update.editorIsHidden) {\n    resetView(cm);\n    return false\n  }\n\n  // Bail out if the visible area is already rendered and nothing changed.\n  if (!update.force &&\n      update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n      (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n      display.renderedView == display.view && countDirtyView(cm) == 0)\n    { return false }\n\n  if (maybeUpdateLineNumberWidth(cm)) {\n    resetView(cm);\n    update.dims = getDimensions(cm);\n  }\n\n  // Compute a suitable new viewport (from & to)\n  var end = doc.first + doc.size;\n  var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n  var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n  if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom); }\n  if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo); }\n  if (sawCollapsedSpans) {\n    from = visualLineNo(cm.doc, from);\n    to = visualLineEndNo(cm.doc, to);\n  }\n\n  var different = from != display.viewFrom || to != display.viewTo ||\n    display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n  adjustView(cm, from, to);\n\n  display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n  // Position the mover div to align with the current scroll position\n  cm.display.mover.style.top = display.viewOffset + \"px\";\n\n  var toUpdate = countDirtyView(cm);\n  if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\n      (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n    { return false }\n\n  // For big changes, we hide the enclosing element during the\n  // update, since that speeds up the operations on most browsers.\n  var selSnapshot = selectionSnapshot(cm);\n  if (toUpdate > 4) { display.lineDiv.style.display = \"none\"; }\n  patchDisplay(cm, display.updateLineNumbers, update.dims);\n  if (toUpdate > 4) { display.lineDiv.style.display = \"\"; }\n  display.renderedView = display.view;\n  // There might have been a widget with a focused element that got\n  // hidden or updated, if so re-focus it.\n  restoreSelection(selSnapshot);\n\n  // Prevent selection and cursors from interfering with the scroll\n  // width and height.\n  removeChildren(display.cursorDiv);\n  removeChildren(display.selectionDiv);\n  display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n  if (different) {\n    display.lastWrapHeight = update.wrapperHeight;\n    display.lastWrapWidth = update.wrapperWidth;\n    startWorker(cm, 400);\n  }\n\n  display.updateLineNumbers = null;\n\n  return true\n}\n\nfunction postUpdateDisplay(cm, update) {\n  var viewport = update.viewport;\n\n  for (var first = true;; first = false) {\n    if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n      // Clip forced viewport to actual scrollable area.\n      if (viewport && viewport.top != null)\n        { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)}; }\n      // Updated line heights might result in the drawn area not\n      // actually covering the viewport. Keep looping until it does.\n      update.visible = visibleLines(cm.display, cm.doc, viewport);\n      if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n        { break }\n    }\n    if (!updateDisplayIfNeeded(cm, update)) { break }\n    updateHeightsInViewport(cm);\n    var barMeasure = measureForScrollbars(cm);\n    updateSelection(cm);\n    updateScrollbars(cm, barMeasure);\n    setDocumentHeight(cm, barMeasure);\n  }\n\n  update.signal(cm, \"update\", cm);\n  if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n    update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n    cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\n  }\n}\n\nfunction updateDisplaySimple(cm, viewport) {\n  var update = new DisplayUpdate(cm, viewport);\n  if (updateDisplayIfNeeded(cm, update)) {\n    updateHeightsInViewport(cm);\n    postUpdateDisplay(cm, update);\n    var barMeasure = measureForScrollbars(cm);\n    updateSelection(cm);\n    updateScrollbars(cm, barMeasure);\n    setDocumentHeight(cm, barMeasure);\n    update.finish();\n  }\n}\n\n// Sync the actual display DOM structure with display.view, removing\n// nodes for lines that are no longer in view, and creating the ones\n// that are not there yet, and updating the ones that are out of\n// date.\nfunction patchDisplay(cm, updateNumbersFrom, dims) {\n  var display = cm.display, lineNumbers = cm.options.lineNumbers;\n  var container = display.lineDiv, cur = container.firstChild;\n\n  function rm(node) {\n    var next = node.nextSibling;\n    // Works around a throw-scroll bug in OS X Webkit\n    if (webkit && mac && cm.display.currentWheelTarget == node)\n      { node.style.display = \"none\"; }\n    else\n      { node.parentNode.removeChild(node); }\n    return next\n  }\n\n  var view = display.view, lineN = display.viewFrom;\n  // Loop over the elements in the view, syncing cur (the DOM nodes\n  // in display.lineDiv) with the view as we go.\n  for (var i = 0; i < view.length; i++) {\n    var lineView = view[i];\n    if (lineView.hidden) {\n    } else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\n      var node = buildLineElement(cm, lineView, lineN, dims);\n      container.insertBefore(node, cur);\n    } else { // Already drawn\n      while (cur != lineView.node) { cur = rm(cur); }\n      var updateNumber = lineNumbers && updateNumbersFrom != null &&\n        updateNumbersFrom <= lineN && lineView.lineNumber;\n      if (lineView.changes) {\n        if (indexOf(lineView.changes, \"gutter\") > -1) { updateNumber = false; }\n        updateLineForChanges(cm, lineView, lineN, dims);\n      }\n      if (updateNumber) {\n        removeChildren(lineView.lineNumber);\n        lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n      }\n      cur = lineView.node.nextSibling;\n    }\n    lineN += lineView.size;\n  }\n  while (cur) { cur = rm(cur); }\n}\n\nfunction updateGutterSpace(cm) {\n  var width = cm.display.gutters.offsetWidth;\n  cm.display.sizer.style.marginLeft = width + \"px\";\n}\n\nfunction setDocumentHeight(cm, measure) {\n  cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n  cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n  cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + \"px\";\n}\n\n// Rebuild the gutter elements, ensure the margin to the left of the\n// code matches their width.\nfunction updateGutters(cm) {\n  var gutters = cm.display.gutters, specs = cm.options.gutters;\n  removeChildren(gutters);\n  var i = 0;\n  for (; i < specs.length; ++i) {\n    var gutterClass = specs[i];\n    var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + gutterClass));\n    if (gutterClass == \"CodeMirror-linenumbers\") {\n      cm.display.lineGutter = gElt;\n      gElt.style.width = (cm.display.lineNumWidth || 1) + \"px\";\n    }\n  }\n  gutters.style.display = i ? \"\" : \"none\";\n  updateGutterSpace(cm);\n}\n\n// Make sure the gutters options contains the element\n// \"CodeMirror-linenumbers\" when the lineNumbers option is true.\nfunction setGuttersForLineNumbers(options) {\n  var found = indexOf(options.gutters, \"CodeMirror-linenumbers\");\n  if (found == -1 && options.lineNumbers) {\n    options.gutters = options.gutters.concat([\"CodeMirror-linenumbers\"]);\n  } else if (found > -1 && !options.lineNumbers) {\n    options.gutters = options.gutters.slice(0);\n    options.gutters.splice(found, 1);\n  }\n}\n\n// Since the delta values reported on mouse wheel events are\n// unstandardized between browsers and even browser versions, and\n// generally horribly unpredictable, this code starts by measuring\n// the scroll effect that the first few mouse wheel events have,\n// and, from that, detects the way it can convert deltas to pixel\n// offsets afterwards.\n//\n// The reason we want to know the amount a wheel event will scroll\n// is that it gives us a chance to update the display before the\n// actual scrolling happens, reducing flickering.\n\nvar wheelSamples = 0;\nvar wheelPixelsPerUnit = null;\n// Fill in a browser-detected starting value on browsers where we\n// know one. These don't have to be accurate -- the result of them\n// being wrong would just be a slight flicker on the first wheel\n// scroll (if it is large enough).\nif (ie) { wheelPixelsPerUnit = -.53; }\nelse if (gecko) { wheelPixelsPerUnit = 15; }\nelse if (chrome) { wheelPixelsPerUnit = -.7; }\nelse if (safari) { wheelPixelsPerUnit = -1/3; }\n\nfunction wheelEventDelta(e) {\n  var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n  if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail; }\n  if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail; }\n  else if (dy == null) { dy = e.wheelDelta; }\n  return {x: dx, y: dy}\n}\nfunction wheelEventPixels(e) {\n  var delta = wheelEventDelta(e);\n  delta.x *= wheelPixelsPerUnit;\n  delta.y *= wheelPixelsPerUnit;\n  return delta\n}\n\nfunction onScrollWheel(cm, e) {\n  var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\n\n  var display = cm.display, scroll = display.scroller;\n  // Quit if there's nothing to scroll here\n  var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n  var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n  if (!(dx && canScrollX || dy && canScrollY)) { return }\n\n  // Webkit browsers on OS X abort momentum scrolls when the target\n  // of the scroll event is removed from the scrollable element.\n  // This hack (see related code in patchDisplay) makes sure the\n  // element is kept around.\n  if (dy && mac && webkit) {\n    outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n      for (var i = 0; i < view.length; i++) {\n        if (view[i].node == cur) {\n          cm.display.currentWheelTarget = cur;\n          break outer\n        }\n      }\n    }\n  }\n\n  // On some browsers, horizontal scrolling will cause redraws to\n  // happen before the gutter has been realigned, causing it to\n  // wriggle around in a most unseemly way. When we have an\n  // estimated pixels/delta value, we just handle horizontal\n  // scrolling entirely here. It'll be slightly off from native, but\n  // better than glitching out.\n  if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n    if (dy && canScrollY)\n      { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit)); }\n    setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit));\n    // Only prevent default scrolling if vertical scrolling is\n    // actually possible. Otherwise, it causes vertical scroll\n    // jitter on OSX trackpads when deltaX is small and deltaY\n    // is large (issue #3579)\n    if (!dy || (dy && canScrollY))\n      { e_preventDefault(e); }\n    display.wheelStartX = null; // Abort measurement, if in progress\n    return\n  }\n\n  // 'Project' the visible viewport to cover the area that is being\n  // scrolled into view (if we know enough to estimate it).\n  if (dy && wheelPixelsPerUnit != null) {\n    var pixels = dy * wheelPixelsPerUnit;\n    var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n    if (pixels < 0) { top = Math.max(0, top + pixels - 50); }\n    else { bot = Math.min(cm.doc.height, bot + pixels + 50); }\n    updateDisplaySimple(cm, {top: top, bottom: bot});\n  }\n\n  if (wheelSamples < 20) {\n    if (display.wheelStartX == null) {\n      display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n      display.wheelDX = dx; display.wheelDY = dy;\n      setTimeout(function () {\n        if (display.wheelStartX == null) { return }\n        var movedX = scroll.scrollLeft - display.wheelStartX;\n        var movedY = scroll.scrollTop - display.wheelStartY;\n        var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n          (movedX && display.wheelDX && movedX / display.wheelDX);\n        display.wheelStartX = display.wheelStartY = null;\n        if (!sample) { return }\n        wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n        ++wheelSamples;\n      }, 200);\n    } else {\n      display.wheelDX += dx; display.wheelDY += dy;\n    }\n  }\n}\n\n// Selection objects are immutable. A new one is created every time\n// the selection changes. A selection is one or more non-overlapping\n// (and non-touching) ranges, sorted, and an integer that indicates\n// which one is the primary selection (the one that's scrolled into\n// view, that getCursor returns, etc).\nvar Selection = function(ranges, primIndex) {\n  this.ranges = ranges;\n  this.primIndex = primIndex;\n};\n\nSelection.prototype.primary = function () { return this.ranges[this.primIndex] };\n\nSelection.prototype.equals = function (other) {\n    var this$1 = this;\n\n  if (other == this) { return true }\n  if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\n  for (var i = 0; i < this.ranges.length; i++) {\n    var here = this$1.ranges[i], there = other.ranges[i];\n    if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\n  }\n  return true\n};\n\nSelection.prototype.deepCopy = function () {\n    var this$1 = this;\n\n  var out = [];\n  for (var i = 0; i < this.ranges.length; i++)\n    { out[i] = new Range(copyPos(this$1.ranges[i].anchor), copyPos(this$1.ranges[i].head)); }\n  return new Selection(out, this.primIndex)\n};\n\nSelection.prototype.somethingSelected = function () {\n    var this$1 = this;\n\n  for (var i = 0; i < this.ranges.length; i++)\n    { if (!this$1.ranges[i].empty()) { return true } }\n  return false\n};\n\nSelection.prototype.contains = function (pos, end) {\n    var this$1 = this;\n\n  if (!end) { end = pos; }\n  for (var i = 0; i < this.ranges.length; i++) {\n    var range = this$1.ranges[i];\n    if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n      { return i }\n  }\n  return -1\n};\n\nvar Range = function(anchor, head) {\n  this.anchor = anchor; this.head = head;\n};\n\nRange.prototype.from = function () { return minPos(this.anchor, this.head) };\nRange.prototype.to = function () { return maxPos(this.anchor, this.head) };\nRange.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\n\n// Take an unsorted, potentially overlapping set of ranges, and\n// build a selection out of it. 'Consumes' ranges array (modifying\n// it).\nfunction normalizeSelection(ranges, primIndex) {\n  var prim = ranges[primIndex];\n  ranges.sort(function (a, b) { return cmp(a.from(), b.from()); });\n  primIndex = indexOf(ranges, prim);\n  for (var i = 1; i < ranges.length; i++) {\n    var cur = ranges[i], prev = ranges[i - 1];\n    if (cmp(prev.to(), cur.from()) >= 0) {\n      var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n      var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n      if (i <= primIndex) { --primIndex; }\n      ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n    }\n  }\n  return new Selection(ranges, primIndex)\n}\n\nfunction simpleSelection(anchor, head) {\n  return new Selection([new Range(anchor, head || anchor)], 0)\n}\n\n// Compute the position of the end of a change (its 'to' property\n// refers to the pre-change end).\nfunction changeEnd(change) {\n  if (!change.text) { return change.to }\n  return Pos(change.from.line + change.text.length - 1,\n             lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\n}\n\n// Adjust a position to refer to the post-change position of the\n// same text, or the end of the change if the change covers it.\nfunction adjustForChange(pos, change) {\n  if (cmp(pos, change.from) < 0) { return pos }\n  if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\n\n  var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n  if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch; }\n  return Pos(line, ch)\n}\n\nfunction computeSelAfterChange(doc, change) {\n  var out = [];\n  for (var i = 0; i < doc.sel.ranges.length; i++) {\n    var range = doc.sel.ranges[i];\n    out.push(new Range(adjustForChange(range.anchor, change),\n                       adjustForChange(range.head, change)));\n  }\n  return normalizeSelection(out, doc.sel.primIndex)\n}\n\nfunction offsetPos(pos, old, nw) {\n  if (pos.line == old.line)\n    { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\n  else\n    { return Pos(nw.line + (pos.line - old.line), pos.ch) }\n}\n\n// Used by replaceSelections to allow moving the selection to the\n// start or around the replaced test. Hint may be \"start\" or \"around\".\nfunction computeReplacedSel(doc, changes, hint) {\n  var out = [];\n  var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n  for (var i = 0; i < changes.length; i++) {\n    var change = changes[i];\n    var from = offsetPos(change.from, oldPrev, newPrev);\n    var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n    oldPrev = change.to;\n    newPrev = to;\n    if (hint == \"around\") {\n      var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n      out[i] = new Range(inv ? to : from, inv ? from : to);\n    } else {\n      out[i] = new Range(from, from);\n    }\n  }\n  return new Selection(out, doc.sel.primIndex)\n}\n\n// Used to get the editor into a consistent state again when options change.\n\nfunction loadMode(cm) {\n  cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n  resetModeState(cm);\n}\n\nfunction resetModeState(cm) {\n  cm.doc.iter(function (line) {\n    if (line.stateAfter) { line.stateAfter = null; }\n    if (line.styles) { line.styles = null; }\n  });\n  cm.doc.frontier = cm.doc.first;\n  startWorker(cm, 100);\n  cm.state.modeGen++;\n  if (cm.curOp) { regChange(cm); }\n}\n\n// DOCUMENT DATA STRUCTURE\n\n// By default, updates that start and end at the beginning of a line\n// are treated specially, in order to make the association of line\n// widgets and marker elements with the text behave more intuitive.\nfunction isWholeLineUpdate(doc, change) {\n  return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n    (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\n}\n\n// Perform a change on the document data structure.\nfunction updateDoc(doc, change, markedSpans, estimateHeight$$1) {\n  function spansFor(n) {return markedSpans ? markedSpans[n] : null}\n  function update(line, text, spans) {\n    updateLine(line, text, spans, estimateHeight$$1);\n    signalLater(line, \"change\", line, change);\n  }\n  function linesFor(start, end) {\n    var result = [];\n    for (var i = start; i < end; ++i)\n      { result.push(new Line(text[i], spansFor(i), estimateHeight$$1)); }\n    return result\n  }\n\n  var from = change.from, to = change.to, text = change.text;\n  var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n  var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n  // Adjust the line structure\n  if (change.full) {\n    doc.insert(0, linesFor(0, text.length));\n    doc.remove(text.length, doc.size - text.length);\n  } else if (isWholeLineUpdate(doc, change)) {\n    // This is a whole-line replace. Treated specially to make\n    // sure line objects move the way they are supposed to.\n    var added = linesFor(0, text.length - 1);\n    update(lastLine, lastLine.text, lastSpans);\n    if (nlines) { doc.remove(from.line, nlines); }\n    if (added.length) { doc.insert(from.line, added); }\n  } else if (firstLine == lastLine) {\n    if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n    } else {\n      var added$1 = linesFor(1, text.length - 1);\n      added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight$$1));\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      doc.insert(from.line + 1, added$1);\n    }\n  } else if (text.length == 1) {\n    update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n    doc.remove(from.line + 1, nlines);\n  } else {\n    update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n    update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n    var added$2 = linesFor(1, text.length - 1);\n    if (nlines > 1) { doc.remove(from.line + 1, nlines - 1); }\n    doc.insert(from.line + 1, added$2);\n  }\n\n  signalLater(doc, \"change\", doc, change);\n}\n\n// Call f for all linked documents.\nfunction linkedDocs(doc, f, sharedHistOnly) {\n  function propagate(doc, skip, sharedHist) {\n    if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\n      var rel = doc.linked[i];\n      if (rel.doc == skip) { continue }\n      var shared = sharedHist && rel.sharedHist;\n      if (sharedHistOnly && !shared) { continue }\n      f(rel.doc, shared);\n      propagate(rel.doc, doc, shared);\n    } }\n  }\n  propagate(doc, null, true);\n}\n\n// Attach a document to an editor.\nfunction attachDoc(cm, doc) {\n  if (doc.cm) { throw new Error(\"This document is already in use.\") }\n  cm.doc = doc;\n  doc.cm = cm;\n  estimateLineHeights(cm);\n  loadMode(cm);\n  setDirectionClass(cm);\n  if (!cm.options.lineWrapping) { findMaxLine(cm); }\n  cm.options.mode = doc.modeOption;\n  regChange(cm);\n}\n\nfunction setDirectionClass(cm) {\n  (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n}\n\nfunction directionChanged(cm) {\n  runInOp(cm, function () {\n    setDirectionClass(cm);\n    regChange(cm);\n  });\n}\n\nfunction History(startGen) {\n  // Arrays of change events and selections. Doing something adds an\n  // event to done and clears undo. Undoing moves events from done\n  // to undone, redoing moves them in the other direction.\n  this.done = []; this.undone = [];\n  this.undoDepth = Infinity;\n  // Used to track when changes can be merged into a single undo\n  // event\n  this.lastModTime = this.lastSelTime = 0;\n  this.lastOp = this.lastSelOp = null;\n  this.lastOrigin = this.lastSelOrigin = null;\n  // Used by the isClean() method\n  this.generation = this.maxGeneration = startGen || 1;\n}\n\n// Create a history change event from an updateDoc-style change\n// object.\nfunction historyChangeFromChange(doc, change) {\n  var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n  attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n  linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true);\n  return histChange\n}\n\n// Pop all selection events off the end of a history array. Stop at\n// a change event.\nfunction clearSelectionEvents(array) {\n  while (array.length) {\n    var last = lst(array);\n    if (last.ranges) { array.pop(); }\n    else { break }\n  }\n}\n\n// Find the top change event in the history. Pop off selection\n// events that are in the way.\nfunction lastChangeEvent(hist, force) {\n  if (force) {\n    clearSelectionEvents(hist.done);\n    return lst(hist.done)\n  } else if (hist.done.length && !lst(hist.done).ranges) {\n    return lst(hist.done)\n  } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n    hist.done.pop();\n    return lst(hist.done)\n  }\n}\n\n// Register a change in the history. Merges changes that are within\n// a single operation, or are close together with an origin that\n// allows merging (starting with \"+\") into a single event.\nfunction addChangeToHistory(doc, change, selAfter, opId) {\n  var hist = doc.history;\n  hist.undone.length = 0;\n  var time = +new Date, cur;\n  var last;\n\n  if ((hist.lastOp == opId ||\n       hist.lastOrigin == change.origin && change.origin &&\n       ((change.origin.charAt(0) == \"+\" && doc.cm && hist.lastModTime > time - doc.cm.options.historyEventDelay) ||\n        change.origin.charAt(0) == \"*\")) &&\n      (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n    // Merge this change into the last event\n    last = lst(cur.changes);\n    if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n      // Optimized case for simple insertion -- don't want to add\n      // new changesets for every character typed\n      last.to = changeEnd(change);\n    } else {\n      // Add new sub-event\n      cur.changes.push(historyChangeFromChange(doc, change));\n    }\n  } else {\n    // Can not be merged, start a new event.\n    var before = lst(hist.done);\n    if (!before || !before.ranges)\n      { pushSelectionToHistory(doc.sel, hist.done); }\n    cur = {changes: [historyChangeFromChange(doc, change)],\n           generation: hist.generation};\n    hist.done.push(cur);\n    while (hist.done.length > hist.undoDepth) {\n      hist.done.shift();\n      if (!hist.done[0].ranges) { hist.done.shift(); }\n    }\n  }\n  hist.done.push(selAfter);\n  hist.generation = ++hist.maxGeneration;\n  hist.lastModTime = hist.lastSelTime = time;\n  hist.lastOp = hist.lastSelOp = opId;\n  hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n  if (!last) { signal(doc, \"historyAdded\"); }\n}\n\nfunction selectionEventCanBeMerged(doc, origin, prev, sel) {\n  var ch = origin.charAt(0);\n  return ch == \"*\" ||\n    ch == \"+\" &&\n    prev.ranges.length == sel.ranges.length &&\n    prev.somethingSelected() == sel.somethingSelected() &&\n    new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\n}\n\n// Called whenever the selection changes, sets the new selection as\n// the pending selection in the history, and pushes the old pending\n// selection into the 'done' array when it was significantly\n// different (in number of selected ranges, emptiness, or time).\nfunction addSelectionToHistory(doc, sel, opId, options) {\n  var hist = doc.history, origin = options && options.origin;\n\n  // A new event is started when the previous origin does not match\n  // the current, or the origins don't allow matching. Origins\n  // starting with * are always merged, those starting with + are\n  // merged when similar and close together in time.\n  if (opId == hist.lastSelOp ||\n      (origin && hist.lastSelOrigin == origin &&\n       (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n        selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n    { hist.done[hist.done.length - 1] = sel; }\n  else\n    { pushSelectionToHistory(sel, hist.done); }\n\n  hist.lastSelTime = +new Date;\n  hist.lastSelOrigin = origin;\n  hist.lastSelOp = opId;\n  if (options && options.clearRedo !== false)\n    { clearSelectionEvents(hist.undone); }\n}\n\nfunction pushSelectionToHistory(sel, dest) {\n  var top = lst(dest);\n  if (!(top && top.ranges && top.equals(sel)))\n    { dest.push(sel); }\n}\n\n// Used to store marked span information in the history.\nfunction attachLocalSpans(doc, change, from, to) {\n  var existing = change[\"spans_\" + doc.id], n = 0;\n  doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n    if (line.markedSpans)\n      { (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans; }\n    ++n;\n  });\n}\n\n// When un/re-doing restores text containing marked spans, those\n// that have been explicitly cleared should not be restored.\nfunction removeClearedSpans(spans) {\n  if (!spans) { return null }\n  var out;\n  for (var i = 0; i < spans.length; ++i) {\n    if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i); } }\n    else if (out) { out.push(spans[i]); }\n  }\n  return !out ? spans : out.length ? out : null\n}\n\n// Retrieve and filter the old marked spans stored in a change event.\nfunction getOldSpans(doc, change) {\n  var found = change[\"spans_\" + doc.id];\n  if (!found) { return null }\n  var nw = [];\n  for (var i = 0; i < change.text.length; ++i)\n    { nw.push(removeClearedSpans(found[i])); }\n  return nw\n}\n\n// Used for un/re-doing changes from the history. Combines the\n// result of computing the existing spans with the set of spans that\n// existed in the history (so that deleting around a span and then\n// undoing brings back the span).\nfunction mergeOldSpans(doc, change) {\n  var old = getOldSpans(doc, change);\n  var stretched = stretchSpansOverChange(doc, change);\n  if (!old) { return stretched }\n  if (!stretched) { return old }\n\n  for (var i = 0; i < old.length; ++i) {\n    var oldCur = old[i], stretchCur = stretched[i];\n    if (oldCur && stretchCur) {\n      spans: for (var j = 0; j < stretchCur.length; ++j) {\n        var span = stretchCur[j];\n        for (var k = 0; k < oldCur.length; ++k)\n          { if (oldCur[k].marker == span.marker) { continue spans } }\n        oldCur.push(span);\n      }\n    } else if (stretchCur) {\n      old[i] = stretchCur;\n    }\n  }\n  return old\n}\n\n// Used both to provide a JSON-safe object in .getHistory, and, when\n// detaching a document, to split the history in two\nfunction copyHistoryArray(events, newGroup, instantiateSel) {\n  var copy = [];\n  for (var i = 0; i < events.length; ++i) {\n    var event = events[i];\n    if (event.ranges) {\n      copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n      continue\n    }\n    var changes = event.changes, newChanges = [];\n    copy.push({changes: newChanges});\n    for (var j = 0; j < changes.length; ++j) {\n      var change = changes[j], m = (void 0);\n      newChanges.push({from: change.from, to: change.to, text: change.text});\n      if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\n        if (indexOf(newGroup, Number(m[1])) > -1) {\n          lst(newChanges)[prop] = change[prop];\n          delete change[prop];\n        }\n      } } }\n    }\n  }\n  return copy\n}\n\n// The 'scroll' parameter given to many of these indicated whether\n// the new cursor position should be scrolled into view after\n// modifying the selection.\n\n// If shift is held or the extend flag is set, extends a range to\n// include a given position (and optionally a second position).\n// Otherwise, simply returns the range between the given positions.\n// Used for cursor motion and such.\nfunction extendRange(doc, range, head, other) {\n  if (doc.cm && doc.cm.display.shift || doc.extend) {\n    var anchor = range.anchor;\n    if (other) {\n      var posBefore = cmp(head, anchor) < 0;\n      if (posBefore != (cmp(other, anchor) < 0)) {\n        anchor = head;\n        head = other;\n      } else if (posBefore != (cmp(head, other) < 0)) {\n        head = other;\n      }\n    }\n    return new Range(anchor, head)\n  } else {\n    return new Range(other || head, head)\n  }\n}\n\n// Extend the primary selection range, discard the rest.\nfunction extendSelection(doc, head, other, options) {\n  setSelection(doc, new Selection([extendRange(doc, doc.sel.primary(), head, other)], 0), options);\n}\n\n// Extend all selections (pos is an array of selections with length\n// equal the number of selections)\nfunction extendSelections(doc, heads, options) {\n  var out = [];\n  for (var i = 0; i < doc.sel.ranges.length; i++)\n    { out[i] = extendRange(doc, doc.sel.ranges[i], heads[i], null); }\n  var newSel = normalizeSelection(out, doc.sel.primIndex);\n  setSelection(doc, newSel, options);\n}\n\n// Updates a single range in the selection.\nfunction replaceOneSelection(doc, i, range, options) {\n  var ranges = doc.sel.ranges.slice(0);\n  ranges[i] = range;\n  setSelection(doc, normalizeSelection(ranges, doc.sel.primIndex), options);\n}\n\n// Reset the selection to a single range.\nfunction setSimpleSelection(doc, anchor, head, options) {\n  setSelection(doc, simpleSelection(anchor, head), options);\n}\n\n// Give beforeSelectionChange handlers a change to influence a\n// selection update.\nfunction filterSelectionChange(doc, sel, options) {\n  var obj = {\n    ranges: sel.ranges,\n    update: function(ranges) {\n      var this$1 = this;\n\n      this.ranges = [];\n      for (var i = 0; i < ranges.length; i++)\n        { this$1.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                   clipPos(doc, ranges[i].head)); }\n    },\n    origin: options && options.origin\n  };\n  signal(doc, \"beforeSelectionChange\", doc, obj);\n  if (doc.cm) { signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj); }\n  if (obj.ranges != sel.ranges) { return normalizeSelection(obj.ranges, obj.ranges.length - 1) }\n  else { return sel }\n}\n\nfunction setSelectionReplaceHistory(doc, sel, options) {\n  var done = doc.history.done, last = lst(done);\n  if (last && last.ranges) {\n    done[done.length - 1] = sel;\n    setSelectionNoUndo(doc, sel, options);\n  } else {\n    setSelection(doc, sel, options);\n  }\n}\n\n// Set a new selection.\nfunction setSelection(doc, sel, options) {\n  setSelectionNoUndo(doc, sel, options);\n  addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n}\n\nfunction setSelectionNoUndo(doc, sel, options) {\n  if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n    { sel = filterSelectionChange(doc, sel, options); }\n\n  var bias = options && options.bias ||\n    (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n  setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n  if (!(options && options.scroll === false) && doc.cm)\n    { ensureCursorVisible(doc.cm); }\n}\n\nfunction setSelectionInner(doc, sel) {\n  if (sel.equals(doc.sel)) { return }\n\n  doc.sel = sel;\n\n  if (doc.cm) {\n    doc.cm.curOp.updateInput = doc.cm.curOp.selectionChanged = true;\n    signalCursorActivity(doc.cm);\n  }\n  signalLater(doc, \"cursorActivity\", doc);\n}\n\n// Verify that the selection does not partially select any atomic\n// marked ranges.\nfunction reCheckSelection(doc) {\n  setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n}\n\n// Return a selection that does not partially select any atomic\n// ranges.\nfunction skipAtomicInSelection(doc, sel, bias, mayClear) {\n  var out;\n  for (var i = 0; i < sel.ranges.length; i++) {\n    var range = sel.ranges[i];\n    var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n    var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n    var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n    if (out || newAnchor != range.anchor || newHead != range.head) {\n      if (!out) { out = sel.ranges.slice(0, i); }\n      out[i] = new Range(newAnchor, newHead);\n    }\n  }\n  return out ? normalizeSelection(out, sel.primIndex) : sel\n}\n\nfunction skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n  var line = getLine(doc, pos.line);\n  if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n    var sp = line.markedSpans[i], m = sp.marker;\n    if ((sp.from == null || (m.inclusiveLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\n        (sp.to == null || (m.inclusiveRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n      if (mayClear) {\n        signal(m, \"beforeCursorEnter\");\n        if (m.explicitlyCleared) {\n          if (!line.markedSpans) { break }\n          else {--i; continue}\n        }\n      }\n      if (!m.atomic) { continue }\n\n      if (oldPos) {\n        var near = m.find(dir < 0 ? 1 : -1), diff = (void 0);\n        if (dir < 0 ? m.inclusiveRight : m.inclusiveLeft)\n          { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null); }\n        if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\n          { return skipAtomicInner(doc, near, pos, dir, mayClear) }\n      }\n\n      var far = m.find(dir < 0 ? -1 : 1);\n      if (dir < 0 ? m.inclusiveLeft : m.inclusiveRight)\n        { far = movePos(doc, far, dir, far.line == pos.line ? line : null); }\n      return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\n    }\n  } }\n  return pos\n}\n\n// Ensure a given position is not inside an atomic range.\nfunction skipAtomic(doc, pos, oldPos, bias, mayClear) {\n  var dir = bias || 1;\n  var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\n      (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\n      skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\n      (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true));\n  if (!found) {\n    doc.cantEdit = true;\n    return Pos(doc.first, 0)\n  }\n  return found\n}\n\nfunction movePos(doc, pos, dir, line) {\n  if (dir < 0 && pos.ch == 0) {\n    if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\n    else { return null }\n  } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n    if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\n    else { return null }\n  } else {\n    return new Pos(pos.line, pos.ch + dir)\n  }\n}\n\nfunction selectAll(cm) {\n  cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n}\n\n// UPDATING\n\n// Allow \"beforeChange\" event handlers to influence a change\nfunction filterChange(doc, change, update) {\n  var obj = {\n    canceled: false,\n    from: change.from,\n    to: change.to,\n    text: change.text,\n    origin: change.origin,\n    cancel: function () { return obj.canceled = true; }\n  };\n  if (update) { obj.update = function (from, to, text, origin) {\n    if (from) { obj.from = clipPos(doc, from); }\n    if (to) { obj.to = clipPos(doc, to); }\n    if (text) { obj.text = text; }\n    if (origin !== undefined) { obj.origin = origin; }\n  }; }\n  signal(doc, \"beforeChange\", doc, obj);\n  if (doc.cm) { signal(doc.cm, \"beforeChange\", doc.cm, obj); }\n\n  if (obj.canceled) { return null }\n  return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\n}\n\n// Apply a change to a document, and add it to the document's\n// history, and propagating it to all linked documents.\nfunction makeChange(doc, change, ignoreReadOnly) {\n  if (doc.cm) {\n    if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\n    if (doc.cm.state.suppressEdits) { return }\n  }\n\n  if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n    change = filterChange(doc, change, true);\n    if (!change) { return }\n  }\n\n  // Possibly split or suppress the update based on the presence\n  // of read-only spans in its range.\n  var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n  if (split) {\n    for (var i = split.length - 1; i >= 0; --i)\n      { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text}); }\n  } else {\n    makeChangeInner(doc, change);\n  }\n}\n\nfunction makeChangeInner(doc, change) {\n  if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) { return }\n  var selAfter = computeSelAfterChange(doc, change);\n  addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n  makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n  var rebased = [];\n\n  linkedDocs(doc, function (doc, sharedHist) {\n    if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n      rebaseHist(doc.history, change);\n      rebased.push(doc.history);\n    }\n    makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n  });\n}\n\n// Revert a change stored in a document's history.\nfunction makeChangeFromHistory(doc, type, allowSelectionOnly) {\n  if (doc.cm && doc.cm.state.suppressEdits && !allowSelectionOnly) { return }\n\n  var hist = doc.history, event, selAfter = doc.sel;\n  var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n  // Verify that there is a useable event (so that ctrl-z won't\n  // needlessly clear selection events)\n  var i = 0;\n  for (; i < source.length; i++) {\n    event = source[i];\n    if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n      { break }\n  }\n  if (i == source.length) { return }\n  hist.lastOrigin = hist.lastSelOrigin = null;\n\n  for (;;) {\n    event = source.pop();\n    if (event.ranges) {\n      pushSelectionToHistory(event, dest);\n      if (allowSelectionOnly && !event.equals(doc.sel)) {\n        setSelection(doc, event, {clearRedo: false});\n        return\n      }\n      selAfter = event;\n    }\n    else { break }\n  }\n\n  // Build up a reverse change object to add to the opposite history\n  // stack (redo when undoing, and vice versa).\n  var antiChanges = [];\n  pushSelectionToHistory(selAfter, dest);\n  dest.push({changes: antiChanges, generation: hist.generation});\n  hist.generation = event.generation || ++hist.maxGeneration;\n\n  var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n  var loop = function ( i ) {\n    var change = event.changes[i];\n    change.origin = type;\n    if (filter && !filterChange(doc, change, false)) {\n      source.length = 0;\n      return {}\n    }\n\n    antiChanges.push(historyChangeFromChange(doc, change));\n\n    var after = i ? computeSelAfterChange(doc, change) : lst(source);\n    makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n    if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}); }\n    var rebased = [];\n\n    // Propagate to the linked documents\n    linkedDocs(doc, function (doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n    });\n  };\n\n  for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n    var returned = loop( i$1 );\n\n    if ( returned ) return returned.v;\n  }\n}\n\n// Sub-views need their line numbers shifted when text is added\n// above or below them in the parent document.\nfunction shiftDoc(doc, distance) {\n  if (distance == 0) { return }\n  doc.first += distance;\n  doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\n    Pos(range.anchor.line + distance, range.anchor.ch),\n    Pos(range.head.line + distance, range.head.ch)\n  ); }), doc.sel.primIndex);\n  if (doc.cm) {\n    regChange(doc.cm, doc.first, doc.first - distance, distance);\n    for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n      { regLineChange(doc.cm, l, \"gutter\"); }\n  }\n}\n\n// More lower-level change function, handling only a single document\n// (not linked ones).\nfunction makeChangeSingleDoc(doc, change, selAfter, spans) {\n  if (doc.cm && !doc.cm.curOp)\n    { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\n\n  if (change.to.line < doc.first) {\n    shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n    return\n  }\n  if (change.from.line > doc.lastLine()) { return }\n\n  // Clip the change to the size of this doc\n  if (change.from.line < doc.first) {\n    var shift = change.text.length - 1 - (doc.first - change.from.line);\n    shiftDoc(doc, shift);\n    change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n              text: [lst(change.text)], origin: change.origin};\n  }\n  var last = doc.lastLine();\n  if (change.to.line > last) {\n    change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n              text: [change.text[0]], origin: change.origin};\n  }\n\n  change.removed = getBetween(doc, change.from, change.to);\n\n  if (!selAfter) { selAfter = computeSelAfterChange(doc, change); }\n  if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans); }\n  else { updateDoc(doc, change, spans); }\n  setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n}\n\n// Handle the interaction of a change to a document with the editor\n// that this document is part of.\nfunction makeChangeSingleDocInEditor(cm, change, spans) {\n  var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n  var recomputeMaxLength = false, checkWidthStart = from.line;\n  if (!cm.options.lineWrapping) {\n    checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n    doc.iter(checkWidthStart, to.line + 1, function (line) {\n      if (line == display.maxLine) {\n        recomputeMaxLength = true;\n        return true\n      }\n    });\n  }\n\n  if (doc.sel.contains(change.from, change.to) > -1)\n    { signalCursorActivity(cm); }\n\n  updateDoc(doc, change, spans, estimateHeight(cm));\n\n  if (!cm.options.lineWrapping) {\n    doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n      var len = lineLength(line);\n      if (len > display.maxLineLength) {\n        display.maxLine = line;\n        display.maxLineLength = len;\n        display.maxLineChanged = true;\n        recomputeMaxLength = false;\n      }\n    });\n    if (recomputeMaxLength) { cm.curOp.updateMaxLine = true; }\n  }\n\n  // Adjust frontier, schedule worker\n  doc.frontier = Math.min(doc.frontier, from.line);\n  startWorker(cm, 400);\n\n  var lendiff = change.text.length - (to.line - from.line) - 1;\n  // Remember that these lines changed, for updating the display\n  if (change.full)\n    { regChange(cm); }\n  else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n    { regLineChange(cm, from.line, \"text\"); }\n  else\n    { regChange(cm, from.line, to.line + 1, lendiff); }\n\n  var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n  if (changeHandler || changesHandler) {\n    var obj = {\n      from: from, to: to,\n      text: change.text,\n      removed: change.removed,\n      origin: change.origin\n    };\n    if (changeHandler) { signalLater(cm, \"change\", cm, obj); }\n    if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj); }\n  }\n  cm.display.selForContextMenu = null;\n}\n\nfunction replaceRange(doc, code, from, to, origin) {\n  if (!to) { to = from; }\n  if (cmp(to, from) < 0) { var tmp = to; to = from; from = tmp; }\n  if (typeof code == \"string\") { code = doc.splitLines(code); }\n  makeChange(doc, {from: from, to: to, text: code, origin: origin});\n}\n\n// Rebasing/resetting history to deal with externally-sourced changes\n\nfunction rebaseHistSelSingle(pos, from, to, diff) {\n  if (to < pos.line) {\n    pos.line += diff;\n  } else if (from < pos.line) {\n    pos.line = from;\n    pos.ch = 0;\n  }\n}\n\n// Tries to rebase an array of history events given a change in the\n// document. If the change touches the same lines as the event, the\n// event, and everything 'behind' it, is discarded. If the change is\n// before the event, the event's positions are updated. Uses a\n// copy-on-write scheme for the positions, to avoid having to\n// reallocate them all on every rebase, but also avoid problems with\n// shared position objects being unsafely updated.\nfunction rebaseHistArray(array, from, to, diff) {\n  for (var i = 0; i < array.length; ++i) {\n    var sub = array[i], ok = true;\n    if (sub.ranges) {\n      if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n      for (var j = 0; j < sub.ranges.length; j++) {\n        rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n        rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n      }\n      continue\n    }\n    for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n      var cur = sub.changes[j$1];\n      if (to < cur.from.line) {\n        cur.from = Pos(cur.from.line + diff, cur.from.ch);\n        cur.to = Pos(cur.to.line + diff, cur.to.ch);\n      } else if (from <= cur.to.line) {\n        ok = false;\n        break\n      }\n    }\n    if (!ok) {\n      array.splice(0, i + 1);\n      i = 0;\n    }\n  }\n}\n\nfunction rebaseHist(hist, change) {\n  var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n  rebaseHistArray(hist.done, from, to, diff);\n  rebaseHistArray(hist.undone, from, to, diff);\n}\n\n// Utility for applying a change to a line by handle or number,\n// returning the number and optionally registering the line as\n// changed.\nfunction changeLine(doc, handle, changeType, op) {\n  var no = handle, line = handle;\n  if (typeof handle == \"number\") { line = getLine(doc, clipLine(doc, handle)); }\n  else { no = lineNo(handle); }\n  if (no == null) { return null }\n  if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType); }\n  return line\n}\n\n// The document is represented as a BTree consisting of leaves, with\n// chunk of lines in them, and branches, with up to ten leaves or\n// other branch nodes below them. The top node is always a branch\n// node, and is the document object itself (meaning it has\n// additional methods and properties).\n//\n// All nodes have parent links. The tree is used both to go from\n// line numbers to line objects, and to go from objects to numbers.\n// It also indexes by height, and is used to convert between height\n// and line object, and to find the total height of the document.\n//\n// See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\nvar LeafChunk = function(lines) {\n  var this$1 = this;\n\n  this.lines = lines;\n  this.parent = null;\n  var height = 0;\n  for (var i = 0; i < lines.length; ++i) {\n    lines[i].parent = this$1;\n    height += lines[i].height;\n  }\n  this.height = height;\n};\n\nLeafChunk.prototype.chunkSize = function () { return this.lines.length };\n\n// Remove the n lines at offset 'at'.\nLeafChunk.prototype.removeInner = function (at, n) {\n    var this$1 = this;\n\n  for (var i = at, e = at + n; i < e; ++i) {\n    var line = this$1.lines[i];\n    this$1.height -= line.height;\n    cleanUpLine(line);\n    signalLater(line, \"delete\");\n  }\n  this.lines.splice(at, n);\n};\n\n// Helper used to collapse a small branch into a single leaf.\nLeafChunk.prototype.collapse = function (lines) {\n  lines.push.apply(lines, this.lines);\n};\n\n// Insert the given array of lines at offset 'at', count them as\n// having the given height.\nLeafChunk.prototype.insertInner = function (at, lines, height) {\n    var this$1 = this;\n\n  this.height += height;\n  this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n  for (var i = 0; i < lines.length; ++i) { lines[i].parent = this$1; }\n};\n\n// Used to iterate over a part of the tree.\nLeafChunk.prototype.iterN = function (at, n, op) {\n    var this$1 = this;\n\n  for (var e = at + n; at < e; ++at)\n    { if (op(this$1.lines[at])) { return true } }\n};\n\nvar BranchChunk = function(children) {\n  var this$1 = this;\n\n  this.children = children;\n  var size = 0, height = 0;\n  for (var i = 0; i < children.length; ++i) {\n    var ch = children[i];\n    size += ch.chunkSize(); height += ch.height;\n    ch.parent = this$1;\n  }\n  this.size = size;\n  this.height = height;\n  this.parent = null;\n};\n\nBranchChunk.prototype.chunkSize = function () { return this.size };\n\nBranchChunk.prototype.removeInner = function (at, n) {\n    var this$1 = this;\n\n  this.size -= n;\n  for (var i = 0; i < this.children.length; ++i) {\n    var child = this$1.children[i], sz = child.chunkSize();\n    if (at < sz) {\n      var rm = Math.min(n, sz - at), oldHeight = child.height;\n      child.removeInner(at, rm);\n      this$1.height -= oldHeight - child.height;\n      if (sz == rm) { this$1.children.splice(i--, 1); child.parent = null; }\n      if ((n -= rm) == 0) { break }\n      at = 0;\n    } else { at -= sz; }\n  }\n  // If the result is smaller than 25 lines, ensure that it is a\n  // single leaf node.\n  if (this.size - n < 25 &&\n      (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n    var lines = [];\n    this.collapse(lines);\n    this.children = [new LeafChunk(lines)];\n    this.children[0].parent = this;\n  }\n};\n\nBranchChunk.prototype.collapse = function (lines) {\n    var this$1 = this;\n\n  for (var i = 0; i < this.children.length; ++i) { this$1.children[i].collapse(lines); }\n};\n\nBranchChunk.prototype.insertInner = function (at, lines, height) {\n    var this$1 = this;\n\n  this.size += lines.length;\n  this.height += height;\n  for (var i = 0; i < this.children.length; ++i) {\n    var child = this$1.children[i], sz = child.chunkSize();\n    if (at <= sz) {\n      child.insertInner(at, lines, height);\n      if (child.lines && child.lines.length > 50) {\n        // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n        // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n        var remaining = child.lines.length % 25 + 25;\n        for (var pos = remaining; pos < child.lines.length;) {\n          var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n          child.height -= leaf.height;\n          this$1.children.splice(++i, 0, leaf);\n          leaf.parent = this$1;\n        }\n        child.lines = child.lines.slice(0, remaining);\n        this$1.maybeSpill();\n      }\n      break\n    }\n    at -= sz;\n  }\n};\n\n// When a node has grown, check whether it should be split.\nBranchChunk.prototype.maybeSpill = function () {\n  if (this.children.length <= 10) { return }\n  var me = this;\n  do {\n    var spilled = me.children.splice(me.children.length - 5, 5);\n    var sibling = new BranchChunk(spilled);\n    if (!me.parent) { // Become the parent node\n      var copy = new BranchChunk(me.children);\n      copy.parent = me;\n      me.children = [copy, sibling];\n      me = copy;\n   } else {\n      me.size -= sibling.size;\n      me.height -= sibling.height;\n      var myIndex = indexOf(me.parent.children, me);\n      me.parent.children.splice(myIndex + 1, 0, sibling);\n    }\n    sibling.parent = me.parent;\n  } while (me.children.length > 10)\n  me.parent.maybeSpill();\n};\n\nBranchChunk.prototype.iterN = function (at, n, op) {\n    var this$1 = this;\n\n  for (var i = 0; i < this.children.length; ++i) {\n    var child = this$1.children[i], sz = child.chunkSize();\n    if (at < sz) {\n      var used = Math.min(n, sz - at);\n      if (child.iterN(at, used, op)) { return true }\n      if ((n -= used) == 0) { break }\n      at = 0;\n    } else { at -= sz; }\n  }\n};\n\n// Line widgets are block elements displayed above or below a line.\n\nvar LineWidget = function(doc, node, options) {\n  var this$1 = this;\n\n  if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\n    { this$1[opt] = options[opt]; } } }\n  this.doc = doc;\n  this.node = node;\n};\n\nLineWidget.prototype.clear = function () {\n    var this$1 = this;\n\n  var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n  if (no == null || !ws) { return }\n  for (var i = 0; i < ws.length; ++i) { if (ws[i] == this$1) { ws.splice(i--, 1); } }\n  if (!ws.length) { line.widgets = null; }\n  var height = widgetHeight(this);\n  updateLineHeight(line, Math.max(0, line.height - height));\n  if (cm) {\n    runInOp(cm, function () {\n      adjustScrollWhenAboveVisible(cm, line, -height);\n      regLineChange(cm, no, \"widget\");\n    });\n    signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n  }\n};\n\nLineWidget.prototype.changed = function () {\n    var this$1 = this;\n\n  var oldH = this.height, cm = this.doc.cm, line = this.line;\n  this.height = null;\n  var diff = widgetHeight(this) - oldH;\n  if (!diff) { return }\n  updateLineHeight(line, line.height + diff);\n  if (cm) {\n    runInOp(cm, function () {\n      cm.curOp.forceUpdate = true;\n      adjustScrollWhenAboveVisible(cm, line, diff);\n      signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n    });\n  }\n};\neventMixin(LineWidget);\n\nfunction adjustScrollWhenAboveVisible(cm, line, diff) {\n  if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n    { addToScrollTop(cm, diff); }\n}\n\nfunction addLineWidget(doc, handle, node, options) {\n  var widget = new LineWidget(doc, node, options);\n  var cm = doc.cm;\n  if (cm && widget.noHScroll) { cm.display.alignWidgets = true; }\n  changeLine(doc, handle, \"widget\", function (line) {\n    var widgets = line.widgets || (line.widgets = []);\n    if (widget.insertAt == null) { widgets.push(widget); }\n    else { widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget); }\n    widget.line = line;\n    if (cm && !lineIsHidden(doc, line)) {\n      var aboveVisible = heightAtLine(line) < doc.scrollTop;\n      updateLineHeight(line, line.height + widgetHeight(widget));\n      if (aboveVisible) { addToScrollTop(cm, widget.height); }\n      cm.curOp.forceUpdate = true;\n    }\n    return true\n  });\n  signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle));\n  return widget\n}\n\n// TEXTMARKERS\n\n// Created with markText and setBookmark methods. A TextMarker is a\n// handle that can be used to clear or find a marked position in the\n// document. Line objects hold arrays (markedSpans) containing\n// {from, to, marker} object pointing to such marker objects, and\n// indicating that such a marker is present on that line. Multiple\n// lines may point to the same marker when it spans across lines.\n// The spans will have null for their from/to properties when the\n// marker continues beyond the start/end of the line. Markers have\n// links back to the lines they currently touch.\n\n// Collapsed markers have unique ids, in order to be able to order\n// them, which is needed for uniquely determining an outer marker\n// when they overlap (they may nest, but not partially overlap).\nvar nextMarkerId = 0;\n\nvar TextMarker = function(doc, type) {\n  this.lines = [];\n  this.type = type;\n  this.doc = doc;\n  this.id = ++nextMarkerId;\n};\n\n// Clear the marker.\nTextMarker.prototype.clear = function () {\n    var this$1 = this;\n\n  if (this.explicitlyCleared) { return }\n  var cm = this.doc.cm, withOp = cm && !cm.curOp;\n  if (withOp) { startOperation(cm); }\n  if (hasHandler(this, \"clear\")) {\n    var found = this.find();\n    if (found) { signalLater(this, \"clear\", found.from, found.to); }\n  }\n  var min = null, max = null;\n  for (var i = 0; i < this.lines.length; ++i) {\n    var line = this$1.lines[i];\n    var span = getMarkedSpanFor(line.markedSpans, this$1);\n    if (cm && !this$1.collapsed) { regLineChange(cm, lineNo(line), \"text\"); }\n    else if (cm) {\n      if (span.to != null) { max = lineNo(line); }\n      if (span.from != null) { min = lineNo(line); }\n    }\n    line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n    if (span.from == null && this$1.collapsed && !lineIsHidden(this$1.doc, line) && cm)\n      { updateLineHeight(line, textHeight(cm.display)); }\n  }\n  if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n    var visual = visualLine(this$1.lines[i$1]), len = lineLength(visual);\n    if (len > cm.display.maxLineLength) {\n      cm.display.maxLine = visual;\n      cm.display.maxLineLength = len;\n      cm.display.maxLineChanged = true;\n    }\n  } }\n\n  if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1); }\n  this.lines.length = 0;\n  this.explicitlyCleared = true;\n  if (this.atomic && this.doc.cantEdit) {\n    this.doc.cantEdit = false;\n    if (cm) { reCheckSelection(cm.doc); }\n  }\n  if (cm) { signalLater(cm, \"markerCleared\", cm, this, min, max); }\n  if (withOp) { endOperation(cm); }\n  if (this.parent) { this.parent.clear(); }\n};\n\n// Find the position of the marker in the document. Returns a {from,\n// to} object by default. Side can be passed to get a specific side\n// -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n// Pos objects returned contain a line object, rather than a line\n// number (used to prevent looking up the same line twice).\nTextMarker.prototype.find = function (side, lineObj) {\n    var this$1 = this;\n\n  if (side == null && this.type == \"bookmark\") { side = 1; }\n  var from, to;\n  for (var i = 0; i < this.lines.length; ++i) {\n    var line = this$1.lines[i];\n    var span = getMarkedSpanFor(line.markedSpans, this$1);\n    if (span.from != null) {\n      from = Pos(lineObj ? line : lineNo(line), span.from);\n      if (side == -1) { return from }\n    }\n    if (span.to != null) {\n      to = Pos(lineObj ? line : lineNo(line), span.to);\n      if (side == 1) { return to }\n    }\n  }\n  return from && {from: from, to: to}\n};\n\n// Signals that the marker's widget changed, and surrounding layout\n// should be recomputed.\nTextMarker.prototype.changed = function () {\n    var this$1 = this;\n\n  var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n  if (!pos || !cm) { return }\n  runInOp(cm, function () {\n    var line = pos.line, lineN = lineNo(pos.line);\n    var view = findViewForLine(cm, lineN);\n    if (view) {\n      clearLineMeasurementCacheFor(view);\n      cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n    }\n    cm.curOp.updateMaxLine = true;\n    if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n      var oldHeight = widget.height;\n      widget.height = null;\n      var dHeight = widgetHeight(widget) - oldHeight;\n      if (dHeight)\n        { updateLineHeight(line, line.height + dHeight); }\n    }\n    signalLater(cm, \"markerChanged\", cm, this$1);\n  });\n};\n\nTextMarker.prototype.attachLine = function (line) {\n  if (!this.lines.length && this.doc.cm) {\n    var op = this.doc.cm.curOp;\n    if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n      { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this); }\n  }\n  this.lines.push(line);\n};\n\nTextMarker.prototype.detachLine = function (line) {\n  this.lines.splice(indexOf(this.lines, line), 1);\n  if (!this.lines.length && this.doc.cm) {\n    var op = this.doc.cm.curOp;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n  }\n};\neventMixin(TextMarker);\n\n// Create a marker, wire it up to the right lines, and\nfunction markText(doc, from, to, options, type) {\n  // Shared markers (across linked documents) are handled separately\n  // (markTextShared will call out to this again, once per\n  // document).\n  if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\n  // Ensure we are in an operation.\n  if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\n\n  var marker = new TextMarker(doc, type), diff = cmp(from, to);\n  if (options) { copyObj(options, marker, false); }\n  // Don't connect empty markers unless clearWhenEmpty is false\n  if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n    { return marker }\n  if (marker.replacedWith) {\n    // Showing up as a widget implies collapsed (widget replaces text)\n    marker.collapsed = true;\n    marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n    if (!options.handleMouseEvents) { marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\"); }\n    if (options.insertLeft) { marker.widgetNode.insertLeft = true; }\n  }\n  if (marker.collapsed) {\n    if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n        from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n      { throw new Error(\"Inserting collapsed marker partially overlapping an existing one\") }\n    seeCollapsedSpans();\n  }\n\n  if (marker.addToHistory)\n    { addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN); }\n\n  var curLine = from.line, cm = doc.cm, updateMaxLine;\n  doc.iter(curLine, to.line + 1, function (line) {\n    if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n      { updateMaxLine = true; }\n    if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0); }\n    addMarkedSpan(line, new MarkedSpan(marker,\n                                       curLine == from.line ? from.ch : null,\n                                       curLine == to.line ? to.ch : null));\n    ++curLine;\n  });\n  // lineIsHidden depends on the presence of the spans, so needs a second pass\n  if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\n    if (lineIsHidden(doc, line)) { updateLineHeight(line, 0); }\n  }); }\n\n  if (marker.clearOnEnter) { on(marker, \"beforeCursorEnter\", function () { return marker.clear(); }); }\n\n  if (marker.readOnly) {\n    seeReadOnlySpans();\n    if (doc.history.done.length || doc.history.undone.length)\n      { doc.clearHistory(); }\n  }\n  if (marker.collapsed) {\n    marker.id = ++nextMarkerId;\n    marker.atomic = true;\n  }\n  if (cm) {\n    // Sync editor state\n    if (updateMaxLine) { cm.curOp.updateMaxLine = true; }\n    if (marker.collapsed)\n      { regChange(cm, from.line, to.line + 1); }\n    else if (marker.className || marker.title || marker.startStyle || marker.endStyle || marker.css)\n      { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, \"text\"); } }\n    if (marker.atomic) { reCheckSelection(cm.doc); }\n    signalLater(cm, \"markerAdded\", cm, marker);\n  }\n  return marker\n}\n\n// SHARED TEXTMARKERS\n\n// A shared marker spans multiple linked documents. It is\n// implemented as a meta-marker-object controlling multiple normal\n// markers.\nvar SharedTextMarker = function(markers, primary) {\n  var this$1 = this;\n\n  this.markers = markers;\n  this.primary = primary;\n  for (var i = 0; i < markers.length; ++i)\n    { markers[i].parent = this$1; }\n};\n\nSharedTextMarker.prototype.clear = function () {\n    var this$1 = this;\n\n  if (this.explicitlyCleared) { return }\n  this.explicitlyCleared = true;\n  for (var i = 0; i < this.markers.length; ++i)\n    { this$1.markers[i].clear(); }\n  signalLater(this, \"clear\");\n};\n\nSharedTextMarker.prototype.find = function (side, lineObj) {\n  return this.primary.find(side, lineObj)\n};\neventMixin(SharedTextMarker);\n\nfunction markTextShared(doc, from, to, options, type) {\n  options = copyObj(options);\n  options.shared = false;\n  var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n  var widget = options.widgetNode;\n  linkedDocs(doc, function (doc) {\n    if (widget) { options.widgetNode = widget.cloneNode(true); }\n    markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n    for (var i = 0; i < doc.linked.length; ++i)\n      { if (doc.linked[i].isParent) { return } }\n    primary = lst(markers);\n  });\n  return new SharedTextMarker(markers, primary)\n}\n\nfunction findSharedMarkers(doc) {\n  return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\n}\n\nfunction copySharedMarkers(doc, markers) {\n  for (var i = 0; i < markers.length; i++) {\n    var marker = markers[i], pos = marker.find();\n    var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n    if (cmp(mFrom, mTo)) {\n      var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n      marker.markers.push(subMark);\n      subMark.parent = marker;\n    }\n  }\n}\n\nfunction detachSharedMarkers(markers) {\n  var loop = function ( i ) {\n    var marker = markers[i], linked = [marker.primary.doc];\n    linkedDocs(marker.primary.doc, function (d) { return linked.push(d); });\n    for (var j = 0; j < marker.markers.length; j++) {\n      var subMarker = marker.markers[j];\n      if (indexOf(linked, subMarker.doc) == -1) {\n        subMarker.parent = null;\n        marker.markers.splice(j--, 1);\n      }\n    }\n  };\n\n  for (var i = 0; i < markers.length; i++) loop( i );\n}\n\nvar nextDocId = 0;\nvar Doc = function(text, mode, firstLine, lineSep, direction) {\n  if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\n  if (firstLine == null) { firstLine = 0; }\n\n  BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n  this.first = firstLine;\n  this.scrollTop = this.scrollLeft = 0;\n  this.cantEdit = false;\n  this.cleanGeneration = 1;\n  this.frontier = firstLine;\n  var start = Pos(firstLine, 0);\n  this.sel = simpleSelection(start);\n  this.history = new History(null);\n  this.id = ++nextDocId;\n  this.modeOption = mode;\n  this.lineSep = lineSep;\n  this.direction = (direction == \"rtl\") ? \"rtl\" : \"ltr\";\n  this.extend = false;\n\n  if (typeof text == \"string\") { text = this.splitLines(text); }\n  updateDoc(this, {from: start, to: start, text: text});\n  setSelection(this, simpleSelection(start), sel_dontScroll);\n};\n\nDoc.prototype = createObj(BranchChunk.prototype, {\n  constructor: Doc,\n  // Iterate over the document. Supports two forms -- with only one\n  // argument, it calls that for each line in the document. With\n  // three, it iterates over the range given by the first two (with\n  // the second being non-inclusive).\n  iter: function(from, to, op) {\n    if (op) { this.iterN(from - this.first, to - from, op); }\n    else { this.iterN(this.first, this.first + this.size, from); }\n  },\n\n  // Non-public interface for adding and removing lines.\n  insert: function(at, lines) {\n    var height = 0;\n    for (var i = 0; i < lines.length; ++i) { height += lines[i].height; }\n    this.insertInner(at - this.first, lines, height);\n  },\n  remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n  // From here, the methods are part of the public interface. Most\n  // are also available from CodeMirror (editor) instances.\n\n  getValue: function(lineSep) {\n    var lines = getLines(this, this.first, this.first + this.size);\n    if (lineSep === false) { return lines }\n    return lines.join(lineSep || this.lineSeparator())\n  },\n  setValue: docMethodOp(function(code) {\n    var top = Pos(this.first, 0), last = this.first + this.size - 1;\n    makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                      text: this.splitLines(code), origin: \"setValue\", full: true}, true);\n    if (this.cm) { scrollToCoords(this.cm, 0, 0); }\n    setSelection(this, simpleSelection(top), sel_dontScroll);\n  }),\n  replaceRange: function(code, from, to, origin) {\n    from = clipPos(this, from);\n    to = to ? clipPos(this, to) : from;\n    replaceRange(this, code, from, to, origin);\n  },\n  getRange: function(from, to, lineSep) {\n    var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n    if (lineSep === false) { return lines }\n    return lines.join(lineSep || this.lineSeparator())\n  },\n\n  getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\n\n  getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\n  getLineNumber: function(line) {return lineNo(line)},\n\n  getLineHandleVisualStart: function(line) {\n    if (typeof line == \"number\") { line = getLine(this, line); }\n    return visualLine(line)\n  },\n\n  lineCount: function() {return this.size},\n  firstLine: function() {return this.first},\n  lastLine: function() {return this.first + this.size - 1},\n\n  clipPos: function(pos) {return clipPos(this, pos)},\n\n  getCursor: function(start) {\n    var range$$1 = this.sel.primary(), pos;\n    if (start == null || start == \"head\") { pos = range$$1.head; }\n    else if (start == \"anchor\") { pos = range$$1.anchor; }\n    else if (start == \"end\" || start == \"to\" || start === false) { pos = range$$1.to(); }\n    else { pos = range$$1.from(); }\n    return pos\n  },\n  listSelections: function() { return this.sel.ranges },\n  somethingSelected: function() {return this.sel.somethingSelected()},\n\n  setCursor: docMethodOp(function(line, ch, options) {\n    setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n  }),\n  setSelection: docMethodOp(function(anchor, head, options) {\n    setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n  }),\n  extendSelection: docMethodOp(function(head, other, options) {\n    extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n  }),\n  extendSelections: docMethodOp(function(heads, options) {\n    extendSelections(this, clipPosArray(this, heads), options);\n  }),\n  extendSelectionsBy: docMethodOp(function(f, options) {\n    var heads = map(this.sel.ranges, f);\n    extendSelections(this, clipPosArray(this, heads), options);\n  }),\n  setSelections: docMethodOp(function(ranges, primary, options) {\n    var this$1 = this;\n\n    if (!ranges.length) { return }\n    var out = [];\n    for (var i = 0; i < ranges.length; i++)\n      { out[i] = new Range(clipPos(this$1, ranges[i].anchor),\n                         clipPos(this$1, ranges[i].head)); }\n    if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex); }\n    setSelection(this, normalizeSelection(out, primary), options);\n  }),\n  addSelection: docMethodOp(function(anchor, head, options) {\n    var ranges = this.sel.ranges.slice(0);\n    ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n    setSelection(this, normalizeSelection(ranges, ranges.length - 1), options);\n  }),\n\n  getSelection: function(lineSep) {\n    var this$1 = this;\n\n    var ranges = this.sel.ranges, lines;\n    for (var i = 0; i < ranges.length; i++) {\n      var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n      lines = lines ? lines.concat(sel) : sel;\n    }\n    if (lineSep === false) { return lines }\n    else { return lines.join(lineSep || this.lineSeparator()) }\n  },\n  getSelections: function(lineSep) {\n    var this$1 = this;\n\n    var parts = [], ranges = this.sel.ranges;\n    for (var i = 0; i < ranges.length; i++) {\n      var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n      if (lineSep !== false) { sel = sel.join(lineSep || this$1.lineSeparator()); }\n      parts[i] = sel;\n    }\n    return parts\n  },\n  replaceSelection: function(code, collapse, origin) {\n    var dup = [];\n    for (var i = 0; i < this.sel.ranges.length; i++)\n      { dup[i] = code; }\n    this.replaceSelections(dup, collapse, origin || \"+input\");\n  },\n  replaceSelections: docMethodOp(function(code, collapse, origin) {\n    var this$1 = this;\n\n    var changes = [], sel = this.sel;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range$$1 = sel.ranges[i];\n      changes[i] = {from: range$$1.from(), to: range$$1.to(), text: this$1.splitLines(code[i]), origin: origin};\n    }\n    var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n    for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\n      { makeChange(this$1, changes[i$1]); }\n    if (newSel) { setSelectionReplaceHistory(this, newSel); }\n    else if (this.cm) { ensureCursorVisible(this.cm); }\n  }),\n  undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n  redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n  undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n  redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n  setExtending: function(val) {this.extend = val;},\n  getExtending: function() {return this.extend},\n\n  historySize: function() {\n    var hist = this.history, done = 0, undone = 0;\n    for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done; } }\n    for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone; } }\n    return {undo: done, redo: undone}\n  },\n  clearHistory: function() {this.history = new History(this.history.maxGeneration);},\n\n  markClean: function() {\n    this.cleanGeneration = this.changeGeneration(true);\n  },\n  changeGeneration: function(forceSplit) {\n    if (forceSplit)\n      { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null; }\n    return this.history.generation\n  },\n  isClean: function (gen) {\n    return this.history.generation == (gen || this.cleanGeneration)\n  },\n\n  getHistory: function() {\n    return {done: copyHistoryArray(this.history.done),\n            undone: copyHistoryArray(this.history.undone)}\n  },\n  setHistory: function(histData) {\n    var hist = this.history = new History(this.history.maxGeneration);\n    hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n    hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n  },\n\n  setGutterMarker: docMethodOp(function(line, gutterID, value) {\n    return changeLine(this, line, \"gutter\", function (line) {\n      var markers = line.gutterMarkers || (line.gutterMarkers = {});\n      markers[gutterID] = value;\n      if (!value && isEmpty(markers)) { line.gutterMarkers = null; }\n      return true\n    })\n  }),\n\n  clearGutter: docMethodOp(function(gutterID) {\n    var this$1 = this;\n\n    this.iter(function (line) {\n      if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n        changeLine(this$1, line, \"gutter\", function () {\n          line.gutterMarkers[gutterID] = null;\n          if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null; }\n          return true\n        });\n      }\n    });\n  }),\n\n  lineInfo: function(line) {\n    var n;\n    if (typeof line == \"number\") {\n      if (!isLine(this, line)) { return null }\n      n = line;\n      line = getLine(this, line);\n      if (!line) { return null }\n    } else {\n      n = lineNo(line);\n      if (n == null) { return null }\n    }\n    return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n            textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n            widgets: line.widgets}\n  },\n\n  addLineClass: docMethodOp(function(handle, where, cls) {\n    return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n      var prop = where == \"text\" ? \"textClass\"\n               : where == \"background\" ? \"bgClass\"\n               : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n      if (!line[prop]) { line[prop] = cls; }\n      else if (classTest(cls).test(line[prop])) { return false }\n      else { line[prop] += \" \" + cls; }\n      return true\n    })\n  }),\n  removeLineClass: docMethodOp(function(handle, where, cls) {\n    return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n      var prop = where == \"text\" ? \"textClass\"\n               : where == \"background\" ? \"bgClass\"\n               : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n      var cur = line[prop];\n      if (!cur) { return false }\n      else if (cls == null) { line[prop] = null; }\n      else {\n        var found = cur.match(classTest(cls));\n        if (!found) { return false }\n        var end = found.index + found[0].length;\n        line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n      }\n      return true\n    })\n  }),\n\n  addLineWidget: docMethodOp(function(handle, node, options) {\n    return addLineWidget(this, handle, node, options)\n  }),\n  removeLineWidget: function(widget) { widget.clear(); },\n\n  markText: function(from, to, options) {\n    return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\")\n  },\n  setBookmark: function(pos, options) {\n    var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                    insertLeft: options && options.insertLeft,\n                    clearWhenEmpty: false, shared: options && options.shared,\n                    handleMouseEvents: options && options.handleMouseEvents};\n    pos = clipPos(this, pos);\n    return markText(this, pos, pos, realOpts, \"bookmark\")\n  },\n  findMarksAt: function(pos) {\n    pos = clipPos(this, pos);\n    var markers = [], spans = getLine(this, pos.line).markedSpans;\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if ((span.from == null || span.from <= pos.ch) &&\n          (span.to == null || span.to >= pos.ch))\n        { markers.push(span.marker.parent || span.marker); }\n    } }\n    return markers\n  },\n  findMarks: function(from, to, filter) {\n    from = clipPos(this, from); to = clipPos(this, to);\n    var found = [], lineNo$$1 = from.line;\n    this.iter(from.line, to.line + 1, function (line) {\n      var spans = line.markedSpans;\n      if (spans) { for (var i = 0; i < spans.length; i++) {\n        var span = spans[i];\n        if (!(span.to != null && lineNo$$1 == from.line && from.ch >= span.to ||\n              span.from == null && lineNo$$1 != from.line ||\n              span.from != null && lineNo$$1 == to.line && span.from >= to.ch) &&\n            (!filter || filter(span.marker)))\n          { found.push(span.marker.parent || span.marker); }\n      } }\n      ++lineNo$$1;\n    });\n    return found\n  },\n  getAllMarks: function() {\n    var markers = [];\n    this.iter(function (line) {\n      var sps = line.markedSpans;\n      if (sps) { for (var i = 0; i < sps.length; ++i)\n        { if (sps[i].from != null) { markers.push(sps[i].marker); } } }\n    });\n    return markers\n  },\n\n  posFromIndex: function(off) {\n    var ch, lineNo$$1 = this.first, sepSize = this.lineSeparator().length;\n    this.iter(function (line) {\n      var sz = line.text.length + sepSize;\n      if (sz > off) { ch = off; return true }\n      off -= sz;\n      ++lineNo$$1;\n    });\n    return clipPos(this, Pos(lineNo$$1, ch))\n  },\n  indexFromPos: function (coords) {\n    coords = clipPos(this, coords);\n    var index = coords.ch;\n    if (coords.line < this.first || coords.ch < 0) { return 0 }\n    var sepSize = this.lineSeparator().length;\n    this.iter(this.first, coords.line, function (line) { // iter aborts when callback returns a truthy value\n      index += line.text.length + sepSize;\n    });\n    return index\n  },\n\n  copy: function(copyHistory) {\n    var doc = new Doc(getLines(this, this.first, this.first + this.size),\n                      this.modeOption, this.first, this.lineSep, this.direction);\n    doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n    doc.sel = this.sel;\n    doc.extend = false;\n    if (copyHistory) {\n      doc.history.undoDepth = this.history.undoDepth;\n      doc.setHistory(this.getHistory());\n    }\n    return doc\n  },\n\n  linkedDoc: function(options) {\n    if (!options) { options = {}; }\n    var from = this.first, to = this.first + this.size;\n    if (options.from != null && options.from > from) { from = options.from; }\n    if (options.to != null && options.to < to) { to = options.to; }\n    var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n    if (options.sharedHist) { copy.history = this.history\n    ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n    copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n    copySharedMarkers(copy, findSharedMarkers(this));\n    return copy\n  },\n  unlinkDoc: function(other) {\n    var this$1 = this;\n\n    if (other instanceof CodeMirror$1) { other = other.doc; }\n    if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\n      var link = this$1.linked[i];\n      if (link.doc != other) { continue }\n      this$1.linked.splice(i, 1);\n      other.unlinkDoc(this$1);\n      detachSharedMarkers(findSharedMarkers(this$1));\n      break\n    } }\n    // If the histories were shared, split them again\n    if (other.history == this.history) {\n      var splitIds = [other.id];\n      linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true);\n      other.history = new History(null);\n      other.history.done = copyHistoryArray(this.history.done, splitIds);\n      other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n    }\n  },\n  iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n  getMode: function() {return this.mode},\n  getEditor: function() {return this.cm},\n\n  splitLines: function(str) {\n    if (this.lineSep) { return str.split(this.lineSep) }\n    return splitLinesAuto(str)\n  },\n  lineSeparator: function() { return this.lineSep || \"\\n\" },\n\n  setDirection: docMethodOp(function (dir) {\n    if (dir != \"rtl\") { dir = \"ltr\"; }\n    if (dir == this.direction) { return }\n    this.direction = dir;\n    this.iter(function (line) { return line.order = null; });\n    if (this.cm) { directionChanged(this.cm); }\n  })\n});\n\n// Public alias.\nDoc.prototype.eachLine = Doc.prototype.iter;\n\n// Kludge to work around strange IE behavior where it'll sometimes\n// re-fire a series of drag-related events right after the drop (#1551)\nvar lastDrop = 0;\n\nfunction onDrop(e) {\n  var cm = this;\n  clearDragCursor(cm);\n  if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n    { return }\n  e_preventDefault(e);\n  if (ie) { lastDrop = +new Date; }\n  var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n  if (!pos || cm.isReadOnly()) { return }\n  // Might be a file drop, in which case we simply extract the text\n  // and insert it.\n  if (files && files.length && window.FileReader && window.File) {\n    var n = files.length, text = Array(n), read = 0;\n    var loadFile = function (file, i) {\n      if (cm.options.allowDropFileTypes &&\n          indexOf(cm.options.allowDropFileTypes, file.type) == -1)\n        { return }\n\n      var reader = new FileReader;\n      reader.onload = operation(cm, function () {\n        var content = reader.result;\n        if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) { content = \"\"; }\n        text[i] = content;\n        if (++read == n) {\n          pos = clipPos(cm.doc, pos);\n          var change = {from: pos, to: pos,\n                        text: cm.doc.splitLines(text.join(cm.doc.lineSeparator())),\n                        origin: \"paste\"};\n          makeChange(cm.doc, change);\n          setSelectionReplaceHistory(cm.doc, simpleSelection(pos, changeEnd(change)));\n        }\n      });\n      reader.readAsText(file);\n    };\n    for (var i = 0; i < n; ++i) { loadFile(files[i], i); }\n  } else { // Normal drop\n    // Don't do a replace if the drop happened inside of the selected text.\n    if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n      cm.state.draggingText(e);\n      // Ensure the editor is re-focused\n      setTimeout(function () { return cm.display.input.focus(); }, 20);\n      return\n    }\n    try {\n      var text$1 = e.dataTransfer.getData(\"Text\");\n      if (text$1) {\n        var selected;\n        if (cm.state.draggingText && !cm.state.draggingText.copy)\n          { selected = cm.listSelections(); }\n        setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n        if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\n          { replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\"); } }\n        cm.replaceSelection(text$1, \"around\", \"paste\");\n        cm.display.input.focus();\n      }\n    }\n    catch(e){}\n  }\n}\n\nfunction onDragStart(cm, e) {\n  if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\n  if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\n\n  e.dataTransfer.setData(\"Text\", cm.getSelection());\n  e.dataTransfer.effectAllowed = \"copyMove\";\n\n  // Use dummy image instead of default browsers image.\n  // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n  if (e.dataTransfer.setDragImage && !safari) {\n    var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n    img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n    if (presto) {\n      img.width = img.height = 1;\n      cm.display.wrapper.appendChild(img);\n      // Force a relayout, or Opera won't use our image for some obscure reason\n      img._top = img.offsetTop;\n    }\n    e.dataTransfer.setDragImage(img, 0, 0);\n    if (presto) { img.parentNode.removeChild(img); }\n  }\n}\n\nfunction onDragOver(cm, e) {\n  var pos = posFromMouse(cm, e);\n  if (!pos) { return }\n  var frag = document.createDocumentFragment();\n  drawSelectionCursor(cm, pos, frag);\n  if (!cm.display.dragCursor) {\n    cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n    cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n  }\n  removeChildrenAndAdd(cm.display.dragCursor, frag);\n}\n\nfunction clearDragCursor(cm) {\n  if (cm.display.dragCursor) {\n    cm.display.lineSpace.removeChild(cm.display.dragCursor);\n    cm.display.dragCursor = null;\n  }\n}\n\n// These must be handled carefully, because naively registering a\n// handler for each editor will cause the editors to never be\n// garbage collected.\n\nfunction forEachCodeMirror(f) {\n  if (!document.body.getElementsByClassName) { return }\n  var byClass = document.body.getElementsByClassName(\"CodeMirror\");\n  for (var i = 0; i < byClass.length; i++) {\n    var cm = byClass[i].CodeMirror;\n    if (cm) { f(cm); }\n  }\n}\n\nvar globalsRegistered = false;\nfunction ensureGlobalHandlers() {\n  if (globalsRegistered) { return }\n  registerGlobalHandlers();\n  globalsRegistered = true;\n}\nfunction registerGlobalHandlers() {\n  // When the window resizes, we need to refresh active editors.\n  var resizeTimer;\n  on(window, \"resize\", function () {\n    if (resizeTimer == null) { resizeTimer = setTimeout(function () {\n      resizeTimer = null;\n      forEachCodeMirror(onResize);\n    }, 100); }\n  });\n  // When the window loses focus, we want to show the editor as blurred\n  on(window, \"blur\", function () { return forEachCodeMirror(onBlur); });\n}\n// Called when the window resizes\nfunction onResize(cm) {\n  var d = cm.display;\n  if (d.lastWrapHeight == d.wrapper.clientHeight && d.lastWrapWidth == d.wrapper.clientWidth)\n    { return }\n  // Might be a text scaling operation, clear size caches.\n  d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n  d.scrollbarsClipped = false;\n  cm.setSize();\n}\n\nvar keyNames = {\n  3: \"Enter\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n  19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n  36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n  46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\n  106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 127: \"Delete\",\n  173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n  221: \"]\", 222: \"'\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n  63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\n};\n\n// Number keys\nfor (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i); }\n// Alphabetic keys\nfor (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1); }\n// Function keys\nfor (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2; }\n\nvar keyMap = {};\n\nkeyMap.basic = {\n  \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n  \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n  \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n  \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n  \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n  \"Esc\": \"singleSelection\"\n};\n// Note that the save and find-related commands aren't defined by\n// default. User code or addons can define them. Unknown commands\n// are simply ignored.\nkeyMap.pcDefault = {\n  \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n  \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n  \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n  \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n  \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n  \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n  \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n  fallthrough: \"basic\"\n};\n// Very basic readline/emacs-style bindings, which are standard on Mac.\nkeyMap.emacsy = {\n  \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n  \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\n  \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\n  \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\",\n  \"Ctrl-O\": \"openLine\"\n};\nkeyMap.macDefault = {\n  \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n  \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n  \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n  \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n  \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n  \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n  \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n  fallthrough: [\"basic\", \"emacsy\"]\n};\nkeyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n// KEYMAP DISPATCH\n\nfunction normalizeKeyName(name) {\n  var parts = name.split(/-(?!$)/);\n  name = parts[parts.length - 1];\n  var alt, ctrl, shift, cmd;\n  for (var i = 0; i < parts.length - 1; i++) {\n    var mod = parts[i];\n    if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true; }\n    else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n    else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n    else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n    else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n  }\n  if (alt) { name = \"Alt-\" + name; }\n  if (ctrl) { name = \"Ctrl-\" + name; }\n  if (cmd) { name = \"Cmd-\" + name; }\n  if (shift) { name = \"Shift-\" + name; }\n  return name\n}\n\n// This is a kludge to keep keymaps mostly working as raw objects\n// (backwards compatibility) while at the same time support features\n// like normalization and multi-stroke key bindings. It compiles a\n// new normalized keymap, and then updates the old object to reflect\n// this.\nfunction normalizeKeyMap(keymap) {\n  var copy = {};\n  for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\n    var value = keymap[keyname];\n    if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\n    if (value == \"...\") { delete keymap[keyname]; continue }\n\n    var keys = map(keyname.split(\" \"), normalizeKeyName);\n    for (var i = 0; i < keys.length; i++) {\n      var val = (void 0), name = (void 0);\n      if (i == keys.length - 1) {\n        name = keys.join(\" \");\n        val = value;\n      } else {\n        name = keys.slice(0, i + 1).join(\" \");\n        val = \"...\";\n      }\n      var prev = copy[name];\n      if (!prev) { copy[name] = val; }\n      else if (prev != val) { throw new Error(\"Inconsistent bindings for \" + name) }\n    }\n    delete keymap[keyname];\n  } }\n  for (var prop in copy) { keymap[prop] = copy[prop]; }\n  return keymap\n}\n\nfunction lookupKey(key, map$$1, handle, context) {\n  map$$1 = getKeyMap(map$$1);\n  var found = map$$1.call ? map$$1.call(key, context) : map$$1[key];\n  if (found === false) { return \"nothing\" }\n  if (found === \"...\") { return \"multi\" }\n  if (found != null && handle(found)) { return \"handled\" }\n\n  if (map$$1.fallthrough) {\n    if (Object.prototype.toString.call(map$$1.fallthrough) != \"[object Array]\")\n      { return lookupKey(key, map$$1.fallthrough, handle, context) }\n    for (var i = 0; i < map$$1.fallthrough.length; i++) {\n      var result = lookupKey(key, map$$1.fallthrough[i], handle, context);\n      if (result) { return result }\n    }\n  }\n}\n\n// Modifier key presses don't count as 'real' key presses for the\n// purpose of keymap fallthrough.\nfunction isModifierKey(value) {\n  var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n  return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\"\n}\n\n// Look up the name of a key as indicated by an event object.\nfunction keyName(event, noShift) {\n  if (presto && event.keyCode == 34 && event[\"char\"]) { return false }\n  var base = keyNames[event.keyCode], name = base;\n  if (name == null || event.altGraphKey) { return false }\n  if (event.altKey && base != \"Alt\") { name = \"Alt-\" + name; }\n  if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") { name = \"Ctrl-\" + name; }\n  if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Cmd\") { name = \"Cmd-\" + name; }\n  if (!noShift && event.shiftKey && base != \"Shift\") { name = \"Shift-\" + name; }\n  return name\n}\n\nfunction getKeyMap(val) {\n  return typeof val == \"string\" ? keyMap[val] : val\n}\n\n// Helper for deleting text near the selection(s), used to implement\n// backspace, delete, and similar functionality.\nfunction deleteNearSelection(cm, compute) {\n  var ranges = cm.doc.sel.ranges, kill = [];\n  // Build up a set of ranges to kill first, merging overlapping\n  // ranges.\n  for (var i = 0; i < ranges.length; i++) {\n    var toKill = compute(ranges[i]);\n    while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n      var replaced = kill.pop();\n      if (cmp(replaced.from, toKill.from) < 0) {\n        toKill.from = replaced.from;\n        break\n      }\n    }\n    kill.push(toKill);\n  }\n  // Next, remove those actual ranges.\n  runInOp(cm, function () {\n    for (var i = kill.length - 1; i >= 0; i--)\n      { replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\"); }\n    ensureCursorVisible(cm);\n  });\n}\n\n// Commands are parameter-less actions that can be performed on an\n// editor, mostly used for keybindings.\nvar commands = {\n  selectAll: selectAll,\n  singleSelection: function (cm) { return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll); },\n  killLine: function (cm) { return deleteNearSelection(cm, function (range) {\n    if (range.empty()) {\n      var len = getLine(cm.doc, range.head.line).text.length;\n      if (range.head.ch == len && range.head.line < cm.lastLine())\n        { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\n      else\n        { return {from: range.head, to: Pos(range.head.line, len)} }\n    } else {\n      return {from: range.from(), to: range.to()}\n    }\n  }); },\n  deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n    from: Pos(range.from().line, 0),\n    to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\n  }); }); },\n  delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n    from: Pos(range.from().line, 0), to: range.from()\n  }); }); },\n  delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n    return {from: leftPos, to: range.from()}\n  }); },\n  delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n    return {from: range.from(), to: rightPos }\n  }); },\n  undo: function (cm) { return cm.undo(); },\n  redo: function (cm) { return cm.redo(); },\n  undoSelection: function (cm) { return cm.undoSelection(); },\n  redoSelection: function (cm) { return cm.redoSelection(); },\n  goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\n  goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\n  goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\n    {origin: \"+move\", bias: 1}\n  ); },\n  goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\n    {origin: \"+move\", bias: 1}\n  ); },\n  goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\n    {origin: \"+move\", bias: -1}\n  ); },\n  goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\n  }, sel_move); },\n  goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    return cm.coordsChar({left: 0, top: top}, \"div\")\n  }, sel_move); },\n  goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n    if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\n    return pos\n  }, sel_move); },\n  goLineUp: function (cm) { return cm.moveV(-1, \"line\"); },\n  goLineDown: function (cm) { return cm.moveV(1, \"line\"); },\n  goPageUp: function (cm) { return cm.moveV(-1, \"page\"); },\n  goPageDown: function (cm) { return cm.moveV(1, \"page\"); },\n  goCharLeft: function (cm) { return cm.moveH(-1, \"char\"); },\n  goCharRight: function (cm) { return cm.moveH(1, \"char\"); },\n  goColumnLeft: function (cm) { return cm.moveH(-1, \"column\"); },\n  goColumnRight: function (cm) { return cm.moveH(1, \"column\"); },\n  goWordLeft: function (cm) { return cm.moveH(-1, \"word\"); },\n  goGroupRight: function (cm) { return cm.moveH(1, \"group\"); },\n  goGroupLeft: function (cm) { return cm.moveH(-1, \"group\"); },\n  goWordRight: function (cm) { return cm.moveH(1, \"word\"); },\n  delCharBefore: function (cm) { return cm.deleteH(-1, \"char\"); },\n  delCharAfter: function (cm) { return cm.deleteH(1, \"char\"); },\n  delWordBefore: function (cm) { return cm.deleteH(-1, \"word\"); },\n  delWordAfter: function (cm) { return cm.deleteH(1, \"word\"); },\n  delGroupBefore: function (cm) { return cm.deleteH(-1, \"group\"); },\n  delGroupAfter: function (cm) { return cm.deleteH(1, \"group\"); },\n  indentAuto: function (cm) { return cm.indentSelection(\"smart\"); },\n  indentMore: function (cm) { return cm.indentSelection(\"add\"); },\n  indentLess: function (cm) { return cm.indentSelection(\"subtract\"); },\n  insertTab: function (cm) { return cm.replaceSelection(\"\\t\"); },\n  insertSoftTab: function (cm) {\n    var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n    for (var i = 0; i < ranges.length; i++) {\n      var pos = ranges[i].from();\n      var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n      spaces.push(spaceStr(tabSize - col % tabSize));\n    }\n    cm.replaceSelections(spaces);\n  },\n  defaultTab: function (cm) {\n    if (cm.somethingSelected()) { cm.indentSelection(\"add\"); }\n    else { cm.execCommand(\"insertTab\"); }\n  },\n  // Swap the two chars left and right of each selection's head.\n  // Move cursor behind the two swapped characters afterwards.\n  //\n  // Doesn't consider line feeds a character.\n  // Doesn't scan more than one line above to find a character.\n  // Doesn't do anything on an empty line.\n  // Doesn't do anything with non-empty selections.\n  transposeChars: function (cm) { return runInOp(cm, function () {\n    var ranges = cm.listSelections(), newSel = [];\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) { continue }\n      var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n      if (line) {\n        if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1); }\n        if (cur.ch > 0) {\n          cur = new Pos(cur.line, cur.ch + 1);\n          cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                          Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n        } else if (cur.line > cm.doc.first) {\n          var prev = getLine(cm.doc, cur.line - 1).text;\n          if (prev) {\n            cur = new Pos(cur.line, 1);\n            cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\n                            prev.charAt(prev.length - 1),\n                            Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n          }\n        }\n      }\n      newSel.push(new Range(cur, cur));\n    }\n    cm.setSelections(newSel);\n  }); },\n  newlineAndIndent: function (cm) { return runInOp(cm, function () {\n    var sels = cm.listSelections();\n    for (var i = sels.length - 1; i >= 0; i--)\n      { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\"); }\n    sels = cm.listSelections();\n    for (var i$1 = 0; i$1 < sels.length; i$1++)\n      { cm.indentLine(sels[i$1].from().line, null, true); }\n    ensureCursorVisible(cm);\n  }); },\n  openLine: function (cm) { return cm.replaceSelection(\"\\n\", \"start\"); },\n  toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\n};\n\n\nfunction lineStart(cm, lineN) {\n  var line = getLine(cm.doc, lineN);\n  var visual = visualLine(line);\n  if (visual != line) { lineN = lineNo(visual); }\n  return endOfLine(true, cm, visual, lineN, 1)\n}\nfunction lineEnd(cm, lineN) {\n  var line = getLine(cm.doc, lineN);\n  var visual = visualLineEnd(line);\n  if (visual != line) { lineN = lineNo(visual); }\n  return endOfLine(true, cm, line, lineN, -1)\n}\nfunction lineStartSmart(cm, pos) {\n  var start = lineStart(cm, pos.line);\n  var line = getLine(cm.doc, start.line);\n  var order = getOrder(line, cm.doc.direction);\n  if (!order || order[0].level == 0) {\n    var firstNonWS = Math.max(0, line.text.search(/\\S/));\n    var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n    return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\n  }\n  return start\n}\n\n// Run a handler that was bound to a key.\nfunction doHandleBinding(cm, bound, dropShift) {\n  if (typeof bound == \"string\") {\n    bound = commands[bound];\n    if (!bound) { return false }\n  }\n  // Ensure previous input has been read, so that the handler sees a\n  // consistent view of the document\n  cm.display.input.ensurePolled();\n  var prevShift = cm.display.shift, done = false;\n  try {\n    if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n    if (dropShift) { cm.display.shift = false; }\n    done = bound(cm) != Pass;\n  } finally {\n    cm.display.shift = prevShift;\n    cm.state.suppressEdits = false;\n  }\n  return done\n}\n\nfunction lookupKeyForEditor(cm, name, handle) {\n  for (var i = 0; i < cm.state.keyMaps.length; i++) {\n    var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n    if (result) { return result }\n  }\n  return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\n    || lookupKey(name, cm.options.keyMap, handle, cm)\n}\n\nvar stopSeq = new Delayed;\nfunction dispatchKey(cm, name, e, handle) {\n  var seq = cm.state.keySeq;\n  if (seq) {\n    if (isModifierKey(name)) { return \"handled\" }\n    stopSeq.set(50, function () {\n      if (cm.state.keySeq == seq) {\n        cm.state.keySeq = null;\n        cm.display.input.reset();\n      }\n    });\n    name = seq + \" \" + name;\n  }\n  var result = lookupKeyForEditor(cm, name, handle);\n\n  if (result == \"multi\")\n    { cm.state.keySeq = name; }\n  if (result == \"handled\")\n    { signalLater(cm, \"keyHandled\", cm, name, e); }\n\n  if (result == \"handled\" || result == \"multi\") {\n    e_preventDefault(e);\n    restartBlink(cm);\n  }\n\n  if (seq && !result && /\\'$/.test(name)) {\n    e_preventDefault(e);\n    return true\n  }\n  return !!result\n}\n\n// Handle a key from the keydown event.\nfunction handleKeyBinding(cm, e) {\n  var name = keyName(e, true);\n  if (!name) { return false }\n\n  if (e.shiftKey && !cm.state.keySeq) {\n    // First try to resolve full name (including 'Shift-'). Failing\n    // that, see if there is a cursor-motion command (starting with\n    // 'go') bound to the keyname without 'Shift-'.\n    return dispatchKey(cm, \"Shift-\" + name, e, function (b) { return doHandleBinding(cm, b, true); })\n        || dispatchKey(cm, name, e, function (b) {\n             if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n               { return doHandleBinding(cm, b) }\n           })\n  } else {\n    return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\n  }\n}\n\n// Handle a key from the keypress event\nfunction handleCharBinding(cm, e, ch) {\n  return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) { return doHandleBinding(cm, b, true); })\n}\n\nvar lastStoppedKey = null;\nfunction onKeyDown(e) {\n  var cm = this;\n  cm.curOp.focus = activeElt();\n  if (signalDOMEvent(cm, e)) { return }\n  // IE does strange things with escape.\n  if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false; }\n  var code = e.keyCode;\n  cm.display.shift = code == 16 || e.shiftKey;\n  var handled = handleKeyBinding(cm, e);\n  if (presto) {\n    lastStoppedKey = handled ? code : null;\n    // Opera has no cut event... we try to at least catch the key combo\n    if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n      { cm.replaceSelection(\"\", null, \"cut\"); }\n  }\n\n  // Turn mouse into crosshair when Alt is held on Mac.\n  if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n    { showCrossHair(cm); }\n}\n\nfunction showCrossHair(cm) {\n  var lineDiv = cm.display.lineDiv;\n  addClass(lineDiv, \"CodeMirror-crosshair\");\n\n  function up(e) {\n    if (e.keyCode == 18 || !e.altKey) {\n      rmClass(lineDiv, \"CodeMirror-crosshair\");\n      off(document, \"keyup\", up);\n      off(document, \"mouseover\", up);\n    }\n  }\n  on(document, \"keyup\", up);\n  on(document, \"mouseover\", up);\n}\n\nfunction onKeyUp(e) {\n  if (e.keyCode == 16) { this.doc.sel.shift = false; }\n  signalDOMEvent(this, e);\n}\n\nfunction onKeyPress(e) {\n  var cm = this;\n  if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\n  var keyCode = e.keyCode, charCode = e.charCode;\n  if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\n  if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\n  var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n  // Some browsers fire keypress events for backspace\n  if (ch == \"\\x08\") { return }\n  if (handleCharBinding(cm, e, ch)) { return }\n  cm.display.input.onKeyPress(e);\n}\n\n// A mouse down can be a single click, double click, triple click,\n// start of selection drag, start of text drag, new cursor\n// (ctrl-click), rectangle drag (alt-drag), or xwin\n// middle-click-paste. Or it might be a click on something we should\n// not interfere with, such as a scrollbar or widget.\nfunction onMouseDown(e) {\n  var cm = this, display = cm.display;\n  if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\n  display.input.ensurePolled();\n  display.shift = e.shiftKey;\n\n  if (eventInWidget(display, e)) {\n    if (!webkit) {\n      // Briefly turn off draggability, to allow widgets to do\n      // normal dragging things.\n      display.scroller.draggable = false;\n      setTimeout(function () { return display.scroller.draggable = true; }, 100);\n    }\n    return\n  }\n  if (clickInGutter(cm, e)) { return }\n  var start = posFromMouse(cm, e);\n  window.focus();\n\n  switch (e_button(e)) {\n  case 1:\n    // #3261: make sure, that we're not starting a second selection\n    if (cm.state.selectingText)\n      { cm.state.selectingText(e); }\n    else if (start)\n      { leftButtonDown(cm, e, start); }\n    else if (e_target(e) == display.scroller)\n      { e_preventDefault(e); }\n    break\n  case 2:\n    if (webkit) { cm.state.lastMiddleDown = +new Date; }\n    if (start) { extendSelection(cm.doc, start); }\n    setTimeout(function () { return display.input.focus(); }, 20);\n    e_preventDefault(e);\n    break\n  case 3:\n    if (captureRightClick) { onContextMenu(cm, e); }\n    else { delayBlurEvent(cm); }\n    break\n  }\n}\n\nvar lastClick;\nvar lastDoubleClick;\nfunction leftButtonDown(cm, e, start) {\n  if (ie) { setTimeout(bind(ensureFocus, cm), 0); }\n  else { cm.curOp.focus = activeElt(); }\n\n  var now = +new Date, type;\n  if (lastDoubleClick && lastDoubleClick.time > now - 400 && cmp(lastDoubleClick.pos, start) == 0) {\n    type = \"triple\";\n  } else if (lastClick && lastClick.time > now - 400 && cmp(lastClick.pos, start) == 0) {\n    type = \"double\";\n    lastDoubleClick = {time: now, pos: start};\n  } else {\n    type = \"single\";\n    lastClick = {time: now, pos: start};\n  }\n\n  var sel = cm.doc.sel, modifier = mac ? e.metaKey : e.ctrlKey, contained;\n  if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\n      type == \"single\" && (contained = sel.contains(start)) > -1 &&\n      (cmp((contained = sel.ranges[contained]).from(), start) < 0 || start.xRel > 0) &&\n      (cmp(contained.to(), start) > 0 || start.xRel < 0))\n    { leftButtonStartDrag(cm, e, start, modifier); }\n  else\n    { leftButtonSelect(cm, e, start, type, modifier); }\n}\n\n// Start a text drag. When it ends, see if any dragging actually\n// happen, and treat as a click if it didn't.\nfunction leftButtonStartDrag(cm, e, start, modifier) {\n  var display = cm.display, moved = false;\n  var dragEnd = operation(cm, function (e) {\n    if (webkit) { display.scroller.draggable = false; }\n    cm.state.draggingText = false;\n    off(document, \"mouseup\", dragEnd);\n    off(document, \"mousemove\", mouseMove);\n    off(display.scroller, \"dragstart\", dragStart);\n    off(display.scroller, \"drop\", dragEnd);\n    if (!moved) {\n      e_preventDefault(e);\n      if (!modifier)\n        { extendSelection(cm.doc, start); }\n      // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n      if (webkit || ie && ie_version == 9)\n        { setTimeout(function () {document.body.focus(); display.input.focus();}, 20); }\n      else\n        { display.input.focus(); }\n    }\n  });\n  var mouseMove = function(e2) {\n    moved = moved || Math.abs(e.clientX - e2.clientX) + Math.abs(e.clientY - e2.clientY) >= 10;\n  };\n  var dragStart = function () { return moved = true; };\n  // Let the drag handler handle this.\n  if (webkit) { display.scroller.draggable = true; }\n  cm.state.draggingText = dragEnd;\n  dragEnd.copy = mac ? e.altKey : e.ctrlKey;\n  // IE's approach to draggable\n  if (display.scroller.dragDrop) { display.scroller.dragDrop(); }\n  on(document, \"mouseup\", dragEnd);\n  on(document, \"mousemove\", mouseMove);\n  on(display.scroller, \"dragstart\", dragStart);\n  on(display.scroller, \"drop\", dragEnd);\n\n  delayBlurEvent(cm);\n  setTimeout(function () { return display.input.focus(); }, 20);\n}\n\n// Normal selection, as opposed to text dragging.\nfunction leftButtonSelect(cm, e, start, type, addNew) {\n  var display = cm.display, doc = cm.doc;\n  e_preventDefault(e);\n\n  var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\n  if (addNew && !e.shiftKey) {\n    ourIndex = doc.sel.contains(start);\n    if (ourIndex > -1)\n      { ourRange = ranges[ourIndex]; }\n    else\n      { ourRange = new Range(start, start); }\n  } else {\n    ourRange = doc.sel.primary();\n    ourIndex = doc.sel.primIndex;\n  }\n\n  if (chromeOS ? e.shiftKey && e.metaKey : e.altKey) {\n    type = \"rect\";\n    if (!addNew) { ourRange = new Range(start, start); }\n    start = posFromMouse(cm, e, true, true);\n    ourIndex = -1;\n  } else if (type == \"double\") {\n    var word = cm.findWordAt(start);\n    if (cm.display.shift || doc.extend)\n      { ourRange = extendRange(doc, ourRange, word.anchor, word.head); }\n    else\n      { ourRange = word; }\n  } else if (type == \"triple\") {\n    var line = new Range(Pos(start.line, 0), clipPos(doc, Pos(start.line + 1, 0)));\n    if (cm.display.shift || doc.extend)\n      { ourRange = extendRange(doc, ourRange, line.anchor, line.head); }\n    else\n      { ourRange = line; }\n  } else {\n    ourRange = extendRange(doc, ourRange, start);\n  }\n\n  if (!addNew) {\n    ourIndex = 0;\n    setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n    startSel = doc.sel;\n  } else if (ourIndex == -1) {\n    ourIndex = ranges.length;\n    setSelection(doc, normalizeSelection(ranges.concat([ourRange]), ourIndex),\n                 {scroll: false, origin: \"*mouse\"});\n  } else if (ranges.length > 1 && ranges[ourIndex].empty() && type == \"single\" && !e.shiftKey) {\n    setSelection(doc, normalizeSelection(ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\n                 {scroll: false, origin: \"*mouse\"});\n    startSel = doc.sel;\n  } else {\n    replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n  }\n\n  var lastPos = start;\n  function extendTo(pos) {\n    if (cmp(lastPos, pos) == 0) { return }\n    lastPos = pos;\n\n    if (type == \"rect\") {\n      var ranges = [], tabSize = cm.options.tabSize;\n      var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n      var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n      var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n      for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n           line <= end; line++) {\n        var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n        if (left == right)\n          { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))); }\n        else if (text.length > leftPos)\n          { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))); }\n      }\n      if (!ranges.length) { ranges.push(new Range(start, start)); }\n      setSelection(doc, normalizeSelection(startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                   {origin: \"*mouse\", scroll: false});\n      cm.scrollIntoView(pos);\n    } else {\n      var oldRange = ourRange;\n      var anchor = oldRange.anchor, head = pos;\n      if (type != \"single\") {\n        var range$$1;\n        if (type == \"double\")\n          { range$$1 = cm.findWordAt(pos); }\n        else\n          { range$$1 = new Range(Pos(pos.line, 0), clipPos(doc, Pos(pos.line + 1, 0))); }\n        if (cmp(range$$1.anchor, anchor) > 0) {\n          head = range$$1.head;\n          anchor = minPos(oldRange.from(), range$$1.anchor);\n        } else {\n          head = range$$1.anchor;\n          anchor = maxPos(oldRange.to(), range$$1.head);\n        }\n      }\n      var ranges$1 = startSel.ranges.slice(0);\n      ranges$1[ourIndex] = new Range(clipPos(doc, anchor), head);\n      setSelection(doc, normalizeSelection(ranges$1, ourIndex), sel_mouse);\n    }\n  }\n\n  var editorSize = display.wrapper.getBoundingClientRect();\n  // Used to ensure timeout re-tries don't fire when another extend\n  // happened in the meantime (clearTimeout isn't reliable -- at\n  // least on Chrome, the timeouts still happen even when cleared,\n  // if the clear happens after their scheduled firing time).\n  var counter = 0;\n\n  function extend(e) {\n    var curCount = ++counter;\n    var cur = posFromMouse(cm, e, true, type == \"rect\");\n    if (!cur) { return }\n    if (cmp(cur, lastPos) != 0) {\n      cm.curOp.focus = activeElt();\n      extendTo(cur);\n      var visible = visibleLines(display, doc);\n      if (cur.line >= visible.to || cur.line < visible.from)\n        { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e); }}), 150); }\n    } else {\n      var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n      if (outside) { setTimeout(operation(cm, function () {\n        if (counter != curCount) { return }\n        display.scroller.scrollTop += outside;\n        extend(e);\n      }), 50); }\n    }\n  }\n\n  function done(e) {\n    cm.state.selectingText = false;\n    counter = Infinity;\n    e_preventDefault(e);\n    display.input.focus();\n    off(document, \"mousemove\", move);\n    off(document, \"mouseup\", up);\n    doc.history.lastSelOrigin = null;\n  }\n\n  var move = operation(cm, function (e) {\n    if (!e_button(e)) { done(e); }\n    else { extend(e); }\n  });\n  var up = operation(cm, done);\n  cm.state.selectingText = up;\n  on(document, \"mousemove\", move);\n  on(document, \"mouseup\", up);\n}\n\n\n// Determines whether an event happened in the gutter, and fires the\n// handlers for the corresponding event.\nfunction gutterEvent(cm, e, type, prevent) {\n  var mX, mY;\n  try { mX = e.clientX; mY = e.clientY; }\n  catch(e) { return false }\n  if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\n  if (prevent) { e_preventDefault(e); }\n\n  var display = cm.display;\n  var lineBox = display.lineDiv.getBoundingClientRect();\n\n  if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\n  mY -= lineBox.top - display.viewOffset;\n\n  for (var i = 0; i < cm.options.gutters.length; ++i) {\n    var g = display.gutters.childNodes[i];\n    if (g && g.getBoundingClientRect().right >= mX) {\n      var line = lineAtHeight(cm.doc, mY);\n      var gutter = cm.options.gutters[i];\n      signal(cm, type, cm, line, gutter, e);\n      return e_defaultPrevented(e)\n    }\n  }\n}\n\nfunction clickInGutter(cm, e) {\n  return gutterEvent(cm, e, \"gutterClick\", true)\n}\n\n// CONTEXT MENU HANDLING\n\n// To make the context menu work, we need to briefly unhide the\n// textarea (making it as unobtrusive as possible) to let the\n// right-click take effect on it.\nfunction onContextMenu(cm, e) {\n  if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\n  if (signalDOMEvent(cm, e, \"contextmenu\")) { return }\n  cm.display.input.onContextMenu(e);\n}\n\nfunction contextMenuInGutter(cm, e) {\n  if (!hasHandler(cm, \"gutterContextMenu\")) { return false }\n  return gutterEvent(cm, e, \"gutterContextMenu\", false)\n}\n\nfunction themeChanged(cm) {\n  cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n    cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n  clearCaches(cm);\n}\n\nvar Init = {toString: function(){return \"CodeMirror.Init\"}};\n\nvar defaults = {};\nvar optionHandlers = {};\n\nfunction defineOptions(CodeMirror) {\n  var optionHandlers = CodeMirror.optionHandlers;\n\n  function option(name, deflt, handle, notOnInit) {\n    CodeMirror.defaults[name] = deflt;\n    if (handle) { optionHandlers[name] =\n      notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old); }} : handle; }\n  }\n\n  CodeMirror.defineOption = option;\n\n  // Passed to option handlers when there is no old value.\n  CodeMirror.Init = Init;\n\n  // These two are, on init, called from the constructor because they\n  // have to be initialized before the editor can start at all.\n  option(\"value\", \"\", function (cm, val) { return cm.setValue(val); }, true);\n  option(\"mode\", null, function (cm, val) {\n    cm.doc.modeOption = val;\n    loadMode(cm);\n  }, true);\n\n  option(\"indentUnit\", 2, loadMode, true);\n  option(\"indentWithTabs\", false);\n  option(\"smartIndent\", true);\n  option(\"tabSize\", 4, function (cm) {\n    resetModeState(cm);\n    clearCaches(cm);\n    regChange(cm);\n  }, true);\n  option(\"lineSeparator\", null, function (cm, val) {\n    cm.doc.lineSep = val;\n    if (!val) { return }\n    var newBreaks = [], lineNo = cm.doc.first;\n    cm.doc.iter(function (line) {\n      for (var pos = 0;;) {\n        var found = line.text.indexOf(val, pos);\n        if (found == -1) { break }\n        pos = found + val.length;\n        newBreaks.push(Pos(lineNo, found));\n      }\n      lineNo++;\n    });\n    for (var i = newBreaks.length - 1; i >= 0; i--)\n      { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)); }\n  });\n  option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200f\\u2028\\u2029\\ufeff]/g, function (cm, val, old) {\n    cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n    if (old != Init) { cm.refresh(); }\n  });\n  option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true);\n  option(\"electricChars\", true);\n  option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n    throw new Error(\"inputStyle can not (yet) be changed in a running editor\") // FIXME\n  }, true);\n  option(\"spellcheck\", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true);\n  option(\"rtlMoveVisually\", !windows);\n  option(\"wholeLineUpdateBefore\", true);\n\n  option(\"theme\", \"default\", function (cm) {\n    themeChanged(cm);\n    guttersChanged(cm);\n  }, true);\n  option(\"keyMap\", \"default\", function (cm, val, old) {\n    var next = getKeyMap(val);\n    var prev = old != Init && getKeyMap(old);\n    if (prev && prev.detach) { prev.detach(cm, next); }\n    if (next.attach) { next.attach(cm, prev || null); }\n  });\n  option(\"extraKeys\", null);\n\n  option(\"lineWrapping\", false, wrappingChanged, true);\n  option(\"gutters\", [], function (cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"fixedGutter\", true, function (cm, val) {\n    cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n    cm.refresh();\n  }, true);\n  option(\"coverGutterNextToScrollbar\", false, function (cm) { return updateScrollbars(cm); }, true);\n  option(\"scrollbarStyle\", \"native\", function (cm) {\n    initScrollbars(cm);\n    updateScrollbars(cm);\n    cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n    cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n  }, true);\n  option(\"lineNumbers\", false, function (cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"firstLineNumber\", 1, guttersChanged, true);\n  option(\"lineNumberFormatter\", function (integer) { return integer; }, guttersChanged, true);\n  option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n  option(\"resetSelectionOnContextMenu\", true);\n  option(\"lineWiseCopyCut\", true);\n\n  option(\"readOnly\", false, function (cm, val) {\n    if (val == \"nocursor\") {\n      onBlur(cm);\n      cm.display.input.blur();\n      cm.display.disabled = true;\n    } else {\n      cm.display.disabled = false;\n    }\n    cm.display.input.readOnlyChanged(val);\n  });\n  option(\"disableInput\", false, function (cm, val) {if (!val) { cm.display.input.reset(); }}, true);\n  option(\"dragDrop\", true, dragDropChanged);\n  option(\"allowDropFileTypes\", null);\n\n  option(\"cursorBlinkRate\", 530);\n  option(\"cursorScrollMargin\", 0);\n  option(\"cursorHeight\", 1, updateSelection, true);\n  option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n  option(\"workTime\", 100);\n  option(\"workDelay\", 100);\n  option(\"flattenSpans\", true, resetModeState, true);\n  option(\"addModeClass\", false, resetModeState, true);\n  option(\"pollInterval\", 100);\n  option(\"undoDepth\", 200, function (cm, val) { return cm.doc.history.undoDepth = val; });\n  option(\"historyEventDelay\", 1250);\n  option(\"viewportMargin\", 10, function (cm) { return cm.refresh(); }, true);\n  option(\"maxHighlightLength\", 10000, resetModeState, true);\n  option(\"moveInputWithCursor\", true, function (cm, val) {\n    if (!val) { cm.display.input.resetPosition(); }\n  });\n\n  option(\"tabindex\", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || \"\"; });\n  option(\"autofocus\", null);\n  option(\"direction\", \"ltr\", function (cm, val) { return cm.doc.setDirection(val); }, true);\n}\n\nfunction guttersChanged(cm) {\n  updateGutters(cm);\n  regChange(cm);\n  alignHorizontally(cm);\n}\n\nfunction dragDropChanged(cm, value, old) {\n  var wasOn = old && old != Init;\n  if (!value != !wasOn) {\n    var funcs = cm.display.dragFunctions;\n    var toggle = value ? on : off;\n    toggle(cm.display.scroller, \"dragstart\", funcs.start);\n    toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n    toggle(cm.display.scroller, \"dragover\", funcs.over);\n    toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n    toggle(cm.display.scroller, \"drop\", funcs.drop);\n  }\n}\n\nfunction wrappingChanged(cm) {\n  if (cm.options.lineWrapping) {\n    addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n    cm.display.sizer.style.minWidth = \"\";\n    cm.display.sizerWidth = null;\n  } else {\n    rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n    findMaxLine(cm);\n  }\n  estimateLineHeights(cm);\n  regChange(cm);\n  clearCaches(cm);\n  setTimeout(function () { return updateScrollbars(cm); }, 100);\n}\n\n// A CodeMirror instance represents an editor. This is the object\n// that user code is usually dealing with.\n\nfunction CodeMirror$1(place, options) {\n  var this$1 = this;\n\n  if (!(this instanceof CodeMirror$1)) { return new CodeMirror$1(place, options) }\n\n  this.options = options = options ? copyObj(options) : {};\n  // Determine effective options based on given values and defaults.\n  copyObj(defaults, options, false);\n  setGuttersForLineNumbers(options);\n\n  var doc = options.value;\n  if (typeof doc == \"string\") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction); }\n  this.doc = doc;\n\n  var input = new CodeMirror$1.inputStyles[options.inputStyle](this);\n  var display = this.display = new Display(place, doc, input);\n  display.wrapper.CodeMirror = this;\n  updateGutters(this);\n  themeChanged(this);\n  if (options.lineWrapping)\n    { this.display.wrapper.className += \" CodeMirror-wrap\"; }\n  initScrollbars(this);\n\n  this.state = {\n    keyMaps: [],  // stores maps added by addKeyMap\n    overlays: [], // highlighting overlays, as added by addOverlay\n    modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n    overwrite: false,\n    delayingBlurEvent: false,\n    focused: false,\n    suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n    pasteIncoming: false, cutIncoming: false, // help recognize paste/cut edits in input.poll\n    selectingText: false,\n    draggingText: false,\n    highlight: new Delayed(), // stores highlight worker timeout\n    keySeq: null,  // Unfinished key sequence\n    specialChars: null\n  };\n\n  if (options.autofocus && !mobile) { display.input.focus(); }\n\n  // Override magic textarea content restore that IE sometimes does\n  // on our hidden textarea on reload\n  if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20); }\n\n  registerEventHandlers(this);\n  ensureGlobalHandlers();\n\n  startOperation(this);\n  this.curOp.forceUpdate = true;\n  attachDoc(this, doc);\n\n  if ((options.autofocus && !mobile) || this.hasFocus())\n    { setTimeout(bind(onFocus, this), 20); }\n  else\n    { onBlur(this); }\n\n  for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\n    { optionHandlers[opt](this$1, options[opt], Init); } }\n  maybeUpdateLineNumberWidth(this);\n  if (options.finishInit) { options.finishInit(this); }\n  for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this$1); }\n  endOperation(this);\n  // Suppress optimizelegibility in Webkit, since it breaks text\n  // measuring on line wrapping boundaries.\n  if (webkit && options.lineWrapping &&\n      getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n    { display.lineDiv.style.textRendering = \"auto\"; }\n}\n\n// The default configuration options.\nCodeMirror$1.defaults = defaults;\n// Functions to run when options are changed.\nCodeMirror$1.optionHandlers = optionHandlers;\n\n// Attach the necessary event handlers when initializing the editor\nfunction registerEventHandlers(cm) {\n  var d = cm.display;\n  on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n  // Older IE's will not fire a second mousedown for a double click\n  if (ie && ie_version < 11)\n    { on(d.scroller, \"dblclick\", operation(cm, function (e) {\n      if (signalDOMEvent(cm, e)) { return }\n      var pos = posFromMouse(cm, e);\n      if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\n      e_preventDefault(e);\n      var word = cm.findWordAt(pos);\n      extendSelection(cm.doc, word.anchor, word.head);\n    })); }\n  else\n    { on(d.scroller, \"dblclick\", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }); }\n  // Some browsers fire contextmenu *after* opening the menu, at\n  // which point we can't mess with it anymore. Context menu is\n  // handled in onMouseDown for these browsers.\n  if (!captureRightClick) { on(d.scroller, \"contextmenu\", function (e) { return onContextMenu(cm, e); }); }\n\n  // Used to suppress mouse event handling when a touch happens\n  var touchFinished, prevTouch = {end: 0};\n  function finishTouch() {\n    if (d.activeTouch) {\n      touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000);\n      prevTouch = d.activeTouch;\n      prevTouch.end = +new Date;\n    }\n  }\n  function isMouseLikeTouchEvent(e) {\n    if (e.touches.length != 1) { return false }\n    var touch = e.touches[0];\n    return touch.radiusX <= 1 && touch.radiusY <= 1\n  }\n  function farAway(touch, other) {\n    if (other.left == null) { return true }\n    var dx = other.left - touch.left, dy = other.top - touch.top;\n    return dx * dx + dy * dy > 20 * 20\n  }\n  on(d.scroller, \"touchstart\", function (e) {\n    if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e)) {\n      d.input.ensurePolled();\n      clearTimeout(touchFinished);\n      var now = +new Date;\n      d.activeTouch = {start: now, moved: false,\n                       prev: now - prevTouch.end <= 300 ? prevTouch : null};\n      if (e.touches.length == 1) {\n        d.activeTouch.left = e.touches[0].pageX;\n        d.activeTouch.top = e.touches[0].pageY;\n      }\n    }\n  });\n  on(d.scroller, \"touchmove\", function () {\n    if (d.activeTouch) { d.activeTouch.moved = true; }\n  });\n  on(d.scroller, \"touchend\", function (e) {\n    var touch = d.activeTouch;\n    if (touch && !eventInWidget(d, e) && touch.left != null &&\n        !touch.moved && new Date - touch.start < 300) {\n      var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n      if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n        { range = new Range(pos, pos); }\n      else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n        { range = cm.findWordAt(pos); }\n      else // Triple tap\n        { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))); }\n      cm.setSelection(range.anchor, range.head);\n      cm.focus();\n      e_preventDefault(e);\n    }\n    finishTouch();\n  });\n  on(d.scroller, \"touchcancel\", finishTouch);\n\n  // Sync scrolling between fake scrollbars and real scrollable\n  // area, ensure viewport is updated when scrolling.\n  on(d.scroller, \"scroll\", function () {\n    if (d.scroller.clientHeight) {\n      updateScrollTop(cm, d.scroller.scrollTop);\n      setScrollLeft(cm, d.scroller.scrollLeft, true);\n      signal(cm, \"scroll\", cm);\n    }\n  });\n\n  // Listen to wheel events in order to try and update the viewport on time.\n  on(d.scroller, \"mousewheel\", function (e) { return onScrollWheel(cm, e); });\n  on(d.scroller, \"DOMMouseScroll\", function (e) { return onScrollWheel(cm, e); });\n\n  // Prevent wrapper from ever scrolling\n  on(d.wrapper, \"scroll\", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n  d.dragFunctions = {\n    enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e); }},\n    over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n    start: function (e) { return onDragStart(cm, e); },\n    drop: operation(cm, onDrop),\n    leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\n  };\n\n  var inp = d.input.getField();\n  on(inp, \"keyup\", function (e) { return onKeyUp.call(cm, e); });\n  on(inp, \"keydown\", operation(cm, onKeyDown));\n  on(inp, \"keypress\", operation(cm, onKeyPress));\n  on(inp, \"focus\", function (e) { return onFocus(cm, e); });\n  on(inp, \"blur\", function (e) { return onBlur(cm, e); });\n}\n\nvar initHooks = [];\nCodeMirror$1.defineInitHook = function (f) { return initHooks.push(f); };\n\n// Indent the given line. The how parameter can be \"smart\",\n// \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n// (typically set to true for forced single-line indents), empty\n// lines are not indented, and places where the mode returns Pass\n// are left alone.\nfunction indentLine(cm, n, how, aggressive) {\n  var doc = cm.doc, state;\n  if (how == null) { how = \"add\"; }\n  if (how == \"smart\") {\n    // Fall back to \"prev\" when the mode doesn't have an indentation\n    // method.\n    if (!doc.mode.indent) { how = \"prev\"; }\n    else { state = getStateBefore(cm, n); }\n  }\n\n  var tabSize = cm.options.tabSize;\n  var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n  if (line.stateAfter) { line.stateAfter = null; }\n  var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n  if (!aggressive && !/\\S/.test(line.text)) {\n    indentation = 0;\n    how = \"not\";\n  } else if (how == \"smart\") {\n    indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n    if (indentation == Pass || indentation > 150) {\n      if (!aggressive) { return }\n      how = \"prev\";\n    }\n  }\n  if (how == \"prev\") {\n    if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize); }\n    else { indentation = 0; }\n  } else if (how == \"add\") {\n    indentation = curSpace + cm.options.indentUnit;\n  } else if (how == \"subtract\") {\n    indentation = curSpace - cm.options.indentUnit;\n  } else if (typeof how == \"number\") {\n    indentation = curSpace + how;\n  }\n  indentation = Math.max(0, indentation);\n\n  var indentString = \"\", pos = 0;\n  if (cm.options.indentWithTabs)\n    { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";} }\n  if (pos < indentation) { indentString += spaceStr(indentation - pos); }\n\n  if (indentString != curSpaceString) {\n    replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n    line.stateAfter = null;\n    return true\n  } else {\n    // Ensure that, if the cursor was in the whitespace at the start\n    // of the line, it is moved to the end of that space.\n    for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n      var range = doc.sel.ranges[i$1];\n      if (range.head.line == n && range.head.ch < curSpaceString.length) {\n        var pos$1 = Pos(n, curSpaceString.length);\n        replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n        break\n      }\n    }\n  }\n}\n\n// This will be set to a {lineWise: bool, text: [string]} object, so\n// that, when pasting, we know what kind of selections the copied\n// text was made out of.\nvar lastCopied = null;\n\nfunction setLastCopied(newLastCopied) {\n  lastCopied = newLastCopied;\n}\n\nfunction applyTextInput(cm, inserted, deleted, sel, origin) {\n  var doc = cm.doc;\n  cm.display.shift = false;\n  if (!sel) { sel = doc.sel; }\n\n  var paste = cm.state.pasteIncoming || origin == \"paste\";\n  var textLines = splitLinesAuto(inserted), multiPaste = null;\n  // When pasing N lines into N selections, insert one line per selection\n  if (paste && sel.ranges.length > 1) {\n    if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n      if (sel.ranges.length % lastCopied.text.length == 0) {\n        multiPaste = [];\n        for (var i = 0; i < lastCopied.text.length; i++)\n          { multiPaste.push(doc.splitLines(lastCopied.text[i])); }\n      }\n    } else if (textLines.length == sel.ranges.length) {\n      multiPaste = map(textLines, function (l) { return [l]; });\n    }\n  }\n\n  var updateInput;\n  // Normal behavior is to insert the new text into every selection\n  for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n    var range$$1 = sel.ranges[i$1];\n    var from = range$$1.from(), to = range$$1.to();\n    if (range$$1.empty()) {\n      if (deleted && deleted > 0) // Handle deletion\n        { from = Pos(from.line, from.ch - deleted); }\n      else if (cm.state.overwrite && !paste) // Handle overwrite\n        { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)); }\n      else if (lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == inserted)\n        { from = to = Pos(from.line, 0); }\n    }\n    updateInput = cm.curOp.updateInput;\n    var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n                       origin: origin || (paste ? \"paste\" : cm.state.cutIncoming ? \"cut\" : \"+input\")};\n    makeChange(cm.doc, changeEvent);\n    signalLater(cm, \"inputRead\", cm, changeEvent);\n  }\n  if (inserted && !paste)\n    { triggerElectric(cm, inserted); }\n\n  ensureCursorVisible(cm);\n  cm.curOp.updateInput = updateInput;\n  cm.curOp.typing = true;\n  cm.state.pasteIncoming = cm.state.cutIncoming = false;\n}\n\nfunction handlePaste(e, cm) {\n  var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n  if (pasted) {\n    e.preventDefault();\n    if (!cm.isReadOnly() && !cm.options.disableInput)\n      { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, \"paste\"); }); }\n    return true\n  }\n}\n\nfunction triggerElectric(cm, inserted) {\n  // When an 'electric' character is inserted, immediately trigger a reindent\n  if (!cm.options.electricChars || !cm.options.smartIndent) { return }\n  var sel = cm.doc.sel;\n\n  for (var i = sel.ranges.length - 1; i >= 0; i--) {\n    var range$$1 = sel.ranges[i];\n    if (range$$1.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range$$1.head.line)) { continue }\n    var mode = cm.getModeAt(range$$1.head);\n    var indented = false;\n    if (mode.electricChars) {\n      for (var j = 0; j < mode.electricChars.length; j++)\n        { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n          indented = indentLine(cm, range$$1.head.line, \"smart\");\n          break\n        } }\n    } else if (mode.electricInput) {\n      if (mode.electricInput.test(getLine(cm.doc, range$$1.head.line).text.slice(0, range$$1.head.ch)))\n        { indented = indentLine(cm, range$$1.head.line, \"smart\"); }\n    }\n    if (indented) { signalLater(cm, \"electricInput\", cm, range$$1.head.line); }\n  }\n}\n\nfunction copyableRanges(cm) {\n  var text = [], ranges = [];\n  for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n    var line = cm.doc.sel.ranges[i].head.line;\n    var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n    ranges.push(lineRange);\n    text.push(cm.getRange(lineRange.anchor, lineRange.head));\n  }\n  return {text: text, ranges: ranges}\n}\n\nfunction disableBrowserMagic(field, spellcheck) {\n  field.setAttribute(\"autocorrect\", \"off\");\n  field.setAttribute(\"autocapitalize\", \"off\");\n  field.setAttribute(\"spellcheck\", !!spellcheck);\n}\n\nfunction hiddenTextarea() {\n  var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\");\n  var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n  // The textarea is kept positioned near the cursor to prevent the\n  // fact that it'll be scrolled into view on input from scrolling\n  // our fake cursor out of view. On webkit, when wrap=off, paste is\n  // very slow. So make the area wide instead.\n  if (webkit) { te.style.width = \"1000px\"; }\n  else { te.setAttribute(\"wrap\", \"off\"); }\n  // If border: 0; -- iOS fails to open keyboard (issue #1287)\n  if (ios) { te.style.border = \"1px solid black\"; }\n  disableBrowserMagic(te);\n  return div\n}\n\n// The publicly visible API. Note that methodOp(f) means\n// 'wrap f in an operation, performed on its `this` parameter'.\n\n// This is not the complete set of editor methods. Most of the\n// methods defined on the Doc type are also injected into\n// CodeMirror.prototype, for backwards compatibility and\n// convenience.\n\nvar addEditorMethods = function(CodeMirror) {\n  var optionHandlers = CodeMirror.optionHandlers;\n\n  var helpers = CodeMirror.helpers = {};\n\n  CodeMirror.prototype = {\n    constructor: CodeMirror,\n    focus: function(){window.focus(); this.display.input.focus();},\n\n    setOption: function(option, value) {\n      var options = this.options, old = options[option];\n      if (options[option] == value && option != \"mode\") { return }\n      options[option] = value;\n      if (optionHandlers.hasOwnProperty(option))\n        { operation(this, optionHandlers[option])(this, value, old); }\n      signal(this, \"optionChange\", this, option);\n    },\n\n    getOption: function(option) {return this.options[option]},\n    getDoc: function() {return this.doc},\n\n    addKeyMap: function(map$$1, bottom) {\n      this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map$$1));\n    },\n    removeKeyMap: function(map$$1) {\n      var maps = this.state.keyMaps;\n      for (var i = 0; i < maps.length; ++i)\n        { if (maps[i] == map$$1 || maps[i].name == map$$1) {\n          maps.splice(i, 1);\n          return true\n        } }\n    },\n\n    addOverlay: methodOp(function(spec, options) {\n      var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n      if (mode.startState) { throw new Error(\"Overlays may not be stateful.\") }\n      insertSorted(this.state.overlays,\n                   {mode: mode, modeSpec: spec, opaque: options && options.opaque,\n                    priority: (options && options.priority) || 0},\n                   function (overlay) { return overlay.priority; });\n      this.state.modeGen++;\n      regChange(this);\n    }),\n    removeOverlay: methodOp(function(spec) {\n      var this$1 = this;\n\n      var overlays = this.state.overlays;\n      for (var i = 0; i < overlays.length; ++i) {\n        var cur = overlays[i].modeSpec;\n        if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n          overlays.splice(i, 1);\n          this$1.state.modeGen++;\n          regChange(this$1);\n          return\n        }\n      }\n    }),\n\n    indentLine: methodOp(function(n, dir, aggressive) {\n      if (typeof dir != \"string\" && typeof dir != \"number\") {\n        if (dir == null) { dir = this.options.smartIndent ? \"smart\" : \"prev\"; }\n        else { dir = dir ? \"add\" : \"subtract\"; }\n      }\n      if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive); }\n    }),\n    indentSelection: methodOp(function(how) {\n      var this$1 = this;\n\n      var ranges = this.doc.sel.ranges, end = -1;\n      for (var i = 0; i < ranges.length; i++) {\n        var range$$1 = ranges[i];\n        if (!range$$1.empty()) {\n          var from = range$$1.from(), to = range$$1.to();\n          var start = Math.max(end, from.line);\n          end = Math.min(this$1.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n          for (var j = start; j < end; ++j)\n            { indentLine(this$1, j, how); }\n          var newRanges = this$1.doc.sel.ranges;\n          if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n            { replaceOneSelection(this$1.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll); }\n        } else if (range$$1.head.line > end) {\n          indentLine(this$1, range$$1.head.line, how, true);\n          end = range$$1.head.line;\n          if (i == this$1.doc.sel.primIndex) { ensureCursorVisible(this$1); }\n        }\n      }\n    }),\n\n    // Fetch the parser token for a given character. Useful for hacks\n    // that want to inspect the mode state (say, for completion).\n    getTokenAt: function(pos, precise) {\n      return takeToken(this, pos, precise)\n    },\n\n    getLineTokens: function(line, precise) {\n      return takeToken(this, Pos(line), precise, true)\n    },\n\n    getTokenTypeAt: function(pos) {\n      pos = clipPos(this.doc, pos);\n      var styles = getLineStyles(this, getLine(this.doc, pos.line));\n      var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n      var type;\n      if (ch == 0) { type = styles[2]; }\n      else { for (;;) {\n        var mid = (before + after) >> 1;\n        if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid; }\n        else if (styles[mid * 2 + 1] < ch) { before = mid + 1; }\n        else { type = styles[mid * 2 + 2]; break }\n      } }\n      var cut = type ? type.indexOf(\"overlay \") : -1;\n      return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\n    },\n\n    getModeAt: function(pos) {\n      var mode = this.doc.mode;\n      if (!mode.innerMode) { return mode }\n      return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\n    },\n\n    getHelper: function(pos, type) {\n      return this.getHelpers(pos, type)[0]\n    },\n\n    getHelpers: function(pos, type) {\n      var this$1 = this;\n\n      var found = [];\n      if (!helpers.hasOwnProperty(type)) { return found }\n      var help = helpers[type], mode = this.getModeAt(pos);\n      if (typeof mode[type] == \"string\") {\n        if (help[mode[type]]) { found.push(help[mode[type]]); }\n      } else if (mode[type]) {\n        for (var i = 0; i < mode[type].length; i++) {\n          var val = help[mode[type][i]];\n          if (val) { found.push(val); }\n        }\n      } else if (mode.helperType && help[mode.helperType]) {\n        found.push(help[mode.helperType]);\n      } else if (help[mode.name]) {\n        found.push(help[mode.name]);\n      }\n      for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n        var cur = help._global[i$1];\n        if (cur.pred(mode, this$1) && indexOf(found, cur.val) == -1)\n          { found.push(cur.val); }\n      }\n      return found\n    },\n\n    getStateAfter: function(line, precise) {\n      var doc = this.doc;\n      line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n      return getStateBefore(this, line + 1, precise)\n    },\n\n    cursorCoords: function(start, mode) {\n      var pos, range$$1 = this.doc.sel.primary();\n      if (start == null) { pos = range$$1.head; }\n      else if (typeof start == \"object\") { pos = clipPos(this.doc, start); }\n      else { pos = start ? range$$1.from() : range$$1.to(); }\n      return cursorCoords(this, pos, mode || \"page\")\n    },\n\n    charCoords: function(pos, mode) {\n      return charCoords(this, clipPos(this.doc, pos), mode || \"page\")\n    },\n\n    coordsChar: function(coords, mode) {\n      coords = fromCoordSystem(this, coords, mode || \"page\");\n      return coordsChar(this, coords.left, coords.top)\n    },\n\n    lineAtHeight: function(height, mode) {\n      height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n      return lineAtHeight(this.doc, height + this.display.viewOffset)\n    },\n    heightAtLine: function(line, mode, includeWidgets) {\n      var end = false, lineObj;\n      if (typeof line == \"number\") {\n        var last = this.doc.first + this.doc.size - 1;\n        if (line < this.doc.first) { line = this.doc.first; }\n        else if (line > last) { line = last; end = true; }\n        lineObj = getLine(this.doc, line);\n      } else {\n        lineObj = line;\n      }\n      return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\", includeWidgets || end).top +\n        (end ? this.doc.height - heightAtLine(lineObj) : 0)\n    },\n\n    defaultTextHeight: function() { return textHeight(this.display) },\n    defaultCharWidth: function() { return charWidth(this.display) },\n\n    getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\n\n    addWidget: function(pos, node, scroll, vert, horiz) {\n      var display = this.display;\n      pos = cursorCoords(this, clipPos(this.doc, pos));\n      var top = pos.bottom, left = pos.left;\n      node.style.position = \"absolute\";\n      node.setAttribute(\"cm-ignore-events\", \"true\");\n      this.display.input.setUneditable(node);\n      display.sizer.appendChild(node);\n      if (vert == \"over\") {\n        top = pos.top;\n      } else if (vert == \"above\" || vert == \"near\") {\n        var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n        hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n        // Default to positioning above (if specified and possible); otherwise default to positioning below\n        if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n          { top = pos.top - node.offsetHeight; }\n        else if (pos.bottom + node.offsetHeight <= vspace)\n          { top = pos.bottom; }\n        if (left + node.offsetWidth > hspace)\n          { left = hspace - node.offsetWidth; }\n      }\n      node.style.top = top + \"px\";\n      node.style.left = node.style.right = \"\";\n      if (horiz == \"right\") {\n        left = display.sizer.clientWidth - node.offsetWidth;\n        node.style.right = \"0px\";\n      } else {\n        if (horiz == \"left\") { left = 0; }\n        else if (horiz == \"middle\") { left = (display.sizer.clientWidth - node.offsetWidth) / 2; }\n        node.style.left = left + \"px\";\n      }\n      if (scroll)\n        { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}); }\n    },\n\n    triggerOnKeyDown: methodOp(onKeyDown),\n    triggerOnKeyPress: methodOp(onKeyPress),\n    triggerOnKeyUp: onKeyUp,\n\n    execCommand: function(cmd) {\n      if (commands.hasOwnProperty(cmd))\n        { return commands[cmd].call(null, this) }\n    },\n\n    triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n    findPosH: function(from, amount, unit, visually) {\n      var this$1 = this;\n\n      var dir = 1;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      var cur = clipPos(this.doc, from);\n      for (var i = 0; i < amount; ++i) {\n        cur = findPosH(this$1.doc, cur, dir, unit, visually);\n        if (cur.hitSide) { break }\n      }\n      return cur\n    },\n\n    moveH: methodOp(function(dir, unit) {\n      var this$1 = this;\n\n      this.extendSelectionsBy(function (range$$1) {\n        if (this$1.display.shift || this$1.doc.extend || range$$1.empty())\n          { return findPosH(this$1.doc, range$$1.head, dir, unit, this$1.options.rtlMoveVisually) }\n        else\n          { return dir < 0 ? range$$1.from() : range$$1.to() }\n      }, sel_move);\n    }),\n\n    deleteH: methodOp(function(dir, unit) {\n      var sel = this.doc.sel, doc = this.doc;\n      if (sel.somethingSelected())\n        { doc.replaceSelection(\"\", null, \"+delete\"); }\n      else\n        { deleteNearSelection(this, function (range$$1) {\n          var other = findPosH(doc, range$$1.head, dir, unit, false);\n          return dir < 0 ? {from: other, to: range$$1.head} : {from: range$$1.head, to: other}\n        }); }\n    }),\n\n    findPosV: function(from, amount, unit, goalColumn) {\n      var this$1 = this;\n\n      var dir = 1, x = goalColumn;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      var cur = clipPos(this.doc, from);\n      for (var i = 0; i < amount; ++i) {\n        var coords = cursorCoords(this$1, cur, \"div\");\n        if (x == null) { x = coords.left; }\n        else { coords.left = x; }\n        cur = findPosV(this$1, coords, dir, unit);\n        if (cur.hitSide) { break }\n      }\n      return cur\n    },\n\n    moveV: methodOp(function(dir, unit) {\n      var this$1 = this;\n\n      var doc = this.doc, goals = [];\n      var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n      doc.extendSelectionsBy(function (range$$1) {\n        if (collapse)\n          { return dir < 0 ? range$$1.from() : range$$1.to() }\n        var headPos = cursorCoords(this$1, range$$1.head, \"div\");\n        if (range$$1.goalColumn != null) { headPos.left = range$$1.goalColumn; }\n        goals.push(headPos.left);\n        var pos = findPosV(this$1, headPos, dir, unit);\n        if (unit == \"page\" && range$$1 == doc.sel.primary())\n          { addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top); }\n        return pos\n      }, sel_move);\n      if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\n        { doc.sel.ranges[i].goalColumn = goals[i]; } }\n    }),\n\n    // Find the word at the given position (as returned by coordsChar).\n    findWordAt: function(pos) {\n      var doc = this.doc, line = getLine(doc, pos.line).text;\n      var start = pos.ch, end = pos.ch;\n      if (line) {\n        var helper = this.getHelper(pos, \"wordChars\");\n        if ((pos.sticky == \"before\" || end == line.length) && start) { --start; } else { ++end; }\n        var startChar = line.charAt(start);\n        var check = isWordChar(startChar, helper)\n          ? function (ch) { return isWordChar(ch, helper); }\n          : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\n          : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); };\n        while (start > 0 && check(line.charAt(start - 1))) { --start; }\n        while (end < line.length && check(line.charAt(end))) { ++end; }\n      }\n      return new Range(Pos(pos.line, start), Pos(pos.line, end))\n    },\n\n    toggleOverwrite: function(value) {\n      if (value != null && value == this.state.overwrite) { return }\n      if (this.state.overwrite = !this.state.overwrite)\n        { addClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n      else\n        { rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n\n      signal(this, \"overwriteToggle\", this, this.state.overwrite);\n    },\n    hasFocus: function() { return this.display.input.getField() == activeElt() },\n    isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\n\n    scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y); }),\n    getScrollInfo: function() {\n      var scroller = this.display.scroller;\n      return {left: scroller.scrollLeft, top: scroller.scrollTop,\n              height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n              width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n              clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\n    },\n\n    scrollIntoView: methodOp(function(range$$1, margin) {\n      if (range$$1 == null) {\n        range$$1 = {from: this.doc.sel.primary().head, to: null};\n        if (margin == null) { margin = this.options.cursorScrollMargin; }\n      } else if (typeof range$$1 == \"number\") {\n        range$$1 = {from: Pos(range$$1, 0), to: null};\n      } else if (range$$1.from == null) {\n        range$$1 = {from: range$$1, to: null};\n      }\n      if (!range$$1.to) { range$$1.to = range$$1.from; }\n      range$$1.margin = margin || 0;\n\n      if (range$$1.from.line != null) {\n        scrollToRange(this, range$$1);\n      } else {\n        scrollToCoordsRange(this, range$$1.from, range$$1.to, range$$1.margin);\n      }\n    }),\n\n    setSize: methodOp(function(width, height) {\n      var this$1 = this;\n\n      var interpret = function (val) { return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val; };\n      if (width != null) { this.display.wrapper.style.width = interpret(width); }\n      if (height != null) { this.display.wrapper.style.height = interpret(height); }\n      if (this.options.lineWrapping) { clearLineMeasurementCache(this); }\n      var lineNo$$1 = this.display.viewFrom;\n      this.doc.iter(lineNo$$1, this.display.viewTo, function (line) {\n        if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\n          { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo$$1, \"widget\"); break } } }\n        ++lineNo$$1;\n      });\n      this.curOp.forceUpdate = true;\n      signal(this, \"refresh\", this);\n    }),\n\n    operation: function(f){return runInOp(this, f)},\n\n    refresh: methodOp(function() {\n      var oldHeight = this.display.cachedTextHeight;\n      regChange(this);\n      this.curOp.forceUpdate = true;\n      clearCaches(this);\n      scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n      updateGutterSpace(this);\n      if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5)\n        { estimateLineHeights(this); }\n      signal(this, \"refresh\", this);\n    }),\n\n    swapDoc: methodOp(function(doc) {\n      var old = this.doc;\n      old.cm = null;\n      attachDoc(this, doc);\n      clearCaches(this);\n      this.display.input.reset();\n      scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n      this.curOp.forceScroll = true;\n      signalLater(this, \"swapDoc\", this, old);\n      return old\n    }),\n\n    getInputField: function(){return this.display.input.getField()},\n    getWrapperElement: function(){return this.display.wrapper},\n    getScrollerElement: function(){return this.display.scroller},\n    getGutterElement: function(){return this.display.gutters}\n  };\n  eventMixin(CodeMirror);\n\n  CodeMirror.registerHelper = function(type, name, value) {\n    if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []}; }\n    helpers[type][name] = value;\n  };\n  CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n    CodeMirror.registerHelper(type, name, value);\n    helpers[type]._global.push({pred: predicate, val: value});\n  };\n};\n\n// Used for horizontal relative motion. Dir is -1 or 1 (left or\n// right), unit can be \"char\", \"column\" (like char, but doesn't\n// cross line boundaries), \"word\" (across next word), or \"group\" (to\n// the start of next group of word or non-word-non-whitespace\n// chars). The visually param controls whether, in right-to-left\n// text, direction 1 means to move towards the next index in the\n// string, or towards the character to the right of the current\n// position. The resulting position will have a hitSide=true\n// property if it reached the end of the document.\nfunction findPosH(doc, pos, dir, unit, visually) {\n  var oldPos = pos;\n  var origDir = dir;\n  var lineObj = getLine(doc, pos.line);\n  function findNextLine() {\n    var l = pos.line + dir;\n    if (l < doc.first || l >= doc.first + doc.size) { return false }\n    pos = new Pos(l, pos.ch, pos.sticky);\n    return lineObj = getLine(doc, l)\n  }\n  function moveOnce(boundToLine) {\n    var next;\n    if (visually) {\n      next = moveVisually(doc.cm, lineObj, pos, dir);\n    } else {\n      next = moveLogically(lineObj, pos, dir);\n    }\n    if (next == null) {\n      if (!boundToLine && findNextLine())\n        { pos = endOfLine(visually, doc.cm, lineObj, pos.line, dir); }\n      else\n        { return false }\n    } else {\n      pos = next;\n    }\n    return true\n  }\n\n  if (unit == \"char\") {\n    moveOnce();\n  } else if (unit == \"column\") {\n    moveOnce(true);\n  } else if (unit == \"word\" || unit == \"group\") {\n    var sawType = null, group = unit == \"group\";\n    var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n    for (var first = true;; first = false) {\n      if (dir < 0 && !moveOnce(!first)) { break }\n      var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n      var type = isWordChar(cur, helper) ? \"w\"\n        : group && cur == \"\\n\" ? \"n\"\n        : !group || /\\s/.test(cur) ? null\n        : \"p\";\n      if (group && !first && !type) { type = \"s\"; }\n      if (sawType && sawType != type) {\n        if (dir < 0) {dir = 1; moveOnce(); pos.sticky = \"after\";}\n        break\n      }\n\n      if (type) { sawType = type; }\n      if (dir > 0 && !moveOnce(!first)) { break }\n    }\n  }\n  var result = skipAtomic(doc, pos, oldPos, origDir, true);\n  if (equalCursorPos(oldPos, result)) { result.hitSide = true; }\n  return result\n}\n\n// For relative vertical movement. Dir may be -1 or 1. Unit can be\n// \"page\" or \"line\". The resulting position will have a hitSide=true\n// property if it reached the end of the document.\nfunction findPosV(cm, pos, dir, unit) {\n  var doc = cm.doc, x = pos.left, y;\n  if (unit == \"page\") {\n    var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n    var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n    y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n\n  } else if (unit == \"line\") {\n    y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n  }\n  var target;\n  for (;;) {\n    target = coordsChar(cm, x, y);\n    if (!target.outside) { break }\n    if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\n    y += dir * 5;\n  }\n  return target\n}\n\n// CONTENTEDITABLE INPUT STYLE\n\nvar ContentEditableInput = function(cm) {\n  this.cm = cm;\n  this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n  this.polling = new Delayed();\n  this.composing = null;\n  this.gracePeriod = false;\n  this.readDOMTimeout = null;\n};\n\nContentEditableInput.prototype.init = function (display) {\n    var this$1 = this;\n\n  var input = this, cm = input.cm;\n  var div = input.div = display.lineDiv;\n  disableBrowserMagic(div, cm.options.spellcheck);\n\n  on(div, \"paste\", function (e) {\n    if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n    // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n    if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20); }\n  });\n\n  on(div, \"compositionstart\", function (e) {\n    this$1.composing = {data: e.data, done: false};\n  });\n  on(div, \"compositionupdate\", function (e) {\n    if (!this$1.composing) { this$1.composing = {data: e.data, done: false}; }\n  });\n  on(div, \"compositionend\", function (e) {\n    if (this$1.composing) {\n      if (e.data != this$1.composing.data) { this$1.readFromDOMSoon(); }\n      this$1.composing.done = true;\n    }\n  });\n\n  on(div, \"touchstart\", function () { return input.forceCompositionEnd(); });\n\n  on(div, \"input\", function () {\n    if (!this$1.composing) { this$1.readFromDOMSoon(); }\n  });\n\n  function onCopyCut(e) {\n    if (signalDOMEvent(cm, e)) { return }\n    if (cm.somethingSelected()) {\n      setLastCopied({lineWise: false, text: cm.getSelections()});\n      if (e.type == \"cut\") { cm.replaceSelection(\"\", null, \"cut\"); }\n    } else if (!cm.options.lineWiseCopyCut) {\n      return\n    } else {\n      var ranges = copyableRanges(cm);\n      setLastCopied({lineWise: true, text: ranges.text});\n      if (e.type == \"cut\") {\n        cm.operation(function () {\n          cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n          cm.replaceSelection(\"\", null, \"cut\");\n        });\n      }\n    }\n    if (e.clipboardData) {\n      e.clipboardData.clearData();\n      var content = lastCopied.text.join(\"\\n\");\n      // iOS exposes the clipboard API, but seems to discard content inserted into it\n      e.clipboardData.setData(\"Text\", content);\n      if (e.clipboardData.getData(\"Text\") == content) {\n        e.preventDefault();\n        return\n      }\n    }\n    // Old-fashioned briefly-focus-a-textarea hack\n    var kludge = hiddenTextarea(), te = kludge.firstChild;\n    cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n    te.value = lastCopied.text.join(\"\\n\");\n    var hadFocus = document.activeElement;\n    selectInput(te);\n    setTimeout(function () {\n      cm.display.lineSpace.removeChild(kludge);\n      hadFocus.focus();\n      if (hadFocus == div) { input.showPrimarySelection(); }\n    }, 50);\n  }\n  on(div, \"copy\", onCopyCut);\n  on(div, \"cut\", onCopyCut);\n};\n\nContentEditableInput.prototype.prepareSelection = function () {\n  var result = prepareSelection(this.cm, false);\n  result.focus = this.cm.state.focused;\n  return result\n};\n\nContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n  if (!info || !this.cm.display.view.length) { return }\n  if (info.focus || takeFocus) { this.showPrimarySelection(); }\n  this.showMultipleSelections(info);\n};\n\nContentEditableInput.prototype.showPrimarySelection = function () {\n  var sel = window.getSelection(), cm = this.cm, prim = cm.doc.sel.primary();\n  var from = prim.from(), to = prim.to();\n\n  if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n    sel.removeAllRanges();\n    return\n  }\n\n  var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n  var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n  if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\n      cmp(minPos(curAnchor, curFocus), from) == 0 &&\n      cmp(maxPos(curAnchor, curFocus), to) == 0)\n    { return }\n\n  var view = cm.display.view;\n  var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\n      {node: view[0].measure.map[2], offset: 0};\n  var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n  if (!end) {\n    var measure = view[view.length - 1].measure;\n    var map$$1 = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n    end = {node: map$$1[map$$1.length - 1], offset: map$$1[map$$1.length - 2] - map$$1[map$$1.length - 3]};\n  }\n\n  if (!start || !end) {\n    sel.removeAllRanges();\n    return\n  }\n\n  var old = sel.rangeCount && sel.getRangeAt(0), rng;\n  try { rng = range(start.node, start.offset, end.offset, end.node); }\n  catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n  if (rng) {\n    if (!gecko && cm.state.focused) {\n      sel.collapse(start.node, start.offset);\n      if (!rng.collapsed) {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n      }\n    } else {\n      sel.removeAllRanges();\n      sel.addRange(rng);\n    }\n    if (old && sel.anchorNode == null) { sel.addRange(old); }\n    else if (gecko) { this.startGracePeriod(); }\n  }\n  this.rememberSelection();\n};\n\nContentEditableInput.prototype.startGracePeriod = function () {\n    var this$1 = this;\n\n  clearTimeout(this.gracePeriod);\n  this.gracePeriod = setTimeout(function () {\n    this$1.gracePeriod = false;\n    if (this$1.selectionChanged())\n      { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }); }\n  }, 20);\n};\n\nContentEditableInput.prototype.showMultipleSelections = function (info) {\n  removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n  removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n};\n\nContentEditableInput.prototype.rememberSelection = function () {\n  var sel = window.getSelection();\n  this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\n  this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\n};\n\nContentEditableInput.prototype.selectionInEditor = function () {\n  var sel = window.getSelection();\n  if (!sel.rangeCount) { return false }\n  var node = sel.getRangeAt(0).commonAncestorContainer;\n  return contains(this.div, node)\n};\n\nContentEditableInput.prototype.focus = function () {\n  if (this.cm.options.readOnly != \"nocursor\") {\n    if (!this.selectionInEditor())\n      { this.showSelection(this.prepareSelection(), true); }\n    this.div.focus();\n  }\n};\nContentEditableInput.prototype.blur = function () { this.div.blur(); };\nContentEditableInput.prototype.getField = function () { return this.div };\n\nContentEditableInput.prototype.supportsTouch = function () { return true };\n\nContentEditableInput.prototype.receivedFocus = function () {\n  var input = this;\n  if (this.selectionInEditor())\n    { this.pollSelection(); }\n  else\n    { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }); }\n\n  function poll() {\n    if (input.cm.state.focused) {\n      input.pollSelection();\n      input.polling.set(input.cm.options.pollInterval, poll);\n    }\n  }\n  this.polling.set(this.cm.options.pollInterval, poll);\n};\n\nContentEditableInput.prototype.selectionChanged = function () {\n  var sel = window.getSelection();\n  return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\n    sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\n};\n\nContentEditableInput.prototype.pollSelection = function () {\n  if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\n  var sel = window.getSelection(), cm = this.cm;\n  // On Android Chrome (version 56, at least), backspacing into an\n  // uneditable block element will put the cursor in that element,\n  // and then, because it's not editable, hide the virtual keyboard.\n  // Because Android doesn't allow us to actually detect backspace\n  // presses in a sane way, this code checks for when that happens\n  // and simulates a backspace press in this case.\n  if (android && chrome && this.cm.options.gutters.length && isInGutter(sel.anchorNode)) {\n    this.cm.triggerOnKeyDown({type: \"keydown\", keyCode: 8, preventDefault: Math.abs});\n    this.blur();\n    this.focus();\n    return\n  }\n  if (this.composing) { return }\n  this.rememberSelection();\n  var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n  var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n  if (anchor && head) { runInOp(cm, function () {\n    setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n    if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true; }\n  }); }\n};\n\nContentEditableInput.prototype.pollContent = function () {\n  if (this.readDOMTimeout != null) {\n    clearTimeout(this.readDOMTimeout);\n    this.readDOMTimeout = null;\n  }\n\n  var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\n  var from = sel.from(), to = sel.to();\n  if (from.ch == 0 && from.line > cm.firstLine())\n    { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length); }\n  if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\n    { to = Pos(to.line + 1, 0); }\n  if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\n\n  var fromIndex, fromLine, fromNode;\n  if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n    fromLine = lineNo(display.view[0].line);\n    fromNode = display.view[0].node;\n  } else {\n    fromLine = lineNo(display.view[fromIndex].line);\n    fromNode = display.view[fromIndex - 1].node.nextSibling;\n  }\n  var toIndex = findViewIndex(cm, to.line);\n  var toLine, toNode;\n  if (toIndex == display.view.length - 1) {\n    toLine = display.viewTo - 1;\n    toNode = display.lineDiv.lastChild;\n  } else {\n    toLine = lineNo(display.view[toIndex + 1].line) - 1;\n    toNode = display.view[toIndex + 1].node.previousSibling;\n  }\n\n  if (!fromNode) { return false }\n  var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n  var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n  while (newText.length > 1 && oldText.length > 1) {\n    if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\n    else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\n    else { break }\n  }\n\n  var cutFront = 0, cutEnd = 0;\n  var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\n  while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\n    { ++cutFront; }\n  var newBot = lst(newText), oldBot = lst(oldText);\n  var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\n                           oldBot.length - (oldText.length == 1 ? cutFront : 0));\n  while (cutEnd < maxCutEnd &&\n         newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\n    { ++cutEnd; }\n  // Try to move start of change to start of selection if ambiguous\n  if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n    while (cutFront && cutFront > from.ch &&\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n      cutFront--;\n      cutEnd++;\n    }\n  }\n\n  newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n  newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n\n  var chFrom = Pos(fromLine, cutFront);\n  var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n  if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n    replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n    return true\n  }\n};\n\nContentEditableInput.prototype.ensurePolled = function () {\n  this.forceCompositionEnd();\n};\nContentEditableInput.prototype.reset = function () {\n  this.forceCompositionEnd();\n};\nContentEditableInput.prototype.forceCompositionEnd = function () {\n  if (!this.composing) { return }\n  clearTimeout(this.readDOMTimeout);\n  this.composing = null;\n  this.updateFromDOM();\n  this.div.blur();\n  this.div.focus();\n};\nContentEditableInput.prototype.readFromDOMSoon = function () {\n    var this$1 = this;\n\n  if (this.readDOMTimeout != null) { return }\n  this.readDOMTimeout = setTimeout(function () {\n    this$1.readDOMTimeout = null;\n    if (this$1.composing) {\n      if (this$1.composing.done) { this$1.composing = null; }\n      else { return }\n    }\n    this$1.updateFromDOM();\n  }, 80);\n};\n\nContentEditableInput.prototype.updateFromDOM = function () {\n    var this$1 = this;\n\n  if (this.cm.isReadOnly() || !this.pollContent())\n    { runInOp(this.cm, function () { return regChange(this$1.cm); }); }\n};\n\nContentEditableInput.prototype.setUneditable = function (node) {\n  node.contentEditable = \"false\";\n};\n\nContentEditableInput.prototype.onKeyPress = function (e) {\n  if (e.charCode == 0) { return }\n  e.preventDefault();\n  if (!this.cm.isReadOnly())\n    { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0); }\n};\n\nContentEditableInput.prototype.readOnlyChanged = function (val) {\n  this.div.contentEditable = String(val != \"nocursor\");\n};\n\nContentEditableInput.prototype.onContextMenu = function () {};\nContentEditableInput.prototype.resetPosition = function () {};\n\nContentEditableInput.prototype.needsContentAttribute = true;\n\nfunction posToDOM(cm, pos) {\n  var view = findViewForLine(cm, pos.line);\n  if (!view || view.hidden) { return null }\n  var line = getLine(cm.doc, pos.line);\n  var info = mapFromLineView(view, line, pos.line);\n\n  var order = getOrder(line, cm.doc.direction), side = \"left\";\n  if (order) {\n    var partPos = getBidiPartAt(order, pos.ch);\n    side = partPos % 2 ? \"right\" : \"left\";\n  }\n  var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n  result.offset = result.collapse == \"right\" ? result.end : result.start;\n  return result\n}\n\nfunction isInGutter(node) {\n  for (var scan = node; scan; scan = scan.parentNode)\n    { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\n  return false\n}\n\nfunction badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\n\nfunction domTextBetween(cm, from, to, fromLine, toLine) {\n  var text = \"\", closing = false, lineSep = cm.doc.lineSeparator();\n  function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\n  function close() {\n    if (closing) {\n      text += lineSep;\n      closing = false;\n    }\n  }\n  function addText(str) {\n    if (str) {\n      close();\n      text += str;\n    }\n  }\n  function walk(node) {\n    if (node.nodeType == 1) {\n      var cmText = node.getAttribute(\"cm-text\");\n      if (cmText != null) {\n        addText(cmText || node.textContent.replace(/\\u200b/g, \"\"));\n        return\n      }\n      var markerID = node.getAttribute(\"cm-marker\"), range$$1;\n      if (markerID) {\n        var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n        if (found.length && (range$$1 = found[0].find()))\n          { addText(getBetween(cm.doc, range$$1.from, range$$1.to).join(lineSep)); }\n        return\n      }\n      if (node.getAttribute(\"contenteditable\") == \"false\") { return }\n      var isBlock = /^(pre|div|p)$/i.test(node.nodeName);\n      if (isBlock) { close(); }\n      for (var i = 0; i < node.childNodes.length; i++)\n        { walk(node.childNodes[i]); }\n      if (isBlock) { closing = true; }\n    } else if (node.nodeType == 3) {\n      addText(node.nodeValue);\n    }\n  }\n  for (;;) {\n    walk(from);\n    if (from == to) { break }\n    from = from.nextSibling;\n  }\n  return text\n}\n\nfunction domToPos(cm, node, offset) {\n  var lineNode;\n  if (node == cm.display.lineDiv) {\n    lineNode = cm.display.lineDiv.childNodes[offset];\n    if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\n    node = null; offset = 0;\n  } else {\n    for (lineNode = node;; lineNode = lineNode.parentNode) {\n      if (!lineNode || lineNode == cm.display.lineDiv) { return null }\n      if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\n    }\n  }\n  for (var i = 0; i < cm.display.view.length; i++) {\n    var lineView = cm.display.view[i];\n    if (lineView.node == lineNode)\n      { return locateNodeInLineView(lineView, node, offset) }\n  }\n}\n\nfunction locateNodeInLineView(lineView, node, offset) {\n  var wrapper = lineView.text.firstChild, bad = false;\n  if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\n  if (node == wrapper) {\n    bad = true;\n    node = wrapper.childNodes[offset];\n    offset = 0;\n    if (!node) {\n      var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n      return badPos(Pos(lineNo(line), line.text.length), bad)\n    }\n  }\n\n  var textNode = node.nodeType == 3 ? node : null, topNode = node;\n  if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n    textNode = node.firstChild;\n    if (offset) { offset = textNode.nodeValue.length; }\n  }\n  while (topNode.parentNode != wrapper) { topNode = topNode.parentNode; }\n  var measure = lineView.measure, maps = measure.maps;\n\n  function find(textNode, topNode, offset) {\n    for (var i = -1; i < (maps ? maps.length : 0); i++) {\n      var map$$1 = i < 0 ? measure.map : maps[i];\n      for (var j = 0; j < map$$1.length; j += 3) {\n        var curNode = map$$1[j + 2];\n        if (curNode == textNode || curNode == topNode) {\n          var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n          var ch = map$$1[j] + offset;\n          if (offset < 0 || curNode != textNode) { ch = map$$1[j + (offset ? 1 : 0)]; }\n          return Pos(line, ch)\n        }\n      }\n    }\n  }\n  var found = find(textNode, topNode, offset);\n  if (found) { return badPos(found, bad) }\n\n  // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n  for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n    found = find(after, after.firstChild, 0);\n    if (found)\n      { return badPos(Pos(found.line, found.ch - dist), bad) }\n    else\n      { dist += after.textContent.length; }\n  }\n  for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n    found = find(before, before.firstChild, -1);\n    if (found)\n      { return badPos(Pos(found.line, found.ch + dist$1), bad) }\n    else\n      { dist$1 += before.textContent.length; }\n  }\n}\n\n// TEXTAREA INPUT STYLE\n\nvar TextareaInput = function(cm) {\n  this.cm = cm;\n  // See input.poll and input.reset\n  this.prevInput = \"\";\n\n  // Flag that indicates whether we expect input to appear real soon\n  // now (after some event like 'keypress' or 'input') and are\n  // polling intensively.\n  this.pollingFast = false;\n  // Self-resetting timeout for the poller\n  this.polling = new Delayed();\n  // Tracks when input.reset has punted to just putting a short\n  // string into the textarea instead of the full selection.\n  this.inaccurateSelection = false;\n  // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n  this.hasSelection = false;\n  this.composing = null;\n};\n\nTextareaInput.prototype.init = function (display) {\n    var this$1 = this;\n\n  var input = this, cm = this.cm;\n\n  // Wraps and hides input textarea\n  var div = this.wrapper = hiddenTextarea();\n  // The semihidden textarea that is focused when the editor is\n  // focused, and receives input.\n  var te = this.textarea = div.firstChild;\n  display.wrapper.insertBefore(div, display.wrapper.firstChild);\n\n  // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n  if (ios) { te.style.width = \"0px\"; }\n\n  on(te, \"input\", function () {\n    if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null; }\n    input.poll();\n  });\n\n  on(te, \"paste\", function (e) {\n    if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n\n    cm.state.pasteIncoming = true;\n    input.fastPoll();\n  });\n\n  function prepareCopyCut(e) {\n    if (signalDOMEvent(cm, e)) { return }\n    if (cm.somethingSelected()) {\n      setLastCopied({lineWise: false, text: cm.getSelections()});\n      if (input.inaccurateSelection) {\n        input.prevInput = \"\";\n        input.inaccurateSelection = false;\n        te.value = lastCopied.text.join(\"\\n\");\n        selectInput(te);\n      }\n    } else if (!cm.options.lineWiseCopyCut) {\n      return\n    } else {\n      var ranges = copyableRanges(cm);\n      setLastCopied({lineWise: true, text: ranges.text});\n      if (e.type == \"cut\") {\n        cm.setSelections(ranges.ranges, null, sel_dontScroll);\n      } else {\n        input.prevInput = \"\";\n        te.value = ranges.text.join(\"\\n\");\n        selectInput(te);\n      }\n    }\n    if (e.type == \"cut\") { cm.state.cutIncoming = true; }\n  }\n  on(te, \"cut\", prepareCopyCut);\n  on(te, \"copy\", prepareCopyCut);\n\n  on(display.scroller, \"paste\", function (e) {\n    if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\n    cm.state.pasteIncoming = true;\n    input.focus();\n  });\n\n  // Prevent normal selection in the editor (we handle our own)\n  on(display.lineSpace, \"selectstart\", function (e) {\n    if (!eventInWidget(display, e)) { e_preventDefault(e); }\n  });\n\n  on(te, \"compositionstart\", function () {\n    var start = cm.getCursor(\"from\");\n    if (input.composing) { input.composing.range.clear(); }\n    input.composing = {\n      start: start,\n      range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\n    };\n  });\n  on(te, \"compositionend\", function () {\n    if (input.composing) {\n      input.poll();\n      input.composing.range.clear();\n      input.composing = null;\n    }\n  });\n};\n\nTextareaInput.prototype.prepareSelection = function () {\n  // Redraw the selection and/or cursor\n  var cm = this.cm, display = cm.display, doc = cm.doc;\n  var result = prepareSelection(cm);\n\n  // Move the hidden textarea near the cursor to prevent scrolling artifacts\n  if (cm.options.moveInputWithCursor) {\n    var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n    var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n    result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                        headPos.top + lineOff.top - wrapOff.top));\n    result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                         headPos.left + lineOff.left - wrapOff.left));\n  }\n\n  return result\n};\n\nTextareaInput.prototype.showSelection = function (drawn) {\n  var cm = this.cm, display = cm.display;\n  removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n  removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n  if (drawn.teTop != null) {\n    this.wrapper.style.top = drawn.teTop + \"px\";\n    this.wrapper.style.left = drawn.teLeft + \"px\";\n  }\n};\n\n// Reset the input to correspond to the selection (or to be empty,\n// when not typing and nothing is selected)\nTextareaInput.prototype.reset = function (typing) {\n  if (this.contextMenuPending || this.composing) { return }\n  var minimal, selected, cm = this.cm, doc = cm.doc;\n  if (cm.somethingSelected()) {\n    this.prevInput = \"\";\n    var range$$1 = doc.sel.primary();\n    minimal = hasCopyEvent &&\n      (range$$1.to().line - range$$1.from().line > 100 || (selected = cm.getSelection()).length > 1000);\n    var content = minimal ? \"-\" : selected || cm.getSelection();\n    this.textarea.value = content;\n    if (cm.state.focused) { selectInput(this.textarea); }\n    if (ie && ie_version >= 9) { this.hasSelection = content; }\n  } else if (!typing) {\n    this.prevInput = this.textarea.value = \"\";\n    if (ie && ie_version >= 9) { this.hasSelection = null; }\n  }\n  this.inaccurateSelection = minimal;\n};\n\nTextareaInput.prototype.getField = function () { return this.textarea };\n\nTextareaInput.prototype.supportsTouch = function () { return false };\n\nTextareaInput.prototype.focus = function () {\n  if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n    try { this.textarea.focus(); }\n    catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n  }\n};\n\nTextareaInput.prototype.blur = function () { this.textarea.blur(); };\n\nTextareaInput.prototype.resetPosition = function () {\n  this.wrapper.style.top = this.wrapper.style.left = 0;\n};\n\nTextareaInput.prototype.receivedFocus = function () { this.slowPoll(); };\n\n// Poll for input changes, using the normal rate of polling. This\n// runs as long as the editor is focused.\nTextareaInput.prototype.slowPoll = function () {\n    var this$1 = this;\n\n  if (this.pollingFast) { return }\n  this.polling.set(this.cm.options.pollInterval, function () {\n    this$1.poll();\n    if (this$1.cm.state.focused) { this$1.slowPoll(); }\n  });\n};\n\n// When an event has just come in that is likely to add or change\n// something in the input textarea, we poll faster, to ensure that\n// the change appears on the screen quickly.\nTextareaInput.prototype.fastPoll = function () {\n  var missed = false, input = this;\n  input.pollingFast = true;\n  function p() {\n    var changed = input.poll();\n    if (!changed && !missed) {missed = true; input.polling.set(60, p);}\n    else {input.pollingFast = false; input.slowPoll();}\n  }\n  input.polling.set(20, p);\n};\n\n// Read input from the textarea, and update the document to match.\n// When something is selected, it is present in the textarea, and\n// selected (unless it is huge, in which case a placeholder is\n// used). When nothing is selected, the cursor sits after previously\n// seen text (can be empty), which is stored in prevInput (we must\n// not reset the textarea when typing, because that breaks IME).\nTextareaInput.prototype.poll = function () {\n    var this$1 = this;\n\n  var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\n  // Since this is called a *lot*, try to bail out as cheaply as\n  // possible when it is clear that nothing happened. hasSelection\n  // will be the case when there is a lot of text in the textarea,\n  // in which case reading its value would be expensive.\n  if (this.contextMenuPending || !cm.state.focused ||\n      (hasSelection(input) && !prevInput && !this.composing) ||\n      cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\n    { return false }\n\n  var text = input.value;\n  // If nothing changed, bail.\n  if (text == prevInput && !cm.somethingSelected()) { return false }\n  // Work around nonsensical selection resetting in IE9/10, and\n  // inexplicable appearance of private area unicode characters on\n  // some key combos in Mac (#2689).\n  if (ie && ie_version >= 9 && this.hasSelection === text ||\n      mac && /[\\uf700-\\uf7ff]/.test(text)) {\n    cm.display.input.reset();\n    return false\n  }\n\n  if (cm.doc.sel == cm.display.selForContextMenu) {\n    var first = text.charCodeAt(0);\n    if (first == 0x200b && !prevInput) { prevInput = \"\\u200b\"; }\n    if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\") }\n  }\n  // Find the part of the input that is actually new\n  var same = 0, l = Math.min(prevInput.length, text.length);\n  while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same; }\n\n  runInOp(cm, function () {\n    applyTextInput(cm, text.slice(same), prevInput.length - same,\n                   null, this$1.composing ? \"*compose\" : null);\n\n    // Don't leave long text in the textarea, since it makes further polling slow\n    if (text.length > 1000 || text.indexOf(\"\\n\") > -1) { input.value = this$1.prevInput = \"\"; }\n    else { this$1.prevInput = text; }\n\n    if (this$1.composing) {\n      this$1.composing.range.clear();\n      this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"),\n                                         {className: \"CodeMirror-composing\"});\n    }\n  });\n  return true\n};\n\nTextareaInput.prototype.ensurePolled = function () {\n  if (this.pollingFast && this.poll()) { this.pollingFast = false; }\n};\n\nTextareaInput.prototype.onKeyPress = function () {\n  if (ie && ie_version >= 9) { this.hasSelection = null; }\n  this.fastPoll();\n};\n\nTextareaInput.prototype.onContextMenu = function (e) {\n  var input = this, cm = input.cm, display = cm.display, te = input.textarea;\n  var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n  if (!pos || presto) { return } // Opera is difficult.\n\n  // Reset the current text selection only if the click is done outside of the selection\n  // and 'resetSelectionOnContextMenu' option is true.\n  var reset = cm.options.resetSelectionOnContextMenu;\n  if (reset && cm.doc.sel.contains(pos) == -1)\n    { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll); }\n\n  var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText;\n  input.wrapper.style.cssText = \"position: absolute\";\n  var wrapperBox = input.wrapper.getBoundingClientRect();\n  te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n  var oldScrollY;\n  if (webkit) { oldScrollY = window.scrollY; } // Work around Chrome issue (#2712)\n  display.input.focus();\n  if (webkit) { window.scrollTo(null, oldScrollY); }\n  display.input.reset();\n  // Adds \"Select all\" to context menu in FF\n  if (!cm.somethingSelected()) { te.value = input.prevInput = \" \"; }\n  input.contextMenuPending = true;\n  display.selForContextMenu = cm.doc.sel;\n  clearTimeout(display.detectingSelectAll);\n\n  // Select-all will be greyed out if there's nothing to select, so\n  // this adds a zero-width space so that we can later check whether\n  // it got selected.\n  function prepareSelectAllHack() {\n    if (te.selectionStart != null) {\n      var selected = cm.somethingSelected();\n      var extval = \"\\u200b\" + (selected ? te.value : \"\");\n      te.value = \"\\u21da\"; // Used to catch context-menu undo\n      te.value = extval;\n      input.prevInput = selected ? \"\" : \"\\u200b\";\n      te.selectionStart = 1; te.selectionEnd = extval.length;\n      // Re-set this, in case some other handler touched the\n      // selection in the meantime.\n      display.selForContextMenu = cm.doc.sel;\n    }\n  }\n  function rehide() {\n    input.contextMenuPending = false;\n    input.wrapper.style.cssText = oldWrapperCSS;\n    te.style.cssText = oldCSS;\n    if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos); }\n\n    // Try to detect the user choosing select-all\n    if (te.selectionStart != null) {\n      if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack(); }\n      var i = 0, poll = function () {\n        if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\n            te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\n          operation(cm, selectAll)(cm);\n        } else if (i++ < 10) {\n          display.detectingSelectAll = setTimeout(poll, 500);\n        } else {\n          display.selForContextMenu = null;\n          display.input.reset();\n        }\n      };\n      display.detectingSelectAll = setTimeout(poll, 200);\n    }\n  }\n\n  if (ie && ie_version >= 9) { prepareSelectAllHack(); }\n  if (captureRightClick) {\n    e_stop(e);\n    var mouseup = function () {\n      off(window, \"mouseup\", mouseup);\n      setTimeout(rehide, 20);\n    };\n    on(window, \"mouseup\", mouseup);\n  } else {\n    setTimeout(rehide, 50);\n  }\n};\n\nTextareaInput.prototype.readOnlyChanged = function (val) {\n  if (!val) { this.reset(); }\n};\n\nTextareaInput.prototype.setUneditable = function () {};\n\nTextareaInput.prototype.needsContentAttribute = false;\n\nfunction fromTextArea(textarea, options) {\n  options = options ? copyObj(options) : {};\n  options.value = textarea.value;\n  if (!options.tabindex && textarea.tabIndex)\n    { options.tabindex = textarea.tabIndex; }\n  if (!options.placeholder && textarea.placeholder)\n    { options.placeholder = textarea.placeholder; }\n  // Set autofocus to true if this textarea is focused, or if it has\n  // autofocus and no other element is focused.\n  if (options.autofocus == null) {\n    var hasFocus = activeElt();\n    options.autofocus = hasFocus == textarea ||\n      textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n  }\n\n  function save() {textarea.value = cm.getValue();}\n\n  var realSubmit;\n  if (textarea.form) {\n    on(textarea.form, \"submit\", save);\n    // Deplorable hack to make the submit method do the right thing.\n    if (!options.leaveSubmitMethodAlone) {\n      var form = textarea.form;\n      realSubmit = form.submit;\n      try {\n        var wrappedSubmit = form.submit = function () {\n          save();\n          form.submit = realSubmit;\n          form.submit();\n          form.submit = wrappedSubmit;\n        };\n      } catch(e) {}\n    }\n  }\n\n  options.finishInit = function (cm) {\n    cm.save = save;\n    cm.getTextArea = function () { return textarea; };\n    cm.toTextArea = function () {\n      cm.toTextArea = isNaN; // Prevent this from being ran twice\n      save();\n      textarea.parentNode.removeChild(cm.getWrapperElement());\n      textarea.style.display = \"\";\n      if (textarea.form) {\n        off(textarea.form, \"submit\", save);\n        if (typeof textarea.form.submit == \"function\")\n          { textarea.form.submit = realSubmit; }\n      }\n    };\n  };\n\n  textarea.style.display = \"none\";\n  var cm = CodeMirror$1(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\n    options);\n  return cm\n}\n\nfunction addLegacyProps(CodeMirror) {\n  CodeMirror.off = off;\n  CodeMirror.on = on;\n  CodeMirror.wheelEventPixels = wheelEventPixels;\n  CodeMirror.Doc = Doc;\n  CodeMirror.splitLines = splitLinesAuto;\n  CodeMirror.countColumn = countColumn;\n  CodeMirror.findColumn = findColumn;\n  CodeMirror.isWordChar = isWordCharBasic;\n  CodeMirror.Pass = Pass;\n  CodeMirror.signal = signal;\n  CodeMirror.Line = Line;\n  CodeMirror.changeEnd = changeEnd;\n  CodeMirror.scrollbarModel = scrollbarModel;\n  CodeMirror.Pos = Pos;\n  CodeMirror.cmpPos = cmp;\n  CodeMirror.modes = modes;\n  CodeMirror.mimeModes = mimeModes;\n  CodeMirror.resolveMode = resolveMode;\n  CodeMirror.getMode = getMode;\n  CodeMirror.modeExtensions = modeExtensions;\n  CodeMirror.extendMode = extendMode;\n  CodeMirror.copyState = copyState;\n  CodeMirror.startState = startState;\n  CodeMirror.innerMode = innerMode;\n  CodeMirror.commands = commands;\n  CodeMirror.keyMap = keyMap;\n  CodeMirror.keyName = keyName;\n  CodeMirror.isModifierKey = isModifierKey;\n  CodeMirror.lookupKey = lookupKey;\n  CodeMirror.normalizeKeyMap = normalizeKeyMap;\n  CodeMirror.StringStream = StringStream;\n  CodeMirror.SharedTextMarker = SharedTextMarker;\n  CodeMirror.TextMarker = TextMarker;\n  CodeMirror.LineWidget = LineWidget;\n  CodeMirror.e_preventDefault = e_preventDefault;\n  CodeMirror.e_stopPropagation = e_stopPropagation;\n  CodeMirror.e_stop = e_stop;\n  CodeMirror.addClass = addClass;\n  CodeMirror.contains = contains;\n  CodeMirror.rmClass = rmClass;\n  CodeMirror.keyNames = keyNames;\n}\n\n// EDITOR CONSTRUCTOR\n\ndefineOptions(CodeMirror$1);\n\naddEditorMethods(CodeMirror$1);\n\n// Set up methods on CodeMirror's prototype to redirect to the editor's document.\nvar dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\nfor (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n  { CodeMirror$1.prototype[prop] = (function(method) {\n    return function() {return method.apply(this.doc, arguments)}\n  })(Doc.prototype[prop]); } }\n\neventMixin(Doc);\n\n// INPUT HANDLING\n\nCodeMirror$1.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n// MODE DEFINITION AND QUERYING\n\n// Extra arguments are stored as the mode's dependencies, which is\n// used by (legacy) mechanisms like loadmode.js to automatically\n// load a mode. (Preferred mechanism is the require/define calls.)\nCodeMirror$1.defineMode = function(name/*, mode, …*/) {\n  if (!CodeMirror$1.defaults.mode && name != \"null\") { CodeMirror$1.defaults.mode = name; }\n  defineMode.apply(this, arguments);\n};\n\nCodeMirror$1.defineMIME = defineMIME;\n\n// Minimal default mode.\nCodeMirror$1.defineMode(\"null\", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); });\nCodeMirror$1.defineMIME(\"text/plain\", \"null\");\n\n// EXTENSIONS\n\nCodeMirror$1.defineExtension = function (name, func) {\n  CodeMirror$1.prototype[name] = func;\n};\nCodeMirror$1.defineDocExtension = function (name, func) {\n  Doc.prototype[name] = func;\n};\n\nCodeMirror$1.fromTextArea = fromTextArea;\n\naddLegacyProps(CodeMirror$1);\n\nCodeMirror$1.version = \"5.26.0\";\n\nreturn CodeMirror$1;\n\n})));\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(process) {/**\n * Copyright 2014-2015, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n */\n\n\n\nvar emptyFunction = __webpack_require__(1);\n\n/**\n * Similar to invariant but only logs a warning if the condition is not met.\n * This can be used to log issues in development environments in critical\n * paths. Removing the logging code for production environments will keep the\n * same logic and follow the same code paths.\n */\n\nvar warning = emptyFunction;\n\nif (process.env.NODE_ENV !== 'production') {\n  (function () {\n    var printWarning = function printWarning(format) {\n      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      var argIndex = 0;\n      var message = 'Warning: ' + format.replace(/%s/g, function () {\n        return args[argIndex++];\n      });\n      if (typeof console !== 'undefined') {\n        console.error(message);\n      }\n      try {\n        // --- Welcome to debugging React ---\n        // This error was thrown as a convenience so that you can use this stack\n        // to find the callsite that caused this warning to fire.\n        throw new Error(message);\n      } catch (x) {}\n    };\n\n    warning = function warning(condition, format) {\n      if (format === undefined) {\n        throw new Error('`warning(condition, format, ...args)` requires a warning ' + 'message argument');\n      }\n\n      if (format.indexOf('Failed Composite propType: ') === 0) {\n        return; // Ignore CompositeComponent proptype check.\n      }\n\n      if (!condition) {\n        for (var _len2 = arguments.length, args = Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n          args[_key2 - 2] = arguments[_key2];\n        }\n\n        printWarning.apply(undefined, [format].concat(args));\n      }\n    };\n  })();\n}\n\nmodule.exports = warning;\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(process) {/**\n * Copyright 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var REACT_ELEMENT_TYPE = (typeof Symbol === 'function' &&\n    Symbol.for &&\n    Symbol.for('react.element')) ||\n    0xeac7;\n\n  var isValidElement = function(object) {\n    return typeof object === 'object' &&\n      object !== null &&\n      object.$$typeof === REACT_ELEMENT_TYPE;\n  };\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = __webpack_require__(15)(isValidElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = __webpack_require__(14)();\n}\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**\n * Super simple wysiwyg editor v0.8.3\n * http://summernote.org/\n *\n * summernote.js\n * Copyright 2013-2016 Alan Hong. and other contributors\n * summernote may be freely distributed under the MIT license./\n *\n * Date: 2017-04-01T13:43Z\n */\n(function (factory) {\n  /* global define */\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(4)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof module === 'object' && module.exports) {\n    // Node/CommonJS\n    module.exports = factory(require('jquery'));\n  } else {\n    // Browser globals\n    factory(window.jQuery);\n  }\n}(function ($) {\n  'use strict';\n\n  /**\n   * @class core.func\n   *\n   * func utils (for high-order func's arg)\n   *\n   * @singleton\n   * @alternateClassName func\n   */\n  var func = (function () {\n    var eq = function (itemA) {\n      return function (itemB) {\n        return itemA === itemB;\n      };\n    };\n\n    var eq2 = function (itemA, itemB) {\n      return itemA === itemB;\n    };\n\n    var peq2 = function (propName) {\n      return function (itemA, itemB) {\n        return itemA[propName] === itemB[propName];\n      };\n    };\n\n    var ok = function () {\n      return true;\n    };\n\n    var fail = function () {\n      return false;\n    };\n\n    var not = function (f) {\n      return function () {\n        return !f.apply(f, arguments);\n      };\n    };\n\n    var and = function (fA, fB) {\n      return function (item) {\n        return fA(item) && fB(item);\n      };\n    };\n\n    var self = function (a) {\n      return a;\n    };\n\n    var invoke = function (obj, method) {\n      return function () {\n        return obj[method].apply(obj, arguments);\n      };\n    };\n\n    var idCounter = 0;\n\n    /**\n     * generate a globally-unique id\n     *\n     * @param {String} [prefix]\n     */\n    var uniqueId = function (prefix) {\n      var id = ++idCounter + '';\n      return prefix ? prefix + id : id;\n    };\n\n    /**\n     * returns bnd (bounds) from rect\n     *\n     * - IE Compatibility Issue: http://goo.gl/sRLOAo\n     * - Scroll Issue: http://goo.gl/sNjUc\n     *\n     * @param {Rect} rect\n     * @return {Object} bounds\n     * @return {Number} bounds.top\n     * @return {Number} bounds.left\n     * @return {Number} bounds.width\n     * @return {Number} bounds.height\n     */\n    var rect2bnd = function (rect) {\n      var $document = $(document);\n      return {\n        top: rect.top + $document.scrollTop(),\n        left: rect.left + $document.scrollLeft(),\n        width: rect.right - rect.left,\n        height: rect.bottom - rect.top\n      };\n    };\n\n    /**\n     * returns a copy of the object where the keys have become the values and the values the keys.\n     * @param {Object} obj\n     * @return {Object}\n     */\n    var invertObject = function (obj) {\n      var inverted = {};\n      for (var key in obj) {\n        if (obj.hasOwnProperty(key)) {\n          inverted[obj[key]] = key;\n        }\n      }\n      return inverted;\n    };\n\n    /**\n     * @param {String} namespace\n     * @param {String} [prefix]\n     * @return {String}\n     */\n    var namespaceToCamel = function (namespace, prefix) {\n      prefix = prefix || '';\n      return prefix + namespace.split('.').map(function (name) {\n        return name.substring(0, 1).toUpperCase() + name.substring(1);\n      }).join('');\n    };\n\n    /**\n     * Returns a function, that, as long as it continues to be invoked, will not\n     * be triggered. The function will be called after it stops being called for\n     * N milliseconds. If `immediate` is passed, trigger the function on the\n     * leading edge, instead of the trailing.\n     * @param {Function} func\n     * @param {Number} wait\n     * @param {Boolean} immediate\n     * @return {Function}\n     */\n    var debounce = function (func, wait, immediate) {\n      var timeout;\n      return function () {\n        var context = this, args = arguments;\n        var later = function () {\n          timeout = null;\n          if (!immediate) {\n            func.apply(context, args);\n          }\n        };\n        var callNow = immediate && !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n        if (callNow) {\n          func.apply(context, args);\n        }\n      };\n    };\n\n    return {\n      eq: eq,\n      eq2: eq2,\n      peq2: peq2,\n      ok: ok,\n      fail: fail,\n      self: self,\n      not: not,\n      and: and,\n      invoke: invoke,\n      uniqueId: uniqueId,\n      rect2bnd: rect2bnd,\n      invertObject: invertObject,\n      namespaceToCamel: namespaceToCamel,\n      debounce: debounce\n    };\n  })();\n\n  /**\n   * @class core.list\n   *\n   * list utils\n   *\n   * @singleton\n   * @alternateClassName list\n   */\n  var list = (function () {\n    /**\n     * returns the first item of an array.\n     *\n     * @param {Array} array\n     */\n    var head = function (array) {\n      return array[0];\n    };\n\n    /**\n     * returns the last item of an array.\n     *\n     * @param {Array} array\n     */\n    var last = function (array) {\n      return array[array.length - 1];\n    };\n\n    /**\n     * returns everything but the last entry of the array.\n     *\n     * @param {Array} array\n     */\n    var initial = function (array) {\n      return array.slice(0, array.length - 1);\n    };\n\n    /**\n     * returns the rest of the items in an array.\n     *\n     * @param {Array} array\n     */\n    var tail = function (array) {\n      return array.slice(1);\n    };\n\n    /**\n     * returns item of array\n     */\n    var find = function (array, pred) {\n      for (var idx = 0, len = array.length; idx < len; idx ++) {\n        var item = array[idx];\n        if (pred(item)) {\n          return item;\n        }\n      }\n    };\n\n    /**\n     * returns true if all of the values in the array pass the predicate truth test.\n     */\n    var all = function (array, pred) {\n      for (var idx = 0, len = array.length; idx < len; idx ++) {\n        if (!pred(array[idx])) {\n          return false;\n        }\n      }\n      return true;\n    };\n\n    /**\n     * returns index of item\n     */\n    var indexOf = function (array, item) {\n      return $.inArray(item, array);\n    };\n\n    /**\n     * returns true if the value is present in the list.\n     */\n    var contains = function (array, item) {\n      return indexOf(array, item) !== -1;\n    };\n\n    /**\n     * get sum from a list\n     *\n     * @param {Array} array - array\n     * @param {Function} fn - iterator\n     */\n    var sum = function (array, fn) {\n      fn = fn || func.self;\n      return array.reduce(function (memo, v) {\n        return memo + fn(v);\n      }, 0);\n    };\n  \n    /**\n     * returns a copy of the collection with array type.\n     * @param {Collection} collection - collection eg) node.childNodes, ...\n     */\n    var from = function (collection) {\n      var result = [], idx = -1, length = collection.length;\n      while (++idx < length) {\n        result[idx] = collection[idx];\n      }\n      return result;\n    };\n\n    /**\n     * returns whether list is empty or not\n     */\n    var isEmpty = function (array) {\n      return !array || !array.length;\n    };\n  \n    /**\n     * cluster elements by predicate function.\n     *\n     * @param {Array} array - array\n     * @param {Function} fn - predicate function for cluster rule\n     * @param {Array[]}\n     */\n    var clusterBy = function (array, fn) {\n      if (!array.length) { return []; }\n      var aTail = tail(array);\n      return aTail.reduce(function (memo, v) {\n        var aLast = last(memo);\n        if (fn(last(aLast), v)) {\n          aLast[aLast.length] = v;\n        } else {\n          memo[memo.length] = [v];\n        }\n        return memo;\n      }, [[head(array)]]);\n    };\n  \n    /**\n     * returns a copy of the array with all false values removed\n     *\n     * @param {Array} array - array\n     * @param {Function} fn - predicate function for cluster rule\n     */\n    var compact = function (array) {\n      var aResult = [];\n      for (var idx = 0, len = array.length; idx < len; idx ++) {\n        if (array[idx]) { aResult.push(array[idx]); }\n      }\n      return aResult;\n    };\n\n    /**\n     * produces a duplicate-free version of the array\n     *\n     * @param {Array} array\n     */\n    var unique = function (array) {\n      var results = [];\n\n      for (var idx = 0, len = array.length; idx < len; idx ++) {\n        if (!contains(results, array[idx])) {\n          results.push(array[idx]);\n        }\n      }\n\n      return results;\n    };\n\n    /**\n     * returns next item.\n     * @param {Array} array\n     */\n    var next = function (array, item) {\n      var idx = indexOf(array, item);\n      if (idx === -1) { return null; }\n\n      return array[idx + 1];\n    };\n\n    /**\n     * returns prev item.\n     * @param {Array} array\n     */\n    var prev = function (array, item) {\n      var idx = indexOf(array, item);\n      if (idx === -1) { return null; }\n\n      return array[idx - 1];\n    };\n\n    return { head: head, last: last, initial: initial, tail: tail,\n             prev: prev, next: next, find: find, contains: contains,\n             all: all, sum: sum, from: from, isEmpty: isEmpty,\n             clusterBy: clusterBy, compact: compact, unique: unique };\n  })();\n\n  var isSupportAmd = \"function\" === 'function' && __webpack_require__(16);\n\n  /**\n   * returns whether font is installed or not.\n   *\n   * @param {String} fontName\n   * @return {Boolean}\n   */\n  var isFontInstalled = function (fontName) {\n    var testFontName = fontName === 'Comic Sans MS' ? 'Courier New' : 'Comic Sans MS';\n    var $tester = $('<div>').css({\n      position: 'absolute',\n      left: '-9999px',\n      top: '-9999px',\n      fontSize: '200px'\n    }).text('mmmmmmmmmwwwwwww').appendTo(document.body);\n\n    var originalWidth = $tester.css('fontFamily', testFontName).width();\n    var width = $tester.css('fontFamily', fontName + ',' + testFontName).width();\n\n    $tester.remove();\n\n    return originalWidth !== width;\n  };\n\n  var userAgent = navigator.userAgent;\n  var isMSIE = /MSIE|Trident/i.test(userAgent);\n  var browserVersion;\n  if (isMSIE) {\n    var matches = /MSIE (\\d+[.]\\d+)/.exec(userAgent);\n    if (matches) {\n      browserVersion = parseFloat(matches[1]);\n    }\n    matches = /Trident\\/.*rv:([0-9]{1,}[\\.0-9]{0,})/.exec(userAgent);\n    if (matches) {\n      browserVersion = parseFloat(matches[1]);\n    }\n  }\n\n  var isEdge = /Edge\\/\\d+/.test(userAgent);\n\n  var hasCodeMirror = !!window.CodeMirror;\n  if (!hasCodeMirror && isSupportAmd && \"function\" !== 'undefined') {\n    if (true) {\n      try {\n        // If CodeMirror can't be resolved, `require.resolve` will throw an\n        // exception and `hasCodeMirror` won't be set to `true`.\n        /*require.resolve*/(5);\n        hasCodeMirror = true;\n      } catch (e) {\n        // Do nothing.\n      }\n    } else if (typeof eval('require').specified !== 'undefined') {\n      hasCodeMirror = eval('require').specified('codemirror');\n    }\n  }\n\n  /**\n   * @class core.agent\n   *\n   * Object which check platform and agent\n   *\n   * @singleton\n   * @alternateClassName agent\n   */\n  var agent = {\n    isMac: navigator.appVersion.indexOf('Mac') > -1,\n    isMSIE: isMSIE,\n    isEdge: isEdge,\n    isFF: !isEdge && /firefox/i.test(userAgent),\n    isPhantom: /PhantomJS/i.test(userAgent),\n    isWebkit: !isEdge && /webkit/i.test(userAgent),\n    isChrome: !isEdge && /chrome/i.test(userAgent),\n    isSafari: !isEdge && /safari/i.test(userAgent),\n    browserVersion: browserVersion,\n    jqueryVersion: parseFloat($.fn.jquery),\n    isSupportAmd: isSupportAmd,\n    hasCodeMirror: hasCodeMirror,\n    isFontInstalled: isFontInstalled,\n    isW3CRangeSupport: !!document.createRange\n  };\n\n\n  var NBSP_CHAR = String.fromCharCode(160);\n  var ZERO_WIDTH_NBSP_CHAR = '\\ufeff';\n\n  /**\n   * @class core.dom\n   *\n   * Dom functions\n   *\n   * @singleton\n   * @alternateClassName dom\n   */\n  var dom = (function () {\n    /**\n     * @method isEditable\n     *\n     * returns whether node is `note-editable` or not.\n     *\n     * @param {Node} node\n     * @return {Boolean}\n     */\n    var isEditable = function (node) {\n      return node && $(node).hasClass('note-editable');\n    };\n\n    /**\n     * @method isControlSizing\n     *\n     * returns whether node is `note-control-sizing` or not.\n     *\n     * @param {Node} node\n     * @return {Boolean}\n     */\n    var isControlSizing = function (node) {\n      return node && $(node).hasClass('note-control-sizing');\n    };\n\n    /**\n     * @method makePredByNodeName\n     *\n     * returns predicate which judge whether nodeName is same\n     *\n     * @param {String} nodeName\n     * @return {Function}\n     */\n    var makePredByNodeName = function (nodeName) {\n      nodeName = nodeName.toUpperCase();\n      return function (node) {\n        return node && node.nodeName.toUpperCase() === nodeName;\n      };\n    };\n\n    /**\n     * @method isText\n     *\n     *\n     *\n     * @param {Node} node\n     * @return {Boolean} true if node's type is text(3)\n     */\n    var isText = function (node) {\n      return node && node.nodeType === 3;\n    };\n\n    /**\n     * @method isElement\n     *\n     *\n     *\n     * @param {Node} node\n     * @return {Boolean} true if node's type is element(1)\n     */\n    var isElement = function (node) {\n      return node && node.nodeType === 1;\n    };\n\n    /**\n     * ex) br, col, embed, hr, img, input, ...\n     * @see http://www.w3.org/html/wg/drafts/html/master/syntax.html#void-elements\n     */\n    var isVoid = function (node) {\n      return node && /^BR|^IMG|^HR|^IFRAME|^BUTTON/.test(node.nodeName.toUpperCase());\n    };\n\n    var isPara = function (node) {\n      if (isEditable(node)) {\n        return false;\n      }\n\n      // Chrome(v31.0), FF(v25.0.1) use DIV for paragraph\n      return node && /^DIV|^P|^LI|^H[1-7]/.test(node.nodeName.toUpperCase());\n    };\n\n    var isHeading = function (node) {\n      return node && /^H[1-7]/.test(node.nodeName.toUpperCase());\n    };\n\n    var isPre = makePredByNodeName('PRE');\n\n    var isLi = makePredByNodeName('LI');\n\n    var isPurePara = function (node) {\n      return isPara(node) && !isLi(node);\n    };\n\n    var isTable = makePredByNodeName('TABLE');\n\n    var isData = makePredByNodeName('DATA');\n\n    var isInline = function (node) {\n      return !isBodyContainer(node) &&\n             !isList(node) &&\n             !isHr(node) &&\n             !isPara(node) &&\n             !isTable(node) &&\n             !isBlockquote(node) &&\n             !isData(node);\n    };\n\n    var isList = function (node) {\n      return node && /^UL|^OL/.test(node.nodeName.toUpperCase());\n    };\n\n    var isHr = makePredByNodeName('HR');\n\n    var isCell = function (node) {\n      return node && /^TD|^TH/.test(node.nodeName.toUpperCase());\n    };\n\n    var isBlockquote = makePredByNodeName('BLOCKQUOTE');\n\n    var isBodyContainer = function (node) {\n      return isCell(node) || isBlockquote(node) || isEditable(node);\n    };\n\n    var isAnchor = makePredByNodeName('A');\n\n    var isParaInline = function (node) {\n      return isInline(node) && !!ancestor(node, isPara);\n    };\n\n    var isBodyInline = function (node) {\n      return isInline(node) && !ancestor(node, isPara);\n    };\n\n    var isBody = makePredByNodeName('BODY');\n\n    /**\n     * returns whether nodeB is closest sibling of nodeA\n     *\n     * @param {Node} nodeA\n     * @param {Node} nodeB\n     * @return {Boolean}\n     */\n    var isClosestSibling = function (nodeA, nodeB) {\n      return nodeA.nextSibling === nodeB ||\n             nodeA.previousSibling === nodeB;\n    };\n\n    /**\n     * returns array of closest siblings with node\n     *\n     * @param {Node} node\n     * @param {function} [pred] - predicate function\n     * @return {Node[]}\n     */\n    var withClosestSiblings = function (node, pred) {\n      pred = pred || func.ok;\n\n      var siblings = [];\n      if (node.previousSibling && pred(node.previousSibling)) {\n        siblings.push(node.previousSibling);\n      }\n      siblings.push(node);\n      if (node.nextSibling && pred(node.nextSibling)) {\n        siblings.push(node.nextSibling);\n      }\n      return siblings;\n    };\n\n    /**\n     * blank HTML for cursor position\n     * - [workaround] old IE only works with &nbsp;\n     * - [workaround] IE11 and other browser works with bogus br\n     */\n    var blankHTML = agent.isMSIE && agent.browserVersion < 11 ? '&nbsp;' : '<br>';\n\n    /**\n     * @method nodeLength\n     *\n     * returns #text's text size or element's childNodes size\n     *\n     * @param {Node} node\n     */\n    var nodeLength = function (node) {\n      if (isText(node)) {\n        return node.nodeValue.length;\n      }\n      \n      if (node) {\n        return node.childNodes.length;\n      }\n      \n      return 0;\n      \n    };\n\n    /**\n     * returns whether node is empty or not.\n     *\n     * @param {Node} node\n     * @return {Boolean}\n     */\n    var isEmpty = function (node) {\n      var len = nodeLength(node);\n\n      if (len === 0) {\n        return true;\n      } else if (!isText(node) && len === 1 && node.innerHTML === blankHTML) {\n        // ex) <p><br></p>, <span><br></span>\n        return true;\n      } else if (list.all(node.childNodes, isText) && node.innerHTML === '') {\n        // ex) <p></p>, <span></span>\n        return true;\n      }\n\n      return false;\n    };\n\n    /**\n     * padding blankHTML if node is empty (for cursor position)\n     */\n    var paddingBlankHTML = function (node) {\n      if (!isVoid(node) && !nodeLength(node)) {\n        node.innerHTML = blankHTML;\n      }\n    };\n\n    /**\n     * find nearest ancestor predicate hit\n     *\n     * @param {Node} node\n     * @param {Function} pred - predicate function\n     */\n    var ancestor = function (node, pred) {\n      while (node) {\n        if (pred(node)) { return node; }\n        if (isEditable(node)) { break; }\n\n        node = node.parentNode;\n      }\n      return null;\n    };\n\n    /**\n     * find nearest ancestor only single child blood line and predicate hit\n     *\n     * @param {Node} node\n     * @param {Function} pred - predicate function\n     */\n    var singleChildAncestor = function (node, pred) {\n      node = node.parentNode;\n\n      while (node) {\n        if (nodeLength(node) !== 1) { break; }\n        if (pred(node)) { return node; }\n        if (isEditable(node)) { break; }\n\n        node = node.parentNode;\n      }\n      return null;\n    };\n\n    /**\n     * returns new array of ancestor nodes (until predicate hit).\n     *\n     * @param {Node} node\n     * @param {Function} [optional] pred - predicate function\n     */\n    var listAncestor = function (node, pred) {\n      pred = pred || func.fail;\n\n      var ancestors = [];\n      ancestor(node, function (el) {\n        if (!isEditable(el)) {\n          ancestors.push(el);\n        }\n\n        return pred(el);\n      });\n      return ancestors;\n    };\n\n    /**\n     * find farthest ancestor predicate hit\n     */\n    var lastAncestor = function (node, pred) {\n      var ancestors = listAncestor(node);\n      return list.last(ancestors.filter(pred));\n    };\n\n    /**\n     * returns common ancestor node between two nodes.\n     *\n     * @param {Node} nodeA\n     * @param {Node} nodeB\n     */\n    var commonAncestor = function (nodeA, nodeB) {\n      var ancestors = listAncestor(nodeA);\n      for (var n = nodeB; n; n = n.parentNode) {\n        if ($.inArray(n, ancestors) > -1) { return n; }\n      }\n      return null; // difference document area\n    };\n\n    /**\n     * listing all previous siblings (until predicate hit).\n     *\n     * @param {Node} node\n     * @param {Function} [optional] pred - predicate function\n     */\n    var listPrev = function (node, pred) {\n      pred = pred || func.fail;\n\n      var nodes = [];\n      while (node) {\n        if (pred(node)) { break; }\n        nodes.push(node);\n        node = node.previousSibling;\n      }\n      return nodes;\n    };\n\n    /**\n     * listing next siblings (until predicate hit).\n     *\n     * @param {Node} node\n     * @param {Function} [pred] - predicate function\n     */\n    var listNext = function (node, pred) {\n      pred = pred || func.fail;\n\n      var nodes = [];\n      while (node) {\n        if (pred(node)) { break; }\n        nodes.push(node);\n        node = node.nextSibling;\n      }\n      return nodes;\n    };\n\n    /**\n     * listing descendant nodes\n     *\n     * @param {Node} node\n     * @param {Function} [pred] - predicate function\n     */\n    var listDescendant = function (node, pred) {\n      var descendants = [];\n      pred = pred || func.ok;\n\n      // start DFS(depth first search) with node\n      (function fnWalk(current) {\n        if (node !== current && pred(current)) {\n          descendants.push(current);\n        }\n        for (var idx = 0, len = current.childNodes.length; idx < len; idx++) {\n          fnWalk(current.childNodes[idx]);\n        }\n      })(node);\n\n      return descendants;\n    };\n\n    /**\n     * wrap node with new tag.\n     *\n     * @param {Node} node\n     * @param {Node} tagName of wrapper\n     * @return {Node} - wrapper\n     */\n    var wrap = function (node, wrapperName) {\n      var parent = node.parentNode;\n      var wrapper = $('<' + wrapperName + '>')[0];\n\n      parent.insertBefore(wrapper, node);\n      wrapper.appendChild(node);\n\n      return wrapper;\n    };\n\n    /**\n     * insert node after preceding\n     *\n     * @param {Node} node\n     * @param {Node} preceding - predicate function\n     */\n    var insertAfter = function (node, preceding) {\n      var next = preceding.nextSibling, parent = preceding.parentNode;\n      if (next) {\n        parent.insertBefore(node, next);\n      } else {\n        parent.appendChild(node);\n      }\n      return node;\n    };\n\n    /**\n     * append elements.\n     *\n     * @param {Node} node\n     * @param {Collection} aChild\n     */\n    var appendChildNodes = function (node, aChild) {\n      $.each(aChild, function (idx, child) {\n        node.appendChild(child);\n      });\n      return node;\n    };\n\n    /**\n     * returns whether boundaryPoint is left edge or not.\n     *\n     * @param {BoundaryPoint} point\n     * @return {Boolean}\n     */\n    var isLeftEdgePoint = function (point) {\n      return point.offset === 0;\n    };\n\n    /**\n     * returns whether boundaryPoint is right edge or not.\n     *\n     * @param {BoundaryPoint} point\n     * @return {Boolean}\n     */\n    var isRightEdgePoint = function (point) {\n      return point.offset === nodeLength(point.node);\n    };\n\n    /**\n     * returns whether boundaryPoint is edge or not.\n     *\n     * @param {BoundaryPoint} point\n     * @return {Boolean}\n     */\n    var isEdgePoint = function (point) {\n      return isLeftEdgePoint(point) || isRightEdgePoint(point);\n    };\n\n    /**\n     * returns whether node is left edge of ancestor or not.\n     *\n     * @param {Node} node\n     * @param {Node} ancestor\n     * @return {Boolean}\n     */\n    var isLeftEdgeOf = function (node, ancestor) {\n      while (node && node !== ancestor) {\n        if (position(node) !== 0) {\n          return false;\n        }\n        node = node.parentNode;\n      }\n\n      return true;\n    };\n\n    /**\n     * returns whether node is right edge of ancestor or not.\n     *\n     * @param {Node} node\n     * @param {Node} ancestor\n     * @return {Boolean}\n     */\n    var isRightEdgeOf = function (node, ancestor) {\n      if (!ancestor) {\n        return false;\n      }\n      while (node && node !== ancestor) {\n        if (position(node) !== nodeLength(node.parentNode) - 1) {\n          return false;\n        }\n        node = node.parentNode;\n      }\n\n      return true;\n    };\n\n    /**\n     * returns whether point is left edge of ancestor or not.\n     * @param {BoundaryPoint} point\n     * @param {Node} ancestor\n     * @return {Boolean}\n     */\n    var isLeftEdgePointOf = function (point, ancestor) {\n      return isLeftEdgePoint(point) && isLeftEdgeOf(point.node, ancestor);\n    };\n\n    /**\n     * returns whether point is right edge of ancestor or not.\n     * @param {BoundaryPoint} point\n     * @param {Node} ancestor\n     * @return {Boolean}\n     */\n    var isRightEdgePointOf = function (point, ancestor) {\n      return isRightEdgePoint(point) && isRightEdgeOf(point.node, ancestor);\n    };\n\n    /**\n     * returns offset from parent.\n     *\n     * @param {Node} node\n     */\n    var position = function (node) {\n      var offset = 0;\n      while ((node = node.previousSibling)) {\n        offset += 1;\n      }\n      return offset;\n    };\n\n    var hasChildren = function (node) {\n      return !!(node && node.childNodes && node.childNodes.length);\n    };\n\n    /**\n     * returns previous boundaryPoint\n     *\n     * @param {BoundaryPoint} point\n     * @param {Boolean} isSkipInnerOffset\n     * @return {BoundaryPoint}\n     */\n    var prevPoint = function (point, isSkipInnerOffset) {\n      var node, offset;\n\n      if (point.offset === 0) {\n        if (isEditable(point.node)) {\n          return null;\n        }\n\n        node = point.node.parentNode;\n        offset = position(point.node);\n      } else if (hasChildren(point.node)) {\n        node = point.node.childNodes[point.offset - 1];\n        offset = nodeLength(node);\n      } else {\n        node = point.node;\n        offset = isSkipInnerOffset ? 0 : point.offset - 1;\n      }\n\n      return {\n        node: node,\n        offset: offset\n      };\n    };\n\n    /**\n     * returns next boundaryPoint\n     *\n     * @param {BoundaryPoint} point\n     * @param {Boolean} isSkipInnerOffset\n     * @return {BoundaryPoint}\n     */\n    var nextPoint = function (point, isSkipInnerOffset) {\n      var node, offset;\n\n      if (nodeLength(point.node) === point.offset) {\n        if (isEditable(point.node)) {\n          return null;\n        }\n\n        node = point.node.parentNode;\n        offset = position(point.node) + 1;\n      } else if (hasChildren(point.node)) {\n        node = point.node.childNodes[point.offset];\n        offset = 0;\n      } else {\n        node = point.node;\n        offset = isSkipInnerOffset ? nodeLength(point.node) : point.offset + 1;\n      }\n\n      return {\n        node: node,\n        offset: offset\n      };\n    };\n\n    /**\n     * returns whether pointA and pointB is same or not.\n     *\n     * @param {BoundaryPoint} pointA\n     * @param {BoundaryPoint} pointB\n     * @return {Boolean}\n     */\n    var isSamePoint = function (pointA, pointB) {\n      return pointA.node === pointB.node && pointA.offset === pointB.offset;\n    };\n\n    /**\n     * returns whether point is visible (can set cursor) or not.\n     *\n     * @param {BoundaryPoint} point\n     * @return {Boolean}\n     */\n    var isVisiblePoint = function (point) {\n      if (isText(point.node) || !hasChildren(point.node) || isEmpty(point.node)) {\n        return true;\n      }\n\n      var leftNode = point.node.childNodes[point.offset - 1];\n      var rightNode = point.node.childNodes[point.offset];\n      if ((!leftNode || isVoid(leftNode)) && (!rightNode || isVoid(rightNode))) {\n        return true;\n      }\n\n      return false;\n    };\n\n    /**\n     * @method prevPointUtil\n     *\n     * @param {BoundaryPoint} point\n     * @param {Function} pred\n     * @return {BoundaryPoint}\n     */\n    var prevPointUntil = function (point, pred) {\n      while (point) {\n        if (pred(point)) {\n          return point;\n        }\n\n        point = prevPoint(point);\n      }\n\n      return null;\n    };\n\n    /**\n     * @method nextPointUntil\n     *\n     * @param {BoundaryPoint} point\n     * @param {Function} pred\n     * @return {BoundaryPoint}\n     */\n    var nextPointUntil = function (point, pred) {\n      while (point) {\n        if (pred(point)) {\n          return point;\n        }\n\n        point = nextPoint(point);\n      }\n\n      return null;\n    };\n\n    /**\n     * returns whether point has character or not.\n     *\n     * @param {Point} point\n     * @return {Boolean}\n     */\n    var isCharPoint = function (point) {\n      if (!isText(point.node)) {\n        return false;\n      }\n\n      var ch = point.node.nodeValue.charAt(point.offset - 1);\n      return ch && (ch !== ' ' && ch !== NBSP_CHAR);\n    };\n\n    /**\n     * @method walkPoint\n     *\n     * @param {BoundaryPoint} startPoint\n     * @param {BoundaryPoint} endPoint\n     * @param {Function} handler\n     * @param {Boolean} isSkipInnerOffset\n     */\n    var walkPoint = function (startPoint, endPoint, handler, isSkipInnerOffset) {\n      var point = startPoint;\n\n      while (point) {\n        handler(point);\n\n        if (isSamePoint(point, endPoint)) {\n          break;\n        }\n\n        var isSkipOffset = isSkipInnerOffset &&\n                           startPoint.node !== point.node &&\n                           endPoint.node !== point.node;\n        point = nextPoint(point, isSkipOffset);\n      }\n    };\n\n    /**\n     * @method makeOffsetPath\n     *\n     * return offsetPath(array of offset) from ancestor\n     *\n     * @param {Node} ancestor - ancestor node\n     * @param {Node} node\n     */\n    var makeOffsetPath = function (ancestor, node) {\n      var ancestors = listAncestor(node, func.eq(ancestor));\n      return ancestors.map(position).reverse();\n    };\n\n    /**\n     * @method fromOffsetPath\n     *\n     * return element from offsetPath(array of offset)\n     *\n     * @param {Node} ancestor - ancestor node\n     * @param {array} offsets - offsetPath\n     */\n    var fromOffsetPath = function (ancestor, offsets) {\n      var current = ancestor;\n      for (var i = 0, len = offsets.length; i < len; i++) {\n        if (current.childNodes.length <= offsets[i]) {\n          current = current.childNodes[current.childNodes.length - 1];\n        } else {\n          current = current.childNodes[offsets[i]];\n        }\n      }\n      return current;\n    };\n\n    /**\n     * @method splitNode\n     *\n     * split element or #text\n     *\n     * @param {BoundaryPoint} point\n     * @param {Object} [options]\n     * @param {Boolean} [options.isSkipPaddingBlankHTML] - default: false\n     * @param {Boolean} [options.isNotSplitEdgePoint] - default: false\n     * @return {Node} right node of boundaryPoint\n     */\n    var splitNode = function (point, options) {\n      var isSkipPaddingBlankHTML = options && options.isSkipPaddingBlankHTML;\n      var isNotSplitEdgePoint = options && options.isNotSplitEdgePoint;\n\n      // edge case\n      if (isEdgePoint(point) && (isText(point.node) || isNotSplitEdgePoint)) {\n        if (isLeftEdgePoint(point)) {\n          return point.node;\n        } else if (isRightEdgePoint(point)) {\n          return point.node.nextSibling;\n        }\n      }\n\n      // split #text\n      if (isText(point.node)) {\n        return point.node.splitText(point.offset);\n      } else {\n        var childNode = point.node.childNodes[point.offset];\n        var clone = insertAfter(point.node.cloneNode(false), point.node);\n        appendChildNodes(clone, listNext(childNode));\n\n        if (!isSkipPaddingBlankHTML) {\n          paddingBlankHTML(point.node);\n          paddingBlankHTML(clone);\n        }\n\n        return clone;\n      }\n    };\n\n    /**\n     * @method splitTree\n     *\n     * split tree by point\n     *\n     * @param {Node} root - split root\n     * @param {BoundaryPoint} point\n     * @param {Object} [options]\n     * @param {Boolean} [options.isSkipPaddingBlankHTML] - default: false\n     * @param {Boolean} [options.isNotSplitEdgePoint] - default: false\n     * @return {Node} right node of boundaryPoint\n     */\n    var splitTree = function (root, point, options) {\n      // ex) [#text, <span>, <p>]\n      var ancestors = listAncestor(point.node, func.eq(root));\n\n      if (!ancestors.length) {\n        return null;\n      } else if (ancestors.length === 1) {\n        return splitNode(point, options);\n      }\n\n      return ancestors.reduce(function (node, parent) {\n        if (node === point.node) {\n          node = splitNode(point, options);\n        }\n\n        return splitNode({\n          node: parent,\n          offset: node ? dom.position(node) : nodeLength(parent)\n        }, options);\n      });\n    };\n\n    /**\n     * split point\n     *\n     * @param {Point} point\n     * @param {Boolean} isInline\n     * @return {Object}\n     */\n    var splitPoint = function (point, isInline) {\n      // find splitRoot, container\n      //  - inline: splitRoot is a child of paragraph\n      //  - block: splitRoot is a child of bodyContainer\n      var pred = isInline ? isPara : isBodyContainer;\n      var ancestors = listAncestor(point.node, pred);\n      var topAncestor = list.last(ancestors) || point.node;\n\n      var splitRoot, container;\n      if (pred(topAncestor)) {\n        splitRoot = ancestors[ancestors.length - 2];\n        container = topAncestor;\n      } else {\n        splitRoot = topAncestor;\n        container = splitRoot.parentNode;\n      }\n\n      // if splitRoot is exists, split with splitTree\n      var pivot = splitRoot && splitTree(splitRoot, point, {\n        isSkipPaddingBlankHTML: isInline,\n        isNotSplitEdgePoint: isInline\n      });\n\n      // if container is point.node, find pivot with point.offset\n      if (!pivot && container === point.node) {\n        pivot = point.node.childNodes[point.offset];\n      }\n\n      return {\n        rightNode: pivot,\n        container: container\n      };\n    };\n\n    var create = function (nodeName) {\n      return document.createElement(nodeName);\n    };\n\n    var createText = function (text) {\n      return document.createTextNode(text);\n    };\n\n    /**\n     * @method remove\n     *\n     * remove node, (isRemoveChild: remove child or not)\n     *\n     * @param {Node} node\n     * @param {Boolean} isRemoveChild\n     */\n    var remove = function (node, isRemoveChild) {\n      if (!node || !node.parentNode) { return; }\n      if (node.removeNode) { return node.removeNode(isRemoveChild); }\n\n      var parent = node.parentNode;\n      if (!isRemoveChild) {\n        var nodes = [];\n        var i, len;\n        for (i = 0, len = node.childNodes.length; i < len; i++) {\n          nodes.push(node.childNodes[i]);\n        }\n\n        for (i = 0, len = nodes.length; i < len; i++) {\n          parent.insertBefore(nodes[i], node);\n        }\n      }\n\n      parent.removeChild(node);\n    };\n\n    /**\n     * @method removeWhile\n     *\n     * @param {Node} node\n     * @param {Function} pred\n     */\n    var removeWhile = function (node, pred) {\n      while (node) {\n        if (isEditable(node) || !pred(node)) {\n          break;\n        }\n\n        var parent = node.parentNode;\n        remove(node);\n        node = parent;\n      }\n    };\n\n    /**\n     * @method replace\n     *\n     * replace node with provided nodeName\n     *\n     * @param {Node} node\n     * @param {String} nodeName\n     * @return {Node} - new node\n     */\n    var replace = function (node, nodeName) {\n      if (node.nodeName.toUpperCase() === nodeName.toUpperCase()) {\n        return node;\n      }\n\n      var newNode = create(nodeName);\n\n      if (node.style.cssText) {\n        newNode.style.cssText = node.style.cssText;\n      }\n\n      appendChildNodes(newNode, list.from(node.childNodes));\n      insertAfter(newNode, node);\n      remove(node);\n\n      return newNode;\n    };\n\n    var isTextarea = makePredByNodeName('TEXTAREA');\n\n    /**\n     * @param {jQuery} $node\n     * @param {Boolean} [stripLinebreaks] - default: false\n     */\n    var value = function ($node, stripLinebreaks) {\n      var val = isTextarea($node[0]) ? $node.val() : $node.html();\n      if (stripLinebreaks) {\n        return val.replace(/[\\n\\r]/g, '');\n      }\n      return val;\n    };\n\n    /**\n     * @method html\n     *\n     * get the HTML contents of node\n     *\n     * @param {jQuery} $node\n     * @param {Boolean} [isNewlineOnBlock]\n     */\n    var html = function ($node, isNewlineOnBlock) {\n      var markup = value($node);\n\n      if (isNewlineOnBlock) {\n        var regexTag = /<(\\/?)(\\b(?!!)[^>\\s]*)(.*?)(\\s*\\/?>)/g;\n        markup = markup.replace(regexTag, function (match, endSlash, name) {\n          name = name.toUpperCase();\n          var isEndOfInlineContainer = /^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(name) &&\n                                       !!endSlash;\n          var isBlockNode = /^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(name);\n\n          return match + ((isEndOfInlineContainer || isBlockNode) ? '\\n' : '');\n        });\n        markup = $.trim(markup);\n      }\n\n      return markup;\n    };\n\n    var posFromPlaceholder = function (placeholder) {\n      var $placeholder = $(placeholder);\n      var pos = $placeholder.offset();\n      var height = $placeholder.outerHeight(true); // include margin\n\n      return {\n        left: pos.left,\n        top: pos.top + height\n      };\n    };\n\n    var attachEvents = function ($node, events) {\n      Object.keys(events).forEach(function (key) {\n        $node.on(key, events[key]);\n      });\n    };\n\n    var detachEvents = function ($node, events) {\n      Object.keys(events).forEach(function (key) {\n        $node.off(key, events[key]);\n      });\n    };\n\n    return {\n      /** @property {String} NBSP_CHAR */\n      NBSP_CHAR: NBSP_CHAR,\n      /** @property {String} ZERO_WIDTH_NBSP_CHAR */\n      ZERO_WIDTH_NBSP_CHAR: ZERO_WIDTH_NBSP_CHAR,\n      /** @property {String} blank */\n      blank: blankHTML,\n      /** @property {String} emptyPara */\n      emptyPara: '<p>' + blankHTML + '</p>',\n      makePredByNodeName: makePredByNodeName,\n      isEditable: isEditable,\n      isControlSizing: isControlSizing,\n      isText: isText,\n      isElement: isElement,\n      isVoid: isVoid,\n      isPara: isPara,\n      isPurePara: isPurePara,\n      isHeading: isHeading,\n      isInline: isInline,\n      isBlock: func.not(isInline),\n      isBodyInline: isBodyInline,\n      isBody: isBody,\n      isParaInline: isParaInline,\n      isPre: isPre,\n      isList: isList,\n      isTable: isTable,\n      isData: isData,\n      isCell: isCell,\n      isBlockquote: isBlockquote,\n      isBodyContainer: isBodyContainer,\n      isAnchor: isAnchor,\n      isDiv: makePredByNodeName('DIV'),\n      isLi: isLi,\n      isBR: makePredByNodeName('BR'),\n      isSpan: makePredByNodeName('SPAN'),\n      isB: makePredByNodeName('B'),\n      isU: makePredByNodeName('U'),\n      isS: makePredByNodeName('S'),\n      isI: makePredByNodeName('I'),\n      isImg: makePredByNodeName('IMG'),\n      isTextarea: isTextarea,\n      isEmpty: isEmpty,\n      isEmptyAnchor: func.and(isAnchor, isEmpty),\n      isClosestSibling: isClosestSibling,\n      withClosestSiblings: withClosestSiblings,\n      nodeLength: nodeLength,\n      isLeftEdgePoint: isLeftEdgePoint,\n      isRightEdgePoint: isRightEdgePoint,\n      isEdgePoint: isEdgePoint,\n      isLeftEdgeOf: isLeftEdgeOf,\n      isRightEdgeOf: isRightEdgeOf,\n      isLeftEdgePointOf: isLeftEdgePointOf,\n      isRightEdgePointOf: isRightEdgePointOf,\n      prevPoint: prevPoint,\n      nextPoint: nextPoint,\n      isSamePoint: isSamePoint,\n      isVisiblePoint: isVisiblePoint,\n      prevPointUntil: prevPointUntil,\n      nextPointUntil: nextPointUntil,\n      isCharPoint: isCharPoint,\n      walkPoint: walkPoint,\n      ancestor: ancestor,\n      singleChildAncestor: singleChildAncestor,\n      listAncestor: listAncestor,\n      lastAncestor: lastAncestor,\n      listNext: listNext,\n      listPrev: listPrev,\n      listDescendant: listDescendant,\n      commonAncestor: commonAncestor,\n      wrap: wrap,\n      insertAfter: insertAfter,\n      appendChildNodes: appendChildNodes,\n      position: position,\n      hasChildren: hasChildren,\n      makeOffsetPath: makeOffsetPath,\n      fromOffsetPath: fromOffsetPath,\n      splitTree: splitTree,\n      splitPoint: splitPoint,\n      create: create,\n      createText: createText,\n      remove: remove,\n      removeWhile: removeWhile,\n      replace: replace,\n      html: html,\n      value: value,\n      posFromPlaceholder: posFromPlaceholder,\n      attachEvents: attachEvents,\n      detachEvents: detachEvents\n    };\n  })();\n\n  /**\n   * @param {jQuery} $note\n   * @param {Object} options\n   * @return {Context}\n   */\n  var Context = function ($note, options) {\n    var self = this;\n\n    var ui = $.summernote.ui;\n    this.memos = {};\n    this.modules = {};\n    this.layoutInfo = {};\n    this.options = options;\n\n    /**\n     * create layout and initialize modules and other resources\n     */\n    this.initialize = function () {\n      this.layoutInfo = ui.createLayout($note, options);\n      this._initialize();\n      $note.hide();\n      return this;\n    };\n\n    /**\n     * destroy modules and other resources and remove layout\n     */\n    this.destroy = function () {\n      this._destroy();\n      $note.removeData('summernote');\n      ui.removeLayout($note, this.layoutInfo);\n    };\n\n    /**\n     * destory modules and other resources and initialize it again\n     */\n    this.reset = function () {\n      var disabled = self.isDisabled();\n      this.code(dom.emptyPara);\n      this._destroy();\n      this._initialize();\n\n      if (disabled) {\n        self.disable();\n      }\n    };\n\n    this._initialize = function () {\n      // add optional buttons\n      var buttons = $.extend({}, this.options.buttons);\n      Object.keys(buttons).forEach(function (key) {\n        self.memo('button.' + key, buttons[key]);\n      });\n\n      var modules = $.extend({}, this.options.modules, $.summernote.plugins || {});\n\n      // add and initialize modules\n      Object.keys(modules).forEach(function (key) {\n        self.module(key, modules[key], true);\n      });\n\n      Object.keys(this.modules).forEach(function (key) {\n        self.initializeModule(key);\n      });\n    };\n\n    this._destroy = function () {\n      // destroy modules with reversed order\n      Object.keys(this.modules).reverse().forEach(function (key) {\n        self.removeModule(key);\n      });\n\n      Object.keys(this.memos).forEach(function (key) {\n        self.removeMemo(key);\n      });\n      // trigger custom onDestroy callback\n      this.triggerEvent('destroy', this);\n    };\n\n    this.code = function (html) {\n      var isActivated = this.invoke('codeview.isActivated');\n\n      if (html === undefined) {\n        this.invoke('codeview.sync');\n        return isActivated ? this.layoutInfo.codable.val() : this.layoutInfo.editable.html();\n      } else {\n        if (isActivated) {\n          this.layoutInfo.codable.val(html);\n        } else {\n          this.layoutInfo.editable.html(html);\n        }\n        $note.val(html);\n        this.triggerEvent('change', html);\n      }\n    };\n\n    this.isDisabled = function () {\n      return this.layoutInfo.editable.attr('contenteditable') === 'false';\n    };\n\n    this.enable = function () {\n      this.layoutInfo.editable.attr('contenteditable', true);\n      this.invoke('toolbar.activate', true);\n    };\n\n    this.disable = function () {\n      // close codeview if codeview is opend\n      if (this.invoke('codeview.isActivated')) {\n        this.invoke('codeview.deactivate');\n      }\n      this.layoutInfo.editable.attr('contenteditable', false);\n      this.invoke('toolbar.deactivate', true);\n    };\n\n    this.triggerEvent = function () {\n      var namespace = list.head(arguments);\n      var args = list.tail(list.from(arguments));\n\n      var callback = this.options.callbacks[func.namespaceToCamel(namespace, 'on')];\n      if (callback) {\n        callback.apply($note[0], args);\n      }\n      $note.trigger('summernote.' + namespace, args);\n    };\n\n    this.initializeModule = function (key) {\n      var module = this.modules[key];\n      module.shouldInitialize = module.shouldInitialize || func.ok;\n      if (!module.shouldInitialize()) {\n        return;\n      }\n\n      // initialize module\n      if (module.initialize) {\n        module.initialize();\n      }\n\n      // attach events\n      if (module.events) {\n        dom.attachEvents($note, module.events);\n      }\n    };\n\n    this.module = function (key, ModuleClass, withoutIntialize) {\n      if (arguments.length === 1) {\n        return this.modules[key];\n      }\n\n      this.modules[key] = new ModuleClass(this);\n\n      if (!withoutIntialize) {\n        this.initializeModule(key);\n      }\n    };\n\n    this.removeModule = function (key) {\n      var module = this.modules[key];\n      if (module.shouldInitialize()) {\n        if (module.events) {\n          dom.detachEvents($note, module.events);\n        }\n\n        if (module.destroy) {\n          module.destroy();\n        }\n      }\n\n      delete this.modules[key];\n    };\n\n    this.memo = function (key, obj) {\n      if (arguments.length === 1) {\n        return this.memos[key];\n      }\n      this.memos[key] = obj;\n    };\n\n    this.removeMemo = function (key) {\n      if (this.memos[key] && this.memos[key].destroy) {\n        this.memos[key].destroy();\n      }\n\n      delete this.memos[key];\n    };\n\n    this.createInvokeHandler = function (namespace, value) {\n      return function (event) {\n        event.preventDefault();\n        self.invoke(namespace, value || $(event.target).closest('[data-value]').data('value'));\n      };\n    };\n\n    this.invoke = function () {\n      var namespace = list.head(arguments);\n      var args = list.tail(list.from(arguments));\n\n      var splits = namespace.split('.');\n      var hasSeparator = splits.length > 1;\n      var moduleName = hasSeparator && list.head(splits);\n      var methodName = hasSeparator ? list.last(splits) : list.head(splits);\n\n      var module = this.modules[moduleName || 'editor'];\n      if (!moduleName && this[methodName]) {\n        return this[methodName].apply(this, args);\n      } else if (module && module[methodName] && module.shouldInitialize()) {\n        return module[methodName].apply(module, args);\n      }\n    };\n\n    return this.initialize();\n  };\n\n  $.fn.extend({\n    /**\n     * Summernote API\n     *\n     * @param {Object|String}\n     * @return {this}\n     */\n    summernote: function () {\n      var type = $.type(list.head(arguments));\n      var isExternalAPICalled = type === 'string';\n      var hasInitOptions = type === 'object';\n\n      var options = hasInitOptions ? list.head(arguments) : {};\n\n      options = $.extend({}, $.summernote.options, options);\n      options.langInfo = $.extend(true, {}, $.summernote.lang['en-US'], $.summernote.lang[options.lang]);\n      options.icons = $.extend(true, {}, $.summernote.options.icons, options.icons);\n\n      this.each(function (idx, note) {\n        var $note = $(note);\n        if (!$note.data('summernote')) {\n          var context = new Context($note, options);\n          $note.data('summernote', context);\n          $note.data('summernote').triggerEvent('init', context.layoutInfo);\n        }\n      });\n\n      var $note = this.first();\n      if ($note.length) {\n        var context = $note.data('summernote');\n        if (isExternalAPICalled) {\n          return context.invoke.apply(context, list.from(arguments));\n        } else if (options.focus) {\n          context.invoke('editor.focus');\n        }\n      }\n\n      return this;\n    }\n  });\n\n\n  var Renderer = function (markup, children, options, callback) {\n    this.render = function ($parent) {\n      var $node = $(markup);\n\n      if (options && options.contents) {\n        $node.html(options.contents);\n      }\n\n      if (options && options.className) {\n        $node.addClass(options.className);\n      }\n\n      if (options && options.data) {\n        $.each(options.data, function (k, v) {\n          $node.attr('data-' + k, v);\n        });\n      }\n\n      if (options && options.click) {\n        $node.on('click', options.click);\n      }\n\n      if (children) {\n        var $container = $node.find('.note-children-container');\n        children.forEach(function (child) {\n          child.render($container.length ? $container : $node);\n        });\n      }\n\n      if (callback) {\n        callback($node, options);\n      }\n\n      if (options && options.callback) {\n        options.callback($node);\n      }\n\n      if ($parent) {\n        $parent.append($node);\n      }\n\n      return $node;\n    };\n  };\n\n  var renderer = {\n    create: function (markup, callback) {\n      return function () {\n        var children = $.isArray(arguments[0]) ? arguments[0] : [];\n        var options = typeof arguments[1] === 'object' ? arguments[1] : arguments[0];\n        if (options && options.children) {\n          children = options.children;\n        }\n        return new Renderer(markup, children, options, callback);\n      };\n    }\n  };\n\n  var editor = renderer.create('<div class=\"note-editor note-frame panel panel-default\"/>');\n  var toolbar = renderer.create('<div class=\"note-toolbar panel-heading\"/>');\n  var editingArea = renderer.create('<div class=\"note-editing-area\"/>');\n  var codable = renderer.create('<textarea class=\"note-codable\"/>');\n  var editable = renderer.create('<div class=\"note-editable panel-body\" contentEditable=\"true\"/>');\n  var statusbar = renderer.create([\n    '<div class=\"note-statusbar\">',\n    '  <div class=\"note-resizebar\">',\n    '    <div class=\"note-icon-bar\"/>',\n    '    <div class=\"note-icon-bar\"/>',\n    '    <div class=\"note-icon-bar\"/>',\n    '  </div>',\n    '</div>'\n  ].join(''));\n\n  var airEditor = renderer.create('<div class=\"note-editor\"/>');\n  var airEditable = renderer.create('<div class=\"note-editable\" contentEditable=\"true\"/>');\n\n  var buttonGroup = renderer.create('<div class=\"note-btn-group btn-group\">');\n  var button = renderer.create('<button type=\"button\" class=\"note-btn btn btn-default btn-sm\" tabindex=\"-1\">', function ($node, options) {\n    if (options && options.tooltip) {\n      $node.attr({\n        title: options.tooltip\n      }).tooltip({\n        container: 'body',\n        trigger: 'hover',\n        placement: 'bottom'\n      });\n    }\n  });\n\n  var dropdown = renderer.create('<div class=\"dropdown-menu\">', function ($node, options) {\n    var markup = $.isArray(options.items) ? options.items.map(function (item) {\n      var value = (typeof item === 'string') ? item : (item.value || '');\n      var content = options.template ? options.template(item) : item;\n      return '<li><a href=\"#\" data-value=\"' + value + '\">' + content + '</a></li>';\n    }).join('') : options.items;\n\n    $node.html(markup);\n  });\n\n  var dropdownCheck = renderer.create('<div class=\"dropdown-menu note-check\">', function ($node, options) {\n    var markup = $.isArray(options.items) ? options.items.map(function (item) {\n      var value = (typeof item === 'string') ? item : (item.value || '');\n      var content = options.template ? options.template(item) : item;\n      return '<li><a href=\"#\" data-value=\"' + value + '\">' + icon(options.checkClassName) + ' ' + content + '</a></li>';\n    }).join('') : options.items;\n    $node.html(markup);\n  });\n\n  var palette = renderer.create('<div class=\"note-color-palette\"/>', function ($node, options) {\n    var contents = [];\n    for (var row = 0, rowSize = options.colors.length; row < rowSize; row++) {\n      var eventName = options.eventName;\n      var colors = options.colors[row];\n      var buttons = [];\n      for (var col = 0, colSize = colors.length; col < colSize; col++) {\n        var color = colors[col];\n        buttons.push([\n          '<button type=\"button\" class=\"note-color-btn\"',\n          'style=\"background-color:', color, '\" ',\n          'data-event=\"', eventName, '\" ',\n          'data-value=\"', color, '\" ',\n          'title=\"', color, '\" ',\n          'data-toggle=\"button\" tabindex=\"-1\"></button>'\n        ].join(''));\n      }\n      contents.push('<div class=\"note-color-row\">' + buttons.join('') + '</div>');\n    }\n    $node.html(contents.join(''));\n\n    $node.find('.note-color-btn').tooltip({\n      container: 'body',\n      trigger: 'hover',\n      placement: 'bottom'\n    });\n  });\n\n  var dialog = renderer.create('<div class=\"modal\" aria-hidden=\"false\" tabindex=\"-1\"/>', function ($node, options) {\n    if (options.fade) {\n      $node.addClass('fade');\n    }\n    $node.html([\n      '<div class=\"modal-dialog\">',\n      '  <div class=\"modal-content\">',\n      (options.title ?\n      '    <div class=\"modal-header\">' +\n      '      <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>' +\n      '      <h4 class=\"modal-title\">' + options.title + '</h4>' +\n      '    </div>' : ''\n      ),\n      '    <div class=\"modal-body\">' + options.body + '</div>',\n      (options.footer ?\n      '    <div class=\"modal-footer\">' + options.footer + '</div>' : ''\n      ),\n      '  </div>',\n      '</div>'\n    ].join(''));\n  });\n\n  var popover = renderer.create([\n    '<div class=\"note-popover popover in\">',\n    '  <div class=\"arrow\"/>',\n    '  <div class=\"popover-content note-children-container\"/>',\n    '</div>'\n  ].join(''), function ($node, options) {\n    var direction = typeof options.direction !== 'undefined' ? options.direction : 'bottom';\n\n    $node.addClass(direction);\n\n    if (options.hideArrow) {\n      $node.find('.arrow').hide();\n    }\n  });\n\n  var icon = function (iconClassName, tagName) {\n    tagName = tagName || 'i';\n    return '<' + tagName + ' class=\"' + iconClassName + '\"/>';\n  };\n\n  var ui = {\n    editor: editor,\n    toolbar: toolbar,\n    editingArea: editingArea,\n    codable: codable,\n    editable: editable,\n    statusbar: statusbar,\n    airEditor: airEditor,\n    airEditable: airEditable,\n    buttonGroup: buttonGroup,\n    button: button,\n    dropdown: dropdown,\n    dropdownCheck: dropdownCheck,\n    palette: palette,\n    dialog: dialog,\n    popover: popover,\n    icon: icon,\n\n    toggleBtn: function ($btn, isEnable) {\n      $btn.toggleClass('disabled', !isEnable);\n      $btn.attr('disabled', !isEnable);\n    },\n\n    toggleBtnActive: function ($btn, isActive) {\n      $btn.toggleClass('active', isActive);\n    },\n\n    onDialogShown: function ($dialog, handler) {\n      $dialog.one('shown.bs.modal', handler);\n    },\n\n    onDialogHidden: function ($dialog, handler) {\n      $dialog.one('hidden.bs.modal', handler);\n    },\n\n    showDialog: function ($dialog) {\n      $dialog.modal('show');\n    },\n\n    hideDialog: function ($dialog) {\n      $dialog.modal('hide');\n    },\n\n    createLayout: function ($note, options) {\n      var $editor = (options.airMode ? ui.airEditor([\n        ui.editingArea([\n          ui.airEditable()\n        ])\n      ]) : ui.editor([\n        ui.toolbar(),\n        ui.editingArea([\n          ui.codable(),\n          ui.editable()\n        ]),\n        ui.statusbar()\n      ])).render();\n\n      $editor.insertAfter($note);\n\n      return {\n        note: $note,\n        editor: $editor,\n        toolbar: $editor.find('.note-toolbar'),\n        editingArea: $editor.find('.note-editing-area'),\n        editable: $editor.find('.note-editable'),\n        codable: $editor.find('.note-codable'),\n        statusbar: $editor.find('.note-statusbar')\n      };\n    },\n\n    removeLayout: function ($note, layoutInfo) {\n      $note.html(layoutInfo.editable.html());\n      layoutInfo.editor.remove();\n      $note.show();\n    }\n  };\n\n  $.summernote = $.summernote || {\n    lang: {}\n  };\n\n  $.extend($.summernote.lang, {\n    'en-US': {\n      font: {\n        bold: 'Bold',\n        italic: 'Italic',\n        underline: 'Underline',\n        clear: 'Remove Font Style',\n        height: 'Line Height',\n        name: 'Font Family',\n        strikethrough: 'Strikethrough',\n        subscript: 'Subscript',\n        superscript: 'Superscript',\n        size: 'Font Size'\n      },\n      image: {\n        image: 'Picture',\n        insert: 'Insert Image',\n        resizeFull: 'Resize Full',\n        resizeHalf: 'Resize Half',\n        resizeQuarter: 'Resize Quarter',\n        floatLeft: 'Float Left',\n        floatRight: 'Float Right',\n        floatNone: 'Float None',\n        shapeRounded: 'Shape: Rounded',\n        shapeCircle: 'Shape: Circle',\n        shapeThumbnail: 'Shape: Thumbnail',\n        shapeNone: 'Shape: None',\n        dragImageHere: 'Drag image or text here',\n        dropImage: 'Drop image or Text',\n        selectFromFiles: 'Select from files',\n        maximumFileSize: 'Maximum file size',\n        maximumFileSizeError: 'Maximum file size exceeded.',\n        url: 'Image URL',\n        remove: 'Remove Image'\n      },\n      video: {\n        video: 'Video',\n        videoLink: 'Video Link',\n        insert: 'Insert Video',\n        url: 'Video URL?',\n        providers: '(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)'\n      },\n      link: {\n        link: 'Link',\n        insert: 'Insert Link',\n        unlink: 'Unlink',\n        edit: 'Edit',\n        textToDisplay: 'Text to display',\n        url: 'To what URL should this link go?',\n        openInNewWindow: 'Open in new window'\n      },\n      table: {\n        table: 'Table'\n      },\n      hr: {\n        insert: 'Insert Horizontal Rule'\n      },\n      style: {\n        style: 'Style',\n        p: 'Normal',\n        blockquote: 'Quote',\n        pre: 'Code',\n        h1: 'Header 1',\n        h2: 'Header 2',\n        h3: 'Header 3',\n        h4: 'Header 4',\n        h5: 'Header 5',\n        h6: 'Header 6'\n      },\n      lists: {\n        unordered: 'Unordered list',\n        ordered: 'Ordered list'\n      },\n      options: {\n        help: 'Help',\n        fullscreen: 'Full Screen',\n        codeview: 'Code View'\n      },\n      paragraph: {\n        paragraph: 'Paragraph',\n        outdent: 'Outdent',\n        indent: 'Indent',\n        left: 'Align left',\n        center: 'Align center',\n        right: 'Align right',\n        justify: 'Justify full'\n      },\n      color: {\n        recent: 'Recent Color',\n        more: 'More Color',\n        background: 'Background Color',\n        foreground: 'Foreground Color',\n        transparent: 'Transparent',\n        setTransparent: 'Set transparent',\n        reset: 'Reset',\n        resetToDefault: 'Reset to default'\n      },\n      shortcut: {\n        shortcuts: 'Keyboard shortcuts',\n        close: 'Close',\n        textFormatting: 'Text formatting',\n        action: 'Action',\n        paragraphFormatting: 'Paragraph formatting',\n        documentStyle: 'Document Style',\n        extraKeys: 'Extra keys'\n      },\n      help: {\n        'insertParagraph': 'Insert Paragraph',\n        'undo': 'Undoes the last command',\n        'redo': 'Redoes the last command',\n        'tab': 'Tab',\n        'untab': 'Untab',\n        'bold': 'Set a bold style',\n        'italic': 'Set a italic style',\n        'underline': 'Set a underline style',\n        'strikethrough': 'Set a strikethrough style',\n        'removeFormat': 'Clean a style',\n        'justifyLeft': 'Set left align',\n        'justifyCenter': 'Set center align',\n        'justifyRight': 'Set right align',\n        'justifyFull': 'Set full align',\n        'insertUnorderedList': 'Toggle unordered list',\n        'insertOrderedList': 'Toggle ordered list',\n        'outdent': 'Outdent on current paragraph',\n        'indent': 'Indent on current paragraph',\n        'formatPara': 'Change current block\\'s format as a paragraph(P tag)',\n        'formatH1': 'Change current block\\'s format as H1',\n        'formatH2': 'Change current block\\'s format as H2',\n        'formatH3': 'Change current block\\'s format as H3',\n        'formatH4': 'Change current block\\'s format as H4',\n        'formatH5': 'Change current block\\'s format as H5',\n        'formatH6': 'Change current block\\'s format as H6',\n        'insertHorizontalRule': 'Insert horizontal rule',\n        'linkDialog.show': 'Show Link Dialog'\n      },\n      history: {\n        undo: 'Undo',\n        redo: 'Redo'\n      },\n      specialChar: {\n        specialChar: 'SPECIAL CHARACTERS',\n        select: 'Select Special characters'\n      }\n    }\n  });\n\n\n  /**\n   * @class core.key\n   *\n   * Object for keycodes.\n   *\n   * @singleton\n   * @alternateClassName key\n   */\n  var key = (function () {\n    var keyMap = {\n      'BACKSPACE': 8,\n      'TAB': 9,\n      'ENTER': 13,\n      'SPACE': 32,\n\n      // Arrow\n      'LEFT': 37,\n      'UP': 38,\n      'RIGHT': 39,\n      'DOWN': 40,\n\n      // Number: 0-9\n      'NUM0': 48,\n      'NUM1': 49,\n      'NUM2': 50,\n      'NUM3': 51,\n      'NUM4': 52,\n      'NUM5': 53,\n      'NUM6': 54,\n      'NUM7': 55,\n      'NUM8': 56,\n\n      // Alphabet: a-z\n      'B': 66,\n      'E': 69,\n      'I': 73,\n      'J': 74,\n      'K': 75,\n      'L': 76,\n      'R': 82,\n      'S': 83,\n      'U': 85,\n      'V': 86,\n      'Y': 89,\n      'Z': 90,\n\n      'SLASH': 191,\n      'LEFTBRACKET': 219,\n      'BACKSLASH': 220,\n      'RIGHTBRACKET': 221\n    };\n\n    return {\n      /**\n       * @method isEdit\n       *\n       * @param {Number} keyCode\n       * @return {Boolean}\n       */\n      isEdit: function (keyCode) {\n        return list.contains([\n          keyMap.BACKSPACE,\n          keyMap.TAB,\n          keyMap.ENTER,\n          keyMap.SPACE\n        ], keyCode);\n      },\n      /**\n       * @method isMove\n       *\n       * @param {Number} keyCode\n       * @return {Boolean}\n       */\n      isMove: function (keyCode) {\n        return list.contains([\n          keyMap.LEFT,\n          keyMap.UP,\n          keyMap.RIGHT,\n          keyMap.DOWN\n        ], keyCode);\n      },\n      /**\n       * @property {Object} nameFromCode\n       * @property {String} nameFromCode.8 \"BACKSPACE\"\n       */\n      nameFromCode: func.invertObject(keyMap),\n      code: keyMap\n    };\n  })();\n\n  var range = (function () {\n\n    /**\n     * return boundaryPoint from TextRange, inspired by Andy Na's HuskyRange.js\n     *\n     * @param {TextRange} textRange\n     * @param {Boolean} isStart\n     * @return {BoundaryPoint}\n     *\n     * @see http://msdn.microsoft.com/en-us/library/ie/ms535872(v=vs.85).aspx\n     */\n    var textRangeToPoint = function (textRange, isStart) {\n      var container = textRange.parentElement(), offset;\n  \n      var tester = document.body.createTextRange(), prevContainer;\n      var childNodes = list.from(container.childNodes);\n      for (offset = 0; offset < childNodes.length; offset++) {\n        if (dom.isText(childNodes[offset])) {\n          continue;\n        }\n        tester.moveToElementText(childNodes[offset]);\n        if (tester.compareEndPoints('StartToStart', textRange) >= 0) {\n          break;\n        }\n        prevContainer = childNodes[offset];\n      }\n  \n      if (offset !== 0 && dom.isText(childNodes[offset - 1])) {\n        var textRangeStart = document.body.createTextRange(), curTextNode = null;\n        textRangeStart.moveToElementText(prevContainer || container);\n        textRangeStart.collapse(!prevContainer);\n        curTextNode = prevContainer ? prevContainer.nextSibling : container.firstChild;\n  \n        var pointTester = textRange.duplicate();\n        pointTester.setEndPoint('StartToStart', textRangeStart);\n        var textCount = pointTester.text.replace(/[\\r\\n]/g, '').length;\n  \n        while (textCount > curTextNode.nodeValue.length && curTextNode.nextSibling) {\n          textCount -= curTextNode.nodeValue.length;\n          curTextNode = curTextNode.nextSibling;\n        }\n  \n        /* jshint ignore:start */\n        var dummy = curTextNode.nodeValue; // enforce IE to re-reference curTextNode, hack\n        /* jshint ignore:end */\n  \n        if (isStart && curTextNode.nextSibling && dom.isText(curTextNode.nextSibling) &&\n            textCount === curTextNode.nodeValue.length) {\n          textCount -= curTextNode.nodeValue.length;\n          curTextNode = curTextNode.nextSibling;\n        }\n  \n        container = curTextNode;\n        offset = textCount;\n      }\n  \n      return {\n        cont: container,\n        offset: offset\n      };\n    };\n    \n    /**\n     * return TextRange from boundary point (inspired by google closure-library)\n     * @param {BoundaryPoint} point\n     * @return {TextRange}\n     */\n    var pointToTextRange = function (point) {\n      var textRangeInfo = function (container, offset) {\n        var node, isCollapseToStart;\n  \n        if (dom.isText(container)) {\n          var prevTextNodes = dom.listPrev(container, func.not(dom.isText));\n          var prevContainer = list.last(prevTextNodes).previousSibling;\n          node =  prevContainer || container.parentNode;\n          offset += list.sum(list.tail(prevTextNodes), dom.nodeLength);\n          isCollapseToStart = !prevContainer;\n        } else {\n          node = container.childNodes[offset] || container;\n          if (dom.isText(node)) {\n            return textRangeInfo(node, 0);\n          }\n  \n          offset = 0;\n          isCollapseToStart = false;\n        }\n  \n        return {\n          node: node,\n          collapseToStart: isCollapseToStart,\n          offset: offset\n        };\n      };\n  \n      var textRange = document.body.createTextRange();\n      var info = textRangeInfo(point.node, point.offset);\n  \n      textRange.moveToElementText(info.node);\n      textRange.collapse(info.collapseToStart);\n      textRange.moveStart('character', info.offset);\n      return textRange;\n    };\n    \n    /**\n     * Wrapped Range\n     *\n     * @constructor\n     * @param {Node} sc - start container\n     * @param {Number} so - start offset\n     * @param {Node} ec - end container\n     * @param {Number} eo - end offset\n     */\n    var WrappedRange = function (sc, so, ec, eo) {\n      this.sc = sc;\n      this.so = so;\n      this.ec = ec;\n      this.eo = eo;\n  \n      // nativeRange: get nativeRange from sc, so, ec, eo\n      var nativeRange = function () {\n        if (agent.isW3CRangeSupport) {\n          var w3cRange = document.createRange();\n          w3cRange.setStart(sc, so);\n          w3cRange.setEnd(ec, eo);\n\n          return w3cRange;\n        } else {\n          var textRange = pointToTextRange({\n            node: sc,\n            offset: so\n          });\n\n          textRange.setEndPoint('EndToEnd', pointToTextRange({\n            node: ec,\n            offset: eo\n          }));\n\n          return textRange;\n        }\n      };\n\n      this.getPoints = function () {\n        return {\n          sc: sc,\n          so: so,\n          ec: ec,\n          eo: eo\n        };\n      };\n\n      this.getStartPoint = function () {\n        return {\n          node: sc,\n          offset: so\n        };\n      };\n\n      this.getEndPoint = function () {\n        return {\n          node: ec,\n          offset: eo\n        };\n      };\n\n      /**\n       * select update visible range\n       */\n      this.select = function () {\n        var nativeRng = nativeRange();\n        if (agent.isW3CRangeSupport) {\n          var selection = document.getSelection();\n          if (selection.rangeCount > 0) {\n            selection.removeAllRanges();\n          }\n          selection.addRange(nativeRng);\n        } else {\n          nativeRng.select();\n        }\n        \n        return this;\n      };\n\n      /**\n       * Moves the scrollbar to start container(sc) of current range\n       *\n       * @return {WrappedRange}\n       */\n      this.scrollIntoView = function (container) {\n        var height = $(container).height();\n        if (container.scrollTop + height < this.sc.offsetTop) {\n          container.scrollTop += Math.abs(container.scrollTop + height - this.sc.offsetTop);\n        }\n\n        return this;\n      };\n\n      /**\n       * @return {WrappedRange}\n       */\n      this.normalize = function () {\n\n        /**\n         * @param {BoundaryPoint} point\n         * @param {Boolean} isLeftToRight\n         * @return {BoundaryPoint}\n         */\n        var getVisiblePoint = function (point, isLeftToRight) {\n          if ((dom.isVisiblePoint(point) && !dom.isEdgePoint(point)) ||\n              (dom.isVisiblePoint(point) && dom.isRightEdgePoint(point) && !isLeftToRight) ||\n              (dom.isVisiblePoint(point) && dom.isLeftEdgePoint(point) && isLeftToRight) ||\n              (dom.isVisiblePoint(point) && dom.isBlock(point.node) && dom.isEmpty(point.node))) {\n            return point;\n          }\n\n          // point on block's edge\n          var block = dom.ancestor(point.node, dom.isBlock);\n          if (((dom.isLeftEdgePointOf(point, block) || dom.isVoid(dom.prevPoint(point).node)) && !isLeftToRight) ||\n              ((dom.isRightEdgePointOf(point, block) || dom.isVoid(dom.nextPoint(point).node)) && isLeftToRight)) {\n\n            // returns point already on visible point\n            if (dom.isVisiblePoint(point)) {\n              return point;\n            }\n            // reverse direction \n            isLeftToRight = !isLeftToRight;\n          }\n\n          var nextPoint = isLeftToRight ? dom.nextPointUntil(dom.nextPoint(point), dom.isVisiblePoint) :\n                                          dom.prevPointUntil(dom.prevPoint(point), dom.isVisiblePoint);\n          return nextPoint || point;\n        };\n\n        var endPoint = getVisiblePoint(this.getEndPoint(), false);\n        var startPoint = this.isCollapsed() ? endPoint : getVisiblePoint(this.getStartPoint(), true);\n\n        return new WrappedRange(\n          startPoint.node,\n          startPoint.offset,\n          endPoint.node,\n          endPoint.offset\n        );\n      };\n\n      /**\n       * returns matched nodes on range\n       *\n       * @param {Function} [pred] - predicate function\n       * @param {Object} [options]\n       * @param {Boolean} [options.includeAncestor]\n       * @param {Boolean} [options.fullyContains]\n       * @return {Node[]}\n       */\n      this.nodes = function (pred, options) {\n        pred = pred || func.ok;\n\n        var includeAncestor = options && options.includeAncestor;\n        var fullyContains = options && options.fullyContains;\n\n        // TODO compare points and sort\n        var startPoint = this.getStartPoint();\n        var endPoint = this.getEndPoint();\n\n        var nodes = [];\n        var leftEdgeNodes = [];\n\n        dom.walkPoint(startPoint, endPoint, function (point) {\n          if (dom.isEditable(point.node)) {\n            return;\n          }\n\n          var node;\n          if (fullyContains) {\n            if (dom.isLeftEdgePoint(point)) {\n              leftEdgeNodes.push(point.node);\n            }\n            if (dom.isRightEdgePoint(point) && list.contains(leftEdgeNodes, point.node)) {\n              node = point.node;\n            }\n          } else if (includeAncestor) {\n            node = dom.ancestor(point.node, pred);\n          } else {\n            node = point.node;\n          }\n\n          if (node && pred(node)) {\n            nodes.push(node);\n          }\n        }, true);\n\n        return list.unique(nodes);\n      };\n\n      /**\n       * returns commonAncestor of range\n       * @return {Element} - commonAncestor\n       */\n      this.commonAncestor = function () {\n        return dom.commonAncestor(sc, ec);\n      };\n\n      /**\n       * returns expanded range by pred\n       *\n       * @param {Function} pred - predicate function\n       * @return {WrappedRange}\n       */\n      this.expand = function (pred) {\n        var startAncestor = dom.ancestor(sc, pred);\n        var endAncestor = dom.ancestor(ec, pred);\n\n        if (!startAncestor && !endAncestor) {\n          return new WrappedRange(sc, so, ec, eo);\n        }\n\n        var boundaryPoints = this.getPoints();\n\n        if (startAncestor) {\n          boundaryPoints.sc = startAncestor;\n          boundaryPoints.so = 0;\n        }\n\n        if (endAncestor) {\n          boundaryPoints.ec = endAncestor;\n          boundaryPoints.eo = dom.nodeLength(endAncestor);\n        }\n\n        return new WrappedRange(\n          boundaryPoints.sc,\n          boundaryPoints.so,\n          boundaryPoints.ec,\n          boundaryPoints.eo\n        );\n      };\n\n      /**\n       * @param {Boolean} isCollapseToStart\n       * @return {WrappedRange}\n       */\n      this.collapse = function (isCollapseToStart) {\n        if (isCollapseToStart) {\n          return new WrappedRange(sc, so, sc, so);\n        } else {\n          return new WrappedRange(ec, eo, ec, eo);\n        }\n      };\n\n      /**\n       * splitText on range\n       */\n      this.splitText = function () {\n        var isSameContainer = sc === ec;\n        var boundaryPoints = this.getPoints();\n\n        if (dom.isText(ec) && !dom.isEdgePoint(this.getEndPoint())) {\n          ec.splitText(eo);\n        }\n\n        if (dom.isText(sc) && !dom.isEdgePoint(this.getStartPoint())) {\n          boundaryPoints.sc = sc.splitText(so);\n          boundaryPoints.so = 0;\n\n          if (isSameContainer) {\n            boundaryPoints.ec = boundaryPoints.sc;\n            boundaryPoints.eo = eo - so;\n          }\n        }\n\n        return new WrappedRange(\n          boundaryPoints.sc,\n          boundaryPoints.so,\n          boundaryPoints.ec,\n          boundaryPoints.eo\n        );\n      };\n\n      /**\n       * delete contents on range\n       * @return {WrappedRange}\n       */\n      this.deleteContents = function () {\n        if (this.isCollapsed()) {\n          return this;\n        }\n\n        var rng = this.splitText();\n        var nodes = rng.nodes(null, {\n          fullyContains: true\n        });\n\n        // find new cursor point\n        var point = dom.prevPointUntil(rng.getStartPoint(), function (point) {\n          return !list.contains(nodes, point.node);\n        });\n\n        var emptyParents = [];\n        $.each(nodes, function (idx, node) {\n          // find empty parents\n          var parent = node.parentNode;\n          if (point.node !== parent && dom.nodeLength(parent) === 1) {\n            emptyParents.push(parent);\n          }\n          dom.remove(node, false);\n        });\n\n        // remove empty parents\n        $.each(emptyParents, function (idx, node) {\n          dom.remove(node, false);\n        });\n\n        return new WrappedRange(\n          point.node,\n          point.offset,\n          point.node,\n          point.offset\n        ).normalize();\n      };\n      \n      /**\n       * makeIsOn: return isOn(pred) function\n       */\n      var makeIsOn = function (pred) {\n        return function () {\n          var ancestor = dom.ancestor(sc, pred);\n          return !!ancestor && (ancestor === dom.ancestor(ec, pred));\n        };\n      };\n  \n      // isOnEditable: judge whether range is on editable or not\n      this.isOnEditable = makeIsOn(dom.isEditable);\n      // isOnList: judge whether range is on list node or not\n      this.isOnList = makeIsOn(dom.isList);\n      // isOnAnchor: judge whether range is on anchor node or not\n      this.isOnAnchor = makeIsOn(dom.isAnchor);\n      // isOnCell: judge whether range is on cell node or not\n      this.isOnCell = makeIsOn(dom.isCell);\n      // isOnData: judge whether range is on data node or not\n      this.isOnData = makeIsOn(dom.isData);\n\n      /**\n       * @param {Function} pred\n       * @return {Boolean}\n       */\n      this.isLeftEdgeOf = function (pred) {\n        if (!dom.isLeftEdgePoint(this.getStartPoint())) {\n          return false;\n        }\n\n        var node = dom.ancestor(this.sc, pred);\n        return node && dom.isLeftEdgeOf(this.sc, node);\n      };\n\n      /**\n       * returns whether range was collapsed or not\n       */\n      this.isCollapsed = function () {\n        return sc === ec && so === eo;\n      };\n\n      /**\n       * wrap inline nodes which children of body with paragraph\n       *\n       * @return {WrappedRange}\n       */\n      this.wrapBodyInlineWithPara = function () {\n        if (dom.isBodyContainer(sc) && dom.isEmpty(sc)) {\n          sc.innerHTML = dom.emptyPara;\n          return new WrappedRange(sc.firstChild, 0, sc.firstChild, 0);\n        }\n\n        /**\n         * [workaround] firefox often create range on not visible point. so normalize here.\n         *  - firefox: |<p>text</p>|\n         *  - chrome: <p>|text|</p>\n         */\n        var rng = this.normalize();\n        if (dom.isParaInline(sc) || dom.isPara(sc)) {\n          return rng;\n        }\n\n        // find inline top ancestor\n        var topAncestor;\n        if (dom.isInline(rng.sc)) {\n          var ancestors = dom.listAncestor(rng.sc, func.not(dom.isInline));\n          topAncestor = list.last(ancestors);\n          if (!dom.isInline(topAncestor)) {\n            topAncestor = ancestors[ancestors.length - 2] || rng.sc.childNodes[rng.so];\n          }\n        } else {\n          topAncestor = rng.sc.childNodes[rng.so > 0 ? rng.so - 1 : 0];\n        }\n\n        // siblings not in paragraph\n        var inlineSiblings = dom.listPrev(topAncestor, dom.isParaInline).reverse();\n        inlineSiblings = inlineSiblings.concat(dom.listNext(topAncestor.nextSibling, dom.isParaInline));\n\n        // wrap with paragraph\n        if (inlineSiblings.length) {\n          var para = dom.wrap(list.head(inlineSiblings), 'p');\n          dom.appendChildNodes(para, list.tail(inlineSiblings));\n        }\n\n        return this.normalize();\n      };\n\n      /**\n       * insert node at current cursor\n       *\n       * @param {Node} node\n       * @return {Node}\n       */\n      this.insertNode = function (node) {\n        var rng = this.wrapBodyInlineWithPara().deleteContents();\n        var info = dom.splitPoint(rng.getStartPoint(), dom.isInline(node));\n\n        if (info.rightNode) {\n          info.rightNode.parentNode.insertBefore(node, info.rightNode);\n        } else {\n          info.container.appendChild(node);\n        }\n\n        return node;\n      };\n\n      /**\n       * insert html at current cursor\n       */\n      this.pasteHTML = function (markup) {\n        var contentsContainer = $('<div></div>').html(markup)[0];\n        var childNodes = list.from(contentsContainer.childNodes);\n\n        var rng = this.wrapBodyInlineWithPara().deleteContents();\n\n        return childNodes.reverse().map(function (childNode) {\n          return rng.insertNode(childNode);\n        }).reverse();\n      };\n  \n      /**\n       * returns text in range\n       *\n       * @return {String}\n       */\n      this.toString = function () {\n        var nativeRng = nativeRange();\n        return agent.isW3CRangeSupport ? nativeRng.toString() : nativeRng.text;\n      };\n\n      /**\n       * returns range for word before cursor\n       *\n       * @param {Boolean} [findAfter] - find after cursor, default: false\n       * @return {WrappedRange}\n       */\n      this.getWordRange = function (findAfter) {\n        var endPoint = this.getEndPoint();\n\n        if (!dom.isCharPoint(endPoint)) {\n          return this;\n        }\n\n        var startPoint = dom.prevPointUntil(endPoint, function (point) {\n          return !dom.isCharPoint(point);\n        });\n\n        if (findAfter) {\n          endPoint = dom.nextPointUntil(endPoint, function (point) {\n            return !dom.isCharPoint(point);\n          });\n        }\n\n        return new WrappedRange(\n          startPoint.node,\n          startPoint.offset,\n          endPoint.node,\n          endPoint.offset\n        );\n      };\n  \n      /**\n       * create offsetPath bookmark\n       *\n       * @param {Node} editable\n       */\n      this.bookmark = function (editable) {\n        return {\n          s: {\n            path: dom.makeOffsetPath(editable, sc),\n            offset: so\n          },\n          e: {\n            path: dom.makeOffsetPath(editable, ec),\n            offset: eo\n          }\n        };\n      };\n\n      /**\n       * create offsetPath bookmark base on paragraph\n       *\n       * @param {Node[]} paras\n       */\n      this.paraBookmark = function (paras) {\n        return {\n          s: {\n            path: list.tail(dom.makeOffsetPath(list.head(paras), sc)),\n            offset: so\n          },\n          e: {\n            path: list.tail(dom.makeOffsetPath(list.last(paras), ec)),\n            offset: eo\n          }\n        };\n      };\n\n      /**\n       * getClientRects\n       * @return {Rect[]}\n       */\n      this.getClientRects = function () {\n        var nativeRng = nativeRange();\n        return nativeRng.getClientRects();\n      };\n    };\n\n  /**\n   * @class core.range\n   *\n   * Data structure\n   *  * BoundaryPoint: a point of dom tree\n   *  * BoundaryPoints: two boundaryPoints corresponding to the start and the end of the Range\n   *\n   * See to http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Position\n   *\n   * @singleton\n   * @alternateClassName range\n   */\n    return {\n      /**\n       * create Range Object From arguments or Browser Selection\n       *\n       * @param {Node} sc - start container\n       * @param {Number} so - start offset\n       * @param {Node} ec - end container\n       * @param {Number} eo - end offset\n       * @return {WrappedRange}\n       */\n      create: function (sc, so, ec, eo) {\n        if (arguments.length === 4) {\n          return new WrappedRange(sc, so, ec, eo);\n        } else if (arguments.length === 2) { //collapsed\n          ec = sc;\n          eo = so;\n          return new WrappedRange(sc, so, ec, eo);\n        } else {\n          var wrappedRange = this.createFromSelection();\n          if (!wrappedRange && arguments.length === 1) {\n            wrappedRange = this.createFromNode(arguments[0]);\n            return wrappedRange.collapse(dom.emptyPara === arguments[0].innerHTML);\n          }\n          return wrappedRange;\n        }\n      },\n\n      createFromSelection: function () {\n        var sc, so, ec, eo;\n        if (agent.isW3CRangeSupport) {\n          var selection = document.getSelection();\n          if (!selection || selection.rangeCount === 0) {\n            return null;\n          } else if (dom.isBody(selection.anchorNode)) {\n            // Firefox: returns entire body as range on initialization.\n            // We won't never need it.\n            return null;\n          }\n\n          var nativeRng = selection.getRangeAt(0);\n          sc = nativeRng.startContainer;\n          so = nativeRng.startOffset;\n          ec = nativeRng.endContainer;\n          eo = nativeRng.endOffset;\n        } else { // IE8: TextRange\n          var textRange = document.selection.createRange();\n          var textRangeEnd = textRange.duplicate();\n          textRangeEnd.collapse(false);\n          var textRangeStart = textRange;\n          textRangeStart.collapse(true);\n\n          var startPoint = textRangeToPoint(textRangeStart, true),\n          endPoint = textRangeToPoint(textRangeEnd, false);\n\n          // same visible point case: range was collapsed.\n          if (dom.isText(startPoint.node) && dom.isLeftEdgePoint(startPoint) &&\n              dom.isTextNode(endPoint.node) && dom.isRightEdgePoint(endPoint) &&\n              endPoint.node.nextSibling === startPoint.node) {\n            startPoint = endPoint;\n          }\n\n          sc = startPoint.cont;\n          so = startPoint.offset;\n          ec = endPoint.cont;\n          eo = endPoint.offset;\n        }\n\n        return new WrappedRange(sc, so, ec, eo);\n      },\n\n      /**\n       * @method \n       * \n       * create WrappedRange from node\n       *\n       * @param {Node} node\n       * @return {WrappedRange}\n       */\n      createFromNode: function (node) {\n        var sc = node;\n        var so = 0;\n        var ec = node;\n        var eo = dom.nodeLength(ec);\n\n        // browsers can't target a picture or void node\n        if (dom.isVoid(sc)) {\n          so = dom.listPrev(sc).length - 1;\n          sc = sc.parentNode;\n        }\n        if (dom.isBR(ec)) {\n          eo = dom.listPrev(ec).length - 1;\n          ec = ec.parentNode;\n        } else if (dom.isVoid(ec)) {\n          eo = dom.listPrev(ec).length;\n          ec = ec.parentNode;\n        }\n\n        return this.create(sc, so, ec, eo);\n      },\n\n      /**\n       * create WrappedRange from node after position\n       *\n       * @param {Node} node\n       * @return {WrappedRange}\n       */\n      createFromNodeBefore: function (node) {\n        return this.createFromNode(node).collapse(true);\n      },\n\n      /**\n       * create WrappedRange from node after position\n       *\n       * @param {Node} node\n       * @return {WrappedRange}\n       */\n      createFromNodeAfter: function (node) {\n        return this.createFromNode(node).collapse();\n      },\n\n      /**\n       * @method \n       * \n       * create WrappedRange from bookmark\n       *\n       * @param {Node} editable\n       * @param {Object} bookmark\n       * @return {WrappedRange}\n       */\n      createFromBookmark: function (editable, bookmark) {\n        var sc = dom.fromOffsetPath(editable, bookmark.s.path);\n        var so = bookmark.s.offset;\n        var ec = dom.fromOffsetPath(editable, bookmark.e.path);\n        var eo = bookmark.e.offset;\n        return new WrappedRange(sc, so, ec, eo);\n      },\n\n      /**\n       * @method \n       *\n       * create WrappedRange from paraBookmark\n       *\n       * @param {Object} bookmark\n       * @param {Node[]} paras\n       * @return {WrappedRange}\n       */\n      createFromParaBookmark: function (bookmark, paras) {\n        var so = bookmark.s.offset;\n        var eo = bookmark.e.offset;\n        var sc = dom.fromOffsetPath(list.head(paras), bookmark.s.path);\n        var ec = dom.fromOffsetPath(list.last(paras), bookmark.e.path);\n\n        return new WrappedRange(sc, so, ec, eo);\n      }\n    };\n  })();\n\n  /**\n   * @class core.async\n   *\n   * Async functions which returns `Promise`\n   *\n   * @singleton\n   * @alternateClassName async\n   */\n  var async = (function () {\n    /**\n     * @method readFileAsDataURL\n     *\n     * read contents of file as representing URL\n     *\n     * @param {File} file\n     * @return {Promise} - then: dataUrl\n     */\n    var readFileAsDataURL = function (file) {\n      return $.Deferred(function (deferred) {\n        $.extend(new FileReader(), {\n          onload: function (e) {\n            var dataURL = e.target.result;\n            deferred.resolve(dataURL);\n          },\n          onerror: function () {\n            deferred.reject(this);\n          }\n        }).readAsDataURL(file);\n      }).promise();\n    };\n  \n    /**\n     * @method createImage\n     *\n     * create `<image>` from url string\n     *\n     * @param {String} url\n     * @return {Promise} - then: $image\n     */\n    var createImage = function (url) {\n      return $.Deferred(function (deferred) {\n        var $img = $('<img>');\n\n        $img.one('load', function () {\n          $img.off('error abort');\n          deferred.resolve($img);\n        }).one('error abort', function () {\n          $img.off('load').detach();\n          deferred.reject($img);\n        }).css({\n          display: 'none'\n        }).appendTo(document.body).attr('src', url);\n      }).promise();\n    };\n\n    return {\n      readFileAsDataURL: readFileAsDataURL,\n      createImage: createImage\n    };\n  })();\n\n  /**\n   * @class editing.History\n   *\n   * Editor History\n   *\n   */\n  var History = function ($editable) {\n    var stack = [], stackOffset = -1;\n    var editable = $editable[0];\n\n    var makeSnapshot = function () {\n      var rng = range.create(editable);\n      var emptyBookmark = {s: {path: [], offset: 0}, e: {path: [], offset: 0}};\n\n      return {\n        contents: $editable.html(),\n        bookmark: (rng ? rng.bookmark(editable) : emptyBookmark)\n      };\n    };\n\n    var applySnapshot = function (snapshot) {\n      if (snapshot.contents !== null) {\n        $editable.html(snapshot.contents);\n      }\n      if (snapshot.bookmark !== null) {\n        range.createFromBookmark(editable, snapshot.bookmark).select();\n      }\n    };\n\n    /**\n    * @method rewind\n    * Rewinds the history stack back to the first snapshot taken.\n    * Leaves the stack intact, so that \"Redo\" can still be used.\n    */\n    this.rewind = function () {\n      // Create snap shot if not yet recorded\n      if ($editable.html() !== stack[stackOffset].contents) {\n        this.recordUndo();\n      }\n\n      // Return to the first available snapshot.\n      stackOffset = 0;\n\n      // Apply that snapshot.\n      applySnapshot(stack[stackOffset]);\n    };\n\n    /**\n    * @method reset\n    * Resets the history stack completely; reverting to an empty editor.\n    */\n    this.reset = function () {\n      // Clear the stack.\n      stack = [];\n\n      // Restore stackOffset to its original value.\n      stackOffset = -1;\n\n      // Clear the editable area.\n      $editable.html('');\n\n      // Record our first snapshot (of nothing).\n      this.recordUndo();\n    };\n\n    /**\n     * undo\n     */\n    this.undo = function () {\n      // Create snap shot if not yet recorded\n      if ($editable.html() !== stack[stackOffset].contents) {\n        this.recordUndo();\n      }\n\n      if (0 < stackOffset) {\n        stackOffset--;\n        applySnapshot(stack[stackOffset]);\n      }\n    };\n\n    /**\n     * redo\n     */\n    this.redo = function () {\n      if (stack.length - 1 > stackOffset) {\n        stackOffset++;\n        applySnapshot(stack[stackOffset]);\n      }\n    };\n\n    /**\n     * recorded undo\n     */\n    this.recordUndo = function () {\n      stackOffset++;\n\n      // Wash out stack after stackOffset\n      if (stack.length > stackOffset) {\n        stack = stack.slice(0, stackOffset);\n      }\n\n      // Create new snapshot and push it to the end\n      stack.push(makeSnapshot());\n    };\n  };\n\n  /**\n   * @class editing.Style\n   *\n   * Style\n   *\n   */\n  var Style = function () {\n    /**\n     * @method jQueryCSS\n     *\n     * [workaround] for old jQuery\n     * passing an array of style properties to .css()\n     * will result in an object of property-value pairs.\n     * (compability with version < 1.9)\n     *\n     * @private\n     * @param  {jQuery} $obj\n     * @param  {Array} propertyNames - An array of one or more CSS properties.\n     * @return {Object}\n     */\n    var jQueryCSS = function ($obj, propertyNames) {\n      if (agent.jqueryVersion < 1.9) {\n        var result = {};\n        $.each(propertyNames, function (idx, propertyName) {\n          result[propertyName] = $obj.css(propertyName);\n        });\n        return result;\n      }\n      return $obj.css.call($obj, propertyNames);\n    };\n\n    /**\n     * returns style object from node\n     *\n     * @param {jQuery} $node\n     * @return {Object}\n     */\n    this.fromNode = function ($node) {\n      var properties = ['font-family', 'font-size', 'text-align', 'list-style-type', 'line-height'];\n      var styleInfo = jQueryCSS($node, properties) || {};\n      styleInfo['font-size'] = parseInt(styleInfo['font-size'], 10);\n      return styleInfo;\n    };\n\n    /**\n     * paragraph level style\n     *\n     * @param {WrappedRange} rng\n     * @param {Object} styleInfo\n     */\n    this.stylePara = function (rng, styleInfo) {\n      $.each(rng.nodes(dom.isPara, {\n        includeAncestor: true\n      }), function (idx, para) {\n        $(para).css(styleInfo);\n      });\n    };\n\n    /**\n     * insert and returns styleNodes on range.\n     *\n     * @param {WrappedRange} rng\n     * @param {Object} [options] - options for styleNodes\n     * @param {String} [options.nodeName] - default: `SPAN`\n     * @param {Boolean} [options.expandClosestSibling] - default: `false`\n     * @param {Boolean} [options.onlyPartialContains] - default: `false`\n     * @return {Node[]}\n     */\n    this.styleNodes = function (rng, options) {\n      rng = rng.splitText();\n\n      var nodeName = options && options.nodeName || 'SPAN';\n      var expandClosestSibling = !!(options && options.expandClosestSibling);\n      var onlyPartialContains = !!(options && options.onlyPartialContains);\n\n      if (rng.isCollapsed()) {\n        return [rng.insertNode(dom.create(nodeName))];\n      }\n\n      var pred = dom.makePredByNodeName(nodeName);\n      var nodes = rng.nodes(dom.isText, {\n        fullyContains: true\n      }).map(function (text) {\n        return dom.singleChildAncestor(text, pred) || dom.wrap(text, nodeName);\n      });\n\n      if (expandClosestSibling) {\n        if (onlyPartialContains) {\n          var nodesInRange = rng.nodes();\n          // compose with partial contains predication\n          pred = func.and(pred, function (node) {\n            return list.contains(nodesInRange, node);\n          });\n        }\n\n        return nodes.map(function (node) {\n          var siblings = dom.withClosestSiblings(node, pred);\n          var head = list.head(siblings);\n          var tails = list.tail(siblings);\n          $.each(tails, function (idx, elem) {\n            dom.appendChildNodes(head, elem.childNodes);\n            dom.remove(elem);\n          });\n          return list.head(siblings);\n        });\n      } else {\n        return nodes;\n      }\n    };\n\n    /**\n     * get current style on cursor\n     *\n     * @param {WrappedRange} rng\n     * @return {Object} - object contains style properties.\n     */\n    this.current = function (rng) {\n      var $cont = $(!dom.isElement(rng.sc) ? rng.sc.parentNode : rng.sc);\n      var styleInfo = this.fromNode($cont);\n\n      // document.queryCommandState for toggle state\n      // [workaround] prevent Firefox nsresult: \"0x80004005 (NS_ERROR_FAILURE)\"\n      try {\n        styleInfo = $.extend(styleInfo, {\n          'font-bold': document.queryCommandState('bold') ? 'bold' : 'normal',\n          'font-italic': document.queryCommandState('italic') ? 'italic' : 'normal',\n          'font-underline': document.queryCommandState('underline') ? 'underline' : 'normal',\n          'font-subscript': document.queryCommandState('subscript') ? 'subscript' : 'normal',\n          'font-superscript': document.queryCommandState('superscript') ? 'superscript' : 'normal',\n          'font-strikethrough': document.queryCommandState('strikethrough') ? 'strikethrough' : 'normal'\n        });\n      } catch (e) {}\n\n      // list-style-type to list-style(unordered, ordered)\n      if (!rng.isOnList()) {\n        styleInfo['list-style'] = 'none';\n      } else {\n        var orderedTypes = ['circle', 'disc', 'disc-leading-zero', 'square'];\n        var isUnordered = $.inArray(styleInfo['list-style-type'], orderedTypes) > -1;\n        styleInfo['list-style'] = isUnordered ? 'unordered' : 'ordered';\n      }\n\n      var para = dom.ancestor(rng.sc, dom.isPara);\n      if (para && para.style['line-height']) {\n        styleInfo['line-height'] = para.style.lineHeight;\n      } else {\n        var lineHeight = parseInt(styleInfo['line-height'], 10) / parseInt(styleInfo['font-size'], 10);\n        styleInfo['line-height'] = lineHeight.toFixed(1);\n      }\n\n      styleInfo.anchor = rng.isOnAnchor() && dom.ancestor(rng.sc, dom.isAnchor);\n      styleInfo.ancestors = dom.listAncestor(rng.sc, dom.isEditable);\n      styleInfo.range = rng;\n\n      return styleInfo;\n    };\n  };\n\n\n  /**\n   * @class editing.Bullet\n   *\n   * @alternateClassName Bullet\n   */\n  var Bullet = function () {\n    var self = this;\n\n    /**\n     * toggle ordered list\n     */\n    this.insertOrderedList = function (editable) {\n      this.toggleList('OL', editable);\n    };\n\n    /**\n     * toggle unordered list\n     */\n    this.insertUnorderedList = function (editable) {\n      this.toggleList('UL', editable);\n    };\n\n    /**\n     * indent\n     */\n    this.indent = function (editable) {\n      var self = this;\n      var rng = range.create(editable).wrapBodyInlineWithPara();\n\n      var paras = rng.nodes(dom.isPara, { includeAncestor: true });\n      var clustereds = list.clusterBy(paras, func.peq2('parentNode'));\n\n      $.each(clustereds, function (idx, paras) {\n        var head = list.head(paras);\n        if (dom.isLi(head)) {\n          self.wrapList(paras, head.parentNode.nodeName);\n        } else {\n          $.each(paras, function (idx, para) {\n            $(para).css('marginLeft', function (idx, val) {\n              return (parseInt(val, 10) || 0) + 25;\n            });\n          });\n        }\n      });\n\n      rng.select();\n    };\n\n    /**\n     * outdent\n     */\n    this.outdent = function (editable) {\n      var self = this;\n      var rng = range.create(editable).wrapBodyInlineWithPara();\n\n      var paras = rng.nodes(dom.isPara, { includeAncestor: true });\n      var clustereds = list.clusterBy(paras, func.peq2('parentNode'));\n\n      $.each(clustereds, function (idx, paras) {\n        var head = list.head(paras);\n        if (dom.isLi(head)) {\n          self.releaseList([paras]);\n        } else {\n          $.each(paras, function (idx, para) {\n            $(para).css('marginLeft', function (idx, val) {\n              val = (parseInt(val, 10) || 0);\n              return val > 25 ? val - 25 : '';\n            });\n          });\n        }\n      });\n\n      rng.select();\n    };\n\n    /**\n     * toggle list\n     *\n     * @param {String} listName - OL or UL\n     */\n    this.toggleList = function (listName, editable) {\n      var rng = range.create(editable).wrapBodyInlineWithPara();\n\n      var paras = rng.nodes(dom.isPara, { includeAncestor: true });\n      var bookmark = rng.paraBookmark(paras);\n      var clustereds = list.clusterBy(paras, func.peq2('parentNode'));\n\n      // paragraph to list\n      if (list.find(paras, dom.isPurePara)) {\n        var wrappedParas = [];\n        $.each(clustereds, function (idx, paras) {\n          wrappedParas = wrappedParas.concat(self.wrapList(paras, listName));\n        });\n        paras = wrappedParas;\n      // list to paragraph or change list style\n      } else {\n        var diffLists = rng.nodes(dom.isList, {\n          includeAncestor: true\n        }).filter(function (listNode) {\n          return !$.nodeName(listNode, listName);\n        });\n\n        if (diffLists.length) {\n          $.each(diffLists, function (idx, listNode) {\n            dom.replace(listNode, listName);\n          });\n        } else {\n          paras = this.releaseList(clustereds, true);\n        }\n      }\n\n      range.createFromParaBookmark(bookmark, paras).select();\n    };\n\n    /**\n     * @param {Node[]} paras\n     * @param {String} listName\n     * @return {Node[]}\n     */\n    this.wrapList = function (paras, listName) {\n      var head = list.head(paras);\n      var last = list.last(paras);\n\n      var prevList = dom.isList(head.previousSibling) && head.previousSibling;\n      var nextList = dom.isList(last.nextSibling) && last.nextSibling;\n\n      var listNode = prevList || dom.insertAfter(dom.create(listName || 'UL'), last);\n\n      // P to LI\n      paras = paras.map(function (para) {\n        return dom.isPurePara(para) ? dom.replace(para, 'LI') : para;\n      });\n\n      // append to list(<ul>, <ol>)\n      dom.appendChildNodes(listNode, paras);\n\n      if (nextList) {\n        dom.appendChildNodes(listNode, list.from(nextList.childNodes));\n        dom.remove(nextList);\n      }\n\n      return paras;\n    };\n\n    /**\n     * @method releaseList\n     *\n     * @param {Array[]} clustereds\n     * @param {Boolean} isEscapseToBody\n     * @return {Node[]}\n     */\n    this.releaseList = function (clustereds, isEscapseToBody) {\n      var releasedParas = [];\n\n      $.each(clustereds, function (idx, paras) {\n        var head = list.head(paras);\n        var last = list.last(paras);\n\n        var headList = isEscapseToBody ? dom.lastAncestor(head, dom.isList) :\n                                         head.parentNode;\n        var lastList = headList.childNodes.length > 1 ? dom.splitTree(headList, {\n          node: last.parentNode,\n          offset: dom.position(last) + 1\n        }, {\n          isSkipPaddingBlankHTML: true\n        }) : null;\n\n        var middleList = dom.splitTree(headList, {\n          node: head.parentNode,\n          offset: dom.position(head)\n        }, {\n          isSkipPaddingBlankHTML: true\n        });\n\n        paras = isEscapseToBody ? dom.listDescendant(middleList, dom.isLi) :\n                                  list.from(middleList.childNodes).filter(dom.isLi);\n\n        // LI to P\n        if (isEscapseToBody || !dom.isList(headList.parentNode)) {\n          paras = paras.map(function (para) {\n            return dom.replace(para, 'P');\n          });\n        }\n\n        $.each(list.from(paras).reverse(), function (idx, para) {\n          dom.insertAfter(para, headList);\n        });\n\n        // remove empty lists\n        var rootLists = list.compact([headList, middleList, lastList]);\n        $.each(rootLists, function (idx, rootList) {\n          var listNodes = [rootList].concat(dom.listDescendant(rootList, dom.isList));\n          $.each(listNodes.reverse(), function (idx, listNode) {\n            if (!dom.nodeLength(listNode)) {\n              dom.remove(listNode, true);\n            }\n          });\n        });\n\n        releasedParas = releasedParas.concat(paras);\n      });\n\n      return releasedParas;\n    };\n  };\n\n\n  /**\n   * @class editing.Typing\n   *\n   * Typing\n   *\n   */\n  var Typing = function () {\n\n    // a Bullet instance to toggle lists off\n    var bullet = new Bullet();\n\n    /**\n     * insert tab\n     *\n     * @param {WrappedRange} rng\n     * @param {Number} tabsize\n     */\n    this.insertTab = function (rng, tabsize) {\n      var tab = dom.createText(new Array(tabsize + 1).join(dom.NBSP_CHAR));\n      rng = rng.deleteContents();\n      rng.insertNode(tab, true);\n\n      rng = range.create(tab, tabsize);\n      rng.select();\n    };\n\n    /**\n     * insert paragraph\n     */\n    this.insertParagraph = function (editable) {\n      var rng = range.create(editable);\n\n      // deleteContents on range.\n      rng = rng.deleteContents();\n\n      // Wrap range if it needs to be wrapped by paragraph\n      rng = rng.wrapBodyInlineWithPara();\n\n      // finding paragraph\n      var splitRoot = dom.ancestor(rng.sc, dom.isPara);\n\n      var nextPara;\n      // on paragraph: split paragraph\n      if (splitRoot) {\n        // if it is an empty line with li\n        if (dom.isEmpty(splitRoot) && dom.isLi(splitRoot)) {\n          // toogle UL/OL and escape\n          bullet.toggleList(splitRoot.parentNode.nodeName);\n          return;\n        // if it is an empty line with para on blockquote\n        } else if (dom.isEmpty(splitRoot) && dom.isPara(splitRoot) && dom.isBlockquote(splitRoot.parentNode)) {\n          // escape blockquote\n          dom.insertAfter(splitRoot, splitRoot.parentNode);\n          nextPara = splitRoot;\n        // if new line has content (not a line break)\n        } else {\n          nextPara = dom.splitTree(splitRoot, rng.getStartPoint());\n\n          var emptyAnchors = dom.listDescendant(splitRoot, dom.isEmptyAnchor);\n          emptyAnchors = emptyAnchors.concat(dom.listDescendant(nextPara, dom.isEmptyAnchor));\n\n          $.each(emptyAnchors, function (idx, anchor) {\n            dom.remove(anchor);\n          });\n\n          // replace empty heading or pre with P tag\n          if ((dom.isHeading(nextPara) || dom.isPre(nextPara)) && dom.isEmpty(nextPara)) {\n            nextPara = dom.replace(nextPara, 'p');\n          }\n        }\n      // no paragraph: insert empty paragraph\n      } else {\n        var next = rng.sc.childNodes[rng.so];\n        nextPara = $(dom.emptyPara)[0];\n        if (next) {\n          rng.sc.insertBefore(nextPara, next);\n        } else {\n          rng.sc.appendChild(nextPara);\n        }\n      }\n\n      range.create(nextPara, 0).normalize().select().scrollIntoView(editable);\n    };\n  };\n\n  /**\n   * @class editing.Table\n   *\n   * Table\n   *\n   */\n  var Table = function () {\n    /**\n     * handle tab key\n     *\n     * @param {WrappedRange} rng\n     * @param {Boolean} isShift\n     */\n    this.tab = function (rng, isShift) {\n      var cell = dom.ancestor(rng.commonAncestor(), dom.isCell);\n      var table = dom.ancestor(cell, dom.isTable);\n      var cells = dom.listDescendant(table, dom.isCell);\n\n      var nextCell = list[isShift ? 'prev' : 'next'](cells, cell);\n      if (nextCell) {\n        range.create(nextCell, 0).select();\n      }\n    };\n\n    /**\n     * create empty table element\n     *\n     * @param {Number} rowCount\n     * @param {Number} colCount\n     * @return {Node}\n     */\n    this.createTable = function (colCount, rowCount, options) {\n      var tds = [], tdHTML;\n      for (var idxCol = 0; idxCol < colCount; idxCol++) {\n        tds.push('<td>' + dom.blank + '</td>');\n      }\n      tdHTML = tds.join('');\n\n      var trs = [], trHTML;\n      for (var idxRow = 0; idxRow < rowCount; idxRow++) {\n        trs.push('<tr>' + tdHTML + '</tr>');\n      }\n      trHTML = trs.join('');\n      var $table = $('<table>' + trHTML + '</table>');\n      if (options && options.tableClassName) {\n        $table.addClass(options.tableClassName);\n      }\n\n      return $table[0];\n    };\n  };\n\n\n  var KEY_BOGUS = 'bogus';\n\n  /**\n   * @class Editor\n   */\n  var Editor = function (context) {\n    var self = this;\n\n    var $note = context.layoutInfo.note;\n    var $editor = context.layoutInfo.editor;\n    var $editable = context.layoutInfo.editable;\n    var options = context.options;\n    var lang = options.langInfo;\n\n    var editable = $editable[0];\n    var lastRange = null;\n\n    var style = new Style();\n    var table = new Table();\n    var typing = new Typing();\n    var bullet = new Bullet();\n    var history = new History($editable);\n\n    this.initialize = function () {\n      // bind custom events\n      $editable.on('keydown', function (event) {\n        if (event.keyCode === key.code.ENTER) {\n          context.triggerEvent('enter', event);\n        }\n        context.triggerEvent('keydown', event);\n\n        if (!event.isDefaultPrevented()) {\n          if (options.shortcuts) {\n            self.handleKeyMap(event);\n          } else {\n            self.preventDefaultEditableShortCuts(event);\n          }\n        }\n      }).on('keyup', function (event) {\n        context.triggerEvent('keyup', event);\n      }).on('focus', function (event) {\n        context.triggerEvent('focus', event);\n      }).on('blur', function (event) {\n        context.triggerEvent('blur', event);\n      }).on('mousedown', function (event) {\n        context.triggerEvent('mousedown', event);\n      }).on('mouseup', function (event) {\n        context.triggerEvent('mouseup', event);\n      }).on('scroll', function (event) {\n        context.triggerEvent('scroll', event);\n      }).on('paste', function (event) {\n        context.triggerEvent('paste', event);\n      });\n\n      // init content before set event\n      $editable.html(dom.html($note) || dom.emptyPara);\n\n      // [workaround] IE doesn't have input events for contentEditable\n      // - see: https://goo.gl/4bfIvA\n      var changeEventName = agent.isMSIE ? 'DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted' : 'input';\n      $editable.on(changeEventName, func.debounce(function () {\n        context.triggerEvent('change', $editable.html());\n      }, 250));\n\n      $editor.on('focusin', function (event) {\n        context.triggerEvent('focusin', event);\n      }).on('focusout', function (event) {\n        context.triggerEvent('focusout', event);\n      });\n\n      if (!options.airMode) {\n        if (options.width) {\n          $editor.outerWidth(options.width);\n        }\n        if (options.height) {\n          $editable.outerHeight(options.height);\n        }\n        if (options.maxHeight) {\n          $editable.css('max-height', options.maxHeight);\n        }\n        if (options.minHeight) {\n          $editable.css('min-height', options.minHeight);\n        }\n      }\n\n      history.recordUndo();\n    };\n\n    this.destroy = function () {\n      $editable.off();\n    };\n\n    this.handleKeyMap = function (event) {\n      var keyMap = options.keyMap[agent.isMac ? 'mac' : 'pc'];\n      var keys = [];\n\n      if (event.metaKey) { keys.push('CMD'); }\n      if (event.ctrlKey && !event.altKey) { keys.push('CTRL'); }\n      if (event.shiftKey) { keys.push('SHIFT'); }\n\n      var keyName = key.nameFromCode[event.keyCode];\n      if (keyName) {\n        keys.push(keyName);\n      }\n\n      var eventName = keyMap[keys.join('+')];\n      if (eventName) {\n        event.preventDefault();\n        context.invoke(eventName);\n      } else if (key.isEdit(event.keyCode)) {\n        this.afterCommand();\n      }\n    };\n\n    this.preventDefaultEditableShortCuts = function (event) {\n      // B(Bold, 66) / I(Italic, 73) / U(Underline, 85)\n      if ((event.ctrlKey || event.metaKey) &&\n        list.contains([66, 73, 85], event.keyCode)) {\n        event.preventDefault();\n      }\n    };\n\n    /**\n     * create range\n     * @return {WrappedRange}\n     */\n    this.createRange = function () {\n      this.focus();\n      return range.create(editable);\n    };\n\n    /**\n     * saveRange\n     *\n     * save current range\n     *\n     * @param {Boolean} [thenCollapse=false]\n     */\n    this.saveRange = function (thenCollapse) {\n      lastRange = this.createRange();\n      if (thenCollapse) {\n        lastRange.collapse().select();\n      }\n    };\n\n    /**\n     * restoreRange\n     *\n     * restore lately range\n     */\n    this.restoreRange = function () {\n      if (lastRange) {\n        lastRange.select();\n        this.focus();\n      }\n    };\n\n    this.saveTarget = function (node) {\n      $editable.data('target', node);\n    };\n\n    this.clearTarget = function () {\n      $editable.removeData('target');\n    };\n\n    this.restoreTarget = function () {\n      return $editable.data('target');\n    };\n\n    /**\n     * currentStyle\n     *\n     * current style\n     * @return {Object|Boolean} unfocus\n     */\n    this.currentStyle = function () {\n      var rng = range.create();\n      if (rng) {\n        rng = rng.normalize();\n      }\n      return rng ? style.current(rng) : style.fromNode($editable);\n    };\n\n    /**\n     * style from node\n     *\n     * @param {jQuery} $node\n     * @return {Object}\n     */\n    this.styleFromNode = function ($node) {\n      return style.fromNode($node);\n    };\n\n    /**\n     * undo\n     */\n    this.undo = function () {\n      context.triggerEvent('before.command', $editable.html());\n      history.undo();\n      context.triggerEvent('change', $editable.html());\n    };\n    context.memo('help.undo', lang.help.undo);\n\n    /**\n     * redo\n     */\n    this.redo = function () {\n      context.triggerEvent('before.command', $editable.html());\n      history.redo();\n      context.triggerEvent('change', $editable.html());\n    };\n    context.memo('help.redo', lang.help.redo);\n\n    /**\n     * before command\n     */\n    var beforeCommand = this.beforeCommand = function () {\n      context.triggerEvent('before.command', $editable.html());\n      // keep focus on editable before command execution\n      self.focus();\n    };\n\n    /**\n     * after command\n     * @param {Boolean} isPreventTrigger\n     */\n    var afterCommand = this.afterCommand = function (isPreventTrigger) {\n      history.recordUndo();\n      if (!isPreventTrigger) {\n        context.triggerEvent('change', $editable.html());\n      }\n    };\n\n    /* jshint ignore:start */\n    // native commands(with execCommand), generate function for execCommand\n    var commands = ['bold', 'italic', 'underline', 'strikethrough', 'superscript', 'subscript',\n                    'justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull',\n                    'formatBlock', 'removeFormat',\n                    'backColor', 'foreColor', 'fontName'];\n\n    for (var idx = 0, len = commands.length; idx < len; idx ++) {\n      this[commands[idx]] = (function (sCmd) {\n        return function (value) {\n          beforeCommand();\n          document.execCommand(sCmd, false, value);\n          afterCommand(true);\n        };\n      })(commands[idx]);\n      context.memo('help.' + commands[idx], lang.help[commands[idx]]);\n    }\n    /* jshint ignore:end */\n\n    /**\n     * handle tab key\n     */\n    this.tab = function () {\n      var rng = this.createRange();\n      if (rng.isCollapsed() && rng.isOnCell()) {\n        table.tab(rng);\n      } else {\n        beforeCommand();\n        typing.insertTab(rng, options.tabSize);\n        afterCommand();\n      }\n    };\n    context.memo('help.tab', lang.help.tab);\n\n    /**\n     * handle shift+tab key\n     */\n    this.untab = function () {\n      var rng = this.createRange();\n      if (rng.isCollapsed() && rng.isOnCell()) {\n        table.tab(rng, true);\n      }\n    };\n    context.memo('help.untab', lang.help.untab);\n\n    /**\n     * run given function between beforeCommand and afterCommand\n     */\n    this.wrapCommand = function (fn) {\n      return function () {\n        beforeCommand();\n        fn.apply(self, arguments);\n        afterCommand();\n      };\n    };\n\n    /**\n     * insert paragraph\n     */\n    this.insertParagraph = this.wrapCommand(function () {\n      typing.insertParagraph(editable);\n    });\n    context.memo('help.insertParagraph', lang.help.insertParagraph);\n\n    this.insertOrderedList = this.wrapCommand(function () {\n      bullet.insertOrderedList(editable);\n    });\n    context.memo('help.insertOrderedList', lang.help.insertOrderedList);\n\n    this.insertUnorderedList = this.wrapCommand(function () {\n      bullet.insertUnorderedList(editable);\n    });\n    context.memo('help.insertUnorderedList', lang.help.insertUnorderedList);\n\n    this.indent = this.wrapCommand(function () {\n      bullet.indent(editable);\n    });\n    context.memo('help.indent', lang.help.indent);\n\n    this.outdent = this.wrapCommand(function () {\n      bullet.outdent(editable);\n    });\n    context.memo('help.outdent', lang.help.outdent);\n\n    /**\n     * insert image\n     *\n     * @param {String} src\n     * @param {String|Function} param\n     * @return {Promise}\n     */\n    this.insertImage = function (src, param) {\n      return async.createImage(src, param).then(function ($image) {\n        beforeCommand();\n\n        if (typeof param === 'function') {\n          param($image);\n        } else {\n          if (typeof param === 'string') {\n            $image.attr('data-filename', param);\n          }\n          $image.css('width', Math.min($editable.width(), $image.width()));\n        }\n\n        $image.show();\n        range.create(editable).insertNode($image[0]);\n        range.createFromNodeAfter($image[0]).select();\n        afterCommand();\n      }).fail(function (e) {\n        context.triggerEvent('image.upload.error', e);\n      });\n    };\n\n    /**\n     * insertImages\n     * @param {File[]} files\n     */\n    this.insertImages = function (files) {\n      $.each(files, function (idx, file) {\n        var filename = file.name;\n        if (options.maximumImageFileSize && options.maximumImageFileSize < file.size) {\n          context.triggerEvent('image.upload.error', lang.image.maximumFileSizeError);\n        } else {\n          async.readFileAsDataURL(file).then(function (dataURL) {\n            return self.insertImage(dataURL, filename);\n          }).fail(function () {\n            context.triggerEvent('image.upload.error');\n          });\n        }\n      });\n    };\n\n    /**\n     * insertImagesOrCallback\n     * @param {File[]} files\n     */\n    this.insertImagesOrCallback = function (files) {\n      var callbacks = options.callbacks;\n\n      // If onImageUpload options setted\n      if (callbacks.onImageUpload) {\n        context.triggerEvent('image.upload', files);\n      // else insert Image as dataURL\n      } else {\n        this.insertImages(files);\n      }\n    };\n\n    /**\n     * insertNode\n     * insert node\n     * @param {Node} node\n     */\n    this.insertNode = this.wrapCommand(function (node) {\n      var rng = this.createRange();\n      rng.insertNode(node);\n      range.createFromNodeAfter(node).select();\n    });\n\n    /**\n     * insert text\n     * @param {String} text\n     */\n    this.insertText = this.wrapCommand(function (text) {\n      var rng = this.createRange();\n      var textNode = rng.insertNode(dom.createText(text));\n      range.create(textNode, dom.nodeLength(textNode)).select();\n    });\n\n    /**\n     * return selected plain text\n     * @return {String} text\n     */\n    this.getSelectedText = function () {\n      var rng = this.createRange();\n\n      // if range on anchor, expand range with anchor\n      if (rng.isOnAnchor()) {\n        rng = range.createFromNode(dom.ancestor(rng.sc, dom.isAnchor));\n      }\n\n      return rng.toString();\n    };\n\n    /**\n     * paste HTML\n     * @param {String} markup\n     */\n    this.pasteHTML = this.wrapCommand(function (markup) {\n      var contents = this.createRange().pasteHTML(markup);\n      range.createFromNodeAfter(list.last(contents)).select();\n    });\n\n    /**\n     * formatBlock\n     *\n     * @param {String} tagName\n     */\n    this.formatBlock = this.wrapCommand(function (tagName) {\n      // [workaround] for MSIE, IE need `<`\n      tagName = agent.isMSIE ? '<' + tagName + '>' : tagName;\n      document.execCommand('FormatBlock', false, tagName);\n    });\n\n    this.formatPara = function () {\n      this.formatBlock('P');\n    };\n    context.memo('help.formatPara', lang.help.formatPara);\n\n    /* jshint ignore:start */\n    for (var idx = 1; idx <= 6; idx ++) {\n      this['formatH' + idx] = function (idx) {\n        return function () {\n          this.formatBlock('H' + idx);\n        };\n      }(idx);\n      context.memo('help.formatH'+idx, lang.help['formatH' + idx]);\n    };\n    /* jshint ignore:end */\n\n    /**\n     * fontSize\n     *\n     * @param {String} value - px\n     */\n    this.fontSize = function (value) {\n      var rng = this.createRange();\n\n      if (rng && rng.isCollapsed()) {\n        var spans = style.styleNodes(rng);\n        var firstSpan = list.head(spans);\n\n        $(spans).css({\n          'font-size': value + 'px'\n        });\n\n        // [workaround] added styled bogus span for style\n        //  - also bogus character needed for cursor position\n        if (firstSpan && !dom.nodeLength(firstSpan)) {\n          firstSpan.innerHTML = dom.ZERO_WIDTH_NBSP_CHAR;\n          range.createFromNodeAfter(firstSpan.firstChild).select();\n          $editable.data(KEY_BOGUS, firstSpan);\n        }\n      } else {\n        beforeCommand();\n        $(style.styleNodes(rng)).css({\n          'font-size': value + 'px'\n        });\n        afterCommand();\n      }\n    };\n\n    /**\n     * insert horizontal rule\n     */\n    this.insertHorizontalRule = this.wrapCommand(function () {\n      var hrNode = this.createRange().insertNode(dom.create('HR'));\n      if (hrNode.nextSibling) {\n        range.create(hrNode.nextSibling, 0).normalize().select();\n      }\n    });\n    context.memo('help.insertHorizontalRule', lang.help.insertHorizontalRule);\n\n    /**\n     * remove bogus node and character\n     */\n    this.removeBogus = function () {\n      var bogusNode = $editable.data(KEY_BOGUS);\n      if (!bogusNode) {\n        return;\n      }\n\n      var textNode = list.find(list.from(bogusNode.childNodes), dom.isText);\n\n      var bogusCharIdx = textNode.nodeValue.indexOf(dom.ZERO_WIDTH_NBSP_CHAR);\n      if (bogusCharIdx !== -1) {\n        textNode.deleteData(bogusCharIdx, 1);\n      }\n\n      if (dom.isEmpty(bogusNode)) {\n        dom.remove(bogusNode);\n      }\n\n      $editable.removeData(KEY_BOGUS);\n    };\n\n    /**\n     * lineHeight\n     * @param {String} value\n     */\n    this.lineHeight = this.wrapCommand(function (value) {\n      style.stylePara(this.createRange(), {\n        lineHeight: value\n      });\n    });\n\n    /**\n     * unlink\n     *\n     * @type command\n     */\n    this.unlink = function () {\n      var rng = this.createRange();\n      if (rng.isOnAnchor()) {\n        var anchor = dom.ancestor(rng.sc, dom.isAnchor);\n        rng = range.createFromNode(anchor);\n        rng.select();\n\n        beforeCommand();\n        document.execCommand('unlink');\n        afterCommand();\n      }\n    };\n\n    /**\n     * create link (command)\n     *\n     * @param {Object} linkInfo\n     */\n    this.createLink = this.wrapCommand(function (linkInfo) {\n      var linkUrl = linkInfo.url;\n      var linkText = linkInfo.text;\n      var isNewWindow = linkInfo.isNewWindow;\n      var rng = linkInfo.range || this.createRange();\n      var isTextChanged = rng.toString() !== linkText;\n\n      // handle spaced urls from input\n      if (typeof linkUrl === 'string') {\n        linkUrl = linkUrl.trim();\n      }\n\n      if (options.onCreateLink) {\n        linkUrl = options.onCreateLink(linkUrl);\n      } else {\n        // if url doesn't match an URL schema, set http:// as default\n        linkUrl = /^[A-Za-z][A-Za-z0-9+-.]*\\:[\\/\\/]?/.test(linkUrl) ?\n          linkUrl : 'http://' + linkUrl;\n      }\n\n      var anchors = [];\n      if (isTextChanged) {\n        rng = rng.deleteContents();\n        var anchor = rng.insertNode($('<A>' + linkText + '</A>')[0]);\n        anchors.push(anchor);\n      } else {\n        anchors = style.styleNodes(rng, {\n          nodeName: 'A',\n          expandClosestSibling: true,\n          onlyPartialContains: true\n        });\n      }\n\n      $.each(anchors, function (idx, anchor) {\n        $(anchor).attr('href', linkUrl);\n        if (isNewWindow) {\n          $(anchor).attr('target', '_blank');\n        } else {\n          $(anchor).removeAttr('target');\n        }\n      });\n\n      var startRange = range.createFromNodeBefore(list.head(anchors));\n      var startPoint = startRange.getStartPoint();\n      var endRange = range.createFromNodeAfter(list.last(anchors));\n      var endPoint = endRange.getEndPoint();\n\n      range.create(\n        startPoint.node,\n        startPoint.offset,\n        endPoint.node,\n        endPoint.offset\n      ).select();\n    });\n\n    /**\n     * returns link info\n     *\n     * @return {Object}\n     * @return {WrappedRange} return.range\n     * @return {String} return.text\n     * @return {Boolean} [return.isNewWindow=true]\n     * @return {String} [return.url=\"\"]\n     */\n    this.getLinkInfo = function () {\n      var rng = this.createRange().expand(dom.isAnchor);\n\n      // Get the first anchor on range(for edit).\n      var $anchor = $(list.head(rng.nodes(dom.isAnchor)));\n\n      return {\n        range: rng,\n        text: rng.toString(),\n        isNewWindow: $anchor.length ? $anchor.attr('target') === '_blank' : false,\n        url: $anchor.length ? $anchor.attr('href') : ''\n      };\n    };\n\n    /**\n     * setting color\n     *\n     * @param {Object} sObjColor  color code\n     * @param {String} sObjColor.foreColor foreground color\n     * @param {String} sObjColor.backColor background color\n     */\n    this.color = this.wrapCommand(function (colorInfo) {\n      var foreColor = colorInfo.foreColor;\n      var backColor = colorInfo.backColor;\n\n      if (foreColor) { document.execCommand('foreColor', false, foreColor); }\n      if (backColor) { document.execCommand('backColor', false, backColor); }\n    });\n\n    /**\n     * insert Table\n     *\n     * @param {String} dimension of table (ex : \"5x5\")\n     */\n    this.insertTable = this.wrapCommand(function (dim) {\n      var dimension = dim.split('x');\n\n      var rng = this.createRange().deleteContents();\n      rng.insertNode(table.createTable(dimension[0], dimension[1], options));\n    });\n\n    /**\n     * float me\n     *\n     * @param {String} value\n     */\n    this.floatMe = this.wrapCommand(function (value) {\n      var $target = $(this.restoreTarget());\n      $target.css('float', value);\n    });\n\n    /**\n     * resize overlay element\n     * @param {String} value\n     */\n    this.resize = this.wrapCommand(function (value) {\n      var $target = $(this.restoreTarget());\n      $target.css({\n        width: value * 100 + '%',\n        height: ''\n      });\n    });\n\n    /**\n     * @param {Position} pos\n     * @param {jQuery} $target - target element\n     * @param {Boolean} [bKeepRatio] - keep ratio\n     */\n    this.resizeTo = function (pos, $target, bKeepRatio) {\n      var imageSize;\n      if (bKeepRatio) {\n        var newRatio = pos.y / pos.x;\n        var ratio = $target.data('ratio');\n        imageSize = {\n          width: ratio > newRatio ? pos.x : pos.y / ratio,\n          height: ratio > newRatio ? pos.x * ratio : pos.y\n        };\n      } else {\n        imageSize = {\n          width: pos.x,\n          height: pos.y\n        };\n      }\n\n      $target.css(imageSize);\n    };\n\n    /**\n     * remove media object\n     */\n    this.removeMedia = this.wrapCommand(function () {\n      var $target = $(this.restoreTarget()).detach();\n      context.triggerEvent('media.delete', $target, $editable);\n    });\n\n    /**\n     * returns whether editable area has focus or not.\n     */\n    this.hasFocus = function () {\n      return $editable.is(':focus');\n    };\n\n    /**\n     * set focus\n     */\n    this.focus = function () {\n      // [workaround] Screen will move when page is scolled in IE.\n      //  - do focus when not focused\n      if (!this.hasFocus()) {\n        $editable.focus();\n      }\n    };\n\n    /**\n     * returns whether contents is empty or not.\n     * @return {Boolean}\n     */\n    this.isEmpty = function () {\n      return dom.isEmpty($editable[0]) || dom.emptyPara === $editable.html();\n    };\n\n    /**\n     * Removes all contents and restores the editable instance to an _emptyPara_.\n     */\n    this.empty = function () {\n      context.invoke('code', dom.emptyPara);\n    };\n  };\n\n  var Clipboard = function (context) {\n    var self = this;\n\n    var $editable = context.layoutInfo.editable;\n\n    this.events = {\n      'summernote.keydown': function (we, e) {\n        if (self.needKeydownHook()) {\n          if ((e.ctrlKey || e.metaKey) && e.keyCode === key.code.V) {\n            context.invoke('editor.saveRange');\n            self.$paste.focus();\n\n            setTimeout(function () {\n              self.pasteByHook();\n            }, 0);\n          }\n        }\n      }\n    };\n\n    this.needKeydownHook = function () {\n      return (agent.isMSIE && agent.browserVersion > 10) || agent.isFF;\n    };\n\n    this.initialize = function () {\n      // [workaround] getting image from clipboard\n      //  - IE11 and Firefox: CTRL+v hook\n      //  - Webkit: event.clipboardData\n      if (this.needKeydownHook()) {\n        this.$paste = $('<div tabindex=\"-1\" />').attr('contenteditable', true).css({\n          position: 'absolute',\n          left: -100000,\n          opacity: 0\n        });\n        $editable.before(this.$paste);\n\n        this.$paste.on('paste', function (event) {\n          context.triggerEvent('paste', event);\n        });\n      } else {\n        $editable.on('paste', this.pasteByEvent);\n      }\n    };\n\n    this.destroy = function () {\n      if (this.needKeydownHook()) {\n        this.$paste.remove();\n        this.$paste = null;\n      }\n    };\n\n    this.pasteByHook = function () {\n      var node = this.$paste[0].firstChild;\n\n      if (dom.isImg(node)) {\n        var dataURI = node.src;\n        var decodedData = atob(dataURI.split(',')[1]);\n        var array = new Uint8Array(decodedData.length);\n        for (var i = 0; i < decodedData.length; i++) {\n          array[i] = decodedData.charCodeAt(i);\n        }\n\n        var blob = new Blob([array], { type: 'image/png' });\n        blob.name = 'clipboard.png';\n\n        context.invoke('editor.restoreRange');\n        context.invoke('editor.focus');\n        context.invoke('editor.insertImagesOrCallback', [blob]);\n      } else {\n        var pasteContent = $('<div />').html(this.$paste.html()).html();\n        context.invoke('editor.restoreRange');\n        context.invoke('editor.focus');\n\n        if (pasteContent) {\n          context.invoke('editor.pasteHTML', pasteContent);\n        }\n      }\n\n      this.$paste.empty();\n    };\n\n    /**\n     * paste by clipboard event\n     *\n     * @param {Event} event\n     */\n    this.pasteByEvent = function (event) {\n      var clipboardData = event.originalEvent.clipboardData;\n      if (clipboardData && clipboardData.items && clipboardData.items.length) {\n        var item = list.head(clipboardData.items);\n        if (item.kind === 'file' && item.type.indexOf('image/') !== -1) {\n          context.invoke('editor.insertImagesOrCallback', [item.getAsFile()]);\n        }\n        context.invoke('editor.afterCommand');\n      }\n    };\n  };\n\n  var Dropzone = function (context) {\n    var $document = $(document);\n    var $editor = context.layoutInfo.editor;\n    var $editable = context.layoutInfo.editable;\n    var options = context.options;\n    var lang = options.langInfo;\n    var documentEventHandlers = {};\n\n    var $dropzone = $([\n      '<div class=\"note-dropzone\">',\n      '  <div class=\"note-dropzone-message\"/>',\n      '</div>'\n    ].join('')).prependTo($editor);\n\n    var detachDocumentEvent = function () {\n      Object.keys(documentEventHandlers).forEach(function (key) {\n        $document.off(key.substr(2).toLowerCase(), documentEventHandlers[key]);\n      });\n      documentEventHandlers = {};\n    };\n\n    /**\n     * attach Drag and Drop Events\n     */\n    this.initialize = function () {\n      if (options.disableDragAndDrop) {\n        // prevent default drop event\n        documentEventHandlers.onDrop = function (e) {\n          e.preventDefault();\n        };\n        $document.on('drop', documentEventHandlers.onDrop);\n      } else {\n        this.attachDragAndDropEvent();\n      }\n    };\n\n    /**\n     * attach Drag and Drop Events\n     */\n    this.attachDragAndDropEvent = function () {\n      var collection = $(),\n          $dropzoneMessage = $dropzone.find('.note-dropzone-message');\n\n      documentEventHandlers.onDragenter = function (e) {\n        var isCodeview = context.invoke('codeview.isActivated');\n        var hasEditorSize = $editor.width() > 0 && $editor.height() > 0;\n        if (!isCodeview && !collection.length && hasEditorSize) {\n          $editor.addClass('dragover');\n          $dropzone.width($editor.width());\n          $dropzone.height($editor.height());\n          $dropzoneMessage.text(lang.image.dragImageHere);\n        }\n        collection = collection.add(e.target);\n      };\n\n      documentEventHandlers.onDragleave = function (e) {\n        collection = collection.not(e.target);\n        if (!collection.length) {\n          $editor.removeClass('dragover');\n        }\n      };\n\n      documentEventHandlers.onDrop = function () {\n        collection = $();\n        $editor.removeClass('dragover');\n      };\n\n      // show dropzone on dragenter when dragging a object to document\n      // -but only if the editor is visible, i.e. has a positive width and height\n      $document.on('dragenter', documentEventHandlers.onDragenter)\n        .on('dragleave', documentEventHandlers.onDragleave)\n        .on('drop', documentEventHandlers.onDrop);\n\n      // change dropzone's message on hover.\n      $dropzone.on('dragenter', function () {\n        $dropzone.addClass('hover');\n        $dropzoneMessage.text(lang.image.dropImage);\n      }).on('dragleave', function () {\n        $dropzone.removeClass('hover');\n        $dropzoneMessage.text(lang.image.dragImageHere);\n      });\n\n      // attach dropImage\n      $dropzone.on('drop', function (event) {\n        var dataTransfer = event.originalEvent.dataTransfer;\n\n        if (dataTransfer && dataTransfer.files && dataTransfer.files.length) {\n          event.preventDefault();\n          $editable.focus();\n          context.invoke('editor.insertImagesOrCallback', dataTransfer.files);\n        } else {\n          $.each(dataTransfer.types, function (idx, type) {\n            var content = dataTransfer.getData(type);\n\n            if (type.toLowerCase().indexOf('text') > -1) {\n              context.invoke('editor.pasteHTML', content);\n            } else {\n              $(content).each(function () {\n                context.invoke('editor.insertNode', this);\n              });\n            }\n          });\n        }\n      }).on('dragover', false); // prevent default dragover event\n    };\n\n    this.destroy = function () {\n      detachDocumentEvent();\n    };\n  };\n\n\n  var CodeMirror;\n  if (agent.hasCodeMirror) {\n    if (agent.isSupportAmd) {\n      new Promise(function(resolve) { resolve(); }).then(function() { var __WEBPACK_AMD_REQUIRE_ARRAY__ = [__webpack_require__(5)]; (function (cm) {\n        CodeMirror = cm;\n      }.apply(null, __WEBPACK_AMD_REQUIRE_ARRAY__));}).catch(__webpack_require__.oe);\n    } else {\n      CodeMirror = window.CodeMirror;\n    }\n  }\n\n  /**\n   * @class Codeview\n   */\n  var Codeview = function (context) {\n    var $editor = context.layoutInfo.editor;\n    var $editable = context.layoutInfo.editable;\n    var $codable = context.layoutInfo.codable;\n    var options = context.options;\n\n    this.sync = function () {\n      var isCodeview = this.isActivated();\n      if (isCodeview && agent.hasCodeMirror) {\n        $codable.data('cmEditor').save();\n      }\n    };\n\n    /**\n     * @return {Boolean}\n     */\n    this.isActivated = function () {\n      return $editor.hasClass('codeview');\n    };\n\n    /**\n     * toggle codeview\n     */\n    this.toggle = function () {\n      if (this.isActivated()) {\n        this.deactivate();\n      } else {\n        this.activate();\n      }\n      context.triggerEvent('codeview.toggled');\n    };\n\n    /**\n     * activate code view\n     */\n    this.activate = function () {\n      $codable.val(dom.html($editable, options.prettifyHtml));\n      $codable.height($editable.height());\n\n      context.invoke('toolbar.updateCodeview', true);\n      $editor.addClass('codeview');\n      $codable.focus();\n\n      // activate CodeMirror as codable\n      if (agent.hasCodeMirror) {\n        var cmEditor = CodeMirror.fromTextArea($codable[0], options.codemirror);\n\n        // CodeMirror TernServer\n        if (options.codemirror.tern) {\n          var server = new CodeMirror.TernServer(options.codemirror.tern);\n          cmEditor.ternServer = server;\n          cmEditor.on('cursorActivity', function (cm) {\n            server.updateArgHints(cm);\n          });\n        }\n\n        // CodeMirror hasn't Padding.\n        cmEditor.setSize(null, $editable.outerHeight());\n        $codable.data('cmEditor', cmEditor);\n      }\n    };\n\n    /**\n     * deactivate code view\n     */\n    this.deactivate = function () {\n      // deactivate CodeMirror as codable\n      if (agent.hasCodeMirror) {\n        var cmEditor = $codable.data('cmEditor');\n        $codable.val(cmEditor.getValue());\n        cmEditor.toTextArea();\n      }\n\n      var value = dom.value($codable, options.prettifyHtml) || dom.emptyPara;\n      var isChange = $editable.html() !== value;\n\n      $editable.html(value);\n      $editable.height(options.height ? $codable.height() : 'auto');\n      $editor.removeClass('codeview');\n\n      if (isChange) {\n        context.triggerEvent('change', $editable.html(), $editable);\n      }\n\n      $editable.focus();\n\n      context.invoke('toolbar.updateCodeview', false);\n    };\n\n    this.destroy = function () {\n      if (this.isActivated()) {\n        this.deactivate();\n      }\n    };\n  };\n\n  var EDITABLE_PADDING = 24;\n\n  var Statusbar = function (context) {\n    var $document = $(document);\n    var $statusbar = context.layoutInfo.statusbar;\n    var $editable = context.layoutInfo.editable;\n    var options = context.options;\n\n    this.initialize = function () {\n      if (options.airMode || options.disableResizeEditor) {\n        this.destroy();\n        return;\n      }\n\n      $statusbar.on('mousedown', function (event) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        var editableTop = $editable.offset().top - $document.scrollTop();\n\n        $document.on('mousemove', function (event) {\n          var height = event.clientY - (editableTop + EDITABLE_PADDING);\n\n          height = (options.minheight > 0) ? Math.max(height, options.minheight) : height;\n          height = (options.maxHeight > 0) ? Math.min(height, options.maxHeight) : height;\n\n          $editable.height(height);\n        }).one('mouseup', function () {\n          $document.off('mousemove');\n        });\n      });\n    };\n\n    this.destroy = function () {\n      $statusbar.off();\n      $statusbar.remove();\n    };\n  };\n\n  var Fullscreen = function (context) {\n    var $editor = context.layoutInfo.editor;\n    var $toolbar = context.layoutInfo.toolbar;\n    var $editable = context.layoutInfo.editable;\n    var $codable = context.layoutInfo.codable;\n\n    var $window = $(window);\n    var $scrollbar = $('html, body');\n\n    /**\n     * toggle fullscreen\n     */\n    this.toggle = function () {\n      var resize = function (size) {\n        $editable.css('height', size.h);\n        $codable.css('height', size.h);\n        if ($codable.data('cmeditor')) {\n          $codable.data('cmeditor').setsize(null, size.h);\n        }\n      };\n\n      $editor.toggleClass('fullscreen');\n      if (this.isFullscreen()) {\n        $editable.data('orgHeight', $editable.css('height'));\n\n        $window.on('resize', function () {\n          resize({\n            h: $window.height() - $toolbar.outerHeight()\n          });\n        }).trigger('resize');\n\n        $scrollbar.css('overflow', 'hidden');\n      } else {\n        $window.off('resize');\n        resize({\n          h: $editable.data('orgHeight')\n        });\n        $scrollbar.css('overflow', 'visible');\n      }\n\n      context.invoke('toolbar.updateFullscreen', this.isFullscreen());\n    };\n\n    this.isFullscreen = function () {\n      return $editor.hasClass('fullscreen');\n    };\n  };\n\n  var Handle = function (context) {\n    var self = this;\n\n    var $document = $(document);\n    var $editingArea = context.layoutInfo.editingArea;\n    var options = context.options;\n\n    this.events = {\n      'summernote.mousedown': function (we, e) {\n        if (self.update(e.target)) {\n          e.preventDefault();\n        }\n      },\n      'summernote.keyup summernote.scroll summernote.change summernote.dialog.shown': function () {\n        self.update();\n      }\n    };\n\n    this.initialize = function () {\n      this.$handle = $([\n        '<div class=\"note-handle\">',\n        '<div class=\"note-control-selection\">',\n        '<div class=\"note-control-selection-bg\"></div>',\n        '<div class=\"note-control-holder note-control-nw\"></div>',\n        '<div class=\"note-control-holder note-control-ne\"></div>',\n        '<div class=\"note-control-holder note-control-sw\"></div>',\n        '<div class=\"',\n        (options.disableResizeImage ? 'note-control-holder' : 'note-control-sizing'),\n        ' note-control-se\"></div>',\n        (options.disableResizeImage ? '' : '<div class=\"note-control-selection-info\"></div>'),\n        '</div>',\n        '</div>'\n      ].join('')).prependTo($editingArea);\n\n      this.$handle.on('mousedown', function (event) {\n        if (dom.isControlSizing(event.target)) {\n          event.preventDefault();\n          event.stopPropagation();\n\n          var $target = self.$handle.find('.note-control-selection').data('target'),\n              posStart = $target.offset(),\n              scrollTop = $document.scrollTop();\n\n          $document.on('mousemove', function (event) {\n            context.invoke('editor.resizeTo', {\n              x: event.clientX - posStart.left,\n              y: event.clientY - (posStart.top - scrollTop)\n            }, $target, !event.shiftKey);\n\n            self.update($target[0]);\n          }).one('mouseup', function (e) {\n            e.preventDefault();\n            $document.off('mousemove');\n            context.invoke('editor.afterCommand');\n          });\n\n          if (!$target.data('ratio')) { // original ratio.\n            $target.data('ratio', $target.height() / $target.width());\n          }\n        }\n      });\n    };\n\n    this.destroy = function () {\n      this.$handle.remove();\n    };\n\n    this.update = function (target) {\n      var isImage = dom.isImg(target);\n      var $selection = this.$handle.find('.note-control-selection');\n\n      context.invoke('imagePopover.update', target);\n\n      if (isImage) {\n        var $image = $(target);\n        var pos = $image.position();\n\n        // include margin\n        var imageSize = {\n          w: $image.outerWidth(true),\n          h: $image.outerHeight(true)\n        };\n\n        $selection.css({\n          display: 'block',\n          left: pos.left,\n          top: pos.top,\n          width: imageSize.w,\n          height: imageSize.h\n        }).data('target', $image); // save current image element.\n\n        var sizingText = imageSize.w + 'x' + imageSize.h;\n        $selection.find('.note-control-selection-info').text(sizingText);\n        context.invoke('editor.saveTarget', target);\n      } else {\n        this.hide();\n      }\n\n      return isImage;\n    };\n\n    /**\n     * hide\n     *\n     * @param {jQuery} $handle\n     */\n    this.hide = function () {\n      context.invoke('editor.clearTarget');\n      this.$handle.children().hide();\n    };\n  };\n\n  var AutoLink = function (context) {\n    var self = this;\n    var defaultScheme = 'http://';\n    var linkPattern = /^([A-Za-z][A-Za-z0-9+-.]*\\:[\\/\\/]?|mailto:[A-Z0-9._%+-]+@)?(www\\.)?(.+)$/i;\n\n    this.events = {\n      'summernote.keyup': function (we, e) {\n        if (!e.isDefaultPrevented()) {\n          self.handleKeyup(e);\n        }\n      },\n      'summernote.keydown': function (we, e) {\n        self.handleKeydown(e);\n      }\n    };\n\n    this.initialize = function () {\n      this.lastWordRange = null;\n    };\n\n    this.destroy = function () {\n      this.lastWordRange = null;\n    };\n\n    this.replace = function () {\n      if (!this.lastWordRange) {\n        return;\n      }\n\n      var keyword = this.lastWordRange.toString();\n      var match = keyword.match(linkPattern);\n\n      if (match && (match[1] || match[2])) {\n        var link = match[1] ? keyword : defaultScheme + keyword;\n        var node = $('<a />').html(keyword).attr('href', link)[0];\n\n        this.lastWordRange.insertNode(node);\n        this.lastWordRange = null;\n        context.invoke('editor.focus');\n      }\n\n    };\n\n    this.handleKeydown = function (e) {\n      if (list.contains([key.code.ENTER, key.code.SPACE], e.keyCode)) {\n        var wordRange = context.invoke('editor.createRange').getWordRange();\n        this.lastWordRange = wordRange;\n      }\n    };\n\n    this.handleKeyup = function (e) {\n      if (list.contains([key.code.ENTER, key.code.SPACE], e.keyCode)) {\n        this.replace();\n      }\n    };\n  };\n\n  /**\n   * textarea auto sync.\n   */\n  var AutoSync = function (context) {\n    var $note = context.layoutInfo.note;\n\n    this.events = {\n      'summernote.change': function () {\n        $note.val(context.invoke('code'));\n      }\n    };\n\n    this.shouldInitialize = function () {\n      return dom.isTextarea($note[0]);\n    };\n  };\n\n  var Placeholder = function (context) {\n    var self = this;\n    var $editingArea = context.layoutInfo.editingArea;\n    var options = context.options;\n\n    this.events = {\n      'summernote.init summernote.change': function () {\n        self.update();\n      },\n      'summernote.codeview.toggled': function () {\n        self.update();\n      }\n    };\n\n    this.shouldInitialize = function () {\n      return !!options.placeholder;\n    };\n\n    this.initialize = function () {\n      this.$placeholder = $('<div class=\"note-placeholder\">');\n      this.$placeholder.on('click', function () {\n        context.invoke('focus');\n      }).text(options.placeholder).prependTo($editingArea);\n    };\n\n    this.destroy = function () {\n      this.$placeholder.remove();\n    };\n\n    this.update = function () {\n      var isShow = !context.invoke('codeview.isActivated') && context.invoke('editor.isEmpty');\n      this.$placeholder.toggle(isShow);\n    };\n  };\n\n  var Buttons = function (context) {\n    var self = this;\n    var ui = $.summernote.ui;\n\n    var $toolbar = context.layoutInfo.toolbar;\n    var options = context.options;\n    var lang = options.langInfo;\n\n    var invertedKeyMap = func.invertObject(options.keyMap[agent.isMac ? 'mac' : 'pc']);\n\n    var representShortcut = this.representShortcut = function (editorMethod) {\n      var shortcut = invertedKeyMap[editorMethod];\n      if (!options.shortcuts || !shortcut) {\n        return '';\n      }\n      \n      if (agent.isMac) {\n        shortcut = shortcut.replace('CMD', '⌘').replace('SHIFT', '⇧');\n      }\n\n      shortcut = shortcut.replace('BACKSLASH', '\\\\')\n                         .replace('SLASH', '/')\n                         .replace('LEFTBRACKET', '[')\n                         .replace('RIGHTBRACKET', ']');\n\n      return ' (' + shortcut + ')';\n    };\n\n    this.initialize = function () {\n      this.addToolbarButtons();\n      this.addImagePopoverButtons();\n      this.addLinkPopoverButtons();\n      this.fontInstalledMap = {};\n    };\n\n    this.destroy = function () {\n      delete this.fontInstalledMap;\n    };\n\n    this.isFontInstalled = function (name) {\n      if (!self.fontInstalledMap.hasOwnProperty(name)) {\n        self.fontInstalledMap[name] = agent.isFontInstalled(name) ||\n          list.contains(options.fontNamesIgnoreCheck, name);\n      }\n\n      return self.fontInstalledMap[name];\n    };\n\n    this.addToolbarButtons = function () {\n      context.memo('button.style', function () {\n        return ui.buttonGroup([\n          ui.button({\n            className: 'dropdown-toggle',\n            contents: ui.icon(options.icons.magic) + ' ' + ui.icon(options.icons.caret, 'span'),\n            tooltip: lang.style.style,\n            data: {\n              toggle: 'dropdown'\n            }\n          }),\n          ui.dropdown({\n            className: 'dropdown-style',\n            items: context.options.styleTags,\n            template: function (item) {\n\n              if (typeof item === 'string') {\n                item = { tag: item, title: (lang.style.hasOwnProperty(item) ? lang.style[item] : item) };\n              }\n\n              var tag = item.tag;\n              var title = item.title;\n              var style = item.style ? ' style=\"' + item.style + '\" ' : '';\n              var className = item.className ? ' class=\"' + item.className + '\"' : '';\n\n              return '<' + tag + style + className + '>' + title + '</' + tag +  '>';\n            },\n            click: context.createInvokeHandler('editor.formatBlock')\n          })\n        ]).render();\n      });\n\n      context.memo('button.bold', function () {\n        return ui.button({\n          className: 'note-btn-bold',\n          contents: ui.icon(options.icons.bold),\n          tooltip: lang.font.bold + representShortcut('bold'),\n          click: context.createInvokeHandler('editor.bold')\n        }).render();\n      });\n\n      context.memo('button.italic', function () {\n        return ui.button({\n          className: 'note-btn-italic',\n          contents: ui.icon(options.icons.italic),\n          tooltip: lang.font.italic + representShortcut('italic'),\n          click: context.createInvokeHandler('editor.italic')\n        }).render();\n      });\n\n      context.memo('button.underline', function () {\n        return ui.button({\n          className: 'note-btn-underline',\n          contents: ui.icon(options.icons.underline),\n          tooltip: lang.font.underline + representShortcut('underline'),\n          click: context.createInvokeHandler('editor.underline')\n        }).render();\n      });\n\n      context.memo('button.clear', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.eraser),\n          tooltip: lang.font.clear + representShortcut('removeFormat'),\n          click: context.createInvokeHandler('editor.removeFormat')\n        }).render();\n      });\n\n      context.memo('button.strikethrough', function () {\n        return ui.button({\n          className: 'note-btn-strikethrough',\n          contents: ui.icon(options.icons.strikethrough),\n          tooltip: lang.font.strikethrough + representShortcut('strikethrough'),\n          click: context.createInvokeHandler('editor.strikethrough')\n        }).render();\n      });\n\n      context.memo('button.superscript', function () {\n        return ui.button({\n          className: 'note-btn-superscript',\n          contents: ui.icon(options.icons.superscript),\n          tooltip: lang.font.superscript,\n          click: context.createInvokeHandler('editor.superscript')\n        }).render();\n      });\n\n      context.memo('button.subscript', function () {\n        return ui.button({\n          className: 'note-btn-subscript',\n          contents: ui.icon(options.icons.subscript),\n          tooltip: lang.font.subscript,\n          click: context.createInvokeHandler('editor.subscript')\n        }).render();\n      });\n\n      context.memo('button.fontname', function () {\n        return ui.buttonGroup([\n          ui.button({\n            className: 'dropdown-toggle',\n            contents: '<span class=\"note-current-fontname\"/> ' + ui.icon(options.icons.caret, 'span'),\n            tooltip: lang.font.name,\n            data: {\n              toggle: 'dropdown'\n            }\n          }),\n          ui.dropdownCheck({\n            className: 'dropdown-fontname',\n            checkClassName: options.icons.menuCheck,\n            items: options.fontNames.filter(self.isFontInstalled),\n            template: function (item) {\n              return '<span style=\"font-family:' + item + '\">' + item + '</span>';\n            },\n            click: context.createInvokeHandler('editor.fontName')\n          })\n        ]).render();\n      });\n\n      context.memo('button.fontsize', function () {\n        return ui.buttonGroup([\n          ui.button({\n            className: 'dropdown-toggle',\n            contents: '<span class=\"note-current-fontsize\"/>' + ui.icon(options.icons.caret, 'span'),\n            tooltip: lang.font.size,\n            data: {\n              toggle: 'dropdown'\n            }\n          }),\n          ui.dropdownCheck({\n            className: 'dropdown-fontsize',\n            checkClassName: options.icons.menuCheck,\n            items: options.fontSizes,\n            click: context.createInvokeHandler('editor.fontSize')\n          })\n        ]).render();\n      });\n\n      context.memo('button.color', function () {\n        return ui.buttonGroup({\n          className: 'note-color',\n          children: [\n            ui.button({\n              className: 'note-current-color-button',\n              contents: ui.icon(options.icons.font + ' note-recent-color'),\n              tooltip: lang.color.recent,\n              click: function (e) {\n                var $button = $(e.currentTarget);\n                context.invoke('editor.color', {\n                  backColor: $button.attr('data-backColor'),\n                  foreColor: $button.attr('data-foreColor')\n                });\n              },\n              callback: function ($button) {\n                var $recentColor = $button.find('.note-recent-color');\n                $recentColor.css('background-color', '#FFFF00');\n                $button.attr('data-backColor', '#FFFF00');\n              }\n            }),\n            ui.button({\n              className: 'dropdown-toggle',\n              contents: ui.icon(options.icons.caret, 'span'),\n              tooltip: lang.color.more,\n              data: {\n                toggle: 'dropdown'\n              }\n            }),\n            ui.dropdown({\n              items: [\n                '<li>',\n                '<div class=\"btn-group\">',\n                '  <div class=\"note-palette-title\">' + lang.color.background + '</div>',\n                '  <div>',\n                '    <button type=\"button\" class=\"note-color-reset btn btn-default\" data-event=\"backColor\" data-value=\"inherit\">',\n                lang.color.transparent,\n                '    </button>',\n                '  </div>',\n                '  <div class=\"note-holder\" data-event=\"backColor\"/>',\n                '</div>',\n                '<div class=\"btn-group\">',\n                '  <div class=\"note-palette-title\">' + lang.color.foreground + '</div>',\n                '  <div>',\n                '    <button type=\"button\" class=\"note-color-reset btn btn-default\" data-event=\"removeFormat\" data-value=\"foreColor\">',\n                lang.color.resetToDefault,\n                '    </button>',\n                '  </div>',\n                '  <div class=\"note-holder\" data-event=\"foreColor\"/>',\n                '</div>',\n                '</li>'\n              ].join(''),\n              callback: function ($dropdown) {\n                $dropdown.find('.note-holder').each(function () {\n                  var $holder = $(this);\n                  $holder.append(ui.palette({\n                    colors: options.colors,\n                    eventName: $holder.data('event')\n                  }).render());\n                });\n              },\n              click: function (event) {\n                var $button = $(event.target);\n                var eventName = $button.data('event');\n                var value = $button.data('value');\n\n                if (eventName && value) {\n                  var key = eventName === 'backColor' ? 'background-color' : 'color';\n                  var $color = $button.closest('.note-color').find('.note-recent-color');\n                  var $currentButton = $button.closest('.note-color').find('.note-current-color-button');\n\n                  $color.css(key, value);\n                  $currentButton.attr('data-' + eventName, value);\n                  context.invoke('editor.' + eventName, value);\n                }\n              }\n            })\n          ]\n        }).render();\n      });\n\n      context.memo('button.ul',  function () {\n        return ui.button({\n          contents: ui.icon(options.icons.unorderedlist),\n          tooltip: lang.lists.unordered + representShortcut('insertUnorderedList'),\n          click: context.createInvokeHandler('editor.insertUnorderedList')\n        }).render();\n      });\n\n      context.memo('button.ol', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.orderedlist),\n          tooltip: lang.lists.ordered + representShortcut('insertOrderedList'),\n          click:  context.createInvokeHandler('editor.insertOrderedList')\n        }).render();\n      });\n\n      var justifyLeft = ui.button({\n        contents: ui.icon(options.icons.alignLeft),\n        tooltip: lang.paragraph.left + representShortcut('justifyLeft'),\n        click: context.createInvokeHandler('editor.justifyLeft')\n      });\n\n      var justifyCenter = ui.button({\n        contents: ui.icon(options.icons.alignCenter),\n        tooltip: lang.paragraph.center + representShortcut('justifyCenter'),\n        click: context.createInvokeHandler('editor.justifyCenter')\n      });\n\n      var justifyRight = ui.button({\n        contents: ui.icon(options.icons.alignRight),\n        tooltip: lang.paragraph.right + representShortcut('justifyRight'),\n        click: context.createInvokeHandler('editor.justifyRight')\n      });\n\n      var justifyFull = ui.button({\n        contents: ui.icon(options.icons.alignJustify),\n        tooltip: lang.paragraph.justify + representShortcut('justifyFull'),\n        click: context.createInvokeHandler('editor.justifyFull')\n      });\n\n      var outdent = ui.button({\n        contents: ui.icon(options.icons.outdent),\n        tooltip: lang.paragraph.outdent + representShortcut('outdent'),\n        click: context.createInvokeHandler('editor.outdent')\n      });\n\n      var indent = ui.button({\n        contents: ui.icon(options.icons.indent),\n        tooltip: lang.paragraph.indent + representShortcut('indent'),\n        click: context.createInvokeHandler('editor.indent')\n      });\n\n      context.memo('button.justifyLeft', func.invoke(justifyLeft, 'render'));\n      context.memo('button.justifyCenter', func.invoke(justifyCenter, 'render'));\n      context.memo('button.justifyRight', func.invoke(justifyRight, 'render'));\n      context.memo('button.justifyFull', func.invoke(justifyFull, 'render'));\n      context.memo('button.outdent', func.invoke(outdent, 'render'));\n      context.memo('button.indent', func.invoke(indent, 'render'));\n\n      context.memo('button.paragraph', function () {\n        return ui.buttonGroup([\n          ui.button({\n            className: 'dropdown-toggle',\n            contents: ui.icon(options.icons.alignLeft) + ' ' + ui.icon(options.icons.caret, 'span'),\n            tooltip: lang.paragraph.paragraph,\n            data: {\n              toggle: 'dropdown'\n            }\n          }),\n          ui.dropdown([\n            ui.buttonGroup({\n              className: 'note-align',\n              children: [justifyLeft, justifyCenter, justifyRight, justifyFull]\n            }),\n            ui.buttonGroup({\n              className: 'note-list',\n              children: [outdent, indent]\n            })\n          ])\n        ]).render();\n      });\n\n      context.memo('button.height', function () {\n        return ui.buttonGroup([\n          ui.button({\n            className: 'dropdown-toggle',\n            contents: ui.icon(options.icons.textHeight) + ' ' + ui.icon(options.icons.caret, 'span'),\n            tooltip: lang.font.height,\n            data: {\n              toggle: 'dropdown'\n            }\n          }),\n          ui.dropdownCheck({\n            items: options.lineHeights,\n            checkClassName: options.icons.menuCheck,\n            className: 'dropdown-line-height',\n            click: context.createInvokeHandler('editor.lineHeight')\n          })\n        ]).render();\n      });\n\n      context.memo('button.table', function () {\n        return ui.buttonGroup([\n          ui.button({\n            className: 'dropdown-toggle',\n            contents: ui.icon(options.icons.table) + ' ' + ui.icon(options.icons.caret, 'span'),\n            tooltip: lang.table.table,\n            data: {\n              toggle: 'dropdown'\n            }\n          }),\n          ui.dropdown({\n            className: 'note-table',\n            items: [\n              '<div class=\"note-dimension-picker\">',\n              '  <div class=\"note-dimension-picker-mousecatcher\" data-event=\"insertTable\" data-value=\"1x1\"/>',\n              '  <div class=\"note-dimension-picker-highlighted\"/>',\n              '  <div class=\"note-dimension-picker-unhighlighted\"/>',\n              '</div>',\n              '<div class=\"note-dimension-display\">1 x 1</div>'\n            ].join('')\n          })\n        ], {\n          callback: function ($node) {\n            var $catcher = $node.find('.note-dimension-picker-mousecatcher');\n            $catcher.css({\n              width: options.insertTableMaxSize.col + 'em',\n              height: options.insertTableMaxSize.row + 'em'\n            }).mousedown(context.createInvokeHandler('editor.insertTable'))\n              .on('mousemove', self.tableMoveHandler);\n          }\n        }).render();\n      });\n\n      context.memo('button.link', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.link),\n          tooltip: lang.link.link + representShortcut('linkDialog.show'),\n          click: context.createInvokeHandler('linkDialog.show')\n        }).render();\n      });\n\n      context.memo('button.picture', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.picture),\n          tooltip: lang.image.image,\n          click: context.createInvokeHandler('imageDialog.show')\n        }).render();\n      });\n\n      context.memo('button.video', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.video),\n          tooltip: lang.video.video,\n          click: context.createInvokeHandler('videoDialog.show')\n        }).render();\n      });\n\n      context.memo('button.hr', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.minus),\n          tooltip: lang.hr.insert + representShortcut('insertHorizontalRule'),\n          click: context.createInvokeHandler('editor.insertHorizontalRule')\n        }).render();\n      });\n\n      context.memo('button.fullscreen', function () {\n        return ui.button({\n          className: 'btn-fullscreen',\n          contents: ui.icon(options.icons.arrowsAlt),\n          tooltip: lang.options.fullscreen,\n          click: context.createInvokeHandler('fullscreen.toggle')\n        }).render();\n      });\n\n      context.memo('button.codeview', function () {\n        return ui.button({\n          className: 'btn-codeview',\n          contents: ui.icon(options.icons.code),\n          tooltip: lang.options.codeview,\n          click: context.createInvokeHandler('codeview.toggle')\n        }).render();\n      });\n\n      context.memo('button.redo', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.redo),\n          tooltip: lang.history.redo + representShortcut('redo'),\n          click: context.createInvokeHandler('editor.redo')\n        }).render();\n      });\n\n      context.memo('button.undo', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.undo),\n          tooltip: lang.history.undo + representShortcut('undo'),\n          click: context.createInvokeHandler('editor.undo')\n        }).render();\n      });\n\n      context.memo('button.help', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.question),\n          tooltip: lang.options.help,\n          click: context.createInvokeHandler('helpDialog.show')\n        }).render();\n      });\n    };\n\n    /**\n     * image : [\n     *   ['imagesize', ['imageSize100', 'imageSize50', 'imageSize25']],\n     *   ['float', ['floatLeft', 'floatRight', 'floatNone' ]],\n     *   ['remove', ['removeMedia']]\n     * ],\n     */\n    this.addImagePopoverButtons = function () {\n      // Image Size Buttons\n      context.memo('button.imageSize100', function () {\n        return ui.button({\n          contents: '<span class=\"note-fontsize-10\">100%</span>',\n          tooltip: lang.image.resizeFull,\n          click: context.createInvokeHandler('editor.resize', '1')\n        }).render();\n      });\n      context.memo('button.imageSize50', function () {\n        return  ui.button({\n          contents: '<span class=\"note-fontsize-10\">50%</span>',\n          tooltip: lang.image.resizeHalf,\n          click: context.createInvokeHandler('editor.resize', '0.5')\n        }).render();\n      });\n      context.memo('button.imageSize25', function () {\n        return ui.button({\n          contents: '<span class=\"note-fontsize-10\">25%</span>',\n          tooltip: lang.image.resizeQuarter,\n          click: context.createInvokeHandler('editor.resize', '0.25')\n        }).render();\n      });\n\n      // Float Buttons\n      context.memo('button.floatLeft', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.alignLeft),\n          tooltip: lang.image.floatLeft,\n          click: context.createInvokeHandler('editor.floatMe', 'left')\n        }).render();\n      });\n\n      context.memo('button.floatRight', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.alignRight),\n          tooltip: lang.image.floatRight,\n          click: context.createInvokeHandler('editor.floatMe', 'right')\n        }).render();\n      });\n\n      context.memo('button.floatNone', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.alignJustify),\n          tooltip: lang.image.floatNone,\n          click: context.createInvokeHandler('editor.floatMe', 'none')\n        }).render();\n      });\n\n      // Remove Buttons\n      context.memo('button.removeMedia', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.trash),\n          tooltip: lang.image.remove,\n          click: context.createInvokeHandler('editor.removeMedia')\n        }).render();\n      });\n    };\n\n    this.addLinkPopoverButtons = function () {\n      context.memo('button.linkDialogShow', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.link),\n          tooltip: lang.link.edit,\n          click: context.createInvokeHandler('linkDialog.show')\n        }).render();\n      });\n\n      context.memo('button.unlink', function () {\n        return ui.button({\n          contents: ui.icon(options.icons.unlink),\n          tooltip: lang.link.unlink,\n          click: context.createInvokeHandler('editor.unlink')\n        }).render();\n      });\n    };\n\n    this.build = function ($container, groups) {\n      for (var groupIdx = 0, groupLen = groups.length; groupIdx < groupLen; groupIdx++) {\n        var group = groups[groupIdx];\n        var groupName = group[0];\n        var buttons = group[1];\n\n        var $group = ui.buttonGroup({\n          className: 'note-' + groupName\n        }).render();\n\n        for (var idx = 0, len = buttons.length; idx < len; idx++) {\n          var button = context.memo('button.' + buttons[idx]);\n          if (button) {\n            $group.append(typeof button === 'function' ? button(context) : button);\n          }\n        }\n        $group.appendTo($container);\n      }\n    };\n\n    this.updateCurrentStyle = function () {\n      var styleInfo = context.invoke('editor.currentStyle');\n      this.updateBtnStates({\n        '.note-btn-bold': function () {\n          return styleInfo['font-bold'] === 'bold';\n        },\n        '.note-btn-italic': function () {\n          return styleInfo['font-italic'] === 'italic';\n        },\n        '.note-btn-underline': function () {\n          return styleInfo['font-underline'] === 'underline';\n        },\n        '.note-btn-subscript': function () {\n          return styleInfo['font-subscript'] === 'subscript';\n        },\n        '.note-btn-superscript': function () {\n          return styleInfo['font-superscript'] === 'superscript';\n        },\n        '.note-btn-strikethrough': function () {\n          return styleInfo['font-strikethrough'] === 'strikethrough';\n        }\n      });\n\n      if (styleInfo['font-family']) {\n        var fontNames = styleInfo['font-family'].split(',').map(function (name) {\n          return name.replace(/[\\'\\\"]/g, '')\n            .replace(/\\s+$/, '')\n            .replace(/^\\s+/, '');\n        });\n        var fontName = list.find(fontNames, self.isFontInstalled);\n\n        $toolbar.find('.dropdown-fontname li a').each(function () {\n          // always compare string to avoid creating another func.\n          var isChecked = ($(this).data('value') + '') === (fontName + '');\n          this.className = isChecked ? 'checked' : '';\n        });\n        $toolbar.find('.note-current-fontname').text(fontName);\n      }\n\n      if (styleInfo['font-size']) {\n        var fontSize = styleInfo['font-size'];\n        $toolbar.find('.dropdown-fontsize li a').each(function () {\n          // always compare with string to avoid creating another func.\n          var isChecked = ($(this).data('value') + '') === (fontSize + '');\n          this.className = isChecked ? 'checked' : '';\n        });\n        $toolbar.find('.note-current-fontsize').text(fontSize);\n      }\n\n      if (styleInfo['line-height']) {\n        var lineHeight = styleInfo['line-height'];\n        $toolbar.find('.dropdown-line-height li a').each(function () {\n          // always compare with string to avoid creating another func.\n          var isChecked = ($(this).data('value') + '') === (lineHeight + '');\n          this.className = isChecked ? 'checked' : '';\n        });\n      }\n    };\n\n    this.updateBtnStates = function (infos) {\n      $.each(infos, function (selector, pred) {\n        ui.toggleBtnActive($toolbar.find(selector), pred());\n      });\n    };\n\n    this.tableMoveHandler = function (event) {\n      var PX_PER_EM = 18;\n      var $picker = $(event.target.parentNode); // target is mousecatcher\n      var $dimensionDisplay = $picker.next();\n      var $catcher = $picker.find('.note-dimension-picker-mousecatcher');\n      var $highlighted = $picker.find('.note-dimension-picker-highlighted');\n      var $unhighlighted = $picker.find('.note-dimension-picker-unhighlighted');\n\n      var posOffset;\n      // HTML5 with jQuery - e.offsetX is undefined in Firefox\n      if (event.offsetX === undefined) {\n        var posCatcher = $(event.target).offset();\n        posOffset = {\n          x: event.pageX - posCatcher.left,\n          y: event.pageY - posCatcher.top\n        };\n      } else {\n        posOffset = {\n          x: event.offsetX,\n          y: event.offsetY\n        };\n      }\n\n      var dim = {\n        c: Math.ceil(posOffset.x / PX_PER_EM) || 1,\n        r: Math.ceil(posOffset.y / PX_PER_EM) || 1\n      };\n\n      $highlighted.css({ width: dim.c + 'em', height: dim.r + 'em' });\n      $catcher.data('value', dim.c + 'x' + dim.r);\n\n      if (3 < dim.c && dim.c < options.insertTableMaxSize.col) {\n        $unhighlighted.css({ width: dim.c + 1 + 'em'});\n      }\n\n      if (3 < dim.r && dim.r < options.insertTableMaxSize.row) {\n        $unhighlighted.css({ height: dim.r + 1 + 'em'});\n      }\n\n      $dimensionDisplay.html(dim.c + ' x ' + dim.r);\n    };\n  };\n\n  var Toolbar = function (context) {\n    var ui = $.summernote.ui;\n\n    var $note = context.layoutInfo.note;\n    var $toolbar = context.layoutInfo.toolbar;\n    var options = context.options;\n\n    this.shouldInitialize = function () {\n      return !options.airMode;\n    };\n\n    this.initialize = function () {\n      options.toolbar = options.toolbar || [];\n\n      if (!options.toolbar.length) {\n        $toolbar.hide();\n      } else {\n        context.invoke('buttons.build', $toolbar, options.toolbar);\n      }\n\n      if (options.toolbarContainer) {\n        $toolbar.appendTo(options.toolbarContainer);\n      }\n\n      $note.on('summernote.keyup summernote.mouseup summernote.change', function () {\n        context.invoke('buttons.updateCurrentStyle');\n      });\n\n      context.invoke('buttons.updateCurrentStyle');\n    };\n\n    this.destroy = function () {\n      $toolbar.children().remove();\n    };\n\n    this.updateFullscreen = function (isFullscreen) {\n      ui.toggleBtnActive($toolbar.find('.btn-fullscreen'), isFullscreen);\n    };\n\n    this.updateCodeview = function (isCodeview) {\n      ui.toggleBtnActive($toolbar.find('.btn-codeview'), isCodeview);\n      if (isCodeview) {\n        this.deactivate();\n      } else {\n        this.activate();\n      }\n    };\n\n    this.activate = function (isIncludeCodeview) {\n      var $btn = $toolbar.find('button');\n      if (!isIncludeCodeview) {\n        $btn = $btn.not('.btn-codeview');\n      }\n      ui.toggleBtn($btn, true);\n    };\n\n    this.deactivate = function (isIncludeCodeview) {\n      var $btn = $toolbar.find('button');\n      if (!isIncludeCodeview) {\n        $btn = $btn.not('.btn-codeview');\n      }\n      ui.toggleBtn($btn, false);\n    };\n  };\n\n  var LinkDialog = function (context) {\n    var self = this;\n    var ui = $.summernote.ui;\n\n    var $editor = context.layoutInfo.editor;\n    var options = context.options;\n    var lang = options.langInfo;\n\n    this.initialize = function () {\n      var $container = options.dialogsInBody ? $(document.body) : $editor;\n\n      var body = '<div class=\"form-group\">' +\n                   '<label>' + lang.link.textToDisplay + '</label>' +\n                   '<input class=\"note-link-text form-control\" type=\"text\" />' +\n                 '</div>' +\n                 '<div class=\"form-group\">' +\n                   '<label>' + lang.link.url + '</label>' +\n                   '<input class=\"note-link-url form-control\" type=\"text\" value=\"http://\" />' +\n                 '</div>' +\n                 (!options.disableLinkTarget ?\n                   '<div class=\"checkbox\">' +\n                     '<label>' + '<input type=\"checkbox\" checked> ' + lang.link.openInNewWindow + '</label>' +\n                   '</div>' : ''\n                 );\n      var footer = '<button href=\"#\" class=\"btn btn-primary note-link-btn disabled\" disabled>' + lang.link.insert + '</button>';\n\n      this.$dialog = ui.dialog({\n        className: 'link-dialog',\n        title: lang.link.insert,\n        fade: options.dialogsFade,\n        body: body,\n        footer: footer\n      }).render().appendTo($container);\n    };\n\n    this.destroy = function () {\n      ui.hideDialog(this.$dialog);\n      this.$dialog.remove();\n    };\n\n    this.bindEnterKey = function ($input, $btn) {\n      $input.on('keypress', function (event) {\n        if (event.keyCode === key.code.ENTER) {\n          $btn.trigger('click');\n        }\n      });\n    };\n\n    /**\n     * toggle update button\n     */\n    this.toggleLinkBtn = function ($linkBtn, $linkText, $linkUrl) {\n      ui.toggleBtn($linkBtn, $linkText.val() && $linkUrl.val());\n    };\n\n    /**\n     * Show link dialog and set event handlers on dialog controls.\n     *\n     * @param {Object} linkInfo\n     * @return {Promise}\n     */\n    this.showLinkDialog = function (linkInfo) {\n      return $.Deferred(function (deferred) {\n        var $linkText = self.$dialog.find('.note-link-text'),\n        $linkUrl = self.$dialog.find('.note-link-url'),\n        $linkBtn = self.$dialog.find('.note-link-btn'),\n        $openInNewWindow = self.$dialog.find('input[type=checkbox]');\n\n        ui.onDialogShown(self.$dialog, function () {\n          context.triggerEvent('dialog.shown');\n\n          // if no url was given, copy text to url\n          if (!linkInfo.url) {\n            linkInfo.url = linkInfo.text;\n          }\n\n          $linkText.val(linkInfo.text);\n\n          var handleLinkTextUpdate = function () {\n            self.toggleLinkBtn($linkBtn, $linkText, $linkUrl);\n            // if linktext was modified by keyup,\n            // stop cloning text from linkUrl\n            linkInfo.text = $linkText.val();\n          };\n\n          $linkText.on('input', handleLinkTextUpdate).on('paste', function () {\n            setTimeout(handleLinkTextUpdate, 0);\n          });\n\n          var handleLinkUrlUpdate = function () {\n            self.toggleLinkBtn($linkBtn, $linkText, $linkUrl);\n            // display same link on `Text to display` input\n            // when create a new link\n            if (!linkInfo.text) {\n              $linkText.val($linkUrl.val());\n            }\n          };\n\n          $linkUrl.on('input', handleLinkUrlUpdate).on('paste', function () {\n            setTimeout(handleLinkUrlUpdate, 0);\n          }).val(linkInfo.url).trigger('focus');\n\n          self.toggleLinkBtn($linkBtn, $linkText, $linkUrl);\n          self.bindEnterKey($linkUrl, $linkBtn);\n          self.bindEnterKey($linkText, $linkBtn);\n\n          $openInNewWindow.prop('checked', linkInfo.isNewWindow);\n\n          $linkBtn.one('click', function (event) {\n            event.preventDefault();\n\n            deferred.resolve({\n              range: linkInfo.range,\n              url: $linkUrl.val(),\n              text: $linkText.val(),\n              isNewWindow: $openInNewWindow.is(':checked')\n            });\n            self.$dialog.modal('hide');\n          });\n        });\n\n        ui.onDialogHidden(self.$dialog, function () {\n          // detach events\n          $linkText.off('input paste keypress');\n          $linkUrl.off('input paste keypress');\n          $linkBtn.off('click');\n\n          if (deferred.state() === 'pending') {\n            deferred.reject();\n          }\n        });\n\n        ui.showDialog(self.$dialog);\n      }).promise();\n    };\n\n    /**\n     * @param {Object} layoutInfo\n     */\n    this.show = function () {\n      var linkInfo = context.invoke('editor.getLinkInfo');\n\n      context.invoke('editor.saveRange');\n      this.showLinkDialog(linkInfo).then(function (linkInfo) {\n        context.invoke('editor.restoreRange');\n        context.invoke('editor.createLink', linkInfo);\n      }).fail(function () {\n        context.invoke('editor.restoreRange');\n      });\n    };\n    context.memo('help.linkDialog.show', options.langInfo.help['linkDialog.show']);\n  };\n\n  var LinkPopover = function (context) {\n    var self = this;\n    var ui = $.summernote.ui;\n\n    var options = context.options;\n\n    this.events = {\n      'summernote.keyup summernote.mouseup summernote.change summernote.scroll': function () {\n        self.update();\n      },\n      'summernote.dialog.shown': function () {\n        self.hide();\n      }\n    };\n\n    this.shouldInitialize = function () {\n      return !list.isEmpty(options.popover.link);\n    };\n\n    this.initialize = function () {\n      this.$popover = ui.popover({\n        className: 'note-link-popover',\n        callback: function ($node) {\n          var $content = $node.find('.popover-content');\n          $content.prepend('<span><a target=\"_blank\"></a>&nbsp;</span>');\n        }\n      }).render().appendTo('body');\n      var $content = this.$popover.find('.popover-content');\n\n      context.invoke('buttons.build', $content, options.popover.link);\n    };\n\n    this.destroy = function () {\n      this.$popover.remove();\n    };\n\n    this.update = function () {\n      // Prevent focusing on editable when invoke('code') is executed\n      if (!context.invoke('editor.hasFocus')) {\n        this.hide();\n        return;\n      }\n\n      var rng = context.invoke('editor.createRange');\n      if (rng.isCollapsed() && rng.isOnAnchor()) {\n        var anchor = dom.ancestor(rng.sc, dom.isAnchor);\n        var href = $(anchor).attr('href');\n        this.$popover.find('a').attr('href', href).html(href);\n\n        var pos = dom.posFromPlaceholder(anchor);\n        this.$popover.css({\n          display: 'block',\n          left: pos.left,\n          top: pos.top\n        });\n      } else {\n        this.hide();\n      }\n    };\n\n    this.hide = function () {\n      this.$popover.hide();\n    };\n  };\n\n  var ImageDialog = function (context) {\n    var self = this;\n    var ui = $.summernote.ui;\n\n    var $editor = context.layoutInfo.editor;\n    var options = context.options;\n    var lang = options.langInfo;\n\n    this.initialize = function () {\n      var $container = options.dialogsInBody ? $(document.body) : $editor;\n\n      var imageLimitation = '';\n      if (options.maximumImageFileSize) {\n        var unit = Math.floor(Math.log(options.maximumImageFileSize) / Math.log(1024));\n        var readableSize = (options.maximumImageFileSize / Math.pow(1024, unit)).toFixed(2) * 1 +\n                           ' ' + ' KMGTP'[unit] + 'B';\n        imageLimitation = '<small>' + lang.image.maximumFileSize + ' : ' + readableSize + '</small>';\n      }\n\n      var body = '<div class=\"form-group note-group-select-from-files\">' +\n                   '<label>' + lang.image.selectFromFiles + '</label>' +\n                   '<input class=\"note-image-input form-control\" type=\"file\" name=\"files\" accept=\"image/*\" multiple=\"multiple\" />' +\n                   imageLimitation +\n                 '</div>' +\n                 '<div class=\"form-group note-group-image-url\" style=\"overflow:auto;\">' +\n                   '<label>' + lang.image.url + '</label>' +\n                   '<input class=\"note-image-url form-control col-md-12\" type=\"text\" />' +\n                 '</div>';\n      var footer = '<button href=\"#\" class=\"btn btn-primary note-image-btn disabled\" disabled>' + lang.image.insert + '</button>';\n\n      this.$dialog = ui.dialog({\n        title: lang.image.insert,\n        fade: options.dialogsFade,\n        body: body,\n        footer: footer\n      }).render().appendTo($container);\n    };\n\n    this.destroy = function () {\n      ui.hideDialog(this.$dialog);\n      this.$dialog.remove();\n    };\n\n    this.bindEnterKey = function ($input, $btn) {\n      $input.on('keypress', function (event) {\n        if (event.keyCode === key.code.ENTER) {\n          $btn.trigger('click');\n        }\n      });\n    };\n\n    this.show = function () {\n      context.invoke('editor.saveRange');\n      this.showImageDialog().then(function (data) {\n        // [workaround] hide dialog before restore range for IE range focus\n        ui.hideDialog(self.$dialog);\n        context.invoke('editor.restoreRange');\n\n        if (typeof data === 'string') { // image url\n          context.invoke('editor.insertImage', data);\n        } else { // array of files\n          context.invoke('editor.insertImagesOrCallback', data);\n        }\n      }).fail(function () {\n        context.invoke('editor.restoreRange');\n      });\n    };\n\n    /**\n     * show image dialog\n     *\n     * @param {jQuery} $dialog\n     * @return {Promise}\n     */\n    this.showImageDialog = function () {\n      return $.Deferred(function (deferred) {\n        var $imageInput = self.$dialog.find('.note-image-input'),\n            $imageUrl = self.$dialog.find('.note-image-url'),\n            $imageBtn = self.$dialog.find('.note-image-btn');\n\n        ui.onDialogShown(self.$dialog, function () {\n          context.triggerEvent('dialog.shown');\n\n          // Cloning imageInput to clear element.\n          $imageInput.replaceWith($imageInput.clone()\n            .on('change', function () {\n              deferred.resolve(this.files || this.value);\n            })\n            .val('')\n          );\n\n          $imageBtn.click(function (event) {\n            event.preventDefault();\n\n            deferred.resolve($imageUrl.val());\n          });\n\n          $imageUrl.on('keyup paste', function () {\n            var url = $imageUrl.val();\n            ui.toggleBtn($imageBtn, url);\n          }).val('').trigger('focus');\n          self.bindEnterKey($imageUrl, $imageBtn);\n        });\n\n        ui.onDialogHidden(self.$dialog, function () {\n          $imageInput.off('change');\n          $imageUrl.off('keyup paste keypress');\n          $imageBtn.off('click');\n\n          if (deferred.state() === 'pending') {\n            deferred.reject();\n          }\n        });\n\n        ui.showDialog(self.$dialog);\n      });\n    };\n  };\n\n  var ImagePopover = function (context) {\n    var ui = $.summernote.ui;\n\n    var options = context.options;\n\n    this.shouldInitialize = function () {\n      return !list.isEmpty(options.popover.image);\n    };\n\n    this.initialize = function () {\n      this.$popover = ui.popover({\n        className: 'note-image-popover'\n      }).render().appendTo('body');\n      var $content = this.$popover.find('.popover-content');\n\n      context.invoke('buttons.build', $content, options.popover.image);\n    };\n\n    this.destroy = function () {\n      this.$popover.remove();\n    };\n\n    this.update = function (target) {\n      if (dom.isImg(target)) {\n        var pos = dom.posFromPlaceholder(target);\n        this.$popover.css({\n          display: 'block',\n          left: pos.left,\n          top: pos.top\n        });\n      } else {\n        this.hide();\n      }\n    };\n\n    this.hide = function () {\n      this.$popover.hide();\n    };\n  };\n\n  var VideoDialog = function (context) {\n    var self = this;\n    var ui = $.summernote.ui;\n\n    var $editor = context.layoutInfo.editor;\n    var options = context.options;\n    var lang = options.langInfo;\n\n    this.initialize = function () {\n      var $container = options.dialogsInBody ? $(document.body) : $editor;\n\n      var body = '<div class=\"form-group row-fluid\">' +\n          '<label>' + lang.video.url + ' <small class=\"text-muted\">' + lang.video.providers + '</small></label>' +\n          '<input class=\"note-video-url form-control span12\" type=\"text\" />' +\n          '</div>';\n      var footer = '<button href=\"#\" class=\"btn btn-primary note-video-btn disabled\" disabled>' + lang.video.insert + '</button>';\n\n      this.$dialog = ui.dialog({\n        title: lang.video.insert,\n        fade: options.dialogsFade,\n        body: body,\n        footer: footer\n      }).render().appendTo($container);\n    };\n\n    this.destroy = function () {\n      ui.hideDialog(this.$dialog);\n      this.$dialog.remove();\n    };\n\n    this.bindEnterKey = function ($input, $btn) {\n      $input.on('keypress', function (event) {\n        if (event.keyCode === key.code.ENTER) {\n          $btn.trigger('click');\n        }\n      });\n    };\n\n    this.createVideoNode = function (url) {\n      // video url patterns(youtube, instagram, vimeo, dailymotion, youku, mp4, ogg, webm)\n      var ytRegExp = /^(?:https?:\\/\\/)?(?:www\\.)?(?:youtu\\.be\\/|youtube\\.com\\/(?:embed\\/|v\\/|watch\\?v=|watch\\?.+&v=))((\\w|-){11})(?:\\S+)?$/;\n      var ytMatch = url.match(ytRegExp);\n\n      var igRegExp = /(?:www\\.|\\/\\/)instagram\\.com\\/p\\/(.[a-zA-Z0-9_-]*)/;\n      var igMatch = url.match(igRegExp);\n\n      var vRegExp = /\\/\\/vine\\.co\\/v\\/([a-zA-Z0-9]+)/;\n      var vMatch = url.match(vRegExp);\n\n      var vimRegExp = /\\/\\/(player\\.)?vimeo\\.com\\/([a-z]*\\/)*([0-9]{6,11})[?]?.*/;\n      var vimMatch = url.match(vimRegExp);\n\n      var dmRegExp = /.+dailymotion.com\\/(video|hub)\\/([^_]+)[^#]*(#video=([^_&]+))?/;\n      var dmMatch = url.match(dmRegExp);\n\n      var youkuRegExp = /\\/\\/v\\.youku\\.com\\/v_show\\/id_(\\w+)=*\\.html/;\n      var youkuMatch = url.match(youkuRegExp);\n\n      var mp4RegExp = /^.+.(mp4|m4v)$/;\n      var mp4Match = url.match(mp4RegExp);\n\n      var oggRegExp = /^.+.(ogg|ogv)$/;\n      var oggMatch = url.match(oggRegExp);\n\n      var webmRegExp = /^.+.(webm)$/;\n      var webmMatch = url.match(webmRegExp);\n\n      var $video;\n      if (ytMatch && ytMatch[1].length === 11) {\n        var youtubeId = ytMatch[1];\n        $video = $('<iframe>')\n            .attr('frameborder', 0)\n            .attr('src', '//www.youtube.com/embed/' + youtubeId)\n            .attr('width', '640').attr('height', '360');\n      } else if (igMatch && igMatch[0].length) {\n        $video = $('<iframe>')\n            .attr('frameborder', 0)\n            .attr('src', 'https://instagram.com/p/' + igMatch[1] + '/embed/')\n            .attr('width', '612').attr('height', '710')\n            .attr('scrolling', 'no')\n            .attr('allowtransparency', 'true');\n      } else if (vMatch && vMatch[0].length) {\n        $video = $('<iframe>')\n            .attr('frameborder', 0)\n            .attr('src', vMatch[0] + '/embed/simple')\n            .attr('width', '600').attr('height', '600')\n            .attr('class', 'vine-embed');\n      } else if (vimMatch && vimMatch[3].length) {\n        $video = $('<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>')\n            .attr('frameborder', 0)\n            .attr('src', '//player.vimeo.com/video/' + vimMatch[3])\n            .attr('width', '640').attr('height', '360');\n      } else if (dmMatch && dmMatch[2].length) {\n        $video = $('<iframe>')\n            .attr('frameborder', 0)\n            .attr('src', '//www.dailymotion.com/embed/video/' + dmMatch[2])\n            .attr('width', '640').attr('height', '360');\n      } else if (youkuMatch && youkuMatch[1].length) {\n        $video = $('<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>')\n            .attr('frameborder', 0)\n            .attr('height', '498')\n            .attr('width', '510')\n            .attr('src', '//player.youku.com/embed/' + youkuMatch[1]);\n      } else if (mp4Match || oggMatch || webmMatch) {\n        $video = $('<video controls>')\n            .attr('src', url)\n            .attr('width', '640').attr('height', '360');\n      } else {\n        // this is not a known video link. Now what, Cat? Now what?\n        return false;\n      }\n\n      $video.addClass('note-video-clip');\n\n      return $video[0];\n    };\n\n    this.show = function () {\n      var text = context.invoke('editor.getSelectedText');\n      context.invoke('editor.saveRange');\n      this.showVideoDialog(text).then(function (url) {\n        // [workaround] hide dialog before restore range for IE range focus\n        ui.hideDialog(self.$dialog);\n        context.invoke('editor.restoreRange');\n\n        // build node\n        var $node = self.createVideoNode(url);\n\n        if ($node) {\n          // insert video node\n          context.invoke('editor.insertNode', $node);\n        }\n      }).fail(function () {\n        context.invoke('editor.restoreRange');\n      });\n    };\n\n    /**\n     * show image dialog\n     *\n     * @param {jQuery} $dialog\n     * @return {Promise}\n     */\n    this.showVideoDialog = function (text) {\n      return $.Deferred(function (deferred) {\n        var $videoUrl = self.$dialog.find('.note-video-url'),\n            $videoBtn = self.$dialog.find('.note-video-btn');\n\n        ui.onDialogShown(self.$dialog, function () {\n          context.triggerEvent('dialog.shown');\n\n          $videoUrl.val(text).on('input', function () {\n            ui.toggleBtn($videoBtn, $videoUrl.val());\n          }).trigger('focus');\n\n          $videoBtn.click(function (event) {\n            event.preventDefault();\n\n            deferred.resolve($videoUrl.val());\n          });\n\n          self.bindEnterKey($videoUrl, $videoBtn);\n        });\n\n        ui.onDialogHidden(self.$dialog, function () {\n          $videoUrl.off('input');\n          $videoBtn.off('click');\n\n          if (deferred.state() === 'pending') {\n            deferred.reject();\n          }\n        });\n\n        ui.showDialog(self.$dialog);\n      });\n    };\n  };\n\n  var HelpDialog = function (context) {\n    var self = this;\n    var ui = $.summernote.ui;\n\n    var $editor = context.layoutInfo.editor;\n    var options = context.options;\n    var lang = options.langInfo;\n\n    this.createShortCutList = function () {\n      var keyMap = options.keyMap[agent.isMac ? 'mac' : 'pc'];\n      return Object.keys(keyMap).map(function (key) {\n        var command = keyMap[key];\n        var $row = $('<div><div class=\"help-list-item\"/></div>');\n        $row.append($('<label><kbd>' + key + '</kdb></label>').css({\n          'width': 180,\n          'margin-right': 10\n        })).append($('<span/>').html(context.memo('help.' + command) || command));\n        return $row.html();\n      }).join('');\n    };\n\n    this.initialize = function () {\n      var $container = options.dialogsInBody ? $(document.body) : $editor;\n\n      var body = [\n        '<p class=\"text-center\">',\n        '<a href=\"http://summernote.org/\" target=\"_blank\">Summernote 0.8.3</a> · ',\n        '<a href=\"https://github.com/summernote/summernote\" target=\"_blank\">Project</a> · ',\n        '<a href=\"https://github.com/summernote/summernote/issues\" target=\"_blank\">Issues</a>',\n        '</p>'\n      ].join('');\n\n      this.$dialog = ui.dialog({\n        title: lang.options.help,\n        fade: options.dialogsFade,\n        body: this.createShortCutList(),\n        footer: body,\n        callback: function ($node) {\n          $node.find('.modal-body').css({\n            'max-height': 300,\n            'overflow': 'scroll'\n          });\n        }\n      }).render().appendTo($container);\n    };\n\n    this.destroy = function () {\n      ui.hideDialog(this.$dialog);\n      this.$dialog.remove();\n    };\n\n    /**\n     * show help dialog\n     *\n     * @return {Promise}\n     */\n    this.showHelpDialog = function () {\n      return $.Deferred(function (deferred) {\n        ui.onDialogShown(self.$dialog, function () {\n          context.triggerEvent('dialog.shown');\n          deferred.resolve();\n        });\n        ui.showDialog(self.$dialog);\n      }).promise();\n    };\n\n    this.show = function () {\n      context.invoke('editor.saveRange');\n      this.showHelpDialog().then(function () {\n        context.invoke('editor.restoreRange');\n      });\n    };\n  };\n\n  var AirPopover = function (context) {\n    var self = this;\n    var ui = $.summernote.ui;\n\n    var options = context.options;\n\n    var AIR_MODE_POPOVER_X_OFFSET = 20;\n\n    this.events = {\n      'summernote.keyup summernote.mouseup summernote.scroll': function () {\n        self.update();\n      },\n      'summernote.change summernote.dialog.shown': function () {\n        self.hide();\n      },\n      'summernote.focusout': function (we, e) {\n        // [workaround] Firefox doesn't support relatedTarget on focusout\n        //  - Ignore hide action on focus out in FF.\n        if (agent.isFF) {\n          return;\n        }\n\n        if (!e.relatedTarget || !dom.ancestor(e.relatedTarget, func.eq(self.$popover[0]))) {\n          self.hide();\n        }\n      }\n    };\n\n    this.shouldInitialize = function () {\n      return options.airMode && !list.isEmpty(options.popover.air);\n    };\n\n    this.initialize = function () {\n      this.$popover = ui.popover({\n        className: 'note-air-popover'\n      }).render().appendTo('body');\n      var $content = this.$popover.find('.popover-content');\n\n      context.invoke('buttons.build', $content, options.popover.air);\n    };\n\n    this.destroy = function () {\n      this.$popover.remove();\n    };\n\n    this.update = function () {\n      var styleInfo = context.invoke('editor.currentStyle');\n      if (styleInfo.range && !styleInfo.range.isCollapsed()) {\n        var rect = list.last(styleInfo.range.getClientRects());\n        if (rect) {\n          var bnd = func.rect2bnd(rect);\n          this.$popover.css({\n            display: 'block',\n            left: Math.max(bnd.left + bnd.width / 2, 0) - AIR_MODE_POPOVER_X_OFFSET,\n            top: bnd.top + bnd.height\n          });\n        }\n      } else {\n        this.hide();\n      }\n    };\n\n    this.hide = function () {\n      this.$popover.hide();\n    };\n  };\n\n  var HintPopover = function (context) {\n    var self = this;\n    var ui = $.summernote.ui;\n\n    var POPOVER_DIST = 5;\n    var hint = context.options.hint || [];\n    var direction = context.options.hintDirection || 'bottom';\n    var hints = $.isArray(hint) ? hint : [hint];\n\n    this.events = {\n      'summernote.keyup': function (we, e) {\n        if (!e.isDefaultPrevented()) {\n          self.handleKeyup(e);\n        }\n      },\n      'summernote.keydown': function (we, e) {\n        self.handleKeydown(e);\n      },\n      'summernote.dialog.shown': function () {\n        self.hide();\n      }\n    };\n\n    this.shouldInitialize = function () {\n      return hints.length > 0;\n    };\n\n    this.initialize = function () {\n      this.lastWordRange = null;\n      this.$popover = ui.popover({\n        className: 'note-hint-popover',\n        hideArrow: true,\n        direction: ''\n      }).render().appendTo('body');\n\n      this.$popover.hide();\n\n      this.$content = this.$popover.find('.popover-content');\n\n      this.$content.on('click', '.note-hint-item', function () {\n        self.$content.find('.active').removeClass('active');\n        $(this).addClass('active');\n        self.replace();\n      });\n    };\n\n    this.destroy = function () {\n      this.$popover.remove();\n    };\n\n    this.selectItem = function ($item) {\n      this.$content.find('.active').removeClass('active');\n      $item.addClass('active');\n\n      this.$content[0].scrollTop = $item[0].offsetTop - (this.$content.innerHeight() / 2);\n    };\n\n    this.moveDown = function () {\n      var $current = this.$content.find('.note-hint-item.active');\n      var $next = $current.next();\n\n      if ($next.length) {\n        this.selectItem($next);\n      } else {\n        var $nextGroup = $current.parent().next();\n\n        if (!$nextGroup.length) {\n          $nextGroup = this.$content.find('.note-hint-group').first();\n        }\n\n        this.selectItem($nextGroup.find('.note-hint-item').first());\n      }\n    };\n\n    this.moveUp = function () {\n      var $current = this.$content.find('.note-hint-item.active');\n      var $prev = $current.prev();\n\n      if ($prev.length) {\n        this.selectItem($prev);\n      } else {\n        var $prevGroup = $current.parent().prev();\n\n        if (!$prevGroup.length) {\n          $prevGroup = this.$content.find('.note-hint-group').last();\n        }\n\n        this.selectItem($prevGroup.find('.note-hint-item').last());\n      }\n    };\n\n    this.replace = function () {\n      var $item = this.$content.find('.note-hint-item.active');\n\n      if ($item.length) {\n        var node = this.nodeFromItem($item);\n        this.lastWordRange.insertNode(node);\n        range.createFromNode(node).collapse().select();\n\n        this.lastWordRange = null;\n        this.hide();\n        context.invoke('editor.focus');\n      }\n\n    };\n\n    this.nodeFromItem = function ($item) {\n      var hint = hints[$item.data('index')];\n      var item = $item.data('item');\n      var node = hint.content ? hint.content(item) : item;\n      if (typeof node === 'string') {\n        node = dom.createText(node);\n      }\n      return node;\n    };\n\n    this.createItemTemplates = function (hintIdx, items) {\n      var hint = hints[hintIdx];\n      return items.map(function (item, idx) {\n        var $item = $('<div class=\"note-hint-item\"/>');\n        $item.append(hint.template ? hint.template(item) : item + '');\n        $item.data({\n          'index': hintIdx,\n          'item': item\n        });\n\n        if (hintIdx === 0 && idx === 0) {\n          $item.addClass('active');\n        }\n        return $item;\n      });\n    };\n\n    this.handleKeydown = function (e) {\n      if (!this.$popover.is(':visible')) {\n        return;\n      }\n\n      if (e.keyCode === key.code.ENTER) {\n        e.preventDefault();\n        this.replace();\n      } else if (e.keyCode === key.code.UP) {\n        e.preventDefault();\n        this.moveUp();\n      } else if (e.keyCode === key.code.DOWN) {\n        e.preventDefault();\n        this.moveDown();\n      }\n    };\n\n    this.searchKeyword = function (index, keyword, callback) {\n      var hint = hints[index];\n      if (hint && hint.match.test(keyword) && hint.search) {\n        var matches = hint.match.exec(keyword);\n        hint.search(matches[1], callback);\n      } else {\n        callback();\n      }\n    };\n\n    this.createGroup = function (idx, keyword) {\n      var $group = $('<div class=\"note-hint-group note-hint-group-' + idx + '\"/>');\n      this.searchKeyword(idx, keyword, function (items) {\n        items = items || [];\n        if (items.length) {\n          $group.html(self.createItemTemplates(idx, items));\n          self.show();\n        }\n      });\n\n      return $group;\n    };\n\n    this.handleKeyup = function (e) {\n      if (list.contains([key.code.ENTER, key.code.UP, key.code.DOWN], e.keyCode)) {\n        if (e.keyCode === key.code.ENTER) {\n          if (this.$popover.is(':visible')) {\n            return;\n          }\n        }\n      } else {\n        var wordRange = context.invoke('editor.createRange').getWordRange();\n        var keyword = wordRange.toString();\n        if (hints.length && keyword) {\n          this.$content.empty();\n\n          var bnd = func.rect2bnd(list.last(wordRange.getClientRects()));\n          if (bnd) {\n\n            this.$popover.hide();\n\n            this.lastWordRange = wordRange;\n\n            hints.forEach(function (hint, idx) {\n              if (hint.match.test(keyword)) {\n                self.createGroup(idx, keyword).appendTo(self.$content);\n              }\n            });\n\n            // set position for popover after group is created\n            if (direction === 'top') {\n              this.$popover.css({\n                left: bnd.left,\n                top: bnd.top - this.$popover.outerHeight() - POPOVER_DIST\n              });\n            } else {\n              this.$popover.css({\n                left: bnd.left,\n                top: bnd.top + bnd.height + POPOVER_DIST\n              });\n            }\n\n          }\n        } else {\n          this.hide();\n        }\n      }\n    };\n\n    this.show = function () {\n      this.$popover.show();\n    };\n\n    this.hide = function () {\n      this.$popover.hide();\n    };\n  };\n\n\n  $.summernote = $.extend($.summernote, {\n    version: '0.8.3',\n    ui: ui,\n    dom: dom,\n\n    plugins: {},\n\n    options: {\n      modules: {\n        'editor': Editor,\n        'clipboard': Clipboard,\n        'dropzone': Dropzone,\n        'codeview': Codeview,\n        'statusbar': Statusbar,\n        'fullscreen': Fullscreen,\n        'handle': Handle,\n        // FIXME: HintPopover must be front of autolink\n        //  - Script error about range when Enter key is pressed on hint popover\n        'hintPopover': HintPopover,\n        'autoLink': AutoLink,\n        'autoSync': AutoSync,\n        'placeholder': Placeholder,\n        'buttons': Buttons,\n        'toolbar': Toolbar,\n        'linkDialog': LinkDialog,\n        'linkPopover': LinkPopover,\n        'imageDialog': ImageDialog,\n        'imagePopover': ImagePopover,\n        'videoDialog': VideoDialog,\n        'helpDialog': HelpDialog,\n        'airPopover': AirPopover\n      },\n\n      buttons: {},\n      \n      lang: 'en-US',\n\n      // toolbar\n      toolbar: [\n        ['style', ['style']],\n        ['font', ['bold', 'underline', 'clear']],\n        ['fontname', ['fontname']],\n        ['color', ['color']],\n        ['para', ['ul', 'ol', 'paragraph']],\n        ['table', ['table']],\n        ['insert', ['link', 'picture', 'video']],\n        ['view', ['fullscreen', 'codeview', 'help']]\n      ],\n\n      // popover\n      popover: {\n        image: [\n          ['imagesize', ['imageSize100', 'imageSize50', 'imageSize25']],\n          ['float', ['floatLeft', 'floatRight', 'floatNone']],\n          ['remove', ['removeMedia']]\n        ],\n        link: [\n          ['link', ['linkDialogShow', 'unlink']]\n        ],\n        air: [\n          ['color', ['color']],\n          ['font', ['bold', 'underline', 'clear']],\n          ['para', ['ul', 'paragraph']],\n          ['table', ['table']],\n          ['insert', ['link', 'picture']]\n        ]\n      },\n\n      // air mode: inline editor\n      airMode: false,\n\n      width: null,\n      height: null,\n\n      focus: false,\n      tabSize: 4,\n      styleWithSpan: true,\n      shortcuts: true,\n      textareaAutoSync: true,\n      direction: null,\n\n      styleTags: ['p', 'blockquote', 'pre', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'],\n\n      fontNames: [\n        'Arial', 'Arial Black', 'Comic Sans MS', 'Courier New',\n        'Helvetica Neue', 'Helvetica', 'Impact', 'Lucida Grande',\n        'Tahoma', 'Times New Roman', 'Verdana'\n      ],\n\n      fontSizes: ['8', '9', '10', '11', '12', '14', '18', '24', '36'],\n\n      // pallete colors(n x n)\n      colors: [\n        ['#000000', '#424242', '#636363', '#9C9C94', '#CEC6CE', '#EFEFEF', '#F7F7F7', '#FFFFFF'],\n        ['#FF0000', '#FF9C00', '#FFFF00', '#00FF00', '#00FFFF', '#0000FF', '#9C00FF', '#FF00FF'],\n        ['#F7C6CE', '#FFE7CE', '#FFEFC6', '#D6EFD6', '#CEDEE7', '#CEE7F7', '#D6D6E7', '#E7D6DE'],\n        ['#E79C9C', '#FFC69C', '#FFE79C', '#B5D6A5', '#A5C6CE', '#9CC6EF', '#B5A5D6', '#D6A5BD'],\n        ['#E76363', '#F7AD6B', '#FFD663', '#94BD7B', '#73A5AD', '#6BADDE', '#8C7BC6', '#C67BA5'],\n        ['#CE0000', '#E79439', '#EFC631', '#6BA54A', '#4A7B8C', '#3984C6', '#634AA5', '#A54A7B'],\n        ['#9C0000', '#B56308', '#BD9400', '#397B21', '#104A5A', '#085294', '#311873', '#731842'],\n        ['#630000', '#7B3900', '#846300', '#295218', '#083139', '#003163', '#21104A', '#4A1031']\n      ],\n\n      lineHeights: ['1.0', '1.2', '1.4', '1.5', '1.6', '1.8', '2.0', '3.0'],\n\n      tableClassName: 'table table-bordered',\n\n      insertTableMaxSize: {\n        col: 10,\n        row: 10\n      },\n\n      dialogsInBody: false,\n      dialogsFade: false,\n\n      maximumImageFileSize: null,\n\n      callbacks: {\n        onInit: null,\n        onFocus: null,\n        onBlur: null,\n        onEnter: null,\n        onKeyup: null,\n        onKeydown: null,\n        onImageUpload: null,\n        onImageUploadError: null\n      },\n\n      codemirror: {\n        mode: 'text/html',\n        htmlMode: true,\n        lineNumbers: true\n      },\n\n      keyMap: {\n        pc: {\n          'ENTER': 'insertParagraph',\n          'CTRL+Z': 'undo',\n          'CTRL+Y': 'redo',\n          'TAB': 'tab',\n          'SHIFT+TAB': 'untab',\n          'CTRL+B': 'bold',\n          'CTRL+I': 'italic',\n          'CTRL+U': 'underline',\n          'CTRL+SHIFT+S': 'strikethrough',\n          'CTRL+BACKSLASH': 'removeFormat',\n          'CTRL+SHIFT+L': 'justifyLeft',\n          'CTRL+SHIFT+E': 'justifyCenter',\n          'CTRL+SHIFT+R': 'justifyRight',\n          'CTRL+SHIFT+J': 'justifyFull',\n          'CTRL+SHIFT+NUM7': 'insertUnorderedList',\n          'CTRL+SHIFT+NUM8': 'insertOrderedList',\n          'CTRL+LEFTBRACKET': 'outdent',\n          'CTRL+RIGHTBRACKET': 'indent',\n          'CTRL+NUM0': 'formatPara',\n          'CTRL+NUM1': 'formatH1',\n          'CTRL+NUM2': 'formatH2',\n          'CTRL+NUM3': 'formatH3',\n          'CTRL+NUM4': 'formatH4',\n          'CTRL+NUM5': 'formatH5',\n          'CTRL+NUM6': 'formatH6',\n          'CTRL+ENTER': 'insertHorizontalRule',\n          'CTRL+K': 'linkDialog.show'\n        },\n\n        mac: {\n          'ENTER': 'insertParagraph',\n          'CMD+Z': 'undo',\n          'CMD+SHIFT+Z': 'redo',\n          'TAB': 'tab',\n          'SHIFT+TAB': 'untab',\n          'CMD+B': 'bold',\n          'CMD+I': 'italic',\n          'CMD+U': 'underline',\n          'CMD+SHIFT+S': 'strikethrough',\n          'CMD+BACKSLASH': 'removeFormat',\n          'CMD+SHIFT+L': 'justifyLeft',\n          'CMD+SHIFT+E': 'justifyCenter',\n          'CMD+SHIFT+R': 'justifyRight',\n          'CMD+SHIFT+J': 'justifyFull',\n          'CMD+SHIFT+NUM7': 'insertUnorderedList',\n          'CMD+SHIFT+NUM8': 'insertOrderedList',\n          'CMD+LEFTBRACKET': 'outdent',\n          'CMD+RIGHTBRACKET': 'indent',\n          'CMD+NUM0': 'formatPara',\n          'CMD+NUM1': 'formatH1',\n          'CMD+NUM2': 'formatH2',\n          'CMD+NUM3': 'formatH3',\n          'CMD+NUM4': 'formatH4',\n          'CMD+NUM5': 'formatH5',\n          'CMD+NUM6': 'formatH6',\n          'CMD+ENTER': 'insertHorizontalRule',\n          'CMD+K': 'linkDialog.show'\n        }\n      },\n      icons: {\n        'align': 'note-icon-align',\n        'alignCenter': 'note-icon-align-center',\n        'alignJustify': 'note-icon-align-justify',\n        'alignLeft': 'note-icon-align-left',\n        'alignRight': 'note-icon-align-right',\n        'indent': 'note-icon-align-indent',\n        'outdent': 'note-icon-align-outdent',\n        'arrowsAlt': 'note-icon-arrows-alt',\n        'bold': 'note-icon-bold',\n        'caret': 'note-icon-caret',\n        'circle': 'note-icon-circle',\n        'close': 'note-icon-close',\n        'code': 'note-icon-code',\n        'eraser': 'note-icon-eraser',\n        'font': 'note-icon-font',\n        'frame': 'note-icon-frame',\n        'italic': 'note-icon-italic',\n        'link': 'note-icon-link',\n        'unlink': 'note-icon-chain-broken',\n        'magic': 'note-icon-magic',\n        'menuCheck': 'note-icon-check',\n        'minus': 'note-icon-minus',\n        'orderedlist': 'note-icon-orderedlist',\n        'pencil': 'note-icon-pencil',\n        'picture': 'note-icon-picture',\n        'question': 'note-icon-question',\n        'redo': 'note-icon-redo',\n        'square': 'note-icon-square',\n        'strikethrough': 'note-icon-strikethrough',\n        'subscript': 'note-icon-subscript',\n        'superscript': 'note-icon-superscript',\n        'table': 'note-icon-table',\n        'textHeight': 'note-icon-text-height',\n        'trash': 'note-icon-trash',\n        'underline': 'note-icon-underline',\n        'undo': 'note-icon-undo',\n        'unorderedlist': 'note-icon-unorderedlist',\n        'video': 'note-icon-video'\n      }\n    }\n  });\n\n}));\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_11__;\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function($) {\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\n__webpack_require__(10);\n\n__webpack_require__(8);\n\n__webpack_require__(7);\n\nvar _react = __webpack_require__(11);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = __webpack_require__(9);\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /* global $ */\n\nvar randomUid = function randomUid() {\n  return Math.floor(Math.random() * 100000);\n};\n\nvar ReactSummernote = function (_Component) {\n  _inherits(ReactSummernote, _Component);\n\n  function ReactSummernote(props) {\n    _classCallCheck(this, ReactSummernote);\n\n    var _this = _possibleConstructorReturn(this, (ReactSummernote.__proto__ || Object.getPrototypeOf(ReactSummernote)).call(this, props));\n\n    _this.uid = 'react-summernote-' + randomUid();\n    _this.editor = {};\n    _this.noteEditable = null;\n    _this.notePlaceholder = null;\n\n    _this.onInit = _this.onInit.bind(_this);\n    _this.onImageUpload = _this.onImageUpload.bind(_this);\n\n    _this.focus = _this.focus.bind(_this);\n    _this.isEmpty = _this.isEmpty.bind(_this);\n    _this.reset = _this.reset.bind(_this);\n    _this.replace = _this.replace.bind(_this);\n    _this.disable = _this.disable.bind(_this);\n    _this.enable = _this.enable.bind(_this);\n    _this.toggleState = _this.toggleState.bind(_this);\n    _this.insertImage = _this.insertImage.bind(_this);\n    _this.insertNode = _this.insertNode.bind(_this);\n    _this.insertText = _this.insertText.bind(_this);\n\n    ReactSummernote.focus = _this.focus.bind(_this);\n    ReactSummernote.isEmpty = _this.isEmpty.bind(_this);\n    ReactSummernote.reset = _this.reset.bind(_this);\n    ReactSummernote.replace = _this.replace.bind(_this);\n    ReactSummernote.disable = _this.disable.bind(_this);\n    ReactSummernote.enable = _this.enable.bind(_this);\n    ReactSummernote.toggleState = _this.toggleState.bind(_this);\n    ReactSummernote.insertImage = _this.insertImage.bind(_this);\n    ReactSummernote.insertNode = _this.insertNode.bind(_this);\n    ReactSummernote.insertText = _this.insertText.bind(_this);\n    return _this;\n  }\n\n  _createClass(ReactSummernote, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var options = this.props.options || {};\n      options.callbacks = this.callbacks;\n\n      this.editor = $('#' + this.uid);\n      this.editor.summernote(options);\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      var props = this.props;\n\n\n      if (typeof nextProps.value === 'string' && props.value !== nextProps.value) {\n        this.replace(nextProps.value);\n      }\n\n      if (typeof nextProps.disabled === 'boolean' && props.disabled !== nextProps.disabled) {\n        this.toggleState(nextProps.disabled);\n      }\n    }\n  }, {\n    key: 'shouldComponentUpdate',\n    value: function shouldComponentUpdate() {\n      return false;\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (this.editor.summernote) {\n        this.editor.summernote('destroy');\n      }\n    }\n  }, {\n    key: 'onInit',\n    value: function onInit() {\n      var _props = this.props,\n          disabled = _props.disabled,\n          onInit = _props.onInit;\n\n\n      var $container = this.editor.parent();\n      this.noteEditable = $container.find('.note-editable');\n      this.notePlaceholder = $container.find('.note-placeholder');\n\n      if (typeof disabled === 'boolean') {\n        this.toggleState(disabled);\n      }\n\n      if (typeof onInit === 'function') {\n        onInit({\n          summernote: this.editor.summernote,\n          focus: this.focus,\n          isEmpty: this.isEmpty,\n          reset: this.reset,\n          replace: this.replace,\n          disable: this.disable,\n          enable: this.enable,\n          insertImage: this.insertImage,\n          insertNode: this.insertNode,\n          insertText: this.insertText\n        });\n      }\n    }\n  }, {\n    key: 'onImageUpload',\n    value: function onImageUpload(images) {\n      var onImageUpload = this.props.onImageUpload;\n\n\n      if (typeof onImageUpload === 'function') {\n        onImageUpload(images, this.insertImage);\n      }\n    }\n  }, {\n    key: 'focus',\n    value: function focus() {\n      this.editor.summernote('focus');\n    }\n  }, {\n    key: 'isEmpty',\n    value: function isEmpty() {\n      return this.editor.summernote('isEmpty');\n    }\n  }, {\n    key: 'reset',\n    value: function reset() {\n      this.editor.summernote('reset');\n    }\n  }, {\n    key: 'replace',\n    value: function replace(content) {\n      var noteEditable = this.noteEditable,\n          notePlaceholder = this.notePlaceholder;\n\n      var prevContent = noteEditable.html();\n      var contentLength = content.length;\n\n      if (prevContent !== content) {\n        if (this.isEmpty() && contentLength > 0) {\n          notePlaceholder.hide();\n        } else if (contentLength === 0) {\n          notePlaceholder.show();\n        }\n\n        noteEditable.html(content);\n      }\n    }\n  }, {\n    key: 'disable',\n    value: function disable() {\n      this.editor.summernote('disable');\n    }\n  }, {\n    key: 'enable',\n    value: function enable() {\n      this.editor.summernote('enable');\n    }\n  }, {\n    key: 'toggleState',\n    value: function toggleState(disabled) {\n      if (disabled) {\n        this.disable();\n      } else {\n        this.enable();\n      }\n    }\n  }, {\n    key: 'insertImage',\n    value: function insertImage(url, filenameOrCallback) {\n      this.editor.summernote('insertImage', url, filenameOrCallback);\n    }\n  }, {\n    key: 'insertNode',\n    value: function insertNode(node) {\n      this.editor.summernote('insertNode', node);\n    }\n  }, {\n    key: 'insertText',\n    value: function insertText(text) {\n      this.editor.summernote('insertText', text);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props2 = this.props,\n          value = _props2.value,\n          defaultValue = _props2.defaultValue,\n          className = _props2.className;\n\n      var html = value || defaultValue;\n\n      return _react2.default.createElement(\n        'div',\n        { className: className },\n        _react2.default.createElement('div', { id: this.uid, dangerouslySetInnerHTML: { __html: html } })\n      );\n    }\n  }, {\n    key: 'callbacks',\n    get: function get() {\n      var props = this.props;\n\n      return {\n        onInit: this.onInit,\n        onEnter: props.onEnter,\n        onFocus: props.onFocus,\n        onBlur: props.onBlur,\n        onKeyup: props.onKeyUp,\n        onKeydown: props.onKeyDown,\n        onPaste: props.onPaste,\n        onChange: props.onChange,\n        onImageUpload: this.onImageUpload\n      };\n    }\n  }]);\n\n  return ReactSummernote;\n}(_react.Component);\n\nReactSummernote.propTypes = {\n  value: _propTypes2.default.string,\n  defaultValue: _propTypes2.default.string,\n  className: _propTypes2.default.string,\n  options: _propTypes2.default.object,\n  disabled: _propTypes2.default.bool,\n  onInit: _propTypes2.default.func,\n  onEnter: _propTypes2.default.func,\n  onFocus: _propTypes2.default.func,\n  onBlur: _propTypes2.default.func,\n  onKeyUp: _propTypes2.default.func,\n  onKeyDown: _propTypes2.default.func,\n  onPaste: _propTypes2.default.func,\n  onChange: _propTypes2.default.func,\n  onImageUpload: _propTypes2.default.func\n};\n\nexports.default = ReactSummernote;\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(4)))\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(process) {/**\n * Copyright 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n\n\nif (process.env.NODE_ENV !== 'production') {\n  var invariant = __webpack_require__(2);\n  var warning = __webpack_require__(6);\n  var ReactPropTypesSecret = __webpack_require__(3);\n  var loggedTypeFailures = {};\n}\n\n/**\n * Assert that the values match with the type specs.\n * Error messages are memorized and will only be shown once.\n *\n * @param {object} typeSpecs Map of name to a ReactPropType\n * @param {object} values Runtime values that need to be type-checked\n * @param {string} location e.g. \"prop\", \"context\", \"child context\"\n * @param {string} componentName Name of the component for error messages.\n * @param {?Function} getStack Returns the component stack.\n * @private\n */\nfunction checkPropTypes(typeSpecs, values, location, componentName, getStack) {\n  if (process.env.NODE_ENV !== 'production') {\n    for (var typeSpecName in typeSpecs) {\n      if (typeSpecs.hasOwnProperty(typeSpecName)) {\n        var error;\n        // Prop type validation may throw. In case they do, we don't want to\n        // fail the render phase where it didn't fail before. So we log it.\n        // After these have been cleaned up, we'll let them throw.\n        try {\n          // This is intentionally an invariant that gets caught. It's the same\n          // behavior as without this statement except with a better message.\n          invariant(typeof typeSpecs[typeSpecName] === 'function', '%s: %s type `%s` is invalid; it must be a function, usually from ' + 'React.PropTypes.', componentName || 'React class', location, typeSpecName);\n          error = typeSpecs[typeSpecName](values, typeSpecName, componentName, location, null, ReactPropTypesSecret);\n        } catch (ex) {\n          error = ex;\n        }\n        warning(!error || error instanceof Error, '%s: type specification of %s `%s` is invalid; the type checker ' + 'function must return `null` or an `Error` but returned a %s. ' + 'You may have forgotten to pass an argument to the type checker ' + 'creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and ' + 'shape all require an argument).', componentName || 'React class', location, typeSpecName, typeof error);\n        if (error instanceof Error && !(error.message in loggedTypeFailures)) {\n          // Only monitor this failure once because there tends to be a lot of the\n          // same error.\n          loggedTypeFailures[error.message] = true;\n\n          var stack = getStack ? getStack() : '';\n\n          warning(false, 'Failed %s type: %s%s', location, error.message, stack != null ? stack : '');\n        }\n      }\n    }\n  }\n}\n\nmodule.exports = checkPropTypes;\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * Copyright 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n\n\nvar emptyFunction = __webpack_require__(1);\nvar invariant = __webpack_require__(2);\nvar ReactPropTypesSecret = __webpack_require__(3);\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    invariant(\n      false,\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim\n  };\n\n  ReactPropTypes.checkPropTypes = emptyFunction;\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(process) {/**\n * Copyright 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n\n\nvar emptyFunction = __webpack_require__(1);\nvar invariant = __webpack_require__(2);\nvar warning = __webpack_require__(6);\n\nvar ReactPropTypesSecret = __webpack_require__(3);\nvar checkPropTypes = __webpack_require__(13);\n\nmodule.exports = function(isValidElement, throwOnDirectAccess) {\n  /* global Symbol */\n  var ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\n  var FAUX_ITERATOR_SYMBOL = '@@iterator'; // Before Symbol spec.\n\n  /**\n   * Returns the iterator method function contained on the iterable object.\n   *\n   * Be sure to invoke the function with the iterable as context:\n   *\n   *     var iteratorFn = getIteratorFn(myIterable);\n   *     if (iteratorFn) {\n   *       var iterator = iteratorFn.call(myIterable);\n   *       ...\n   *     }\n   *\n   * @param {?object} maybeIterable\n   * @return {?function}\n   */\n  function getIteratorFn(maybeIterable) {\n    var iteratorFn = maybeIterable && (ITERATOR_SYMBOL && maybeIterable[ITERATOR_SYMBOL] || maybeIterable[FAUX_ITERATOR_SYMBOL]);\n    if (typeof iteratorFn === 'function') {\n      return iteratorFn;\n    }\n  }\n\n  /**\n   * Collection of methods that allow declaration and validation of props that are\n   * supplied to React components. Example usage:\n   *\n   *   var Props = require('ReactPropTypes');\n   *   var MyArticle = React.createClass({\n   *     propTypes: {\n   *       // An optional string prop named \"description\".\n   *       description: Props.string,\n   *\n   *       // A required enum prop named \"category\".\n   *       category: Props.oneOf(['News','Photos']).isRequired,\n   *\n   *       // A prop named \"dialog\" that requires an instance of Dialog.\n   *       dialog: Props.instanceOf(Dialog).isRequired\n   *     },\n   *     render: function() { ... }\n   *   });\n   *\n   * A more formal specification of how these methods are used:\n   *\n   *   type := array|bool|func|object|number|string|oneOf([...])|instanceOf(...)\n   *   decl := ReactPropTypes.{type}(.isRequired)?\n   *\n   * Each and every declaration produces a function with the same signature. This\n   * allows the creation of custom validation functions. For example:\n   *\n   *  var MyLink = React.createClass({\n   *    propTypes: {\n   *      // An optional string or URI prop named \"href\".\n   *      href: function(props, propName, componentName) {\n   *        var propValue = props[propName];\n   *        if (propValue != null && typeof propValue !== 'string' &&\n   *            !(propValue instanceof URI)) {\n   *          return new Error(\n   *            'Expected a string or an URI for ' + propName + ' in ' +\n   *            componentName\n   *          );\n   *        }\n   *      }\n   *    },\n   *    render: function() {...}\n   *  });\n   *\n   * @internal\n   */\n\n  var ANONYMOUS = '<<anonymous>>';\n\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithThrowingShims.js`.\n  var ReactPropTypes = {\n    array: createPrimitiveTypeChecker('array'),\n    bool: createPrimitiveTypeChecker('boolean'),\n    func: createPrimitiveTypeChecker('function'),\n    number: createPrimitiveTypeChecker('number'),\n    object: createPrimitiveTypeChecker('object'),\n    string: createPrimitiveTypeChecker('string'),\n    symbol: createPrimitiveTypeChecker('symbol'),\n\n    any: createAnyTypeChecker(),\n    arrayOf: createArrayOfTypeChecker,\n    element: createElementTypeChecker(),\n    instanceOf: createInstanceTypeChecker,\n    node: createNodeChecker(),\n    objectOf: createObjectOfTypeChecker,\n    oneOf: createEnumTypeChecker,\n    oneOfType: createUnionTypeChecker,\n    shape: createShapeTypeChecker\n  };\n\n  /**\n   * inlined Object.is polyfill to avoid requiring consumers ship their own\n   * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n   */\n  /*eslint-disable no-self-compare*/\n  function is(x, y) {\n    // SameValue algorithm\n    if (x === y) {\n      // Steps 1-5, 7-10\n      // Steps 6.b-6.e: +0 != -0\n      return x !== 0 || 1 / x === 1 / y;\n    } else {\n      // Step 6.a: NaN == NaN\n      return x !== x && y !== y;\n    }\n  }\n  /*eslint-enable no-self-compare*/\n\n  /**\n   * We use an Error-like object for backward compatibility as people may call\n   * PropTypes directly and inspect their output. However, we don't use real\n   * Errors anymore. We don't inspect their stack anyway, and creating them\n   * is prohibitively expensive if they are created too often, such as what\n   * happens in oneOfType() for any type before the one that matched.\n   */\n  function PropTypeError(message) {\n    this.message = message;\n    this.stack = '';\n  }\n  // Make `instanceof Error` still work for returned errors.\n  PropTypeError.prototype = Error.prototype;\n\n  function createChainableTypeChecker(validate) {\n    if (process.env.NODE_ENV !== 'production') {\n      var manualPropTypeCallCache = {};\n      var manualPropTypeWarningCount = 0;\n    }\n    function checkType(isRequired, props, propName, componentName, location, propFullName, secret) {\n      componentName = componentName || ANONYMOUS;\n      propFullName = propFullName || propName;\n\n      if (secret !== ReactPropTypesSecret) {\n        if (throwOnDirectAccess) {\n          // New behavior only for users of `prop-types` package\n          invariant(\n            false,\n            'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n            'Use `PropTypes.checkPropTypes()` to call them. ' +\n            'Read more at http://fb.me/use-check-prop-types'\n          );\n        } else if (process.env.NODE_ENV !== 'production' && typeof console !== 'undefined') {\n          // Old behavior for people using React.PropTypes\n          var cacheKey = componentName + ':' + propName;\n          if (\n            !manualPropTypeCallCache[cacheKey] &&\n            // Avoid spamming the console because they are often not actionable except for lib authors\n            manualPropTypeWarningCount < 3\n          ) {\n            warning(\n              false,\n              'You are manually calling a React.PropTypes validation ' +\n              'function for the `%s` prop on `%s`. This is deprecated ' +\n              'and will throw in the standalone `prop-types` package. ' +\n              'You may be seeing this warning due to a third-party PropTypes ' +\n              'library. See https://fb.me/react-warning-dont-call-proptypes ' + 'for details.',\n              propFullName,\n              componentName\n            );\n            manualPropTypeCallCache[cacheKey] = true;\n            manualPropTypeWarningCount++;\n          }\n        }\n      }\n      if (props[propName] == null) {\n        if (isRequired) {\n          if (props[propName] === null) {\n            return new PropTypeError('The ' + location + ' `' + propFullName + '` is marked as required ' + ('in `' + componentName + '`, but its value is `null`.'));\n          }\n          return new PropTypeError('The ' + location + ' `' + propFullName + '` is marked as required in ' + ('`' + componentName + '`, but its value is `undefined`.'));\n        }\n        return null;\n      } else {\n        return validate(props, propName, componentName, location, propFullName);\n      }\n    }\n\n    var chainedCheckType = checkType.bind(null, false);\n    chainedCheckType.isRequired = checkType.bind(null, true);\n\n    return chainedCheckType;\n  }\n\n  function createPrimitiveTypeChecker(expectedType) {\n    function validate(props, propName, componentName, location, propFullName, secret) {\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== expectedType) {\n        // `propValue` being instance of, say, date/regexp, pass the 'object'\n        // check, but we can offer a more precise error message here rather than\n        // 'of type `object`'.\n        var preciseType = getPreciseType(propValue);\n\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + preciseType + '` supplied to `' + componentName + '`, expected ') + ('`' + expectedType + '`.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createAnyTypeChecker() {\n    return createChainableTypeChecker(emptyFunction.thatReturnsNull);\n  }\n\n  function createArrayOfTypeChecker(typeChecker) {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (typeof typeChecker !== 'function') {\n        return new PropTypeError('Property `' + propFullName + '` of component `' + componentName + '` has invalid PropType notation inside arrayOf.');\n      }\n      var propValue = props[propName];\n      if (!Array.isArray(propValue)) {\n        var propType = getPropType(propValue);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected an array.'));\n      }\n      for (var i = 0; i < propValue.length; i++) {\n        var error = typeChecker(propValue, i, componentName, location, propFullName + '[' + i + ']', ReactPropTypesSecret);\n        if (error instanceof Error) {\n          return error;\n        }\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createElementTypeChecker() {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      if (!isValidElement(propValue)) {\n        var propType = getPropType(propValue);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected a single ReactElement.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createInstanceTypeChecker(expectedClass) {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (!(props[propName] instanceof expectedClass)) {\n        var expectedClassName = expectedClass.name || ANONYMOUS;\n        var actualClassName = getClassName(props[propName]);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + actualClassName + '` supplied to `' + componentName + '`, expected ') + ('instance of `' + expectedClassName + '`.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createEnumTypeChecker(expectedValues) {\n    if (!Array.isArray(expectedValues)) {\n      process.env.NODE_ENV !== 'production' ? warning(false, 'Invalid argument supplied to oneOf, expected an instance of array.') : void 0;\n      return emptyFunction.thatReturnsNull;\n    }\n\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      for (var i = 0; i < expectedValues.length; i++) {\n        if (is(propValue, expectedValues[i])) {\n          return null;\n        }\n      }\n\n      var valuesString = JSON.stringify(expectedValues);\n      return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of value `' + propValue + '` ' + ('supplied to `' + componentName + '`, expected one of ' + valuesString + '.'));\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createObjectOfTypeChecker(typeChecker) {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (typeof typeChecker !== 'function') {\n        return new PropTypeError('Property `' + propFullName + '` of component `' + componentName + '` has invalid PropType notation inside objectOf.');\n      }\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== 'object') {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected an object.'));\n      }\n      for (var key in propValue) {\n        if (propValue.hasOwnProperty(key)) {\n          var error = typeChecker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);\n          if (error instanceof Error) {\n            return error;\n          }\n        }\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createUnionTypeChecker(arrayOfTypeCheckers) {\n    if (!Array.isArray(arrayOfTypeCheckers)) {\n      process.env.NODE_ENV !== 'production' ? warning(false, 'Invalid argument supplied to oneOfType, expected an instance of array.') : void 0;\n      return emptyFunction.thatReturnsNull;\n    }\n\n    for (var i = 0; i < arrayOfTypeCheckers.length; i++) {\n      var checker = arrayOfTypeCheckers[i];\n      if (typeof checker !== 'function') {\n        warning(\n          false,\n          'Invalid argument supplid to oneOfType. Expected an array of check functions, but ' +\n          'received %s at index %s.',\n          getPostfixForTypeWarning(checker),\n          i\n        );\n        return emptyFunction.thatReturnsNull;\n      }\n    }\n\n    function validate(props, propName, componentName, location, propFullName) {\n      for (var i = 0; i < arrayOfTypeCheckers.length; i++) {\n        var checker = arrayOfTypeCheckers[i];\n        if (checker(props, propName, componentName, location, propFullName, ReactPropTypesSecret) == null) {\n          return null;\n        }\n      }\n\n      return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` supplied to ' + ('`' + componentName + '`.'));\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createNodeChecker() {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (!isNode(props[propName])) {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` supplied to ' + ('`' + componentName + '`, expected a ReactNode.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createShapeTypeChecker(shapeTypes) {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== 'object') {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type `' + propType + '` ' + ('supplied to `' + componentName + '`, expected `object`.'));\n      }\n      for (var key in shapeTypes) {\n        var checker = shapeTypes[key];\n        if (!checker) {\n          continue;\n        }\n        var error = checker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);\n        if (error) {\n          return error;\n        }\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function isNode(propValue) {\n    switch (typeof propValue) {\n      case 'number':\n      case 'string':\n      case 'undefined':\n        return true;\n      case 'boolean':\n        return !propValue;\n      case 'object':\n        if (Array.isArray(propValue)) {\n          return propValue.every(isNode);\n        }\n        if (propValue === null || isValidElement(propValue)) {\n          return true;\n        }\n\n        var iteratorFn = getIteratorFn(propValue);\n        if (iteratorFn) {\n          var iterator = iteratorFn.call(propValue);\n          var step;\n          if (iteratorFn !== propValue.entries) {\n            while (!(step = iterator.next()).done) {\n              if (!isNode(step.value)) {\n                return false;\n              }\n            }\n          } else {\n            // Iterator will provide entry [k,v] tuples rather than values.\n            while (!(step = iterator.next()).done) {\n              var entry = step.value;\n              if (entry) {\n                if (!isNode(entry[1])) {\n                  return false;\n                }\n              }\n            }\n          }\n        } else {\n          return false;\n        }\n\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  function isSymbol(propType, propValue) {\n    // Native Symbol.\n    if (propType === 'symbol') {\n      return true;\n    }\n\n    // 19.4.3.5 Symbol.prototype[@@toStringTag] === 'Symbol'\n    if (propValue['@@toStringTag'] === 'Symbol') {\n      return true;\n    }\n\n    // Fallback for non-spec compliant Symbols which are polyfilled.\n    if (typeof Symbol === 'function' && propValue instanceof Symbol) {\n      return true;\n    }\n\n    return false;\n  }\n\n  // Equivalent of `typeof` but with special handling for array and regexp.\n  function getPropType(propValue) {\n    var propType = typeof propValue;\n    if (Array.isArray(propValue)) {\n      return 'array';\n    }\n    if (propValue instanceof RegExp) {\n      // Old webkits (at least until Android 4.0) return 'function' rather than\n      // 'object' for typeof a RegExp. We'll normalize this here so that /bla/\n      // passes PropTypes.object.\n      return 'object';\n    }\n    if (isSymbol(propType, propValue)) {\n      return 'symbol';\n    }\n    return propType;\n  }\n\n  // This handles more types than `getPropType`. Only used for error messages.\n  // See `createPrimitiveTypeChecker`.\n  function getPreciseType(propValue) {\n    if (typeof propValue === 'undefined' || propValue === null) {\n      return '' + propValue;\n    }\n    var propType = getPropType(propValue);\n    if (propType === 'object') {\n      if (propValue instanceof Date) {\n        return 'date';\n      } else if (propValue instanceof RegExp) {\n        return 'regexp';\n      }\n    }\n    return propType;\n  }\n\n  // Returns a string that is postfixed to a warning about an invalid type.\n  // For example, \"undefined\" or \"of type array\"\n  function getPostfixForTypeWarning(value) {\n    var type = getPreciseType(value);\n    switch (type) {\n      case 'array':\n      case 'object':\n        return 'an ' + type;\n      case 'boolean':\n      case 'date':\n      case 'regexp':\n        return 'a ' + type;\n      default:\n        return type;\n    }\n  }\n\n  // Returns class name of the object, if any.\n  function getClassName(propValue) {\n    if (!propValue.constructor || !propValue.constructor.name) {\n      return ANONYMOUS;\n    }\n    return propValue.constructor.name;\n  }\n\n  ReactPropTypes.checkPropTypes = checkPropTypes;\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(0)))\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports) {\n\n/* WEBPACK VAR INJECTION */(function(__webpack_amd_options__) {/* globals __webpack_amd_options__ */\r\nmodule.exports = __webpack_amd_options__;\r\n\n/* WEBPACK VAR INJECTION */}.call(exports, {}))\n\n/***/ })\n/******/ ]);\n});"]},"metadata":{},"sourceType":"script"}